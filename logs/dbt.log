[0m09:50:33.419774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C989DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996CB48E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996CB490A0>]}


============================== 09:50:33.423708 | 2131af59-0490-442c-a22b-02b36e6cc1f3 ==============================
[0m09:50:33.423708 [info ] [MainThread]: Running with dbt=1.8.0
[0m09:50:33.424841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\portfolio_project_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:50:33.614074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2131af59-0490-442c-a22b-02b36e6cc1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C9898E0>]}
[0m09:50:33.648746 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:50:33.650740 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:50:33.651943 [debug] [MainThread]: Command `cli deps` succeeded at 09:50:33.651943 after 0.36 seconds
[0m09:50:33.651943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C9898E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996CB95760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996DDA7FB0>]}
[0m09:50:33.653328 [debug] [MainThread]: Flushing usage events
[0m14:46:33.312374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8772F1460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A87722DA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8772CDAF0>]}


============================== 14:46:33.316752 | ecd24de3-887e-4855-91a2-7ab6da255ba4 ==============================
[0m14:46:33.316752 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:46:33.317757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:46:33.508270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecd24de3-887e-4855-91a2-7ab6da255ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A87760A570>]}
[0m14:46:33.539367 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:46:33.541364 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:46:33.542362 [debug] [MainThread]: Command `cli deps` succeeded at 14:46:33.542362 after 0.36 seconds
[0m14:46:33.543359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A876FC0BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8772CF260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8777B5DF0>]}
[0m14:46:33.543359 [debug] [MainThread]: Flushing usage events
[0m14:46:53.634270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC75CB8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC764C42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC76B07ED0>]}


============================== 14:46:53.638786 | 17328ad3-a59a-4f63-89e3-797e95b84802 ==============================
[0m14:46:53.638786 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:46:53.639523 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target prod', 'printer_width': '80', 'target_path': 'None'}
[0m14:46:53.984953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC75E70180>]}
[0m14:46:54.051306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC769ABAC0>]}
[0m14:46:54.069612 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:46:54.515395 [debug] [MainThread]: checksum: fd5f499d60404c73e369f2149bd6aa6c74754a4e78aa98476ca57564d99f7088, vars: {}, profile: , target: prod, version: 1.10.13
[0m14:46:54.593281 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:46:54.593875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC77C99750>]}
[0m14:46:56.876189 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.portfolio_project_2.example
[0m14:46:56.885310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC77E0EE40>]}
[0m14:46:56.955067 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:46:56.978652 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:46:57.010470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78451B70>]}
[0m14:46:57.011008 [info ] [MainThread]: Found 2 models, 2 sources, 461 macros
[0m14:46:57.011548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78077C70>]}
[0m14:46:57.013873 [info ] [MainThread]: 
[0m14:46:57.014445 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:46:57.014912 [info ] [MainThread]: 
[0m14:46:57.015546 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:46:57.020650 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m14:46:59.783272 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m14:46:59.783844 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m14:46:59.784149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:40.658600 [debug] [ThreadPool]: SQL status: OK in 40.874 seconds
[0m14:47:40.660355 [debug] [ThreadPool]: On list_finance: Close
[0m14:47:40.661093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_prod)
[0m14:47:40.661582 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_prod"
"
[0m14:47:40.667722 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:47:40.668143 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m14:47:40.668468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:40.670893 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:47:40.672373 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:47:40.672690 [debug] [ThreadPool]: On create_finance_analytics_prod: BEGIN
[0m14:47:40.673666 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:47:40.673975 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:47:40.674280 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
    
        create schema if not exists "finance"."analytics_prod"
    
[0m14:47:40.728701 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m14:47:40.729794 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m14:47:40.730187 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:47:40.730500 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m14:47:40.840907 [debug] [ThreadPool]: SQL status: OK in 0.110 seconds
[0m14:47:40.841483 [debug] [ThreadPool]: On create_finance_analytics_prod: Close
[0m14:47:40.843328 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_prod'
[0m14:47:40.849291 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m14:47:40.849710 [debug] [ThreadPool]: On list_finance_analytics_prod: BEGIN
[0m14:47:40.850009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:40.851154 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:47:40.851544 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m14:47:40.851868 [debug] [ThreadPool]: On list_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance_analytics_prod"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_prod'
    and lower(table_catalog) = 'finance'
  
[0m14:47:40.891567 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m14:47:40.892981 [debug] [ThreadPool]: On list_finance_analytics_prod: ROLLBACK
[0m14:47:40.909926 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_prod'
[0m14:47:40.910347 [debug] [ThreadPool]: On list_finance_analytics_prod: Close
[0m14:47:40.911285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78440D10>]}
[0m14:47:40.911778 [debug] [MainThread]: Using duckdb connection "master"
[0m14:47:40.912114 [debug] [MainThread]: On master: BEGIN
[0m14:47:40.912428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:47:40.913625 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:47:40.913957 [debug] [MainThread]: On master: COMMIT
[0m14:47:40.914264 [debug] [MainThread]: Using duckdb connection "master"
[0m14:47:40.914558 [debug] [MainThread]: On master: COMMIT
[0m14:47:40.915185 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:47:40.915535 [debug] [MainThread]: On master: Close
[0m14:47:40.922119 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m14:47:40.922624 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m14:47:40.923208 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_prod.src_stocks .......................... [RUN]
[0m14:47:40.924565 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m14:47:40.925012 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m14:47:40.931923 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m14:47:40.923771 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_prod.src_vix ............................. [RUN]
[0m14:47:40.932841 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m14:47:40.933382 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m14:47:40.936851 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m14:47:40.940469 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m14:47:40.940954 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m14:47:40.974123 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m14:47:40.977779 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m14:47:40.981187 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:47:40.981948 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m14:47:40.982746 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:47:40.983390 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:47:40.984237 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m14:47:40.984623 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:47:40.985276 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:47:40.985667 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:47:40.986068 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_prod"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high:double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m14:47:40.986497 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:47:41.002041 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_prod"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high:double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m14:47:41.002588 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:47:41.003071 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:47:41.003539 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_prod"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close"
from src
  );

[0m14:47:41.004110 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: ROLLBACK
[0m14:47:41.072228 [debug] [Thread-2 (]: SQL status: OK in 0.067 seconds
[0m14:47:41.078436 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:47:41.078904 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_prod"."src_vix__dbt_tmp" rename to "src_vix"
[0m14:47:41.145144 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m14:47:41.159639 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:47:41.160545 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:47:41.161346 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:47:41.177419 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.src_stocks'
[0m14:47:41.177865 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m14:47:41.182022 [debug] [Thread-1 (]: Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^
[0m14:47:41.184176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7864D860>]}
[0m14:47:41.184804 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model analytics_prod.src_stocks ................. [[31mERROR[0m in 0.26s]
[0m14:47:41.185623 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m14:47:41.186268 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.src_stocks' to be skipped because of status 'error'.  Reason: Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^.
[0m14:47:41.274430 [debug] [Thread-2 (]: SQL status: OK in 0.113 seconds
[0m14:47:41.279688 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:47:41.280116 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_prod"."src_vix__dbt_backup" cascade
    
[0m14:47:41.325498 [debug] [Thread-2 (]: SQL status: OK in 0.045 seconds
[0m14:47:41.327996 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m14:47:41.328570 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0118E530>]}
[0m14:47:41.329156 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_prod.src_vix ........................ [[32mOK[0m in 0.40s]
[0m14:47:41.329969 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m14:47:41.331433 [debug] [MainThread]: Using duckdb connection "master"
[0m14:47:41.331761 [debug] [MainThread]: On master: BEGIN
[0m14:47:41.332055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:47:41.333306 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:47:41.333647 [debug] [MainThread]: On master: COMMIT
[0m14:47:41.333976 [debug] [MainThread]: Using duckdb connection "master"
[0m14:47:41.334290 [debug] [MainThread]: On master: COMMIT
[0m14:47:41.334966 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:47:41.335305 [debug] [MainThread]: On master: Close
[0m14:47:41.335712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:41.336067 [debug] [MainThread]: Connection 'create_finance_analytics_prod' was properly closed.
[0m14:47:41.336341 [debug] [MainThread]: Connection 'list_finance_analytics_prod' was properly closed.
[0m14:47:41.336612 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_stocks' was properly closed.
[0m14:47:41.336876 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m14:47:41.340398 [info ] [MainThread]: 
[0m14:47:41.341324 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 44.32 seconds (44.32s).
[0m14:47:41.343093 [debug] [MainThread]: Command end result
[0m14:47:41.371594 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:47:41.374695 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:47:41.382625 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m14:47:41.383043 [info ] [MainThread]: 
[0m14:47:41.383614 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:47:41.384146 [info ] [MainThread]: 
[0m14:47:41.384871 [error] [MainThread]: [31mFailure in model src_stocks (models\bronze\src_stocks.sql)[0m
[0m14:47:41.385705 [error] [MainThread]:   Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^
[0m14:47:41.386443 [info ] [MainThread]: 
[0m14:47:41.387338 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\bronze\src_stocks.sql
[0m14:47:41.388147 [info ] [MainThread]: 
[0m14:47:41.388727 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m14:47:41.389780 [debug] [MainThread]: Command `-c run` failed at 14:47:41.389594 after 47.88 seconds
[0m14:47:41.390297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC786327D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78675150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC701AF150>]}
[0m14:47:41.390903 [debug] [MainThread]: Flushing usage events
[0m14:47:42.202135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:47:44.771591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBE558050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBED642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBF3A7ED0>]}


============================== 14:47:44.775945 | cbcf40c9-a4db-4334-8ca3-01e30d7a4faa ==============================
[0m14:47:44.775945 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:47:44.776785 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'write_json': 'True', 'invocation_command': 'dbt run --target prodclear', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:47:44.779433 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'portfolio_project_2' does not have a target named 'prodclear'. The valid target names for this profile are:
   - dev
   - prod
[0m14:47:44.780365 [debug] [MainThread]: Command `-c run` failed at 14:47:44.780246 after 0.13 seconds
[0m14:47:44.780733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBF4242B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBF2AA8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBF249AE0>]}
[0m14:47:44.781124 [debug] [MainThread]: Flushing usage events
[0m14:47:45.533611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:48:30.536473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7D768050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7DF742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7E5B3ED0>]}


============================== 14:48:30.541105 | fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2 ==============================
[0m14:48:30.541105 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:48:30.541814 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target prod', 'printer_width': '80', 'target_path': 'None'}
[0m14:48:30.788802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7D920180>]}
[0m14:48:30.853194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7E45BAC0>]}
[0m14:48:30.855768 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:48:31.110806 [debug] [MainThread]: checksum: fd5f499d60404c73e369f2149bd6aa6c74754a4e78aa98476ca57564d99f7088, vars: {}, profile: , target: prod, version: 1.10.13
[0m14:48:31.188580 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:48:31.189166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7F6E9750>]}
[0m14:48:32.394734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7F85EE40>]}
[0m14:48:32.457491 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:48:32.459953 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:48:32.487434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7FEA1A90>]}
[0m14:48:32.487962 [info ] [MainThread]: Found 2 models, 2 sources, 461 macros
[0m14:48:32.488523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7FBA82C0>]}
[0m14:48:32.490267 [info ] [MainThread]: 
[0m14:48:32.490772 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:48:32.491311 [info ] [MainThread]: 
[0m14:48:32.491932 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:48:32.496832 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m14:48:32.575229 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m14:48:32.575644 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m14:48:32.575973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:33.855543 [debug] [ThreadPool]: SQL status: OK in 1.279 seconds
[0m14:48:33.857093 [debug] [ThreadPool]: On list_finance: Close
[0m14:48:33.857810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_prod)
[0m14:48:33.858318 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_prod"
"
[0m14:48:33.864662 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:48:33.865067 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m14:48:33.865380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:33.867059 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:48:33.868366 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:48:33.868678 [debug] [ThreadPool]: On create_finance_analytics_prod: BEGIN
[0m14:48:33.869601 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:48:33.869922 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:48:33.870224 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
    
        create schema if not exists "finance"."analytics_prod"
    
[0m14:48:33.923943 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m14:48:33.924978 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m14:48:33.925337 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:48:33.925663 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m14:48:33.985490 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m14:48:33.986044 [debug] [ThreadPool]: On create_finance_analytics_prod: Close
[0m14:48:33.988135 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_prod'
[0m14:48:33.995933 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m14:48:33.996426 [debug] [ThreadPool]: On list_finance_analytics_prod: BEGIN
[0m14:48:33.996856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:33.998372 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:48:33.998912 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m14:48:33.999524 [debug] [ThreadPool]: On list_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance_analytics_prod"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_prod'
    and lower(table_catalog) = 'finance'
  
[0m14:48:34.025467 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m14:48:34.026811 [debug] [ThreadPool]: On list_finance_analytics_prod: ROLLBACK
[0m14:48:34.027842 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_prod'
[0m14:48:34.028164 [debug] [ThreadPool]: On list_finance_analytics_prod: Close
[0m14:48:34.029302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7FE90D10>]}
[0m14:48:34.029776 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:34.030071 [debug] [MainThread]: On master: BEGIN
[0m14:48:34.030349 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:48:34.031569 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:48:34.031909 [debug] [MainThread]: On master: COMMIT
[0m14:48:34.032231 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:34.032536 [debug] [MainThread]: On master: COMMIT
[0m14:48:34.033105 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:48:34.033425 [debug] [MainThread]: On master: Close
[0m14:48:34.038175 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m14:48:34.039228 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m14:48:34.038770 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_prod.src_stocks .......................... [RUN]
[0m14:48:34.040538 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m14:48:34.040001 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_prod.src_vix ............................. [RUN]
[0m14:48:34.041066 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m14:48:34.041554 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m14:48:34.049486 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m14:48:34.050365 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m14:48:34.054721 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m14:48:34.055991 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m14:48:34.056638 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m14:48:34.089569 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m14:48:34.093389 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m14:48:34.095197 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:48:34.095715 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m14:48:34.096065 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:48:34.097049 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.097494 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m14:48:34.097874 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:48:34.098541 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:48:34.099139 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:48:34.099647 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_prod"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high:double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m14:48:34.102598 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_prod"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high:double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m14:48:34.103011 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:48:34.103467 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: ROLLBACK
[0m14:48:34.103934 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:48:34.104318 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.105714 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_prod"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close"
from src
  );

[0m14:48:34.112602 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.src_stocks'
[0m14:48:34.113026 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m14:48:34.117847 [debug] [Thread-1 (]: Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^
[0m14:48:34.121670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A000DD650>]}
[0m14:48:34.122950 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model analytics_prod.src_stocks ................. [[31mERROR[0m in 0.08s]
[0m14:48:34.124373 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m14:48:34.125467 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.src_stocks' to be skipped because of status 'error'.  Reason: Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^.
[0m14:48:34.168341 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m14:48:34.175088 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.175600 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_prod"."src_vix" rename to "src_vix__dbt_backup"
[0m14:48:34.231528 [debug] [Thread-2 (]: SQL status: OK in 0.055 seconds
[0m14:48:34.240942 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.241910 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_prod"."src_vix__dbt_tmp" rename to "src_vix"
[0m14:48:34.307170 [debug] [Thread-2 (]: SQL status: OK in 0.064 seconds
[0m14:48:34.331597 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:48:34.332127 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.332575 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:48:34.446466 [debug] [Thread-2 (]: SQL status: OK in 0.113 seconds
[0m14:48:34.451838 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.452346 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_prod"."src_vix__dbt_backup" cascade
    
[0m14:48:34.601804 [debug] [Thread-2 (]: SQL status: OK in 0.149 seconds
[0m14:48:34.604393 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m14:48:34.605031 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A002E1770>]}
[0m14:48:34.605661 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_prod.src_vix ........................ [[32mOK[0m in 0.56s]
[0m14:48:34.606546 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m14:48:34.608261 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:34.608613 [debug] [MainThread]: On master: BEGIN
[0m14:48:34.608907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:48:34.610196 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:48:34.610547 [debug] [MainThread]: On master: COMMIT
[0m14:48:34.610856 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:34.611146 [debug] [MainThread]: On master: COMMIT
[0m14:48:34.611800 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:48:34.612121 [debug] [MainThread]: On master: Close
[0m14:48:34.612537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:34.612818 [debug] [MainThread]: Connection 'create_finance_analytics_prod' was properly closed.
[0m14:48:34.613083 [debug] [MainThread]: Connection 'list_finance_analytics_prod' was properly closed.
[0m14:48:34.613350 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_stocks' was properly closed.
[0m14:48:34.613615 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m14:48:34.613967 [info ] [MainThread]: 
[0m14:48:34.614519 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m14:48:34.616101 [debug] [MainThread]: Command end result
[0m14:48:34.644235 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:48:34.647221 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:48:34.654773 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m14:48:34.655182 [info ] [MainThread]: 
[0m14:48:34.655814 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:48:34.656519 [info ] [MainThread]: 
[0m14:48:34.657230 [error] [MainThread]: [31mFailure in model src_stocks (models\bronze\src_stocks.sql)[0m
[0m14:48:34.657911 [error] [MainThread]:   Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^
[0m14:48:34.659019 [info ] [MainThread]: 
[0m14:48:34.659798 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\bronze\src_stocks.sql
[0m14:48:34.660398 [info ] [MainThread]: 
[0m14:48:34.660899 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m14:48:34.662211 [debug] [MainThread]: Command `-c run` failed at 14:48:34.661964 after 4.26 seconds
[0m14:48:34.662844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A000C24D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A000F56D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7E4BBB60>]}
[0m14:48:34.663448 [debug] [MainThread]: Flushing usage events
[0m14:48:35.319960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:48:54.063059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C084E8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C08CF42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C09337ED0>]}


============================== 14:48:54.067582 | c9c2ad72-85e8-40be-b214-9ef8f32ce8c4 ==============================
[0m14:48:54.067582 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:48:54.068542 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt parse', 'printer_width': '80', 'write_json': 'True'}
[0m14:48:54.313823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9c2ad72-85e8-40be-b214-9ef8f32ce8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C086A0180>]}
[0m14:48:54.379559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9c2ad72-85e8-40be-b214-9ef8f32ce8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C091DB9B0>]}
[0m14:48:54.382204 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:48:54.628170 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:48:54.705334 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:48:54.705941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9c2ad72-85e8-40be-b214-9ef8f32ce8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0A441650>]}
[0m14:48:55.956655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9c2ad72-85e8-40be-b214-9ef8f32ce8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0A5BAE40>]}
[0m14:48:55.960906 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m14:48:56.027976 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:48:56.031160 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:48:56.032156 [debug] [MainThread]: Command `-c parse` succeeded at 14:48:56.032030 after 2.09 seconds
[0m14:48:56.032574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C091F3E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0A670C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0A82FEE0>]}
[0m14:48:56.032937 [debug] [MainThread]: Flushing usage events
[0m14:48:56.694280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:06.552791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3DDC8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3E5D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3EC17ED0>]}


============================== 14:50:06.557528 | 4799b82d-ea87-4fe1-b5db-edfc45a2191f ==============================
[0m14:50:06.557528 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:50:06.558247 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m14:50:06.817994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4799b82d-ea87-4fe1-b5db-edfc45a2191f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3DF80180>]}
[0m14:50:06.884180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4799b82d-ea87-4fe1-b5db-edfc45a2191f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3EABB9B0>]}
[0m14:50:06.886925 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:50:07.151310 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:50:07.280305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:07.280684 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:07.314825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4799b82d-ea87-4fe1-b5db-edfc45a2191f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3FD0F150>]}
[0m14:50:07.318514 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m14:50:07.402323 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:50:07.405088 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:50:07.405941 [debug] [MainThread]: Command `-c parse` succeeded at 14:50:07.405802 after 1.04 seconds
[0m14:50:07.406365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3EA43E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3D86C7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3EAD3E70>]}
[0m14:50:07.406768 [debug] [MainThread]: Flushing usage events
[0m14:50:08.137014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:18.927465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191DFF8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191E8042D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191EE47ED0>]}


============================== 14:50:18.932634 | fb3f3cfb-4482-441b-85f0-518ae232b0f3 ==============================
[0m14:50:18.932634 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:50:18.933696 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m14:50:19.203665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191E1B0180>]}
[0m14:50:19.274314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191ECEBAC0>]}
[0m14:50:19.276927 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:50:19.545401 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m14:50:19.625979 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:50:19.626762 [debug] [MainThread]: previous checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, current checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe
[0m14:50:19.627239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191FFE5750>]}
[0m14:50:20.994097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192015EE40>]}
[0m14:50:21.061447 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:50:21.064095 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:50:21.090915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219207A5A90>]}
[0m14:50:21.091461 [info ] [MainThread]: Found 2 models, 2 sources, 461 macros
[0m14:50:21.092061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219204A7C70>]}
[0m14:50:21.093899 [info ] [MainThread]: 
[0m14:50:21.094447 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:21.094902 [info ] [MainThread]: 
[0m14:50:21.095511 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:50:21.100463 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m14:50:21.188980 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m14:50:21.189380 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m14:50:21.189697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:22.637508 [debug] [ThreadPool]: SQL status: OK in 1.448 seconds
[0m14:50:22.639326 [debug] [ThreadPool]: On list_finance: Close
[0m14:50:22.640349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m14:50:22.640923 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m14:50:22.647177 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m14:50:22.647592 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m14:50:22.647909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:22.649678 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:50:22.651129 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m14:50:22.651496 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m14:50:22.652631 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:50:22.652976 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m14:50:22.653288 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m14:50:22.700762 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m14:50:22.701725 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m14:50:22.702066 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m14:50:22.702365 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m14:50:22.911032 [debug] [ThreadPool]: SQL status: OK in 0.208 seconds
[0m14:50:22.911849 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m14:50:22.913908 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m14:50:22.919712 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m14:50:22.920106 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m14:50:22.920394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:22.921595 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:50:22.921916 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m14:50:22.922230 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m14:50:22.947405 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m14:50:22.948763 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m14:50:22.950011 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m14:50:22.950413 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m14:50:22.951413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021920794D10>]}
[0m14:50:22.951962 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:22.952331 [debug] [MainThread]: On master: BEGIN
[0m14:50:22.952661 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:22.954196 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:50:22.954913 [debug] [MainThread]: On master: COMMIT
[0m14:50:22.955533 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:22.956124 [debug] [MainThread]: On master: COMMIT
[0m14:50:22.957254 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:50:22.957883 [debug] [MainThread]: On master: Close
[0m14:50:22.963593 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m14:50:22.964088 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m14:50:22.964654 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m14:50:22.965864 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m14:50:22.966248 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m14:50:22.973808 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m14:50:22.965181 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m14:50:22.974889 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m14:50:22.975395 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m14:50:22.978730 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m14:50:22.979865 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m14:50:23.005018 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m14:50:23.030366 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m14:50:23.031261 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m14:50:23.032455 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:50:23.033057 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m14:50:23.033445 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:23.034463 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:50:23.035007 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m14:50:23.035410 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:23.036192 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:50:23.036697 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:50:23.037111 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close"
from src
  );

[0m14:50:23.037773 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:50:23.038557 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:50:23.039408 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m14:50:23.106477 [debug] [Thread-2 (]: SQL status: OK in 0.069 seconds
[0m14:50:23.112835 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:50:23.113336 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m14:50:23.125256 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m14:50:23.128482 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:50:23.128931 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m14:50:23.170014 [debug] [Thread-2 (]: SQL status: OK in 0.056 seconds
[0m14:50:23.180114 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:50:23.180563 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:50:23.180940 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:50:23.183426 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m14:50:23.184711 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m14:50:23.188043 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:50:23.188424 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m14:50:23.285532 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m14:50:23.285987 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m14:50:23.291536 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:50:23.294260 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:50:23.294830 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m14:50:23.295305 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m14:50:23.348730 [debug] [Thread-2 (]: SQL status: OK in 0.053 seconds
[0m14:50:23.349339 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m14:50:23.351787 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m14:50:23.353258 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m14:50:23.356105 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192099D2E0>]}
[0m14:50:23.357185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191E130550>]}
[0m14:50:23.356836 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.39s]
[0m14:50:23.358686 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m14:50:23.358030 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.38s]
[0m14:50:23.359615 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m14:50:23.361377 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:23.361768 [debug] [MainThread]: On master: BEGIN
[0m14:50:23.362072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:23.363292 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:50:23.363701 [debug] [MainThread]: On master: COMMIT
[0m14:50:23.364043 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:23.364353 [debug] [MainThread]: On master: COMMIT
[0m14:50:23.365038 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:50:23.365405 [debug] [MainThread]: On master: Close
[0m14:50:23.365840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:23.366165 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m14:50:23.366442 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m14:50:23.366714 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m14:50:23.366983 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_stocks' was properly closed.
[0m14:50:23.367361 [info ] [MainThread]: 
[0m14:50:23.367922 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m14:50:23.369513 [debug] [MainThread]: Command end result
[0m14:50:23.397585 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:50:23.400189 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:50:23.407508 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m14:50:23.408049 [info ] [MainThread]: 
[0m14:50:23.408923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:23.409728 [info ] [MainThread]: 
[0m14:50:23.410379 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:50:23.411427 [debug] [MainThread]: Command `-c run` succeeded at 14:50:23.411275 after 4.62 seconds
[0m14:50:23.411823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191DA3C750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191E12FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191853F150>]}
[0m14:50:23.412195 [debug] [MainThread]: Flushing usage events
[0m14:50:24.184904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:57:40.918310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808018050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8088242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808E67ED0>]}


============================== 14:57:40.923891 | 47ecd736-1bfe-49ac-a2f9-14d8628c5446 ==============================
[0m14:57:40.923891 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:57:40.924582 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt clean', 'printer_width': '80', 'target_path': 'None'}
[0m14:57:41.061902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47ecd736-1bfe-49ac-a2f9-14d8628c5446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8081D0180>]}
[0m14:57:41.095718 [debug] [MainThread]: Command `-c clean` succeeded at 14:57:41.095524 after 0.37 seconds
[0m14:57:41.096147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808D0A470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808D09F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808D03B50>]}
[0m14:57:41.096560 [debug] [MainThread]: Flushing usage events
[0m14:57:41.866239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:13:42.051627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC7EC8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC86D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC8D17ED0>]}


============================== 18:13:42.056001 | 778e2293-7214-474e-b4f7-b4d7601ca520 ==============================
[0m18:13:42.056001 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:13:42.056784 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --target prod', 'printer_width': '80', 'target_path': 'None'}
[0m18:13:42.304019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC8080180>]}
[0m18:13:42.369313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC8BBBAC0>]}
[0m18:13:42.371978 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:13:42.624611 [debug] [MainThread]: checksum: fd5f499d60404c73e369f2149bd6aa6c74754a4e78aa98476ca57564d99f7088, vars: {}, profile: , target: prod, version: 1.10.13
[0m18:13:42.703106 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:13:42.703671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC9E15750>]}
[0m18:13:43.925897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC9F8EE40>]}
[0m18:13:43.988711 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:13:43.999904 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:13:44.048272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA6197F0>]}
[0m18:13:44.048755 [info ] [MainThread]: Found 2 models, 2 sources, 461 macros
[0m18:13:44.050762 [info ] [MainThread]: 
[0m18:13:44.051286 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m18:13:44.051746 [info ] [MainThread]: 
[0m18:13:44.052363 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:13:44.057504 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m18:13:44.133632 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m18:13:44.134025 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m18:13:44.134340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:45.359809 [debug] [ThreadPool]: SQL status: OK in 1.225 seconds
[0m18:13:45.361190 [debug] [ThreadPool]: On list_finance: Close
[0m18:13:45.361908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_prod)
[0m18:13:45.362378 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_prod"
"
[0m18:13:45.368133 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m18:13:45.368497 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m18:13:45.368803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:45.370276 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:45.371613 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m18:13:45.371929 [debug] [ThreadPool]: On create_finance_analytics_prod: BEGIN
[0m18:13:45.373109 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:45.373682 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m18:13:45.373999 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
    
        create schema if not exists "finance"."analytics_prod"
    
[0m18:13:45.424623 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m18:13:45.425570 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m18:13:45.425897 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m18:13:45.426194 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m18:13:45.473200 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m18:13:45.473619 [debug] [ThreadPool]: On create_finance_analytics_prod: Close
[0m18:13:45.475121 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_prod'
[0m18:13:45.480423 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m18:13:45.480839 [debug] [ThreadPool]: On list_finance_analytics_prod: BEGIN
[0m18:13:45.481153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:45.482374 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:45.482710 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m18:13:45.483043 [debug] [ThreadPool]: On list_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance_analytics_prod"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_prod'
    and lower(table_catalog) = 'finance'
  
[0m18:13:45.507574 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m18:13:45.509231 [debug] [ThreadPool]: On list_finance_analytics_prod: ROLLBACK
[0m18:13:45.510478 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_prod'
[0m18:13:45.510854 [debug] [ThreadPool]: On list_finance_analytics_prod: Close
[0m18:13:45.512183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA883380>]}
[0m18:13:45.512687 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:45.513019 [debug] [MainThread]: On master: BEGIN
[0m18:13:45.513334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:45.514557 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:45.514914 [debug] [MainThread]: On master: COMMIT
[0m18:13:45.515221 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:45.515511 [debug] [MainThread]: On master: COMMIT
[0m18:13:45.516113 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:45.516433 [debug] [MainThread]: On master: Close
[0m18:13:45.520779 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m18:13:45.521682 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m18:13:45.521311 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_prod.src_stocks .......................... [RUN]
[0m18:13:45.523268 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m18:13:45.523828 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m18:13:45.530855 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m18:13:45.522164 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_prod.src_vix ............................. [RUN]
[0m18:13:45.531605 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m18:13:45.531982 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m18:13:45.536797 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m18:13:45.539292 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m18:13:45.539923 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m18:13:45.569270 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m18:13:45.572445 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m18:13:45.575631 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.576153 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m18:13:45.576560 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:13:45.577387 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m18:13:45.577804 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m18:13:45.578167 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:13:45.578809 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:13:45.579196 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.579577 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_prod"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close"
from src
  );

[0m18:13:45.580234 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:45.580618 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m18:13:45.581008 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_prod"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m18:13:45.655677 [debug] [Thread-2 (]: SQL status: OK in 0.076 seconds
[0m18:13:45.656264 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m18:13:45.661965 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.664506 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m18:13:45.664945 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_prod"."src_vix" rename to "src_vix__dbt_backup"
[0m18:13:45.665389 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_prod"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m18:13:45.713777 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m18:13:45.716800 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.717193 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_prod"."src_vix__dbt_tmp" rename to "src_vix"
[0m18:13:45.717599 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m18:13:45.727514 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m18:13:45.727942 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m18:13:45.728287 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m18:13:45.765464 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m18:13:45.768662 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:13:45.769062 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.769403 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:13:45.856185 [debug] [Thread-2 (]: SQL status: OK in 0.086 seconds
[0m18:13:45.861310 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.861709 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_prod"."src_vix__dbt_backup" cascade
    
[0m18:13:45.862253 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m18:13:45.864497 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m18:13:45.864883 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_prod"."src_stocks__dbt_backup" cascade
    
[0m18:13:45.966596 [debug] [Thread-2 (]: SQL status: OK in 0.104 seconds
[0m18:13:45.968952 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m18:13:45.971379 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA66D850>]}
[0m18:13:45.972726 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m18:13:45.972171 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_prod.src_vix ........................ [[32mOK[0m in 0.44s]
[0m18:13:45.974325 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m18:13:45.974994 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m18:13:45.975611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCAA70680>]}
[0m18:13:45.976397 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_prod.src_stocks ..................... [[32mOK[0m in 0.45s]
[0m18:13:45.977185 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m18:13:45.978775 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:45.979172 [debug] [MainThread]: On master: BEGIN
[0m18:13:45.979481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:45.980676 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:45.981043 [debug] [MainThread]: On master: COMMIT
[0m18:13:45.981347 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:45.981635 [debug] [MainThread]: On master: COMMIT
[0m18:13:45.982236 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:45.982548 [debug] [MainThread]: On master: Close
[0m18:13:45.982977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:45.983324 [debug] [MainThread]: Connection 'create_finance_analytics_prod' was properly closed.
[0m18:13:45.983618 [debug] [MainThread]: Connection 'list_finance_analytics_prod' was properly closed.
[0m18:13:45.983893 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_stocks' was properly closed.
[0m18:13:45.984164 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m18:13:45.984521 [info ] [MainThread]: 
[0m18:13:45.985077 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m18:13:45.986492 [debug] [MainThread]: Command end result
[0m18:13:46.006912 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:13:46.009215 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:13:46.015501 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m18:13:46.015926 [info ] [MainThread]: 
[0m18:13:46.016785 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:46.017498 [info ] [MainThread]: 
[0m18:13:46.018025 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:13:46.018944 [debug] [MainThread]: Command `-c build` succeeded at 18:13:46.018820 after 4.15 seconds
[0m18:13:46.019328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA9AC690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA627EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA518D50>]}
[0m18:13:46.019739 [debug] [MainThread]: Flushing usage events
[0m18:13:46.744053 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:19.314869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001961FEB8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196206C42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019620D03ED0>]}


============================== 20:48:19.325571 | 111018e3-ab84-45ee-af77-7911f083b6ff ==============================
[0m20:48:19.325571 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:48:19.327224 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt parse', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m20:48:19.940469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '111018e3-ab84-45ee-af77-7911f083b6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019620070180>]}
[0m20:48:20.057180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '111018e3-ab84-45ee-af77-7911f083b6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019620BAB9B0>]}
[0m20:48:20.091711 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:48:21.053195 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:48:21.236985 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:48:21.238190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '111018e3-ab84-45ee-af77-7911f083b6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019621E31B50>]}
[0m20:48:26.470820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '111018e3-ab84-45ee-af77-7911f083b6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019621FAAE40>]}
[0m20:48:26.479955 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m20:48:26.611648 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:48:26.641702 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:48:26.644093 [debug] [MainThread]: Command `-c parse` succeeded at 20:48:26.643791 after 7.72 seconds
[0m20:48:26.644864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019620BC3E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019622064BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019622217EE0>]}
[0m20:48:26.645674 [debug] [MainThread]: Flushing usage events
[0m20:48:28.215030 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:53.782491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F1FA38050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F202442D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F20887ED0>]}


============================== 20:48:53.793818 | bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30 ==============================
[0m20:48:53.793818 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:48:53.795560 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select stg__rsi', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m20:48:54.356873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F1FBF0180>]}
[0m20:48:54.467255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F2072B9B0>]}
[0m20:48:54.471229 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:48:54.941820 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:48:55.207157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:48:55.208271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:48:55.313587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F2198B150>]}
[0m20:48:55.447471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:48:55.451584 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:48:55.497053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F206B3E30>]}
[0m20:48:55.497901 [info ] [MainThread]: Found 3 models, 2 sources, 461 macros
[0m20:48:55.498854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F21A23230>]}
[0m20:48:55.501625 [info ] [MainThread]: 
[0m20:48:55.502513 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:48:55.503444 [info ] [MainThread]: 
[0m20:48:55.504875 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:48:55.506867 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m20:49:01.393083 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m20:49:01.394072 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m20:49:01.394884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:03.709439 [debug] [ThreadPool]: SQL status: OK in 2.314 seconds
[0m20:49:03.712988 [debug] [ThreadPool]: On list_finance: Close
[0m20:49:03.714750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m20:49:03.716081 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m20:49:03.731367 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:03.732321 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m20:49:03.733117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:03.736915 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:49:03.740273 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:03.741138 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m20:49:03.743837 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:49:03.744722 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:03.745520 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m20:49:03.817884 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m20:49:03.822096 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:03.823801 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:03.825449 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:03.896702 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m20:49:03.897456 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m20:49:03.906390 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m20:49:03.916764 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:03.917348 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m20:49:03.917818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:03.919549 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:49:03.920113 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:03.920636 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m20:49:03.961650 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m20:49:03.963840 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m20:49:03.994839 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m20:49:03.995429 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m20:49:03.997404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F2208B380>]}
[0m20:49:03.998164 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:03.998699 [debug] [MainThread]: On master: BEGIN
[0m20:49:03.999172 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:04.000925 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:49:04.001504 [debug] [MainThread]: On master: COMMIT
[0m20:49:04.002012 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:04.002498 [debug] [MainThread]: On master: COMMIT
[0m20:49:04.003604 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:04.004292 [debug] [MainThread]: On master: Close
[0m20:49:04.010675 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__rsi
[0m20:49:04.011582 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.stg__rsi ............................. [RUN]
[0m20:49:04.013160 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__rsi'
[0m20:49:04.013877 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__rsi
[0m20:49:04.025832 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__rsi"
[0m20:49:04.028333 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__rsi
[0m20:49:04.079470 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__rsi"
[0m20:49:04.081471 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:04.082124 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: BEGIN
[0m20:49:04.082706 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:49:04.084937 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:04.085721 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:04.086481 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


with recursive wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:04.115069 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


with recursive wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:04.116013 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:49:04.117453 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: ROLLBACK
[0m20:49:04.352567 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.stg__rsi'
[0m20:49:04.353591 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: Close
[0m20:49:04.363452 [debug] [Thread-1 (]: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "with"
  
  LINE 78: with recursive wilder as (
           ^
[0m20:49:04.368545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F220F8650>]}
[0m20:49:04.370251 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.stg__rsi .................... [[31mERROR[0m in 0.35s]
[0m20:49:04.372346 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__rsi
[0m20:49:04.373941 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.stg__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "with"
  
  LINE 78: with recursive wilder as (
           ^.
[0m20:49:04.378701 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:04.379607 [debug] [MainThread]: On master: BEGIN
[0m20:49:04.380380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:04.383014 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m20:49:04.383880 [debug] [MainThread]: On master: COMMIT
[0m20:49:04.384701 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:04.385505 [debug] [MainThread]: On master: COMMIT
[0m20:49:04.387243 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:04.388490 [debug] [MainThread]: On master: Close
[0m20:49:04.389642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:04.390438 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m20:49:04.391168 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m20:49:04.391877 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__rsi' was properly closed.
[0m20:49:04.392639 [info ] [MainThread]: 
[0m20:49:04.394042 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m20:49:04.396215 [debug] [MainThread]: Command end result
[0m20:49:04.444186 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:49:04.447829 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:49:04.459718 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m20:49:04.460368 [info ] [MainThread]: 
[0m20:49:04.461236 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:49:04.462076 [info ] [MainThread]: 
[0m20:49:04.463005 [error] [MainThread]: [31mFailure in model stg__rsi (models\silver\stg__rsi.sql)[0m
[0m20:49:04.463910 [error] [MainThread]:   Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "with"
  
  LINE 78: with recursive wilder as (
           ^
[0m20:49:04.464695 [info ] [MainThread]: 
[0m20:49:04.465516 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\stg__rsi.sql
[0m20:49:04.466274 [info ] [MainThread]: 
[0m20:49:04.467229 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:49:04.468769 [debug] [MainThread]: Command `-c run` failed at 20:49:04.468544 after 10.97 seconds
[0m20:49:04.469439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F220D5BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F221E5D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F221E7C50>]}
[0m20:49:04.470038 [debug] [MainThread]: Flushing usage events
[0m20:49:05.703591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:21.808901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780BE28050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780C6342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780CC77ED0>]}


============================== 20:49:21.815658 | b0342c31-503d-4727-b873-0681fcb97da8 ==============================
[0m20:49:21.815658 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:49:21.816743 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select stg__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m20:49:22.338093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780BFE0180>]}
[0m20:49:22.456812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780CB1B9B0>]}
[0m20:49:22.461293 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:49:23.045476 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:49:23.190228 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:49:23.191265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780DD89B50>]}
[0m20:49:25.273143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780DEFEE40>]}
[0m20:49:25.373088 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:49:25.376269 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:49:25.416548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E541C50>]}
[0m20:49:25.417249 [info ] [MainThread]: Found 3 models, 2 sources, 461 macros
[0m20:49:25.418243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E167C70>]}
[0m20:49:25.420617 [info ] [MainThread]: 
[0m20:49:25.421393 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:49:25.422119 [info ] [MainThread]: 
[0m20:49:25.423099 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:49:25.424628 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m20:49:25.560364 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m20:49:25.561000 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m20:49:25.561527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:27.654626 [debug] [ThreadPool]: SQL status: OK in 2.093 seconds
[0m20:49:27.658365 [debug] [ThreadPool]: On list_finance: Close
[0m20:49:27.660071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m20:49:27.661470 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m20:49:27.675472 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:27.676314 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m20:49:27.677163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:27.680810 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:49:27.684124 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:27.684959 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m20:49:27.687556 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:49:27.688431 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:27.689277 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m20:49:27.751837 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m20:49:27.754173 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:27.755028 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:27.755799 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:27.807902 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m20:49:27.808899 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m20:49:27.822002 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m20:49:27.836589 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:27.837480 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m20:49:27.838238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:27.840908 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:49:27.841714 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:27.842538 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m20:49:27.897035 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m20:49:27.899170 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m20:49:27.900695 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m20:49:27.901182 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m20:49:27.903201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E52DE50>]}
[0m20:49:27.904106 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:27.904693 [debug] [MainThread]: On master: BEGIN
[0m20:49:27.905306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:27.907505 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:49:27.908205 [debug] [MainThread]: On master: COMMIT
[0m20:49:27.908881 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:27.909563 [debug] [MainThread]: On master: COMMIT
[0m20:49:27.910841 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:27.911457 [debug] [MainThread]: On master: Close
[0m20:49:27.919392 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__rsi
[0m20:49:27.920523 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.stg__rsi ............................. [RUN]
[0m20:49:27.921802 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__rsi'
[0m20:49:27.922515 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__rsi
[0m20:49:27.936105 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__rsi"
[0m20:49:27.937747 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__rsi
[0m20:49:27.997293 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__rsi"
[0m20:49:27.999033 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:27.999770 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: BEGIN
[0m20:49:28.000444 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:49:28.003012 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:28.003767 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:28.004716 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


recursive wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:28.031878 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


recursive wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:28.033097 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:49:28.033994 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: ROLLBACK
[0m20:49:28.046646 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.stg__rsi'
[0m20:49:28.047408 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: Close
[0m20:49:28.057213 [debug] [Thread-1 (]: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "wilder"
  
  LINE 78: recursive wilder as (
                     ^
[0m20:49:28.060850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E7495A0>]}
[0m20:49:28.062081 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.stg__rsi .................... [[31mERROR[0m in 0.14s]
[0m20:49:28.063647 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__rsi
[0m20:49:28.064854 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.stg__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "wilder"
  
  LINE 78: recursive wilder as (
                     ^.
[0m20:49:28.068444 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:28.069112 [debug] [MainThread]: On master: BEGIN
[0m20:49:28.069707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:28.071967 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:49:28.073028 [debug] [MainThread]: On master: COMMIT
[0m20:49:28.073690 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:28.074269 [debug] [MainThread]: On master: COMMIT
[0m20:49:28.075484 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:28.076106 [debug] [MainThread]: On master: Close
[0m20:49:28.076856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:28.077402 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m20:49:28.077931 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m20:49:28.078443 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__rsi' was properly closed.
[0m20:49:28.079015 [info ] [MainThread]: 
[0m20:49:28.079896 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m20:49:28.081581 [debug] [MainThread]: Command end result
[0m20:49:28.127657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:49:28.131797 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:49:28.143095 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m20:49:28.143736 [info ] [MainThread]: 
[0m20:49:28.144816 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:49:28.145723 [info ] [MainThread]: 
[0m20:49:28.146768 [error] [MainThread]: [31mFailure in model stg__rsi (models\silver\stg__rsi.sql)[0m
[0m20:49:28.147986 [error] [MainThread]:   Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "wilder"
  
  LINE 78: recursive wilder as (
                     ^
[0m20:49:28.148905 [info ] [MainThread]: 
[0m20:49:28.149965 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\stg__rsi.sql
[0m20:49:28.150794 [info ] [MainThread]: 
[0m20:49:28.151671 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:49:28.153336 [debug] [MainThread]: Command `-c run` failed at 20:49:28.153103 after 6.53 seconds
[0m20:49:28.154215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E51A530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E54DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E722C50>]}
[0m20:49:28.155532 [debug] [MainThread]: Flushing usage events
[0m20:49:29.436579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:42.038086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FFA28050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1812E42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F181923ED0>]}


============================== 20:49:42.045560 | 5ea5a74c-428f-4309-ac17-91512b519e1f ==============================
[0m20:49:42.045560 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:49:42.046942 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt run --select stg__rsi', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m20:49:42.451743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FFBE0180>]}
[0m20:49:42.570146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1817CB9B0>]}
[0m20:49:42.575815 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:49:43.014978 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:49:43.187376 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:49:43.188428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F182A71B50>]}
[0m20:49:45.780008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F182BEAE40>]}
[0m20:49:45.888411 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:49:45.892049 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:49:45.942408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F183235C50>]}
[0m20:49:45.943312 [info ] [MainThread]: Found 3 models, 2 sources, 461 macros
[0m20:49:45.944300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F182E53C70>]}
[0m20:49:45.947326 [info ] [MainThread]: 
[0m20:49:45.948417 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:49:45.949331 [info ] [MainThread]: 
[0m20:49:45.950582 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:49:45.952481 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m20:49:46.108798 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m20:49:46.109526 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m20:49:46.110137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:47.713087 [debug] [ThreadPool]: SQL status: OK in 1.603 seconds
[0m20:49:47.716754 [debug] [ThreadPool]: On list_finance: Close
[0m20:49:47.718901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m20:49:47.720184 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m20:49:47.735864 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:47.737252 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m20:49:47.738120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:47.741779 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:49:47.745396 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:47.746287 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m20:49:47.748800 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:49:47.749677 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:47.750498 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m20:49:47.817504 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m20:49:47.819799 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:47.820707 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:47.821507 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:47.894450 [debug] [ThreadPool]: SQL status: OK in 0.072 seconds
[0m20:49:47.895473 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m20:49:47.908991 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m20:49:47.922883 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:47.923800 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m20:49:47.924694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:47.927550 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:49:47.928452 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:47.929277 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m20:49:47.993610 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m20:49:47.997025 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m20:49:47.999590 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m20:49:48.000359 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m20:49:48.002955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F183225E50>]}
[0m20:49:48.004149 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:48.004781 [debug] [MainThread]: On master: BEGIN
[0m20:49:48.005406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:48.007969 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m20:49:48.008809 [debug] [MainThread]: On master: COMMIT
[0m20:49:48.009476 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:48.010100 [debug] [MainThread]: On master: COMMIT
[0m20:49:48.011405 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:48.012098 [debug] [MainThread]: On master: Close
[0m20:49:48.020839 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__rsi
[0m20:49:48.021989 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.stg__rsi ............................. [RUN]
[0m20:49:48.023824 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__rsi'
[0m20:49:48.024750 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__rsi
[0m20:49:48.039293 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__rsi"
[0m20:49:48.041575 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__rsi
[0m20:49:48.109369 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__rsi"
[0m20:49:48.111356 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:48.112910 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: BEGIN
[0m20:49:48.113816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:49:48.116718 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:48.117615 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:48.118736 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:48.200449 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:48.201639 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:49:48.202589 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: ROLLBACK
[0m20:49:48.217589 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.stg__rsi'
[0m20:49:48.218512 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: Close
[0m20:49:48.227877 [debug] [Thread-1 (]: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Binder Error: Referenced column "loaded_at" not found in FROM clause!
  Candidate bindings: "trade_date", "close", "daily_gain", "daily_change", "sma_gain"
  
  LINE 72: ...number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
                                                                         ^
[0m20:49:48.231783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1834394F0>]}
[0m20:49:48.233224 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.stg__rsi .................... [[31mERROR[0m in 0.21s]
[0m20:49:48.234924 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__rsi
[0m20:49:48.236261 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.stg__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Binder Error: Referenced column "loaded_at" not found in FROM clause!
  Candidate bindings: "trade_date", "close", "daily_gain", "daily_change", "sma_gain"
  
  LINE 72: ...number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
                                                                         ^.
[0m20:49:48.240693 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:48.241475 [debug] [MainThread]: On master: BEGIN
[0m20:49:48.242123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:48.244397 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:49:48.245098 [debug] [MainThread]: On master: COMMIT
[0m20:49:48.245766 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:48.246417 [debug] [MainThread]: On master: COMMIT
[0m20:49:48.247873 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:48.248623 [debug] [MainThread]: On master: Close
[0m20:49:48.249502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:48.250123 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m20:49:48.250720 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m20:49:48.251294 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__rsi' was properly closed.
[0m20:49:48.251917 [info ] [MainThread]: 
[0m20:49:48.252871 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m20:49:48.254653 [debug] [MainThread]: Command end result
[0m20:49:48.317301 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:49:48.322924 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:49:48.336327 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m20:49:48.337343 [info ] [MainThread]: 
[0m20:49:48.338745 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:49:48.339868 [info ] [MainThread]: 
[0m20:49:48.342006 [error] [MainThread]: [31mFailure in model stg__rsi (models\silver\stg__rsi.sql)[0m
[0m20:49:48.343393 [error] [MainThread]:   Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Binder Error: Referenced column "loaded_at" not found in FROM clause!
  Candidate bindings: "trade_date", "close", "daily_gain", "daily_change", "sma_gain"
  
  LINE 72: ...number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
                                                                         ^
[0m20:49:48.344621 [info ] [MainThread]: 
[0m20:49:48.346286 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\stg__rsi.sql
[0m20:49:48.347455 [info ] [MainThread]: 
[0m20:49:48.358514 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:49:48.374762 [debug] [MainThread]: Command `-c run` failed at 20:49:48.374190 after 6.54 seconds
[0m20:49:48.376429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18320E530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F183241D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FFB70F50>]}
[0m20:49:48.378174 [debug] [MainThread]: Flushing usage events
[0m20:49:49.834253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:25.119211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F43E88050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F446942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F44CD7ED0>]}


============================== 20:50:25.126201 | c1cc3688-3a5f-477b-b62f-c1e5310bff93 ==============================
[0m20:50:25.126201 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:50:25.127405 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select stg__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m20:50:25.497793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F44040180>]}
[0m20:50:25.593469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F44B7B9B0>]}
[0m20:50:25.597044 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:50:25.976212 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:50:26.095587 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:50:26.096449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F45DD9B50>]}
[0m20:50:27.956372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F45F4EE40>]}
[0m20:50:28.058459 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:50:28.061747 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:50:28.096517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F46595C50>]}
[0m20:50:28.097170 [info ] [MainThread]: Found 3 models, 2 sources, 461 macros
[0m20:50:28.097846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F461B3C70>]}
[0m20:50:28.099896 [info ] [MainThread]: 
[0m20:50:28.100595 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:50:28.101263 [info ] [MainThread]: 
[0m20:50:28.102166 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:50:28.103652 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m20:50:28.234893 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m20:50:28.235515 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m20:50:28.236031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:29.915685 [debug] [ThreadPool]: SQL status: OK in 1.679 seconds
[0m20:50:29.919089 [debug] [ThreadPool]: On list_finance: Close
[0m20:50:29.921117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m20:50:29.922412 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m20:50:29.937430 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:50:29.938346 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m20:50:29.939144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:29.942873 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:50:29.946389 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:50:29.947226 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m20:50:29.949743 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:50:29.950560 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:50:29.951351 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m20:50:30.022548 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m20:50:30.025105 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:50:30.026189 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:50:30.027005 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:50:30.089333 [debug] [ThreadPool]: SQL status: OK in 0.061 seconds
[0m20:50:30.090290 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m20:50:30.103292 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m20:50:30.117077 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:50:30.117984 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m20:50:30.118739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:30.121459 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:50:30.122308 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:50:30.123181 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m20:50:30.184419 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m20:50:30.187258 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m20:50:30.189309 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m20:50:30.189956 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m20:50:30.192512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4657DE50>]}
[0m20:50:30.193308 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:30.193893 [debug] [MainThread]: On master: BEGIN
[0m20:50:30.194380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:30.196257 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:50:30.196790 [debug] [MainThread]: On master: COMMIT
[0m20:50:30.197365 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:30.197855 [debug] [MainThread]: On master: COMMIT
[0m20:50:30.198870 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:50:30.199401 [debug] [MainThread]: On master: Close
[0m20:50:30.206117 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__rsi
[0m20:50:30.206979 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.stg__rsi ............................. [RUN]
[0m20:50:30.208145 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__rsi'
[0m20:50:30.208789 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__rsi
[0m20:50:30.220055 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__rsi"
[0m20:50:30.221506 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__rsi
[0m20:50:30.270261 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__rsi"
[0m20:50:30.271716 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:50:30.272323 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: BEGIN
[0m20:50:30.272886 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:50:30.275800 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:50:30.276493 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:50:30.277305 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        loaded_at,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:50:30.359519 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        loaded_at,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:50:30.360547 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:50:30.361402 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: ROLLBACK
[0m20:50:30.373376 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.stg__rsi'
[0m20:50:30.374452 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: Close
[0m20:50:30.381896 [debug] [Thread-1 (]: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Catalog Error: Table with name wilder does not exist!
  Did you mean "pg_index"?
  
  LINE 104:     join wilder prev
                     ^
[0m20:50:30.385086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F467995A0>]}
[0m20:50:30.386169 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.stg__rsi .................... [[31mERROR[0m in 0.17s]
[0m20:50:30.387440 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__rsi
[0m20:50:30.388448 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.stg__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Catalog Error: Table with name wilder does not exist!
  Did you mean "pg_index"?
  
  LINE 104:     join wilder prev
                     ^.
[0m20:50:30.391447 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:30.392025 [debug] [MainThread]: On master: BEGIN
[0m20:50:30.392523 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:30.394407 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:50:30.395008 [debug] [MainThread]: On master: COMMIT
[0m20:50:30.395563 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:30.396040 [debug] [MainThread]: On master: COMMIT
[0m20:50:30.397004 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:50:30.397510 [debug] [MainThread]: On master: Close
[0m20:50:30.398352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:30.399264 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m20:50:30.399921 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m20:50:30.400365 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__rsi' was properly closed.
[0m20:50:30.400854 [info ] [MainThread]: 
[0m20:50:30.401550 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m20:50:30.402948 [debug] [MainThread]: Command end result
[0m20:50:30.441501 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:50:30.445051 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:50:30.455340 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m20:50:30.455970 [info ] [MainThread]: 
[0m20:50:30.456990 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:50:30.457837 [info ] [MainThread]: 
[0m20:50:30.458811 [error] [MainThread]: [31mFailure in model stg__rsi (models\silver\stg__rsi.sql)[0m
[0m20:50:30.459778 [error] [MainThread]:   Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Catalog Error: Table with name wilder does not exist!
  Did you mean "pg_index"?
  
  LINE 104:     join wilder prev
                     ^
[0m20:50:30.460874 [info ] [MainThread]: 
[0m20:50:30.462368 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\stg__rsi.sql
[0m20:50:30.463292 [info ] [MainThread]: 
[0m20:50:30.464209 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:50:30.465801 [debug] [MainThread]: Command `-c run` failed at 20:50:30.465567 after 5.55 seconds
[0m20:50:30.466541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F46562530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4659DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F46772C50>]}
[0m20:50:30.467258 [debug] [MainThread]: Flushing usage events
[0m20:50:31.464541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:42.759070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021933098050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219338A42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021933EE3ED0>]}


============================== 12:38:42.765569 | c3c0a9d0-7cbd-4c4b-8e01-dd920b403997 ==============================
[0m12:38:42.765569 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:38:42.766237 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m12:38:43.188944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3c0a9d0-7cbd-4c4b-8e01-dd920b403997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021933250180>]}
[0m12:38:43.252910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3c0a9d0-7cbd-4c4b-8e01-dd920b403997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021933D8B9B0>]}
[0m12:38:43.271380 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:38:43.687760 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:38:43.765406 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:38:43.766066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3c0a9d0-7cbd-4c4b-8e01-dd920b403997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021934FDDB50>]}
[0m12:38:46.187167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3c0a9d0-7cbd-4c4b-8e01-dd920b403997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193515EE40>]}
[0m12:38:46.191038 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m12:38:46.260167 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:38:46.283619 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:38:46.284420 [debug] [MainThread]: Command `-c parse` succeeded at 12:38:46.284300 after 3.70 seconds
[0m12:38:46.284784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021933DA3E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021935210C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219353C7EE0>]}
[0m12:38:46.285144 [debug] [MainThread]: Flushing usage events
[0m12:38:47.035873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:36.728689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132C608050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132CE142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D457ED0>]}


============================== 12:39:36.732893 | 1647c0db-536d-40d7-9ec6-dccf16440c45 ==============================
[0m12:39:36.732893 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:39:36.733529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'invocation_command': 'dbt clean', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m12:39:36.867135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1647c0db-536d-40d7-9ec6-dccf16440c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132C7C0180>]}
[0m12:39:36.901861 [debug] [MainThread]: Command `-c clean` succeeded at 12:39:36.901696 after 0.30 seconds
[0m12:39:36.902268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D2FA470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D2F9F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D2F3A50>]}
[0m12:39:36.902648 [debug] [MainThread]: Flushing usage events
[0m12:39:37.819313 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:41.068807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE659A8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE661B42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE667F3ED0>]}


============================== 12:39:41.073626 | 3479392e-08f1-424d-bf45-fff4c452d3b3 ==============================
[0m12:39:41.073626 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:39:41.074544 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt parse', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m12:39:41.353453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3479392e-08f1-424d-bf45-fff4c452d3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE65B60180>]}
[0m12:39:41.418345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3479392e-08f1-424d-bf45-fff4c452d3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6669B9B0>]}
[0m12:39:41.420938 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:39:41.661486 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:39:41.662444 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:39:41.663010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3479392e-08f1-424d-bf45-fff4c452d3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE66911350>]}
[0m12:39:42.884989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3479392e-08f1-424d-bf45-fff4c452d3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE67ADEE40>]}
[0m12:39:42.888969 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m12:39:42.966614 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:39:42.968975 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:39:42.969858 [debug] [MainThread]: Command `-c parse` succeeded at 12:39:42.969737 after 2.02 seconds
[0m12:39:42.970228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE5FE302F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE67F24AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE67E13EE0>]}
[0m12:39:42.970590 [debug] [MainThread]: Flushing usage events
[0m12:39:43.784187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:00.128484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FB0D8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FB8E42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FBF27ED0>]}


============================== 12:40:00.132848 | 5e845d5e-fc7e-42ff-985c-0dcb8db987d7 ==============================
[0m12:40:00.132848 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:40:00.133538 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_rsi', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m12:40:00.370288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e845d5e-fc7e-42ff-985c-0dcb8db987d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FB290180>]}
[0m12:40:00.434405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e845d5e-fc7e-42ff-985c-0dcb8db987d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FBDCB9B0>]}
[0m12:40:00.436841 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:40:00.681818 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:40:00.807443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:00.807801 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:00.841419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e845d5e-fc7e-42ff-985c-0dcb8db987d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FD017350>]}
[0m12:40:00.913734 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:00.916261 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:00.953083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e845d5e-fc7e-42ff-985c-0dcb8db987d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FBD53E30>]}
[0m12:40:00.953574 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:40:00.954086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e845d5e-fc7e-42ff-985c-0dcb8db987d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FD0B3230>]}
[0m12:40:00.954996 [warn ] [MainThread]: The selection criterion 'fct_rsi' does not match any enabled nodes
[0m12:40:00.956340 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:40:00.958533 [debug] [MainThread]: Command end result
[0m12:40:00.979395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:00.982239 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:00.986575 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:40:00.987903 [debug] [MainThread]: Command `-c run` succeeded at 12:40:00.987728 after 0.99 seconds
[0m12:40:00.988541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FD5D7D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FBD1B1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FD59F7D0>]}
[0m12:40:00.989205 [debug] [MainThread]: Flushing usage events
[0m12:40:01.829410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:10.259052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266366C8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026636ED42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026637517ED0>]}


============================== 12:40:10.263478 | abaabc25-e582-4b7d-afb3-3971ac46d6e2 ==============================
[0m12:40:10.263478 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:40:10.264186 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select fct__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m12:40:10.506114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026636880180>]}
[0m12:40:10.570624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266373BB9B0>]}
[0m12:40:10.573177 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:40:10.823913 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:40:10.936860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:10.937209 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:10.970132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638617350>]}
[0m12:40:11.040547 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:11.042772 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:11.068722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026637343E30>]}
[0m12:40:11.069181 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:40:11.069812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266386AF230>]}
[0m12:40:11.071288 [info ] [MainThread]: 
[0m12:40:11.071879 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:11.072427 [info ] [MainThread]: 
[0m12:40:11.073229 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:40:11.074248 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:40:13.709721 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:40:13.710105 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m12:40:13.710414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:21.676716 [debug] [ThreadPool]: SQL status: OK in 7.966 seconds
[0m12:40:21.678466 [debug] [ThreadPool]: On list_finance: Close
[0m12:40:21.679299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:40:21.680001 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:40:21.686602 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:21.687023 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m12:40:21.687333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:21.689338 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:40:21.690894 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:21.691279 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:40:21.692441 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:40:21.692786 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:21.693122 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m12:40:21.753475 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m12:40:21.754503 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:40:21.754897 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:21.755241 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:40:21.803452 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m12:40:21.803907 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:40:21.810016 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:40:21.816153 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:40:21.816651 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:40:21.817011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:21.818950 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:40:21.819372 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:40:21.819720 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m12:40:21.854238 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m12:40:21.856773 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:40:21.872256 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:40:21.872929 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:40:21.874589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638D0BA00>]}
[0m12:40:21.875180 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:21.875496 [debug] [MainThread]: On master: BEGIN
[0m12:40:21.875786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:21.876881 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:40:21.877212 [debug] [MainThread]: On master: COMMIT
[0m12:40:21.877518 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:21.877809 [debug] [MainThread]: On master: COMMIT
[0m12:40:21.878388 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:40:21.878702 [debug] [MainThread]: On master: Close
[0m12:40:21.884162 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:40:21.884741 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:40:21.885472 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.fct__rsi'
[0m12:40:21.885865 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:40:21.893083 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:40:21.894872 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:40:21.928959 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:40:21.930978 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:40:21.931448 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:40:21.931820 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:21.933182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:40:21.933604 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:40:21.934042 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:40:22.079976 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:40:22.080595 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:40:22.081084 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: ROLLBACK
[0m12:40:22.208768 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.fct__rsi'
[0m12:40:22.209207 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:40:22.213613 [debug] [Thread-1 (]: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^
[0m12:40:22.215638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638D950D0>]}
[0m12:40:22.216264 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.fct__rsi .................... [[31mERROR[0m in 0.33s]
[0m12:40:22.217070 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:40:22.217669 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^.
[0m12:40:22.219613 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:22.219945 [debug] [MainThread]: On master: BEGIN
[0m12:40:22.220244 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:22.221641 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:40:22.221969 [debug] [MainThread]: On master: COMMIT
[0m12:40:22.222262 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:22.222542 [debug] [MainThread]: On master: COMMIT
[0m12:40:22.223396 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:40:22.223770 [debug] [MainThread]: On master: Close
[0m12:40:22.224162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:22.224434 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:40:22.224691 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:40:22.224949 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:40:22.225243 [info ] [MainThread]: 
[0m12:40:22.225760 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 11.15 seconds (11.15s).
[0m12:40:22.226636 [debug] [MainThread]: Command end result
[0m12:40:22.251137 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:22.253738 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:22.260308 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:40:22.260907 [info ] [MainThread]: 
[0m12:40:22.261759 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:40:22.262676 [info ] [MainThread]: 
[0m12:40:22.263497 [error] [MainThread]: [31mFailure in model fct__rsi (models\gold\fct__rsi.sql)[0m
[0m12:40:22.264280 [error] [MainThread]:   Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^
[0m12:40:22.265090 [info ] [MainThread]: 
[0m12:40:22.265866 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\fct__rsi.sql
[0m12:40:22.266436 [info ] [MainThread]: 
[0m12:40:22.267105 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:40:22.268481 [debug] [MainThread]: Command `-c run` failed at 12:40:22.268313 after 12.13 seconds
[0m12:40:22.268994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638D6CF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638E6A2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638E69E50>]}
[0m12:40:22.269692 [debug] [MainThread]: Flushing usage events
[0m12:40:23.094324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:53.908356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F2128050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F29342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F2F77ED0>]}


============================== 12:40:53.912510 | ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb ==============================
[0m12:40:53.912510 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:40:53.913146 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select *fct__rsi', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m12:40:54.149646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F22E0180>]}
[0m12:40:54.213414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F2E1B9B0>]}
[0m12:40:54.215766 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:40:54.465868 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:40:54.581338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:54.581689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:54.614989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F4167350>]}
[0m12:40:54.686014 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:54.688215 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:54.715383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F2E0B2F0>]}
[0m12:40:54.715863 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:40:54.716362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F4203230>]}
[0m12:40:54.717895 [info ] [MainThread]: 
[0m12:40:54.718429 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:54.718886 [info ] [MainThread]: 
[0m12:40:54.719515 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:40:54.720436 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:40:54.802501 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:40:54.802896 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m12:40:54.803210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:56.512850 [debug] [ThreadPool]: SQL status: OK in 1.710 seconds
[0m12:40:56.514368 [debug] [ThreadPool]: On list_finance: Close
[0m12:40:56.515164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:40:56.515630 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:40:56.521483 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:56.521822 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m12:40:56.522132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:56.523709 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:40:56.525021 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:56.525349 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:40:56.526404 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:40:56.526726 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:56.527031 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m12:40:56.579257 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m12:40:56.580218 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:40:56.580553 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:56.580855 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:40:56.743806 [debug] [ThreadPool]: SQL status: OK in 0.163 seconds
[0m12:40:56.744217 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:40:56.749726 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:40:56.755112 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:40:56.755463 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:40:56.755747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:56.756926 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:40:56.757274 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:40:56.757576 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m12:40:56.780497 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:40:56.781835 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:40:56.782858 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:40:56.783165 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:40:56.784382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F485BA00>]}
[0m12:40:56.784935 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:56.785231 [debug] [MainThread]: On master: BEGIN
[0m12:40:56.785509 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:56.786743 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:40:56.787098 [debug] [MainThread]: On master: COMMIT
[0m12:40:56.787414 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:56.787716 [debug] [MainThread]: On master: COMMIT
[0m12:40:56.788398 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:40:56.788712 [debug] [MainThread]: On master: Close
[0m12:40:56.793315 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:40:56.793843 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:40:56.794671 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.fct__rsi'
[0m12:40:56.795068 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:40:56.801834 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:40:56.802783 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:40:56.833900 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:40:56.834876 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:40:56.835258 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:40:56.835604 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:56.836946 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:40:56.837325 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:40:56.837744 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:40:56.898187 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:40:56.898713 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:40:56.899190 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: ROLLBACK
[0m12:40:56.905891 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.fct__rsi'
[0m12:40:56.906301 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:40:56.910648 [debug] [Thread-1 (]: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^
[0m12:40:56.912685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F48E50D0>]}
[0m12:40:56.913315 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.fct__rsi .................... [[31mERROR[0m in 0.12s]
[0m12:40:56.914131 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:40:56.914741 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^.
[0m12:40:56.916574 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:56.916905 [debug] [MainThread]: On master: BEGIN
[0m12:40:56.917210 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:56.918468 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:40:56.918877 [debug] [MainThread]: On master: COMMIT
[0m12:40:56.919182 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:56.919469 [debug] [MainThread]: On master: COMMIT
[0m12:40:56.920038 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:40:56.920354 [debug] [MainThread]: On master: Close
[0m12:40:56.920741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:56.921019 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:40:56.921291 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:40:56.921554 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:40:56.921851 [info ] [MainThread]: 
[0m12:40:56.922335 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m12:40:56.923213 [debug] [MainThread]: Command end result
[0m12:40:56.944507 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:56.947271 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:56.953780 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:40:56.954144 [info ] [MainThread]: 
[0m12:40:56.954674 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:40:56.955201 [info ] [MainThread]: 
[0m12:40:56.955753 [error] [MainThread]: [31mFailure in model fct__rsi (models\gold\fct__rsi.sql)[0m
[0m12:40:56.956306 [error] [MainThread]:   Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^
[0m12:40:56.956796 [info ] [MainThread]: 
[0m12:40:56.957332 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\fct__rsi.sql
[0m12:40:56.957820 [info ] [MainThread]: 
[0m12:40:56.958366 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:40:56.959298 [debug] [MainThread]: Command `-c run` failed at 12:40:56.959180 after 3.17 seconds
[0m12:40:56.959737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F48BCF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F49E2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F4A6D1D0>]}
[0m12:40:56.960127 [debug] [MainThread]: Flushing usage events
[0m12:40:57.864414 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:57.843528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A72F88050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A737942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73DD7ED0>]}


============================== 12:41:57.847975 | e7d7796d-4b55-4b47-a15a-f8a95b482e95 ==============================
[0m12:41:57.847975 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:41:57.848740 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --select +fct__rsi', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m12:41:58.112028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73140180>]}
[0m12:41:58.183530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73C7B9B0>]}
[0m12:41:58.186204 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:41:58.454718 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:41:58.587532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:41:58.587908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:41:58.625981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A74F17350>]}
[0m12:41:58.708661 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:41:58.711062 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:41:58.740641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73C03E30>]}
[0m12:41:58.741256 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:41:58.741893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A74FB3230>]}
[0m12:41:58.743768 [info ] [MainThread]: 
[0m12:41:58.744464 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:41:58.745130 [info ] [MainThread]: 
[0m12:41:58.745982 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:41:58.751156 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:41:58.839439 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:41:58.839860 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m12:41:58.840179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:00.469764 [debug] [ThreadPool]: SQL status: OK in 1.629 seconds
[0m12:42:00.471209 [debug] [ThreadPool]: On list_finance: Close
[0m12:42:00.472029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:42:00.472636 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:42:00.479805 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:00.480182 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m12:42:00.480480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:00.482145 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:42:00.483430 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:00.483738 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:42:00.484706 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:00.485004 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:00.485294 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m12:42:00.542873 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m12:42:00.544076 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:00.544460 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:00.544772 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:00.591328 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m12:42:00.591742 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:42:00.593552 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:42:00.598908 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:00.599264 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:42:00.599556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:00.600675 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:00.600989 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:00.601303 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m12:42:00.624553 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:42:00.626009 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:42:00.627082 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:42:00.627416 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:42:00.628667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7560FA00>]}
[0m12:42:00.629157 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:00.629487 [debug] [MainThread]: On master: BEGIN
[0m12:42:00.629795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:00.630976 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:00.631323 [debug] [MainThread]: On master: COMMIT
[0m12:42:00.631664 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:00.631957 [debug] [MainThread]: On master: COMMIT
[0m12:42:00.632550 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:00.632863 [debug] [MainThread]: On master: Close
[0m12:42:00.637368 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m12:42:00.637903 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m12:42:00.638595 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m12:42:00.638978 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m12:42:00.645920 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m12:42:00.648050 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m12:42:00.681649 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m12:42:00.683194 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.683653 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m12:42:00.684029 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:00.685431 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:00.685811 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.686180 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m12:42:00.733917 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m12:42:00.739562 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.739989 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m12:42:00.803755 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m12:42:00.806384 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.806767 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m12:42:00.847442 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m12:42:00.859720 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:00.860172 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.860545 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:00.977443 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m12:42:00.982506 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.982885 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m12:42:01.088978 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m12:42:01.091296 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m12:42:01.093636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A75675CD0>]}
[0m12:42:01.094350 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.45s]
[0m12:42:01.095241 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m12:42:01.096005 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m12:42:01.096477 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_dev.int__price_changes ................... [RUN]
[0m12:42:01.097233 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m12:42:01.097592 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m12:42:01.099949 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m12:42:01.101498 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m12:42:01.104448 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m12:42:01.105845 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:01.106240 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m12:42:01.106611 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:42:01.107871 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:42:01.108359 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:01.108842 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m12:42:01.179316 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m12:42:01.181928 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:01.182323 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m12:42:01.232917 [debug] [Thread-2 (]: SQL status: OK in 0.050 seconds
[0m12:42:01.234264 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:42:01.234661 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:01.235015 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:42:01.327903 [debug] [Thread-2 (]: SQL status: OK in 0.092 seconds
[0m12:42:01.330425 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:01.330843 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m12:42:01.447875 [debug] [Thread-2 (]: SQL status: OK in 0.117 seconds
[0m12:42:01.449315 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m12:42:01.449833 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7566DB20>]}
[0m12:42:01.450401 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_dev.int__price_changes .............. [[32mOK[0m in 0.35s]
[0m12:42:01.451331 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m12:42:01.452140 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m12:42:01.452909 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_dev.int__rsi_sma ......................... [RUN]
[0m12:42:01.453708 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_sma'
[0m12:42:01.454197 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m12:42:01.457334 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.458893 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m12:42:01.462404 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.463534 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.464002 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m12:42:01.464392 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:42:01.466094 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:42:01.466673 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.467261 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    sma_gain::decimal as sma_gain,
    sma_loss::decimal as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m12:42:01.540453 [debug] [Thread-3 (]: SQL status: OK in 0.073 seconds
[0m12:42:01.543214 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.543616 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m12:42:01.587528 [debug] [Thread-3 (]: SQL status: OK in 0.043 seconds
[0m12:42:01.588812 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:42:01.589195 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.589536 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:42:01.676809 [debug] [Thread-3 (]: SQL status: OK in 0.087 seconds
[0m12:42:01.678860 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.679233 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m12:42:01.721423 [debug] [Thread-3 (]: SQL status: OK in 0.042 seconds
[0m12:42:01.722860 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m12:42:01.723369 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A75822AD0>]}
[0m12:42:01.723937 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_dev.int__rsi_sma .................... [[32mOK[0m in 0.27s]
[0m12:42:01.724706 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m12:42:01.725354 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m12:42:01.725842 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_dev.int__rsi_wilder ...................... [RUN]
[0m12:42:01.726515 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_wilder'
[0m12:42:01.726904 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m12:42:01.732947 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:01.742758 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m12:42:01.745519 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:01.746577 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:01.746992 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m12:42:01.747362 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:42:01.748601 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:42:01.749099 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:01.749506 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal as gain,
    loss::decimal as loss,
    wilder_gain::decimal as wilder_gain,
    wilder_loss::decimal as wilder_loss
from wilder
  );

[0m12:42:01.859403 [debug] [Thread-4 (]: SQL status: OK in 0.109 seconds
[0m12:42:01.909770 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:01.910224 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m12:42:02.077586 [debug] [Thread-4 (]: SQL status: OK in 0.167 seconds
[0m12:42:02.078859 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:42:02.079239 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:02.079580 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:42:02.184437 [debug] [Thread-4 (]: SQL status: OK in 0.104 seconds
[0m12:42:02.187576 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:02.188140 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m12:42:02.236874 [debug] [Thread-4 (]: SQL status: OK in 0.048 seconds
[0m12:42:02.238261 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m12:42:02.238772 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7570A0D0>]}
[0m12:42:02.239347 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_dev.int__rsi_wilder ................. [[32mOK[0m in 0.51s]
[0m12:42:02.240116 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m12:42:02.240973 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:42:02.241473 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:42:02.242075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.fct__rsi)
[0m12:42:02.242463 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:42:02.245192 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:42:02.246132 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:42:02.249263 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:42:02.250484 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:42:02.251118 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:42:02.251475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:02.252774 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:02.253223 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:42:02.253682 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:42:02.319773 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:42:02.320347 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:42:02.320810 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: ROLLBACK
[0m12:42:02.327483 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.fct__rsi'
[0m12:42:02.327870 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:42:02.332219 [debug] [Thread-1 (]: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47:     left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
                                                         ^
[0m12:42:02.332689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A758A1470>]}
[0m12:42:02.333280 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model analytics_dev.fct__rsi .................... [[31mERROR[0m in 0.09s]
[0m12:42:02.334083 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:42:02.334693 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47:     left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
                                                         ^.
[0m12:42:02.336525 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:02.336881 [debug] [MainThread]: On master: BEGIN
[0m12:42:02.337188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:42:02.338337 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:02.338653 [debug] [MainThread]: On master: COMMIT
[0m12:42:02.338956 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:02.339246 [debug] [MainThread]: On master: COMMIT
[0m12:42:02.339811 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:02.340163 [debug] [MainThread]: On master: Close
[0m12:42:02.340600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:02.340894 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:42:02.341164 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:42:02.341432 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:42:02.341697 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__price_changes' was properly closed.
[0m12:42:02.341967 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m12:42:02.342230 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m12:42:02.342585 [info ] [MainThread]: 
[0m12:42:02.343084 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m12:42:02.344630 [debug] [MainThread]: Command end result
[0m12:42:02.365769 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:42:02.368019 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:42:02.374376 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:42:02.374776 [info ] [MainThread]: 
[0m12:42:02.375497 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:42:02.375995 [info ] [MainThread]: 
[0m12:42:02.376584 [error] [MainThread]: [31mFailure in model fct__rsi (models\gold\fct__rsi.sql)[0m
[0m12:42:02.377173 [error] [MainThread]:   Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47:     left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
                                                         ^
[0m12:42:02.377670 [info ] [MainThread]: 
[0m12:42:02.378333 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\fct__rsi.sql
[0m12:42:02.378877 [info ] [MainThread]: 
[0m12:42:02.379400 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m12:42:02.380336 [debug] [MainThread]: Command `-c run` failed at 12:42:02.380204 after 4.68 seconds
[0m12:42:02.380729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73BD6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7504AB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73E4BEF0>]}
[0m12:42:02.381091 [debug] [MainThread]: Flushing usage events
[0m12:42:03.065416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:20.514332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6F4D8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6FCE42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E70323ED0>]}


============================== 12:42:20.519347 | a6371ac5-9517-4897-aeb3-60b2b2b2945c ==============================
[0m12:42:20.519347 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:42:20.520039 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select +fct__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m12:42:20.772928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6F690180>]}
[0m12:42:20.839067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E701CB9B0>]}
[0m12:42:20.841691 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:42:21.084774 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:42:21.162305 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:42:21.162950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71419B50>]}
[0m12:42:22.403543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E7159EE40>]}
[0m12:42:22.474984 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:42:22.478618 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:42:22.506776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71BF5C50>]}
[0m12:42:22.507479 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:42:22.508167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E718CC870>]}
[0m12:42:22.510037 [info ] [MainThread]: 
[0m12:42:22.510730 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:42:22.511328 [info ] [MainThread]: 
[0m12:42:22.512292 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:42:22.519022 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:42:22.603915 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:42:22.604320 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m12:42:22.604636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:23.914116 [debug] [ThreadPool]: SQL status: OK in 1.309 seconds
[0m12:42:23.915504 [debug] [ThreadPool]: On list_finance: Close
[0m12:42:23.916184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:42:23.916660 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:42:23.922287 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:23.922609 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m12:42:23.922960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:23.924746 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:42:23.926091 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:23.926404 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:42:23.927409 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:23.927714 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:23.928005 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m12:42:23.977790 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m12:42:23.978743 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:23.979062 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:23.979359 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:24.026267 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m12:42:24.026664 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:42:24.028428 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:42:24.033798 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:24.034153 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:42:24.034432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:24.035606 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:24.035906 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:24.036209 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m12:42:24.059989 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:42:24.061365 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:42:24.062467 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:42:24.062776 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:42:24.064570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71A1D250>]}
[0m12:42:24.065004 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:24.065296 [debug] [MainThread]: On master: BEGIN
[0m12:42:24.065616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:24.066761 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:24.067074 [debug] [MainThread]: On master: COMMIT
[0m12:42:24.067367 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:24.067649 [debug] [MainThread]: On master: COMMIT
[0m12:42:24.068235 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:24.068722 [debug] [MainThread]: On master: Close
[0m12:42:24.073449 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m12:42:24.073997 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m12:42:24.074896 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m12:42:24.075248 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m12:42:24.081619 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m12:42:24.082495 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m12:42:24.112769 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m12:42:24.113711 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.114100 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m12:42:24.114446 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:24.115949 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:24.116317 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.116683 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m12:42:24.176644 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m12:42:24.182329 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.182722 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m12:42:24.225090 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m12:42:24.227833 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.228208 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m12:42:24.275421 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m12:42:24.288304 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:24.288723 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.289063 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:24.383375 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m12:42:24.388764 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.389143 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m12:42:24.500531 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m12:42:24.502838 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m12:42:24.504817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71DE9390>]}
[0m12:42:24.505527 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.43s]
[0m12:42:24.514460 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m12:42:24.515466 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m12:42:24.515956 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_dev.int__price_changes ................... [RUN]
[0m12:42:24.516733 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m12:42:24.517191 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m12:42:24.519759 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m12:42:24.520698 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m12:42:24.526629 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m12:42:24.527580 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.527958 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m12:42:24.528307 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:42:24.529477 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:42:24.529840 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.530244 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m12:42:24.610711 [debug] [Thread-2 (]: SQL status: OK in 0.080 seconds
[0m12:42:24.613360 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.613752 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m12:42:24.670830 [debug] [Thread-2 (]: SQL status: OK in 0.057 seconds
[0m12:42:24.673429 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.674197 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m12:42:24.723708 [debug] [Thread-2 (]: SQL status: OK in 0.049 seconds
[0m12:42:24.725075 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:42:24.725478 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.725816 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:42:24.812875 [debug] [Thread-2 (]: SQL status: OK in 0.087 seconds
[0m12:42:24.814997 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.815373 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m12:42:25.008765 [debug] [Thread-2 (]: SQL status: OK in 0.193 seconds
[0m12:42:25.010117 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m12:42:25.010630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71FB3A70>]}
[0m12:42:25.011197 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_dev.int__price_changes .............. [[32mOK[0m in 0.49s]
[0m12:42:25.012093 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m12:42:25.012821 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m12:42:25.013336 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_dev.int__rsi_sma ......................... [RUN]
[0m12:42:25.014383 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_sma'
[0m12:42:25.014754 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m12:42:25.017058 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.017916 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m12:42:25.021095 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.022707 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.023424 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m12:42:25.023799 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:42:25.025434 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:42:25.025908 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.026381 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    sma_gain::decimal as sma_gain,
    sma_loss::decimal as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m12:42:25.101462 [debug] [Thread-3 (]: SQL status: OK in 0.074 seconds
[0m12:42:25.104049 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.104419 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m12:42:25.152999 [debug] [Thread-3 (]: SQL status: OK in 0.048 seconds
[0m12:42:25.155681 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.156057 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m12:42:25.208546 [debug] [Thread-3 (]: SQL status: OK in 0.052 seconds
[0m12:42:25.210405 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:42:25.210814 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.211167 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:42:25.313262 [debug] [Thread-3 (]: SQL status: OK in 0.102 seconds
[0m12:42:25.315386 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.315761 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m12:42:25.421739 [debug] [Thread-3 (]: SQL status: OK in 0.106 seconds
[0m12:42:25.423071 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m12:42:25.423568 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71EB22D0>]}
[0m12:42:25.424125 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_dev.int__rsi_sma .................... [[32mOK[0m in 0.41s]
[0m12:42:25.424976 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m12:42:25.425652 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m12:42:25.426161 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_dev.int__rsi_wilder ...................... [RUN]
[0m12:42:25.426947 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_wilder'
[0m12:42:25.427410 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m12:42:25.430116 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.431078 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m12:42:25.434073 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.437766 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.438640 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m12:42:25.439069 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:42:25.440809 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:42:25.441384 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.441853 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal as gain,
    loss::decimal as loss,
    wilder_gain::decimal as wilder_gain,
    wilder_loss::decimal as wilder_loss
from wilder
  );

[0m12:42:25.532033 [debug] [Thread-4 (]: SQL status: OK in 0.090 seconds
[0m12:42:25.534830 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.535254 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m12:42:25.585938 [debug] [Thread-4 (]: SQL status: OK in 0.050 seconds
[0m12:42:25.588718 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.589106 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m12:42:25.635717 [debug] [Thread-4 (]: SQL status: OK in 0.046 seconds
[0m12:42:25.637065 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:42:25.637454 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.637804 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:42:25.740558 [debug] [Thread-4 (]: SQL status: OK in 0.102 seconds
[0m12:42:25.742991 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.743405 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m12:42:25.846718 [debug] [Thread-4 (]: SQL status: OK in 0.103 seconds
[0m12:42:25.848117 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m12:42:25.848612 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71FA6890>]}
[0m12:42:25.849180 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_dev.int__rsi_wilder ................. [[32mOK[0m in 0.42s]
[0m12:42:25.850083 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m12:42:25.850839 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:42:25.851331 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:42:25.852049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.fct__rsi)
[0m12:42:25.852406 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:42:25.855008 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:42:25.855843 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:42:25.858713 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:42:25.859634 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:42:25.860042 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:42:25.860369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:25.861774 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:25.871120 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:42:25.871615 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = s.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:42:25.936927 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = s.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:42:25.937451 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:42:25.937908 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: ROLLBACK
[0m12:42:25.944739 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.fct__rsi'
[0m12:42:25.945152 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:42:25.949427 [debug] [Thread-1 (]: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47: ... wilder_sma ws on s.trade_date = s.trade_date and s.ticker = sma.ticker
                                                                           ^
[0m12:42:25.949868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E734B2C90>]}
[0m12:42:25.950443 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model analytics_dev.fct__rsi .................... [[31mERROR[0m in 0.10s]
[0m12:42:25.951252 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:42:25.951837 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47: ... wilder_sma ws on s.trade_date = s.trade_date and s.ticker = sma.ticker
                                                                           ^.
[0m12:42:25.953665 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:25.953998 [debug] [MainThread]: On master: BEGIN
[0m12:42:25.954302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:42:25.955460 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:25.955805 [debug] [MainThread]: On master: COMMIT
[0m12:42:25.956126 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:25.956484 [debug] [MainThread]: On master: COMMIT
[0m12:42:25.957151 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:25.957485 [debug] [MainThread]: On master: Close
[0m12:42:25.957901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:25.958189 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:42:25.958458 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:42:25.958724 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:42:25.958989 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__price_changes' was properly closed.
[0m12:42:25.959256 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m12:42:25.959519 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m12:42:25.959867 [info ] [MainThread]: 
[0m12:42:25.960318 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m12:42:25.961788 [debug] [MainThread]: Command end result
[0m12:42:25.982533 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:42:25.984720 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:42:25.991710 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:42:25.992084 [info ] [MainThread]: 
[0m12:42:25.992594 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:42:25.993154 [info ] [MainThread]: 
[0m12:42:25.993799 [error] [MainThread]: [31mFailure in model fct__rsi (models\gold\fct__rsi.sql)[0m
[0m12:42:25.994426 [error] [MainThread]:   Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47: ... wilder_sma ws on s.trade_date = s.trade_date and s.ticker = sma.ticker
                                                                           ^
[0m12:42:25.995175 [info ] [MainThread]: 
[0m12:42:25.995784 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\fct__rsi.sql
[0m12:42:25.996257 [info ] [MainThread]: 
[0m12:42:25.996781 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m12:42:25.997704 [debug] [MainThread]: Command `-c run` failed at 12:42:25.997589 after 5.62 seconds
[0m12:42:25.998078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71FFC2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71995F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6F5250D0>]}
[0m12:42:25.998440 [debug] [MainThread]: Flushing usage events
[0m12:42:26.762957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:55.045874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014020058050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140208642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014020EA7ED0>]}


============================== 12:42:55.050081 | 0b91ea45-4f77-4488-bb01-30428f9e0a1a ==============================
[0m12:42:55.050081 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:42:55.050769 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +fct__rsi', 'printer_width': '80', 'write_json': 'True'}
[0m12:42:55.291467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014020210180>]}
[0m12:42:55.356383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014020D4B9B0>]}
[0m12:42:55.358858 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:42:55.600901 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:42:55.680837 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:42:55.681437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014021F91B50>]}
[0m12:42:56.914940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001402217AE40>]}
[0m12:42:56.978162 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:42:56.980364 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:42:57.004376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140227D5C50>]}
[0m12:42:57.004843 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:42:57.005340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022410870>]}
[0m12:42:57.006979 [info ] [MainThread]: 
[0m12:42:57.007471 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:42:57.007945 [info ] [MainThread]: 
[0m12:42:57.008579 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:42:57.013754 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:42:57.090591 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:42:57.090981 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m12:42:57.091295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:58.938618 [debug] [ThreadPool]: SQL status: OK in 1.847 seconds
[0m12:42:58.940062 [debug] [ThreadPool]: On list_finance: Close
[0m12:42:58.940788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:42:58.941367 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:42:58.947112 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:58.947448 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m12:42:58.947744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:58.949349 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:42:58.950603 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:58.950907 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:42:58.951872 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:58.952169 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:58.952465 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m12:42:58.996973 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m12:42:58.997898 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:58.998219 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:58.998511 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:59.046750 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m12:42:59.047163 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:42:59.049023 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:42:59.054511 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:59.054842 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:42:59.055116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:59.056302 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:59.056604 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:59.056902 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m12:42:59.080426 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:42:59.081800 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:42:59.082989 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:42:59.083307 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:42:59.085164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022605250>]}
[0m12:42:59.085671 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:59.085965 [debug] [MainThread]: On master: BEGIN
[0m12:42:59.086240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:59.087431 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:59.087773 [debug] [MainThread]: On master: COMMIT
[0m12:42:59.088074 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:59.088359 [debug] [MainThread]: On master: COMMIT
[0m12:42:59.088969 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:59.089280 [debug] [MainThread]: On master: Close
[0m12:42:59.094035 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m12:42:59.094550 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m12:42:59.095470 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m12:42:59.095831 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m12:42:59.102407 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m12:42:59.103271 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m12:42:59.133432 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m12:42:59.134446 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.134864 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m12:42:59.135243 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:59.136940 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:42:59.137512 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.137926 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m12:42:59.194070 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m12:42:59.199678 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.200066 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m12:42:59.260544 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m12:42:59.263256 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.263652 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m12:42:59.310688 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m12:42:59.322600 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:59.323024 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.323360 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:59.435638 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m12:42:59.440759 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.441175 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m12:42:59.550645 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m12:42:59.552970 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m12:42:59.554944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140229CD4F0>]}
[0m12:42:59.555577 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.46s]
[0m12:42:59.556455 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m12:42:59.557179 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m12:42:59.557701 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_dev.int__price_changes ................... [RUN]
[0m12:42:59.558412 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m12:42:59.558798 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m12:42:59.561171 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m12:42:59.562009 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m12:42:59.567694 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m12:42:59.568748 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:59.569134 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m12:42:59.569467 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:42:59.570820 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:42:59.571299 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:59.571705 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m12:42:59.755998 [debug] [Thread-2 (]: SQL status: OK in 0.184 seconds
[0m12:42:59.758798 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:59.759202 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m12:42:59.819412 [debug] [Thread-2 (]: SQL status: OK in 0.060 seconds
[0m12:42:59.821969 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:59.822728 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m12:42:59.959855 [debug] [Thread-2 (]: SQL status: OK in 0.137 seconds
[0m12:42:59.961179 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:42:59.961554 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:59.961892 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:43:00.065736 [debug] [Thread-2 (]: SQL status: OK in 0.103 seconds
[0m12:43:00.067870 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:43:00.068247 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m12:43:00.165738 [debug] [Thread-2 (]: SQL status: OK in 0.097 seconds
[0m12:43:00.167206 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m12:43:00.167765 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022B939D0>]}
[0m12:43:00.168383 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_dev.int__price_changes .............. [[32mOK[0m in 0.61s]
[0m12:43:00.169157 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m12:43:00.169843 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m12:43:00.170342 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_dev.int__rsi_sma ......................... [RUN]
[0m12:43:00.171022 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_sma'
[0m12:43:00.171408 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m12:43:00.173846 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.174681 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m12:43:00.177638 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.178446 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.178815 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m12:43:00.179155 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:43:00.180295 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:43:00.180660 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.181047 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    sma_gain::decimal as sma_gain,
    sma_loss::decimal as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m12:43:00.366410 [debug] [Thread-3 (]: SQL status: OK in 0.185 seconds
[0m12:43:00.369339 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.369740 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m12:43:00.424108 [debug] [Thread-3 (]: SQL status: OK in 0.054 seconds
[0m12:43:00.427181 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.427637 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m12:43:00.474797 [debug] [Thread-3 (]: SQL status: OK in 0.047 seconds
[0m12:43:00.476586 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:43:00.476972 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.477322 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:43:00.574223 [debug] [Thread-3 (]: SQL status: OK in 0.096 seconds
[0m12:43:00.576482 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.576857 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m12:43:00.686282 [debug] [Thread-3 (]: SQL status: OK in 0.109 seconds
[0m12:43:00.687627 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m12:43:00.688127 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022A962D0>]}
[0m12:43:00.688679 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_dev.int__rsi_sma .................... [[32mOK[0m in 0.52s]
[0m12:43:00.689503 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m12:43:00.690213 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m12:43:00.690679 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_dev.int__rsi_wilder ...................... [RUN]
[0m12:43:00.691721 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_wilder'
[0m12:43:00.692327 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m12:43:00.695215 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.696175 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m12:43:00.699231 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.700111 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.700497 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m12:43:00.700833 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:43:00.702106 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:43:00.702468 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.702853 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal as gain,
    loss::decimal as loss,
    wilder_gain::decimal as wilder_gain,
    wilder_loss::decimal as wilder_loss
from wilder
  );

[0m12:43:00.790525 [debug] [Thread-4 (]: SQL status: OK in 0.087 seconds
[0m12:43:00.793152 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.793533 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m12:43:00.850822 [debug] [Thread-4 (]: SQL status: OK in 0.057 seconds
[0m12:43:00.853499 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.853879 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m12:43:00.916534 [debug] [Thread-4 (]: SQL status: OK in 0.062 seconds
[0m12:43:00.917865 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:43:00.918236 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.918578 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:43:01.040219 [debug] [Thread-4 (]: SQL status: OK in 0.121 seconds
[0m12:43:01.042703 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:01.043072 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m12:43:01.161150 [debug] [Thread-4 (]: SQL status: OK in 0.118 seconds
[0m12:43:01.162768 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m12:43:01.163449 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022B89FD0>]}
[0m12:43:01.164082 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_dev.int__rsi_wilder ................. [[32mOK[0m in 0.47s]
[0m12:43:01.164952 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m12:43:01.165654 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:43:01.166167 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:43:01.167115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.fct__rsi)
[0m12:43:01.167482 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:43:01.170117 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:43:01.171024 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:43:01.174179 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:43:01.175286 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:43:01.175714 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:43:01.176061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:01.177487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:01.177921 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:43:01.178343 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = s.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:43:01.287136 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m12:43:01.289761 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:43:01.290139 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
alter view "finance"."analytics_dev"."fct__rsi__dbt_tmp" rename to "fct__rsi"
[0m12:43:01.390494 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m12:43:01.391778 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m12:43:01.392152 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:43:01.392494 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m12:43:01.490811 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m12:43:01.492912 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:43:01.493271 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop view if exists "finance"."analytics_dev"."fct__rsi__dbt_backup" cascade
    
[0m12:43:01.538978 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m12:43:01.540307 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:43:01.540811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022A63410>]}
[0m12:43:01.541415 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics_dev.fct__rsi ........................ [[32mOK[0m in 0.37s]
[0m12:43:01.542436 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:43:01.543829 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:01.544201 [debug] [MainThread]: On master: BEGIN
[0m12:43:01.544484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:01.545771 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:43:01.546127 [debug] [MainThread]: On master: COMMIT
[0m12:43:01.546429 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:01.546715 [debug] [MainThread]: On master: COMMIT
[0m12:43:01.547323 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:43:01.547631 [debug] [MainThread]: On master: Close
[0m12:43:01.548014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:01.548297 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:43:01.548563 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:43:01.548823 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:43:01.549082 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__price_changes' was properly closed.
[0m12:43:01.549339 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m12:43:01.549600 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m12:43:01.549943 [info ] [MainThread]: 
[0m12:43:01.550512 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m12:43:01.552158 [debug] [MainThread]: Command end result
[0m12:43:01.573839 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:43:01.576204 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:43:01.582391 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:43:01.582761 [info ] [MainThread]: 
[0m12:43:01.583412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:01.584084 [info ] [MainThread]: 
[0m12:43:01.584743 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m12:43:01.585717 [debug] [MainThread]: Command `-c run` succeeded at 12:43:01.585607 after 6.66 seconds
[0m12:43:01.586068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014020148DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022BDFD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022BDF7D0>]}
[0m12:43:01.586422 [debug] [MainThread]: Flushing usage events
[0m12:43:02.292486 [debug] [MainThread]: An error was encountered while trying to flush usage events
