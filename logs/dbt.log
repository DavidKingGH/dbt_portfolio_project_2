[0m09:50:33.419774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C989DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996CB48E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996CB490A0>]}


============================== 09:50:33.423708 | 2131af59-0490-442c-a22b-02b36e6cc1f3 ==============================
[0m09:50:33.423708 [info ] [MainThread]: Running with dbt=1.8.0
[0m09:50:33.424841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\portfolio_project_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:50:33.614074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2131af59-0490-442c-a22b-02b36e6cc1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C9898E0>]}
[0m09:50:33.648746 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:50:33.650740 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:50:33.651943 [debug] [MainThread]: Command `cli deps` succeeded at 09:50:33.651943 after 0.36 seconds
[0m09:50:33.651943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C9898E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996CB95760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996DDA7FB0>]}
[0m09:50:33.653328 [debug] [MainThread]: Flushing usage events
[0m14:46:33.312374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8772F1460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A87722DA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8772CDAF0>]}


============================== 14:46:33.316752 | ecd24de3-887e-4855-91a2-7ab6da255ba4 ==============================
[0m14:46:33.316752 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:46:33.317757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:46:33.508270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecd24de3-887e-4855-91a2-7ab6da255ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A87760A570>]}
[0m14:46:33.539367 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:46:33.541364 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:46:33.542362 [debug] [MainThread]: Command `cli deps` succeeded at 14:46:33.542362 after 0.36 seconds
[0m14:46:33.543359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A876FC0BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8772CF260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8777B5DF0>]}
[0m14:46:33.543359 [debug] [MainThread]: Flushing usage events
[0m14:46:53.634270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC75CB8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC764C42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC76B07ED0>]}


============================== 14:46:53.638786 | 17328ad3-a59a-4f63-89e3-797e95b84802 ==============================
[0m14:46:53.638786 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:46:53.639523 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target prod', 'printer_width': '80', 'target_path': 'None'}
[0m14:46:53.984953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC75E70180>]}
[0m14:46:54.051306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC769ABAC0>]}
[0m14:46:54.069612 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:46:54.515395 [debug] [MainThread]: checksum: fd5f499d60404c73e369f2149bd6aa6c74754a4e78aa98476ca57564d99f7088, vars: {}, profile: , target: prod, version: 1.10.13
[0m14:46:54.593281 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:46:54.593875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC77C99750>]}
[0m14:46:56.876189 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.portfolio_project_2.example
[0m14:46:56.885310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC77E0EE40>]}
[0m14:46:56.955067 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:46:56.978652 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:46:57.010470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78451B70>]}
[0m14:46:57.011008 [info ] [MainThread]: Found 2 models, 2 sources, 461 macros
[0m14:46:57.011548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78077C70>]}
[0m14:46:57.013873 [info ] [MainThread]: 
[0m14:46:57.014445 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:46:57.014912 [info ] [MainThread]: 
[0m14:46:57.015546 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:46:57.020650 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m14:46:59.783272 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m14:46:59.783844 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m14:46:59.784149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:40.658600 [debug] [ThreadPool]: SQL status: OK in 40.874 seconds
[0m14:47:40.660355 [debug] [ThreadPool]: On list_finance: Close
[0m14:47:40.661093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_prod)
[0m14:47:40.661582 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_prod"
"
[0m14:47:40.667722 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:47:40.668143 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m14:47:40.668468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:40.670893 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:47:40.672373 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:47:40.672690 [debug] [ThreadPool]: On create_finance_analytics_prod: BEGIN
[0m14:47:40.673666 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:47:40.673975 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:47:40.674280 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
    
        create schema if not exists "finance"."analytics_prod"
    
[0m14:47:40.728701 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m14:47:40.729794 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m14:47:40.730187 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:47:40.730500 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m14:47:40.840907 [debug] [ThreadPool]: SQL status: OK in 0.110 seconds
[0m14:47:40.841483 [debug] [ThreadPool]: On create_finance_analytics_prod: Close
[0m14:47:40.843328 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_prod'
[0m14:47:40.849291 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m14:47:40.849710 [debug] [ThreadPool]: On list_finance_analytics_prod: BEGIN
[0m14:47:40.850009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:40.851154 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:47:40.851544 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m14:47:40.851868 [debug] [ThreadPool]: On list_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance_analytics_prod"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_prod'
    and lower(table_catalog) = 'finance'
  
[0m14:47:40.891567 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m14:47:40.892981 [debug] [ThreadPool]: On list_finance_analytics_prod: ROLLBACK
[0m14:47:40.909926 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_prod'
[0m14:47:40.910347 [debug] [ThreadPool]: On list_finance_analytics_prod: Close
[0m14:47:40.911285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78440D10>]}
[0m14:47:40.911778 [debug] [MainThread]: Using duckdb connection "master"
[0m14:47:40.912114 [debug] [MainThread]: On master: BEGIN
[0m14:47:40.912428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:47:40.913625 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:47:40.913957 [debug] [MainThread]: On master: COMMIT
[0m14:47:40.914264 [debug] [MainThread]: Using duckdb connection "master"
[0m14:47:40.914558 [debug] [MainThread]: On master: COMMIT
[0m14:47:40.915185 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:47:40.915535 [debug] [MainThread]: On master: Close
[0m14:47:40.922119 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m14:47:40.922624 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m14:47:40.923208 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_prod.src_stocks .......................... [RUN]
[0m14:47:40.924565 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m14:47:40.925012 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m14:47:40.931923 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m14:47:40.923771 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_prod.src_vix ............................. [RUN]
[0m14:47:40.932841 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m14:47:40.933382 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m14:47:40.936851 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m14:47:40.940469 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m14:47:40.940954 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m14:47:40.974123 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m14:47:40.977779 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m14:47:40.981187 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:47:40.981948 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m14:47:40.982746 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:47:40.983390 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:47:40.984237 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m14:47:40.984623 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:47:40.985276 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:47:40.985667 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:47:40.986068 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_prod"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high:double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m14:47:40.986497 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:47:41.002041 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_prod"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high:double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m14:47:41.002588 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:47:41.003071 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:47:41.003539 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_prod"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close"
from src
  );

[0m14:47:41.004110 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: ROLLBACK
[0m14:47:41.072228 [debug] [Thread-2 (]: SQL status: OK in 0.067 seconds
[0m14:47:41.078436 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:47:41.078904 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_prod"."src_vix__dbt_tmp" rename to "src_vix"
[0m14:47:41.145144 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m14:47:41.159639 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:47:41.160545 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:47:41.161346 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:47:41.177419 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.src_stocks'
[0m14:47:41.177865 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m14:47:41.182022 [debug] [Thread-1 (]: Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^
[0m14:47:41.184176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7864D860>]}
[0m14:47:41.184804 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model analytics_prod.src_stocks ................. [[31mERROR[0m in 0.26s]
[0m14:47:41.185623 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m14:47:41.186268 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.src_stocks' to be skipped because of status 'error'.  Reason: Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^.
[0m14:47:41.274430 [debug] [Thread-2 (]: SQL status: OK in 0.113 seconds
[0m14:47:41.279688 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:47:41.280116 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_prod"."src_vix__dbt_backup" cascade
    
[0m14:47:41.325498 [debug] [Thread-2 (]: SQL status: OK in 0.045 seconds
[0m14:47:41.327996 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m14:47:41.328570 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0118E530>]}
[0m14:47:41.329156 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_prod.src_vix ........................ [[32mOK[0m in 0.40s]
[0m14:47:41.329969 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m14:47:41.331433 [debug] [MainThread]: Using duckdb connection "master"
[0m14:47:41.331761 [debug] [MainThread]: On master: BEGIN
[0m14:47:41.332055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:47:41.333306 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:47:41.333647 [debug] [MainThread]: On master: COMMIT
[0m14:47:41.333976 [debug] [MainThread]: Using duckdb connection "master"
[0m14:47:41.334290 [debug] [MainThread]: On master: COMMIT
[0m14:47:41.334966 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:47:41.335305 [debug] [MainThread]: On master: Close
[0m14:47:41.335712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:41.336067 [debug] [MainThread]: Connection 'create_finance_analytics_prod' was properly closed.
[0m14:47:41.336341 [debug] [MainThread]: Connection 'list_finance_analytics_prod' was properly closed.
[0m14:47:41.336612 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_stocks' was properly closed.
[0m14:47:41.336876 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m14:47:41.340398 [info ] [MainThread]: 
[0m14:47:41.341324 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 44.32 seconds (44.32s).
[0m14:47:41.343093 [debug] [MainThread]: Command end result
[0m14:47:41.371594 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:47:41.374695 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:47:41.382625 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m14:47:41.383043 [info ] [MainThread]: 
[0m14:47:41.383614 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:47:41.384146 [info ] [MainThread]: 
[0m14:47:41.384871 [error] [MainThread]: [31mFailure in model src_stocks (models\bronze\src_stocks.sql)[0m
[0m14:47:41.385705 [error] [MainThread]:   Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^
[0m14:47:41.386443 [info ] [MainThread]: 
[0m14:47:41.387338 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\bronze\src_stocks.sql
[0m14:47:41.388147 [info ] [MainThread]: 
[0m14:47:41.388727 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m14:47:41.389780 [debug] [MainThread]: Command `-c run` failed at 14:47:41.389594 after 47.88 seconds
[0m14:47:41.390297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC786327D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78675150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC701AF150>]}
[0m14:47:41.390903 [debug] [MainThread]: Flushing usage events
[0m14:47:42.202135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:47:44.771591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBE558050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBED642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBF3A7ED0>]}


============================== 14:47:44.775945 | cbcf40c9-a4db-4334-8ca3-01e30d7a4faa ==============================
[0m14:47:44.775945 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:47:44.776785 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'write_json': 'True', 'invocation_command': 'dbt run --target prodclear', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:47:44.779433 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'portfolio_project_2' does not have a target named 'prodclear'. The valid target names for this profile are:
   - dev
   - prod
[0m14:47:44.780365 [debug] [MainThread]: Command `-c run` failed at 14:47:44.780246 after 0.13 seconds
[0m14:47:44.780733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBF4242B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBF2AA8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBF249AE0>]}
[0m14:47:44.781124 [debug] [MainThread]: Flushing usage events
[0m14:47:45.533611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:48:30.536473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7D768050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7DF742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7E5B3ED0>]}


============================== 14:48:30.541105 | fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2 ==============================
[0m14:48:30.541105 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:48:30.541814 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target prod', 'printer_width': '80', 'target_path': 'None'}
[0m14:48:30.788802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7D920180>]}
[0m14:48:30.853194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7E45BAC0>]}
[0m14:48:30.855768 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:48:31.110806 [debug] [MainThread]: checksum: fd5f499d60404c73e369f2149bd6aa6c74754a4e78aa98476ca57564d99f7088, vars: {}, profile: , target: prod, version: 1.10.13
[0m14:48:31.188580 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:48:31.189166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7F6E9750>]}
[0m14:48:32.394734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7F85EE40>]}
[0m14:48:32.457491 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:48:32.459953 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:48:32.487434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7FEA1A90>]}
[0m14:48:32.487962 [info ] [MainThread]: Found 2 models, 2 sources, 461 macros
[0m14:48:32.488523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7FBA82C0>]}
[0m14:48:32.490267 [info ] [MainThread]: 
[0m14:48:32.490772 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:48:32.491311 [info ] [MainThread]: 
[0m14:48:32.491932 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:48:32.496832 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m14:48:32.575229 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m14:48:32.575644 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m14:48:32.575973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:33.855543 [debug] [ThreadPool]: SQL status: OK in 1.279 seconds
[0m14:48:33.857093 [debug] [ThreadPool]: On list_finance: Close
[0m14:48:33.857810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_prod)
[0m14:48:33.858318 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_prod"
"
[0m14:48:33.864662 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:48:33.865067 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m14:48:33.865380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:33.867059 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:48:33.868366 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:48:33.868678 [debug] [ThreadPool]: On create_finance_analytics_prod: BEGIN
[0m14:48:33.869601 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:48:33.869922 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:48:33.870224 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
    
        create schema if not exists "finance"."analytics_prod"
    
[0m14:48:33.923943 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m14:48:33.924978 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m14:48:33.925337 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:48:33.925663 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m14:48:33.985490 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m14:48:33.986044 [debug] [ThreadPool]: On create_finance_analytics_prod: Close
[0m14:48:33.988135 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_prod'
[0m14:48:33.995933 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m14:48:33.996426 [debug] [ThreadPool]: On list_finance_analytics_prod: BEGIN
[0m14:48:33.996856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:33.998372 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:48:33.998912 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m14:48:33.999524 [debug] [ThreadPool]: On list_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance_analytics_prod"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_prod'
    and lower(table_catalog) = 'finance'
  
[0m14:48:34.025467 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m14:48:34.026811 [debug] [ThreadPool]: On list_finance_analytics_prod: ROLLBACK
[0m14:48:34.027842 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_prod'
[0m14:48:34.028164 [debug] [ThreadPool]: On list_finance_analytics_prod: Close
[0m14:48:34.029302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7FE90D10>]}
[0m14:48:34.029776 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:34.030071 [debug] [MainThread]: On master: BEGIN
[0m14:48:34.030349 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:48:34.031569 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:48:34.031909 [debug] [MainThread]: On master: COMMIT
[0m14:48:34.032231 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:34.032536 [debug] [MainThread]: On master: COMMIT
[0m14:48:34.033105 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:48:34.033425 [debug] [MainThread]: On master: Close
[0m14:48:34.038175 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m14:48:34.039228 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m14:48:34.038770 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_prod.src_stocks .......................... [RUN]
[0m14:48:34.040538 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m14:48:34.040001 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_prod.src_vix ............................. [RUN]
[0m14:48:34.041066 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m14:48:34.041554 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m14:48:34.049486 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m14:48:34.050365 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m14:48:34.054721 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m14:48:34.055991 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m14:48:34.056638 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m14:48:34.089569 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m14:48:34.093389 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m14:48:34.095197 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:48:34.095715 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m14:48:34.096065 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:48:34.097049 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.097494 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m14:48:34.097874 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:48:34.098541 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:48:34.099139 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:48:34.099647 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_prod"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high:double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m14:48:34.102598 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_prod"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high:double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m14:48:34.103011 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:48:34.103467 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: ROLLBACK
[0m14:48:34.103934 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:48:34.104318 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.105714 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_prod"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close"
from src
  );

[0m14:48:34.112602 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.src_stocks'
[0m14:48:34.113026 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m14:48:34.117847 [debug] [Thread-1 (]: Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^
[0m14:48:34.121670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A000DD650>]}
[0m14:48:34.122950 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model analytics_prod.src_stocks ................. [[31mERROR[0m in 0.08s]
[0m14:48:34.124373 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m14:48:34.125467 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.src_stocks' to be skipped because of status 'error'.  Reason: Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^.
[0m14:48:34.168341 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m14:48:34.175088 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.175600 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_prod"."src_vix" rename to "src_vix__dbt_backup"
[0m14:48:34.231528 [debug] [Thread-2 (]: SQL status: OK in 0.055 seconds
[0m14:48:34.240942 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.241910 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_prod"."src_vix__dbt_tmp" rename to "src_vix"
[0m14:48:34.307170 [debug] [Thread-2 (]: SQL status: OK in 0.064 seconds
[0m14:48:34.331597 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:48:34.332127 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.332575 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:48:34.446466 [debug] [Thread-2 (]: SQL status: OK in 0.113 seconds
[0m14:48:34.451838 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.452346 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_prod"."src_vix__dbt_backup" cascade
    
[0m14:48:34.601804 [debug] [Thread-2 (]: SQL status: OK in 0.149 seconds
[0m14:48:34.604393 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m14:48:34.605031 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A002E1770>]}
[0m14:48:34.605661 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_prod.src_vix ........................ [[32mOK[0m in 0.56s]
[0m14:48:34.606546 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m14:48:34.608261 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:34.608613 [debug] [MainThread]: On master: BEGIN
[0m14:48:34.608907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:48:34.610196 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:48:34.610547 [debug] [MainThread]: On master: COMMIT
[0m14:48:34.610856 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:34.611146 [debug] [MainThread]: On master: COMMIT
[0m14:48:34.611800 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:48:34.612121 [debug] [MainThread]: On master: Close
[0m14:48:34.612537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:34.612818 [debug] [MainThread]: Connection 'create_finance_analytics_prod' was properly closed.
[0m14:48:34.613083 [debug] [MainThread]: Connection 'list_finance_analytics_prod' was properly closed.
[0m14:48:34.613350 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_stocks' was properly closed.
[0m14:48:34.613615 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m14:48:34.613967 [info ] [MainThread]: 
[0m14:48:34.614519 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m14:48:34.616101 [debug] [MainThread]: Command end result
[0m14:48:34.644235 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:48:34.647221 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:48:34.654773 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m14:48:34.655182 [info ] [MainThread]: 
[0m14:48:34.655814 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:48:34.656519 [info ] [MainThread]: 
[0m14:48:34.657230 [error] [MainThread]: [31mFailure in model src_stocks (models\bronze\src_stocks.sql)[0m
[0m14:48:34.657911 [error] [MainThread]:   Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^
[0m14:48:34.659019 [info ] [MainThread]: 
[0m14:48:34.659798 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\bronze\src_stocks.sql
[0m14:48:34.660398 [info ] [MainThread]: 
[0m14:48:34.660899 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m14:48:34.662211 [debug] [MainThread]: Command `-c run` failed at 14:48:34.661964 after 4.26 seconds
[0m14:48:34.662844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A000C24D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A000F56D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7E4BBB60>]}
[0m14:48:34.663448 [debug] [MainThread]: Flushing usage events
[0m14:48:35.319960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:48:54.063059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C084E8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C08CF42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C09337ED0>]}


============================== 14:48:54.067582 | c9c2ad72-85e8-40be-b214-9ef8f32ce8c4 ==============================
[0m14:48:54.067582 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:48:54.068542 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt parse', 'printer_width': '80', 'write_json': 'True'}
[0m14:48:54.313823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9c2ad72-85e8-40be-b214-9ef8f32ce8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C086A0180>]}
[0m14:48:54.379559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9c2ad72-85e8-40be-b214-9ef8f32ce8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C091DB9B0>]}
[0m14:48:54.382204 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:48:54.628170 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:48:54.705334 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:48:54.705941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9c2ad72-85e8-40be-b214-9ef8f32ce8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0A441650>]}
[0m14:48:55.956655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9c2ad72-85e8-40be-b214-9ef8f32ce8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0A5BAE40>]}
[0m14:48:55.960906 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m14:48:56.027976 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:48:56.031160 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:48:56.032156 [debug] [MainThread]: Command `-c parse` succeeded at 14:48:56.032030 after 2.09 seconds
[0m14:48:56.032574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C091F3E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0A670C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0A82FEE0>]}
[0m14:48:56.032937 [debug] [MainThread]: Flushing usage events
[0m14:48:56.694280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:06.552791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3DDC8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3E5D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3EC17ED0>]}


============================== 14:50:06.557528 | 4799b82d-ea87-4fe1-b5db-edfc45a2191f ==============================
[0m14:50:06.557528 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:50:06.558247 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m14:50:06.817994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4799b82d-ea87-4fe1-b5db-edfc45a2191f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3DF80180>]}
[0m14:50:06.884180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4799b82d-ea87-4fe1-b5db-edfc45a2191f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3EABB9B0>]}
[0m14:50:06.886925 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:50:07.151310 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:50:07.280305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:07.280684 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:07.314825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4799b82d-ea87-4fe1-b5db-edfc45a2191f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3FD0F150>]}
[0m14:50:07.318514 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m14:50:07.402323 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:50:07.405088 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:50:07.405941 [debug] [MainThread]: Command `-c parse` succeeded at 14:50:07.405802 after 1.04 seconds
[0m14:50:07.406365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3EA43E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3D86C7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3EAD3E70>]}
[0m14:50:07.406768 [debug] [MainThread]: Flushing usage events
[0m14:50:08.137014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:18.927465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191DFF8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191E8042D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191EE47ED0>]}


============================== 14:50:18.932634 | fb3f3cfb-4482-441b-85f0-518ae232b0f3 ==============================
[0m14:50:18.932634 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:50:18.933696 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m14:50:19.203665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191E1B0180>]}
[0m14:50:19.274314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191ECEBAC0>]}
[0m14:50:19.276927 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:50:19.545401 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m14:50:19.625979 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:50:19.626762 [debug] [MainThread]: previous checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, current checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe
[0m14:50:19.627239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191FFE5750>]}
[0m14:50:20.994097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192015EE40>]}
[0m14:50:21.061447 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:50:21.064095 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:50:21.090915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219207A5A90>]}
[0m14:50:21.091461 [info ] [MainThread]: Found 2 models, 2 sources, 461 macros
[0m14:50:21.092061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219204A7C70>]}
[0m14:50:21.093899 [info ] [MainThread]: 
[0m14:50:21.094447 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:21.094902 [info ] [MainThread]: 
[0m14:50:21.095511 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:50:21.100463 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m14:50:21.188980 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m14:50:21.189380 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m14:50:21.189697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:22.637508 [debug] [ThreadPool]: SQL status: OK in 1.448 seconds
[0m14:50:22.639326 [debug] [ThreadPool]: On list_finance: Close
[0m14:50:22.640349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m14:50:22.640923 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m14:50:22.647177 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m14:50:22.647592 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m14:50:22.647909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:22.649678 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:50:22.651129 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m14:50:22.651496 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m14:50:22.652631 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:50:22.652976 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m14:50:22.653288 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m14:50:22.700762 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m14:50:22.701725 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m14:50:22.702066 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m14:50:22.702365 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m14:50:22.911032 [debug] [ThreadPool]: SQL status: OK in 0.208 seconds
[0m14:50:22.911849 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m14:50:22.913908 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m14:50:22.919712 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m14:50:22.920106 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m14:50:22.920394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:22.921595 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:50:22.921916 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m14:50:22.922230 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m14:50:22.947405 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m14:50:22.948763 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m14:50:22.950011 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m14:50:22.950413 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m14:50:22.951413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021920794D10>]}
[0m14:50:22.951962 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:22.952331 [debug] [MainThread]: On master: BEGIN
[0m14:50:22.952661 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:22.954196 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:50:22.954913 [debug] [MainThread]: On master: COMMIT
[0m14:50:22.955533 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:22.956124 [debug] [MainThread]: On master: COMMIT
[0m14:50:22.957254 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:50:22.957883 [debug] [MainThread]: On master: Close
[0m14:50:22.963593 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m14:50:22.964088 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m14:50:22.964654 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m14:50:22.965864 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m14:50:22.966248 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m14:50:22.973808 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m14:50:22.965181 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m14:50:22.974889 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m14:50:22.975395 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m14:50:22.978730 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m14:50:22.979865 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m14:50:23.005018 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m14:50:23.030366 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m14:50:23.031261 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m14:50:23.032455 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:50:23.033057 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m14:50:23.033445 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:23.034463 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:50:23.035007 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m14:50:23.035410 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:23.036192 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:50:23.036697 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:50:23.037111 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close"
from src
  );

[0m14:50:23.037773 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:50:23.038557 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:50:23.039408 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m14:50:23.106477 [debug] [Thread-2 (]: SQL status: OK in 0.069 seconds
[0m14:50:23.112835 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:50:23.113336 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m14:50:23.125256 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m14:50:23.128482 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:50:23.128931 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m14:50:23.170014 [debug] [Thread-2 (]: SQL status: OK in 0.056 seconds
[0m14:50:23.180114 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:50:23.180563 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:50:23.180940 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:50:23.183426 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m14:50:23.184711 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m14:50:23.188043 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:50:23.188424 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m14:50:23.285532 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m14:50:23.285987 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m14:50:23.291536 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:50:23.294260 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:50:23.294830 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m14:50:23.295305 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m14:50:23.348730 [debug] [Thread-2 (]: SQL status: OK in 0.053 seconds
[0m14:50:23.349339 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m14:50:23.351787 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m14:50:23.353258 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m14:50:23.356105 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192099D2E0>]}
[0m14:50:23.357185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191E130550>]}
[0m14:50:23.356836 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.39s]
[0m14:50:23.358686 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m14:50:23.358030 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.38s]
[0m14:50:23.359615 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m14:50:23.361377 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:23.361768 [debug] [MainThread]: On master: BEGIN
[0m14:50:23.362072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:23.363292 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:50:23.363701 [debug] [MainThread]: On master: COMMIT
[0m14:50:23.364043 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:23.364353 [debug] [MainThread]: On master: COMMIT
[0m14:50:23.365038 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:50:23.365405 [debug] [MainThread]: On master: Close
[0m14:50:23.365840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:23.366165 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m14:50:23.366442 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m14:50:23.366714 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m14:50:23.366983 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_stocks' was properly closed.
[0m14:50:23.367361 [info ] [MainThread]: 
[0m14:50:23.367922 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m14:50:23.369513 [debug] [MainThread]: Command end result
[0m14:50:23.397585 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:50:23.400189 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:50:23.407508 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m14:50:23.408049 [info ] [MainThread]: 
[0m14:50:23.408923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:23.409728 [info ] [MainThread]: 
[0m14:50:23.410379 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:50:23.411427 [debug] [MainThread]: Command `-c run` succeeded at 14:50:23.411275 after 4.62 seconds
[0m14:50:23.411823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191DA3C750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191E12FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191853F150>]}
[0m14:50:23.412195 [debug] [MainThread]: Flushing usage events
[0m14:50:24.184904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:57:40.918310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808018050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8088242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808E67ED0>]}


============================== 14:57:40.923891 | 47ecd736-1bfe-49ac-a2f9-14d8628c5446 ==============================
[0m14:57:40.923891 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:57:40.924582 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt clean', 'printer_width': '80', 'target_path': 'None'}
[0m14:57:41.061902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47ecd736-1bfe-49ac-a2f9-14d8628c5446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8081D0180>]}
[0m14:57:41.095718 [debug] [MainThread]: Command `-c clean` succeeded at 14:57:41.095524 after 0.37 seconds
[0m14:57:41.096147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808D0A470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808D09F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808D03B50>]}
[0m14:57:41.096560 [debug] [MainThread]: Flushing usage events
[0m14:57:41.866239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:13:42.051627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC7EC8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC86D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC8D17ED0>]}


============================== 18:13:42.056001 | 778e2293-7214-474e-b4f7-b4d7601ca520 ==============================
[0m18:13:42.056001 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:13:42.056784 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --target prod', 'printer_width': '80', 'target_path': 'None'}
[0m18:13:42.304019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC8080180>]}
[0m18:13:42.369313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC8BBBAC0>]}
[0m18:13:42.371978 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:13:42.624611 [debug] [MainThread]: checksum: fd5f499d60404c73e369f2149bd6aa6c74754a4e78aa98476ca57564d99f7088, vars: {}, profile: , target: prod, version: 1.10.13
[0m18:13:42.703106 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:13:42.703671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC9E15750>]}
[0m18:13:43.925897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC9F8EE40>]}
[0m18:13:43.988711 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:13:43.999904 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:13:44.048272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA6197F0>]}
[0m18:13:44.048755 [info ] [MainThread]: Found 2 models, 2 sources, 461 macros
[0m18:13:44.050762 [info ] [MainThread]: 
[0m18:13:44.051286 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m18:13:44.051746 [info ] [MainThread]: 
[0m18:13:44.052363 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:13:44.057504 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m18:13:44.133632 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m18:13:44.134025 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m18:13:44.134340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:45.359809 [debug] [ThreadPool]: SQL status: OK in 1.225 seconds
[0m18:13:45.361190 [debug] [ThreadPool]: On list_finance: Close
[0m18:13:45.361908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_prod)
[0m18:13:45.362378 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_prod"
"
[0m18:13:45.368133 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m18:13:45.368497 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m18:13:45.368803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:45.370276 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:45.371613 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m18:13:45.371929 [debug] [ThreadPool]: On create_finance_analytics_prod: BEGIN
[0m18:13:45.373109 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:45.373682 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m18:13:45.373999 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
    
        create schema if not exists "finance"."analytics_prod"
    
[0m18:13:45.424623 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m18:13:45.425570 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m18:13:45.425897 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m18:13:45.426194 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m18:13:45.473200 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m18:13:45.473619 [debug] [ThreadPool]: On create_finance_analytics_prod: Close
[0m18:13:45.475121 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_prod'
[0m18:13:45.480423 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m18:13:45.480839 [debug] [ThreadPool]: On list_finance_analytics_prod: BEGIN
[0m18:13:45.481153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:45.482374 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:45.482710 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m18:13:45.483043 [debug] [ThreadPool]: On list_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance_analytics_prod"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_prod'
    and lower(table_catalog) = 'finance'
  
[0m18:13:45.507574 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m18:13:45.509231 [debug] [ThreadPool]: On list_finance_analytics_prod: ROLLBACK
[0m18:13:45.510478 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_prod'
[0m18:13:45.510854 [debug] [ThreadPool]: On list_finance_analytics_prod: Close
[0m18:13:45.512183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA883380>]}
[0m18:13:45.512687 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:45.513019 [debug] [MainThread]: On master: BEGIN
[0m18:13:45.513334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:45.514557 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:45.514914 [debug] [MainThread]: On master: COMMIT
[0m18:13:45.515221 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:45.515511 [debug] [MainThread]: On master: COMMIT
[0m18:13:45.516113 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:45.516433 [debug] [MainThread]: On master: Close
[0m18:13:45.520779 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m18:13:45.521682 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m18:13:45.521311 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_prod.src_stocks .......................... [RUN]
[0m18:13:45.523268 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m18:13:45.523828 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m18:13:45.530855 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m18:13:45.522164 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_prod.src_vix ............................. [RUN]
[0m18:13:45.531605 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m18:13:45.531982 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m18:13:45.536797 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m18:13:45.539292 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m18:13:45.539923 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m18:13:45.569270 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m18:13:45.572445 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m18:13:45.575631 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.576153 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m18:13:45.576560 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:13:45.577387 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m18:13:45.577804 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m18:13:45.578167 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:13:45.578809 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:13:45.579196 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.579577 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_prod"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close"
from src
  );

[0m18:13:45.580234 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:45.580618 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m18:13:45.581008 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_prod"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m18:13:45.655677 [debug] [Thread-2 (]: SQL status: OK in 0.076 seconds
[0m18:13:45.656264 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m18:13:45.661965 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.664506 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m18:13:45.664945 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_prod"."src_vix" rename to "src_vix__dbt_backup"
[0m18:13:45.665389 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_prod"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m18:13:45.713777 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m18:13:45.716800 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.717193 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_prod"."src_vix__dbt_tmp" rename to "src_vix"
[0m18:13:45.717599 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m18:13:45.727514 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m18:13:45.727942 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m18:13:45.728287 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m18:13:45.765464 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m18:13:45.768662 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:13:45.769062 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.769403 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:13:45.856185 [debug] [Thread-2 (]: SQL status: OK in 0.086 seconds
[0m18:13:45.861310 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.861709 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_prod"."src_vix__dbt_backup" cascade
    
[0m18:13:45.862253 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m18:13:45.864497 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m18:13:45.864883 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_prod"."src_stocks__dbt_backup" cascade
    
[0m18:13:45.966596 [debug] [Thread-2 (]: SQL status: OK in 0.104 seconds
[0m18:13:45.968952 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m18:13:45.971379 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA66D850>]}
[0m18:13:45.972726 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m18:13:45.972171 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_prod.src_vix ........................ [[32mOK[0m in 0.44s]
[0m18:13:45.974325 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m18:13:45.974994 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m18:13:45.975611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCAA70680>]}
[0m18:13:45.976397 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_prod.src_stocks ..................... [[32mOK[0m in 0.45s]
[0m18:13:45.977185 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m18:13:45.978775 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:45.979172 [debug] [MainThread]: On master: BEGIN
[0m18:13:45.979481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:45.980676 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:45.981043 [debug] [MainThread]: On master: COMMIT
[0m18:13:45.981347 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:45.981635 [debug] [MainThread]: On master: COMMIT
[0m18:13:45.982236 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:45.982548 [debug] [MainThread]: On master: Close
[0m18:13:45.982977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:45.983324 [debug] [MainThread]: Connection 'create_finance_analytics_prod' was properly closed.
[0m18:13:45.983618 [debug] [MainThread]: Connection 'list_finance_analytics_prod' was properly closed.
[0m18:13:45.983893 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_stocks' was properly closed.
[0m18:13:45.984164 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m18:13:45.984521 [info ] [MainThread]: 
[0m18:13:45.985077 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m18:13:45.986492 [debug] [MainThread]: Command end result
[0m18:13:46.006912 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:13:46.009215 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:13:46.015501 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m18:13:46.015926 [info ] [MainThread]: 
[0m18:13:46.016785 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:46.017498 [info ] [MainThread]: 
[0m18:13:46.018025 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:13:46.018944 [debug] [MainThread]: Command `-c build` succeeded at 18:13:46.018820 after 4.15 seconds
[0m18:13:46.019328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA9AC690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA627EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA518D50>]}
[0m18:13:46.019739 [debug] [MainThread]: Flushing usage events
[0m18:13:46.744053 [debug] [MainThread]: An error was encountered while trying to flush usage events
<<<<<<< HEAD
[0m12:48:23.260576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39BB28050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39C3342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39C973ED0>]}


============================== 12:48:23.265177 | 29d5d14d-0b1e-4c42-960f-43b7dd783c25 ==============================
[0m12:48:23.265177 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:48:23.265860 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select +fct__rsi', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m12:48:23.508254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39BCE0180>]}
[0m12:48:23.572533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39C81B9B0>]}
[0m12:48:23.575231 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:48:23.827197 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:48:23.905984 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:48:23.906557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39DA71B50>]}
[0m12:48:25.171983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39DBEEE40>]}
[0m12:48:25.238688 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:48:25.241000 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:48:25.268220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E245C50>]}
[0m12:48:25.268694 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:48:25.269203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39DE88870>]}
[0m12:48:25.270871 [info ] [MainThread]: 
[0m12:48:25.271364 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:48:25.271828 [info ] [MainThread]: 
[0m12:48:25.272468 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:48:25.277535 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:48:25.355448 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:48:25.355852 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */
=======
[0m20:48:19.314869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001961FEB8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196206C42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019620D03ED0>]}


============================== 20:48:19.325571 | 111018e3-ab84-45ee-af77-7911f083b6ff ==============================
[0m20:48:19.325571 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:48:19.327224 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt parse', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m20:48:19.940469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '111018e3-ab84-45ee-af77-7911f083b6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019620070180>]}
[0m20:48:20.057180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '111018e3-ab84-45ee-af77-7911f083b6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019620BAB9B0>]}
[0m20:48:20.091711 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:48:21.053195 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:48:21.236985 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:48:21.238190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '111018e3-ab84-45ee-af77-7911f083b6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019621E31B50>]}
[0m20:48:26.470820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '111018e3-ab84-45ee-af77-7911f083b6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019621FAAE40>]}
[0m20:48:26.479955 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m20:48:26.611648 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:48:26.641702 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:48:26.644093 [debug] [MainThread]: Command `-c parse` succeeded at 20:48:26.643791 after 7.72 seconds
[0m20:48:26.644864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019620BC3E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019622064BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019622217EE0>]}
[0m20:48:26.645674 [debug] [MainThread]: Flushing usage events
[0m20:48:28.215030 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:53.782491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F1FA38050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F202442D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F20887ED0>]}


============================== 20:48:53.793818 | bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30 ==============================
[0m20:48:53.793818 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:48:53.795560 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select stg__rsi', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m20:48:54.356873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F1FBF0180>]}
[0m20:48:54.467255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F2072B9B0>]}
[0m20:48:54.471229 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:48:54.941820 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:48:55.207157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:48:55.208271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:48:55.313587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F2198B150>]}
[0m20:48:55.447471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:48:55.451584 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:48:55.497053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F206B3E30>]}
[0m20:48:55.497901 [info ] [MainThread]: Found 3 models, 2 sources, 461 macros
[0m20:48:55.498854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F21A23230>]}
[0m20:48:55.501625 [info ] [MainThread]: 
[0m20:48:55.502513 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:48:55.503444 [info ] [MainThread]: 
[0m20:48:55.504875 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:48:55.506867 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m20:49:01.393083 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m20:49:01.394072 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
<<<<<<< HEAD
[0m12:48:25.356171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:27.096239 [debug] [ThreadPool]: SQL status: OK in 1.740 seconds
[0m12:48:27.097624 [debug] [ThreadPool]: On list_finance: Close
[0m12:48:27.098341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:48:27.098818 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:48:27.105499 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:48:27.105905 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */
=======
[0m20:49:01.394884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:03.709439 [debug] [ThreadPool]: SQL status: OK in 2.314 seconds
[0m20:49:03.712988 [debug] [ThreadPool]: On list_finance: Close
[0m20:49:03.714750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m20:49:03.716081 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m20:49:03.731367 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:03.732321 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
<<<<<<< HEAD
[0m12:48:27.106220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:27.107807 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:48:27.109144 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:48:27.109456 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:48:27.110513 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:48:27.110824 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:48:27.111130 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */
=======
[0m20:49:03.733117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:03.736915 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:49:03.740273 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:03.741138 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m20:49:03.743837 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:49:03.744722 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:03.745520 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

    
    
        create schema if not exists "finance"."analytics_dev"
    
<<<<<<< HEAD
[0m12:48:27.160850 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m12:48:27.161821 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:48:27.162165 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:48:27.162481 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:48:27.213547 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m12:48:27.213981 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:48:27.215865 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:48:27.221452 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:48:27.221901 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:48:27.222187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:27.223374 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:48:27.223684 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:48:27.224011 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
=======
[0m20:49:03.817884 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m20:49:03.822096 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:03.823801 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:03.825449 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:03.896702 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m20:49:03.897456 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m20:49:03.906390 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m20:49:03.916764 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:03.917348 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m20:49:03.917818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:03.919549 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:49:03.920113 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:03.920636 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
<<<<<<< HEAD
[0m12:48:27.248249 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m12:48:27.249655 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:48:27.250715 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:48:27.251024 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:48:27.252882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E125250>]}
[0m12:48:27.253314 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:27.253613 [debug] [MainThread]: On master: BEGIN
[0m12:48:27.253895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:27.255129 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:48:27.255443 [debug] [MainThread]: On master: COMMIT
[0m12:48:27.255738 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:27.256018 [debug] [MainThread]: On master: COMMIT
[0m12:48:27.256652 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:48:27.256952 [debug] [MainThread]: On master: Close
[0m12:48:27.262016 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m12:48:27.262561 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m12:48:27.263437 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m12:48:27.263797 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m12:48:27.270405 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m12:48:27.271334 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m12:48:27.302413 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m12:48:27.303523 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:48:27.304099 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m12:48:27.304569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:48:27.306741 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:48:27.307484 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:48:27.307855 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
=======
[0m20:49:03.961650 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m20:49:03.963840 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m20:49:03.994839 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m20:49:03.995429 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m20:49:03.997404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F2208B380>]}
[0m20:49:03.998164 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:03.998699 [debug] [MainThread]: On master: BEGIN
[0m20:49:03.999172 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:04.000925 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:49:04.001504 [debug] [MainThread]: On master: COMMIT
[0m20:49:04.002012 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:04.002498 [debug] [MainThread]: On master: COMMIT
[0m20:49:04.003604 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:04.004292 [debug] [MainThread]: On master: Close
[0m20:49:04.010675 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__rsi
[0m20:49:04.011582 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.stg__rsi ............................. [RUN]
[0m20:49:04.013160 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__rsi'
[0m20:49:04.013877 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__rsi
[0m20:49:04.025832 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__rsi"
[0m20:49:04.028333 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__rsi
[0m20:49:04.079470 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__rsi"
[0m20:49:04.081471 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:04.082124 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: BEGIN
[0m20:49:04.082706 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:49:04.084937 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:04.085721 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:04.086481 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


with recursive wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:04.115069 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


with recursive wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:04.116013 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:49:04.117453 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: ROLLBACK
[0m20:49:04.352567 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.stg__rsi'
[0m20:49:04.353591 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: Close
[0m20:49:04.363452 [debug] [Thread-1 (]: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "with"
  
  LINE 78: with recursive wilder as (
           ^
[0m20:49:04.368545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F220F8650>]}
[0m20:49:04.370251 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.stg__rsi .................... [[31mERROR[0m in 0.35s]
[0m20:49:04.372346 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__rsi
[0m20:49:04.373941 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.stg__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "with"
  
  LINE 78: with recursive wilder as (
           ^.
[0m20:49:04.378701 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:04.379607 [debug] [MainThread]: On master: BEGIN
[0m20:49:04.380380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:04.383014 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m20:49:04.383880 [debug] [MainThread]: On master: COMMIT
[0m20:49:04.384701 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:04.385505 [debug] [MainThread]: On master: COMMIT
[0m20:49:04.387243 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:04.388490 [debug] [MainThread]: On master: Close
[0m20:49:04.389642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:04.390438 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m20:49:04.391168 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m20:49:04.391877 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__rsi' was properly closed.
[0m20:49:04.392639 [info ] [MainThread]: 
[0m20:49:04.394042 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m20:49:04.396215 [debug] [MainThread]: Command end result
[0m20:49:04.444186 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:49:04.447829 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:49:04.459718 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m20:49:04.460368 [info ] [MainThread]: 
[0m20:49:04.461236 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:49:04.462076 [info ] [MainThread]: 
[0m20:49:04.463005 [error] [MainThread]: [31mFailure in model stg__rsi (models\silver\stg__rsi.sql)[0m
[0m20:49:04.463910 [error] [MainThread]:   Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "with"
  
  LINE 78: with recursive wilder as (
           ^
[0m20:49:04.464695 [info ] [MainThread]: 
[0m20:49:04.465516 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\stg__rsi.sql
[0m20:49:04.466274 [info ] [MainThread]: 
[0m20:49:04.467229 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:49:04.468769 [debug] [MainThread]: Command `-c run` failed at 20:49:04.468544 after 10.97 seconds
[0m20:49:04.469439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F220D5BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F221E5D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F221E7C50>]}
[0m20:49:04.470038 [debug] [MainThread]: Flushing usage events
[0m20:49:05.703591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:21.808901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780BE28050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780C6342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780CC77ED0>]}


============================== 20:49:21.815658 | b0342c31-503d-4727-b873-0681fcb97da8 ==============================
[0m20:49:21.815658 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:49:21.816743 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select stg__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m20:49:22.338093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780BFE0180>]}
[0m20:49:22.456812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780CB1B9B0>]}
[0m20:49:22.461293 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:49:23.045476 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:49:23.190228 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:49:23.191265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780DD89B50>]}
[0m20:49:25.273143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780DEFEE40>]}
[0m20:49:25.373088 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:49:25.376269 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:49:25.416548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E541C50>]}
[0m20:49:25.417249 [info ] [MainThread]: Found 3 models, 2 sources, 461 macros
[0m20:49:25.418243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E167C70>]}
[0m20:49:25.420617 [info ] [MainThread]: 
[0m20:49:25.421393 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:49:25.422119 [info ] [MainThread]: 
[0m20:49:25.423099 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:49:25.424628 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m20:49:25.560364 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m20:49:25.561000 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m20:49:25.561527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:27.654626 [debug] [ThreadPool]: SQL status: OK in 2.093 seconds
[0m20:49:27.658365 [debug] [ThreadPool]: On list_finance: Close
[0m20:49:27.660071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m20:49:27.661470 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m20:49:27.675472 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:27.676314 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m20:49:27.677163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:27.680810 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:49:27.684124 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:27.684959 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m20:49:27.687556 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:49:27.688431 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:27.689277 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m20:49:27.751837 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m20:49:27.754173 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:27.755028 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:27.755799 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:27.807902 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m20:49:27.808899 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m20:49:27.822002 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m20:49:27.836589 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:27.837480 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m20:49:27.838238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:27.840908 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:49:27.841714 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:27.842538 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m20:49:27.897035 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m20:49:27.899170 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m20:49:27.900695 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m20:49:27.901182 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m20:49:27.903201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E52DE50>]}
[0m20:49:27.904106 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:27.904693 [debug] [MainThread]: On master: BEGIN
[0m20:49:27.905306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:27.907505 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:49:27.908205 [debug] [MainThread]: On master: COMMIT
[0m20:49:27.908881 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:27.909563 [debug] [MainThread]: On master: COMMIT
[0m20:49:27.910841 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:27.911457 [debug] [MainThread]: On master: Close
[0m20:49:27.919392 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__rsi
[0m20:49:27.920523 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.stg__rsi ............................. [RUN]
[0m20:49:27.921802 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__rsi'
[0m20:49:27.922515 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__rsi
[0m20:49:27.936105 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__rsi"
[0m20:49:27.937747 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__rsi
[0m20:49:27.997293 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__rsi"
[0m20:49:27.999033 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:27.999770 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: BEGIN
[0m20:49:28.000444 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:49:28.003012 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:28.003767 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:28.004716 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


recursive wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:28.031878 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


recursive wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:28.033097 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:49:28.033994 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: ROLLBACK
[0m20:49:28.046646 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.stg__rsi'
[0m20:49:28.047408 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: Close
[0m20:49:28.057213 [debug] [Thread-1 (]: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "wilder"
  
  LINE 78: recursive wilder as (
                     ^
[0m20:49:28.060850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E7495A0>]}
[0m20:49:28.062081 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.stg__rsi .................... [[31mERROR[0m in 0.14s]
[0m20:49:28.063647 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__rsi
[0m20:49:28.064854 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.stg__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "wilder"
  
  LINE 78: recursive wilder as (
                     ^.
[0m20:49:28.068444 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:28.069112 [debug] [MainThread]: On master: BEGIN
[0m20:49:28.069707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:28.071967 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:49:28.073028 [debug] [MainThread]: On master: COMMIT
[0m20:49:28.073690 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:28.074269 [debug] [MainThread]: On master: COMMIT
[0m20:49:28.075484 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:28.076106 [debug] [MainThread]: On master: Close
[0m20:49:28.076856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:28.077402 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m20:49:28.077931 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m20:49:28.078443 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__rsi' was properly closed.
[0m20:49:28.079015 [info ] [MainThread]: 
[0m20:49:28.079896 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m20:49:28.081581 [debug] [MainThread]: Command end result
[0m20:49:28.127657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:49:28.131797 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:49:28.143095 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m20:49:28.143736 [info ] [MainThread]: 
[0m20:49:28.144816 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:49:28.145723 [info ] [MainThread]: 
[0m20:49:28.146768 [error] [MainThread]: [31mFailure in model stg__rsi (models\silver\stg__rsi.sql)[0m
[0m20:49:28.147986 [error] [MainThread]:   Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "wilder"
  
  LINE 78: recursive wilder as (
                     ^
[0m20:49:28.148905 [info ] [MainThread]: 
[0m20:49:28.149965 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\stg__rsi.sql
[0m20:49:28.150794 [info ] [MainThread]: 
[0m20:49:28.151671 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:49:28.153336 [debug] [MainThread]: Command `-c run` failed at 20:49:28.153103 after 6.53 seconds
[0m20:49:28.154215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E51A530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E54DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E722C50>]}
[0m20:49:28.155532 [debug] [MainThread]: Flushing usage events
[0m20:49:29.436579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:42.038086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FFA28050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1812E42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F181923ED0>]}


============================== 20:49:42.045560 | 5ea5a74c-428f-4309-ac17-91512b519e1f ==============================
[0m20:49:42.045560 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:49:42.046942 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt run --select stg__rsi', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m20:49:42.451743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FFBE0180>]}
[0m20:49:42.570146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1817CB9B0>]}
[0m20:49:42.575815 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:49:43.014978 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:49:43.187376 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:49:43.188428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F182A71B50>]}
[0m20:49:45.780008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F182BEAE40>]}
[0m20:49:45.888411 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:49:45.892049 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:49:45.942408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F183235C50>]}
[0m20:49:45.943312 [info ] [MainThread]: Found 3 models, 2 sources, 461 macros
[0m20:49:45.944300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F182E53C70>]}
[0m20:49:45.947326 [info ] [MainThread]: 
[0m20:49:45.948417 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:49:45.949331 [info ] [MainThread]: 
[0m20:49:45.950582 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:49:45.952481 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m20:49:46.108798 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m20:49:46.109526 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m20:49:46.110137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:47.713087 [debug] [ThreadPool]: SQL status: OK in 1.603 seconds
[0m20:49:47.716754 [debug] [ThreadPool]: On list_finance: Close
[0m20:49:47.718901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m20:49:47.720184 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m20:49:47.735864 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:47.737252 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m20:49:47.738120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:47.741779 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:49:47.745396 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:47.746287 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m20:49:47.748800 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:49:47.749677 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:47.750498 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m20:49:47.817504 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m20:49:47.819799 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:47.820707 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:47.821507 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:47.894450 [debug] [ThreadPool]: SQL status: OK in 0.072 seconds
[0m20:49:47.895473 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m20:49:47.908991 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m20:49:47.922883 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:47.923800 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m20:49:47.924694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:47.927550 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:49:47.928452 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:47.929277 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m20:49:47.993610 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m20:49:47.997025 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m20:49:47.999590 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m20:49:48.000359 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m20:49:48.002955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F183225E50>]}
[0m20:49:48.004149 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:48.004781 [debug] [MainThread]: On master: BEGIN
[0m20:49:48.005406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:48.007969 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m20:49:48.008809 [debug] [MainThread]: On master: COMMIT
[0m20:49:48.009476 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:48.010100 [debug] [MainThread]: On master: COMMIT
[0m20:49:48.011405 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:48.012098 [debug] [MainThread]: On master: Close
[0m20:49:48.020839 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__rsi
[0m20:49:48.021989 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.stg__rsi ............................. [RUN]
[0m20:49:48.023824 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__rsi'
[0m20:49:48.024750 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__rsi
[0m20:49:48.039293 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__rsi"
[0m20:49:48.041575 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__rsi
[0m20:49:48.109369 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__rsi"
[0m20:49:48.111356 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:48.112910 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: BEGIN
[0m20:49:48.113816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:49:48.116718 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:48.117615 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:48.118736 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:48.200449 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:48.201639 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:49:48.202589 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: ROLLBACK
[0m20:49:48.217589 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.stg__rsi'
[0m20:49:48.218512 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: Close
[0m20:49:48.227877 [debug] [Thread-1 (]: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Binder Error: Referenced column "loaded_at" not found in FROM clause!
  Candidate bindings: "trade_date", "close", "daily_gain", "daily_change", "sma_gain"
  
  LINE 72: ...number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
                                                                         ^
[0m20:49:48.231783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1834394F0>]}
[0m20:49:48.233224 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.stg__rsi .................... [[31mERROR[0m in 0.21s]
[0m20:49:48.234924 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__rsi
[0m20:49:48.236261 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.stg__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Binder Error: Referenced column "loaded_at" not found in FROM clause!
  Candidate bindings: "trade_date", "close", "daily_gain", "daily_change", "sma_gain"
  
  LINE 72: ...number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
                                                                         ^.
[0m20:49:48.240693 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:48.241475 [debug] [MainThread]: On master: BEGIN
[0m20:49:48.242123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:48.244397 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:49:48.245098 [debug] [MainThread]: On master: COMMIT
[0m20:49:48.245766 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:48.246417 [debug] [MainThread]: On master: COMMIT
[0m20:49:48.247873 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:48.248623 [debug] [MainThread]: On master: Close
[0m20:49:48.249502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:48.250123 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m20:49:48.250720 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m20:49:48.251294 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__rsi' was properly closed.
[0m20:49:48.251917 [info ] [MainThread]: 
[0m20:49:48.252871 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m20:49:48.254653 [debug] [MainThread]: Command end result
[0m20:49:48.317301 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:49:48.322924 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:49:48.336327 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m20:49:48.337343 [info ] [MainThread]: 
[0m20:49:48.338745 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:49:48.339868 [info ] [MainThread]: 
[0m20:49:48.342006 [error] [MainThread]: [31mFailure in model stg__rsi (models\silver\stg__rsi.sql)[0m
[0m20:49:48.343393 [error] [MainThread]:   Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Binder Error: Referenced column "loaded_at" not found in FROM clause!
  Candidate bindings: "trade_date", "close", "daily_gain", "daily_change", "sma_gain"
  
  LINE 72: ...number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
                                                                         ^
[0m20:49:48.344621 [info ] [MainThread]: 
[0m20:49:48.346286 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\stg__rsi.sql
[0m20:49:48.347455 [info ] [MainThread]: 
[0m20:49:48.358514 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:49:48.374762 [debug] [MainThread]: Command `-c run` failed at 20:49:48.374190 after 6.54 seconds
[0m20:49:48.376429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18320E530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F183241D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FFB70F50>]}
[0m20:49:48.378174 [debug] [MainThread]: Flushing usage events
[0m20:49:49.834253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:25.119211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F43E88050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F446942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F44CD7ED0>]}


============================== 20:50:25.126201 | c1cc3688-3a5f-477b-b62f-c1e5310bff93 ==============================
[0m20:50:25.126201 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:50:25.127405 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select stg__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m20:50:25.497793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F44040180>]}
[0m20:50:25.593469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F44B7B9B0>]}
[0m20:50:25.597044 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:50:25.976212 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:50:26.095587 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:50:26.096449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F45DD9B50>]}
[0m20:50:27.956372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F45F4EE40>]}
[0m20:50:28.058459 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:50:28.061747 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:50:28.096517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F46595C50>]}
[0m20:50:28.097170 [info ] [MainThread]: Found 3 models, 2 sources, 461 macros
[0m20:50:28.097846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F461B3C70>]}
[0m20:50:28.099896 [info ] [MainThread]: 
[0m20:50:28.100595 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:50:28.101263 [info ] [MainThread]: 
[0m20:50:28.102166 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:50:28.103652 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m20:50:28.234893 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m20:50:28.235515 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m20:50:28.236031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:29.915685 [debug] [ThreadPool]: SQL status: OK in 1.679 seconds
[0m20:50:29.919089 [debug] [ThreadPool]: On list_finance: Close
[0m20:50:29.921117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m20:50:29.922412 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m20:50:29.937430 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:50:29.938346 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m20:50:29.939144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:29.942873 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:50:29.946389 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:50:29.947226 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m20:50:29.949743 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:50:29.950560 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:50:29.951351 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m20:50:30.022548 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m20:50:30.025105 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:50:30.026189 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:50:30.027005 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:50:30.089333 [debug] [ThreadPool]: SQL status: OK in 0.061 seconds
[0m20:50:30.090290 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m20:50:30.103292 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m20:50:30.117077 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:50:30.117984 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m20:50:30.118739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:30.121459 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:50:30.122308 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:50:30.123181 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m20:50:30.184419 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m20:50:30.187258 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m20:50:30.189309 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m20:50:30.189956 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m20:50:30.192512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4657DE50>]}
[0m20:50:30.193308 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:30.193893 [debug] [MainThread]: On master: BEGIN
[0m20:50:30.194380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:30.196257 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:50:30.196790 [debug] [MainThread]: On master: COMMIT
[0m20:50:30.197365 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:30.197855 [debug] [MainThread]: On master: COMMIT
[0m20:50:30.198870 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:50:30.199401 [debug] [MainThread]: On master: Close
[0m20:50:30.206117 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__rsi
[0m20:50:30.206979 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.stg__rsi ............................. [RUN]
[0m20:50:30.208145 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__rsi'
[0m20:50:30.208789 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__rsi
[0m20:50:30.220055 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__rsi"
[0m20:50:30.221506 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__rsi
[0m20:50:30.270261 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__rsi"
[0m20:50:30.271716 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:50:30.272323 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: BEGIN
[0m20:50:30.272886 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:50:30.275800 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:50:30.276493 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:50:30.277305 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        loaded_at,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:50:30.359519 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        loaded_at,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:50:30.360547 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:50:30.361402 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: ROLLBACK
[0m20:50:30.373376 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.stg__rsi'
[0m20:50:30.374452 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: Close
[0m20:50:30.381896 [debug] [Thread-1 (]: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Catalog Error: Table with name wilder does not exist!
  Did you mean "pg_index"?
  
  LINE 104:     join wilder prev
                     ^
[0m20:50:30.385086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F467995A0>]}
[0m20:50:30.386169 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.stg__rsi .................... [[31mERROR[0m in 0.17s]
[0m20:50:30.387440 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__rsi
[0m20:50:30.388448 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.stg__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Catalog Error: Table with name wilder does not exist!
  Did you mean "pg_index"?
  
  LINE 104:     join wilder prev
                     ^.
[0m20:50:30.391447 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:30.392025 [debug] [MainThread]: On master: BEGIN
[0m20:50:30.392523 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:30.394407 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:50:30.395008 [debug] [MainThread]: On master: COMMIT
[0m20:50:30.395563 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:30.396040 [debug] [MainThread]: On master: COMMIT
[0m20:50:30.397004 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:50:30.397510 [debug] [MainThread]: On master: Close
[0m20:50:30.398352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:30.399264 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m20:50:30.399921 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m20:50:30.400365 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__rsi' was properly closed.
[0m20:50:30.400854 [info ] [MainThread]: 
[0m20:50:30.401550 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m20:50:30.402948 [debug] [MainThread]: Command end result
[0m20:50:30.441501 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:50:30.445051 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:50:30.455340 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m20:50:30.455970 [info ] [MainThread]: 
[0m20:50:30.456990 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:50:30.457837 [info ] [MainThread]: 
[0m20:50:30.458811 [error] [MainThread]: [31mFailure in model stg__rsi (models\silver\stg__rsi.sql)[0m
[0m20:50:30.459778 [error] [MainThread]:   Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Catalog Error: Table with name wilder does not exist!
  Did you mean "pg_index"?
  
  LINE 104:     join wilder prev
                     ^
[0m20:50:30.460874 [info ] [MainThread]: 
[0m20:50:30.462368 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\stg__rsi.sql
[0m20:50:30.463292 [info ] [MainThread]: 
[0m20:50:30.464209 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:50:30.465801 [debug] [MainThread]: Command `-c run` failed at 20:50:30.465567 after 5.55 seconds
[0m20:50:30.466541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F46562530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4659DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F46772C50>]}
[0m20:50:30.467258 [debug] [MainThread]: Flushing usage events
[0m20:50:31.464541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:42.759070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021933098050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219338A42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021933EE3ED0>]}


============================== 12:38:42.765569 | c3c0a9d0-7cbd-4c4b-8e01-dd920b403997 ==============================
[0m12:38:42.765569 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:38:42.766237 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m12:38:43.188944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3c0a9d0-7cbd-4c4b-8e01-dd920b403997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021933250180>]}
[0m12:38:43.252910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3c0a9d0-7cbd-4c4b-8e01-dd920b403997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021933D8B9B0>]}
[0m12:38:43.271380 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:38:43.687760 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:38:43.765406 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:38:43.766066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3c0a9d0-7cbd-4c4b-8e01-dd920b403997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021934FDDB50>]}
[0m12:38:46.187167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3c0a9d0-7cbd-4c4b-8e01-dd920b403997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193515EE40>]}
[0m12:38:46.191038 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m12:38:46.260167 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:38:46.283619 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:38:46.284420 [debug] [MainThread]: Command `-c parse` succeeded at 12:38:46.284300 after 3.70 seconds
[0m12:38:46.284784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021933DA3E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021935210C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219353C7EE0>]}
[0m12:38:46.285144 [debug] [MainThread]: Flushing usage events
[0m12:38:47.035873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:36.728689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132C608050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132CE142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D457ED0>]}


============================== 12:39:36.732893 | 1647c0db-536d-40d7-9ec6-dccf16440c45 ==============================
[0m12:39:36.732893 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:39:36.733529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'invocation_command': 'dbt clean', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m12:39:36.867135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1647c0db-536d-40d7-9ec6-dccf16440c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132C7C0180>]}
[0m12:39:36.901861 [debug] [MainThread]: Command `-c clean` succeeded at 12:39:36.901696 after 0.30 seconds
[0m12:39:36.902268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D2FA470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D2F9F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D2F3A50>]}
[0m12:39:36.902648 [debug] [MainThread]: Flushing usage events
[0m12:39:37.819313 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:41.068807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE659A8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE661B42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE667F3ED0>]}


============================== 12:39:41.073626 | 3479392e-08f1-424d-bf45-fff4c452d3b3 ==============================
[0m12:39:41.073626 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:39:41.074544 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt parse', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m12:39:41.353453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3479392e-08f1-424d-bf45-fff4c452d3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE65B60180>]}
[0m12:39:41.418345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3479392e-08f1-424d-bf45-fff4c452d3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6669B9B0>]}
[0m12:39:41.420938 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:39:41.661486 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:39:41.662444 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:39:41.663010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3479392e-08f1-424d-bf45-fff4c452d3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE66911350>]}
[0m12:39:42.884989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3479392e-08f1-424d-bf45-fff4c452d3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE67ADEE40>]}
[0m12:39:42.888969 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m12:39:42.966614 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:39:42.968975 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:39:42.969858 [debug] [MainThread]: Command `-c parse` succeeded at 12:39:42.969737 after 2.02 seconds
[0m12:39:42.970228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE5FE302F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE67F24AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE67E13EE0>]}
[0m12:39:42.970590 [debug] [MainThread]: Flushing usage events
[0m12:39:43.784187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:00.128484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FB0D8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FB8E42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FBF27ED0>]}


============================== 12:40:00.132848 | 5e845d5e-fc7e-42ff-985c-0dcb8db987d7 ==============================
[0m12:40:00.132848 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:40:00.133538 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_rsi', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m12:40:00.370288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e845d5e-fc7e-42ff-985c-0dcb8db987d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FB290180>]}
[0m12:40:00.434405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e845d5e-fc7e-42ff-985c-0dcb8db987d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FBDCB9B0>]}
[0m12:40:00.436841 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:40:00.681818 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:40:00.807443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:00.807801 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:00.841419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e845d5e-fc7e-42ff-985c-0dcb8db987d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FD017350>]}
[0m12:40:00.913734 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:00.916261 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:00.953083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e845d5e-fc7e-42ff-985c-0dcb8db987d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FBD53E30>]}
[0m12:40:00.953574 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:40:00.954086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e845d5e-fc7e-42ff-985c-0dcb8db987d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FD0B3230>]}
[0m12:40:00.954996 [warn ] [MainThread]: The selection criterion 'fct_rsi' does not match any enabled nodes
[0m12:40:00.956340 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:40:00.958533 [debug] [MainThread]: Command end result
[0m12:40:00.979395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:00.982239 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:00.986575 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:40:00.987903 [debug] [MainThread]: Command `-c run` succeeded at 12:40:00.987728 after 0.99 seconds
[0m12:40:00.988541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FD5D7D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FBD1B1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FD59F7D0>]}
[0m12:40:00.989205 [debug] [MainThread]: Flushing usage events
[0m12:40:01.829410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:10.259052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266366C8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026636ED42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026637517ED0>]}


============================== 12:40:10.263478 | abaabc25-e582-4b7d-afb3-3971ac46d6e2 ==============================
[0m12:40:10.263478 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:40:10.264186 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select fct__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m12:40:10.506114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026636880180>]}
[0m12:40:10.570624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266373BB9B0>]}
[0m12:40:10.573177 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:40:10.823913 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:40:10.936860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:10.937209 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:10.970132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638617350>]}
[0m12:40:11.040547 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:11.042772 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:11.068722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026637343E30>]}
[0m12:40:11.069181 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:40:11.069812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266386AF230>]}
[0m12:40:11.071288 [info ] [MainThread]: 
[0m12:40:11.071879 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:11.072427 [info ] [MainThread]: 
[0m12:40:11.073229 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:40:11.074248 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:40:13.709721 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:40:13.710105 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m12:40:13.710414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:21.676716 [debug] [ThreadPool]: SQL status: OK in 7.966 seconds
[0m12:40:21.678466 [debug] [ThreadPool]: On list_finance: Close
[0m12:40:21.679299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:40:21.680001 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:40:21.686602 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:21.687023 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m12:40:21.687333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:21.689338 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:40:21.690894 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:21.691279 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:40:21.692441 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:40:21.692786 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:21.693122 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m12:40:21.753475 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m12:40:21.754503 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:40:21.754897 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:21.755241 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:40:21.803452 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m12:40:21.803907 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:40:21.810016 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:40:21.816153 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:40:21.816651 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:40:21.817011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:21.818950 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:40:21.819372 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:40:21.819720 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m12:40:21.854238 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m12:40:21.856773 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:40:21.872256 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:40:21.872929 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:40:21.874589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638D0BA00>]}
[0m12:40:21.875180 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:21.875496 [debug] [MainThread]: On master: BEGIN
[0m12:40:21.875786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:21.876881 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:40:21.877212 [debug] [MainThread]: On master: COMMIT
[0m12:40:21.877518 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:21.877809 [debug] [MainThread]: On master: COMMIT
[0m12:40:21.878388 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:40:21.878702 [debug] [MainThread]: On master: Close
[0m12:40:21.884162 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:40:21.884741 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:40:21.885472 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.fct__rsi'
[0m12:40:21.885865 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:40:21.893083 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:40:21.894872 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:40:21.928959 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:40:21.930978 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:40:21.931448 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:40:21.931820 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:21.933182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:40:21.933604 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:40:21.934042 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:40:22.079976 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:40:22.080595 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:40:22.081084 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: ROLLBACK
[0m12:40:22.208768 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.fct__rsi'
[0m12:40:22.209207 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:40:22.213613 [debug] [Thread-1 (]: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^
[0m12:40:22.215638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638D950D0>]}
[0m12:40:22.216264 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.fct__rsi .................... [[31mERROR[0m in 0.33s]
[0m12:40:22.217070 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:40:22.217669 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^.
[0m12:40:22.219613 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:22.219945 [debug] [MainThread]: On master: BEGIN
[0m12:40:22.220244 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:22.221641 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:40:22.221969 [debug] [MainThread]: On master: COMMIT
[0m12:40:22.222262 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:22.222542 [debug] [MainThread]: On master: COMMIT
[0m12:40:22.223396 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:40:22.223770 [debug] [MainThread]: On master: Close
[0m12:40:22.224162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:22.224434 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:40:22.224691 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:40:22.224949 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:40:22.225243 [info ] [MainThread]: 
[0m12:40:22.225760 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 11.15 seconds (11.15s).
[0m12:40:22.226636 [debug] [MainThread]: Command end result
[0m12:40:22.251137 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:22.253738 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:22.260308 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:40:22.260907 [info ] [MainThread]: 
[0m12:40:22.261759 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:40:22.262676 [info ] [MainThread]: 
[0m12:40:22.263497 [error] [MainThread]: [31mFailure in model fct__rsi (models\gold\fct__rsi.sql)[0m
[0m12:40:22.264280 [error] [MainThread]:   Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^
[0m12:40:22.265090 [info ] [MainThread]: 
[0m12:40:22.265866 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\fct__rsi.sql
[0m12:40:22.266436 [info ] [MainThread]: 
[0m12:40:22.267105 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:40:22.268481 [debug] [MainThread]: Command `-c run` failed at 12:40:22.268313 after 12.13 seconds
[0m12:40:22.268994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638D6CF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638E6A2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638E69E50>]}
[0m12:40:22.269692 [debug] [MainThread]: Flushing usage events
[0m12:40:23.094324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:53.908356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F2128050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F29342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F2F77ED0>]}


============================== 12:40:53.912510 | ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb ==============================
[0m12:40:53.912510 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:40:53.913146 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select *fct__rsi', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m12:40:54.149646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F22E0180>]}
[0m12:40:54.213414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F2E1B9B0>]}
[0m12:40:54.215766 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:40:54.465868 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:40:54.581338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:54.581689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:54.614989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F4167350>]}
[0m12:40:54.686014 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:54.688215 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:54.715383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F2E0B2F0>]}
[0m12:40:54.715863 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:40:54.716362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F4203230>]}
[0m12:40:54.717895 [info ] [MainThread]: 
[0m12:40:54.718429 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:54.718886 [info ] [MainThread]: 
[0m12:40:54.719515 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:40:54.720436 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:40:54.802501 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:40:54.802896 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m12:40:54.803210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:56.512850 [debug] [ThreadPool]: SQL status: OK in 1.710 seconds
[0m12:40:56.514368 [debug] [ThreadPool]: On list_finance: Close
[0m12:40:56.515164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:40:56.515630 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:40:56.521483 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:56.521822 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m12:40:56.522132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:56.523709 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:40:56.525021 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:56.525349 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:40:56.526404 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:40:56.526726 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:56.527031 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m12:40:56.579257 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m12:40:56.580218 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:40:56.580553 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:56.580855 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:40:56.743806 [debug] [ThreadPool]: SQL status: OK in 0.163 seconds
[0m12:40:56.744217 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:40:56.749726 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:40:56.755112 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:40:56.755463 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:40:56.755747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:56.756926 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:40:56.757274 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:40:56.757576 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m12:40:56.780497 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:40:56.781835 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:40:56.782858 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:40:56.783165 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:40:56.784382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F485BA00>]}
[0m12:40:56.784935 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:56.785231 [debug] [MainThread]: On master: BEGIN
[0m12:40:56.785509 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:56.786743 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:40:56.787098 [debug] [MainThread]: On master: COMMIT
[0m12:40:56.787414 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:56.787716 [debug] [MainThread]: On master: COMMIT
[0m12:40:56.788398 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:40:56.788712 [debug] [MainThread]: On master: Close
[0m12:40:56.793315 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:40:56.793843 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:40:56.794671 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.fct__rsi'
[0m12:40:56.795068 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:40:56.801834 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:40:56.802783 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:40:56.833900 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:40:56.834876 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:40:56.835258 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:40:56.835604 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:56.836946 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:40:56.837325 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:40:56.837744 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:40:56.898187 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:40:56.898713 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:40:56.899190 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: ROLLBACK
[0m12:40:56.905891 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.fct__rsi'
[0m12:40:56.906301 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:40:56.910648 [debug] [Thread-1 (]: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^
[0m12:40:56.912685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F48E50D0>]}
[0m12:40:56.913315 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.fct__rsi .................... [[31mERROR[0m in 0.12s]
[0m12:40:56.914131 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:40:56.914741 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^.
[0m12:40:56.916574 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:56.916905 [debug] [MainThread]: On master: BEGIN
[0m12:40:56.917210 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:56.918468 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:40:56.918877 [debug] [MainThread]: On master: COMMIT
[0m12:40:56.919182 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:56.919469 [debug] [MainThread]: On master: COMMIT
[0m12:40:56.920038 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:40:56.920354 [debug] [MainThread]: On master: Close
[0m12:40:56.920741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:56.921019 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:40:56.921291 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:40:56.921554 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:40:56.921851 [info ] [MainThread]: 
[0m12:40:56.922335 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m12:40:56.923213 [debug] [MainThread]: Command end result
[0m12:40:56.944507 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:56.947271 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:56.953780 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:40:56.954144 [info ] [MainThread]: 
[0m12:40:56.954674 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:40:56.955201 [info ] [MainThread]: 
[0m12:40:56.955753 [error] [MainThread]: [31mFailure in model fct__rsi (models\gold\fct__rsi.sql)[0m
[0m12:40:56.956306 [error] [MainThread]:   Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^
[0m12:40:56.956796 [info ] [MainThread]: 
[0m12:40:56.957332 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\fct__rsi.sql
[0m12:40:56.957820 [info ] [MainThread]: 
[0m12:40:56.958366 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:40:56.959298 [debug] [MainThread]: Command `-c run` failed at 12:40:56.959180 after 3.17 seconds
[0m12:40:56.959737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F48BCF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F49E2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F4A6D1D0>]}
[0m12:40:56.960127 [debug] [MainThread]: Flushing usage events
[0m12:40:57.864414 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:57.843528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A72F88050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A737942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73DD7ED0>]}


============================== 12:41:57.847975 | e7d7796d-4b55-4b47-a15a-f8a95b482e95 ==============================
[0m12:41:57.847975 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:41:57.848740 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --select +fct__rsi', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m12:41:58.112028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73140180>]}
[0m12:41:58.183530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73C7B9B0>]}
[0m12:41:58.186204 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:41:58.454718 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:41:58.587532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:41:58.587908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:41:58.625981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A74F17350>]}
[0m12:41:58.708661 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:41:58.711062 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:41:58.740641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73C03E30>]}
[0m12:41:58.741256 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:41:58.741893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A74FB3230>]}
[0m12:41:58.743768 [info ] [MainThread]: 
[0m12:41:58.744464 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:41:58.745130 [info ] [MainThread]: 
[0m12:41:58.745982 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:41:58.751156 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:41:58.839439 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:41:58.839860 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m12:41:58.840179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:00.469764 [debug] [ThreadPool]: SQL status: OK in 1.629 seconds
[0m12:42:00.471209 [debug] [ThreadPool]: On list_finance: Close
[0m12:42:00.472029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:42:00.472636 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:42:00.479805 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:00.480182 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m12:42:00.480480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:00.482145 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:42:00.483430 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:00.483738 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:42:00.484706 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:00.485004 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:00.485294 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m12:42:00.542873 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m12:42:00.544076 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:00.544460 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:00.544772 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:00.591328 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m12:42:00.591742 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:42:00.593552 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:42:00.598908 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:00.599264 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:42:00.599556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:00.600675 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:00.600989 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:00.601303 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m12:42:00.624553 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:42:00.626009 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:42:00.627082 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:42:00.627416 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:42:00.628667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7560FA00>]}
[0m12:42:00.629157 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:00.629487 [debug] [MainThread]: On master: BEGIN
[0m12:42:00.629795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:00.630976 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:00.631323 [debug] [MainThread]: On master: COMMIT
[0m12:42:00.631664 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:00.631957 [debug] [MainThread]: On master: COMMIT
[0m12:42:00.632550 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:00.632863 [debug] [MainThread]: On master: Close
[0m12:42:00.637368 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m12:42:00.637903 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m12:42:00.638595 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m12:42:00.638978 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m12:42:00.645920 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m12:42:00.648050 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m12:42:00.681649 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m12:42:00.683194 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.683653 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m12:42:00.684029 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:00.685431 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:00.685811 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.686180 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

<<<<<<< HEAD
[0m12:48:27.375254 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m12:48:27.382168 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:48:27.382745 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m12:48:27.439332 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m12:48:27.442008 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:48:27.442430 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m12:48:27.500010 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m12:48:27.512485 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:48:27.512919 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:48:27.513271 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:48:27.738122 [debug] [Thread-1 (]: SQL status: OK in 0.224 seconds
[0m12:48:27.743293 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:48:27.743698 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m12:48:27.854823 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m12:48:27.857311 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m12:48:27.859485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E43D2E0>]}
[0m12:48:27.860166 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.59s]
[0m12:48:27.861221 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m12:48:27.861990 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m12:48:27.862620 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_dev.int__price_changes ................... [RUN]
[0m12:48:27.863451 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m12:48:27.864011 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m12:48:27.866895 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m12:48:27.867931 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m12:48:27.873209 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m12:48:27.874194 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:48:27.874669 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m12:48:27.875039 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:48:27.876321 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:48:27.876703 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:48:27.877159 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
=======
[0m12:42:00.733917 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m12:42:00.739562 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.739989 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m12:42:00.803755 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m12:42:00.806384 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.806767 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m12:42:00.847442 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m12:42:00.859720 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:00.860172 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.860545 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:00.977443 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m12:42:00.982506 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.982885 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m12:42:01.088978 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m12:42:01.091296 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m12:42:01.093636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A75675CD0>]}
[0m12:42:01.094350 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.45s]
[0m12:42:01.095241 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m12:42:01.096005 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m12:42:01.096477 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_dev.int__price_changes ................... [RUN]
[0m12:42:01.097233 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m12:42:01.097592 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m12:42:01.099949 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m12:42:01.101498 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m12:42:01.104448 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m12:42:01.105845 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:01.106240 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m12:42:01.106611 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:42:01.107871 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:42:01.108359 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:01.108842 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

<<<<<<< HEAD
[0m12:48:27.974215 [debug] [Thread-2 (]: SQL status: OK in 0.096 seconds
[0m12:48:27.977001 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:48:27.977426 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m12:48:28.026207 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m12:48:28.029266 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:48:28.030231 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m12:48:28.085174 [debug] [Thread-2 (]: SQL status: OK in 0.054 seconds
[0m12:48:28.086634 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:48:28.087068 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:48:28.087426 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:48:28.266132 [debug] [Thread-2 (]: SQL status: OK in 0.178 seconds
[0m12:48:28.268598 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:48:28.268994 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m12:48:28.375900 [debug] [Thread-2 (]: SQL status: OK in 0.106 seconds
[0m12:48:28.377392 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m12:48:28.377926 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E6039D0>]}
[0m12:48:28.378499 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_dev.int__price_changes .............. [[32mOK[0m in 0.51s]
[0m12:48:28.379439 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m12:48:28.380109 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m12:48:28.380778 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_dev.int__rsi_sma ......................... [RUN]
[0m12:48:28.381532 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_sma'
[0m12:48:28.381884 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m12:48:28.384234 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.385121 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m12:48:28.388056 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.388911 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.389324 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m12:48:28.389662 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:48:28.390974 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:48:28.391333 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.391715 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
=======
[0m12:42:01.179316 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m12:42:01.181928 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:01.182323 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m12:42:01.232917 [debug] [Thread-2 (]: SQL status: OK in 0.050 seconds
[0m12:42:01.234264 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:42:01.234661 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:01.235015 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:42:01.327903 [debug] [Thread-2 (]: SQL status: OK in 0.092 seconds
[0m12:42:01.330425 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:01.330843 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m12:42:01.447875 [debug] [Thread-2 (]: SQL status: OK in 0.117 seconds
[0m12:42:01.449315 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m12:42:01.449833 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7566DB20>]}
[0m12:42:01.450401 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_dev.int__price_changes .............. [[32mOK[0m in 0.35s]
[0m12:42:01.451331 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m12:42:01.452140 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m12:42:01.452909 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_dev.int__rsi_sma ......................... [RUN]
[0m12:42:01.453708 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_sma'
[0m12:42:01.454197 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m12:42:01.457334 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.458893 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m12:42:01.462404 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.463534 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.464002 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m12:42:01.464392 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:42:01.466094 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:42:01.466673 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.467261 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    sma_gain::decimal as sma_gain,
    sma_loss::decimal as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

<<<<<<< HEAD
[0m12:48:28.479535 [debug] [Thread-3 (]: SQL status: OK in 0.087 seconds
[0m12:48:28.482192 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.482586 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m12:48:28.529160 [debug] [Thread-3 (]: SQL status: OK in 0.046 seconds
[0m12:48:28.531875 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.532289 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m12:48:28.578797 [debug] [Thread-3 (]: SQL status: OK in 0.046 seconds
[0m12:48:28.580592 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:48:28.580990 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.581344 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:48:28.683354 [debug] [Thread-3 (]: SQL status: OK in 0.102 seconds
[0m12:48:28.685606 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.685980 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m12:48:28.775440 [debug] [Thread-3 (]: SQL status: OK in 0.089 seconds
[0m12:48:28.777379 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m12:48:28.777918 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E505F50>]}
[0m12:48:28.778530 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_dev.int__rsi_sma .................... [[32mOK[0m in 0.40s]
[0m12:48:28.779488 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m12:48:28.780212 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m12:48:28.780700 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_dev.int__rsi_wilder ...................... [RUN]
[0m12:48:28.781517 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_wilder'
[0m12:48:28.781888 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m12:48:28.784841 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:28.785748 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m12:48:28.788832 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:28.789709 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:28.790130 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m12:48:28.790468 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:48:28.791673 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:48:28.792033 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:28.792412 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
=======
[0m12:42:01.540453 [debug] [Thread-3 (]: SQL status: OK in 0.073 seconds
[0m12:42:01.543214 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.543616 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m12:42:01.587528 [debug] [Thread-3 (]: SQL status: OK in 0.043 seconds
[0m12:42:01.588812 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:42:01.589195 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.589536 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:42:01.676809 [debug] [Thread-3 (]: SQL status: OK in 0.087 seconds
[0m12:42:01.678860 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.679233 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m12:42:01.721423 [debug] [Thread-3 (]: SQL status: OK in 0.042 seconds
[0m12:42:01.722860 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m12:42:01.723369 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A75822AD0>]}
[0m12:42:01.723937 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_dev.int__rsi_sma .................... [[32mOK[0m in 0.27s]
[0m12:42:01.724706 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m12:42:01.725354 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m12:42:01.725842 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_dev.int__rsi_wilder ...................... [RUN]
[0m12:42:01.726515 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_wilder'
[0m12:42:01.726904 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m12:42:01.732947 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:01.742758 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m12:42:01.745519 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:01.746577 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:01.746992 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m12:42:01.747362 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:42:01.748601 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:42:01.749099 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:01.749506 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal as gain,
    loss::decimal as loss,
    wilder_gain::decimal as wilder_gain,
    wilder_loss::decimal as wilder_loss
from wilder
  );

<<<<<<< HEAD
[0m12:48:28.891238 [debug] [Thread-4 (]: SQL status: OK in 0.098 seconds
[0m12:48:28.893931 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:28.894317 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m12:48:28.944513 [debug] [Thread-4 (]: SQL status: OK in 0.050 seconds
[0m12:48:28.947115 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:28.947495 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m12:48:28.986895 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m12:48:28.988243 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:48:28.988623 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:28.988969 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:48:29.069070 [debug] [Thread-4 (]: SQL status: OK in 0.080 seconds
[0m12:48:29.071531 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:29.071899 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m12:48:29.166151 [debug] [Thread-4 (]: SQL status: OK in 0.094 seconds
[0m12:48:29.167505 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m12:48:29.168011 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E5F5010>]}
[0m12:48:29.168581 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_dev.int__rsi_wilder ................. [[32mOK[0m in 0.39s]
[0m12:48:29.169413 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m12:48:29.170182 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:48:29.170846 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:48:29.171597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.fct__rsi)
[0m12:48:29.171952 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:48:29.174836 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:48:29.175780 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:48:29.178741 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:48:29.179596 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:48:29.179975 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:48:29.180307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:29.181587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:48:29.181942 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:48:29.182340 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
=======
[0m12:42:01.859403 [debug] [Thread-4 (]: SQL status: OK in 0.109 seconds
[0m12:42:01.909770 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:01.910224 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m12:42:02.077586 [debug] [Thread-4 (]: SQL status: OK in 0.167 seconds
[0m12:42:02.078859 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:42:02.079239 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:02.079580 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:42:02.184437 [debug] [Thread-4 (]: SQL status: OK in 0.104 seconds
[0m12:42:02.187576 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:02.188140 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m12:42:02.236874 [debug] [Thread-4 (]: SQL status: OK in 0.048 seconds
[0m12:42:02.238261 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m12:42:02.238772 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7570A0D0>]}
[0m12:42:02.239347 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_dev.int__rsi_wilder ................. [[32mOK[0m in 0.51s]
[0m12:42:02.240116 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m12:42:02.240973 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:42:02.241473 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:42:02.242075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.fct__rsi)
[0m12:42:02.242463 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:42:02.245192 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:42:02.246132 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:42:02.249263 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:42:02.250484 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:42:02.251118 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:42:02.251475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:02.252774 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:02.253223 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:42:02.253682 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:42:02.319773 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:42:02.320347 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:42:02.320810 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: ROLLBACK
[0m12:42:02.327483 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.fct__rsi'
[0m12:42:02.327870 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:42:02.332219 [debug] [Thread-1 (]: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47:     left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
                                                         ^
[0m12:42:02.332689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A758A1470>]}
[0m12:42:02.333280 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model analytics_dev.fct__rsi .................... [[31mERROR[0m in 0.09s]
[0m12:42:02.334083 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:42:02.334693 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47:     left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
                                                         ^.
[0m12:42:02.336525 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:02.336881 [debug] [MainThread]: On master: BEGIN
[0m12:42:02.337188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:42:02.338337 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:02.338653 [debug] [MainThread]: On master: COMMIT
[0m12:42:02.338956 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:02.339246 [debug] [MainThread]: On master: COMMIT
[0m12:42:02.339811 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:02.340163 [debug] [MainThread]: On master: Close
[0m12:42:02.340600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:02.340894 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:42:02.341164 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:42:02.341432 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:42:02.341697 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__price_changes' was properly closed.
[0m12:42:02.341967 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m12:42:02.342230 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m12:42:02.342585 [info ] [MainThread]: 
[0m12:42:02.343084 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m12:42:02.344630 [debug] [MainThread]: Command end result
[0m12:42:02.365769 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:42:02.368019 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:42:02.374376 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:42:02.374776 [info ] [MainThread]: 
[0m12:42:02.375497 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:42:02.375995 [info ] [MainThread]: 
[0m12:42:02.376584 [error] [MainThread]: [31mFailure in model fct__rsi (models\gold\fct__rsi.sql)[0m
[0m12:42:02.377173 [error] [MainThread]:   Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47:     left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
                                                         ^
[0m12:42:02.377670 [info ] [MainThread]: 
[0m12:42:02.378333 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\fct__rsi.sql
[0m12:42:02.378877 [info ] [MainThread]: 
[0m12:42:02.379400 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m12:42:02.380336 [debug] [MainThread]: Command `-c run` failed at 12:42:02.380204 after 4.68 seconds
[0m12:42:02.380729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73BD6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7504AB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73E4BEF0>]}
[0m12:42:02.381091 [debug] [MainThread]: Flushing usage events
[0m12:42:03.065416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:20.514332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6F4D8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6FCE42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E70323ED0>]}


============================== 12:42:20.519347 | a6371ac5-9517-4897-aeb3-60b2b2b2945c ==============================
[0m12:42:20.519347 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:42:20.520039 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select +fct__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m12:42:20.772928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6F690180>]}
[0m12:42:20.839067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E701CB9B0>]}
[0m12:42:20.841691 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:42:21.084774 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:42:21.162305 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:42:21.162950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71419B50>]}
[0m12:42:22.403543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E7159EE40>]}
[0m12:42:22.474984 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:42:22.478618 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:42:22.506776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71BF5C50>]}
[0m12:42:22.507479 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:42:22.508167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E718CC870>]}
[0m12:42:22.510037 [info ] [MainThread]: 
[0m12:42:22.510730 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:42:22.511328 [info ] [MainThread]: 
[0m12:42:22.512292 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:42:22.519022 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:42:22.603915 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:42:22.604320 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m12:42:22.604636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:23.914116 [debug] [ThreadPool]: SQL status: OK in 1.309 seconds
[0m12:42:23.915504 [debug] [ThreadPool]: On list_finance: Close
[0m12:42:23.916184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:42:23.916660 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:42:23.922287 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:23.922609 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m12:42:23.922960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:23.924746 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:42:23.926091 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:23.926404 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:42:23.927409 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:23.927714 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:23.928005 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m12:42:23.977790 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m12:42:23.978743 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:23.979062 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:23.979359 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:24.026267 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m12:42:24.026664 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:42:24.028428 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:42:24.033798 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:24.034153 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:42:24.034432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:24.035606 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:24.035906 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:24.036209 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m12:42:24.059989 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:42:24.061365 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:42:24.062467 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:42:24.062776 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:42:24.064570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71A1D250>]}
[0m12:42:24.065004 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:24.065296 [debug] [MainThread]: On master: BEGIN
[0m12:42:24.065616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:24.066761 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:24.067074 [debug] [MainThread]: On master: COMMIT
[0m12:42:24.067367 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:24.067649 [debug] [MainThread]: On master: COMMIT
[0m12:42:24.068235 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:24.068722 [debug] [MainThread]: On master: Close
[0m12:42:24.073449 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m12:42:24.073997 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m12:42:24.074896 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m12:42:24.075248 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m12:42:24.081619 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m12:42:24.082495 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m12:42:24.112769 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m12:42:24.113711 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.114100 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m12:42:24.114446 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:24.115949 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:24.116317 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.116683 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m12:42:24.176644 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m12:42:24.182329 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.182722 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m12:42:24.225090 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m12:42:24.227833 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.228208 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m12:42:24.275421 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m12:42:24.288304 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:24.288723 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.289063 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:24.383375 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m12:42:24.388764 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.389143 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m12:42:24.500531 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m12:42:24.502838 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m12:42:24.504817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71DE9390>]}
[0m12:42:24.505527 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.43s]
[0m12:42:24.514460 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m12:42:24.515466 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m12:42:24.515956 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_dev.int__price_changes ................... [RUN]
[0m12:42:24.516733 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m12:42:24.517191 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m12:42:24.519759 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m12:42:24.520698 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m12:42:24.526629 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m12:42:24.527580 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.527958 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m12:42:24.528307 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:42:24.529477 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:42:24.529840 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.530244 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m12:42:24.610711 [debug] [Thread-2 (]: SQL status: OK in 0.080 seconds
[0m12:42:24.613360 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.613752 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m12:42:24.670830 [debug] [Thread-2 (]: SQL status: OK in 0.057 seconds
[0m12:42:24.673429 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.674197 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m12:42:24.723708 [debug] [Thread-2 (]: SQL status: OK in 0.049 seconds
[0m12:42:24.725075 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:42:24.725478 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.725816 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:42:24.812875 [debug] [Thread-2 (]: SQL status: OK in 0.087 seconds
[0m12:42:24.814997 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.815373 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m12:42:25.008765 [debug] [Thread-2 (]: SQL status: OK in 0.193 seconds
[0m12:42:25.010117 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m12:42:25.010630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71FB3A70>]}
[0m12:42:25.011197 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_dev.int__price_changes .............. [[32mOK[0m in 0.49s]
[0m12:42:25.012093 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m12:42:25.012821 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m12:42:25.013336 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_dev.int__rsi_sma ......................... [RUN]
[0m12:42:25.014383 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_sma'
[0m12:42:25.014754 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m12:42:25.017058 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.017916 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m12:42:25.021095 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.022707 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.023424 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m12:42:25.023799 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:42:25.025434 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:42:25.025908 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.026381 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    sma_gain::decimal as sma_gain,
    sma_loss::decimal as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m12:42:25.101462 [debug] [Thread-3 (]: SQL status: OK in 0.074 seconds
[0m12:42:25.104049 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.104419 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m12:42:25.152999 [debug] [Thread-3 (]: SQL status: OK in 0.048 seconds
[0m12:42:25.155681 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.156057 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m12:42:25.208546 [debug] [Thread-3 (]: SQL status: OK in 0.052 seconds
[0m12:42:25.210405 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:42:25.210814 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.211167 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:42:25.313262 [debug] [Thread-3 (]: SQL status: OK in 0.102 seconds
[0m12:42:25.315386 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.315761 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m12:42:25.421739 [debug] [Thread-3 (]: SQL status: OK in 0.106 seconds
[0m12:42:25.423071 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m12:42:25.423568 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71EB22D0>]}
[0m12:42:25.424125 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_dev.int__rsi_sma .................... [[32mOK[0m in 0.41s]
[0m12:42:25.424976 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m12:42:25.425652 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m12:42:25.426161 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_dev.int__rsi_wilder ...................... [RUN]
[0m12:42:25.426947 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_wilder'
[0m12:42:25.427410 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m12:42:25.430116 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.431078 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m12:42:25.434073 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.437766 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.438640 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m12:42:25.439069 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:42:25.440809 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:42:25.441384 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.441853 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal as gain,
    loss::decimal as loss,
    wilder_gain::decimal as wilder_gain,
    wilder_loss::decimal as wilder_loss
from wilder
  );

[0m12:42:25.532033 [debug] [Thread-4 (]: SQL status: OK in 0.090 seconds
[0m12:42:25.534830 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.535254 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m12:42:25.585938 [debug] [Thread-4 (]: SQL status: OK in 0.050 seconds
[0m12:42:25.588718 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.589106 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m12:42:25.635717 [debug] [Thread-4 (]: SQL status: OK in 0.046 seconds
[0m12:42:25.637065 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:42:25.637454 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.637804 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:42:25.740558 [debug] [Thread-4 (]: SQL status: OK in 0.102 seconds
[0m12:42:25.742991 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.743405 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m12:42:25.846718 [debug] [Thread-4 (]: SQL status: OK in 0.103 seconds
[0m12:42:25.848117 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m12:42:25.848612 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71FA6890>]}
[0m12:42:25.849180 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_dev.int__rsi_wilder ................. [[32mOK[0m in 0.42s]
[0m12:42:25.850083 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m12:42:25.850839 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:42:25.851331 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:42:25.852049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.fct__rsi)
[0m12:42:25.852406 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:42:25.855008 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:42:25.855843 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:42:25.858713 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:42:25.859634 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:42:25.860042 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:42:25.860369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:25.861774 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:25.871120 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:42:25.871615 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = s.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:42:25.936927 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = s.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:42:25.937451 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:42:25.937908 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: ROLLBACK
[0m12:42:25.944739 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.fct__rsi'
[0m12:42:25.945152 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:42:25.949427 [debug] [Thread-1 (]: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47: ... wilder_sma ws on s.trade_date = s.trade_date and s.ticker = sma.ticker
                                                                           ^
[0m12:42:25.949868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E734B2C90>]}
[0m12:42:25.950443 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model analytics_dev.fct__rsi .................... [[31mERROR[0m in 0.10s]
[0m12:42:25.951252 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:42:25.951837 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47: ... wilder_sma ws on s.trade_date = s.trade_date and s.ticker = sma.ticker
                                                                           ^.
[0m12:42:25.953665 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:25.953998 [debug] [MainThread]: On master: BEGIN
[0m12:42:25.954302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:42:25.955460 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:25.955805 [debug] [MainThread]: On master: COMMIT
[0m12:42:25.956126 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:25.956484 [debug] [MainThread]: On master: COMMIT
[0m12:42:25.957151 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:25.957485 [debug] [MainThread]: On master: Close
[0m12:42:25.957901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:25.958189 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:42:25.958458 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:42:25.958724 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:42:25.958989 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__price_changes' was properly closed.
[0m12:42:25.959256 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m12:42:25.959519 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m12:42:25.959867 [info ] [MainThread]: 
[0m12:42:25.960318 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m12:42:25.961788 [debug] [MainThread]: Command end result
[0m12:42:25.982533 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:42:25.984720 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:42:25.991710 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:42:25.992084 [info ] [MainThread]: 
[0m12:42:25.992594 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:42:25.993154 [info ] [MainThread]: 
[0m12:42:25.993799 [error] [MainThread]: [31mFailure in model fct__rsi (models\gold\fct__rsi.sql)[0m
[0m12:42:25.994426 [error] [MainThread]:   Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47: ... wilder_sma ws on s.trade_date = s.trade_date and s.ticker = sma.ticker
                                                                           ^
[0m12:42:25.995175 [info ] [MainThread]: 
[0m12:42:25.995784 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\fct__rsi.sql
[0m12:42:25.996257 [info ] [MainThread]: 
[0m12:42:25.996781 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m12:42:25.997704 [debug] [MainThread]: Command `-c run` failed at 12:42:25.997589 after 5.62 seconds
[0m12:42:25.998078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71FFC2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71995F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6F5250D0>]}
[0m12:42:25.998440 [debug] [MainThread]: Flushing usage events
[0m12:42:26.762957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:55.045874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014020058050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140208642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014020EA7ED0>]}


============================== 12:42:55.050081 | 0b91ea45-4f77-4488-bb01-30428f9e0a1a ==============================
[0m12:42:55.050081 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:42:55.050769 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +fct__rsi', 'printer_width': '80', 'write_json': 'True'}
[0m12:42:55.291467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014020210180>]}
[0m12:42:55.356383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014020D4B9B0>]}
[0m12:42:55.358858 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:42:55.600901 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:42:55.680837 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:42:55.681437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014021F91B50>]}
[0m12:42:56.914940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001402217AE40>]}
[0m12:42:56.978162 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:42:56.980364 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:42:57.004376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140227D5C50>]}
[0m12:42:57.004843 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:42:57.005340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022410870>]}
[0m12:42:57.006979 [info ] [MainThread]: 
[0m12:42:57.007471 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:42:57.007945 [info ] [MainThread]: 
[0m12:42:57.008579 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:42:57.013754 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:42:57.090591 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:42:57.090981 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m12:42:57.091295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:58.938618 [debug] [ThreadPool]: SQL status: OK in 1.847 seconds
[0m12:42:58.940062 [debug] [ThreadPool]: On list_finance: Close
[0m12:42:58.940788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:42:58.941367 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:42:58.947112 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:58.947448 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m12:42:58.947744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:58.949349 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:42:58.950603 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:58.950907 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:42:58.951872 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:58.952169 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:58.952465 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m12:42:58.996973 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m12:42:58.997898 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:58.998219 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:58.998511 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:59.046750 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m12:42:59.047163 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:42:59.049023 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:42:59.054511 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:59.054842 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:42:59.055116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:59.056302 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:59.056604 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:59.056902 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m12:42:59.080426 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:42:59.081800 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:42:59.082989 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:42:59.083307 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:42:59.085164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022605250>]}
[0m12:42:59.085671 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:59.085965 [debug] [MainThread]: On master: BEGIN
[0m12:42:59.086240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:59.087431 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:59.087773 [debug] [MainThread]: On master: COMMIT
[0m12:42:59.088074 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:59.088359 [debug] [MainThread]: On master: COMMIT
[0m12:42:59.088969 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:59.089280 [debug] [MainThread]: On master: Close
[0m12:42:59.094035 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m12:42:59.094550 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m12:42:59.095470 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m12:42:59.095831 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m12:42:59.102407 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m12:42:59.103271 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m12:42:59.133432 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m12:42:59.134446 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.134864 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m12:42:59.135243 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:59.136940 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:42:59.137512 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.137926 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m12:42:59.194070 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m12:42:59.199678 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.200066 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m12:42:59.260544 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m12:42:59.263256 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.263652 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m12:42:59.310688 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m12:42:59.322600 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:59.323024 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.323360 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:59.435638 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m12:42:59.440759 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.441175 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m12:42:59.550645 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m12:42:59.552970 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m12:42:59.554944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140229CD4F0>]}
[0m12:42:59.555577 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.46s]
[0m12:42:59.556455 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m12:42:59.557179 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m12:42:59.557701 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_dev.int__price_changes ................... [RUN]
[0m12:42:59.558412 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m12:42:59.558798 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m12:42:59.561171 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m12:42:59.562009 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m12:42:59.567694 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m12:42:59.568748 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:59.569134 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m12:42:59.569467 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:42:59.570820 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:42:59.571299 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:59.571705 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m12:42:59.755998 [debug] [Thread-2 (]: SQL status: OK in 0.184 seconds
[0m12:42:59.758798 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:59.759202 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m12:42:59.819412 [debug] [Thread-2 (]: SQL status: OK in 0.060 seconds
[0m12:42:59.821969 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:59.822728 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m12:42:59.959855 [debug] [Thread-2 (]: SQL status: OK in 0.137 seconds
[0m12:42:59.961179 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:42:59.961554 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:59.961892 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:43:00.065736 [debug] [Thread-2 (]: SQL status: OK in 0.103 seconds
[0m12:43:00.067870 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:43:00.068247 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m12:43:00.165738 [debug] [Thread-2 (]: SQL status: OK in 0.097 seconds
[0m12:43:00.167206 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m12:43:00.167765 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022B939D0>]}
[0m12:43:00.168383 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_dev.int__price_changes .............. [[32mOK[0m in 0.61s]
[0m12:43:00.169157 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m12:43:00.169843 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m12:43:00.170342 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_dev.int__rsi_sma ......................... [RUN]
[0m12:43:00.171022 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_sma'
[0m12:43:00.171408 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m12:43:00.173846 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.174681 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m12:43:00.177638 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.178446 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.178815 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m12:43:00.179155 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:43:00.180295 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:43:00.180660 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.181047 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    sma_gain::decimal as sma_gain,
    sma_loss::decimal as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m12:43:00.366410 [debug] [Thread-3 (]: SQL status: OK in 0.185 seconds
[0m12:43:00.369339 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.369740 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m12:43:00.424108 [debug] [Thread-3 (]: SQL status: OK in 0.054 seconds
[0m12:43:00.427181 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.427637 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m12:43:00.474797 [debug] [Thread-3 (]: SQL status: OK in 0.047 seconds
[0m12:43:00.476586 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:43:00.476972 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.477322 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:43:00.574223 [debug] [Thread-3 (]: SQL status: OK in 0.096 seconds
[0m12:43:00.576482 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.576857 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m12:43:00.686282 [debug] [Thread-3 (]: SQL status: OK in 0.109 seconds
[0m12:43:00.687627 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m12:43:00.688127 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022A962D0>]}
[0m12:43:00.688679 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_dev.int__rsi_sma .................... [[32mOK[0m in 0.52s]
[0m12:43:00.689503 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m12:43:00.690213 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m12:43:00.690679 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_dev.int__rsi_wilder ...................... [RUN]
[0m12:43:00.691721 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_wilder'
[0m12:43:00.692327 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m12:43:00.695215 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.696175 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m12:43:00.699231 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.700111 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.700497 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m12:43:00.700833 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:43:00.702106 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:43:00.702468 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.702853 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal as gain,
    loss::decimal as loss,
    wilder_gain::decimal as wilder_gain,
    wilder_loss::decimal as wilder_loss
from wilder
  );

[0m12:43:00.790525 [debug] [Thread-4 (]: SQL status: OK in 0.087 seconds
[0m12:43:00.793152 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.793533 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m12:43:00.850822 [debug] [Thread-4 (]: SQL status: OK in 0.057 seconds
[0m12:43:00.853499 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.853879 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m12:43:00.916534 [debug] [Thread-4 (]: SQL status: OK in 0.062 seconds
[0m12:43:00.917865 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:43:00.918236 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.918578 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:43:01.040219 [debug] [Thread-4 (]: SQL status: OK in 0.121 seconds
[0m12:43:01.042703 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:01.043072 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m12:43:01.161150 [debug] [Thread-4 (]: SQL status: OK in 0.118 seconds
[0m12:43:01.162768 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m12:43:01.163449 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022B89FD0>]}
[0m12:43:01.164082 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_dev.int__rsi_wilder ................. [[32mOK[0m in 0.47s]
[0m12:43:01.164952 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m12:43:01.165654 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:43:01.166167 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:43:01.167115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.fct__rsi)
[0m12:43:01.167482 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:43:01.170117 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:43:01.171024 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:43:01.174179 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:43:01.175286 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:43:01.175714 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:43:01.176061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:01.177487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:01.177921 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:43:01.178343 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = s.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

<<<<<<< HEAD
[0m12:48:29.286313 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m12:48:29.288946 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:48:29.289322 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
alter view "finance"."analytics_dev"."fct__rsi" rename to "fct__rsi__dbt_backup"
[0m12:48:29.373810 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m12:48:29.376469 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:48:29.376866 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
alter view "finance"."analytics_dev"."fct__rsi__dbt_tmp" rename to "fct__rsi"
[0m12:48:29.418665 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m12:48:29.420000 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m12:48:29.420371 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:48:29.420744 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m12:48:29.518868 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m12:48:29.521327 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:48:29.521698 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop view if exists "finance"."analytics_dev"."fct__rsi__dbt_backup" cascade
    
[0m12:48:29.624526 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m12:48:29.631111 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:48:29.631836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E4D2330>]}
[0m12:48:29.632464 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics_dev.fct__rsi ........................ [[32mOK[0m in 0.46s]
[0m12:48:29.633389 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:48:29.635065 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:29.635388 [debug] [MainThread]: On master: BEGIN
[0m12:48:29.635718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:48:29.637062 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:48:29.637408 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.637711 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:29.638004 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.638679 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:48:29.638990 [debug] [MainThread]: On master: Close
[0m12:48:29.639383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:29.639659 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:48:29.639921 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:48:29.640179 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:48:29.640438 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__price_changes' was properly closed.
[0m12:48:29.640701 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m12:48:29.640957 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m12:48:29.641302 [info ] [MainThread]: 
[0m12:48:29.641739 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.37 seconds (4.37s).
[0m12:48:29.643581 [debug] [MainThread]: Command end result
[0m12:48:29.667851 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:48:29.671082 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:48:29.677536 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:48:29.677920 [info ] [MainThread]: 
[0m12:48:29.678459 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:48:29.678989 [info ] [MainThread]: 
[0m12:48:29.679614 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m12:48:29.680813 [debug] [MainThread]: Command `-c run` succeeded at 12:48:29.680678 after 6.59 seconds
[0m12:48:29.681216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39A0F75F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39DAF0E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E64F830>]}
[0m12:48:29.681728 [debug] [MainThread]: Flushing usage events
[0m12:48:30.372312 [debug] [MainThread]: An error was encountered while trying to flush usage events
=======
[0m12:43:01.287136 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m12:43:01.289761 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:43:01.290139 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
alter view "finance"."analytics_dev"."fct__rsi__dbt_tmp" rename to "fct__rsi"
[0m12:43:01.390494 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m12:43:01.391778 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m12:43:01.392152 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:43:01.392494 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m12:43:01.490811 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m12:43:01.492912 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:43:01.493271 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop view if exists "finance"."analytics_dev"."fct__rsi__dbt_backup" cascade
    
[0m12:43:01.538978 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m12:43:01.540307 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:43:01.540811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022A63410>]}
[0m12:43:01.541415 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics_dev.fct__rsi ........................ [[32mOK[0m in 0.37s]
[0m12:43:01.542436 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:43:01.543829 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:01.544201 [debug] [MainThread]: On master: BEGIN
[0m12:43:01.544484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:01.545771 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:43:01.546127 [debug] [MainThread]: On master: COMMIT
[0m12:43:01.546429 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:01.546715 [debug] [MainThread]: On master: COMMIT
[0m12:43:01.547323 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:43:01.547631 [debug] [MainThread]: On master: Close
[0m12:43:01.548014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:01.548297 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:43:01.548563 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:43:01.548823 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:43:01.549082 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__price_changes' was properly closed.
[0m12:43:01.549339 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m12:43:01.549600 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m12:43:01.549943 [info ] [MainThread]: 
[0m12:43:01.550512 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m12:43:01.552158 [debug] [MainThread]: Command end result
[0m12:43:01.573839 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:43:01.576204 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:43:01.582391 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:43:01.582761 [info ] [MainThread]: 
[0m12:43:01.583412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:01.584084 [info ] [MainThread]: 
[0m12:43:01.584743 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m12:43:01.585717 [debug] [MainThread]: Command `-c run` succeeded at 12:43:01.585607 after 6.66 seconds
[0m12:43:01.586068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014020148DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022BDFD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022BDF7D0>]}
[0m12:43:01.586422 [debug] [MainThread]: Flushing usage events
[0m12:43:02.292486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:21.957046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8DF6B8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8DFEC42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E0503ED0>]}


============================== 13:38:21.961552 | 942553ef-0a93-41b1-9e6f-88e5ed65ca6e ==============================
[0m13:38:21.961552 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:38:21.962517 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt deps', 'printer_width': '80', 'target_path': 'None'}
[0m13:38:22.107680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '942553ef-0a93-41b1-9e6f-88e5ed65ca6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8DF870180>]}
[0m13:38:22.136436 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-szcmxnzx'
[0m13:38:22.136994 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:38:22.715103 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:38:22.716563 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:38:23.221100 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:38:23.233528 [info ] [MainThread]: Updating lock file in file path: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2/package-lock.yml
[0m13:38:23.244030 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-z8qfqz3l'
[0m13:38:23.247276 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:38:24.079550 [info ] [MainThread]: Installed from version 1.3.1
[0m13:38:24.080079 [info ] [MainThread]: Updated version available: 1.3.2
[0m13:38:24.080553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '942553ef-0a93-41b1-9e6f-88e5ed65ca6e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E03AA580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E03AAF10>]}
[0m13:38:24.080947 [info ] [MainThread]: 
[0m13:38:24.081369 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m13:38:24.083015 [debug] [MainThread]: Command `-c deps` succeeded at 13:38:24.082873 after 2.30 seconds
[0m13:38:24.083417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E178CD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8DFDF4C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E0395040>]}
[0m13:38:24.083777 [debug] [MainThread]: Flushing usage events
[0m13:38:24.746088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:55.941021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD6703C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD678442D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD67E87ED0>]}


============================== 13:38:55.945622 | e0705e42-2d08-41fd-b776-837ff0743a81 ==============================
[0m13:38:55.945622 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:38:55.946343 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m13:38:56.088908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0705e42-2d08-41fd-b776-837ff0743a81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD671F0180>]}
[0m13:38:56.121229 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-gjl388uo'
[0m13:38:56.121764 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:38:56.840248 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:38:56.841654 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:38:57.451490 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:38:57.462286 [info ] [MainThread]: Updating lock file in file path: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2/package-lock.yml
[0m13:38:57.527712 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-1r869tt3'
[0m13:38:57.531087 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:38:58.544608 [info ] [MainThread]: Installed from version 1.3.2
[0m13:38:58.545139 [info ] [MainThread]: Up to date!
[0m13:38:58.545642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e0705e42-2d08-41fd-b776-837ff0743a81', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD67D2A580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD67D2AF10>]}
[0m13:38:58.547199 [debug] [MainThread]: Command `-c deps` succeeded at 13:38:58.547064 after 2.75 seconds
[0m13:38:58.547569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD690D8D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD67D19040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD67D1B6B0>]}
[0m13:38:58.547971 [debug] [MainThread]: Flushing usage events
[0m13:38:59.174887 [debug] [MainThread]: An error was encountered while trying to flush usage events
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb
[0m13:48:49.178635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0FB5472F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0FA573290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0FD9CFAA0>]}


============================== 13:48:49.183079 | d31bdab1-f542-4f06-a624-802c5d473a45 ==============================
[0m13:48:49.183079 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:48:49.184076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m13:48:49.441622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd31bdab1-f542-4f06-a624-802c5d473a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0FDDA9F40>]}
[0m13:48:49.530707 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.2', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.2'}} is not valid under any of the given schemas
  
[0m13:48:49.531707 [debug] [MainThread]: Command `cli deps` failed at 13:48:49.531707 after 0.47 seconds
[0m13:48:49.531707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0FDB77680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0FDFEB6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0FF0D4AA0>]}
[0m13:48:49.533205 [debug] [MainThread]: Flushing usage events
[0m14:12:51.127093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E2E58050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E36642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E3CA3ED0>]}


============================== 14:12:51.131558 | 96545b6f-a8a2-49c9-abd4-c348371625ab ==============================
[0m14:12:51.131558 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:12:51.132301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt build --select int__price_changes', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:12:51.451453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96545b6f-a8a2-49c9-abd4-c348371625ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E3010180>]}
[0m14:12:51.516199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96545b6f-a8a2-49c9-abd4-c348371625ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E3B4B9B0>]}
[0m14:12:51.531435 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:12:51.854531 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m14:12:51.855511 [debug] [MainThread]: Command `-c build` failed at 14:12:51.855393 after 0.90 seconds
[0m14:12:51.855883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E4D95450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E4D95350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E4FE4D70>]}
[0m14:12:51.856238 [debug] [MainThread]: Flushing usage events
[0m14:12:52.497182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:58.365935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C834B8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C83CC42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C84303ED0>]}


============================== 14:12:58.370264 | 62ec1f2d-ef31-48d0-ab1e-438fd72f1603 ==============================
[0m14:12:58.370264 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:12:58.370986 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt deps', 'printer_width': '80', 'log_format': 'default', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:12:58.505529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62ec1f2d-ef31-48d0-ab1e-438fd72f1603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C83670180>]}
[0m14:12:58.539288 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-wm8v2l2v'
[0m14:12:58.539752 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:12:59.139453 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:12:59.141826 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:12:59.674629 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:12:59.680534 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:13:00.526628 [info ] [MainThread]: Installed from version 1.3.2
[0m14:13:00.527168 [info ] [MainThread]: Up to date!
[0m14:13:00.527692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '62ec1f2d-ef31-48d0-ab1e-438fd72f1603', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C841AAF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C841AA580>]}
[0m14:13:00.529161 [debug] [MainThread]: Command `-c deps` succeeded at 14:13:00.529021 after 2.28 seconds
[0m14:13:00.529539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C8560CD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C8419B6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C84199040>]}
[0m14:13:00.529901 [debug] [MainThread]: Flushing usage events
[0m14:13:01.250343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:04.907688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014619AC8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461A2D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461A913ED0>]}


============================== 14:13:04.912083 | 55c2b991-5750-4497-bbe8-948acabe5462 ==============================
[0m14:13:04.912083 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:13:04.912978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt build --select int__price_changes', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:13:05.168726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55c2b991-5750-4497-bbe8-948acabe5462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014619C80180>]}
[0m14:13:05.235706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55c2b991-5750-4497-bbe8-948acabe5462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461A7BB9B0>]}
[0m14:13:05.238351 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:13:05.491742 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:13:05.573409 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:13:05.574035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '55c2b991-5750-4497-bbe8-948acabe5462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461BA95E50>]}
[0m14:13:07.358998 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__price_changes', 'description': '...', 'data_tests': [{'dbt_utils.unique_combination_of_columns': {'combination_of_columns': ['trade_date', 'ticker', 'rn', 'loaded_at']}}, {'dbt_utils.expression_is_true': None, 'expression': 'abs(delta) - (gain + loss)) = 0'}, {'dbt_utils.expression_is_true': {'expression': '(delta > 0 and gain = delta) or (delta <= 0 and gain = 0)'}}, {'dbt_utils.expression_is_true': {'expression': '(delta < 0 and loss = -delta) or (delta >= 0 and loss = 0)'}}], 'columns': [{'name': 'trade_date', 'description': None, 'data_tests': ['not_null']}, {'name': 'ticker', 'data_tests': ['not_null']}, {'name': 'close', 'data_tests': ['not_null']}, {'name': 'gain', 'data_tests': ['not_null', {'dbt_utils.expression_is_true': {'arguments': {'expression': 'gain >= 0'}}}]}, {'name': 'loss', 'data_tests': ['not_null', {'dbt_utils.expression_is_true': {'arguments': {'expression': 'loss >= 0'}}}]}, {'name': 'rn', 'data_tests': ['not_null']}, {'name': 'period_check', 'data_tests': [{'dbt_utils.expression_is_true': {'expression': 'period_check between 1 and 14'}}]}, {'name': 'loaded_at', 'data_tests': ['not_null']}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['columns'][0]['description']: None is not of type 'string'
[0m14:13:07.360294 [debug] [MainThread]: Command `-c build` failed at 14:13:07.360176 after 2.59 seconds
[0m14:13:07.360703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461C210140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461C210050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461A7D3E70>]}
[0m14:13:07.361048 [debug] [MainThread]: Flushing usage events
[0m14:13:07.942753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:01.882691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F35248050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F35A542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F36097ED0>]}


============================== 14:14:01.887595 | 4167dc35-79a3-46ed-b2d2-51ca0b93b7eb ==============================
[0m14:14:01.887595 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:14:01.888283 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt parse', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m14:14:02.152249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4167dc35-79a3-46ed-b2d2-51ca0b93b7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F35400180>]}
[0m14:14:02.221784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4167dc35-79a3-46ed-b2d2-51ca0b93b7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F35F3B9B0>]}
[0m14:14:02.224603 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:14:02.488647 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:14:02.575958 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:14:02.576592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4167dc35-79a3-46ed-b2d2-51ca0b93b7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F37185E50>]}
[0m14:14:04.065255 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__price_changes', 'description': '...', 'data_tests': [{'dbt_utils.unique_combination_of_columns': {'combination_of_columns': ['trade_date', 'ticker', 'rn', 'loaded_at']}}, {'dbt_utils.expression_is_true': None, 'expression': 'abs(delta) - (gain + loss)) = 0'}, {'dbt_utils.expression_is_true': {'expression': '(delta > 0 and gain = delta) or (delta <= 0 and gain = 0)'}}, {'dbt_utils.expression_is_true': {'expression': '(delta < 0 and loss = -delta) or (delta >= 0 and loss = 0)'}}], 'columns': [{'name': 'trade_date', 'description': None, 'data_tests': ['not_null']}, {'name': 'ticker', 'data_tests': ['not_null']}, {'name': 'close', 'data_tests': ['not_null']}, {'name': 'gain', 'data_tests': ['not_null', {'dbt_utils.expression_is_true': {'arguments': {'expression': 'gain >= 0'}}}]}, {'name': 'loss', 'data_tests': ['not_null', {'dbt_utils.expression_is_true': {'arguments': {'expression': 'loss >= 0'}}}]}, {'name': 'rn', 'data_tests': ['not_null']}, {'name': 'period_check', 'data_tests': [{'dbt_utils.expression_is_true': {'expression': 'period_check between 1 and 14'}}]}, {'name': 'loaded_at', 'data_tests': ['not_null']}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['columns'][0]['description']: None is not of type 'string'
[0m14:14:04.066686 [debug] [MainThread]: Command `-c parse` failed at 14:14:04.066549 after 2.33 seconds
[0m14:14:04.067103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F37934140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F37934050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F35F53E70>]}
[0m14:14:04.067483 [debug] [MainThread]: Flushing usage events
[0m14:14:04.784317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:03.212022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026788148050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267889542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026788F97ED0>]}


============================== 14:16:03.216348 | b32d27b1-cbc1-4480-9203-2d9e1d3f55e3 ==============================
[0m14:16:03.216348 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:16:03.217060 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'printer_width': '80', 'target_path': 'None'}
[0m14:16:03.461762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b32d27b1-cbc1-4480-9203-2d9e1d3f55e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026788300180>]}
[0m14:16:03.525768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b32d27b1-cbc1-4480-9203-2d9e1d3f55e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026788E3B9B0>]}
[0m14:16:03.528364 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:16:03.780551 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:16:03.856931 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:16:03.857525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b32d27b1-cbc1-4480-9203-2d9e1d3f55e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678A111E50>]}
[0m14:16:05.226696 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__rsi_sma', 'description': '...', 'data_tests': None, 'columns': [{'name': 'trade_date', 'data_tests': ['not_null', {'relationships': {'arguments': {'to': "ref('fct_events')", 'field': 'event_id'}}}]}, {'name': 'order_date', 'data_tests': ['not_null']}, {'name': 'user_id', 'data_tests': ['not_null']}, {'name': 'ga_session_id', 'data_tests': ['not_null']}, {'name': 'device_category', 'data_tests': [{'accepted_values': {'arguments': {'values': ['desktop', 'mobile', 'tablet']}}}]}, {'name': 'revenue', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}, {'name': 'total_items', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>= 1'}}}]}, {'name': 'distinct_products', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['data_tests']: None is not of type 'array'
[0m14:16:05.227921 [debug] [MainThread]: Command `-c parse` failed at 14:16:05.227786 after 2.18 seconds
[0m14:16:05.228324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678A890E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678A890F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026788E53E70>]}
[0m14:16:05.228702 [debug] [MainThread]: Flushing usage events
[0m14:16:06.018466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:03.048024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017268748050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017268F542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017269597ED0>]}


============================== 14:17:03.052356 | 8ba98aa5-b6b0-44b7-ba54-a5fc0f1c0a33 ==============================
[0m14:17:03.052356 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:17:03.053088 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:17:03.300662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ba98aa5-b6b0-44b7-ba54-a5fc0f1c0a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017268900180>]}
[0m14:17:03.366477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ba98aa5-b6b0-44b7-ba54-a5fc0f1c0a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726943B9B0>]}
[0m14:17:03.369044 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:17:03.619056 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:17:03.696484 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:17:03.697093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8ba98aa5-b6b0-44b7-ba54-a5fc0f1c0a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726A6FDE50>]}
[0m14:17:05.067801 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__rsi_sma', 'description': '...', 'data_tests': None, 'columns': [{'name': 'trade_date', 'data_tests': ['not_null', {'relationships': {'arguments': {'to': "ref('fct_events')", 'field': 'event_id'}}}]}, {'name': 'order_date', 'data_tests': ['not_null']}, {'name': 'user_id', 'data_tests': ['not_null']}, {'name': 'ga_session_id', 'data_tests': ['not_null']}, {'name': 'device_category', 'data_tests': [{'accepted_values': {'arguments': {'values': ['desktop', 'mobile', 'tablet']}}}]}, {'name': 'revenue', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}, {'name': 'total_items', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>= 1'}}}]}, {'name': 'distinct_products', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['data_tests']: None is not of type 'array'
[0m14:17:05.068923 [debug] [MainThread]: Command `-c parse` failed at 14:17:05.068780 after 2.14 seconds
[0m14:17:05.069285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726AE80E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726AE80F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017269453E70>]}
[0m14:17:05.069630 [debug] [MainThread]: Flushing usage events
[0m14:17:05.810729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:29.454446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A59468050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A59C742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A5A2B7ED0>]}


============================== 14:17:29.458859 | 7227c1c2-70da-4a03-8865-3be51b41cc9f ==============================
[0m14:17:29.458859 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:17:29.459742 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'printer_width': '80', 'write_json': 'True'}
[0m14:17:29.707724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7227c1c2-70da-4a03-8865-3be51b41cc9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A59620180>]}
[0m14:17:29.772759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7227c1c2-70da-4a03-8865-3be51b41cc9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A5A15B9B0>]}
[0m14:17:29.775399 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:17:30.022577 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:17:30.101458 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:17:30.102077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7227c1c2-70da-4a03-8865-3be51b41cc9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A5B3A5E50>]}
[0m14:17:31.494899 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__rsi_sma', 'description': '...', 'data_tests': None, 'columns': [{'name': 'trade_date', 'data_tests': ['not_null', {'relationships': {'arguments': {'to': "ref('fct_events')", 'field': 'event_id'}}}]}, {'name': 'order_date', 'data_tests': ['not_null']}, {'name': 'user_id', 'data_tests': ['not_null']}, {'name': 'ga_session_id', 'data_tests': ['not_null']}, {'name': 'device_category', 'data_tests': [{'accepted_values': {'arguments': {'values': ['desktop', 'mobile', 'tablet']}}}]}, {'name': 'revenue', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}, {'name': 'total_items', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>= 1'}}}]}, {'name': 'distinct_products', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['data_tests']: None is not of type 'array'
[0m14:17:31.496036 [debug] [MainThread]: Command `-c parse` failed at 14:17:31.495910 after 2.16 seconds
[0m14:17:31.496424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A5BBD0E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A5BBD0F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A5A173E70>]}
[0m14:17:31.496802 [debug] [MainThread]: Flushing usage events
[0m14:17:32.098314 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:53.427836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C7AE8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C82F42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C8937ED0>]}


============================== 14:17:53.432296 | d978ffb8-218d-41ef-a0e2-8922ed9f78a6 ==============================
[0m14:17:53.432296 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:17:53.433003 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:17:53.693333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd978ffb8-218d-41ef-a0e2-8922ed9f78a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C7CA0180>]}
[0m14:17:53.759455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd978ffb8-218d-41ef-a0e2-8922ed9f78a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C87DB9B0>]}
[0m14:17:53.762211 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:17:54.012156 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:17:54.090565 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:17:54.091167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd978ffb8-218d-41ef-a0e2-8922ed9f78a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C8A55E50>]}
[0m14:17:55.481932 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__rsi_sma', 'description': '...', 'data_tests': None, 'columns': [{'name': 'trade_date', 'data_tests': ['not_null', {'relationships': {'arguments': {'to': "ref('fct_events')", 'field': 'event_id'}}}]}, {'name': 'order_date', 'data_tests': ['not_null']}, {'name': 'user_id', 'data_tests': ['not_null']}, {'name': 'ga_session_id', 'data_tests': ['not_null']}, {'name': 'device_category', 'data_tests': [{'accepted_values': {'arguments': {'values': ['desktop', 'mobile', 'tablet']}}}]}, {'name': 'revenue', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}, {'name': 'total_items', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>= 1'}}}]}, {'name': 'distinct_products', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['data_tests']: None is not of type 'array'
[0m14:17:55.483067 [debug] [MainThread]: Command `-c parse` failed at 14:17:55.482945 after 2.18 seconds
[0m14:17:55.483454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CA244E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CA244F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C87F3E70>]}
[0m14:17:55.483831 [debug] [MainThread]: Flushing usage events
[0m14:17:56.081358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:30.508606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A47068050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A478742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A47EB7ED0>]}


============================== 14:18:30.513075 | 9c7b4b27-c03a-401d-a553-104a035a6029 ==============================
[0m14:18:30.513075 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:18:30.513776 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'invocation_command': 'dbt parse', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m14:18:30.762351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c7b4b27-c03a-401d-a553-104a035a6029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A47220180>]}
[0m14:18:30.827532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c7b4b27-c03a-401d-a553-104a035a6029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A47D5B9B0>]}
[0m14:18:30.830007 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:18:31.075902 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:18:31.153347 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:18:31.153898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c7b4b27-c03a-401d-a553-104a035a6029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A48FB5E50>]}
[0m14:18:32.542014 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__rsi_sma', 'description': '...', 'data_tests': None, 'columns': [{'name': 'trade_date', 'data_tests': ['not_null', {'relationships': {'arguments': {'to': "ref('fct_events')", 'field': 'event_id'}}}]}, {'name': 'order_date', 'data_tests': ['not_null']}, {'name': 'user_id', 'data_tests': ['not_null']}, {'name': 'ga_session_id', 'data_tests': ['not_null']}, {'name': 'device_category', 'data_tests': [{'accepted_values': {'arguments': {'values': ['desktop', 'mobile', 'tablet']}}}]}, {'name': 'revenue', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}, {'name': 'total_items', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>= 1'}}}]}, {'name': 'distinct_products', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['data_tests']: None is not of type 'array'
[0m14:18:32.543156 [debug] [MainThread]: Command `-c parse` failed at 14:18:32.543036 after 2.16 seconds
[0m14:18:32.543527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A49740E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A49740F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A47D73E70>]}
[0m14:18:32.543924 [debug] [MainThread]: Flushing usage events
[0m14:18:33.268045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:19:20.933664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FCE08050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FD6142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FDC53ED0>]}


============================== 14:19:20.938374 | 0b3e87a0-707a-446f-821e-23d0dfc2a99c ==============================
[0m14:19:20.938374 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:19:20.939082 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'printer_width': '80', 'target_path': 'None'}
[0m14:19:21.183419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b3e87a0-707a-446f-821e-23d0dfc2a99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FCFC0180>]}
[0m14:19:21.249708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b3e87a0-707a-446f-821e-23d0dfc2a99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FDAFB9B0>]}
[0m14:19:21.252194 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:19:21.498752 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:19:21.576094 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:19:21.576669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b3e87a0-707a-446f-821e-23d0dfc2a99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FDD71E50>]}
[0m14:19:22.944814 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__rsi_sma', 'description': '...', 'data_tests': None, 'columns': [{'name': 'trade_date', 'data_tests': ['not_null', {'relationships': {'arguments': {'to': "ref('fct_events')", 'field': 'event_id'}}}]}, {'name': 'order_date', 'data_tests': ['not_null']}, {'name': 'user_id', 'data_tests': ['not_null']}, {'name': 'ga_session_id', 'data_tests': ['not_null']}, {'name': 'device_category', 'data_tests': [{'accepted_values': {'arguments': {'values': ['desktop', 'mobile', 'tablet']}}}]}, {'name': 'revenue', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}, {'name': 'total_items', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>= 1'}}}]}, {'name': 'distinct_products', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['data_tests']: None is not of type 'array'
[0m14:19:22.946161 [debug] [MainThread]: Command `-c parse` failed at 14:19:22.946023 after 2.15 seconds
[0m14:19:22.946652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FF550E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FF550F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FDB13E70>]}
[0m14:19:22.947007 [debug] [MainThread]: Flushing usage events
[0m14:19:23.555541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:40.490652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B4E708050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B4EF142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B4F557ED0>]}


============================== 17:00:40.507789 | 3a657c19-1e9c-454d-bac1-ec5c715dab82 ==============================
[0m17:00:40.507789 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:00:40.510569 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:00:40.986649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a657c19-1e9c-454d-bac1-ec5c715dab82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B4E8C0180>]}
[0m17:00:41.076013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a657c19-1e9c-454d-bac1-ec5c715dab82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B4F3FB9B0>]}
[0m17:00:41.079442 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:00:41.434320 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:00:41.541620 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:00:41.542367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a657c19-1e9c-454d-bac1-ec5c715dab82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B50691E50>]}
[0m17:00:43.735213 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:00:43.870272 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m17:00:43.871138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3a657c19-1e9c-454d-bac1-ec5c715dab82', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B50873F20>]}
[0m17:00:44.240180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a657c19-1e9c-454d-bac1-ec5c715dab82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B50F95470>]}
[0m17:00:44.246265 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m17:00:44.448278 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:00:44.453608 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:00:44.454444 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 11 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:00:44.455854 [debug] [MainThread]: Command `-c parse` succeeded at 17:00:44.455686 after 4.39 seconds
[0m17:00:44.456418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B51087520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B4F34F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B50F528D0>]}
[0m17:00:44.456946 [debug] [MainThread]: Flushing usage events
[0m17:00:45.535166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:03:00.672847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DC0E8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DC8F42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DCF37ED0>]}


============================== 17:03:00.683514 | 71c4ee88-12d0-484a-ad09-9220e8e2290b ==============================
[0m17:03:00.683514 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:03:00.685452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:03:01.274107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71c4ee88-12d0-484a-ad09-9220e8e2290b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DC2A0180>]}
[0m17:03:01.408937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71c4ee88-12d0-484a-ad09-9220e8e2290b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DCDDB9B0>]}
[0m17:03:01.417800 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:03:01.967320 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:03:02.362287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:03:02.364182 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\silver_schema.yml
[0m17:03:02.365090 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\gold\gold_schema.yml
[0m17:03:03.190150 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:03:03.207220 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models\gold\gold_schema.yml:
  	test definition dictionary must have exactly one key, got [('dbt_expectations.expect_column_values_to_be_between', None), ('arguments', {'min_value': 0, 'max_value': 100})] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m17:03:03.208622 [debug] [MainThread]: Command `-c parse` failed at 17:03:03.208440 after 2.89 seconds
[0m17:03:03.209157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DE5ED850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DE5ED550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DE40ED50>]}
[0m17:03:03.209672 [debug] [MainThread]: Flushing usage events
[0m17:03:04.164995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:37.910272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DAB28050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DB3342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DB977ED0>]}


============================== 17:05:37.925609 | c0bafb6d-7c2a-4b93-8bad-bdd94450a8b5 ==============================
[0m17:05:37.925609 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:05:37.928145 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt deps', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m17:05:38.185572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0bafb6d-7c2a-4b93-8bad-bdd94450a8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DACE0180>]}
[0m17:05:38.234080 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-hzu8_xy_'
[0m17:05:38.235252 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:05:39.285936 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:05:39.293124 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:05:40.101229 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:05:40.129631 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m17:05:40.940584 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m17:05:40.955419 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m17:05:41.725103 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m17:05:41.779665 [info ] [MainThread]: Updating lock file in file path: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2/package-lock.yml
[0m17:05:41.967150 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-wlimr7zt'
[0m17:05:41.989996 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:05:43.566871 [info ] [MainThread]: Installed from version 1.3.2
[0m17:05:43.567888 [info ] [MainThread]: Up to date!
[0m17:05:43.568740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c0bafb6d-7c2a-4b93-8bad-bdd94450a8b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DCC35370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DCC35480>]}
[0m17:05:43.569391 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m17:05:48.438507 [info ] [MainThread]: Installed from version 0.10.9
[0m17:05:48.439280 [info ] [MainThread]: Up to date!
[0m17:05:48.440016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c0bafb6d-7c2a-4b93-8bad-bdd94450a8b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DCC4D050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DB809040>]}
[0m17:05:48.440568 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m17:05:49.957765 [info ] [MainThread]: Installed from version 0.16.1
[0m17:05:49.959697 [info ] [MainThread]: Up to date!
[0m17:05:49.961670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c0bafb6d-7c2a-4b93-8bad-bdd94450a8b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DCC29EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DCC29C50>]}
[0m17:05:49.972664 [debug] [MainThread]: Command `-c deps` succeeded at 17:05:49.972086 after 12.59 seconds
[0m17:05:49.974174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DB7671D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DCB33290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DCC422B0>]}
[0m17:05:49.975706 [debug] [MainThread]: Flushing usage events
[0m17:05:51.802790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:03.756064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39FC78050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A04842D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A0AC3ED0>]}


============================== 17:06:03.771322 | 97e3d6b7-c84f-4dc2-8cff-b7d9237e3136 ==============================
[0m17:06:03.771322 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:06:03.773828 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'printer_width': '80', 'write_json': 'True'}
[0m17:06:04.320517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97e3d6b7-c84f-4dc2-8cff-b7d9237e3136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39FE30180>]}
[0m17:06:04.421456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97e3d6b7-c84f-4dc2-8cff-b7d9237e3136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A096B790>]}
[0m17:06:04.425365 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:06:04.964544 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:06:05.209915 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:06:05.210939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '97e3d6b7-c84f-4dc2-8cff-b7d9237e3136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A1DFD250>]}
[0m17:06:10.850722 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:06:11.041626 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models\gold\gold_schema.yml:
  	test definition dictionary must have exactly one key, got [('dbt_expectations.expect_column_values_to_be_between', None), ('arguments', {'min_value': 0, 'max_value': 100})] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m17:06:11.043278 [debug] [MainThread]: Command `-c parse` failed at 17:06:11.043071 after 7.54 seconds
[0m17:06:11.043889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A25F0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A25F0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A0983E70>]}
[0m17:06:11.044484 [debug] [MainThread]: Flushing usage events
[0m17:06:12.110367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:14.807103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05C848050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05D0542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05D697ED0>]}


============================== 17:11:14.820044 | 746bbbcc-85c9-48ee-bebf-bc7cc271ef6b ==============================
[0m17:11:14.820044 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:11:14.822079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:11:15.247382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '746bbbcc-85c9-48ee-bebf-bc7cc271ef6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05CA00180>]}
[0m17:11:15.337937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '746bbbcc-85c9-48ee-bebf-bc7cc271ef6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05D53B790>]}
[0m17:11:15.341252 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:11:15.714635 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:11:15.871735 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:11:15.872488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '746bbbcc-85c9-48ee-bebf-bc7cc271ef6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05EA0D250>]}
[0m17:11:18.583269 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:11:18.717808 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m17:11:18.718671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '746bbbcc-85c9-48ee-bebf-bc7cc271ef6b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05ED597C0>]}
[0m17:11:18.748157 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models\gold\gold_schema.yml:
  	test definition dictionary must have exactly one key, got [('dbt_expectations.expect_column_values_to_be_between', None), ('arguments', {'min_value': 0, 'max_value': 100})] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m17:11:18.749402 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:11:18.751060 [debug] [MainThread]: Command `-c parse` failed at 17:11:18.750791 after 4.31 seconds
[0m17:11:18.751866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05D553E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05F1CF3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05EE3E680>]}
[0m17:11:18.752434 [debug] [MainThread]: Flushing usage events
[0m17:11:19.618703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:46.172428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E578050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8ED842D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8F3C3ED0>]}


============================== 17:11:46.189592 | e08525d7-6759-4674-b946-93ef6b2942a8 ==============================
[0m17:11:46.189592 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:11:46.192295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:11:46.619182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e08525d7-6759-4674-b946-93ef6b2942a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E730180>]}
[0m17:11:46.709973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e08525d7-6759-4674-b946-93ef6b2942a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8F26B790>]}
[0m17:11:46.713332 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:11:47.069535 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:11:47.312551 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:11:47.313954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e08525d7-6759-4674-b946-93ef6b2942a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF9071D250>]}
[0m17:11:50.094221 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:11:50.238056 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m17:11:50.239148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e08525d7-6759-4674-b946-93ef6b2942a8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF90A717C0>]}
[0m17:11:50.664816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e08525d7-6759-4674-b946-93ef6b2942a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF90C77850>]}
[0m17:11:50.670518 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m17:11:50.874897 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:11:50.878157 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:11:50.878883 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:11:50.880337 [debug] [MainThread]: Command `-c parse` succeeded at 17:11:50.880170 after 4.97 seconds
[0m17:11:50.880860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF90B6CBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8F1BB1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF90AFE090>]}
[0m17:11:50.881452 [debug] [MainThread]: Flushing usage events
[0m17:11:52.185254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:21.561701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282E82A8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282E8AB42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282E90F7ED0>]}


============================== 17:13:21.568704 | c4381fbf-2491-4417-b06c-af8f2635f80e ==============================
[0m17:13:21.568704 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:13:21.569785 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt parse', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:13:21.962732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4381fbf-2491-4417-b06c-af8f2635f80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282E8460180>]}
[0m17:13:22.053218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4381fbf-2491-4417-b06c-af8f2635f80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282E8F9B790>]}
[0m17:13:22.056930 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:13:22.459227 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:13:22.772631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:13:22.773748 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\gold\gold_schema.yml
[0m17:13:23.240531 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:13:23.241735 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m17:13:23.242445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c4381fbf-2491-4417-b06c-af8f2635f80e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282EA935B50>]}
[0m17:13:23.552149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4381fbf-2491-4417-b06c-af8f2635f80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282EA85FB60>]}
[0m17:13:23.557573 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m17:13:23.749447 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:13:23.752536 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:13:23.753242 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:13:23.754779 [debug] [MainThread]: Command `-c parse` succeeded at 17:13:23.754574 after 2.53 seconds
[0m17:13:23.755497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282E8FB3E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282EA424AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282EAA7BEE0>]}
[0m17:13:23.756040 [debug] [MainThread]: Flushing usage events
[0m17:13:24.583848 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:45.959013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF6D68050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF75742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF7BB7ED0>]}


============================== 17:13:45.974581 | a87a6ca9-37f2-4de3-99c3-a4fbad44bfa2 ==============================
[0m17:13:45.974581 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:13:45.977625 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt build --target +fact__rsi', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m17:13:45.988135 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'portfolio_project_2' does not have a target named '+fact__rsi'. The valid target names for this profile are:
   - dev
   - prod
[0m17:13:45.991566 [debug] [MainThread]: Command `-c build` failed at 17:13:45.991068 after 0.30 seconds
[0m17:13:45.993007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF7C342B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF7AB68D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF7A59AE0>]}
[0m17:13:45.994458 [debug] [MainThread]: Flushing usage events
[0m17:13:46.896927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:57.592834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758A7F8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758B0042D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758B647ED0>]}


============================== 17:13:57.608105 | c9f0dae3-9834-4ace-b3ff-02009404608d ==============================
[0m17:13:57.608105 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:13:57.610577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt build --target +fct__rsi', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:13:57.620454 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'portfolio_project_2' does not have a target named '+fct__rsi'. The valid target names for this profile are:
   - dev
   - prod
[0m17:13:57.623814 [debug] [MainThread]: Command `-c build` failed at 17:13:57.623320 after 0.26 seconds
[0m17:13:57.625243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758B6C42B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758B5468D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758B4E9AE0>]}
[0m17:13:57.626689 [debug] [MainThread]: Flushing usage events
[0m17:13:58.576945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:16.506750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C4D58050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C55642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C5BA3ED0>]}


============================== 17:14:16.521701 | 2516613b-6de9-4b1c-ab6d-c64d597a1999 ==============================
[0m17:14:16.521701 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:14:16.524161 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select +fct__rsi', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m17:14:16.981025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2516613b-6de9-4b1c-ab6d-c64d597a1999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C4F10180>]}
[0m17:14:17.071488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2516613b-6de9-4b1c-ab6d-c64d597a1999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C5A4B790>]}
[0m17:14:17.074945 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:14:17.544742 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:14:18.350732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:18.351451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:18.430214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2516613b-6de9-4b1c-ab6d-c64d597a1999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C6C94F50>]}
[0m17:14:18.690547 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:14:18.694074 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:14:18.798199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2516613b-6de9-4b1c-ab6d-c64d597a1999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C75AD5E0>]}
[0m17:14:18.799640 [info ] [MainThread]: Found 6 models, 47 data tests, 2 sources, 853 macros
[0m17:14:18.814937 [info ] [MainThread]: 
[0m17:14:18.816632 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:14:18.818191 [info ] [MainThread]: 
[0m17:14:18.820473 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:14:18.838948 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:14:21.890354 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:14:21.890948 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:14:21.891432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:24.704952 [debug] [ThreadPool]: SQL status: OK in 2.813 seconds
[0m17:14:24.710660 [debug] [ThreadPool]: On list_finance: Close
[0m17:14:24.713550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:14:24.715710 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:14:24.742554 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:14:24.744067 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:14:24.745482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:24.750352 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:14:24.754348 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:14:24.755247 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:14:24.757473 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:14:24.758233 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:14:24.758939 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:14:24.816290 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m17:14:24.820048 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:14:24.822108 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:14:24.824928 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:14:24.880907 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m17:14:24.883021 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:14:24.890375 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:14:24.920910 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:14:24.922414 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:14:24.923725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:24.928640 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:14:24.930233 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:14:24.931781 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:14:25.083779 [debug] [ThreadPool]: SQL status: OK in 0.150 seconds
[0m17:14:25.089634 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:14:25.142926 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:14:25.144662 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:14:25.152255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2516613b-6de9-4b1c-ab6d-c64d597a1999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C74CA190>]}
[0m17:14:25.154142 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:25.155501 [debug] [MainThread]: On master: BEGIN
[0m17:14:25.156761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:25.161033 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:14:25.162613 [debug] [MainThread]: On master: COMMIT
[0m17:14:25.164252 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:25.165532 [debug] [MainThread]: On master: COMMIT
[0m17:14:25.168219 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:14:25.169576 [debug] [MainThread]: On master: Close
[0m17:14:25.185443 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m17:14:25.187549 [info ] [Thread-1 (]: 1 of 52 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m17:14:25.190410 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m17:14:25.192069 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m17:14:25.223026 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m17:14:25.227584 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m17:14:25.365615 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m17:14:25.369740 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:14:25.371528 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m17:14:25.373120 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:14:25.378901 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:14:25.381009 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:14:25.382663 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:14:25.487633 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m17:14:25.512631 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:14:25.514283 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m17:14:25.571734 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m17:14:25.585048 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:14:25.586643 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m17:14:25.650887 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m17:14:25.698673 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:14:25.700427 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:14:25.701956 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:14:25.932823 [debug] [Thread-1 (]: SQL status: OK in 0.229 seconds
[0m17:14:25.971431 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:14:25.973359 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m17:14:26.093083 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m17:14:26.102540 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m17:14:26.110681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2516613b-6de9-4b1c-ab6d-c64d597a1999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C8DC5F30>]}
[0m17:14:26.113325 [info ] [Thread-1 (]: 1 of 52 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.91s]
[0m17:14:26.116506 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m17:14:26.119387 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m17:14:26.121715 [info ] [Thread-2 (]: 2 of 52 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m17:14:26.124496 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m17:14:26.126179 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m17:14:26.137355 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m17:14:26.141298 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m17:14:26.155064 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m17:14:26.159300 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:14:26.160968 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m17:14:26.162495 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:14:26.167176 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:14:26.168730 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:14:26.170435 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:14:26.281036 [debug] [Thread-2 (]: SQL status: OK in 0.108 seconds
[0m17:14:26.293711 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:14:26.296618 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m17:14:26.364854 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m17:14:26.376546 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:14:26.378464 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m17:14:26.448032 [debug] [Thread-2 (]: SQL status: OK in 0.068 seconds
[0m17:14:26.453916 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:14:26.455704 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:14:26.457409 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:14:26.628627 [debug] [Thread-2 (]: SQL status: OK in 0.170 seconds
[0m17:14:26.641956 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:14:26.644773 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m17:14:26.777093 [debug] [Thread-2 (]: SQL status: OK in 0.130 seconds
[0m17:14:26.783863 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m17:14:26.786785 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2516613b-6de9-4b1c-ab6d-c64d597a1999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C719AB10>]}
[0m17:14:26.790658 [info ] [Thread-2 (]: 2 of 52 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.66s]
[0m17:14:26.796314 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m17:14:26.801543 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:14:26.803727 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:14:26.806058 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca
[0m17:14:26.808242 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:14:26.811282 [info ] [Thread-3 (]: 3 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m17:14:26.813291 [info ] [Thread-1 (]: 5 of 52 START test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9  [RUN]
[0m17:14:26.820854 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:14:26.823354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de)
[0m17:14:26.815637 [info ] [Thread-2 (]: 6 of 52 START test dbt_utils_expression_is_true_int__price_changes_gain__gain_0  [RUN]
[0m17:14:26.826393 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:14:26.828596 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:14:26.817684 [info ] [Thread-4 (]: 4 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m17:14:26.831323 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca)
[0m17:14:26.926056 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:14:26.933055 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:14:26.937755 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:14:26.939907 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca
[0m17:14:26.941520 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:14:26.954913 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca"
[0m17:14:26.967165 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:14:26.969529 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:14:26.971311 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:14:27.017618 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:14:27.022195 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca
[0m17:14:27.097171 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:14:27.106934 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:14:27.118265 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:14:27.122348 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca"
[0m17:14:27.127779 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:14:27.128664 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m17:14:27.129617 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca"
[0m17:14:27.130465 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:14:27.131279 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca: BEGIN
[0m17:14:27.132474 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:14:27.133290 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:14:27.134070 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: BEGIN
[0m17:14:27.135050 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:14:27.136141 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:14:27.137076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:27.137870 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:14:27.138609 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:14:27.139377 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m17:14:27.140741 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m17:14:27.141548 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca"
[0m17:14:27.142460 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:14:27.143781 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:14:27.145528 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:14:27.147373 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:14:27.149023 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:14:27.156842 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:14:27.157809 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(delta) - (gain + loss)) > 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:14:27.158705 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:14:27.159557 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:14:27.164677 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(delta) - (gain + loss)) > 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:14:27.165731 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m17:14:27.167289 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:14:27.168115 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca: ROLLBACK
[0m17:14:27.170187 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: ROLLBACK
[0m17:14:27.264349 [debug] [Thread-4 (]: SQL status: OK in 0.119 seconds
[0m17:14:27.272662 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m17:14:27.274818 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:14:27.276316 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m17:14:27.278523 [info ] [Thread-4 (]: 4 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.35s]
[0m17:14:27.280673 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:14:27.282137 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152
[0m17:14:27.283582 [info ] [Thread-4 (]: 7 of 52 START test dbt_utils_expression_is_true_int__price_changes_loss__loss_0  [RUN]
[0m17:14:27.285139 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152)
[0m17:14:27.285960 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152
[0m17:14:27.295885 [debug] [Thread-3 (]: SQL status: OK in 0.127 seconds
[0m17:14:27.299909 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152"
[0m17:14:27.302902 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152
[0m17:14:27.306596 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m17:14:27.312849 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152"
[0m17:14:27.315081 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:14:27.316816 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m17:14:27.318792 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152"
[0m17:14:27.323073 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152: BEGIN
[0m17:14:27.321489 [info ] [Thread-3 (]: 3 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.50s]
[0m17:14:27.325330 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:14:27.327075 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:14:27.328955 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:14:27.330456 [info ] [Thread-3 (]: 8 of 52 START test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14  [RUN]
[0m17:14:27.332344 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m17:14:27.333363 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182)
[0m17:14:27.334407 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152"
[0m17:14:27.336228 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:14:27.338739 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:14:27.353075 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:14:27.360038 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:14:27.361923 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:14:27.363280 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152: ROLLBACK
[0m17:14:27.366967 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:14:27.374704 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:14:27.377050 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:14:27.377930 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: BEGIN
[0m17:14:27.378759 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:14:27.383374 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:14:27.429793 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:14:27.433562 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:14:27.456697 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:14:27.457868 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:14:27.459012 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: ROLLBACK
[0m17:14:27.568308 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152'
[0m17:14:27.570929 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182'
[0m17:14:27.572054 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152: Close
[0m17:14:27.578521 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de'
[0m17:14:27.579944 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: Close
[0m17:14:27.581777 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca'
[0m17:14:27.582903 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: Close
[0m17:14:27.588371 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca: Close
[0m17:14:27.603055 [debug] [Thread-4 (]: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_loss__loss_0 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "loss"
  
  LINE 18: where not(loss loss >= 0)
                          ^
[0m17:14:27.604403 [error] [Thread-4 (]: 7 of 52 ERROR dbt_utils_expression_is_true_int__price_changes_loss__loss_0 ..... [[31mERROR[0m in 0.32s]
[0m17:14:27.607264 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152
[0m17:14:27.612686 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:14:27.618271 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152' to be skipped because of status 'error'.  Reason: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_loss__loss_0 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "loss"
  
  LINE 18: where not(loss loss >= 0)
                          ^.
[0m17:14:27.621680 [debug] [Thread-3 (]: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "period_check"
  
  LINE 18: where not(period_check period_check between 1 and 14)
                                  ^
[0m17:14:27.619157 [info ] [Thread-4 (]: 9 of 52 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m17:14:27.627088 [debug] [Thread-1 (]: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near ")"
  
  LINE 24:     ) dbt_internal_test
               ^
[0m17:14:27.628620 [error] [Thread-3 (]: 8 of 52 ERROR dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14  [[31mERROR[0m in 0.29s]
[0m17:14:27.634271 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m17:14:27.636595 [debug] [Thread-2 (]: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_gain__gain_0 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "gain"
  
  LINE 18: where not(gain gain >= 0)
                          ^
[0m17:14:27.639463 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:14:27.638023 [error] [Thread-1 (]: 5 of 52 ERROR dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9  [[31mERROR[0m in 0.82s]
[0m17:14:27.640832 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:14:27.643705 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:14:27.642267 [error] [Thread-2 (]: 6 of 52 ERROR dbt_utils_expression_is_true_int__price_changes_gain__gain_0 ..... [[31mERROR[0m in 0.81s]
[0m17:14:27.646495 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182' to be skipped because of status 'error'.  Reason: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "period_check"
  
  LINE 18: where not(period_check period_check between 1 and 14)
                                  ^.
[0m17:14:27.648230 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:14:27.672728 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:14:27.676747 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca
[0m17:14:27.674284 [info ] [Thread-3 (]: 10 of 52 START test not_null_int__price_changes_close .......................... [RUN]
[0m17:14:27.679271 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:14:27.681087 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de' to be skipped because of status 'error'.  Reason: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near ")"
  
  LINE 24:     ) dbt_internal_test
               ^.
[0m17:14:27.682789 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:14:27.684110 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m17:14:27.685367 [info ] [Thread-1 (]: 11 of 52 START test not_null_int__price_changes_gain ........................... [RUN]
[0m17:14:27.688053 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca' to be skipped because of status 'error'.  Reason: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_gain__gain_0 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "gain"
  
  LINE 18: where not(gain gain >= 0)
                          ^.
[0m17:14:27.691612 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:14:27.689864 [info ] [Thread-2 (]: 12 of 52 START test not_null_int__price_changes_loaded_at ...................... [RUN]
[0m17:14:27.694273 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:14:27.695635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m17:14:27.715273 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:14:27.716438 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m17:14:27.738496 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:14:27.740495 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:14:27.743020 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:14:27.761713 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:14:27.770094 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:14:27.797778 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:14:27.799998 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m17:14:27.802711 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:14:27.806137 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:14:27.818222 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:14:27.821758 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:14:27.825268 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:14:27.839255 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:14:27.849905 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:14:27.853498 [debug] [Thread-4 (]: SQL status: OK in 0.047 seconds
[0m17:14:27.857255 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:14:27.861012 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:14:27.864074 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m17:14:27.867332 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:14:27.869817 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:14:27.873448 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:14:27.876088 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:14:27.878153 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m17:14:27.882139 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m17:14:27.884496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:27.887350 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:14:27.889657 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m17:14:27.893816 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:14:27.897177 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:14:27.899749 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m17:14:27.901831 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m17:14:27.904351 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:14:27.907913 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:14:27.910398 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:14:27.912734 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:14:27.974579 [debug] [Thread-4 (]: SQL status: OK in 0.094 seconds
[0m17:14:27.987209 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m17:14:27.991565 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m17:14:27.993817 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m17:14:27.995944 [debug] [Thread-3 (]: SQL status: OK in 0.097 seconds
[0m17:14:28.007555 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m17:14:28.000589 [info ] [Thread-4 (]: 9 of 52 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.37s]
[0m17:14:28.011429 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m17:14:28.014549 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:14:28.016671 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m17:14:28.019007 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:14:28.022408 [info ] [Thread-4 (]: 13 of 52 START test not_null_int__price_changes_loss ........................... [RUN]
[0m17:14:28.027851 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m17:14:28.025345 [info ] [Thread-3 (]: 10 of 52 PASS not_null_int__price_changes_close ................................ [[32mPASS[0m in 0.34s]
[0m17:14:28.030681 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:14:28.034289 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:14:28.054776 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:14:28.056864 [debug] [Thread-1 (]: SQL status: OK in 0.142 seconds
[0m17:14:28.058971 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:14:28.061276 [debug] [Thread-2 (]: SQL status: OK in 0.146 seconds
[0m17:14:28.064015 [info ] [Thread-3 (]: 14 of 52 START test not_null_int__price_changes_rn ............................. [RUN]
[0m17:14:28.067044 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m17:14:28.073438 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:14:28.077189 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m17:14:28.083136 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m17:14:28.099522 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:14:28.102818 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:14:28.105189 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m17:14:28.107752 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m17:14:28.117447 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:14:28.120412 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m17:14:28.122365 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m17:14:28.125125 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:14:28.127655 [info ] [Thread-1 (]: 11 of 52 PASS not_null_int__price_changes_gain ................................. [[32mPASS[0m in 0.43s]
[0m17:14:28.140890 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:14:28.144179 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:14:28.129825 [info ] [Thread-2 (]: 12 of 52 PASS not_null_int__price_changes_loaded_at ............................ [[32mPASS[0m in 0.41s]
[0m17:14:28.146664 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:14:28.149121 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:14:28.151997 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:14:28.153949 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m17:14:28.157738 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:14:28.159989 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:14:28.155945 [info ] [Thread-1 (]: 15 of 52 START test not_null_int__price_changes_ticker ......................... [RUN]
[0m17:14:28.162142 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:14:28.165746 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m17:14:28.164082 [info ] [Thread-2 (]: 16 of 52 START test not_null_int__price_changes_trade_date ..................... [RUN]
[0m17:14:28.168113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m17:14:28.170752 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:14:28.172942 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m17:14:28.175007 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:14:28.176827 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m17:14:28.179334 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:14:28.195249 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:14:28.197179 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:14:28.198956 [debug] [Thread-3 (]: SQL status: OK in 0.028 seconds
[0m17:14:28.215582 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:14:28.218049 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:14:28.220024 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:14:28.223692 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:14:28.226304 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:14:28.237161 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:14:28.239636 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:14:28.251564 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:14:28.254367 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:14:28.256097 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m17:14:28.257585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:28.260453 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:14:28.262134 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m17:14:28.263852 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:14:28.265407 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:14:28.267093 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:14:28.269615 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:14:28.272439 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:14:28.274104 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:14:28.275751 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:14:28.441146 [debug] [Thread-4 (]: SQL status: OK in 0.219 seconds
[0m17:14:28.442164 [debug] [Thread-3 (]: SQL status: OK in 0.203 seconds
[0m17:14:28.447400 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m17:14:28.450700 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m17:14:28.452760 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m17:14:28.455515 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m17:14:28.456748 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m17:14:28.458070 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m17:14:28.462036 [info ] [Thread-4 (]: 13 of 52 PASS not_null_int__price_changes_loss ................................. [[32mPASS[0m in 0.43s]
[0m17:14:28.466971 [debug] [Thread-1 (]: SQL status: OK in 0.195 seconds
[0m17:14:28.468668 [debug] [Thread-2 (]: SQL status: OK in 0.191 seconds
[0m17:14:28.464745 [info ] [Thread-3 (]: 14 of 52 PASS not_null_int__price_changes_rn ................................... [[32mPASS[0m in 0.40s]
[0m17:14:28.473278 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:14:28.477669 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:14:28.486336 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m17:14:28.492206 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m17:14:28.496150 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m17:14:28.499834 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m17:14:28.501831 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m17:14:28.503865 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m17:14:28.509943 [info ] [Thread-2 (]: 16 of 52 PASS not_null_int__price_changes_trade_date ........................... [[32mPASS[0m in 0.34s]
[0m17:14:28.516828 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:14:28.512712 [info ] [Thread-1 (]: 15 of 52 PASS not_null_int__price_changes_ticker ............................... [[32mPASS[0m in 0.34s]
[0m17:14:28.522662 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:14:28.525981 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m17:14:28.528703 [info ] [Thread-4 (]: 17 of 52 SKIP relation analytics_dev.int__rsi_sma .............................. [[33mSKIP[0m]
[0m17:14:28.533031 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m17:14:28.535010 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_sma' to be skipped because of status 'skipped'. 
[0m17:14:28.540367 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:14:28.544087 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14.52086331c6
[0m17:14:28.547527 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain__sma_gain_0.e90a9c84e7
[0m17:14:28.552557 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:14:28.550103 [info ] [Thread-2 (]: 19 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_loss___0 .......... [[33mSKIP[0m]
[0m17:14:28.557318 [info ] [Thread-1 (]: 20 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14  [[33mSKIP[0m]
[0m17:14:28.559737 [info ] [Thread-4 (]: 21 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_sma_gain__sma_gain_0  [[33mSKIP[0m]
[0m17:14:28.565555 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:14:28.568348 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14.52086331c6
[0m17:14:28.562762 [info ] [Thread-3 (]: 18 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_gain___0 .......... [[33mSKIP[0m]
[0m17:14:28.571670 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain__sma_gain_0.e90a9c84e7
[0m17:14:28.574995 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss__sma_loss_0.fea3f2e739
[0m17:14:28.577546 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62' to be skipped because of status 'skipped'. 
[0m17:14:28.579774 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:14:28.581960 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:14:28.584104 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:14:28.590483 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14.52086331c6' to be skipped because of status 'skipped'. 
[0m17:14:28.587816 [info ] [Thread-2 (]: 22 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_sma_loss__sma_loss_0  [[33mSKIP[0m]
[0m17:14:28.597772 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:14:28.595372 [info ] [Thread-1 (]: 23 of 52 SKIP test dbt_utils_not_null_where_int__rsi_sma_sma_gain .............. [[33mSKIP[0m]
[0m17:14:28.602713 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain__sma_gain_0.e90a9c84e7' to be skipped because of status 'skipped'. 
[0m17:14:28.600719 [info ] [Thread-4 (]: 24 of 52 SKIP test dbt_utils_not_null_where_int__rsi_sma_sma_loss .............. [[33mSKIP[0m]
[0m17:14:28.605554 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss__sma_loss_0.fea3f2e739
[0m17:14:28.609963 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:14:28.607992 [info ] [Thread-3 (]: 25 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [[33mSKIP[0m]
[0m17:14:28.613733 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6' to be skipped because of status 'skipped'. 
[0m17:14:28.616396 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:14:28.619115 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:14:28.622248 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:14:28.624930 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:14:28.628021 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss__sma_loss_0.fea3f2e739' to be skipped because of status 'skipped'. 
[0m17:14:28.631518 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:14:28.633701 [info ] [Thread-2 (]: 26 of 52 SKIP test not_null_int__rsi_sma_close ................................. [[33mSKIP[0m]
[0m17:14:28.641000 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:14:28.643869 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e' to be skipped because of status 'skipped'. 
[0m17:14:28.637120 [info ] [Thread-1 (]: 27 of 52 SKIP test not_null_int__rsi_sma_gain .................................. [[33mSKIP[0m]
[0m17:14:28.650166 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:14:28.647551 [info ] [Thread-4 (]: 28 of 52 SKIP test not_null_int__rsi_sma_loaded_at ............................. [[33mSKIP[0m]
[0m17:14:28.656281 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d' to be skipped because of status 'skipped'. 
[0m17:14:28.654029 [info ] [Thread-3 (]: 29 of 52 SKIP test not_null_int__rsi_sma_loss .................................. [[33mSKIP[0m]
[0m17:14:28.659352 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:14:28.662412 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:14:28.665444 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:14:28.668174 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08' to be skipped because of status 'skipped'. 
[0m17:14:28.672179 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:14:28.675120 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:14:28.681136 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:14:28.679146 [info ] [Thread-2 (]: 30 of 52 SKIP test not_null_int__rsi_sma_rn .................................... [[33mSKIP[0m]
[0m17:14:28.683851 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b' to be skipped because of status 'skipped'. 
[0m17:14:28.687508 [info ] [Thread-1 (]: 31 of 52 SKIP test not_null_int__rsi_sma_ticker ................................ [[33mSKIP[0m]
[0m17:14:28.696309 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:14:28.691238 [info ] [Thread-4 (]: 32 of 52 SKIP test not_null_int__rsi_sma_trade_date ............................ [[33mSKIP[0m]
[0m17:14:28.700976 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953' to be skipped because of status 'skipped'. 
[0m17:14:28.705676 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:14:28.709326 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:14:28.712041 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0' to be skipped because of status 'skipped'. 
[0m17:14:28.715534 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065' to be skipped because of status 'skipped'. 
[0m17:14:28.717519 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139' to be skipped because of status 'skipped'. 
[0m17:14:28.721209 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d' to be skipped because of status 'skipped'. 
[0m17:14:28.724796 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0' to be skipped because of status 'skipped'. 
[0m17:14:28.728944 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m17:14:28.731895 [info ] [Thread-3 (]: 33 of 52 SKIP relation analytics_dev.int__rsi_wilder ........................... [[33mSKIP[0m]
[0m17:14:28.735580 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m17:14:28.739259 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_wilder' to be skipped because of status 'skipped'. 
[0m17:14:28.743273 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss__wilder_loss_0.1590da64c7
[0m17:14:28.745783 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:14:28.748147 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain__wilder_gain_0.a5859537ad
[0m17:14:28.750249 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:14:28.753371 [info ] [Thread-3 (]: 37 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss__wilder_loss_0  [[33mSKIP[0m]
[0m17:14:28.756570 [info ] [Thread-1 (]: 35 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ....... [[33mSKIP[0m]
[0m17:14:28.764981 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss__wilder_loss_0.1590da64c7
[0m17:14:28.759220 [info ] [Thread-4 (]: 36 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain__wilder_gain_0  [[33mSKIP[0m]
[0m17:14:28.772266 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:14:28.762507 [info ] [Thread-2 (]: 34 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ....... [[33mSKIP[0m]
[0m17:14:28.777595 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:14:28.780765 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss__wilder_loss_0.1590da64c7' to be skipped because of status 'skipped'. 
[0m17:14:28.782949 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain__wilder_gain_0.a5859537ad
[0m17:14:28.786217 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:14:28.790259 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:14:28.794943 [info ] [Thread-3 (]: 38 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[33mSKIP[0m]
[0m17:14:28.799350 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703' to be skipped because of status 'skipped'. 
[0m17:14:28.803302 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:14:28.810417 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:14:28.807566 [info ] [Thread-1 (]: 39 of 52 SKIP test not_null_int__rsi_wilder_gain ............................... [[33mSKIP[0m]
[0m17:14:28.814388 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:14:28.816553 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain__wilder_gain_0.a5859537ad' to be skipped because of status 'skipped'. 
[0m17:14:28.819833 [info ] [Thread-4 (]: 40 of 52 SKIP test not_null_int__rsi_wilder_loss ............................... [[33mSKIP[0m]
[0m17:14:28.826042 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:14:28.823518 [info ] [Thread-2 (]: 41 of 52 SKIP test not_null_int__rsi_wilder_rn ................................. [[33mSKIP[0m]
[0m17:14:28.828781 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:14:28.840917 [info ] [Thread-3 (]: 42 of 52 SKIP test not_null_int__rsi_wilder_ticker ............................. [[33mSKIP[0m]
[0m17:14:28.843505 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:14:28.845982 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:14:28.831820 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:14:28.849934 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:14:28.830285 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90' to be skipped because of status 'skipped'. 
[0m17:14:28.859377 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95' to be skipped because of status 'skipped'. 
[0m17:14:28.861313 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda' to be skipped because of status 'skipped'. 
[0m17:14:28.833214 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:14:28.834556 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:14:28.870770 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:14:28.848242 [info ] [Thread-3 (]: 44 of 52 SKIP test not_null_int__rsi_wilder_wilder_gain ........................ [[33mSKIP[0m]
[0m17:14:28.851995 [info ] [Thread-4 (]: 45 of 52 SKIP test not_null_int__rsi_wilder_wilder_loss ........................ [[33mSKIP[0m]
[0m17:14:28.863066 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd' to be skipped because of status 'skipped'. 
[0m17:14:28.874565 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:14:28.876518 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:14:28.868443 [info ] [Thread-1 (]: 43 of 52 SKIP test not_null_int__rsi_wilder_trade_date ......................... [[33mSKIP[0m]
[0m17:14:28.881265 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:14:28.878441 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56' to be skipped because of status 'skipped'. 
[0m17:14:28.883725 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d' to be skipped because of status 'skipped'. 
[0m17:14:28.885883 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9' to be skipped because of status 'skipped'. 
[0m17:14:28.888039 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb' to be skipped because of status 'skipped'. 
[0m17:14:28.892823 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c' to be skipped because of status 'skipped'. 
[0m17:14:28.872909 [info ] [Thread-2 (]: 46 of 52 SKIP test wilder_seed_equals_sma ...................................... [[33mSKIP[0m]
[0m17:14:28.895514 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:14:28.897500 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.wilder_seed_equals_sma' to be skipped because of status 'skipped'. 
[0m17:14:28.900028 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.fct__rsi
[0m17:14:28.901651 [info ] [Thread-3 (]: 47 of 52 SKIP relation analytics_dev.fct__rsi .................................. [[33mSKIP[0m]
[0m17:14:28.906818 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m17:14:28.909019 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'skipped'. 
[0m17:14:28.911868 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:14:28.915527 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:14:28.917311 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:14:28.919019 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:14:28.913743 [info ] [Thread-1 (]: 49 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[33mSKIP[0m]
[0m17:14:28.921242 [info ] [Thread-4 (]: 48 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[33mSKIP[0m]
[0m17:14:28.927112 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:14:28.929156 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:14:28.923622 [info ] [Thread-3 (]: 51 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ......... [[33mSKIP[0m]
[0m17:14:28.931958 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:14:28.933312 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2' to be skipped because of status 'skipped'. 
[0m17:14:28.935358 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:14:28.925184 [info ] [Thread-2 (]: 50 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............ [[33mSKIP[0m]
[0m17:14:28.940853 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a' to be skipped because of status 'skipped'. 
[0m17:14:28.939211 [info ] [Thread-1 (]: 52 of 52 SKIP test dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker  [[33mSKIP[0m]
[0m17:14:28.943632 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:14:28.945103 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0' to be skipped because of status 'skipped'. 
[0m17:14:28.946686 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:14:28.948427 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a' to be skipped because of status 'skipped'. 
[0m17:14:28.950288 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400' to be skipped because of status 'skipped'. 
[0m17:14:28.957244 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:28.958571 [debug] [MainThread]: On master: BEGIN
[0m17:14:28.959441 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:14:28.965704 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m17:14:28.967002 [debug] [MainThread]: On master: COMMIT
[0m17:14:28.968308 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:28.969489 [debug] [MainThread]: On master: COMMIT
[0m17:14:28.972951 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:14:28.974270 [debug] [MainThread]: On master: Close
[0m17:14:28.976002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:28.977369 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:14:28.978751 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:14:28.980011 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a' was properly closed.
[0m17:14:28.981265 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5' was properly closed.
[0m17:14:28.982328 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638' was properly closed.
[0m17:14:28.983054 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa' was properly closed.
[0m17:14:28.984196 [info ] [MainThread]: 
[0m17:14:28.987761 [info ] [MainThread]: Finished running 47 data tests, 5 view models in 0 hours 0 minutes and 10.16 seconds (10.16s).
[0m17:14:29.000426 [debug] [MainThread]: Command end result
[0m17:14:29.228389 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:14:29.233967 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:14:29.252174 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:14:29.253170 [info ] [MainThread]: 
[0m17:14:29.254257 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m17:14:29.255469 [info ] [MainThread]: 
[0m17:14:29.256651 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int__price_changes_loss__loss_0 (models\silver\silver_schema.yml)[0m
[0m17:14:29.257757 [error] [MainThread]:   Runtime Error in test dbt_utils_expression_is_true_int__price_changes_loss__loss_0 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "loss"
  
  LINE 18: where not(loss loss >= 0)
                          ^
[0m17:14:29.258834 [info ] [MainThread]: 
[0m17:14:29.259955 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\silver_schema.yml\dbt_utils_expression_is_true_int__price_changes_loss__loss_0.sql
[0m17:14:29.260926 [info ] [MainThread]: 
[0m17:14:29.262058 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)[0m
[0m17:14:29.263187 [error] [MainThread]:   Runtime Error in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "period_check"
  
  LINE 18: where not(period_check period_check between 1 and 14)
                                  ^
[0m17:14:29.264644 [info ] [MainThread]: 
[0m17:14:29.266474 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\silver_schema.yml\dbt_utils_expression_is_true_i_02fc6d0de4be0787745a8150f25c1081.sql
[0m17:14:29.267878 [info ] [MainThread]: 
[0m17:14:29.269491 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)[0m
[0m17:14:29.271359 [error] [MainThread]:   Runtime Error in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near ")"
  
  LINE 24:     ) dbt_internal_test
               ^
[0m17:14:29.273328 [info ] [MainThread]: 
[0m17:14:29.275407 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\silver_schema.yml\dbt_utils_expression_is_true_i_42ddde861532075e91a49918f22e3300.sql
[0m17:14:29.277025 [info ] [MainThread]: 
[0m17:14:29.278678 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int__price_changes_gain__gain_0 (models\silver\silver_schema.yml)[0m
[0m17:14:29.280027 [error] [MainThread]:   Runtime Error in test dbt_utils_expression_is_true_int__price_changes_gain__gain_0 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "gain"
  
  LINE 18: where not(gain gain >= 0)
                          ^
[0m17:14:29.281093 [info ] [MainThread]: 
[0m17:14:29.282435 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\silver_schema.yml\dbt_utils_expression_is_true_int__price_changes_gain__gain_0.sql
[0m17:14:29.283754 [info ] [MainThread]: 
[0m17:14:29.284951 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=4 SKIP=36 NO-OP=0 TOTAL=52
[0m17:14:29.287661 [debug] [MainThread]: Command `-c build` failed at 17:14:29.287165 after 13.03 seconds
[0m17:14:29.288952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C75E1C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C8E899F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C8E88C30>]}
[0m17:14:29.289863 [debug] [MainThread]: Flushing usage events
[0m17:14:30.666016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:43.506208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B678618050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B678E242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67946BED0>]}


============================== 17:18:43.521568 | 7c403f86-6ba9-46b7-b310-1db54117b702 ==============================
[0m17:18:43.521568 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:18:43.524062 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt build --select +fct__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m17:18:43.947862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c403f86-6ba9-46b7-b310-1db54117b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6787D0180>]}
[0m17:18:44.036652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c403f86-6ba9-46b7-b310-1db54117b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67930B790>]}
[0m17:18:44.040350 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:18:44.402988 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:18:44.744744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:18:44.746282 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\silver_schema.yml
[0m17:18:45.585959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c403f86-6ba9-46b7-b310-1db54117b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67AD75E50>]}
[0m17:18:45.741436 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:18:45.744511 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:18:45.859919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c403f86-6ba9-46b7-b310-1db54117b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67AF798B0>]}
[0m17:18:45.861479 [info ] [MainThread]: Found 6 models, 47 data tests, 2 sources, 853 macros
[0m17:18:45.877435 [info ] [MainThread]: 
[0m17:18:45.878751 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:18:45.879911 [info ] [MainThread]: 
[0m17:18:45.881445 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:18:45.893979 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:18:46.057517 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:18:46.058037 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:18:46.058463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:47.811845 [debug] [ThreadPool]: SQL status: OK in 1.753 seconds
[0m17:18:47.817861 [debug] [ThreadPool]: On list_finance: Close
[0m17:18:47.821320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:18:47.823573 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:18:47.849426 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:18:47.851303 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:18:47.852632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:47.858644 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:18:47.864253 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:18:47.865691 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:18:47.869793 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:18:47.871129 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:18:47.872431 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:18:47.936845 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m17:18:47.940717 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:18:47.943076 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:18:47.944388 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:18:47.995971 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m17:18:47.997452 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:18:48.003782 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:18:48.025241 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:18:48.026561 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:18:48.027697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:48.031572 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:18:48.032786 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:18:48.034025 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:18:48.110027 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m17:18:48.112528 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:18:48.114305 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:18:48.114862 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:18:48.118274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c403f86-6ba9-46b7-b310-1db54117b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67B0C99B0>]}
[0m17:18:48.118997 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:48.119485 [debug] [MainThread]: On master: BEGIN
[0m17:18:48.119923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:48.121427 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:18:48.121901 [debug] [MainThread]: On master: COMMIT
[0m17:18:48.122354 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:48.122793 [debug] [MainThread]: On master: COMMIT
[0m17:18:48.123631 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:18:48.124110 [debug] [MainThread]: On master: Close
[0m17:18:48.130710 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m17:18:48.131580 [info ] [Thread-1 (]: 1 of 52 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m17:18:48.132914 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m17:18:48.133543 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m17:18:48.145640 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m17:18:48.147067 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m17:18:48.210131 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m17:18:48.212270 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:18:48.213444 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m17:18:48.214297 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:18:48.217012 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:18:48.218144 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:18:48.218995 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:18:48.276738 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m17:18:48.291435 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:18:48.292458 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m17:18:48.342495 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m17:18:48.350975 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:18:48.352344 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m17:18:48.408451 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m17:18:48.463020 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:18:48.464587 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:18:48.465952 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:18:48.578963 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m17:18:48.609657 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:18:48.610824 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m17:18:48.713441 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m17:18:48.717158 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m17:18:48.720692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c403f86-6ba9-46b7-b310-1db54117b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67B50F380>]}
[0m17:18:48.721804 [info ] [Thread-1 (]: 1 of 52 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.59s]
[0m17:18:48.723341 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m17:18:48.724609 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m17:18:48.725605 [info ] [Thread-2 (]: 2 of 52 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m17:18:48.726836 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m17:18:48.727674 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m17:18:48.733290 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m17:18:48.735124 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m17:18:48.743563 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m17:18:48.746477 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:18:48.747410 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m17:18:48.748216 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:18:48.750679 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:18:48.751815 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:18:48.753375 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:18:48.866085 [debug] [Thread-2 (]: SQL status: OK in 0.112 seconds
[0m17:18:48.873158 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:18:48.874159 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m17:18:48.946369 [debug] [Thread-2 (]: SQL status: OK in 0.071 seconds
[0m17:18:48.954155 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:18:48.955129 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m17:18:49.028213 [debug] [Thread-2 (]: SQL status: OK in 0.072 seconds
[0m17:18:49.032291 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:18:49.033513 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:18:49.034634 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:18:49.217359 [debug] [Thread-2 (]: SQL status: OK in 0.181 seconds
[0m17:18:49.227540 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:18:49.229232 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m17:18:49.356835 [debug] [Thread-2 (]: SQL status: OK in 0.126 seconds
[0m17:18:49.361480 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m17:18:49.363289 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c403f86-6ba9-46b7-b310-1db54117b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67B0F2BD0>]}
[0m17:18:49.365264 [info ] [Thread-2 (]: 2 of 52 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.64s]
[0m17:18:49.368027 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m17:18:49.371096 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:18:49.372592 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:18:49.374056 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:18:49.376975 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:18:49.375661 [info ] [Thread-3 (]: 3 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m17:18:49.378608 [info ] [Thread-4 (]: 4 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m17:18:49.381173 [info ] [Thread-2 (]: 6 of 52 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .... [RUN]
[0m17:18:49.384791 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:18:49.386842 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:18:49.382576 [info ] [Thread-1 (]: 5 of 52 START test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9  [RUN]
[0m17:18:49.389086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m17:18:49.390704 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:18:49.392360 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:18:49.394052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de)
[0m17:18:49.395653 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:18:49.410115 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:18:49.425816 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:18:49.427456 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:18:49.440650 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:18:49.459267 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:18:49.463362 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:18:49.466159 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:18:49.488322 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:18:49.584915 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:18:49.590854 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:18:49.597135 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:18:49.599203 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:18:49.610407 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:18:49.613649 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:18:49.615595 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:18:49.617350 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: BEGIN
[0m17:18:49.619205 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:18:49.621133 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:18:49.623064 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m17:18:49.625144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.626908 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m17:18:49.628732 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m17:18:49.630532 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:18:49.633087 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:18:49.634893 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.637330 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:18:49.640932 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:18:49.642933 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:18:49.644989 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:18:49.646780 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m17:18:49.648521 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(delta) - (gain + loss)) > 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:18:49.650459 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m17:18:49.652574 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m17:18:49.654427 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:18:49.656936 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:18:49.658487 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:18:49.669719 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(delta) - (gain + loss)) > 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:18:49.672332 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m17:18:49.674093 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:18:49.676803 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: ROLLBACK
[0m17:18:49.702484 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de'
[0m17:18:49.704098 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: Close
[0m17:18:49.719578 [debug] [Thread-1 (]: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near ")"
  
  LINE 24:     ) dbt_internal_test
               ^
[0m17:18:49.721515 [error] [Thread-1 (]: 5 of 52 ERROR dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9  [[31mERROR[0m in 0.33s]
[0m17:18:49.724579 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:18:49.726236 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:18:49.728350 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de' to be skipped because of status 'error'.  Reason: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near ")"
  
  LINE 24:     ) dbt_internal_test
               ^.
[0m17:18:49.729995 [info ] [Thread-1 (]: 7 of 52 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .... [RUN]
[0m17:18:49.733129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m17:18:49.734639 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:18:49.750074 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:18:49.752021 [debug] [Thread-2 (]: SQL status: OK in 0.081 seconds
[0m17:18:49.754034 [debug] [Thread-3 (]: SQL status: OK in 0.097 seconds
[0m17:18:49.756394 [debug] [Thread-4 (]: SQL status: OK in 0.080 seconds
[0m17:18:49.768873 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m17:18:49.775678 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m17:18:49.781632 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m17:18:49.783848 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m17:18:49.785446 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:18:49.787878 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:18:49.789786 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m17:18:49.791896 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:18:49.802578 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:18:49.804327 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m17:18:49.806379 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m17:18:49.808752 [info ] [Thread-2 (]: 6 of 52 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 .......... [[32mPASS[0m in 0.42s]
[0m17:18:49.812487 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:18:49.814097 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:18:49.816174 [info ] [Thread-3 (]: 3 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.43s]
[0m17:18:49.824425 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:18:49.819205 [info ] [Thread-4 (]: 4 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.43s]
[0m17:18:49.826688 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:18:49.828390 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:18:49.820798 [info ] [Thread-2 (]: 8 of 52 START test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14  [RUN]
[0m17:18:49.831839 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:18:49.835367 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m17:18:49.833811 [info ] [Thread-3 (]: 9 of 52 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m17:18:49.837609 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182)
[0m17:18:49.839553 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:18:49.841423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.843431 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m17:18:49.845645 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:18:49.847378 [info ] [Thread-4 (]: 10 of 52 START test not_null_int__price_changes_close .......................... [RUN]
[0m17:18:49.850267 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:18:49.866057 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:18:49.868619 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m17:18:49.867755 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m17:18:49.886424 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:18:49.888671 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:18:49.890416 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:18:49.918363 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:18:49.919993 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:18:49.921686 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:18:49.928545 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:18:49.933019 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:18:49.953479 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:18:49.956060 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:18:49.965345 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:18:49.967414 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:18:49.969108 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: BEGIN
[0m17:18:49.970589 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.972868 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:18:49.974479 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m17:18:49.975946 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:49.978357 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:18:49.980026 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:18:49.981568 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:18:49.983274 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m17:18:49.984913 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m17:18:49.986676 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:18:49.988324 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:49.990003 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:18:50.001596 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:18:50.003910 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:18:50.005720 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:18:50.007325 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m17:18:50.009438 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: ROLLBACK
[0m17:18:50.011653 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:18:50.013739 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:18:50.030870 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182'
[0m17:18:50.032536 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: Close
[0m17:18:50.048039 [debug] [Thread-2 (]: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "period_check"
  
  LINE 18: where not(period_check period_check between 1 and 14)
                                  ^
[0m17:18:50.049944 [error] [Thread-2 (]: 8 of 52 ERROR dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14  [[31mERROR[0m in 0.21s]
[0m17:18:50.052878 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:18:50.054496 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:18:50.056611 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182' to be skipped because of status 'error'.  Reason: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "period_check"
  
  LINE 18: where not(period_check period_check between 1 and 14)
                                  ^.
[0m17:18:50.058202 [info ] [Thread-2 (]: 11 of 52 START test not_null_int__price_changes_gain ........................... [RUN]
[0m17:18:50.060616 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m17:18:50.062303 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:18:50.076846 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:18:50.080253 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:18:50.088469 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:18:50.091836 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:18:50.094072 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m17:18:50.096658 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:50.100750 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:18:50.102210 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:18:50.103685 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:18:50.114206 [debug] [Thread-1 (]: SQL status: OK in 0.179 seconds
[0m17:18:50.120122 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m17:18:50.122087 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m17:18:50.123211 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m17:18:50.125685 [info ] [Thread-1 (]: 7 of 52 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 .......... [[32mPASS[0m in 0.39s]
[0m17:18:50.128498 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:18:50.129747 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:18:50.130911 [debug] [Thread-3 (]: SQL status: OK in 0.122 seconds
[0m17:18:50.132059 [info ] [Thread-1 (]: 12 of 52 START test not_null_int__price_changes_loaded_at ...................... [RUN]
[0m17:18:50.133965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m17:18:50.135112 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:18:50.145569 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:18:50.149911 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m17:18:50.151613 [debug] [Thread-4 (]: SQL status: OK in 0.134 seconds
[0m17:18:50.153471 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m17:18:50.155063 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m17:18:50.156628 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:18:50.161274 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m17:18:50.169292 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:18:50.171249 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m17:18:50.162284 [info ] [Thread-3 (]: 9 of 52 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.32s]
[0m17:18:50.173441 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m17:18:50.175851 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:18:50.177044 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m17:18:50.178521 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:18:50.182322 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m17:18:50.183828 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:18:50.185324 [info ] [Thread-3 (]: 13 of 52 START test not_null_int__price_changes_loss ........................... [RUN]
[0m17:18:50.189116 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m17:18:50.190387 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m17:18:50.187636 [info ] [Thread-4 (]: 10 of 52 PASS not_null_int__price_changes_close ................................ [[32mPASS[0m in 0.32s]
[0m17:18:50.192052 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m17:18:50.193304 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m17:18:50.194507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:50.196258 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:18:50.197412 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:18:50.199423 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:18:50.201230 [info ] [Thread-2 (]: 11 of 52 PASS not_null_int__price_changes_gain ................................. [[32mPASS[0m in 0.14s]
[0m17:18:50.204548 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:18:50.213586 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:18:50.216655 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:18:50.214816 [info ] [Thread-4 (]: 14 of 52 START test not_null_int__price_changes_rn ............................. [RUN]
[0m17:18:50.218475 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:18:50.220417 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:18:50.221923 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m17:18:50.223244 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:18:50.225922 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:18:50.227369 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:18:50.224559 [info ] [Thread-2 (]: 15 of 52 START test not_null_int__price_changes_ticker ......................... [RUN]
[0m17:18:50.236281 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:18:50.247026 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:18:50.248240 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m17:18:50.250212 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:18:50.261013 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:18:50.263214 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:18:50.264851 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:18:50.266074 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m17:18:50.272732 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:18:50.274183 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:50.276012 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:18:50.283090 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:18:50.284603 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:18:50.285753 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m17:18:50.286842 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:50.288369 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m17:18:50.289509 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:18:50.290638 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:18:50.292454 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:18:50.293719 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:18:50.294831 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:18:50.296027 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m17:18:50.297284 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:18:50.298495 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:50.302274 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:18:50.303921 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:18:50.305305 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:18:50.315423 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m17:18:50.321315 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m17:18:50.322990 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m17:18:50.324005 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m17:18:50.326348 [info ] [Thread-1 (]: 12 of 52 PASS not_null_int__price_changes_loaded_at ............................ [[32mPASS[0m in 0.19s]
[0m17:18:50.328500 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:18:50.329670 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:18:50.330779 [info ] [Thread-1 (]: 16 of 52 START test not_null_int__price_changes_trade_date ..................... [RUN]
[0m17:18:50.332287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m17:18:50.333399 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:18:50.344236 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:18:50.346948 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:18:50.352843 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:18:50.355256 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:18:50.356419 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m17:18:50.357401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:50.360349 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:18:50.361357 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:18:50.362363 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:18:50.382031 [debug] [Thread-3 (]: SQL status: OK in 0.090 seconds
[0m17:18:50.383326 [debug] [Thread-4 (]: SQL status: OK in 0.084 seconds
[0m17:18:50.384601 [debug] [Thread-2 (]: SQL status: OK in 0.078 seconds
[0m17:18:50.389120 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m17:18:50.392703 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m17:18:50.396904 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m17:18:50.398696 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m17:18:50.400552 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m17:18:50.402169 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m17:18:50.403461 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m17:18:50.404682 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m17:18:50.406190 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m17:18:50.407850 [info ] [Thread-3 (]: 13 of 52 PASS not_null_int__price_changes_loss ................................. [[32mPASS[0m in 0.22s]
[0m17:18:50.409992 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:18:50.410917 [info ] [Thread-4 (]: 14 of 52 PASS not_null_int__price_changes_rn ................................... [[32mPASS[0m in 0.19s]
[0m17:18:50.415670 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:18:50.413341 [info ] [Thread-2 (]: 15 of 52 PASS not_null_int__price_changes_ticker ............................... [[32mPASS[0m in 0.16s]
[0m17:18:50.418077 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:18:50.426963 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m17:18:50.433010 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m17:18:50.434820 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m17:18:50.435852 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m17:18:50.438259 [info ] [Thread-1 (]: 16 of 52 PASS not_null_int__price_changes_trade_date ........................... [[32mPASS[0m in 0.11s]
[0m17:18:50.440356 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:18:50.442154 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m17:18:50.443583 [info ] [Thread-3 (]: 17 of 52 SKIP relation analytics_dev.int__rsi_sma .............................. [[33mSKIP[0m]
[0m17:18:50.445935 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m17:18:50.447766 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_sma' to be skipped because of status 'skipped'. 
[0m17:18:50.451057 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:18:50.453589 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:18:50.454896 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:18:50.457252 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14.52086331c6
[0m17:18:50.456200 [info ] [Thread-3 (]: 21 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ...... [[33mSKIP[0m]
[0m17:18:50.458988 [info ] [Thread-4 (]: 18 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_gain___0 .......... [[33mSKIP[0m]
[0m17:18:50.460824 [info ] [Thread-2 (]: 19 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_loss___0 .......... [[33mSKIP[0m]
[0m17:18:50.463724 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:18:50.465103 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:18:50.462072 [info ] [Thread-1 (]: 20 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14  [[33mSKIP[0m]
[0m17:18:50.466689 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:18:50.468286 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:18:50.469440 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9' to be skipped because of status 'skipped'. 
[0m17:18:50.470740 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:18:50.472390 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14.52086331c6
[0m17:18:50.474646 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:18:50.477485 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6' to be skipped because of status 'skipped'. 
[0m17:18:50.476226 [info ] [Thread-3 (]: 22 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ...... [[33mSKIP[0m]
[0m17:18:50.480446 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:18:50.479215 [info ] [Thread-4 (]: 23 of 52 SKIP test dbt_utils_not_null_where_int__rsi_sma_sma_gain .............. [[33mSKIP[0m]
[0m17:18:50.483268 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62' to be skipped because of status 'skipped'. 
[0m17:18:50.482106 [info ] [Thread-2 (]: 24 of 52 SKIP test dbt_utils_not_null_where_int__rsi_sma_sma_loss .............. [[33mSKIP[0m]
[0m17:18:50.484986 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:18:50.487554 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:18:50.486377 [info ] [Thread-1 (]: 25 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [[33mSKIP[0m]
[0m17:18:50.489130 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14.52086331c6' to be skipped because of status 'skipped'. 
[0m17:18:50.490427 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:18:50.491701 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:18:50.493352 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:18:50.494932 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:18:50.496339 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21' to be skipped because of status 'skipped'. 
[0m17:18:50.497730 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:18:50.498982 [info ] [Thread-3 (]: 26 of 52 SKIP test not_null_int__rsi_sma_close ................................. [[33mSKIP[0m]
[0m17:18:50.502030 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:18:50.503446 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e' to be skipped because of status 'skipped'. 
[0m17:18:50.500148 [info ] [Thread-4 (]: 27 of 52 SKIP test not_null_int__rsi_sma_gain .................................. [[33mSKIP[0m]
[0m17:18:50.506435 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:18:50.505238 [info ] [Thread-2 (]: 28 of 52 SKIP test not_null_int__rsi_sma_loaded_at ............................. [[33mSKIP[0m]
[0m17:18:50.509266 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d' to be skipped because of status 'skipped'. 
[0m17:18:50.508093 [info ] [Thread-1 (]: 29 of 52 SKIP test not_null_int__rsi_sma_loss .................................. [[33mSKIP[0m]
[0m17:18:50.510832 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:18:50.512201 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:18:50.513481 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:18:50.514735 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08' to be skipped because of status 'skipped'. 
[0m17:18:50.516016 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:18:50.517648 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:18:50.520433 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:18:50.519166 [info ] [Thread-3 (]: 30 of 52 SKIP test not_null_int__rsi_sma_rn .................................... [[33mSKIP[0m]
[0m17:18:50.522237 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b' to be skipped because of status 'skipped'. 
[0m17:18:50.526470 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:18:50.523886 [info ] [Thread-4 (]: 31 of 52 SKIP test not_null_int__rsi_sma_ticker ................................ [[33mSKIP[0m]
[0m17:18:50.528100 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953' to be skipped because of status 'skipped'. 
[0m17:18:50.525068 [info ] [Thread-2 (]: 32 of 52 SKIP test not_null_int__rsi_sma_trade_date ............................ [[33mSKIP[0m]
[0m17:18:50.530149 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:18:50.531612 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0' to be skipped because of status 'skipped'. 
[0m17:18:50.532904 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:18:50.534784 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065' to be skipped because of status 'skipped'. 
[0m17:18:50.536172 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139' to be skipped because of status 'skipped'. 
[0m17:18:50.537261 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d' to be skipped because of status 'skipped'. 
[0m17:18:50.538339 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0' to be skipped because of status 'skipped'. 
[0m17:18:50.539977 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m17:18:50.541197 [info ] [Thread-1 (]: 33 of 52 SKIP relation analytics_dev.int__rsi_wilder ........................... [[33mSKIP[0m]
[0m17:18:50.543675 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m17:18:50.545552 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_wilder' to be skipped because of status 'skipped'. 
[0m17:18:50.548043 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:18:50.549443 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:18:50.550679 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:18:50.553080 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:18:50.551894 [info ] [Thread-1 (]: 37 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [[33mSKIP[0m]
[0m17:18:50.554807 [info ] [Thread-3 (]: 34 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ....... [[33mSKIP[0m]
[0m17:18:50.559123 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:18:50.556447 [info ] [Thread-2 (]: 36 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [[33mSKIP[0m]
[0m17:18:50.560807 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:18:50.557908 [info ] [Thread-4 (]: 35 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ....... [[33mSKIP[0m]
[0m17:18:50.562475 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:18:50.563558 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d' to be skipped because of status 'skipped'. 
[0m17:18:50.564755 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:18:50.566012 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:18:50.567733 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:18:50.570705 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90' to be skipped because of status 'skipped'. 
[0m17:18:50.569311 [info ] [Thread-1 (]: 38 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[33mSKIP[0m]
[0m17:18:50.572559 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:18:50.575210 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:18:50.573889 [info ] [Thread-3 (]: 39 of 52 SKIP test not_null_int__rsi_wilder_gain ............................... [[33mSKIP[0m]
[0m17:18:50.577270 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7' to be skipped because of status 'skipped'. 
[0m17:18:50.578652 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:18:50.580004 [info ] [Thread-2 (]: 40 of 52 SKIP test not_null_int__rsi_wilder_loss ............................... [[33mSKIP[0m]
[0m17:18:50.582857 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:18:50.584212 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703' to be skipped because of status 'skipped'. 
[0m17:18:50.581199 [info ] [Thread-4 (]: 41 of 52 SKIP test not_null_int__rsi_wilder_rn ................................. [[33mSKIP[0m]
[0m17:18:50.585876 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:18:50.587137 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:18:50.588393 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:18:50.589615 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95' to be skipped because of status 'skipped'. 
[0m17:18:50.590892 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:18:50.593572 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:18:50.592292 [info ] [Thread-1 (]: 42 of 52 SKIP test not_null_int__rsi_wilder_ticker ............................. [[33mSKIP[0m]
[0m17:18:50.596601 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda' to be skipped because of status 'skipped'. 
[0m17:18:50.594929 [info ] [Thread-3 (]: 43 of 52 SKIP test not_null_int__rsi_wilder_trade_date ......................... [[33mSKIP[0m]
[0m17:18:50.598362 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:18:50.600926 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:18:50.599699 [info ] [Thread-2 (]: 44 of 52 SKIP test not_null_int__rsi_wilder_wilder_gain ........................ [[33mSKIP[0m]
[0m17:18:50.602752 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56' to be skipped because of status 'skipped'. 
[0m17:18:50.604103 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:18:50.606586 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:18:50.607930 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:18:50.605382 [info ] [Thread-4 (]: 45 of 52 SKIP test not_null_int__rsi_wilder_wilder_loss ........................ [[33mSKIP[0m]
[0m17:18:50.609476 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d' to be skipped because of status 'skipped'. 
[0m17:18:50.610998 [info ] [Thread-1 (]: 46 of 52 SKIP test wilder_seed_equals_sma ...................................... [[33mSKIP[0m]
[0m17:18:50.612687 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:18:50.614152 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd' to be skipped because of status 'skipped'. 
[0m17:18:50.615605 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:18:50.617062 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c' to be skipped because of status 'skipped'. 
[0m17:18:50.618740 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9' to be skipped because of status 'skipped'. 
[0m17:18:50.619819 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb' to be skipped because of status 'skipped'. 
[0m17:18:50.620876 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.wilder_seed_equals_sma' to be skipped because of status 'skipped'. 
[0m17:18:50.622717 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.fct__rsi
[0m17:18:50.624004 [info ] [Thread-3 (]: 47 of 52 SKIP relation analytics_dev.fct__rsi .................................. [[33mSKIP[0m]
[0m17:18:50.625991 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m17:18:50.627286 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'skipped'. 
[0m17:18:50.629335 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:18:50.630520 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:18:50.631629 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:18:50.632880 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:18:50.634396 [info ] [Thread-4 (]: 49 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[33mSKIP[0m]
[0m17:18:50.635648 [info ] [Thread-2 (]: 48 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[33mSKIP[0m]
[0m17:18:50.640234 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:18:50.642025 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:18:50.637352 [info ] [Thread-1 (]: 50 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............ [[33mSKIP[0m]
[0m17:18:50.644085 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:18:50.645234 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2' to be skipped because of status 'skipped'. 
[0m17:18:50.638700 [info ] [Thread-3 (]: 51 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ......... [[33mSKIP[0m]
[0m17:18:50.647302 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:18:50.649737 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a' to be skipped because of status 'skipped'. 
[0m17:18:50.648645 [info ] [Thread-4 (]: 52 of 52 SKIP test dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker  [[33mSKIP[0m]
[0m17:18:50.651461 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:18:50.652752 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a' to be skipped because of status 'skipped'. 
[0m17:18:50.654028 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:18:50.655371 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0' to be skipped because of status 'skipped'. 
[0m17:18:50.656728 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400' to be skipped because of status 'skipped'. 
[0m17:18:50.660465 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:50.661477 [debug] [MainThread]: On master: BEGIN
[0m17:18:50.662372 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:18:50.665217 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:18:50.666217 [debug] [MainThread]: On master: COMMIT
[0m17:18:50.667121 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:50.667991 [debug] [MainThread]: On master: COMMIT
[0m17:18:50.669740 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:18:50.670690 [debug] [MainThread]: On master: Close
[0m17:18:50.671789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:50.672593 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:18:50.673345 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:18:50.674103 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5' was properly closed.
[0m17:18:50.674856 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a' was properly closed.
[0m17:18:50.675604 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa' was properly closed.
[0m17:18:50.676361 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638' was properly closed.
[0m17:18:50.677377 [info ] [MainThread]: 
[0m17:18:50.678658 [info ] [MainThread]: Finished running 47 data tests, 5 view models in 0 hours 0 minutes and 4.80 seconds (4.80s).
[0m17:18:50.694596 [debug] [MainThread]: Command end result
[0m17:18:50.807247 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:18:50.810798 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:18:50.821656 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:18:50.822212 [info ] [MainThread]: 
[0m17:18:50.823023 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:18:50.823825 [info ] [MainThread]: 
[0m17:18:50.824737 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)[0m
[0m17:18:50.825669 [error] [MainThread]:   Runtime Error in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near ")"
  
  LINE 24:     ) dbt_internal_test
               ^
[0m17:18:50.826533 [info ] [MainThread]: 
[0m17:18:50.827392 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\silver_schema.yml\dbt_utils_expression_is_true_i_42ddde861532075e91a49918f22e3300.sql
[0m17:18:50.828227 [info ] [MainThread]: 
[0m17:18:50.829032 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)[0m
[0m17:18:50.829982 [error] [MainThread]:   Runtime Error in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "period_check"
  
  LINE 18: where not(period_check period_check between 1 and 14)
                                  ^
[0m17:18:50.830887 [info ] [MainThread]: 
[0m17:18:50.831788 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\silver_schema.yml\dbt_utils_expression_is_true_i_02fc6d0de4be0787745a8150f25c1081.sql
[0m17:18:50.832680 [info ] [MainThread]: 
[0m17:18:50.833603 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=2 SKIP=36 NO-OP=0 TOTAL=52
[0m17:18:50.835142 [debug] [MainThread]: Command `-c build` failed at 17:18:50.834928 after 7.72 seconds
[0m17:18:50.835845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67B0F7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67B034190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67B034550>]}
[0m17:18:50.836480 [debug] [MainThread]: Flushing usage events
[0m17:18:51.777236 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:20:08.802366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EEF6D8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EEFEE42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF0527ED0>]}


============================== 17:20:08.817756 | 230c252a-5bec-4e98-b77f-9189ed750040 ==============================
[0m17:20:08.817756 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:20:08.820264 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt build --select +fct__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m17:20:09.316176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '230c252a-5bec-4e98-b77f-9189ed750040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EEF890180>]}
[0m17:20:09.407236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '230c252a-5bec-4e98-b77f-9189ed750040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF03CB790>]}
[0m17:20:09.410694 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:20:09.852146 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:20:10.246851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:20:10.248486 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\silver_schema.yml
[0m17:20:11.150876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '230c252a-5bec-4e98-b77f-9189ed750040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF1D6DD50>]}
[0m17:20:11.367233 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:20:11.372395 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:20:11.510884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '230c252a-5bec-4e98-b77f-9189ed750040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF1FD1C70>]}
[0m17:20:11.512176 [info ] [MainThread]: Found 6 models, 47 data tests, 2 sources, 853 macros
[0m17:20:11.522454 [info ] [MainThread]: 
[0m17:20:11.523488 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:20:11.524441 [info ] [MainThread]: 
[0m17:20:11.525677 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:20:11.536229 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:20:11.729164 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:20:11.729665 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:20:11.730083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:13.255570 [debug] [ThreadPool]: SQL status: OK in 1.525 seconds
[0m17:20:13.260619 [debug] [ThreadPool]: On list_finance: Close
[0m17:20:13.263268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:20:13.265113 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:20:13.281251 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:20:13.282107 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:20:13.282779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:13.285706 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:20:13.288009 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:20:13.288564 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:20:13.290124 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:20:13.290675 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:20:13.291202 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:20:13.345693 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m17:20:13.350133 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:20:13.351699 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:20:13.353303 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:20:13.407666 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m17:20:13.409147 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:20:13.415355 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:20:13.436471 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:20:13.437968 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:20:13.439123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:13.443067 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:20:13.443969 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:20:13.444858 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:20:13.507608 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m17:20:13.511115 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:20:13.513676 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:20:13.514491 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:20:13.518986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '230c252a-5bec-4e98-b77f-9189ed750040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF20B73F0>]}
[0m17:20:13.520194 [debug] [MainThread]: Using duckdb connection "master"
[0m17:20:13.520994 [debug] [MainThread]: On master: BEGIN
[0m17:20:13.521747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:20:13.524501 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:20:13.525374 [debug] [MainThread]: On master: COMMIT
[0m17:20:13.526212 [debug] [MainThread]: Using duckdb connection "master"
[0m17:20:13.527017 [debug] [MainThread]: On master: COMMIT
[0m17:20:13.528651 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:20:13.529493 [debug] [MainThread]: On master: Close
[0m17:20:13.541224 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m17:20:13.543092 [info ] [Thread-1 (]: 1 of 52 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m17:20:13.545575 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m17:20:13.547074 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m17:20:13.574994 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m17:20:13.578933 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m17:20:13.691045 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m17:20:13.693461 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:20:13.694511 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m17:20:13.695323 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:20:13.698018 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:20:13.698840 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:20:13.699752 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:20:13.758723 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m17:20:13.780837 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:20:13.782388 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m17:20:13.840817 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m17:20:13.853651 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:20:13.855119 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m17:20:13.925346 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m17:20:13.969861 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:20:13.971289 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:20:13.972560 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:20:14.124273 [debug] [Thread-1 (]: SQL status: OK in 0.150 seconds
[0m17:20:14.146847 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:20:14.148379 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m17:20:14.267179 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m17:20:14.276220 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m17:20:14.283553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '230c252a-5bec-4e98-b77f-9189ed750040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF25032B0>]}
[0m17:20:14.285895 [info ] [Thread-1 (]: 1 of 52 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.73s]
[0m17:20:14.288944 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m17:20:14.291538 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m17:20:14.293588 [info ] [Thread-2 (]: 2 of 52 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m17:20:14.296286 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m17:20:14.297862 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m17:20:14.307996 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m17:20:14.311566 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m17:20:14.324467 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m17:20:14.327933 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:20:14.329461 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m17:20:14.330891 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:20:14.335247 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:20:14.336910 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:20:14.339155 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:20:14.557082 [debug] [Thread-2 (]: SQL status: OK in 0.216 seconds
[0m17:20:14.568642 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:20:14.570122 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m17:20:14.636121 [debug] [Thread-2 (]: SQL status: OK in 0.064 seconds
[0m17:20:14.656623 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:20:14.658354 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m17:20:14.718277 [debug] [Thread-2 (]: SQL status: OK in 0.058 seconds
[0m17:20:14.723891 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:20:14.725569 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:20:14.727158 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:20:14.845366 [debug] [Thread-2 (]: SQL status: OK in 0.116 seconds
[0m17:20:14.856531 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:20:14.858143 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m17:20:15.050303 [debug] [Thread-2 (]: SQL status: OK in 0.190 seconds
[0m17:20:15.055873 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m17:20:15.061509 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '230c252a-5bec-4e98-b77f-9189ed750040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF20FB650>]}
[0m17:20:15.063913 [info ] [Thread-2 (]: 2 of 52 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.77s]
[0m17:20:15.066888 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m17:20:15.070292 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:20:15.071908 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:20:15.073480 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06
[0m17:20:15.075144 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:20:15.076838 [info ] [Thread-3 (]: 3 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m17:20:15.078589 [info ] [Thread-4 (]: 4 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m17:20:15.084989 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:20:15.080917 [info ] [Thread-1 (]: 5 of 52 START test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [RUN]
[0m17:20:15.087547 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:20:15.089397 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:20:15.082908 [info ] [Thread-2 (]: 6 of 52 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .... [RUN]
[0m17:20:15.091577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06)
[0m17:20:15.093290 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:20:15.109726 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:20:15.111800 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m17:20:15.113837 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06
[0m17:20:15.133867 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:20:15.136356 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:20:15.154161 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06"
[0m17:20:15.172669 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:20:15.175198 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:20:15.177703 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:20:15.278846 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:20:15.309132 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:20:15.312029 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:20:15.313590 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06
[0m17:20:15.319752 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:20:15.329496 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06"
[0m17:20:15.332812 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:20:15.334581 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m17:20:15.336388 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:20:15.338205 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:20:15.340169 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m17:20:15.342989 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:20:15.344846 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:20:15.346924 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m17:20:15.348868 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m17:20:15.351296 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06"
[0m17:20:15.353130 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:20:15.355041 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:20:15.356855 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m17:20:15.358557 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06: BEGIN
[0m17:20:15.361382 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m17:20:15.363394 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:20:15.365201 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m17:20:15.366838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:15.369397 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:20:15.371402 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:20:15.374959 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m17:20:15.378552 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:20:15.380278 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06"
[0m17:20:15.382003 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(abs(delta) - (gain + loss)) > 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:20:15.508213 [debug] [Thread-4 (]: SQL status: OK in 0.130 seconds
[0m17:20:15.510028 [debug] [Thread-3 (]: SQL status: OK in 0.141 seconds
[0m17:20:15.511953 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m17:20:15.513717 [debug] [Thread-2 (]: SQL status: OK in 0.140 seconds
[0m17:20:15.526728 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m17:20:15.532274 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m17:20:15.537690 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06: ROLLBACK
[0m17:20:15.543081 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m17:20:15.546133 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:20:15.548943 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m17:20:15.551494 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06'
[0m17:20:15.553815 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:20:15.555374 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m17:20:15.556986 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m17:20:15.558646 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06: Close
[0m17:20:15.560301 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m17:20:15.563707 [info ] [Thread-4 (]: 4 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.48s]
[0m17:20:15.572613 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:20:15.565724 [info ] [Thread-2 (]: 6 of 52 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 .......... [[32mPASS[0m in 0.45s]
[0m17:20:15.575125 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:20:15.567868 [info ] [Thread-3 (]: 3 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.48s]
[0m17:20:15.579058 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:20:15.569889 [error] [Thread-1 (]: 5 of 52 FAIL 1265 dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[31mFAIL 1265[0m in 0.48s]
[0m17:20:15.586651 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:20:15.590363 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:20:15.594225 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06
[0m17:20:15.581686 [info ] [Thread-4 (]: 7 of 52 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .... [RUN]
[0m17:20:15.596801 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:20:15.601748 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06' to be skipped because of status 'fail'.  Reason: Got 1265 results, configured to fail if != 0.
[0m17:20:15.604045 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m17:20:15.598893 [info ] [Thread-2 (]: 8 of 52 START test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [RUN]
[0m17:20:15.606564 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:20:15.610070 [info ] [Thread-3 (]: 9 of 52 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m17:20:15.613738 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:20:15.615735 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96)
[0m17:20:15.618034 [info ] [Thread-1 (]: 10 of 52 START test not_null_int__price_changes_close .......................... [RUN]
[0m17:20:15.620698 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m17:20:15.645320 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:20:15.647318 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:20:15.649319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m17:20:15.651775 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:20:15.671235 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:20:15.673080 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:20:15.690814 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:20:15.693564 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:20:15.721119 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:20:15.724385 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:20:15.734747 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:20:15.744794 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:20:15.748073 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:20:15.758310 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:20:15.760193 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:20:15.774628 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:20:15.776597 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:20:15.778961 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:20:15.781374 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m17:20:15.783538 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:20:15.785234 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: BEGIN
[0m17:20:15.787136 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:20:15.789058 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m17:20:15.791085 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:20:15.792769 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:20:15.795282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:15.797441 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m17:20:15.799281 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m17:20:15.802282 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:20:15.806400 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:20:15.804104 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:20:15.808461 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:20:15.810163 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m17:20:15.811911 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:20:15.813641 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:20:15.815572 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:20:15.817442 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:20:15.819189 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:20:15.822434 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:20:15.824397 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:20:15.959107 [debug] [Thread-1 (]: SQL status: OK in 0.137 seconds
[0m17:20:15.961107 [debug] [Thread-4 (]: SQL status: OK in 0.140 seconds
[0m17:20:15.963156 [debug] [Thread-2 (]: SQL status: OK in 0.137 seconds
[0m17:20:15.964827 [debug] [Thread-3 (]: SQL status: OK in 0.138 seconds
[0m17:20:15.970640 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m17:20:15.976125 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m17:20:15.981398 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: ROLLBACK
[0m17:20:15.984563 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m17:20:15.987044 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m17:20:15.993056 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m17:20:15.995424 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96'
[0m17:20:15.997119 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m17:20:15.998893 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m17:20:16.001522 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m17:20:16.003296 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: Close
[0m17:20:16.005620 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m17:20:16.008584 [info ] [Thread-4 (]: 7 of 52 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 .......... [[32mPASS[0m in 0.40s]
[0m17:20:16.016126 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:20:16.017940 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:20:16.010748 [info ] [Thread-1 (]: 10 of 52 PASS not_null_int__price_changes_close ................................ [[32mPASS[0m in 0.36s]
[0m17:20:16.025311 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:20:16.026988 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:20:16.012879 [info ] [Thread-2 (]: 8 of 52 PASS dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[32mPASS[0m in 0.40s]
[0m17:20:16.032062 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:20:16.020849 [info ] [Thread-3 (]: 9 of 52 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.40s]
[0m17:20:16.034385 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:20:16.038156 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:20:16.022406 [info ] [Thread-4 (]: 11 of 52 START test not_null_int__price_changes_gain ........................... [RUN]
[0m17:20:16.042207 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:20:16.044243 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m17:20:16.029474 [info ] [Thread-1 (]: 12 of 52 START test not_null_int__price_changes_loaded_at ...................... [RUN]
[0m17:20:16.039951 [info ] [Thread-2 (]: 13 of 52 START test not_null_int__price_changes_loss ........................... [RUN]
[0m17:20:16.049184 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:20:16.047001 [info ] [Thread-3 (]: 14 of 52 START test not_null_int__price_changes_rn ............................. [RUN]
[0m17:20:16.051475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m17:20:16.054244 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m17:20:16.069859 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m17:20:16.073991 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:20:16.075855 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:20:16.077679 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:20:16.079652 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:20:16.123979 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:20:16.108746 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:20:16.141658 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:20:16.144935 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:20:16.154929 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:20:16.157793 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:20:16.159657 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:20:16.162238 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:20:16.171489 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:20:16.181595 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:20:16.183526 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:20:16.192219 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:20:16.195274 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m17:20:16.198097 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:20:16.200737 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:20:16.202468 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m17:20:16.204041 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:20:16.206493 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:20:16.208305 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m17:20:16.210206 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m17:20:16.211971 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:20:16.213620 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:20:16.215422 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:20:16.217177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:16.218909 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:20:16.220697 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:20:16.222569 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m17:20:16.225268 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:20:16.227835 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:20:16.229574 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:20:16.232501 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:20:16.234155 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:20:16.236282 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m17:20:16.237965 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:20:16.239622 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:20:16.451836 [debug] [Thread-4 (]: SQL status: OK in 0.225 seconds
[0m17:20:16.453755 [debug] [Thread-3 (]: SQL status: OK in 0.212 seconds
[0m17:20:16.455499 [debug] [Thread-2 (]: SQL status: OK in 0.224 seconds
[0m17:20:16.457705 [debug] [Thread-1 (]: SQL status: OK in 0.222 seconds
[0m17:20:16.463346 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m17:20:16.468893 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m17:20:16.474196 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m17:20:16.479657 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m17:20:16.482347 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m17:20:16.484857 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m17:20:16.487682 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m17:20:16.490173 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m17:20:16.491803 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m17:20:16.493576 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m17:20:16.495336 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m17:20:16.497097 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m17:20:16.500656 [info ] [Thread-4 (]: 11 of 52 PASS not_null_int__price_changes_gain ................................. [[32mPASS[0m in 0.46s]
[0m17:20:16.509976 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:20:16.502783 [info ] [Thread-2 (]: 13 of 52 PASS not_null_int__price_changes_loss ................................. [[32mPASS[0m in 0.45s]
[0m17:20:16.512504 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:20:16.504907 [info ] [Thread-1 (]: 12 of 52 PASS not_null_int__price_changes_loaded_at ............................ [[32mPASS[0m in 0.45s]
[0m17:20:16.516120 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:20:16.507510 [info ] [Thread-3 (]: 14 of 52 PASS not_null_int__price_changes_rn ................................... [[32mPASS[0m in 0.44s]
[0m17:20:16.521915 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:20:16.524576 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:20:16.518218 [info ] [Thread-4 (]: 15 of 52 START test not_null_int__price_changes_ticker ......................... [RUN]
[0m17:20:16.528299 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:20:16.532985 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m17:20:16.531172 [info ] [Thread-2 (]: 16 of 52 START test not_null_int__price_changes_trade_date ..................... [RUN]
[0m17:20:16.535928 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:20:16.538348 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m17:20:16.556792 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:20:16.558554 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:20:16.575034 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:20:16.577688 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:20:16.588053 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:20:16.591480 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:20:16.603217 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:20:16.605585 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:20:16.607201 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m17:20:16.608732 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:20:16.612256 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:20:16.613976 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m17:20:16.615563 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m17:20:16.617203 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:20:16.618988 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:20:16.621556 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:20:16.624825 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:20:16.626539 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:20:16.628269 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:20:16.690097 [debug] [Thread-4 (]: SQL status: OK in 0.066 seconds
[0m17:20:16.698961 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m17:20:16.701640 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m17:20:16.703177 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m17:20:16.706633 [info ] [Thread-4 (]: 15 of 52 PASS not_null_int__price_changes_ticker ............................... [[32mPASS[0m in 0.17s]
[0m17:20:16.709824 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:20:16.716662 [debug] [Thread-2 (]: SQL status: OK in 0.086 seconds
[0m17:20:16.725946 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m17:20:16.728560 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m17:20:16.730127 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m17:20:16.733813 [info ] [Thread-2 (]: 16 of 52 PASS not_null_int__price_changes_trade_date ........................... [[32mPASS[0m in 0.20s]
[0m17:20:16.737110 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:20:16.739738 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m17:20:16.742200 [info ] [Thread-1 (]: 17 of 52 SKIP relation analytics_dev.int__rsi_sma .............................. [[33mSKIP[0m]
[0m17:20:16.744919 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m17:20:16.746699 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_sma' to be skipped because of status 'skipped'. 
[0m17:20:16.751174 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:20:16.754126 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:20:16.756794 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:20:16.759813 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:20:16.758831 [info ] [Thread-1 (]: 21 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ...... [[33mSKIP[0m]
[0m17:20:16.761994 [info ] [Thread-4 (]: 19 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_loss___0 .......... [[33mSKIP[0m]
[0m17:20:16.768856 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:20:16.764371 [info ] [Thread-2 (]: 20 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[33mSKIP[0m]
[0m17:20:16.771386 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:20:16.774054 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:20:16.776234 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9' to be skipped because of status 'skipped'. 
[0m17:20:16.766968 [info ] [Thread-3 (]: 18 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_gain___0 .......... [[33mSKIP[0m]
[0m17:20:16.778637 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:20:16.780621 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:20:16.782732 [info ] [Thread-1 (]: 22 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ...... [[33mSKIP[0m]
[0m17:20:16.785290 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62' to be skipped because of status 'skipped'. 
[0m17:20:16.787269 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:20:16.789540 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:20:16.793606 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:20:16.795570 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704' to be skipped because of status 'skipped'. 
[0m17:20:16.791795 [info ] [Thread-4 (]: 23 of 52 SKIP test dbt_utils_not_null_where_int__rsi_sma_sma_gain .............. [[33mSKIP[0m]
[0m17:20:16.798474 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:20:16.802208 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:20:16.800419 [info ] [Thread-2 (]: 24 of 52 SKIP test dbt_utils_not_null_where_int__rsi_sma_sma_loss .............. [[33mSKIP[0m]
[0m17:20:16.804630 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6' to be skipped because of status 'skipped'. 
[0m17:20:16.806630 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:20:16.808639 [info ] [Thread-3 (]: 25 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [[33mSKIP[0m]
[0m17:20:16.812651 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:20:16.815153 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21' to be skipped because of status 'skipped'. 
[0m17:20:16.810447 [info ] [Thread-1 (]: 26 of 52 SKIP test not_null_int__rsi_sma_close ................................. [[33mSKIP[0m]
[0m17:20:16.817510 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:20:16.819492 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:20:16.821534 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:20:16.823704 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e' to be skipped because of status 'skipped'. 
[0m17:20:16.826198 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:20:16.830077 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:20:16.828244 [info ] [Thread-4 (]: 27 of 52 SKIP test not_null_int__rsi_sma_gain .................................. [[33mSKIP[0m]
[0m17:20:16.834561 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d' to be skipped because of status 'skipped'. 
[0m17:20:16.832562 [info ] [Thread-2 (]: 28 of 52 SKIP test not_null_int__rsi_sma_loaded_at ............................. [[33mSKIP[0m]
[0m17:20:16.837377 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:20:16.841400 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:20:16.839338 [info ] [Thread-3 (]: 29 of 52 SKIP test not_null_int__rsi_sma_loss .................................. [[33mSKIP[0m]
[0m17:20:16.843747 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08' to be skipped because of status 'skipped'. 
[0m17:20:16.845794 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:20:16.850270 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:20:16.847826 [info ] [Thread-1 (]: 30 of 52 SKIP test not_null_int__rsi_sma_rn .................................... [[33mSKIP[0m]
[0m17:20:16.852778 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:20:16.854676 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b' to be skipped because of status 'skipped'. 
[0m17:20:16.857332 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:20:16.862509 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:20:16.860678 [info ] [Thread-4 (]: 31 of 52 SKIP test not_null_int__rsi_sma_ticker ................................ [[33mSKIP[0m]
[0m17:20:16.865360 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953' to be skipped because of status 'skipped'. 
[0m17:20:16.867337 [info ] [Thread-2 (]: 32 of 52 SKIP test not_null_int__rsi_sma_trade_date ............................ [[33mSKIP[0m]
[0m17:20:16.869938 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:20:16.871943 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0' to be skipped because of status 'skipped'. 
[0m17:20:16.874067 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:20:16.876345 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065' to be skipped because of status 'skipped'. 
[0m17:20:16.878471 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139' to be skipped because of status 'skipped'. 
[0m17:20:16.880180 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d' to be skipped because of status 'skipped'. 
[0m17:20:16.881861 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0' to be skipped because of status 'skipped'. 
[0m17:20:16.884407 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m17:20:16.886183 [info ] [Thread-3 (]: 33 of 52 SKIP relation analytics_dev.int__rsi_wilder ........................... [[33mSKIP[0m]
[0m17:20:16.888651 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m17:20:16.890785 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_wilder' to be skipped because of status 'skipped'. 
[0m17:20:16.894475 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:20:16.896458 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:20:16.898200 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:20:16.900034 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:20:16.901852 [info ] [Thread-3 (]: 37 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [[33mSKIP[0m]
[0m17:20:16.903756 [info ] [Thread-1 (]: 34 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ....... [[33mSKIP[0m]
[0m17:20:16.911437 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:20:16.907001 [info ] [Thread-2 (]: 36 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [[33mSKIP[0m]
[0m17:20:16.913970 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:20:16.916074 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:20:16.909526 [info ] [Thread-4 (]: 35 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ....... [[33mSKIP[0m]
[0m17:20:16.918545 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:20:16.920067 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d' to be skipped because of status 'skipped'. 
[0m17:20:16.922105 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:20:16.926600 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:20:16.924705 [info ] [Thread-3 (]: 38 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[33mSKIP[0m]
[0m17:20:16.929246 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:20:16.931400 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90' to be skipped because of status 'skipped'. 
[0m17:20:16.935877 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:20:16.933760 [info ] [Thread-1 (]: 39 of 52 SKIP test not_null_int__rsi_wilder_gain ............................... [[33mSKIP[0m]
[0m17:20:16.938317 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:20:16.942224 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7' to be skipped because of status 'skipped'. 
[0m17:20:16.940509 [info ] [Thread-2 (]: 40 of 52 SKIP test not_null_int__rsi_wilder_loss ............................... [[33mSKIP[0m]
[0m17:20:16.946555 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:20:16.944740 [info ] [Thread-4 (]: 41 of 52 SKIP test not_null_int__rsi_wilder_rn ................................. [[33mSKIP[0m]
[0m17:20:16.949267 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:20:16.951129 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703' to be skipped because of status 'skipped'. 
[0m17:20:16.953085 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:20:16.955024 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:20:16.957007 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:20:16.960763 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95' to be skipped because of status 'skipped'. 
[0m17:20:16.959084 [info ] [Thread-3 (]: 42 of 52 SKIP test not_null_int__rsi_wilder_ticker ............................. [[33mSKIP[0m]
[0m17:20:16.963187 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:20:16.967281 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:20:16.965520 [info ] [Thread-1 (]: 43 of 52 SKIP test not_null_int__rsi_wilder_trade_date ......................... [[33mSKIP[0m]
[0m17:20:16.969648 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda' to be skipped because of status 'skipped'. 
[0m17:20:16.971678 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:20:16.973659 [info ] [Thread-2 (]: 44 of 52 SKIP test not_null_int__rsi_wilder_wilder_gain ........................ [[33mSKIP[0m]
[0m17:20:16.977770 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:20:16.975497 [info ] [Thread-4 (]: 45 of 52 SKIP test not_null_int__rsi_wilder_wilder_loss ........................ [[33mSKIP[0m]
[0m17:20:16.979807 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56' to be skipped because of status 'skipped'. 
[0m17:20:16.982787 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:20:16.985152 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:20:16.987419 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:20:16.989274 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d' to be skipped because of status 'skipped'. 
[0m17:20:16.991255 [info ] [Thread-3 (]: 46 of 52 SKIP test wilder_seed_equals_sma ...................................... [[33mSKIP[0m]
[0m17:20:16.994339 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd' to be skipped because of status 'skipped'. 
[0m17:20:16.996393 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:20:16.998456 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c' to be skipped because of status 'skipped'. 
[0m17:20:17.000628 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9' to be skipped because of status 'skipped'. 
[0m17:20:17.002316 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb' to be skipped because of status 'skipped'. 
[0m17:20:17.003975 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.wilder_seed_equals_sma' to be skipped because of status 'skipped'. 
[0m17:20:17.006442 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m17:20:17.008516 [info ] [Thread-1 (]: 47 of 52 SKIP relation analytics_dev.fct__rsi .................................. [[33mSKIP[0m]
[0m17:20:17.011105 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m17:20:17.012822 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'skipped'. 
[0m17:20:17.016107 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:20:17.018040 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:20:17.019976 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:20:17.025059 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:20:17.022063 [info ] [Thread-3 (]: 50 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............ [[33mSKIP[0m]
[0m17:20:17.028953 [info ] [Thread-2 (]: 48 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[33mSKIP[0m]
[0m17:20:17.036209 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:20:17.031866 [info ] [Thread-1 (]: 51 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ......... [[33mSKIP[0m]
[0m17:20:17.038672 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:20:17.041524 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:20:17.043175 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a' to be skipped because of status 'skipped'. 
[0m17:20:17.034283 [info ] [Thread-4 (]: 49 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[33mSKIP[0m]
[0m17:20:17.045558 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:20:17.049630 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a' to be skipped because of status 'skipped'. 
[0m17:20:17.047968 [info ] [Thread-3 (]: 52 of 52 SKIP test dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker  [[33mSKIP[0m]
[0m17:20:17.052353 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:20:17.054540 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0' to be skipped because of status 'skipped'. 
[0m17:20:17.056897 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:20:17.059346 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2' to be skipped because of status 'skipped'. 
[0m17:20:17.061444 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400' to be skipped because of status 'skipped'. 
[0m17:20:17.066998 [debug] [MainThread]: Using duckdb connection "master"
[0m17:20:17.068426 [debug] [MainThread]: On master: BEGIN
[0m17:20:17.069688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:20:17.075162 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m17:20:17.077154 [debug] [MainThread]: On master: COMMIT
[0m17:20:17.078509 [debug] [MainThread]: Using duckdb connection "master"
[0m17:20:17.079800 [debug] [MainThread]: On master: COMMIT
[0m17:20:17.082392 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:20:17.083867 [debug] [MainThread]: On master: Close
[0m17:20:17.085524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:17.086733 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:20:17.087910 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:20:17.089105 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f' was properly closed.
[0m17:20:17.090278 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5' was properly closed.
[0m17:20:17.091434 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638' was properly closed.
[0m17:20:17.092579 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a' was properly closed.
[0m17:20:17.094148 [info ] [MainThread]: 
[0m17:20:17.096017 [info ] [MainThread]: Finished running 47 data tests, 5 view models in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m17:20:17.113616 [debug] [MainThread]: Command end result
[0m17:20:17.228763 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:20:17.232577 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:20:17.243747 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:20:17.244313 [info ] [MainThread]: 
[0m17:20:17.245215 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:20:17.245962 [info ] [MainThread]: 
[0m17:20:17.246906 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)[0m
[0m17:20:17.247766 [error] [MainThread]:   Got 1265 results, configured to fail if != 0
[0m17:20:17.248540 [info ] [MainThread]: 
[0m17:20:17.249411 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\silver_schema.yml\dbt_utils_expression_is_true_i_ba38dcc47ac9f7f603717bd1fa0a1017.sql
[0m17:20:17.250266 [info ] [MainThread]: 
[0m17:20:17.251116 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=36 NO-OP=0 TOTAL=52
[0m17:20:17.252688 [debug] [MainThread]: Command `-c build` failed at 17:20:17.252472 after 8.75 seconds
[0m17:20:17.253422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF1FCE8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF3A7A030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF3A7A0D0>]}
[0m17:20:17.254069 [debug] [MainThread]: Flushing usage events
[0m17:20:18.306893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:22:34.566783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADC7A18050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADC82242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADC8863ED0>]}


============================== 17:22:34.581868 | 293edd3d-3cbb-4f5d-aff4-c5973d61da81 ==============================
[0m17:22:34.581868 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:22:34.584326 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'invocation_command': 'dbt build --select +fct__rsi', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:22:35.185150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADC7BD0180>]}
[0m17:22:35.276379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADC870B790>]}
[0m17:22:35.280056 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:22:35.688011 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:22:36.184277 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:22:36.185656 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\silver_schema.yml
[0m17:22:36.977985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA0EE550>]}
[0m17:22:37.172437 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:22:37.175556 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:22:37.293007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA2D65D0>]}
[0m17:22:37.294624 [info ] [MainThread]: Found 6 models, 47 data tests, 2 sources, 853 macros
[0m17:22:37.313376 [info ] [MainThread]: 
[0m17:22:37.315774 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:22:37.318239 [info ] [MainThread]: 
[0m17:22:37.321786 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:22:37.341517 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:22:37.659167 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:22:37.659925 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:22:37.660562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:39.897442 [debug] [ThreadPool]: SQL status: OK in 2.237 seconds
[0m17:22:39.902843 [debug] [ThreadPool]: On list_finance: Close
[0m17:22:39.905594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:22:39.907485 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:22:39.934231 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:22:39.935911 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:22:39.937278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:39.944314 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:22:39.950760 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:22:39.952120 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:22:39.956575 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:22:39.958010 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:22:39.959291 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:22:40.083619 [debug] [ThreadPool]: SQL status: OK in 0.123 seconds
[0m17:22:40.087983 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:22:40.089661 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:22:40.091143 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:22:40.153929 [debug] [ThreadPool]: SQL status: OK in 0.061 seconds
[0m17:22:40.155618 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:22:40.165650 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:22:40.198250 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:22:40.200292 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:22:40.202562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:40.209101 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:22:40.211883 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:22:40.215098 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:22:40.328285 [debug] [ThreadPool]: SQL status: OK in 0.112 seconds
[0m17:22:40.333152 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:22:40.337023 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:22:40.338326 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:22:40.343661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA3D6EB0>]}
[0m17:22:40.345652 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:40.346905 [debug] [MainThread]: On master: BEGIN
[0m17:22:40.347903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:22:40.351831 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:22:40.353036 [debug] [MainThread]: On master: COMMIT
[0m17:22:40.353920 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:40.354705 [debug] [MainThread]: On master: COMMIT
[0m17:22:40.356694 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:22:40.357568 [debug] [MainThread]: On master: Close
[0m17:22:40.368718 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m17:22:40.370279 [info ] [Thread-1 (]: 1 of 52 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m17:22:40.372670 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m17:22:40.373892 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m17:22:40.398594 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m17:22:40.401193 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m17:22:40.504147 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m17:22:40.507135 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:22:40.508424 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m17:22:40.509840 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:22:40.514923 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:22:40.516187 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:22:40.517258 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:22:40.594951 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m17:22:40.614835 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:22:40.615922 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m17:22:40.685704 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m17:22:40.698280 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:22:40.699911 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m17:22:40.772088 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m17:22:40.829290 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:22:40.831369 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:22:40.833924 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:22:40.956482 [debug] [Thread-1 (]: SQL status: OK in 0.121 seconds
[0m17:22:40.988296 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:22:40.990833 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m17:22:41.125343 [debug] [Thread-1 (]: SQL status: OK in 0.133 seconds
[0m17:22:41.135389 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m17:22:41.145238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA87B860>]}
[0m17:22:41.147417 [info ] [Thread-1 (]: 1 of 52 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.77s]
[0m17:22:41.149760 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m17:22:41.152047 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m17:22:41.153737 [info ] [Thread-2 (]: 2 of 52 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m17:22:41.155685 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m17:22:41.156988 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m17:22:41.167336 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m17:22:41.170442 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m17:22:41.183164 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m17:22:41.186988 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:22:41.189140 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m17:22:41.190390 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:22:41.195126 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:22:41.196470 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:22:41.197745 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:22:41.303667 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m17:22:41.313411 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:22:41.314662 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m17:22:41.379397 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m17:22:41.388718 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:22:41.389931 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m17:22:41.456817 [debug] [Thread-2 (]: SQL status: OK in 0.065 seconds
[0m17:22:41.462006 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:22:41.463271 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:22:41.464348 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:22:41.587101 [debug] [Thread-2 (]: SQL status: OK in 0.121 seconds
[0m17:22:41.596224 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:22:41.597596 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m17:22:41.788519 [debug] [Thread-2 (]: SQL status: OK in 0.189 seconds
[0m17:22:41.796402 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m17:22:41.798865 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA387E90>]}
[0m17:22:41.801859 [info ] [Thread-2 (]: 2 of 52 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.64s]
[0m17:22:41.805447 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m17:22:41.810211 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:22:41.813234 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:22:41.815786 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:22:41.820442 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:22:41.818426 [info ] [Thread-3 (]: 3 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m17:22:41.823014 [info ] [Thread-2 (]: 6 of 52 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .... [RUN]
[0m17:22:41.825736 [info ] [Thread-1 (]: 5 of 52 START test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [RUN]
[0m17:22:41.832845 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:22:41.829551 [info ] [Thread-4 (]: 4 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m17:22:41.835979 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m17:22:41.838328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd)
[0m17:22:41.840401 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:22:41.843307 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:22:41.845657 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:22:41.847604 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:22:41.872257 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:22:41.874079 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:22:41.897397 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:22:41.933569 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:22:41.956555 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:22:41.961302 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:22:42.010375 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:22:42.090288 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:22:42.124246 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:22:42.152035 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:22:42.153866 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:22:42.157887 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:22:42.173923 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:22:42.178717 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:22:42.181788 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: BEGIN
[0m17:22:42.184148 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:22:42.186069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:42.189355 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m17:22:42.193844 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:22:42.198142 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:22:42.201165 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:22:42.203558 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m17:22:42.205932 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m17:22:42.207927 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m17:22:42.212172 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:22:42.215388 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:22:42.218047 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:42.220241 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m17:22:42.224345 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(abs(delta) - (gain + loss)) <= 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:22:42.229036 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m17:22:42.231541 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:22:42.234678 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m17:22:42.237222 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:22:42.240204 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m17:22:42.243461 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:22:42.247397 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m17:22:42.251340 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:22:42.351758 [debug] [Thread-3 (]: SQL status: OK in 0.102 seconds
[0m17:22:42.354123 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m17:22:42.356546 [debug] [Thread-2 (]: SQL status: OK in 0.101 seconds
[0m17:22:42.359768 [debug] [Thread-4 (]: SQL status: OK in 0.105 seconds
[0m17:22:42.381501 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m17:22:42.390826 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m17:22:42.401866 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: ROLLBACK
[0m17:22:42.406347 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m17:22:42.410843 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:22:42.415647 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m17:22:42.419826 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd'
[0m17:22:42.423216 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:22:42.425207 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m17:22:42.427934 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m17:22:42.430310 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: Close
[0m17:22:42.432959 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m17:22:42.439983 [info ] [Thread-2 (]: 6 of 52 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 .......... [[32mPASS[0m in 0.60s]
[0m17:22:42.453764 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:22:42.443790 [info ] [Thread-3 (]: 3 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.61s]
[0m17:22:42.457951 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:22:42.447106 [info ] [Thread-1 (]: 5 of 52 PASS dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[32mPASS[0m in 0.61s]
[0m17:22:42.465344 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:22:42.449382 [info ] [Thread-4 (]: 4 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.61s]
[0m17:22:42.474808 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:22:42.468429 [info ] [Thread-2 (]: 7 of 52 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .... [RUN]
[0m17:22:42.480116 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:22:42.484844 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:22:42.487770 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:22:42.491724 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m17:22:42.498195 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:22:42.495499 [info ] [Thread-3 (]: 8 of 52 START test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [RUN]
[0m17:22:42.506953 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:22:42.503672 [info ] [Thread-1 (]: 9 of 52 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m17:22:42.514284 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96)
[0m17:22:42.510812 [info ] [Thread-4 (]: 10 of 52 START test not_null_int__price_changes_close .......................... [RUN]
[0m17:22:42.536693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m17:22:42.546042 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:22:42.555153 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:22:42.560220 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m17:22:42.563805 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:22:42.590801 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:22:42.594942 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:22:42.633377 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:22:42.661072 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:22:42.690157 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:22:42.695564 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:22:42.708895 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:22:42.715573 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:22:42.717410 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:22:42.722626 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:22:42.724176 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:22:42.725275 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:22:42.726261 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:22:42.730987 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:22:42.732191 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: BEGIN
[0m17:22:42.733369 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m17:22:42.734900 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:22:42.736381 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:42.737482 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:42.738539 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m17:22:42.739788 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:22:42.741503 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:22:42.742429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:42.743698 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m17:22:42.744651 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:22:42.745671 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:22:42.747598 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:42.749413 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:22:42.752960 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:22:42.751250 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:22:42.755950 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:22:42.758651 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:22:42.760264 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m17:22:42.763177 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:22:42.766090 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:22:42.769846 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:22:42.897938 [debug] [Thread-3 (]: SQL status: OK in 0.136 seconds
[0m17:22:42.899879 [debug] [Thread-2 (]: SQL status: OK in 0.138 seconds
[0m17:22:42.902604 [debug] [Thread-4 (]: SQL status: OK in 0.131 seconds
[0m17:22:42.904600 [debug] [Thread-1 (]: SQL status: OK in 0.136 seconds
[0m17:22:42.914384 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: ROLLBACK
[0m17:22:42.921147 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m17:22:42.928002 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m17:22:42.932188 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96'
[0m17:22:42.935764 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m17:22:42.942013 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m17:22:42.945022 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m17:22:42.946635 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: Close
[0m17:22:42.948384 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m17:22:42.950974 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m17:22:42.953201 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m17:22:42.956084 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m17:22:42.959468 [info ] [Thread-3 (]: 8 of 52 PASS dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[32mPASS[0m in 0.45s]
[0m17:22:42.966097 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:22:42.961948 [info ] [Thread-4 (]: 10 of 52 PASS not_null_int__price_changes_close ................................ [[32mPASS[0m in 0.40s]
[0m17:22:42.972276 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:22:42.968382 [info ] [Thread-2 (]: 7 of 52 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 .......... [[32mPASS[0m in 0.48s]
[0m17:22:42.977416 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:22:42.970279 [info ] [Thread-1 (]: 9 of 52 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.43s]
[0m17:22:42.979655 [info ] [Thread-3 (]: 11 of 52 START test not_null_int__price_changes_gain ........................... [RUN]
[0m17:22:42.983956 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:22:42.988029 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:22:42.992452 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:22:42.995642 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m17:22:42.997885 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:22:43.003469 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:22:43.000612 [info ] [Thread-4 (]: 12 of 52 START test not_null_int__price_changes_loaded_at ...................... [RUN]
[0m17:22:43.006312 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:22:43.009890 [info ] [Thread-2 (]: 13 of 52 START test not_null_int__price_changes_loss ........................... [RUN]
[0m17:22:43.015886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m17:22:43.013069 [info ] [Thread-1 (]: 14 of 52 START test not_null_int__price_changes_rn ............................. [RUN]
[0m17:22:43.044797 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m17:22:43.047195 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:22:43.049473 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:22:43.053114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m17:22:43.056331 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:22:43.082684 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:22:43.084889 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:22:43.092854 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:22:43.110574 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:22:43.129964 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:22:43.144392 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:22:43.148612 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:22:43.171948 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:22:43.184959 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:22:43.188065 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:22:43.189967 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m17:22:43.193579 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:22:43.196984 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:22:43.199026 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:43.226469 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:22:43.232229 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:22:43.235993 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m17:22:43.240328 [debug] [Thread-3 (]: SQL status: OK in 0.041 seconds
[0m17:22:43.244649 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:22:43.248254 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:43.251124 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:22:43.253600 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m17:22:43.256747 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:22:43.260039 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:22:43.263592 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:43.265858 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m17:22:43.268367 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m17:22:43.272593 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:22:43.275676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:43.278244 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m17:22:43.281506 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:22:43.285436 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:22:43.288951 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:22:43.292716 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m17:22:43.295629 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:22:43.298938 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:22:43.352704 [debug] [Thread-3 (]: SQL status: OK in 0.082 seconds
[0m17:22:43.363516 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m17:22:43.366495 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m17:22:43.368326 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m17:22:43.373118 [info ] [Thread-3 (]: 11 of 52 PASS not_null_int__price_changes_gain ................................. [[32mPASS[0m in 0.38s]
[0m17:22:43.378696 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:22:43.380973 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:22:43.383383 [info ] [Thread-3 (]: 15 of 52 START test not_null_int__price_changes_ticker ......................... [RUN]
[0m17:22:43.387415 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m17:22:43.390059 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:22:43.421734 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:22:43.424043 [debug] [Thread-2 (]: SQL status: OK in 0.136 seconds
[0m17:22:43.427029 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m17:22:43.429632 [debug] [Thread-4 (]: SQL status: OK in 0.138 seconds
[0m17:22:43.434309 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:22:43.451166 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m17:22:43.456187 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:22:43.465591 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m17:22:43.475581 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m17:22:43.479905 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m17:22:43.484173 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m17:22:43.489268 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m17:22:43.492642 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m17:22:43.496228 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:22:43.499013 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m17:22:43.501281 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m17:22:43.503920 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m17:22:43.507161 [info ] [Thread-2 (]: 13 of 52 PASS not_null_int__price_changes_loss ................................. [[32mPASS[0m in 0.46s]
[0m17:22:43.511291 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:43.519896 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:22:43.514476 [info ] [Thread-1 (]: 14 of 52 PASS not_null_int__price_changes_rn ................................... [[32mPASS[0m in 0.46s]
[0m17:22:43.517128 [info ] [Thread-4 (]: 12 of 52 PASS not_null_int__price_changes_loaded_at ............................ [[32mPASS[0m in 0.50s]
[0m17:22:43.525846 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:22:43.530373 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:22:43.532738 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m17:22:43.537839 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:22:43.542011 [info ] [Thread-2 (]: 16 of 52 START test not_null_int__price_changes_trade_date ..................... [RUN]
[0m17:22:43.546304 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:22:43.549621 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m17:22:43.552539 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:22:43.555113 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:22:43.580024 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:22:43.584758 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:22:43.596517 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:22:43.601261 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:22:43.604474 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m17:22:43.606241 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:43.613864 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:22:43.615871 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:22:43.617663 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:22:43.632345 [debug] [Thread-3 (]: SQL status: OK in 0.074 seconds
[0m17:22:43.647494 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m17:22:43.650365 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m17:22:43.652309 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m17:22:43.657556 [info ] [Thread-3 (]: 15 of 52 PASS not_null_int__price_changes_ticker ............................... [[32mPASS[0m in 0.27s]
[0m17:22:43.661843 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:22:43.702840 [debug] [Thread-2 (]: SQL status: OK in 0.083 seconds
[0m17:22:43.715319 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m17:22:43.718306 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m17:22:43.720111 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m17:22:43.724932 [info ] [Thread-2 (]: 16 of 52 PASS not_null_int__price_changes_trade_date ........................... [[32mPASS[0m in 0.18s]
[0m17:22:43.729028 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:22:43.732793 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m17:22:43.735529 [info ] [Thread-1 (]: 17 of 52 START sql view model analytics_dev.int__rsi_sma ....................... [RUN]
[0m17:22:43.738977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638, now model.portfolio_project_2.int__rsi_sma)
[0m17:22:43.742934 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m17:22:43.768540 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m17:22:43.774501 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m17:22:43.796136 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m17:22:43.801440 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:22:43.804594 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m17:22:43.808232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:43.816478 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:22:43.818912 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:22:43.821206 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    sma_gain::decimal as sma_gain,
    sma_loss::decimal as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m17:22:44.022775 [debug] [Thread-1 (]: SQL status: OK in 0.199 seconds
[0m17:22:44.034779 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:22:44.036360 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m17:22:44.102155 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m17:22:44.118373 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:22:44.120286 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m17:22:44.186072 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m17:22:44.192603 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m17:22:44.195669 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:22:44.197578 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m17:22:44.326836 [debug] [Thread-1 (]: SQL status: OK in 0.126 seconds
[0m17:22:44.340643 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:22:44.343944 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m17:22:44.481103 [debug] [Thread-1 (]: SQL status: OK in 0.135 seconds
[0m17:22:44.487260 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m17:22:44.489450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA467CD0>]}
[0m17:22:44.493490 [info ] [Thread-1 (]: 17 of 52 OK created sql view model analytics_dev.int__rsi_sma .................. [[32mOK[0m in 0.75s]
[0m17:22:44.497484 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m17:22:44.501420 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:22:44.503389 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:22:44.505315 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:22:44.510502 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:22:44.507552 [info ] [Thread-4 (]: 18 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_gain___0 ......... [RUN]
[0m17:22:44.514671 [info ] [Thread-2 (]: 20 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [RUN]
[0m17:22:44.518304 [info ] [Thread-3 (]: 19 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_loss___0 ......... [RUN]
[0m17:22:44.524187 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6)
[0m17:22:44.520989 [info ] [Thread-1 (]: 21 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ..... [RUN]
[0m17:22:44.528229 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704)
[0m17:22:44.530278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62)
[0m17:22:44.533458 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:22:44.536753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_sma, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9)
[0m17:22:44.539399 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:22:44.542365 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:22:44.569620 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:22:44.572345 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:22:44.610295 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:22:44.623556 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:22:44.647854 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:22:44.651639 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:22:44.669785 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:22:44.671918 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:22:44.684698 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:22:44.688199 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:22:44.700800 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:22:44.702854 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:22:44.716486 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:22:44.719167 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:22:44.721314 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: BEGIN
[0m17:22:44.723994 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:44.728389 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:22:44.730423 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: BEGIN
[0m17:22:44.733106 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:22:44.735573 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:44.738044 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m17:22:44.739879 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:22:44.742052 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: BEGIN
[0m17:22:44.745457 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:22:44.748245 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: BEGIN
[0m17:22:44.750491 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:44.752460 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m17:22:44.754474 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:22:44.756196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:44.759460 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:22:44.762866 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m17:22:44.766243 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:22:44.769493 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:22:44.772550 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m17:22:44.774796 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:22:44.778086 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:22:44.782014 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:22:44.933628 [debug] [Thread-2 (]: SQL status: OK in 0.153 seconds
[0m17:22:44.937728 [debug] [Thread-1 (]: SQL status: OK in 0.153 seconds
[0m17:22:44.936203 [debug] [Thread-3 (]: SQL status: OK in 0.164 seconds
[0m17:22:44.941418 [debug] [Thread-4 (]: SQL status: OK in 0.179 seconds
[0m17:22:44.952487 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: ROLLBACK
[0m17:22:44.961460 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: ROLLBACK
[0m17:22:44.968063 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: ROLLBACK
[0m17:22:44.974467 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: ROLLBACK
[0m17:22:44.978622 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704'
[0m17:22:44.981413 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9'
[0m17:22:44.984395 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62'
[0m17:22:44.987478 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6'
[0m17:22:44.989259 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: Close
[0m17:22:44.991393 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: Close
[0m17:22:44.994573 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: Close
[0m17:22:44.996471 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: Close
[0m17:22:45.001395 [info ] [Thread-1 (]: 21 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ........... [[32mPASS[0m in 0.46s]
[0m17:22:45.012426 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:22:45.004206 [info ] [Thread-2 (]: 20 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[32mPASS[0m in 0.48s]
[0m17:22:45.015775 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:22:45.006162 [info ] [Thread-4 (]: 18 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_gain___0 ............... [[32mPASS[0m in 0.48s]
[0m17:22:45.008390 [info ] [Thread-3 (]: 19 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_loss___0 ............... [[32mPASS[0m in 0.48s]
[0m17:22:45.021490 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:22:45.029085 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:22:45.025736 [info ] [Thread-1 (]: 22 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ..... [RUN]
[0m17:22:45.033453 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:22:45.035501 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:22:45.037959 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:22:45.041593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21)
[0m17:22:45.045497 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:22:45.049377 [info ] [Thread-2 (]: 23 of 52 START test dbt_utils_not_null_where_int__rsi_sma_sma_gain ............. [RUN]
[0m17:22:45.055810 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:22:45.052438 [info ] [Thread-4 (]: 24 of 52 START test dbt_utils_not_null_where_int__rsi_sma_sma_loss ............. [RUN]
[0m17:22:45.062423 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704, now test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e)
[0m17:22:45.060338 [info ] [Thread-3 (]: 25 of 52 START test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [RUN]
[0m17:22:45.091022 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:22:45.094355 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6, now test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d)
[0m17:22:45.096903 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:22:45.099887 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08)
[0m17:22:45.103892 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:22:45.126544 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:22:45.147678 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:22:45.186738 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:22:45.195752 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:22:45.200811 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:22:45.203034 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:22:45.204880 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: BEGIN
[0m17:22:45.219017 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:22:45.223347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:45.231453 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:22:45.233932 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: BEGIN
[0m17:22:45.236692 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:22:45.238793 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:45.242126 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:22:45.246232 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:22:45.249970 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m17:22:45.251866 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:22:45.253557 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_sma"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:22:45.360444 [debug] [Thread-2 (]: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:22:45.362139 [debug] [Thread-4 (]: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:22:45.363911 [error] [Thread-2 (]: 23 of 52 ERROR dbt_utils_not_null_where_int__rsi_sma_sma_gain .................. [[31mERROR[0m in 0.30s]
[0m17:22:45.367470 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m17:22:45.368370 [debug] [Thread-3 (]: SQL status: OK in 0.113 seconds
[0m17:22:45.369892 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:22:45.365792 [error] [Thread-4 (]: 24 of 52 ERROR dbt_utils_not_null_where_int__rsi_sma_sma_loss .................. [[31mERROR[0m in 0.27s]
[0m17:22:45.371766 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:22:45.373195 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:22:45.375500 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:22:45.381087 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: ROLLBACK
[0m17:22:45.387196 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: ROLLBACK
[0m17:22:45.389915 [info ] [Thread-2 (]: 26 of 52 START test not_null_int__rsi_sma_close ................................ [RUN]
[0m17:22:45.394830 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:22:45.397908 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:22:45.400644 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08'
[0m17:22:45.403215 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21'
[0m17:22:45.404918 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e, now test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b)
[0m17:22:45.406673 [info ] [Thread-4 (]: 27 of 52 START test not_null_int__rsi_sma_gain ................................. [RUN]
[0m17:22:45.410392 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: Close
[0m17:22:45.415396 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: Close
[0m17:22:45.418672 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:22:45.422133 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d, now test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953)
[0m17:22:45.451824 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:22:45.429786 [info ] [Thread-3 (]: 25 of 52 PASS dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn .. [[32mPASS[0m in 0.33s]
[0m17:22:45.453901 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:22:45.446955 [info ] [Thread-1 (]: 22 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ........... [[32mPASS[0m in 0.40s]
[0m17:22:45.458686 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:22:45.482890 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:22:45.485281 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:22:45.487131 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:22:45.489290 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:22:45.492911 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:22:45.505631 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:22:45.510492 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:22:45.507953 [info ] [Thread-3 (]: 28 of 52 START test not_null_int__rsi_sma_loaded_at ............................ [RUN]
[0m17:22:45.528847 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08, now test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0)
[0m17:22:45.531866 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:22:45.513220 [info ] [Thread-1 (]: 29 of 52 START test not_null_int__rsi_sma_loss ................................. [RUN]
[0m17:22:45.534840 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:22:45.536564 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:22:45.539386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21, now test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065)
[0m17:22:45.560460 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:22:45.562398 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: BEGIN
[0m17:22:45.564457 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:22:45.567290 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:22:45.570174 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:45.589122 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:22:45.590976 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: BEGIN
[0m17:22:45.594963 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:22:45.596917 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:45.602017 [debug] [Thread-2 (]: SQL status: OK in 0.032 seconds
[0m17:22:45.609683 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:22:45.612782 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:22:45.615018 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:22:45.618307 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__rsi_sma"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:22:45.621115 [debug] [Thread-4 (]: SQL status: OK in 0.024 seconds
[0m17:22:45.633542 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:22:45.636352 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:22:45.639032 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:22:45.642273 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_sma"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:22:45.645030 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: BEGIN
[0m17:22:45.647903 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:45.651400 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:22:45.653605 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: BEGIN
[0m17:22:45.655259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:45.657677 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:22:45.660922 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:22:45.663778 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__rsi_sma"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:22:45.666266 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:22:45.668690 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:22:45.671735 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_sma"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:22:45.816757 [debug] [Thread-2 (]: SQL status: OK in 0.181 seconds
[0m17:22:45.821806 [debug] [Thread-3 (]: SQL status: OK in 0.154 seconds
[0m17:22:45.823878 [debug] [Thread-4 (]: SQL status: OK in 0.177 seconds
[0m17:22:45.826119 [debug] [Thread-1 (]: SQL status: OK in 0.152 seconds
[0m17:22:45.831852 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: ROLLBACK
[0m17:22:45.839764 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: ROLLBACK
[0m17:22:45.845878 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: ROLLBACK
[0m17:22:45.851517 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: ROLLBACK
[0m17:22:45.853887 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b'
[0m17:22:45.856353 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0'
[0m17:22:45.859094 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953'
[0m17:22:45.861569 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065'
[0m17:22:45.863115 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: Close
[0m17:22:45.864739 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: Close
[0m17:22:45.866337 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: Close
[0m17:22:45.869045 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: Close
[0m17:22:45.873555 [info ] [Thread-3 (]: 28 of 52 PASS not_null_int__rsi_sma_loaded_at .................................. [[32mPASS[0m in 0.34s]
[0m17:22:45.876306 [info ] [Thread-2 (]: 26 of 52 PASS not_null_int__rsi_sma_close ...................................... [[32mPASS[0m in 0.47s]
[0m17:22:45.885700 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:22:45.887394 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:22:45.878170 [info ] [Thread-4 (]: 27 of 52 PASS not_null_int__rsi_sma_gain ....................................... [[32mPASS[0m in 0.46s]
[0m17:22:45.890493 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:22:45.894531 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:22:45.879983 [info ] [Thread-1 (]: 29 of 52 PASS not_null_int__rsi_sma_loss ....................................... [[32mPASS[0m in 0.34s]
[0m17:22:45.897919 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:22:45.899624 [info ] [Thread-3 (]: 30 of 52 START test not_null_int__rsi_sma_rn ................................... [RUN]
[0m17:22:45.906138 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:22:45.901295 [info ] [Thread-2 (]: 31 of 52 START test not_null_int__rsi_sma_ticker ............................... [RUN]
[0m17:22:45.909032 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:22:45.911589 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0, now test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139)
[0m17:22:45.915402 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b, now test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d)
[0m17:22:45.920883 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:22:45.918842 [info ] [Thread-4 (]: 32 of 52 START test not_null_int__rsi_sma_trade_date ........................... [RUN]
[0m17:22:45.923329 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:22:45.944102 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:22:45.946099 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953, now test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0)
[0m17:22:45.965741 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:22:45.968150 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:22:45.987196 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:22:45.990102 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:22:46.002393 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:22:46.004836 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:22:46.007933 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:22:46.017995 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:22:46.028899 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:22:46.031879 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:22:46.034889 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: BEGIN
[0m17:22:46.037451 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:46.042130 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:22:46.044891 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: BEGIN
[0m17:22:46.047666 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:22:46.050764 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:22:46.052333 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:46.053953 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:22:46.055562 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: BEGIN
[0m17:22:46.059116 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_sma"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:22:46.060998 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:46.063551 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m17:22:46.066160 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:22:46.068761 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_sma"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:22:46.071344 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m17:22:46.073891 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:22:46.076459 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_sma"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:22:46.354062 [debug] [Thread-4 (]: SQL status: OK in 0.283 seconds
[0m17:22:46.355791 [debug] [Thread-3 (]: SQL status: OK in 0.293 seconds
[0m17:22:46.358297 [debug] [Thread-2 (]: SQL status: OK in 0.280 seconds
[0m17:22:46.365549 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: ROLLBACK
[0m17:22:46.370870 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: ROLLBACK
[0m17:22:46.376871 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: ROLLBACK
[0m17:22:46.379733 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0'
[0m17:22:46.382020 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139'
[0m17:22:46.384435 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d'
[0m17:22:46.385953 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: Close
[0m17:22:46.387540 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: Close
[0m17:22:46.389114 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: Close
[0m17:22:46.395499 [info ] [Thread-4 (]: 32 of 52 PASS not_null_int__rsi_sma_trade_date ................................. [[32mPASS[0m in 0.45s]
[0m17:22:46.402278 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:22:46.394068 [info ] [Thread-3 (]: 30 of 52 PASS not_null_int__rsi_sma_rn ......................................... [[32mPASS[0m in 0.48s]
[0m17:22:46.407177 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:22:46.398980 [info ] [Thread-2 (]: 31 of 52 PASS not_null_int__rsi_sma_ticker ..................................... [[32mPASS[0m in 0.48s]
[0m17:22:46.412140 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:22:46.414917 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m17:22:46.418652 [info ] [Thread-1 (]: 33 of 52 SKIP relation analytics_dev.int__rsi_wilder ........................... [[33mSKIP[0m]
[0m17:22:46.422287 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m17:22:46.424474 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_wilder' to be skipped because of status 'skipped'. 
[0m17:22:46.427954 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:22:46.429655 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:22:46.431330 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:22:46.436551 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:22:46.434133 [info ] [Thread-4 (]: 34 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ....... [[33mSKIP[0m]
[0m17:22:46.440084 [info ] [Thread-2 (]: 36 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [[33mSKIP[0m]
[0m17:22:46.443546 [info ] [Thread-3 (]: 35 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ....... [[33mSKIP[0m]
[0m17:22:46.450225 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:22:46.452398 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:22:46.447590 [info ] [Thread-1 (]: 37 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [[33mSKIP[0m]
[0m17:22:46.455760 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:22:46.458459 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:22:46.460180 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90' to be skipped because of status 'skipped'. 
[0m17:22:46.461929 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:22:46.464401 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:22:46.467305 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:22:46.473438 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7' to be skipped because of status 'skipped'. 
[0m17:22:46.470908 [info ] [Thread-4 (]: 38 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[33mSKIP[0m]
[0m17:22:46.478323 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:22:46.476525 [info ] [Thread-2 (]: 39 of 52 SKIP test not_null_int__rsi_wilder_gain ............................... [[33mSKIP[0m]
[0m17:22:46.484652 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703' to be skipped because of status 'skipped'. 
[0m17:22:46.481951 [info ] [Thread-3 (]: 40 of 52 SKIP test not_null_int__rsi_wilder_loss ............................... [[33mSKIP[0m]
[0m17:22:46.487572 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:22:46.494300 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:22:46.491838 [info ] [Thread-1 (]: 41 of 52 SKIP test not_null_int__rsi_wilder_rn ................................. [[33mSKIP[0m]
[0m17:22:46.496669 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d' to be skipped because of status 'skipped'. 
[0m17:22:46.498414 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:22:46.500169 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:22:46.501922 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:22:46.503619 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:22:46.505220 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95' to be skipped because of status 'skipped'. 
[0m17:22:46.508005 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:22:46.510906 [info ] [Thread-4 (]: 42 of 52 SKIP test not_null_int__rsi_wilder_ticker ............................. [[33mSKIP[0m]
[0m17:22:46.517030 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:22:46.520182 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda' to be skipped because of status 'skipped'. 
[0m17:22:46.513329 [info ] [Thread-2 (]: 43 of 52 SKIP test not_null_int__rsi_wilder_trade_date ......................... [[33mSKIP[0m]
[0m17:22:46.526047 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:22:46.523003 [info ] [Thread-3 (]: 44 of 52 SKIP test not_null_int__rsi_wilder_wilder_gain ........................ [[33mSKIP[0m]
[0m17:22:46.530727 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56' to be skipped because of status 'skipped'. 
[0m17:22:46.528952 [info ] [Thread-1 (]: 45 of 52 SKIP test not_null_int__rsi_wilder_wilder_loss ........................ [[33mSKIP[0m]
[0m17:22:46.533958 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:22:46.536930 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:22:46.540006 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:22:46.543467 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d' to be skipped because of status 'skipped'. 
[0m17:22:46.545558 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:22:46.547662 [info ] [Thread-4 (]: 46 of 52 SKIP test wilder_seed_equals_sma ...................................... [[33mSKIP[0m]
[0m17:22:46.550513 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd' to be skipped because of status 'skipped'. 
[0m17:22:46.553023 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:22:46.554720 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c' to be skipped because of status 'skipped'. 
[0m17:22:46.556912 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9' to be skipped because of status 'skipped'. 
[0m17:22:46.560058 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb' to be skipped because of status 'skipped'. 
[0m17:22:46.563034 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.wilder_seed_equals_sma' to be skipped because of status 'skipped'. 
[0m17:22:46.567099 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.fct__rsi
[0m17:22:46.569291 [info ] [Thread-2 (]: 47 of 52 SKIP relation analytics_dev.fct__rsi .................................. [[33mSKIP[0m]
[0m17:22:46.572092 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m17:22:46.574315 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'skipped'. 
[0m17:22:46.577991 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:22:46.579707 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:22:46.581386 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:22:46.587300 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:22:46.584670 [info ] [Thread-1 (]: 49 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[33mSKIP[0m]
[0m17:22:46.591163 [info ] [Thread-2 (]: 51 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ......... [[33mSKIP[0m]
[0m17:22:46.593554 [info ] [Thread-4 (]: 50 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............ [[33mSKIP[0m]
[0m17:22:46.599301 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:22:46.601505 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:22:46.597014 [info ] [Thread-3 (]: 48 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[33mSKIP[0m]
[0m17:22:46.605161 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:22:46.608953 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:22:46.611787 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2' to be skipped because of status 'skipped'. 
[0m17:22:46.615632 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:22:46.621461 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0' to be skipped because of status 'skipped'. 
[0m17:22:46.619490 [info ] [Thread-1 (]: 52 of 52 SKIP test dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker  [[33mSKIP[0m]
[0m17:22:46.624441 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a' to be skipped because of status 'skipped'. 
[0m17:22:46.626351 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:22:46.627970 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a' to be skipped because of status 'skipped'. 
[0m17:22:46.629848 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400' to be skipped because of status 'skipped'. 
[0m17:22:46.636362 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:46.639036 [debug] [MainThread]: On master: BEGIN
[0m17:22:46.641705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:22:46.647749 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m17:22:46.649163 [debug] [MainThread]: On master: COMMIT
[0m17:22:46.650445 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:46.651710 [debug] [MainThread]: On master: COMMIT
[0m17:22:46.654275 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:22:46.655739 [debug] [MainThread]: On master: Close
[0m17:22:46.658615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:46.661033 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:22:46.663336 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:22:46.665375 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065' was properly closed.
[0m17:22:46.667553 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d' was properly closed.
[0m17:22:46.669532 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139' was properly closed.
[0m17:22:46.670914 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0' was properly closed.
[0m17:22:46.673367 [info ] [MainThread]: 
[0m17:22:46.676528 [info ] [MainThread]: Finished running 47 data tests, 5 view models in 0 hours 0 minutes and 9.35 seconds (9.35s).
[0m17:22:46.730097 [debug] [MainThread]: Command end result
[0m17:22:46.929597 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:22:46.935363 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:22:46.952545 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:22:46.953542 [info ] [MainThread]: 
[0m17:22:46.954746 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:22:46.955916 [info ] [MainThread]: 
[0m17:22:46.957220 [error] [MainThread]: [31mFailure in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)[0m
[0m17:22:46.958712 [error] [MainThread]:   Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:22:46.959896 [info ] [MainThread]: 
[0m17:22:46.961557 [error] [MainThread]: [31mFailure in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)[0m
[0m17:22:46.963168 [error] [MainThread]:   Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:22:46.964499 [info ] [MainThread]: 
[0m17:22:46.965867 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=2 SKIP=20 NO-OP=0 TOTAL=52
[0m17:22:46.969317 [debug] [MainThread]: Command `-c build` failed at 17:22:46.968833 after 12.86 seconds
[0m17:22:46.970581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCBD7AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA2CFEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA75D4D0>]}
[0m17:22:46.971897 [debug] [MainThread]: Flushing usage events
[0m17:22:49.231696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:46.775402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF94488050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF94C942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF952D7ED0>]}


============================== 17:24:46.790556 | d9fdd445-5682-40f9-8355-50f7cf338260 ==============================
[0m17:24:46.790556 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:24:46.793039 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt clean', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m17:24:47.036063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9fdd445-5682-40f9-8355-50f7cf338260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF94640180>]}
[0m17:24:47.263737 [debug] [MainThread]: Command `-c clean` succeeded at 17:24:47.263447 after 0.91 seconds
[0m17:24:47.264520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF9517A360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF9517A030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF95173C50>]}
[0m17:24:47.265096 [debug] [MainThread]: Flushing usage events
[0m17:24:48.142191 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:54.972057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024418708050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024418F142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024419557ED0>]}


============================== 17:24:54.987218 | 41a45fda-0d3a-4b1d-8f4d-0d11082f7555 ==============================
[0m17:24:54.987218 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:24:54.989741 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --select +fct__rsi', 'log_format': 'default', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:24:55.482028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41a45fda-0d3a-4b1d-8f4d-0d11082f7555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244188C0180>]}
[0m17:24:55.571797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41a45fda-0d3a-4b1d-8f4d-0d11082f7555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244193FB790>]}
[0m17:24:55.575066 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:24:55.957545 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m17:24:55.959541 [debug] [MainThread]: Command `-c build` failed at 17:24:55.959241 after 1.24 seconds
[0m17:24:55.960460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002441A695450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002441A695350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002441A870F50>]}
[0m17:24:55.961366 [debug] [MainThread]: Flushing usage events
[0m17:24:57.143924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:07.608270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD094C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD11542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD1797ED0>]}


============================== 17:25:07.617263 | b555cadd-97ae-46da-bf7c-185b2cfe92e2 ==============================
[0m17:25:07.617263 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:25:07.618649 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:25:07.842594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b555cadd-97ae-46da-bf7c-185b2cfe92e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD0B00180>]}
[0m17:25:07.892707 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-u5v29abe'
[0m17:25:07.893514 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:25:08.712765 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:25:08.716035 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:25:09.496834 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:25:09.504479 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m17:25:10.297601 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m17:25:10.311372 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m17:25:11.097911 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m17:25:11.112415 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:25:12.658617 [info ] [MainThread]: Installed from version 1.3.2
[0m17:25:12.659383 [info ] [MainThread]: Up to date!
[0m17:25:12.660155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b555cadd-97ae-46da-bf7c-185b2cfe92e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD163AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD163A580>]}
[0m17:25:12.660714 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m17:25:18.075856 [info ] [MainThread]: Installed from version 0.10.9
[0m17:25:18.076660 [info ] [MainThread]: Up to date!
[0m17:25:18.077483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b555cadd-97ae-46da-bf7c-185b2cfe92e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD2A7D050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD162B6B0>]}
[0m17:25:18.078096 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m17:25:19.295687 [info ] [MainThread]: Installed from version 0.16.1
[0m17:25:19.297646 [info ] [MainThread]: Up to date!
[0m17:25:19.299639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b555cadd-97ae-46da-bf7c-185b2cfe92e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD2A59A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD2A59470>]}
[0m17:25:19.309892 [debug] [MainThread]: Command `-c deps` succeeded at 17:25:19.309345 after 11.92 seconds
[0m17:25:19.311428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD158B1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD29FE810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD2A71E90>]}
[0m17:25:19.313071 [debug] [MainThread]: Flushing usage events
[0m17:25:20.186509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:27.932337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAE858050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAF0642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAF6A3ED0>]}


============================== 17:25:27.949260 | 7927384c-0aae-4b7a-b62a-a9d9308712bb ==============================
[0m17:25:27.949260 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:25:27.952129 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt build --select +fct__rsi', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m17:25:28.600335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAEA10180>]}
[0m17:25:28.689695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAF54B790>]}
[0m17:25:28.693274 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:25:29.174158 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:25:29.177549 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:25:29.178747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAF7C1250>]}
[0m17:25:32.777311 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:25:32.778477 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m17:25:32.779230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB0CB4320>]}
[0m17:25:33.351552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB0FFBE70>]}
[0m17:25:33.547020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:25:33.552169 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:25:33.665849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB136F6C0>]}
[0m17:25:33.667436 [info ] [MainThread]: Found 6 models, 47 data tests, 2 sources, 853 macros
[0m17:25:33.683901 [info ] [MainThread]: 
[0m17:25:33.686089 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:25:33.687729 [info ] [MainThread]: 
[0m17:25:33.690052 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:25:33.708055 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:25:33.948910 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:25:33.949867 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:25:33.950667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:35.889347 [debug] [ThreadPool]: SQL status: OK in 1.938 seconds
[0m17:25:35.894291 [debug] [ThreadPool]: On list_finance: Close
[0m17:25:35.896803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:25:35.898812 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:25:35.921821 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:35.923160 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:25:35.924350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:35.929645 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:25:35.934544 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:35.935747 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:25:35.939485 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:25:35.940720 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:35.941882 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:25:35.995281 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m17:25:35.998852 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:25:36.000226 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:36.001429 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:25:36.050582 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m17:25:36.052149 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:25:36.058427 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:25:36.079407 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:25:36.080727 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:25:36.081852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:36.085856 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:25:36.087068 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:25:36.088300 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:25:36.168451 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m17:25:36.171074 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:25:36.172835 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:25:36.173355 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:25:36.177113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB1246510>]}
[0m17:25:36.178146 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:36.178868 [debug] [MainThread]: On master: BEGIN
[0m17:25:36.179599 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:36.182187 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:25:36.183003 [debug] [MainThread]: On master: COMMIT
[0m17:25:36.183779 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:36.184544 [debug] [MainThread]: On master: COMMIT
[0m17:25:36.186036 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:25:36.186836 [debug] [MainThread]: On master: Close
[0m17:25:36.196928 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m17:25:36.198241 [info ] [Thread-1 (]: 1 of 52 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m17:25:36.199903 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m17:25:36.200863 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m17:25:36.220216 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m17:25:36.226322 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m17:25:36.326735 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m17:25:36.330298 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:25:36.331300 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m17:25:36.332180 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:25:36.335297 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:25:36.336239 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:25:36.337184 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:25:36.398740 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m17:25:36.422203 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:25:36.423801 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m17:25:36.488624 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m17:25:36.501709 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:25:36.503500 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m17:25:36.567865 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m17:25:36.617256 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:25:36.618784 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:25:36.620118 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:25:36.733666 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m17:25:36.755391 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:25:36.757097 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m17:25:36.866268 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m17:25:36.875006 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m17:25:36.882041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB1386F10>]}
[0m17:25:36.884544 [info ] [Thread-1 (]: 1 of 52 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.68s]
[0m17:25:36.887529 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m17:25:36.890041 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m17:25:36.892149 [info ] [Thread-2 (]: 2 of 52 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m17:25:36.894828 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m17:25:36.896442 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m17:25:36.914918 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m17:25:36.920721 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m17:25:36.933044 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m17:25:36.938403 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:25:36.940155 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m17:25:36.941591 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:25:36.945909 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:25:36.947435 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:25:36.949104 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:25:37.065155 [debug] [Thread-2 (]: SQL status: OK in 0.112 seconds
[0m17:25:37.078533 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:25:37.081931 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m17:25:37.156730 [debug] [Thread-2 (]: SQL status: OK in 0.071 seconds
[0m17:25:37.179713 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:25:37.180875 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m17:25:37.232792 [debug] [Thread-2 (]: SQL status: OK in 0.051 seconds
[0m17:25:37.236436 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:25:37.237627 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:25:37.238701 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:25:37.363707 [debug] [Thread-2 (]: SQL status: OK in 0.124 seconds
[0m17:25:37.367485 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:25:37.368078 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m17:25:37.560258 [debug] [Thread-2 (]: SQL status: OK in 0.191 seconds
[0m17:25:37.565638 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m17:25:37.567708 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB2C6A170>]}
[0m17:25:37.569881 [info ] [Thread-2 (]: 2 of 52 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.67s]
[0m17:25:37.572784 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m17:25:37.577475 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:25:37.579061 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:25:37.580886 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:25:37.584226 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:25:37.582720 [info ] [Thread-3 (]: 3 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m17:25:37.586576 [info ] [Thread-1 (]: 5 of 52 START test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [RUN]
[0m17:25:37.592548 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:25:37.588167 [info ] [Thread-2 (]: 6 of 52 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .... [RUN]
[0m17:25:37.594796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd)
[0m17:25:37.596542 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:25:37.590092 [info ] [Thread-4 (]: 4 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m17:25:37.598958 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m17:25:37.600636 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:25:37.617320 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:25:37.619385 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:25:37.621191 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:25:37.647630 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:25:37.649840 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:25:37.666799 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:25:37.685181 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:25:37.687815 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:25:37.689983 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:25:37.774399 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:25:37.786128 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:25:37.803920 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:25:37.813327 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:25:37.815295 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:25:37.824029 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:25:37.828434 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:25:37.830091 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m17:25:37.831845 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:25:37.834828 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:25:37.836628 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: BEGIN
[0m17:25:37.838156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:37.840476 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:25:37.842199 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:25:37.843979 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:25:37.845795 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m17:25:37.849728 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:25:37.848524 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:25:37.852128 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m17:25:37.853892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:37.855748 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m17:25:37.857632 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:25:37.859408 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:25:37.862777 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(abs(delta) - (gain + loss)) <= 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:25:37.866150 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m17:25:37.867792 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:25:37.869385 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m17:25:37.871115 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:25:37.872994 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:25:37.875714 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m17:25:37.969606 [debug] [Thread-3 (]: SQL status: OK in 0.108 seconds
[0m17:25:37.971323 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m17:25:37.975234 [debug] [Thread-4 (]: SQL status: OK in 0.098 seconds
[0m17:25:37.977012 [debug] [Thread-2 (]: SQL status: OK in 0.102 seconds
[0m17:25:37.989447 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m17:25:37.995031 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: ROLLBACK
[0m17:25:38.000638 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m17:25:38.004380 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:25:38.006761 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd'
[0m17:25:38.012635 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m17:25:38.015027 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:25:38.016708 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m17:25:38.018441 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: Close
[0m17:25:38.021039 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m17:25:38.022889 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m17:25:38.025233 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m17:25:38.027733 [info ] [Thread-1 (]: 5 of 52 PASS dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[32mPASS[0m in 0.43s]
[0m17:25:38.033247 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:25:38.039129 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:25:38.030149 [info ] [Thread-3 (]: 3 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.44s]
[0m17:25:38.035491 [info ] [Thread-4 (]: 4 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.42s]
[0m17:25:38.037522 [info ] [Thread-2 (]: 6 of 52 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 .......... [[32mPASS[0m in 0.44s]
[0m17:25:38.052171 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:25:38.049483 [info ] [Thread-1 (]: 7 of 52 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .... [RUN]
[0m17:25:38.055368 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:25:38.058039 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:25:38.059898 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:25:38.062078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m17:25:38.064064 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:25:38.066423 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:25:38.070674 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:25:38.068521 [info ] [Thread-3 (]: 8 of 52 START test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [RUN]
[0m17:25:38.073230 [info ] [Thread-4 (]: 9 of 52 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m17:25:38.075810 [info ] [Thread-2 (]: 10 of 52 START test not_null_int__price_changes_close .......................... [RUN]
[0m17:25:38.099155 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96)
[0m17:25:38.107403 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m17:25:38.109393 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:25:38.111165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m17:25:38.113062 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:25:38.114915 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:25:38.117209 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:25:38.151052 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:25:38.158416 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:25:38.165115 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:25:38.189284 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:25:38.199421 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:25:38.202963 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:25:38.214230 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:25:38.223717 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:25:38.213462 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:25:38.226598 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:25:38.229511 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:25:38.241391 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:25:38.248239 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:25:38.249960 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m17:25:38.251829 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:25:38.253676 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m17:25:38.256080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:38.257932 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: BEGIN
[0m17:25:38.259942 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:38.262646 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:38.264616 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:25:38.267670 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m17:25:38.269344 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:25:38.271021 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:38.272861 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m17:25:38.274504 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:25:38.276330 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m17:25:38.279365 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:25:38.281404 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:25:38.283290 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:25:38.285039 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m17:25:38.286787 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:25:38.289473 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:25:38.291351 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:25:38.294671 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:25:38.508740 [debug] [Thread-2 (]: SQL status: OK in 0.212 seconds
[0m17:25:38.510518 [debug] [Thread-3 (]: SQL status: OK in 0.217 seconds
[0m17:25:38.512431 [debug] [Thread-4 (]: SQL status: OK in 0.219 seconds
[0m17:25:38.514213 [debug] [Thread-1 (]: SQL status: OK in 0.225 seconds
[0m17:25:38.523885 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: ROLLBACK
[0m17:25:38.525405 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m17:25:38.528944 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96'
[0m17:25:38.531025 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: Close
[0m17:25:38.533263 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m17:25:38.540118 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m17:25:38.544594 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m17:25:38.546246 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m17:25:38.548497 [info ] [Thread-3 (]: 8 of 52 PASS dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[32mPASS[0m in 0.45s]
[0m17:25:38.552141 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m17:25:38.554542 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m17:25:38.557328 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:25:38.561177 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m17:25:38.559650 [info ] [Thread-2 (]: 10 of 52 PASS not_null_int__price_changes_close ................................ [[32mPASS[0m in 0.45s]
[0m17:25:38.563517 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m17:25:38.565895 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:25:38.569154 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:25:38.572009 [info ] [Thread-1 (]: 7 of 52 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 .......... [[32mPASS[0m in 0.51s]
[0m17:25:38.574607 [info ] [Thread-3 (]: 11 of 52 START test not_null_int__price_changes_gain ........................... [RUN]
[0m17:25:38.579209 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:25:38.583598 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:25:38.576821 [info ] [Thread-4 (]: 9 of 52 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.47s]
[0m17:25:38.586023 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m17:25:38.590328 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:25:38.587920 [info ] [Thread-2 (]: 12 of 52 START test not_null_int__price_changes_loaded_at ...................... [RUN]
[0m17:25:38.594049 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:25:38.595903 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:25:38.601514 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m17:25:38.598004 [info ] [Thread-1 (]: 13 of 52 START test not_null_int__price_changes_loss ........................... [RUN]
[0m17:25:38.604952 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:25:38.623582 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:25:38.625290 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:25:38.627219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m17:25:38.629132 [info ] [Thread-4 (]: 14 of 52 START test not_null_int__price_changes_rn ............................. [RUN]
[0m17:25:38.646829 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:25:38.649184 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:25:38.651309 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m17:25:38.653095 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:25:38.672418 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:25:38.674194 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:25:38.685294 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:25:38.687581 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:25:38.702999 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:25:38.726716 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:25:38.728611 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:25:38.739058 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:25:38.741445 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:25:38.743125 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m17:25:38.744680 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:38.747493 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:25:38.757651 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:25:38.759478 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:25:38.761156 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m17:25:38.763256 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:25:38.765045 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m17:25:38.766832 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:25:38.768712 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m17:25:38.771051 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:25:38.772611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:38.774312 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:25:38.776100 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:38.777867 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m17:25:38.781695 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:38.783947 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:25:38.785602 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m17:25:38.787218 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:25:38.789071 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:25:38.790801 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m17:25:38.792522 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:25:38.794773 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:25:38.796513 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:25:38.799678 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:25:38.854594 [debug] [Thread-3 (]: SQL status: OK in 0.074 seconds
[0m17:25:38.863696 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m17:25:38.866178 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m17:25:38.867704 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m17:25:38.871181 [info ] [Thread-3 (]: 11 of 52 PASS not_null_int__price_changes_gain ................................. [[32mPASS[0m in 0.29s]
[0m17:25:38.874462 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:25:38.876145 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:25:38.878023 [info ] [Thread-3 (]: 15 of 52 START test not_null_int__price_changes_ticker ......................... [RUN]
[0m17:25:38.880340 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m17:25:38.882106 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:25:38.899971 [debug] [Thread-2 (]: SQL status: OK in 0.101 seconds
[0m17:25:38.902205 [debug] [Thread-4 (]: SQL status: OK in 0.101 seconds
[0m17:25:38.905091 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m17:25:38.907665 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:25:38.913083 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:25:38.923160 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:25:38.930133 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m17:25:38.936042 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m17:25:38.941678 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m17:25:38.944806 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m17:25:38.947676 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m17:25:38.949841 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m17:25:38.952216 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m17:25:38.954185 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:25:38.956178 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m17:25:38.958123 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m17:25:38.962209 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m17:25:38.960649 [info ] [Thread-4 (]: 14 of 52 PASS not_null_int__price_changes_rn ................................... [[32mPASS[0m in 0.31s]
[0m17:25:38.965215 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:38.968029 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:25:38.970211 [info ] [Thread-1 (]: 13 of 52 PASS not_null_int__price_changes_loss ................................. [[32mPASS[0m in 0.34s]
[0m17:25:38.975339 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:25:38.972231 [info ] [Thread-2 (]: 12 of 52 PASS not_null_int__price_changes_loaded_at ............................ [[32mPASS[0m in 0.37s]
[0m17:25:38.979066 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:25:38.980924 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m17:25:38.985520 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:25:38.983017 [info ] [Thread-4 (]: 16 of 52 START test not_null_int__price_changes_trade_date ..................... [RUN]
[0m17:25:38.988282 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:25:38.990678 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m17:25:38.992614 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:25:38.994534 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:25:39.014359 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:25:39.020026 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:25:39.030849 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:25:39.035118 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:25:39.036806 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m17:25:39.038272 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:39.043061 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:25:39.044858 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:25:39.046553 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:25:39.058430 [debug] [Thread-3 (]: SQL status: OK in 0.062 seconds
[0m17:25:39.068149 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m17:25:39.070671 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m17:25:39.072255 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m17:25:39.075697 [info ] [Thread-3 (]: 15 of 52 PASS not_null_int__price_changes_ticker ............................... [[32mPASS[0m in 0.20s]
[0m17:25:39.078888 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:25:39.123833 [debug] [Thread-4 (]: SQL status: OK in 0.076 seconds
[0m17:25:39.133137 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m17:25:39.135805 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m17:25:39.137377 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m17:25:39.140868 [info ] [Thread-4 (]: 16 of 52 PASS not_null_int__price_changes_trade_date ........................... [[32mPASS[0m in 0.15s]
[0m17:25:39.144236 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:25:39.146952 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m17:25:39.149669 [info ] [Thread-1 (]: 17 of 52 START sql view model analytics_dev.int__rsi_sma ....................... [RUN]
[0m17:25:39.152221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa, now model.portfolio_project_2.int__rsi_sma)
[0m17:25:39.154091 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m17:25:39.167330 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.171850 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m17:25:39.185754 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.189746 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.191378 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m17:25:39.192827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:39.197159 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:25:39.198719 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.200412 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    sma_gain::decimal as sma_gain,
    sma_loss::decimal as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m17:25:39.295133 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m17:25:39.307201 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.308757 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m17:25:39.366556 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m17:25:39.379040 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.380594 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m17:25:39.441955 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m17:25:39.447400 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m17:25:39.449001 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.450461 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m17:25:39.557084 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m17:25:39.566542 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.568132 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m17:25:39.680801 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m17:25:39.685707 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m17:25:39.687848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB1656B50>]}
[0m17:25:39.690001 [info ] [Thread-1 (]: 17 of 52 OK created sql view model analytics_dev.int__rsi_sma .................. [[32mOK[0m in 0.54s]
[0m17:25:39.692938 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m17:25:39.696022 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:25:39.697571 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:25:39.699098 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:25:39.700631 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:25:39.702196 [info ] [Thread-2 (]: 18 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_gain___0 ......... [RUN]
[0m17:25:39.704714 [info ] [Thread-3 (]: 19 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_loss___0 ......... [RUN]
[0m17:25:39.706898 [info ] [Thread-1 (]: 21 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ..... [RUN]
[0m17:25:39.711092 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6)
[0m17:25:39.712931 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62)
[0m17:25:39.708583 [info ] [Thread-4 (]: 20 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [RUN]
[0m17:25:39.715182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_sma, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9)
[0m17:25:39.716899 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:25:39.718573 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:25:39.720584 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704)
[0m17:25:39.722315 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:25:39.739244 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:25:39.756099 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:25:39.757854 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:25:39.773458 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:25:39.791997 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:25:39.795107 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:25:39.803638 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:25:39.805465 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:25:39.807002 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:25:39.817259 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:25:39.826462 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:25:39.828949 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:25:39.830802 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:25:39.841382 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:25:39.843219 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: BEGIN
[0m17:25:39.845841 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:39.847782 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:25:39.850313 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:25:39.852137 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: BEGIN
[0m17:25:39.853896 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: BEGIN
[0m17:25:39.855867 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:39.857617 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m17:25:39.859236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:39.861062 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:25:39.863580 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:25:39.866014 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: BEGIN
[0m17:25:39.868498 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:25:39.870385 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m17:25:39.872287 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:25:39.873935 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:39.876442 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:25:39.878270 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:25:39.880842 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:25:39.882796 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:25:39.884507 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m17:25:39.887632 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:25:39.889345 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:25:39.977033 [debug] [Thread-1 (]: SQL status: OK in 0.090 seconds
[0m17:25:39.979132 [debug] [Thread-4 (]: SQL status: OK in 0.088 seconds
[0m17:25:39.981145 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m17:25:39.983010 [debug] [Thread-3 (]: SQL status: OK in 0.097 seconds
[0m17:25:39.989055 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: ROLLBACK
[0m17:25:39.994673 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: ROLLBACK
[0m17:25:39.998183 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9'
[0m17:25:40.001233 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704'
[0m17:25:40.006797 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: ROLLBACK
[0m17:25:40.012677 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: Close
[0m17:25:40.014043 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: ROLLBACK
[0m17:25:40.015853 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: Close
[0m17:25:40.018584 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6'
[0m17:25:40.021302 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62'
[0m17:25:40.025472 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: Close
[0m17:25:40.023732 [info ] [Thread-1 (]: 21 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ........... [[32mPASS[0m in 0.31s]
[0m17:25:40.029916 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: Close
[0m17:25:40.028991 [info ] [Thread-4 (]: 20 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[32mPASS[0m in 0.31s]
[0m17:25:40.033509 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:25:40.035828 [info ] [Thread-2 (]: 18 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_gain___0 ............... [[32mPASS[0m in 0.32s]
[0m17:25:40.039499 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:25:40.041916 [info ] [Thread-3 (]: 19 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_loss___0 ............... [[32mPASS[0m in 0.33s]
[0m17:25:40.043654 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:25:40.048120 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:25:40.050097 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:25:40.053025 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:25:40.056630 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:25:40.054846 [info ] [Thread-1 (]: 22 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ..... [RUN]
[0m17:25:40.062033 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:25:40.059542 [info ] [Thread-4 (]: 23 of 52 START test dbt_utils_not_null_where_int__rsi_sma_sma_gain ............. [RUN]
[0m17:25:40.066916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21)
[0m17:25:40.064400 [info ] [Thread-2 (]: 24 of 52 START test dbt_utils_not_null_where_int__rsi_sma_sma_loss ............. [RUN]
[0m17:25:40.071274 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704, now test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e)
[0m17:25:40.073227 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:25:40.068914 [info ] [Thread-3 (]: 25 of 52 START test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [RUN]
[0m17:25:40.075682 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6, now test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d)
[0m17:25:40.077911 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:25:40.111633 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08)
[0m17:25:40.109782 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:25:40.113525 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:25:40.130192 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:25:40.150136 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:25:40.167832 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:25:40.178122 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:25:40.183093 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:25:40.193133 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:25:40.197008 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:25:40.198751 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: BEGIN
[0m17:25:40.200344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:40.204365 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:25:40.206058 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: BEGIN
[0m17:25:40.208210 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:40.210795 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:25:40.212462 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:25:40.215134 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:25:40.217705 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m17:25:40.219330 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:25:40.220994 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_sma"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:25:40.246687 [debug] [Thread-4 (]: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:25:40.252006 [debug] [Thread-2 (]: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:25:40.249587 [error] [Thread-4 (]: 23 of 52 ERROR dbt_utils_not_null_where_int__rsi_sma_sma_gain .................. [[31mERROR[0m in 0.18s]
[0m17:25:40.256748 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:25:40.254562 [error] [Thread-2 (]: 24 of 52 ERROR dbt_utils_not_null_where_int__rsi_sma_sma_loss .................. [[31mERROR[0m in 0.18s]
[0m17:25:40.259870 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:25:40.261842 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:25:40.264114 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:25:40.269648 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:25:40.271638 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:25:40.267662 [info ] [Thread-4 (]: 26 of 52 START test not_null_int__rsi_sma_close ................................ [RUN]
[0m17:25:40.273852 [info ] [Thread-2 (]: 27 of 52 START test not_null_int__rsi_sma_gain ................................. [RUN]
[0m17:25:40.277088 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e, now test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b)
[0m17:25:40.279073 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d, now test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953)
[0m17:25:40.280962 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:25:40.282760 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:25:40.299811 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:25:40.318563 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:25:40.323577 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:25:40.332576 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:25:40.334898 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:25:40.345025 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:25:40.348079 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:25:40.350492 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: BEGIN
[0m17:25:40.352525 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:40.355157 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:25:40.357628 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: BEGIN
[0m17:25:40.359245 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:40.361439 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m17:25:40.363180 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:25:40.366235 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:25:40.364823 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__rsi_sma"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:25:40.368765 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:25:40.371288 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_sma"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:25:40.435133 [debug] [Thread-1 (]: SQL status: OK in 0.218 seconds
[0m17:25:40.436816 [debug] [Thread-3 (]: SQL status: OK in 0.214 seconds
[0m17:25:40.446060 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: ROLLBACK
[0m17:25:40.451800 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: ROLLBACK
[0m17:25:40.454104 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21'
[0m17:25:40.456733 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08'
[0m17:25:40.458417 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: Close
[0m17:25:40.460215 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: Close
[0m17:25:40.463799 [info ] [Thread-1 (]: 22 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ........... [[32mPASS[0m in 0.40s]
[0m17:25:40.468826 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:25:40.465976 [info ] [Thread-3 (]: 25 of 52 PASS dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn .. [[32mPASS[0m in 0.35s]
[0m17:25:40.471095 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:25:40.473913 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:25:40.477524 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:25:40.475742 [info ] [Thread-1 (]: 28 of 52 START test not_null_int__rsi_sma_loaded_at ............................ [RUN]
[0m17:25:40.482029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21, now test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0)
[0m17:25:40.480380 [info ] [Thread-3 (]: 29 of 52 START test not_null_int__rsi_sma_loss ................................. [RUN]
[0m17:25:40.484268 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:25:40.486181 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08, now test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065)
[0m17:25:40.497512 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:25:40.506602 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:25:40.508668 [debug] [Thread-4 (]: SQL status: OK in 0.138 seconds
[0m17:25:40.524396 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:25:40.526253 [debug] [Thread-2 (]: SQL status: OK in 0.153 seconds
[0m17:25:40.531185 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:25:40.548345 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:25:40.550414 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:25:40.553474 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: ROLLBACK
[0m17:25:40.558876 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: ROLLBACK
[0m17:25:40.568425 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:25:40.571671 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:25:40.573729 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b'
[0m17:25:40.576158 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953'
[0m17:25:40.578314 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: BEGIN
[0m17:25:40.580450 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: Close
[0m17:25:40.582534 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: Close
[0m17:25:40.584470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:40.586694 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:25:40.589588 [info ] [Thread-4 (]: 26 of 52 PASS not_null_int__rsi_sma_close ...................................... [[32mPASS[0m in 0.31s]
[0m17:25:40.596692 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:25:40.592367 [info ] [Thread-2 (]: 27 of 52 PASS not_null_int__rsi_sma_gain ....................................... [[32mPASS[0m in 0.31s]
[0m17:25:40.594658 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: BEGIN
[0m17:25:40.600363 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:25:40.602158 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:25:40.604742 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:25:40.606486 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:40.608499 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:25:40.611256 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__rsi_sma"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:25:40.613301 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:25:40.616141 [info ] [Thread-4 (]: 30 of 52 START test not_null_int__rsi_sma_rn ................................... [RUN]
[0m17:25:40.621135 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b, now test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139)
[0m17:25:40.622852 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:25:40.619098 [info ] [Thread-2 (]: 31 of 52 START test not_null_int__rsi_sma_ticker ............................... [RUN]
[0m17:25:40.625289 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m17:25:40.642388 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:25:40.644178 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953, now test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d)
[0m17:25:40.646103 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:25:40.648557 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:25:40.650792 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_sma"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:25:40.667499 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:25:40.671196 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:25:40.682301 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:25:40.684676 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:25:40.694389 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:25:40.697449 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:25:40.700208 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: BEGIN
[0m17:25:40.701866 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:40.704839 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:25:40.706871 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: BEGIN
[0m17:25:40.708503 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:40.710157 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:25:40.712610 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:25:40.714413 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_sma"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:25:40.716653 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:25:40.718336 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:25:40.720223 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_sma"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:25:40.730411 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m17:25:40.739788 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: ROLLBACK
[0m17:25:40.742311 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0'
[0m17:25:40.743865 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: Close
[0m17:25:40.747348 [info ] [Thread-1 (]: 28 of 52 PASS not_null_int__rsi_sma_loaded_at .................................. [[32mPASS[0m in 0.27s]
[0m17:25:40.750449 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:25:40.752538 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:25:40.754253 [info ] [Thread-1 (]: 32 of 52 START test not_null_int__rsi_sma_trade_date ........................... [RUN]
[0m17:25:40.756488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0, now test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0)
[0m17:25:40.758132 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:25:40.774949 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:25:40.776971 [debug] [Thread-3 (]: SQL status: OK in 0.108 seconds
[0m17:25:40.780288 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:25:40.791132 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:25:40.797514 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: ROLLBACK
[0m17:25:40.800162 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065'
[0m17:25:40.802073 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: Close
[0m17:25:40.804758 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:25:40.806980 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: BEGIN
[0m17:25:40.810914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:40.809273 [info ] [Thread-3 (]: 29 of 52 PASS not_null_int__rsi_sma_loss ....................................... [[32mPASS[0m in 0.32s]
[0m17:25:40.814535 [debug] [Thread-4 (]: SQL status: OK in 0.098 seconds
[0m17:25:40.816371 [debug] [Thread-2 (]: SQL status: OK in 0.094 seconds
[0m17:25:40.818887 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:25:40.821376 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:25:40.824154 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:25:40.829794 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: ROLLBACK
[0m17:25:40.831549 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_sma"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:25:40.837094 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: ROLLBACK
[0m17:25:40.840665 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139'
[0m17:25:40.844618 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d'
[0m17:25:40.846317 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: Close
[0m17:25:40.848161 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: Close
[0m17:25:40.852104 [info ] [Thread-2 (]: 31 of 52 PASS not_null_int__rsi_sma_ticker ..................................... [[32mPASS[0m in 0.21s]
[0m17:25:40.857190 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:25:40.854223 [info ] [Thread-4 (]: 30 of 52 PASS not_null_int__rsi_sma_rn ......................................... [[32mPASS[0m in 0.23s]
[0m17:25:40.861378 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:25:40.923973 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m17:25:40.933513 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: ROLLBACK
[0m17:25:40.936027 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0'
[0m17:25:40.937567 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: Close
[0m17:25:40.941169 [info ] [Thread-1 (]: 32 of 52 PASS not_null_int__rsi_sma_trade_date ................................. [[32mPASS[0m in 0.18s]
[0m17:25:40.944580 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:25:40.947125 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m17:25:40.949041 [info ] [Thread-3 (]: 33 of 52 SKIP relation analytics_dev.int__rsi_wilder ........................... [[33mSKIP[0m]
[0m17:25:40.951824 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m17:25:40.953627 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_wilder' to be skipped because of status 'skipped'. 
[0m17:25:40.957035 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:25:40.958823 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:25:40.960543 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:25:40.962255 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:25:40.964254 [info ] [Thread-2 (]: 34 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ....... [[33mSKIP[0m]
[0m17:25:40.967287 [info ] [Thread-1 (]: 36 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [[33mSKIP[0m]
[0m17:25:40.973427 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:25:40.969284 [info ] [Thread-4 (]: 35 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ....... [[33mSKIP[0m]
[0m17:25:40.976156 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:25:40.978198 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:25:40.971578 [info ] [Thread-3 (]: 37 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [[33mSKIP[0m]
[0m17:25:40.980671 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:25:40.982336 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90' to be skipped because of status 'skipped'. 
[0m17:25:40.985480 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:25:40.989418 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:25:40.987469 [info ] [Thread-2 (]: 38 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[33mSKIP[0m]
[0m17:25:40.992211 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:25:40.994123 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7' to be skipped because of status 'skipped'. 
[0m17:25:40.996091 [info ] [Thread-1 (]: 39 of 52 SKIP test not_null_int__rsi_wilder_gain ............................... [[33mSKIP[0m]
[0m17:25:40.997800 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:25:41.000645 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:25:41.004400 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703' to be skipped because of status 'skipped'. 
[0m17:25:41.002626 [info ] [Thread-4 (]: 40 of 52 SKIP test not_null_int__rsi_wilder_loss ............................... [[33mSKIP[0m]
[0m17:25:41.006899 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:25:41.010665 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:25:41.008893 [info ] [Thread-3 (]: 41 of 52 SKIP test not_null_int__rsi_wilder_rn ................................. [[33mSKIP[0m]
[0m17:25:41.013018 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d' to be skipped because of status 'skipped'. 
[0m17:25:41.014974 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:25:41.017626 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:25:41.021368 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:25:41.019632 [info ] [Thread-2 (]: 42 of 52 SKIP test not_null_int__rsi_wilder_ticker ............................. [[33mSKIP[0m]
[0m17:25:41.023649 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95' to be skipped because of status 'skipped'. 
[0m17:25:41.025807 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:25:41.029548 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:25:41.027834 [info ] [Thread-1 (]: 43 of 52 SKIP test not_null_int__rsi_wilder_trade_date ......................... [[33mSKIP[0m]
[0m17:25:41.032557 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:25:41.034336 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda' to be skipped because of status 'skipped'. 
[0m17:25:41.036297 [info ] [Thread-4 (]: 44 of 52 SKIP test not_null_int__rsi_wilder_wilder_gain ........................ [[33mSKIP[0m]
[0m17:25:41.040644 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:25:41.042669 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:25:41.038060 [info ] [Thread-3 (]: 45 of 52 SKIP test not_null_int__rsi_wilder_wilder_loss ........................ [[33mSKIP[0m]
[0m17:25:41.045334 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56' to be skipped because of status 'skipped'. 
[0m17:25:41.047258 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:25:41.051835 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:25:41.050092 [info ] [Thread-2 (]: 46 of 52 SKIP test wilder_seed_equals_sma ...................................... [[33mSKIP[0m]
[0m17:25:41.054148 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d' to be skipped because of status 'skipped'. 
[0m17:25:41.056783 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:25:41.058602 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd' to be skipped because of status 'skipped'. 
[0m17:25:41.060715 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c' to be skipped because of status 'skipped'. 
[0m17:25:41.062358 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9' to be skipped because of status 'skipped'. 
[0m17:25:41.063993 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb' to be skipped because of status 'skipped'. 
[0m17:25:41.065954 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.wilder_seed_equals_sma' to be skipped because of status 'skipped'. 
[0m17:25:41.068805 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m17:25:41.070549 [info ] [Thread-1 (]: 47 of 52 SKIP relation analytics_dev.fct__rsi .................................. [[33mSKIP[0m]
[0m17:25:41.072939 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m17:25:41.074624 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'skipped'. 
[0m17:25:41.077474 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:25:41.079225 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:25:41.081128 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:25:41.083305 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:25:41.085340 [info ] [Thread-1 (]: 51 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ......... [[33mSKIP[0m]
[0m17:25:41.087142 [info ] [Thread-2 (]: 50 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............ [[33mSKIP[0m]
[0m17:25:41.094697 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:25:41.096738 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:25:41.089842 [info ] [Thread-3 (]: 49 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[33mSKIP[0m]
[0m17:25:41.099435 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:25:41.101237 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0' to be skipped because of status 'skipped'. 
[0m17:25:41.092105 [info ] [Thread-4 (]: 48 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[33mSKIP[0m]
[0m17:25:41.104029 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:25:41.108183 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a' to be skipped because of status 'skipped'. 
[0m17:25:41.106063 [info ] [Thread-1 (]: 52 of 52 SKIP test dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker  [[33mSKIP[0m]
[0m17:25:41.112036 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:25:41.114165 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2' to be skipped because of status 'skipped'. 
[0m17:25:41.116635 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:25:41.118875 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a' to be skipped because of status 'skipped'. 
[0m17:25:41.121007 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400' to be skipped because of status 'skipped'. 
[0m17:25:41.126693 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:41.128188 [debug] [MainThread]: On master: BEGIN
[0m17:25:41.129488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:25:41.133876 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:25:41.135320 [debug] [MainThread]: On master: COMMIT
[0m17:25:41.136614 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:41.137847 [debug] [MainThread]: On master: COMMIT
[0m17:25:41.140576 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:25:41.142039 [debug] [MainThread]: On master: Close
[0m17:25:41.143846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:41.145168 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:25:41.146337 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:25:41.147480 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0' was properly closed.
[0m17:25:41.148760 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d' was properly closed.
[0m17:25:41.149924 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065' was properly closed.
[0m17:25:41.151127 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139' was properly closed.
[0m17:25:41.152676 [info ] [MainThread]: 
[0m17:25:41.154585 [info ] [MainThread]: Finished running 47 data tests, 5 view models in 0 hours 0 minutes and 7.46 seconds (7.46s).
[0m17:25:41.179916 [debug] [MainThread]: Command end result
[0m17:25:41.444733 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:25:41.448293 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:25:41.459943 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:25:41.460523 [info ] [MainThread]: 
[0m17:25:41.461350 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:25:41.462166 [info ] [MainThread]: 
[0m17:25:41.463106 [error] [MainThread]: [31mFailure in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)[0m
[0m17:25:41.463983 [error] [MainThread]:   Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:25:41.464846 [info ] [MainThread]: 
[0m17:25:41.465698 [error] [MainThread]: [31mFailure in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)[0m
[0m17:25:41.466710 [error] [MainThread]:   Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:25:41.467534 [info ] [MainThread]: 
[0m17:25:41.468323 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=2 SKIP=20 NO-OP=0 TOTAL=52
[0m17:25:41.469526 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:25:41.471267 [debug] [MainThread]: Command `-c build` failed at 17:25:41.471062 after 13.83 seconds
[0m17:25:41.471877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CA8D4F150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB2D18C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAF83EB70>]}
[0m17:25:41.472565 [debug] [MainThread]: Flushing usage events
[0m17:25:42.421998 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:53.509196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3BF18050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3C7242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3CD63ED0>]}


============================== 17:27:53.524632 | 793993c1-ab1f-447b-bd69-20f436741a7c ==============================
[0m17:27:53.524632 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:27:53.527046 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m17:27:54.102662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '793993c1-ab1f-447b-bd69-20f436741a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3C0D0180>]}
[0m17:27:54.191904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '793993c1-ab1f-447b-bd69-20f436741a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3CC07790>]}
[0m17:27:54.195603 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:27:54.686913 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:27:55.069834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:27:55.071147 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\silver_schema.yml
[0m17:27:55.811372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '793993c1-ab1f-447b-bd69-20f436741a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3E5FD550>]}
[0m17:27:56.009321 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:27:56.012435 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:27:56.093209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '793993c1-ab1f-447b-bd69-20f436741a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3E89FD40>]}
[0m17:27:56.094315 [info ] [MainThread]: Found 6 models, 47 data tests, 2 sources, 853 macros
[0m17:27:56.095628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '793993c1-ab1f-447b-bd69-20f436741a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3E7E04B0>]}
[0m17:27:56.105007 [info ] [MainThread]: 
[0m17:27:56.106290 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:27:56.107218 [info ] [MainThread]: 
[0m17:27:56.108184 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:27:56.116210 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:27:56.249993 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:27:56.250517 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:27:56.250945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:58.076015 [debug] [ThreadPool]: SQL status: OK in 1.825 seconds
[0m17:27:58.077651 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:27:58.078927 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:27:58.204433 [debug] [ThreadPool]: SQL status: OK in 0.124 seconds
[0m17:27:58.206578 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:27:58.208049 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:27:58.208506 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:27:58.211462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '793993c1-ab1f-447b-bd69-20f436741a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3E9435F0>]}
[0m17:27:58.212223 [debug] [MainThread]: Using duckdb connection "master"
[0m17:27:58.212793 [debug] [MainThread]: On master: BEGIN
[0m17:27:58.213284 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:27:58.215012 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:27:58.215560 [debug] [MainThread]: On master: COMMIT
[0m17:27:58.216075 [debug] [MainThread]: Using duckdb connection "master"
[0m17:27:58.216573 [debug] [MainThread]: On master: COMMIT
[0m17:27:58.217563 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:27:58.218124 [debug] [MainThread]: On master: Close
[0m17:27:58.226824 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:27:58.228381 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:27:58.229317 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:27:58.227707 [info ] [Thread-1 (]: 1 of 47 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [RUN]
[0m17:27:58.231454 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:27:58.230582 [info ] [Thread-4 (]: 4 of 47 START test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ......... [RUN]
[0m17:27:58.233858 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a'
[0m17:27:58.232724 [info ] [Thread-3 (]: 3 of 47 START test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............ [RUN]
[0m17:27:58.236094 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0'
[0m17:27:58.235049 [info ] [Thread-2 (]: 2 of 47 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [RUN]
[0m17:27:58.237506 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:27:58.238785 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a'
[0m17:27:58.239819 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:27:58.241131 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2'
[0m17:27:58.254195 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:27:58.318687 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:27:58.340341 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:27:58.342228 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:27:58.359075 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:27:58.378534 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:27:58.382571 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:27:58.450176 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:27:58.460127 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:27:58.469707 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:27:58.471471 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:27:58.473464 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:27:58.484412 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:27:58.493266 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:27:58.498062 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:27:58.499911 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: BEGIN
[0m17:27:58.501470 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:27:58.505434 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:27:58.507698 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:27:58.509414 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: BEGIN
[0m17:27:58.511222 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:27:58.513708 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: BEGIN
[0m17:27:58.514934 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m17:27:58.516719 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:27:58.518493 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: BEGIN
[0m17:27:58.520255 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:27:58.522054 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:27:58.524575 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:27:58.527239 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and wilder_rsi >= 0 and wilder_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m17:27:58.529176 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m17:27:58.531801 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:27:58.533470 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:27:58.535951 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:27:58.537725 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m17:27:58.539452 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where sma_rs is not null) dbt_subquery

where not(sma_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m17:27:58.541461 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and sma_rsi >= 0 and sma_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m17:27:58.543415 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:27:58.547153 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where wilder_rs is not null) dbt_subquery

where not(wilder_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:00.116610 [debug] [Thread-1 (]: SQL status: OK in 1.571 seconds
[0m17:28:00.118525 [debug] [Thread-2 (]: SQL status: OK in 1.587 seconds
[0m17:28:00.120142 [debug] [Thread-3 (]: SQL status: OK in 1.575 seconds
[0m17:28:00.121868 [debug] [Thread-4 (]: SQL status: OK in 1.573 seconds
[0m17:28:00.141709 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: ROLLBACK
[0m17:28:00.146357 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: ROLLBACK
[0m17:28:00.151536 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: ROLLBACK
[0m17:28:00.155146 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2'
[0m17:28:00.157526 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a'
[0m17:28:00.160000 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a'
[0m17:28:00.165303 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: ROLLBACK
[0m17:28:00.167066 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: Close
[0m17:28:00.168881 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: Close
[0m17:28:00.170566 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: Close
[0m17:28:00.173086 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0'
[0m17:28:00.175466 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: Close
[0m17:28:00.178168 [info ] [Thread-1 (]: 1 of 47 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[32mPASS[0m in 1.94s]
[0m17:28:00.185698 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:28:00.180364 [info ] [Thread-3 (]: 3 of 47 PASS dbt_utils_expression_is_true_fct__rsi_sma_rs___0 .................. [[32mPASS[0m in 1.94s]
[0m17:28:00.190231 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:28:00.182558 [info ] [Thread-2 (]: 2 of 47 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[32mPASS[0m in 1.94s]
[0m17:28:00.193878 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:28:00.188542 [info ] [Thread-4 (]: 4 of 47 PASS dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ............... [[32mPASS[0m in 1.95s]
[0m17:28:00.199034 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:28:00.210485 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:28:00.195997 [info ] [Thread-1 (]: 5 of 47 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m17:28:00.213965 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:28:00.216071 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:28:00.220323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7)
[0m17:28:00.218443 [info ] [Thread-3 (]: 6 of 47 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m17:28:00.222839 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:28:00.226673 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:28:00.224915 [info ] [Thread-2 (]: 7 of 47 START test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [RUN]
[0m17:28:00.229325 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e)
[0m17:28:00.253411 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:28:00.231265 [info ] [Thread-4 (]: 8 of 47 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .... [RUN]
[0m17:28:00.255709 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd)
[0m17:28:00.257618 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:28:00.259928 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m17:28:00.262129 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:28:00.284312 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:28:00.286905 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:28:00.288755 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:28:00.309458 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:28:00.325710 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:28:00.336860 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:28:00.340323 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:28:00.350756 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:28:00.353550 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:28:00.362869 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:28:00.364617 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:28:00.366735 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:28:00.378031 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:28:00.379583 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:28:00.381334 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m17:28:00.383312 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m17:28:00.385863 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:28:00.387745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:00.389506 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:00.391501 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: BEGIN
[0m17:28:00.393542 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:28:00.396940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:00.398863 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m17:28:00.400684 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m17:28:00.402730 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m17:28:00.405187 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:00.407266 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:28:00.410105 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:28:00.412051 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m17:28:00.414632 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m17:28:00.416783 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m17:28:00.418660 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m17:28:00.420369 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:28:00.425687 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(abs(delta) - (gain + loss)) <= 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:28:00.423697 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:28:00.428393 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:00.518139 [debug] [Thread-3 (]: SQL status: OK in 0.096 seconds
[0m17:28:00.524438 [debug] [Thread-2 (]: SQL status: OK in 0.097 seconds
[0m17:28:00.526403 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m17:28:00.528104 [debug] [Thread-4 (]: SQL status: OK in 0.098 seconds
[0m17:28:00.533933 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m17:28:00.539748 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: ROLLBACK
[0m17:28:00.545330 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m17:28:00.548501 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:28:00.551036 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd'
[0m17:28:00.558777 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m17:28:00.553658 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:28:00.560878 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m17:28:00.562662 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: Close
[0m17:28:00.565314 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m17:28:00.567130 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m17:28:00.569407 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m17:28:00.571876 [info ] [Thread-3 (]: 6 of 47 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.34s]
[0m17:28:00.577413 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:28:00.573968 [info ] [Thread-2 (]: 7 of 47 PASS dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[32mPASS[0m in 0.32s]
[0m17:28:00.581871 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:28:00.580170 [info ] [Thread-1 (]: 5 of 47 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.36s]
[0m17:28:00.587677 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:28:00.584357 [info ] [Thread-4 (]: 8 of 47 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 .......... [[32mPASS[0m in 0.32s]
[0m17:28:00.592986 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:28:00.590122 [info ] [Thread-3 (]: 9 of 47 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .... [RUN]
[0m17:28:00.595769 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:28:00.599106 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:28:00.601214 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:28:00.603506 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m17:28:00.607571 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:28:00.605808 [info ] [Thread-2 (]: 10 of 47 START test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [RUN]
[0m17:28:00.611842 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:28:00.610209 [info ] [Thread-1 (]: 11 of 47 START test dbt_utils_expression_is_true_int__rsi_sma_gain___0 ......... [RUN]
[0m17:28:00.616662 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96)
[0m17:28:00.614262 [info ] [Thread-4 (]: 12 of 47 START test dbt_utils_expression_is_true_int__rsi_sma_loss___0 ......... [RUN]
[0m17:28:00.634939 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:28:00.636777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6)
[0m17:28:00.638689 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:28:00.640657 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62)
[0m17:28:00.643059 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:28:00.661588 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:28:00.663545 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:28:00.685934 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:28:00.698496 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:28:00.724554 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:28:00.715035 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:28:00.728478 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:28:00.738215 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:28:00.739967 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:28:00.748566 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:28:00.753060 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:28:00.754796 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m17:28:00.757432 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:00.759129 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:28:00.761081 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:28:00.771235 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:28:00.773046 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: BEGIN
[0m17:28:00.774908 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:28:00.776682 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m17:28:00.778782 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:00.780950 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: BEGIN
[0m17:28:00.782934 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:28:00.784879 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:28:00.787247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:00.789138 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:00.791092 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: BEGIN
[0m17:28:00.793825 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m17:28:00.797150 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:00.799399 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:28:00.802269 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:28:00.804185 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m17:28:00.806742 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:28:00.808376 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m17:28:00.810141 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:00.812061 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:28:00.814571 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:00.944445 [debug] [Thread-2 (]: SQL status: OK in 0.138 seconds
[0m17:28:00.946200 [debug] [Thread-3 (]: SQL status: OK in 0.150 seconds
[0m17:28:00.948376 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m17:28:00.950658 [debug] [Thread-4 (]: SQL status: OK in 0.134 seconds
[0m17:28:00.961688 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m17:28:00.956972 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: ROLLBACK
[0m17:28:00.968119 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: ROLLBACK
[0m17:28:00.973897 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: ROLLBACK
[0m17:28:00.976316 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m17:28:00.978826 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96'
[0m17:28:00.981440 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6'
[0m17:28:00.984061 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62'
[0m17:28:00.985845 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m17:28:00.987623 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: Close
[0m17:28:00.989648 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: Close
[0m17:28:00.991398 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: Close
[0m17:28:00.995159 [info ] [Thread-2 (]: 10 of 47 PASS dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[32mPASS[0m in 0.38s]
[0m17:28:00.997279 [info ] [Thread-1 (]: 11 of 47 PASS dbt_utils_expression_is_true_int__rsi_sma_gain___0 ............... [[32mPASS[0m in 0.36s]
[0m17:28:01.005128 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:28:01.007903 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:28:00.999376 [info ] [Thread-4 (]: 12 of 47 PASS dbt_utils_expression_is_true_int__rsi_sma_loss___0 ............... [[32mPASS[0m in 0.36s]
[0m17:28:01.010391 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:28:01.001420 [info ] [Thread-3 (]: 9 of 47 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 .......... [[32mPASS[0m in 0.40s]
[0m17:28:01.013517 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:28:01.016900 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:28:01.021932 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:28:01.018761 [info ] [Thread-2 (]: 13 of 47 START test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [RUN]
[0m17:28:01.026069 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:28:01.024284 [info ] [Thread-1 (]: 14 of 47 START test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ..... [RUN]
[0m17:28:01.028637 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:28:01.030721 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704)
[0m17:28:01.034481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9)
[0m17:28:01.032710 [info ] [Thread-4 (]: 15 of 47 START test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ..... [RUN]
[0m17:28:01.039154 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:28:01.037432 [info ] [Thread-3 (]: 16 of 47 START test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ...... [RUN]
[0m17:28:01.041545 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:28:01.043488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21)
[0m17:28:01.060565 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:28:01.062456 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90)
[0m17:28:01.081500 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:28:01.083300 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:28:01.085779 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:28:01.104725 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:28:01.106782 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:28:01.123815 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:28:01.133892 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:28:01.135665 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:28:01.138693 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:28:01.149175 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:28:01.160476 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:28:01.162845 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:28:01.165093 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: BEGIN
[0m17:28:01.166641 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:01.168827 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:28:01.178681 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:28:01.181057 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:28:01.183584 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m17:28:01.185804 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:28:01.187664 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: BEGIN
[0m17:28:01.189525 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:28:01.191460 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: BEGIN
[0m17:28:01.193417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:01.195347 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:28:01.197136 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:28:01.198992 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:01.201496 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: BEGIN
[0m17:28:01.204201 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:28:01.205835 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:01.208056 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:28:01.209903 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m17:28:01.212342 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:01.214256 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:28:01.216839 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m17:28:01.218584 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:01.220471 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:28:01.222987 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:01.294558 [debug] [Thread-2 (]: SQL status: OK in 0.091 seconds
[0m17:28:01.304356 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: ROLLBACK
[0m17:28:01.306288 [debug] [Thread-4 (]: SQL status: OK in 0.084 seconds
[0m17:28:01.308236 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m17:28:01.310604 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704'
[0m17:28:01.316319 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: ROLLBACK
[0m17:28:01.319922 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: Close
[0m17:28:01.323639 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: ROLLBACK
[0m17:28:01.326405 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21'
[0m17:28:01.328639 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: Close
[0m17:28:01.330929 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9'
[0m17:28:01.332798 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: Close
[0m17:28:01.336633 [info ] [Thread-4 (]: 15 of 47 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ........... [[32mPASS[0m in 0.29s]
[0m17:28:01.342612 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:28:01.335145 [info ] [Thread-2 (]: 13 of 47 PASS dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[32mPASS[0m in 0.30s]
[0m17:28:01.344942 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:28:01.348011 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:28:01.340336 [info ] [Thread-1 (]: 14 of 47 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ........... [[32mPASS[0m in 0.31s]
[0m17:28:01.352215 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:28:01.350472 [info ] [Thread-4 (]: 17 of 47 START test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ...... [RUN]
[0m17:28:01.355593 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:28:01.359654 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703)
[0m17:28:01.357431 [info ] [Thread-2 (]: 18 of 47 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [RUN]
[0m17:28:01.362248 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:28:01.364289 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:28:01.366304 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7)
[0m17:28:01.368332 [info ] [Thread-1 (]: 19 of 47 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [RUN]
[0m17:28:01.382576 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:28:01.391426 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:28:01.393451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d)
[0m17:28:01.409074 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:28:01.411424 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:28:01.432647 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:28:01.440289 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:28:01.448362 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:28:01.450454 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:28:01.460176 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:28:01.463134 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:28:01.473287 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:28:01.475732 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:28:01.477442 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: BEGIN
[0m17:28:01.479035 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:01.480814 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:28:01.483276 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: BEGIN
[0m17:28:01.484798 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:01.486884 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:28:01.488767 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:28:01.490733 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:28:01.492615 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: BEGIN
[0m17:28:01.494409 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m17:28:01.496124 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:01.497998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:01.499769 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:28:01.503010 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:01.505682 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:28:01.507346 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:28:01.509017 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:02.450849 [debug] [Thread-3 (]: SQL status: OK in 1.226 seconds
[0m17:28:02.459908 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: ROLLBACK
[0m17:28:02.462789 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90'
[0m17:28:02.464325 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: Close
[0m17:28:02.467509 [info ] [Thread-3 (]: 16 of 47 PASS dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ............ [[32mPASS[0m in 1.40s]
[0m17:28:02.470664 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:28:02.472402 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:28:02.474300 [info ] [Thread-3 (]: 20 of 47 START test dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker  [RUN]
[0m17:28:02.476524 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400)
[0m17:28:02.478259 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:28:02.495271 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400"
[0m17:28:02.509198 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:28:02.534151 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400"
[0m17:28:02.537912 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400"
[0m17:28:02.539588 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400: BEGIN
[0m17:28:02.541112 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:02.545550 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:28:02.547097 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400"
[0m17:28:02.548673 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        trade_date, ticker
    from "finance"."analytics_dev"."fct__rsi"
    group by trade_date, ticker
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:28:02.762763 [debug] [Thread-2 (]: SQL status: OK in 1.258 seconds
[0m17:28:02.764330 [debug] [Thread-1 (]: SQL status: OK in 1.254 seconds
[0m17:28:02.765655 [debug] [Thread-4 (]: SQL status: OK in 1.264 seconds
[0m17:28:02.769927 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: ROLLBACK
[0m17:28:02.774148 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: ROLLBACK
[0m17:28:02.777780 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: ROLLBACK
[0m17:28:02.779437 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7'
[0m17:28:02.781041 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d'
[0m17:28:02.782711 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703'
[0m17:28:02.783894 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: Close
[0m17:28:02.784998 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: Close
[0m17:28:02.786130 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: Close
[0m17:28:02.788807 [info ] [Thread-1 (]: 19 of 47 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0 ..... [[32mPASS[0m in 1.40s]
[0m17:28:02.793835 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:28:02.790351 [info ] [Thread-2 (]: 18 of 47 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0 ..... [[32mPASS[0m in 1.42s]
[0m17:28:02.795685 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:28:02.791673 [info ] [Thread-4 (]: 17 of 47 PASS dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ............ [[32mPASS[0m in 1.43s]
[0m17:28:02.798885 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:28:02.802788 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:28:02.800733 [info ] [Thread-1 (]: 21 of 47 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m17:28:02.804371 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:28:02.806121 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:28:02.807656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m17:28:02.809022 [info ] [Thread-2 (]: 22 of 47 START test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [RUN]
[0m17:28:02.811613 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:28:02.813136 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08)
[0m17:28:02.810166 [info ] [Thread-4 (]: 23 of 47 START test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [RUN]
[0m17:28:02.825359 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:28:02.826524 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:28:02.827706 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95)
[0m17:28:02.839921 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:28:02.841611 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:28:02.843057 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:28:02.859680 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:28:02.870192 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:28:02.872557 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:28:02.879544 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:28:02.881310 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:28:02.886745 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:28:02.888541 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:28:02.889776 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m17:28:02.890853 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:28:02.891868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:02.893035 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: BEGIN
[0m17:28:02.894711 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:28:02.895770 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:02.896958 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: BEGIN
[0m17:28:02.898247 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:28:02.900568 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:02.901662 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:28:02.902764 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:28:02.904296 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:28:02.905519 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:28:02.907241 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m17:28:02.908373 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_sma"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:28:02.909545 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:28:02.911205 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_wilder"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:28:03.054550 [debug] [Thread-1 (]: SQL status: OK in 0.148 seconds
[0m17:28:03.058968 [debug] [Thread-2 (]: SQL status: OK in 0.148 seconds
[0m17:28:03.064677 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m17:28:03.070596 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: ROLLBACK
[0m17:28:03.072853 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m17:28:03.076458 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m17:28:03.075481 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08'
[0m17:28:03.079129 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: Close
[0m17:28:03.081512 [info ] [Thread-1 (]: 21 of 47 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.27s]
[0m17:28:03.087127 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:28:03.085547 [info ] [Thread-2 (]: 22 of 47 PASS dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn .. [[32mPASS[0m in 0.27s]
[0m17:28:03.089686 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:28:03.092480 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:28:03.096403 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:28:03.094245 [info ] [Thread-1 (]: 24 of 47 START test not_null_int__price_changes_close .......................... [RUN]
[0m17:28:03.101119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m17:28:03.099236 [info ] [Thread-2 (]: 25 of 47 START test not_null_int__price_changes_gain ........................... [RUN]
[0m17:28:03.103785 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:28:03.105760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m17:28:03.128177 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:28:03.136407 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:28:03.154808 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:28:03.159436 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:28:03.167289 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:28:03.172002 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:28:03.183065 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:28:03.187464 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:28:03.189540 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m17:28:03.191236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:03.193004 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:28:03.195803 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m17:28:03.199120 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:03.202294 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:28:03.204371 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:28:03.206353 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:28:03.208521 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m17:28:03.210938 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:28:03.213867 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:28:03.480719 [debug] [Thread-1 (]: SQL status: OK in 0.271 seconds
[0m17:28:03.482417 [debug] [Thread-2 (]: SQL status: OK in 0.267 seconds
[0m17:28:03.491470 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m17:28:03.497341 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m17:28:03.499646 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m17:28:03.502243 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m17:28:03.503895 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m17:28:03.505638 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m17:28:03.510850 [info ] [Thread-1 (]: 24 of 47 PASS not_null_int__price_changes_close ................................ [[32mPASS[0m in 0.41s]
[0m17:28:03.514427 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:28:03.509354 [info ] [Thread-2 (]: 25 of 47 PASS not_null_int__price_changes_gain ................................. [[32mPASS[0m in 0.40s]
[0m17:28:03.516719 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:28:03.519534 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:28:03.523069 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:28:03.521344 [info ] [Thread-1 (]: 26 of 47 START test not_null_int__price_changes_loaded_at ...................... [RUN]
[0m17:28:03.528576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m17:28:03.526106 [info ] [Thread-2 (]: 27 of 47 START test not_null_int__price_changes_loss ........................... [RUN]
[0m17:28:03.530950 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:28:03.533522 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m17:28:03.549823 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:28:03.552408 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:28:03.571274 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:28:03.573859 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:28:03.584481 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:28:03.587906 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:28:03.597086 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:28:03.600261 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:28:03.602000 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m17:28:03.603843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:03.606896 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:28:03.608560 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m17:28:03.610113 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:28:03.611721 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:03.613510 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:28:03.616528 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:28:03.619355 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:28:03.621009 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:28:03.622621 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:28:03.795440 [debug] [Thread-1 (]: SQL status: OK in 0.177 seconds
[0m17:28:03.797440 [debug] [Thread-2 (]: SQL status: OK in 0.173 seconds
[0m17:28:03.807246 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m17:28:03.809776 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m17:28:03.815189 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m17:28:03.816823 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m17:28:03.819957 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m17:28:03.823776 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m17:28:03.822255 [info ] [Thread-1 (]: 26 of 47 PASS not_null_int__price_changes_loaded_at ............................ [[32mPASS[0m in 0.29s]
[0m17:28:03.827104 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:28:03.831055 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:28:03.829367 [info ] [Thread-2 (]: 27 of 47 PASS not_null_int__price_changes_loss ................................. [[32mPASS[0m in 0.30s]
[0m17:28:03.836372 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:28:03.833881 [info ] [Thread-1 (]: 28 of 47 START test not_null_int__price_changes_rn ............................. [RUN]
[0m17:28:03.838713 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:28:03.840938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m17:28:03.844543 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:28:03.842852 [info ] [Thread-2 (]: 29 of 47 START test not_null_int__price_changes_ticker ......................... [RUN]
[0m17:28:03.859739 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m17:28:03.864728 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:28:03.866511 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:28:03.882913 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:28:03.886537 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:28:03.888248 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:28:03.900074 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:28:03.910490 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:28:03.914907 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:28:03.916651 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m17:28:03.918423 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:28:03.920078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:03.921878 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m17:28:03.924476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:03.927047 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:28:03.928639 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:28:03.930248 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m17:28:03.931962 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:28:03.933970 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:28:03.936305 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:28:03.939331 [debug] [Thread-3 (]: SQL status: OK in 1.389 seconds
[0m17:28:03.949755 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400: ROLLBACK
[0m17:28:03.952437 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400'
[0m17:28:03.954009 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400: Close
[0m17:28:03.957570 [error] [Thread-3 (]: 20 of 47 FAIL 1270 dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker  [[31mFAIL 1270[0m in 1.48s]
[0m17:28:03.960758 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:28:03.962521 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:28:03.964416 [info ] [Thread-3 (]: 30 of 47 START test not_null_int__price_changes_trade_date ..................... [RUN]
[0m17:28:03.966746 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m17:28:03.968363 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:28:03.984096 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:28:03.987491 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:28:04.010983 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:28:04.014555 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:28:04.016580 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m17:28:04.018618 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:04.020898 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m17:28:04.022674 [debug] [Thread-2 (]: SQL status: OK in 0.084 seconds
[0m17:28:04.025063 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:28:04.026783 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:28:04.032857 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m17:28:04.034684 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.040254 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m17:28:04.043272 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m17:28:04.046043 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m17:28:04.048326 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m17:28:04.050092 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m17:28:04.053761 [info ] [Thread-1 (]: 28 of 47 PASS not_null_int__price_changes_rn ................................... [[32mPASS[0m in 0.21s]
[0m17:28:04.059234 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:28:04.056525 [info ] [Thread-2 (]: 29 of 47 PASS not_null_int__price_changes_ticker ............................... [[32mPASS[0m in 0.20s]
[0m17:28:04.061537 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:28:04.064742 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:28:04.068242 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:28:04.066491 [info ] [Thread-1 (]: 31 of 47 START test not_null_int__rsi_sma_close ................................ [RUN]
[0m17:28:04.070451 [info ] [Thread-2 (]: 32 of 47 START test not_null_int__rsi_sma_gain ................................. [RUN]
[0m17:28:04.072905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638, now test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b)
[0m17:28:04.074763 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a, now test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953)
[0m17:28:04.076547 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:28:04.078298 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:28:04.093548 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:28:04.112036 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:28:04.115734 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:28:04.123115 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:28:04.128137 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:28:04.138092 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:28:04.139979 [debug] [Thread-3 (]: SQL status: OK in 0.095 seconds
[0m17:28:04.143949 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:28:04.146436 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:28:04.148161 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: BEGIN
[0m17:28:04.154051 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m17:28:04.156023 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: BEGIN
[0m17:28:04.157846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:04.159983 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:04.162623 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m17:28:04.166282 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m17:28:04.168422 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:28:04.170117 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:28:04.171786 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:28:04.175671 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:28:04.174078 [info ] [Thread-3 (]: 30 of 47 PASS not_null_int__price_changes_trade_date ........................... [[32mPASS[0m in 0.21s]
[0m17:28:04.178023 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_sma"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.179951 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__rsi_sma"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.182726 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:28:04.185973 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:28:04.187886 [info ] [Thread-3 (]: 33 of 47 START test not_null_int__rsi_sma_loaded_at ............................ [RUN]
[0m17:28:04.190180 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5, now test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0)
[0m17:28:04.191905 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:28:04.210161 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:28:04.213760 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:28:04.223569 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:28:04.225655 [debug] [Thread-4 (]: SQL status: OK in 1.313 seconds
[0m17:28:04.229030 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:28:04.230701 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: BEGIN
[0m17:28:04.238203 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:04.236380 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: ROLLBACK
[0m17:28:04.241962 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95'
[0m17:28:04.243673 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: Close
[0m17:28:04.245305 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:28:04.247480 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:28:04.251776 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__rsi_sma"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.250182 [info ] [Thread-4 (]: 23 of 47 PASS dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[32mPASS[0m in 1.42s]
[0m17:28:04.255498 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:28:04.257834 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:28:04.259777 [info ] [Thread-4 (]: 34 of 47 START test not_null_int__rsi_sma_loss ................................. [RUN]
[0m17:28:04.262113 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95, now test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065)
[0m17:28:04.263801 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:28:04.282082 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:28:04.285653 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:28:04.295821 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:28:04.298332 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m17:28:04.301274 [debug] [Thread-2 (]: SQL status: OK in 0.116 seconds
[0m17:28:04.308259 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: ROLLBACK
[0m17:28:04.312623 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b'
[0m17:28:04.314470 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:28:04.316123 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: Close
[0m17:28:04.321691 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: ROLLBACK
[0m17:28:04.323663 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: BEGIN
[0m17:28:04.330529 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:04.326728 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953'
[0m17:28:04.329013 [info ] [Thread-1 (]: 31 of 47 PASS not_null_int__rsi_sma_close ...................................... [[32mPASS[0m in 0.26s]
[0m17:28:04.333917 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: Close
[0m17:28:04.336609 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:28:04.339054 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:28:04.340714 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m17:28:04.347231 [debug] [Thread-3 (]: SQL status: OK in 0.093 seconds
[0m17:28:04.343023 [info ] [Thread-2 (]: 32 of 47 PASS not_null_int__rsi_sma_gain ....................................... [[32mPASS[0m in 0.27s]
[0m17:28:04.349849 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:28:04.345334 [info ] [Thread-1 (]: 35 of 47 START test not_null_int__rsi_sma_rn ................................... [RUN]
[0m17:28:04.353904 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:28:04.355837 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_sma"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.361671 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: ROLLBACK
[0m17:28:04.363461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b, now test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139)
[0m17:28:04.365439 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:28:04.369704 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:28:04.372169 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0'
[0m17:28:04.390146 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:28:04.374347 [info ] [Thread-2 (]: 36 of 47 START test not_null_int__rsi_sma_sma_gain ............................. [RUN]
[0m17:28:04.392448 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: Close
[0m17:28:04.395100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953, now test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416)
[0m17:28:04.397601 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:28:04.410429 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:28:04.401092 [info ] [Thread-3 (]: 33 of 47 PASS not_null_int__rsi_sma_loaded_at .................................. [[32mPASS[0m in 0.21s]
[0m17:28:04.426947 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:28:04.431419 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:28:04.434102 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:28:04.437070 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:28:04.438755 [info ] [Thread-3 (]: 37 of 47 START test not_null_int__rsi_sma_sma_loss ............................. [RUN]
[0m17:28:04.441236 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0, now test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6)
[0m17:28:04.442964 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:28:04.462490 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:28:04.465469 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:28:04.469494 [debug] [Thread-4 (]: SQL status: OK in 0.102 seconds
[0m17:28:04.471201 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: BEGIN
[0m17:28:04.472821 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:28:04.475230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:04.484408 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:28:04.486868 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:28:04.492671 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: ROLLBACK
[0m17:28:04.503709 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:28:04.506266 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:28:04.508852 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065'
[0m17:28:04.511812 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:28:04.515429 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: Close
[0m17:28:04.518663 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:28:04.520633 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_sma"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.522940 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: BEGIN
[0m17:28:04.525530 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:04.530106 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:28:04.528402 [info ] [Thread-4 (]: 34 of 47 PASS not_null_int__rsi_sma_loss ....................................... [[32mPASS[0m in 0.26s]
[0m17:28:04.534105 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:28:04.532350 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: BEGIN
[0m17:28:04.537141 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:28:04.538889 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:28:04.540614 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:04.543031 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:28:04.545123 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_gain
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_gain is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.547913 [info ] [Thread-4 (]: 38 of 47 START test not_null_int__rsi_sma_ticker ............................... [RUN]
[0m17:28:04.551142 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065, now test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d)
[0m17:28:04.552851 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m17:28:04.554518 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:28:04.556302 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:28:04.573469 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:28:04.575895 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_loss
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_loss is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.581110 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:28:04.590435 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:28:04.593948 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:28:04.595669 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: BEGIN
[0m17:28:04.597133 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:04.601636 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:28:04.603430 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:28:04.605023 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_sma"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.615875 [debug] [Thread-1 (]: SQL status: OK in 0.091 seconds
[0m17:28:04.627385 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: ROLLBACK
[0m17:28:04.629949 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139'
[0m17:28:04.631485 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: Close
[0m17:28:04.634980 [info ] [Thread-1 (]: 35 of 47 PASS not_null_int__rsi_sma_rn ......................................... [[32mPASS[0m in 0.27s]
[0m17:28:04.638532 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:28:04.640342 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:28:04.641911 [debug] [Thread-2 (]: SQL status: OK in 0.092 seconds
[0m17:28:04.643623 [info ] [Thread-1 (]: 39 of 47 START test not_null_int__rsi_sma_trade_date ........................... [RUN]
[0m17:28:04.646415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139, now test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0)
[0m17:28:04.648029 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:28:04.666315 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:28:04.672518 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: ROLLBACK
[0m17:28:04.676056 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416'
[0m17:28:04.678049 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: Close
[0m17:28:04.680645 [debug] [Thread-3 (]: SQL status: OK in 0.102 seconds
[0m17:28:04.683367 [info ] [Thread-2 (]: 36 of 47 PASS not_null_int__rsi_sma_sma_gain ................................... [[32mPASS[0m in 0.29s]
[0m17:28:04.686633 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:28:04.689359 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:28:04.696745 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: ROLLBACK
[0m17:28:04.707004 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:28:04.709291 [debug] [Thread-4 (]: SQL status: OK in 0.103 seconds
[0m17:28:04.711149 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:28:04.714499 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6'
[0m17:28:04.719696 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: Close
[0m17:28:04.717265 [info ] [Thread-2 (]: 40 of 47 START test not_null_int__rsi_wilder_gain .............................. [RUN]
[0m17:28:04.727917 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: ROLLBACK
[0m17:28:04.730035 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416, now test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda)
[0m17:28:04.733404 [info ] [Thread-3 (]: 37 of 47 PASS not_null_int__rsi_sma_sma_loss ................................... [[32mPASS[0m in 0.29s]
[0m17:28:04.737372 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d'
[0m17:28:04.739424 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:28:04.741187 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:28:04.743836 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:28:04.745629 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: Close
[0m17:28:04.748394 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: BEGIN
[0m17:28:04.766722 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:28:04.768643 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:28:04.771294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:04.774123 [info ] [Thread-4 (]: 38 of 47 PASS not_null_int__rsi_sma_ticker ..................................... [[32mPASS[0m in 0.22s]
[0m17:28:04.777675 [info ] [Thread-3 (]: 41 of 47 START test not_null_int__rsi_wilder_loss .............................. [RUN]
[0m17:28:04.783102 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:28:04.785401 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:28:04.787661 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6, now test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56)
[0m17:28:04.789999 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m17:28:04.793222 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:28:04.821367 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:28:04.823153 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:28:04.825019 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:28:04.826850 [info ] [Thread-4 (]: 42 of 47 START test not_null_int__rsi_wilder_rn ................................ [RUN]
[0m17:28:04.844006 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_sma"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.846402 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:28:04.848424 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d, now test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d)
[0m17:28:04.852811 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:28:04.854137 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:28:04.855919 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: BEGIN
[0m17:28:04.873959 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:28:04.875792 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:04.877632 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:28:04.889433 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:28:04.891613 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m17:28:04.893427 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:28:04.895318 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:28:04.897165 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_wilder"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.907775 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:28:04.911066 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:28:04.912795 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: BEGIN
[0m17:28:04.914295 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:04.917215 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:28:04.919533 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: BEGIN
[0m17:28:04.921174 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:28:04.922802 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:04.924561 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:28:04.927351 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_wilder"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.931195 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:28:04.932803 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:28:04.934423 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_wilder"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.943916 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m17:28:04.957549 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: ROLLBACK
[0m17:28:04.960053 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0'
[0m17:28:04.961593 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: Close
[0m17:28:04.965465 [info ] [Thread-1 (]: 39 of 47 PASS not_null_int__rsi_sma_trade_date ................................. [[32mPASS[0m in 0.32s]
[0m17:28:04.968858 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:28:04.970563 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:28:04.972390 [info ] [Thread-1 (]: 43 of 47 START test not_null_int__rsi_wilder_ticker ............................ [RUN]
[0m17:28:04.974747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0, now test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd)
[0m17:28:04.976898 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:28:04.992942 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:28:04.996917 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:28:05.006072 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:28:05.010238 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:28:05.011965 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: BEGIN
[0m17:28:05.013453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:05.017999 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:28:05.019683 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:28:05.021281 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_wilder"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:28:06.167340 [debug] [Thread-3 (]: SQL status: OK in 1.237 seconds
[0m17:28:06.169950 [debug] [Thread-2 (]: SQL status: OK in 1.260 seconds
[0m17:28:06.172357 [debug] [Thread-4 (]: SQL status: OK in 1.236 seconds
[0m17:28:06.178747 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: ROLLBACK
[0m17:28:06.184178 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: ROLLBACK
[0m17:28:06.189895 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: ROLLBACK
[0m17:28:06.192266 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56'
[0m17:28:06.194798 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda'
[0m17:28:06.197391 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d'
[0m17:28:06.199147 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: Close
[0m17:28:06.200881 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: Close
[0m17:28:06.202634 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: Close
[0m17:28:06.206366 [info ] [Thread-3 (]: 41 of 47 PASS not_null_int__rsi_wilder_loss .................................... [[32mPASS[0m in 1.42s]
[0m17:28:06.213479 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:28:06.208465 [info ] [Thread-2 (]: 40 of 47 PASS not_null_int__rsi_wilder_gain .................................... [[32mPASS[0m in 1.48s]
[0m17:28:06.215801 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:28:06.210552 [info ] [Thread-4 (]: 42 of 47 PASS not_null_int__rsi_wilder_rn ...................................... [[32mPASS[0m in 1.36s]
[0m17:28:06.219297 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:28:06.223531 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:28:06.221069 [info ] [Thread-3 (]: 44 of 47 START test not_null_int__rsi_wilder_trade_date ........................ [RUN]
[0m17:28:06.226086 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:28:06.228092 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:28:06.230310 [debug] [Thread-1 (]: SQL status: OK in 1.207 seconds
[0m17:28:06.232163 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56, now test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c)
[0m17:28:06.234692 [info ] [Thread-2 (]: 45 of 47 START test not_null_int__rsi_wilder_wilder_gain ....................... [RUN]
[0m17:28:06.236710 [info ] [Thread-4 (]: 46 of 47 START test not_null_int__rsi_wilder_wilder_loss ....................... [RUN]
[0m17:28:06.240122 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:28:06.242077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9)
[0m17:28:06.248685 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: ROLLBACK
[0m17:28:06.250630 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb)
[0m17:28:06.269339 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:28:06.271068 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:28:06.273916 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd'
[0m17:28:06.275553 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:28:06.292493 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:28:06.295556 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: Close
[0m17:28:06.314211 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:28:06.316058 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:28:06.327588 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:28:06.330301 [info ] [Thread-1 (]: 43 of 47 PASS not_null_int__rsi_wilder_ticker .................................. [[32mPASS[0m in 1.36s]
[0m17:28:06.333811 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:28:06.335618 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:28:06.337263 [info ] [Thread-1 (]: 47 of 47 START test wilder_seed_equals_sma ..................................... [RUN]
[0m17:28:06.339680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd, now test.portfolio_project_2.wilder_seed_equals_sma)
[0m17:28:06.341723 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:28:06.351817 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:28:06.356028 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:28:06.360427 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:28:06.369030 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:28:06.372158 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:28:06.381980 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:28:06.383992 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: BEGIN
[0m17:28:06.387356 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:06.389794 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:28:06.400307 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:28:06.402103 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m17:28:06.404420 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:28:06.406319 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:28:06.407964 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:28:06.409882 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: BEGIN
[0m17:28:06.411782 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: BEGIN
[0m17:28:06.413631 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_wilder"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:28:06.415437 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:06.417290 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:06.419896 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:28:06.422962 [debug] [Thread-1 (]: On test.portfolio_project_2.wilder_seed_equals_sma: BEGIN
[0m17:28:06.424555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:06.427046 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m17:28:06.430084 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:28:06.432632 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m17:28:06.434371 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_gain
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_gain is null



  
  
      
    ) dbt_internal_test
[0m17:28:06.436075 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:28:06.437852 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:28:06.440307 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:28:06.442147 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_loss is null



  
  
      
    ) dbt_internal_test
[0m17:28:06.443814 [debug] [Thread-1 (]: On test.portfolio_project_2.wilder_seed_equals_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.wilder_seed_equals_sma"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- asserts the seed matches SMA at rn=14
with w as (
  select ticker, trade_date, wilder_gain, wilder_loss
  from "finance"."analytics_dev"."int__rsi_wilder"
  where rn = 14
),
s as (
  select ticker, trade_date, sma_gain, sma_loss
  from "finance"."analytics_dev"."int__rsi_sma"
  where rn = 14
)
select
  w.ticker,
  w.trade_date
from w
join s using (ticker, trade_date)
where abs(w.wilder_gain - s.sma_gain) > 1e-9
   or abs(w.wilder_loss - s.sma_loss) > 1e-9;
  
  
      
    ) dbt_internal_test
[0m17:28:06.462250 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.wilder_seed_equals_sma"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- asserts the seed matches SMA at rn=14
with w as (
  select ticker, trade_date, wilder_gain, wilder_loss
  from "finance"."analytics_dev"."int__rsi_wilder"
  where rn = 14
),
s as (
  select ticker, trade_date, sma_gain, sma_loss
  from "finance"."analytics_dev"."int__rsi_sma"
  where rn = 14
)
select
  w.ticker,
  w.trade_date
from w
join s using (ticker, trade_date)
where abs(w.wilder_gain - s.sma_gain) > 1e-9
   or abs(w.wilder_loss - s.sma_loss) > 1e-9;
  
  
      
    ) dbt_internal_test
[0m17:28:06.464093 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:28:06.465953 [debug] [Thread-1 (]: On test.portfolio_project_2.wilder_seed_equals_sma: ROLLBACK
[0m17:28:06.493794 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.wilder_seed_equals_sma'
[0m17:28:06.495444 [debug] [Thread-1 (]: On test.portfolio_project_2.wilder_seed_equals_sma: Close
[0m17:28:06.510253 [debug] [Thread-1 (]: Runtime Error in test wilder_seed_equals_sma (tests\wilder_seed_equals_sma.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 27:    or abs(w.wilder_loss - s.sma_loss) > 1e-9;
                                                       ^
[0m17:28:06.511642 [error] [Thread-1 (]: 47 of 47 ERROR wilder_seed_equals_sma .......................................... [[31mERROR[0m in 0.17s]
[0m17:28:06.513871 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:28:06.515667 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.wilder_seed_equals_sma' to be skipped because of status 'error'.  Reason: Runtime Error in test wilder_seed_equals_sma (tests\wilder_seed_equals_sma.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 27:    or abs(w.wilder_loss - s.sma_loss) > 1e-9;
                                                       ^.
[0m17:28:07.898170 [debug] [Thread-3 (]: SQL status: OK in 1.479 seconds
[0m17:28:07.899908 [debug] [Thread-2 (]: SQL status: OK in 1.460 seconds
[0m17:28:07.901870 [debug] [Thread-4 (]: SQL status: OK in 1.455 seconds
[0m17:28:07.910944 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: ROLLBACK
[0m17:28:07.922776 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: ROLLBACK
[0m17:28:07.925356 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c'
[0m17:28:07.928324 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: ROLLBACK
[0m17:28:07.931659 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb'
[0m17:28:07.933309 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: Close
[0m17:28:07.936530 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9'
[0m17:28:07.938243 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: Close
[0m17:28:07.940381 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: Close
[0m17:28:07.942888 [info ] [Thread-3 (]: 44 of 47 PASS not_null_int__rsi_wilder_trade_date .............................. [[32mPASS[0m in 1.71s]
[0m17:28:07.946760 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:28:07.951266 [info ] [Thread-4 (]: 46 of 47 PASS not_null_int__rsi_wilder_wilder_loss ............................. [[32mPASS[0m in 1.70s]
[0m17:28:07.955878 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:28:07.949092 [info ] [Thread-2 (]: 45 of 47 PASS not_null_int__rsi_wilder_wilder_gain ............................. [[32mPASS[0m in 1.71s]
[0m17:28:07.959951 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:28:07.966561 [debug] [MainThread]: Using duckdb connection "master"
[0m17:28:07.968477 [debug] [MainThread]: On master: BEGIN
[0m17:28:07.969758 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:28:07.974265 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:28:07.975825 [debug] [MainThread]: On master: COMMIT
[0m17:28:07.977396 [debug] [MainThread]: Using duckdb connection "master"
[0m17:28:07.979474 [debug] [MainThread]: On master: COMMIT
[0m17:28:07.984430 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:28:07.986236 [debug] [MainThread]: On master: Close
[0m17:28:07.988102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:07.989588 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:28:07.991516 [debug] [MainThread]: Connection 'test.portfolio_project_2.wilder_seed_equals_sma' was properly closed.
[0m17:28:07.992911 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb' was properly closed.
[0m17:28:07.994153 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c' was properly closed.
[0m17:28:07.995373 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9' was properly closed.
[0m17:28:07.996822 [info ] [MainThread]: 
[0m17:28:07.999016 [info ] [MainThread]: Finished running 47 data tests in 0 hours 0 minutes and 11.89 seconds (11.89s).
[0m17:28:08.047960 [debug] [MainThread]: Command end result
[0m17:28:08.279923 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:28:08.289055 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:28:08.325960 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:28:08.327076 [info ] [MainThread]: 
[0m17:28:08.328533 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:28:08.330191 [info ] [MainThread]: 
[0m17:28:08.332206 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker (models\gold\gold_schema.yml)[0m
[0m17:28:08.333933 [error] [MainThread]:   Got 1270 results, configured to fail if != 0
[0m17:28:08.335395 [info ] [MainThread]: 
[0m17:28:08.337004 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\gold_schema.yml\dbt_utils_unique_combination_o_e60dcae9a0b9171ab7dfce8de5514920.sql
[0m17:28:08.338394 [info ] [MainThread]: 
[0m17:28:08.339985 [error] [MainThread]: [31mFailure in test wilder_seed_equals_sma (tests\wilder_seed_equals_sma.sql)[0m
[0m17:28:08.341715 [error] [MainThread]:   Runtime Error in test wilder_seed_equals_sma (tests\wilder_seed_equals_sma.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 27:    or abs(w.wilder_loss - s.sma_loss) > 1e-9;
                                                       ^
[0m17:28:08.343171 [info ] [MainThread]: 
[0m17:28:08.344714 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\tests\wilder_seed_equals_sma.sql
[0m17:28:08.346133 [info ] [MainThread]: 
[0m17:28:08.347543 [info ] [MainThread]: Done. PASS=45 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=47
[0m17:28:08.350376 [debug] [MainThread]: Command `-c test` failed at 17:28:08.349993 after 15.26 seconds
[0m17:28:08.351496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3CB5F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3E979A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3E97A0A0>]}
[0m17:28:08.352584 [debug] [MainThread]: Flushing usage events
[0m17:28:09.273396 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:39.815402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD0CC8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD14D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD1B13ED0>]}


============================== 17:29:39.830469 | 34028a95-276c-4a74-a9f7-810877f5473e ==============================
[0m17:29:39.830469 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:29:39.832940 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt test', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m17:29:40.312896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34028a95-276c-4a74-a9f7-810877f5473e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD0E80180>]}
[0m17:29:40.407579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34028a95-276c-4a74-a9f7-810877f5473e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD19BB790>]}
[0m17:29:40.411591 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:29:40.792975 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:29:41.205070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:29:41.206129 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\gold\gold_schema.yml
[0m17:29:41.206679 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://tests\wilder_seed_equals_sma.sql
[0m17:29:41.861259 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:29:41.862459 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m17:29:41.863198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '34028a95-276c-4a74-a9f7-810877f5473e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD3372550>]}
[0m17:29:42.178533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34028a95-276c-4a74-a9f7-810877f5473e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD32C3020>]}
[0m17:29:42.379923 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:29:42.382958 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:29:42.475048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34028a95-276c-4a74-a9f7-810877f5473e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD36D0AD0>]}
[0m17:29:42.476428 [info ] [MainThread]: Found 6 models, 46 data tests, 2 sources, 853 macros
[0m17:29:42.477942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34028a95-276c-4a74-a9f7-810877f5473e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD36F3EE0>]}
[0m17:29:42.490219 [info ] [MainThread]: 
[0m17:29:42.491792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:29:42.493233 [info ] [MainThread]: 
[0m17:29:42.495337 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:29:42.511488 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:29:42.704247 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:29:42.704727 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:29:42.705124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:43.959978 [debug] [ThreadPool]: SQL status: OK in 1.255 seconds
[0m17:29:43.960938 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:29:43.961780 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:29:44.067670 [debug] [ThreadPool]: SQL status: OK in 0.105 seconds
[0m17:29:44.071261 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:29:44.073783 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:29:44.074602 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:29:44.079366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34028a95-276c-4a74-a9f7-810877f5473e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD342D0D0>]}
[0m17:29:44.080525 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:44.081351 [debug] [MainThread]: On master: BEGIN
[0m17:29:44.082143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:29:44.085003 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:29:44.085882 [debug] [MainThread]: On master: COMMIT
[0m17:29:44.086725 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:44.087524 [debug] [MainThread]: On master: COMMIT
[0m17:29:44.089090 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:29:44.089972 [debug] [MainThread]: On master: Close
[0m17:29:44.101187 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:29:44.102294 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:29:44.103360 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:29:44.105382 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:29:44.104440 [info ] [Thread-1 (]: 1 of 46 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [RUN]
[0m17:29:44.106838 [info ] [Thread-3 (]: 3 of 46 START test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............ [RUN]
[0m17:29:44.107864 [info ] [Thread-2 (]: 2 of 46 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [RUN]
[0m17:29:44.111060 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a'
[0m17:29:44.112570 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a'
[0m17:29:44.109202 [info ] [Thread-4 (]: 4 of 46 START test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ......... [RUN]
[0m17:29:44.114272 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2'
[0m17:29:44.115424 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:29:44.116566 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:29:44.118012 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0'
[0m17:29:44.119126 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:29:44.150813 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:29:44.162750 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:29:44.163913 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:29:44.175677 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:29:44.188796 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:29:44.191549 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:29:44.193076 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:29:44.244494 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:29:44.238688 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:29:44.245941 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:29:44.247305 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:29:44.253641 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:29:44.259496 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:29:44.261696 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:29:44.263516 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: BEGIN
[0m17:29:44.264523 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:29:44.262874 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:29:44.267122 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: BEGIN
[0m17:29:44.268351 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:29:44.269553 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:29:44.271080 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:29:44.272400 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:29:44.273513 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: BEGIN
[0m17:29:44.274723 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:29:44.275823 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:29:44.276883 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: BEGIN
[0m17:29:44.277990 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:29:44.279148 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and sma_rsi >= 0 and sma_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m17:29:44.280351 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:29:44.281436 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:29:44.283630 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where sma_rs is not null) dbt_subquery

where not(sma_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:44.285690 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:29:44.287911 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:29:44.286858 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:29:44.289985 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:29:44.291580 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and wilder_rsi >= 0 and wilder_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m17:29:44.292858 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where wilder_rs is not null) dbt_subquery

where not(wilder_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:45.690859 [debug] [Thread-4 (]: SQL status: OK in 1.396 seconds
[0m17:29:45.694152 [debug] [Thread-2 (]: SQL status: OK in 1.400 seconds
[0m17:29:45.692600 [debug] [Thread-1 (]: SQL status: OK in 1.409 seconds
[0m17:29:45.696557 [debug] [Thread-3 (]: SQL status: OK in 1.411 seconds
[0m17:29:45.720252 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: ROLLBACK
[0m17:29:45.723730 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: ROLLBACK
[0m17:29:45.731962 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: ROLLBACK
[0m17:29:45.738227 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: ROLLBACK
[0m17:29:45.740829 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a'
[0m17:29:45.744035 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0'
[0m17:29:45.746542 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2'
[0m17:29:45.749184 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a'
[0m17:29:45.750969 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: Close
[0m17:29:45.752754 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: Close
[0m17:29:45.754502 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: Close
[0m17:29:45.756268 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: Close
[0m17:29:45.759993 [info ] [Thread-3 (]: 3 of 46 PASS dbt_utils_expression_is_true_fct__rsi_sma_rs___0 .................. [[32mPASS[0m in 1.65s]
[0m17:29:45.768935 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:29:45.770565 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:29:45.762131 [info ] [Thread-2 (]: 2 of 46 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[32mPASS[0m in 1.65s]
[0m17:29:45.764181 [info ] [Thread-1 (]: 1 of 46 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[32mPASS[0m in 1.65s]
[0m17:29:45.777731 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:29:45.780531 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:29:45.766201 [info ] [Thread-4 (]: 4 of 46 PASS dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ............... [[32mPASS[0m in 1.65s]
[0m17:29:45.783055 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:29:45.773906 [info ] [Thread-3 (]: 5 of 46 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m17:29:45.785959 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:29:45.788800 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:29:45.790646 [info ] [Thread-2 (]: 6 of 46 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m17:29:45.793053 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7)
[0m17:29:45.796761 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:29:45.794985 [info ] [Thread-1 (]: 7 of 46 START test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [RUN]
[0m17:29:45.799638 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e)
[0m17:29:45.802179 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:29:45.804322 [info ] [Thread-4 (]: 8 of 46 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .... [RUN]
[0m17:29:45.807516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd)
[0m17:29:45.809312 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:29:45.831886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m17:29:45.834169 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:29:45.835880 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:29:45.855306 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:29:45.857031 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:29:45.877957 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:29:45.894837 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:29:45.897374 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:29:45.905291 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:29:45.914459 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:29:45.932856 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:29:45.938455 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:29:45.936126 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:29:45.948285 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:29:45.954724 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:29:45.957198 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:29:45.963591 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:29:45.965390 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m17:29:45.967227 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m17:29:45.971269 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:29:45.969719 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:45.973538 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:45.975781 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: BEGIN
[0m17:29:45.979739 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:29:45.981725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:45.983665 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:29:45.987000 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m17:29:45.985354 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m17:29:45.990164 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:29:45.992050 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:29:45.993912 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:45.995667 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m17:29:45.997424 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m17:29:45.999422 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m17:29:46.002279 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:29:46.005500 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m17:29:46.007296 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(abs(delta) - (gain + loss)) <= 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:29:46.009230 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:29:46.011826 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:46.097388 [debug] [Thread-3 (]: SQL status: OK in 0.093 seconds
[0m17:29:46.107511 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m17:29:46.109975 [debug] [Thread-4 (]: SQL status: OK in 0.096 seconds
[0m17:29:46.111921 [debug] [Thread-2 (]: SQL status: OK in 0.107 seconds
[0m17:29:46.109179 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m17:29:46.115413 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:29:46.118182 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m17:29:46.124365 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m17:29:46.130300 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: ROLLBACK
[0m17:29:46.137753 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m17:29:46.132594 [info ] [Thread-3 (]: 5 of 46 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.34s]
[0m17:29:46.141601 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m17:29:46.144234 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd'
[0m17:29:46.147221 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:29:46.149506 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:29:46.151430 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m17:29:46.153309 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: Close
[0m17:29:46.155290 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:29:46.157289 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m17:29:46.159996 [info ] [Thread-3 (]: 9 of 46 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .... [RUN]
[0m17:29:46.167808 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m17:29:46.162381 [info ] [Thread-1 (]: 7 of 46 PASS dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[32mPASS[0m in 0.36s]
[0m17:29:46.172581 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:29:46.175777 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:29:46.164869 [info ] [Thread-4 (]: 8 of 46 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 .......... [[32mPASS[0m in 0.33s]
[0m17:29:46.193410 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:29:46.195457 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:29:46.170342 [info ] [Thread-2 (]: 6 of 46 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.37s]
[0m17:29:46.199303 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:29:46.204283 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:29:46.201622 [info ] [Thread-1 (]: 10 of 46 START test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [RUN]
[0m17:29:46.207542 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:29:46.209399 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:29:46.211623 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:29:46.213761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96)
[0m17:29:46.228644 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:29:46.216130 [info ] [Thread-4 (]: 11 of 46 START test dbt_utils_expression_is_true_int__rsi_sma_gain___0 ......... [RUN]
[0m17:29:46.233020 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:29:46.230921 [info ] [Thread-2 (]: 12 of 46 START test dbt_utils_expression_is_true_int__rsi_sma_loss___0 ......... [RUN]
[0m17:29:46.236270 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6)
[0m17:29:46.257720 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:29:46.260791 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62)
[0m17:29:46.262725 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:29:46.264734 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:29:46.266902 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:29:46.273974 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m17:29:46.286939 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:29:46.304226 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:29:46.306536 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:29:46.308424 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:46.319189 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:29:46.323029 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:29:46.324851 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:29:46.331172 [debug] [Thread-3 (]: SQL status: OK in 0.023 seconds
[0m17:29:46.340483 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:29:46.346268 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:29:46.348362 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:29:46.350820 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:29:46.353280 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:46.355238 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: BEGIN
[0m17:29:46.357714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:46.360079 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:29:46.361908 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:29:46.364377 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: BEGIN
[0m17:29:46.366170 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: BEGIN
[0m17:29:46.367938 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:46.369694 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:29:46.371317 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:46.373863 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:29:46.376475 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:29:46.378845 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m17:29:46.380731 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m17:29:46.382689 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:29:46.384577 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:29:46.386492 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:46.388615 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:46.550581 [debug] [Thread-1 (]: SQL status: OK in 0.172 seconds
[0m17:29:46.552370 [debug] [Thread-3 (]: SQL status: OK in 0.195 seconds
[0m17:29:46.553948 [debug] [Thread-4 (]: SQL status: OK in 0.163 seconds
[0m17:29:46.556293 [debug] [Thread-2 (]: SQL status: OK in 0.166 seconds
[0m17:29:46.561577 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: ROLLBACK
[0m17:29:46.566727 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m17:29:46.572279 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: ROLLBACK
[0m17:29:46.577568 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: ROLLBACK
[0m17:29:46.579730 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96'
[0m17:29:46.582141 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m17:29:46.584425 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6'
[0m17:29:46.586800 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62'
[0m17:29:46.588575 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: Close
[0m17:29:46.590167 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m17:29:46.591771 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: Close
[0m17:29:46.593380 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: Close
[0m17:29:46.597633 [info ] [Thread-2 (]: 12 of 46 PASS dbt_utils_expression_is_true_int__rsi_sma_loss___0 ............... [[32mPASS[0m in 0.34s]
[0m17:29:46.599520 [info ] [Thread-4 (]: 11 of 46 PASS dbt_utils_expression_is_true_int__rsi_sma_gain___0 ............... [[32mPASS[0m in 0.36s]
[0m17:29:46.606905 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:29:46.608605 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:29:46.600721 [info ] [Thread-1 (]: 10 of 46 PASS dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[32mPASS[0m in 0.38s]
[0m17:29:46.610768 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:29:46.612984 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:29:46.602578 [info ] [Thread-3 (]: 9 of 46 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 .......... [[32mPASS[0m in 0.43s]
[0m17:29:46.616175 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:29:46.617919 [info ] [Thread-4 (]: 13 of 46 START test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [RUN]
[0m17:29:46.623302 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:29:46.619488 [info ] [Thread-2 (]: 14 of 46 START test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ..... [RUN]
[0m17:29:46.625657 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:29:46.627652 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704)
[0m17:29:46.629624 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:29:46.631543 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9)
[0m17:29:46.634809 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:29:46.633288 [info ] [Thread-1 (]: 15 of 46 START test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ..... [RUN]
[0m17:29:46.638697 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:29:46.636990 [info ] [Thread-3 (]: 16 of 46 START test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ...... [RUN]
[0m17:29:46.659351 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:29:46.662575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21)
[0m17:29:46.679481 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:29:46.681169 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90)
[0m17:29:46.683440 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:29:46.685820 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:29:46.688111 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:29:46.703122 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:29:46.719136 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:29:46.729174 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:29:46.728346 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:29:46.740647 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:29:46.744070 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:29:46.746385 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:29:46.755974 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:29:46.757975 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:29:46.762099 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:29:46.768179 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:29:46.770756 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: BEGIN
[0m17:29:46.772576 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: BEGIN
[0m17:29:46.774951 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:46.776883 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:29:46.778445 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:46.780994 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: BEGIN
[0m17:29:46.782842 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:29:46.785005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:46.786650 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m17:29:46.788267 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: BEGIN
[0m17:29:46.789901 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m17:29:46.792142 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:29:46.793780 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:46.795802 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:29:46.797662 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:29:46.799386 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:29:46.801885 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:46.803622 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:29:46.805870 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:46.807079 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m17:29:46.808658 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:29:46.809831 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:47.000248 [debug] [Thread-1 (]: SQL status: OK in 0.192 seconds
[0m17:29:47.002055 [debug] [Thread-4 (]: SQL status: OK in 0.197 seconds
[0m17:29:47.004117 [debug] [Thread-2 (]: SQL status: OK in 0.198 seconds
[0m17:29:47.011445 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: ROLLBACK
[0m17:29:47.017001 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: ROLLBACK
[0m17:29:47.020044 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704'
[0m17:29:47.025520 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: ROLLBACK
[0m17:29:47.027189 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: Close
[0m17:29:47.029463 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21'
[0m17:29:47.032092 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9'
[0m17:29:47.034088 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: Close
[0m17:29:47.036112 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: Close
[0m17:29:47.038538 [info ] [Thread-4 (]: 13 of 46 PASS dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[32mPASS[0m in 0.41s]
[0m17:29:47.042000 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:29:47.045916 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:29:47.044253 [info ] [Thread-1 (]: 15 of 46 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ........... [[32mPASS[0m in 0.38s]
[0m17:29:47.049503 [info ] [Thread-4 (]: 17 of 46 START test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ...... [RUN]
[0m17:29:47.053817 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:29:47.051340 [info ] [Thread-2 (]: 14 of 46 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ........... [[32mPASS[0m in 0.42s]
[0m17:29:47.056398 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703)
[0m17:29:47.058452 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:29:47.061268 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:29:47.063094 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:29:47.067382 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:29:47.065262 [info ] [Thread-1 (]: 18 of 46 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [RUN]
[0m17:29:47.085008 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:29:47.086931 [info ] [Thread-2 (]: 19 of 46 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [RUN]
[0m17:29:47.088808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7)
[0m17:29:47.092680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d)
[0m17:29:47.094628 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:29:47.096528 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:29:47.114744 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:29:47.112963 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:29:47.146889 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:29:47.156287 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:29:47.161804 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:29:47.173151 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:29:47.175197 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:29:47.176795 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:29:47.186981 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:29:47.189065 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: BEGIN
[0m17:29:47.191553 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:47.194430 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:29:47.196435 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: BEGIN
[0m17:29:47.199369 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:29:47.201063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:47.202911 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:29:47.204755 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:29:47.207470 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: BEGIN
[0m17:29:47.209370 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:47.211240 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:47.212960 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:29:47.216030 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:29:47.217760 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:47.219960 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m17:29:47.221936 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:29:47.223781 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:47.943857 [debug] [Thread-3 (]: SQL status: OK in 1.132 seconds
[0m17:29:47.949723 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: ROLLBACK
[0m17:29:47.951309 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90'
[0m17:29:47.952256 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: Close
[0m17:29:47.955411 [info ] [Thread-3 (]: 16 of 46 PASS dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ............ [[32mPASS[0m in 1.27s]
[0m17:29:47.957410 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:29:47.958499 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:29:47.959620 [info ] [Thread-3 (]: 20 of 46 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m17:29:47.960809 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m17:29:47.961588 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:29:47.983451 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:29:47.986358 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:29:47.993090 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:29:47.995341 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:29:47.996417 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m17:29:47.997382 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:48.000662 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:29:48.002121 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:29:48.003287 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:29:48.061027 [debug] [Thread-3 (]: SQL status: OK in 0.057 seconds
[0m17:29:48.067120 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m17:29:48.068874 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m17:29:48.069894 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m17:29:48.072213 [info ] [Thread-3 (]: 20 of 46 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.11s]
[0m17:29:48.074221 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:29:48.075276 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:29:48.076458 [info ] [Thread-3 (]: 21 of 46 START test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [RUN]
[0m17:29:48.078607 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08)
[0m17:29:48.079893 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:29:48.089790 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:29:48.091905 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:29:48.098434 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:29:48.100848 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:29:48.101915 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: BEGIN
[0m17:29:48.102855 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:48.105785 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:29:48.106813 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:29:48.107832 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_sma"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:29:48.291590 [debug] [Thread-3 (]: SQL status: OK in 0.182 seconds
[0m17:29:48.301104 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: ROLLBACK
[0m17:29:48.303477 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08'
[0m17:29:48.304891 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: Close
[0m17:29:48.308098 [info ] [Thread-3 (]: 21 of 46 PASS dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn .. [[32mPASS[0m in 0.23s]
[0m17:29:48.310917 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:29:48.312486 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:29:48.314496 [info ] [Thread-3 (]: 22 of 46 START test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [RUN]
[0m17:29:48.316587 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95)
[0m17:29:48.318142 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:29:48.335891 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:29:48.339975 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:29:48.346098 [debug] [Thread-2 (]: SQL status: OK in 1.121 seconds
[0m17:29:48.347958 [debug] [Thread-4 (]: SQL status: OK in 1.133 seconds
[0m17:29:48.354292 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:29:48.360011 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: ROLLBACK
[0m17:29:48.362293 [debug] [Thread-1 (]: SQL status: OK in 1.142 seconds
[0m17:29:48.365849 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d'
[0m17:29:48.372410 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: ROLLBACK
[0m17:29:48.378367 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: ROLLBACK
[0m17:29:48.380355 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: Close
[0m17:29:48.382371 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:29:48.385054 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703'
[0m17:29:48.387800 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7'
[0m17:29:48.389919 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: BEGIN
[0m17:29:48.393918 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: Close
[0m17:29:48.392351 [info ] [Thread-2 (]: 19 of 46 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0 ..... [[32mPASS[0m in 1.30s]
[0m17:29:48.396230 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: Close
[0m17:29:48.398084 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:48.401010 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:29:48.404251 [info ] [Thread-4 (]: 17 of 46 PASS dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ............ [[32mPASS[0m in 1.35s]
[0m17:29:48.409676 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:29:48.406541 [info ] [Thread-1 (]: 18 of 46 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0 ..... [[32mPASS[0m in 1.32s]
[0m17:29:48.413440 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:29:48.415191 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m17:29:48.419770 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:29:48.416970 [info ] [Thread-2 (]: 23 of 46 START test not_null_int__price_changes_close .......................... [RUN]
[0m17:29:48.422657 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:29:48.424710 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:29:48.426680 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:29:48.428963 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m17:29:48.432863 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_wilder"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:29:48.431019 [info ] [Thread-4 (]: 24 of 46 START test not_null_int__price_changes_gain ........................... [RUN]
[0m17:29:48.437510 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:29:48.435243 [info ] [Thread-1 (]: 25 of 46 START test not_null_int__price_changes_loaded_at ...................... [RUN]
[0m17:29:48.441210 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m17:29:48.469904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m17:29:48.478106 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:29:48.480510 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:29:48.482480 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:29:48.500719 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:29:48.517559 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:29:48.520302 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:29:48.531233 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:29:48.537772 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:29:48.543712 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:29:48.549031 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:29:48.559161 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:29:48.561712 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:29:48.564059 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m17:29:48.565682 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:48.568754 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:29:48.570579 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:29:48.572327 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m17:29:48.574067 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:29:48.576293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:48.577545 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m17:29:48.579329 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:29:48.581798 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:48.583656 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:29:48.586151 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:29:48.588680 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:29:48.590319 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:29:48.592100 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:29:48.593914 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:29:48.596395 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:29:48.652465 [debug] [Thread-2 (]: SQL status: OK in 0.064 seconds
[0m17:29:48.661538 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m17:29:48.663991 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m17:29:48.665491 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m17:29:48.668917 [info ] [Thread-2 (]: 23 of 46 PASS not_null_int__price_changes_close ................................ [[32mPASS[0m in 0.24s]
[0m17:29:48.674245 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:29:48.675946 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:29:48.679141 [debug] [Thread-4 (]: SQL status: OK in 0.081 seconds
[0m17:29:48.680763 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m17:29:48.677523 [info ] [Thread-2 (]: 26 of 46 START test not_null_int__price_changes_loss ........................... [RUN]
[0m17:29:48.683762 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m17:29:48.690748 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:29:48.707042 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m17:29:48.697227 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m17:29:48.714579 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:29:48.717676 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m17:29:48.720396 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m17:29:48.722631 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m17:29:48.724729 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m17:29:48.727716 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:29:48.730039 [info ] [Thread-1 (]: 25 of 46 PASS not_null_int__price_changes_loaded_at ............................ [[32mPASS[0m in 0.26s]
[0m17:29:48.744910 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:29:48.733254 [info ] [Thread-4 (]: 24 of 46 PASS not_null_int__price_changes_gain ................................. [[32mPASS[0m in 0.29s]
[0m17:29:48.752675 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:29:48.750065 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:29:48.757885 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:29:48.759783 [info ] [Thread-1 (]: 27 of 46 START test not_null_int__price_changes_rn ............................. [RUN]
[0m17:29:48.762856 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:29:48.765239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m17:29:48.769124 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:29:48.767384 [info ] [Thread-4 (]: 28 of 46 START test not_null_int__price_changes_ticker ......................... [RUN]
[0m17:29:48.782666 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:29:48.785543 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m17:29:48.790653 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m17:29:48.797075 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:29:48.798964 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:29:48.800795 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:48.820841 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:29:48.825040 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:29:48.849231 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m17:29:48.858857 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:29:48.860712 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:29:48.864703 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:29:48.867105 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:29:48.879311 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:29:48.881594 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:29:48.884503 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m17:29:48.886271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:48.889390 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:29:48.892237 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:29:48.891224 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m17:29:48.895112 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:29:48.897329 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:48.899311 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:29:48.904652 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m17:29:48.906440 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:29:48.908044 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.028373 [debug] [Thread-2 (]: SQL status: OK in 0.159 seconds
[0m17:29:49.031802 [debug] [Thread-4 (]: SQL status: OK in 0.121 seconds
[0m17:29:49.033701 [debug] [Thread-1 (]: SQL status: OK in 0.132 seconds
[0m17:29:49.040340 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m17:29:49.046107 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m17:29:49.051991 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m17:29:49.055060 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m17:29:49.057754 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m17:29:49.060387 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m17:29:49.062143 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m17:29:49.063916 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m17:29:49.065932 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m17:29:49.070247 [info ] [Thread-2 (]: 26 of 46 PASS not_null_int__price_changes_loss ................................. [[32mPASS[0m in 0.39s]
[0m17:29:49.079631 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:29:49.081632 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:29:49.073469 [info ] [Thread-1 (]: 27 of 46 PASS not_null_int__price_changes_rn ................................... [[32mPASS[0m in 0.31s]
[0m17:29:49.087776 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:29:49.076508 [info ] [Thread-4 (]: 28 of 46 PASS not_null_int__price_changes_ticker ............................... [[32mPASS[0m in 0.29s]
[0m17:29:49.090394 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:29:49.095350 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:29:49.084784 [info ] [Thread-2 (]: 29 of 46 START test not_null_int__price_changes_trade_date ..................... [RUN]
[0m17:29:49.100031 [info ] [Thread-1 (]: 30 of 46 START test not_null_int__rsi_sma_close ................................ [RUN]
[0m17:29:49.103197 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:29:49.106257 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m17:29:49.108254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638, now test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b)
[0m17:29:49.112871 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:29:49.110661 [info ] [Thread-4 (]: 31 of 46 START test not_null_int__rsi_sma_gain ................................. [RUN]
[0m17:29:49.116060 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:29:49.138721 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:29:49.140540 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a, now test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953)
[0m17:29:49.160074 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:29:49.163658 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:29:49.175312 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:29:49.202067 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:29:49.206409 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:29:49.210690 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:29:49.220688 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:29:49.224858 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:29:49.236369 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:29:49.237820 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:29:49.239730 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m17:29:49.241379 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:49.244562 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:29:49.246426 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:29:49.248074 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: BEGIN
[0m17:29:49.250593 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m17:29:49.252262 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: BEGIN
[0m17:29:49.254005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:49.255928 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:29:49.258049 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:49.260604 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.264006 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:29:49.266127 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:29:49.268114 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m17:29:49.270300 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__rsi_sma"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.272238 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:29:49.275922 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_sma"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.337661 [debug] [Thread-2 (]: SQL status: OK in 0.074 seconds
[0m17:29:49.347233 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m17:29:49.349834 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m17:29:49.351456 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m17:29:49.355159 [info ] [Thread-2 (]: 29 of 46 PASS not_null_int__price_changes_trade_date ........................... [[32mPASS[0m in 0.25s]
[0m17:29:49.358375 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:29:49.360130 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:29:49.362013 [info ] [Thread-2 (]: 32 of 46 START test not_null_int__rsi_sma_loaded_at ............................ [RUN]
[0m17:29:49.364230 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5, now test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0)
[0m17:29:49.366030 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:29:49.383156 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m17:29:49.387766 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:29:49.389815 [debug] [Thread-4 (]: SQL status: OK in 0.112 seconds
[0m17:29:49.397039 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: ROLLBACK
[0m17:29:49.403790 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: ROLLBACK
[0m17:29:49.406284 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b'
[0m17:29:49.409711 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953'
[0m17:29:49.411616 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: Close
[0m17:29:49.413677 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: Close
[0m17:29:49.415515 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:29:49.430145 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:29:49.424422 [info ] [Thread-1 (]: 30 of 46 PASS not_null_int__rsi_sma_close ...................................... [[32mPASS[0m in 0.32s]
[0m17:29:49.434205 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:29:49.426509 [info ] [Thread-4 (]: 31 of 46 PASS not_null_int__rsi_sma_gain ....................................... [[32mPASS[0m in 0.29s]
[0m17:29:49.436646 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:29:49.439975 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:29:49.443807 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:29:49.442029 [info ] [Thread-1 (]: 33 of 46 START test not_null_int__rsi_sma_loss ................................. [RUN]
[0m17:29:49.446293 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:29:49.448293 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: BEGIN
[0m17:29:49.450243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b, now test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065)
[0m17:29:49.453769 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:49.455627 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:29:49.452136 [info ] [Thread-4 (]: 34 of 46 START test not_null_int__rsi_sma_rn ................................... [RUN]
[0m17:29:49.474876 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:29:49.476905 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953, now test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139)
[0m17:29:49.478664 [debug] [Thread-2 (]: SQL status: OK in 0.025 seconds
[0m17:29:49.480978 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:29:49.482958 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:29:49.498492 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:29:49.500477 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__rsi_sma"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.503254 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:29:49.514621 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:29:49.517345 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:29:49.526971 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:29:49.529310 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:29:49.531056 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: BEGIN
[0m17:29:49.532628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:49.535576 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:29:49.537325 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: BEGIN
[0m17:29:49.538995 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:49.540591 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:29:49.542910 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:29:49.544569 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_sma"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.546872 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:29:49.548477 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:29:49.550011 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_sma"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.617028 [debug] [Thread-3 (]: SQL status: OK in 1.177 seconds
[0m17:29:49.629355 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: ROLLBACK
[0m17:29:49.631963 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95'
[0m17:29:49.633550 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: Close
[0m17:29:49.637313 [info ] [Thread-3 (]: 22 of 46 PASS dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[32mPASS[0m in 1.32s]
[0m17:29:49.641035 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:29:49.644372 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:29:49.649215 [info ] [Thread-3 (]: 35 of 46 START test not_null_int__rsi_sma_sma_gain ............................. [RUN]
[0m17:29:49.665804 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95, now test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416)
[0m17:29:49.669279 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:29:49.697264 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:29:49.701453 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:29:49.722852 [debug] [Thread-2 (]: SQL status: OK in 0.217 seconds
[0m17:29:49.730202 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:29:49.733510 [debug] [Thread-4 (]: SQL status: OK in 0.181 seconds
[0m17:29:49.736815 [debug] [Thread-1 (]: SQL status: OK in 0.190 seconds
[0m17:29:49.755681 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: ROLLBACK
[0m17:29:49.759431 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:29:49.769224 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: BEGIN
[0m17:29:49.773608 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0'
[0m17:29:49.777463 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: ROLLBACK
[0m17:29:49.780442 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:49.789279 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: ROLLBACK
[0m17:29:49.791685 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: Close
[0m17:29:49.794029 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065'
[0m17:29:49.796260 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139'
[0m17:29:49.798034 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: Close
[0m17:29:49.799805 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m17:29:49.803508 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: Close
[0m17:29:49.802007 [info ] [Thread-2 (]: 32 of 46 PASS not_null_int__rsi_sma_loaded_at .................................. [[32mPASS[0m in 0.44s]
[0m17:29:49.805525 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:29:49.807398 [info ] [Thread-1 (]: 33 of 46 PASS not_null_int__rsi_sma_loss ....................................... [[32mPASS[0m in 0.36s]
[0m17:29:49.809756 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:29:49.812600 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_gain
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_gain is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.811613 [info ] [Thread-4 (]: 34 of 46 PASS not_null_int__rsi_sma_rn ......................................... [[32mPASS[0m in 0.33s]
[0m17:29:49.814091 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:29:49.815071 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:29:49.816772 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:29:49.817677 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:29:49.820059 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:29:49.818960 [info ] [Thread-2 (]: 36 of 46 START test not_null_int__rsi_sma_sma_loss ............................. [RUN]
[0m17:29:49.821651 [info ] [Thread-1 (]: 37 of 46 START test not_null_int__rsi_sma_ticker ............................... [RUN]
[0m17:29:49.824044 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0, now test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6)
[0m17:29:49.825293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065, now test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d)
[0m17:29:49.822720 [info ] [Thread-4 (]: 38 of 46 START test not_null_int__rsi_sma_trade_date ........................... [RUN]
[0m17:29:49.826873 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:29:49.828045 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:29:49.829114 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139, now test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0)
[0m17:29:49.839249 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:29:49.845885 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:29:49.846630 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:29:49.859074 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:29:49.860888 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:29:49.862184 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:29:49.867934 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:29:49.878376 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:29:49.879661 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:29:49.887362 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:29:49.891757 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:29:49.893186 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:29:49.894229 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: BEGIN
[0m17:29:49.895227 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:29:49.896023 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: BEGIN
[0m17:29:49.897231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:49.898299 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: BEGIN
[0m17:29:49.899593 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:49.901023 [debug] [Thread-3 (]: SQL status: OK in 0.085 seconds
[0m17:29:49.902267 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:49.903317 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:29:49.904922 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:29:49.906047 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_sma"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.907114 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:29:49.908204 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m17:29:49.912370 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: ROLLBACK
[0m17:29:49.913667 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:29:49.914966 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:29:49.916887 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416'
[0m17:29:49.918122 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_sma"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.919991 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_loss
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_loss is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.921631 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: Close
[0m17:29:49.924917 [info ] [Thread-3 (]: 35 of 46 PASS not_null_int__rsi_sma_sma_gain ................................... [[32mPASS[0m in 0.26s]
[0m17:29:49.927083 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:29:49.928183 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:29:49.929260 [info ] [Thread-3 (]: 39 of 46 START test not_null_int__rsi_wilder_gain .............................. [RUN]
[0m17:29:49.930635 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416, now test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda)
[0m17:29:49.931876 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:29:49.944574 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:29:49.947012 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:29:49.953319 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:29:49.955313 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:29:49.956556 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: BEGIN
[0m17:29:49.957310 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:49.960103 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:29:49.961380 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:29:49.962681 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_wilder"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.984888 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m17:29:49.991622 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: ROLLBACK
[0m17:29:49.993784 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d'
[0m17:29:49.994687 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: Close
[0m17:29:49.996446 [info ] [Thread-1 (]: 37 of 46 PASS not_null_int__rsi_sma_ticker ..................................... [[32mPASS[0m in 0.17s]
[0m17:29:49.998207 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:29:49.999142 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:29:49.999908 [info ] [Thread-1 (]: 40 of 46 START test not_null_int__rsi_wilder_loss .............................. [RUN]
[0m17:29:50.000987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d, now test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56)
[0m17:29:50.001826 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:29:50.011998 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:29:50.013342 [debug] [Thread-2 (]: SQL status: OK in 0.090 seconds
[0m17:29:50.014087 [debug] [Thread-4 (]: SQL status: OK in 0.092 seconds
[0m17:29:50.015374 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:29:50.021814 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:29:50.024611 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: ROLLBACK
[0m17:29:50.028788 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: ROLLBACK
[0m17:29:50.030385 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0'
[0m17:29:50.031782 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6'
[0m17:29:50.032781 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: Close
[0m17:29:50.033662 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:29:50.034326 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: Close
[0m17:29:50.035106 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: BEGIN
[0m17:29:50.036747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:50.036081 [info ] [Thread-4 (]: 38 of 46 PASS not_null_int__rsi_sma_trade_date ................................. [[32mPASS[0m in 0.21s]
[0m17:29:50.039065 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:29:50.037656 [info ] [Thread-2 (]: 36 of 46 PASS not_null_int__rsi_sma_sma_loss ................................... [[32mPASS[0m in 0.21s]
[0m17:29:50.039995 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:29:50.040623 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:29:50.041684 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:29:50.043314 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:29:50.042378 [info ] [Thread-4 (]: 41 of 46 START test not_null_int__rsi_wilder_rn ................................ [RUN]
[0m17:29:50.044328 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:29:50.045142 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_wilder"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:29:50.045932 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0, now test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d)
[0m17:29:50.046667 [info ] [Thread-2 (]: 42 of 46 START test not_null_int__rsi_wilder_ticker ............................ [RUN]
[0m17:29:50.047899 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:29:50.048643 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6, now test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd)
[0m17:29:50.055210 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:29:50.055976 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:29:50.063186 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:29:50.064180 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:29:50.068025 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:29:50.069341 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:29:50.074286 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:29:50.075481 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:29:50.076309 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: BEGIN
[0m17:29:50.076980 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:50.078236 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:29:50.078868 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: BEGIN
[0m17:29:50.079439 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:50.080261 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:29:50.080884 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:29:50.081511 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_wilder"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:29:50.082380 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:29:50.083629 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:29:50.084470 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_wilder"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:29:51.093280 [debug] [Thread-3 (]: SQL status: OK in 1.129 seconds
[0m17:29:51.101349 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: ROLLBACK
[0m17:29:51.103647 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda'
[0m17:29:51.105034 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: Close
[0m17:29:51.108251 [info ] [Thread-3 (]: 39 of 46 PASS not_null_int__rsi_wilder_gain .................................... [[32mPASS[0m in 1.18s]
[0m17:29:51.111536 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:29:51.113283 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:29:51.115160 [info ] [Thread-3 (]: 43 of 46 START test not_null_int__rsi_wilder_trade_date ........................ [RUN]
[0m17:29:51.117436 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda, now test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c)
[0m17:29:51.119213 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:29:51.135305 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:29:51.137349 [debug] [Thread-1 (]: SQL status: OK in 1.090 seconds
[0m17:29:51.140562 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:29:51.154301 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:29:51.156613 [debug] [Thread-2 (]: SQL status: OK in 1.071 seconds
[0m17:29:51.163447 [debug] [Thread-4 (]: SQL status: OK in 1.079 seconds
[0m17:29:51.166009 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: ROLLBACK
[0m17:29:51.172536 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56'
[0m17:29:51.175135 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: Close
[0m17:29:51.177465 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:29:51.183361 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: ROLLBACK
[0m17:29:51.189751 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: ROLLBACK
[0m17:29:51.191491 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: BEGIN
[0m17:29:51.193799 [info ] [Thread-1 (]: 40 of 46 PASS not_null_int__rsi_wilder_loss .................................... [[32mPASS[0m in 1.19s]
[0m17:29:51.196947 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d'
[0m17:29:51.199541 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd'
[0m17:29:51.201258 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:51.204004 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:29:51.205697 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: Close
[0m17:29:51.207452 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: Close
[0m17:29:51.210611 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:29:51.213173 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m17:29:51.215060 [info ] [Thread-1 (]: 44 of 46 START test not_null_int__rsi_wilder_wilder_gain ....................... [RUN]
[0m17:29:51.222555 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:29:51.217199 [info ] [Thread-4 (]: 41 of 46 PASS not_null_int__rsi_wilder_rn ...................................... [[32mPASS[0m in 1.17s]
[0m17:29:51.224918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9)
[0m17:29:51.226834 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_wilder"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:29:51.220103 [info ] [Thread-2 (]: 42 of 46 PASS not_null_int__rsi_wilder_ticker .................................. [[32mPASS[0m in 1.17s]
[0m17:29:51.230093 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:29:51.231990 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:29:51.237126 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:29:51.239412 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:29:51.256692 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:29:51.258827 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:29:51.260870 [info ] [Thread-4 (]: 45 of 46 START test not_null_int__rsi_wilder_wilder_loss ....................... [RUN]
[0m17:29:51.266138 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb)
[0m17:29:51.269676 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:29:51.263639 [info ] [Thread-2 (]: 46 of 46 START test wilder_seed_equals_sma ..................................... [RUN]
[0m17:29:51.276989 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:29:51.289593 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:29:51.291430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd, now test.portfolio_project_2.wilder_seed_equals_sma)
[0m17:29:51.304031 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:29:51.306334 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:29:51.309583 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:29:51.326419 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:29:51.332293 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:29:51.335816 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:29:51.337548 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: BEGIN
[0m17:29:51.339833 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:29:51.342175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:51.344066 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: BEGIN
[0m17:29:51.346677 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:51.348310 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:29:51.358854 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:29:51.360547 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m17:29:51.362756 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:29:51.364403 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m17:29:51.366124 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_gain
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_gain is null



  
  
      
    ) dbt_internal_test
[0m17:29:51.368285 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:29:51.371017 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_loss is null



  
  
      
    ) dbt_internal_test
[0m17:29:51.373453 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:29:51.375111 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: BEGIN
[0m17:29:51.376651 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:51.381295 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:29:51.382909 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:29:51.385081 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.wilder_seed_equals_sma"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- asserts the seed matches SMA at rn=14
with w as (
  select ticker, trade_date, wilder_gain, wilder_loss
  from "finance"."analytics_dev"."int__rsi_wilder"
  where rn = 14
),
s as (
  select ticker, trade_date, sma_gain, sma_loss
  from "finance"."analytics_dev"."int__rsi_sma"
  where rn = 14
)
select
  w.ticker,
  w.trade_date
from w
join s using (ticker, trade_date)
where abs(w.wilder_gain - s.sma_gain) > 1e-9
   or abs(w.wilder_loss - s.sma_loss) > 1e-9
  
  
      
    ) dbt_internal_test
[0m17:29:52.446461 [debug] [Thread-3 (]: SQL status: OK in 1.212 seconds
[0m17:29:52.455685 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: ROLLBACK
[0m17:29:52.458210 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c'
[0m17:29:52.459768 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: Close
[0m17:29:52.463249 [info ] [Thread-3 (]: 43 of 46 PASS not_null_int__rsi_wilder_trade_date .............................. [[32mPASS[0m in 1.35s]
[0m17:29:52.466428 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:29:52.652562 [debug] [Thread-1 (]: SQL status: OK in 1.282 seconds
[0m17:29:52.654287 [debug] [Thread-2 (]: SQL status: OK in 1.267 seconds
[0m17:29:52.655906 [debug] [Thread-4 (]: SQL status: OK in 1.283 seconds
[0m17:29:52.665148 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: ROLLBACK
[0m17:29:52.675203 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: ROLLBACK
[0m17:29:52.677424 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9'
[0m17:29:52.670546 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: ROLLBACK
[0m17:29:52.681148 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.wilder_seed_equals_sma'
[0m17:29:52.682787 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: Close
[0m17:29:52.684924 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: Close
[0m17:29:52.687454 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb'
[0m17:29:52.689720 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: Close
[0m17:29:52.692014 [info ] [Thread-2 (]: 46 of 46 PASS wilder_seed_equals_sma ........................................... [[32mPASS[0m in 1.40s]
[0m17:29:52.699120 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:29:52.694278 [info ] [Thread-1 (]: 44 of 46 PASS not_null_int__rsi_wilder_wilder_gain ............................. [[32mPASS[0m in 1.47s]
[0m17:29:52.696842 [info ] [Thread-4 (]: 45 of 46 PASS not_null_int__rsi_wilder_wilder_loss ............................. [[32mPASS[0m in 1.43s]
[0m17:29:52.704023 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:29:52.706598 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:29:52.712729 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:52.714180 [debug] [MainThread]: On master: BEGIN
[0m17:29:52.715411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:29:52.719522 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:29:52.720905 [debug] [MainThread]: On master: COMMIT
[0m17:29:52.722196 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:52.723417 [debug] [MainThread]: On master: COMMIT
[0m17:29:52.725826 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:29:52.727139 [debug] [MainThread]: On master: Close
[0m17:29:52.728747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:52.729956 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:29:52.731132 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9' was properly closed.
[0m17:29:52.732345 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c' was properly closed.
[0m17:29:52.733966 [debug] [MainThread]: Connection 'test.portfolio_project_2.wilder_seed_equals_sma' was properly closed.
[0m17:29:52.735173 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb' was properly closed.
[0m17:29:52.736684 [info ] [MainThread]: 
[0m17:29:52.738595 [info ] [MainThread]: Finished running 46 data tests in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m17:29:52.771751 [debug] [MainThread]: Command end result
[0m17:29:52.898188 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:29:52.903921 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:29:52.924564 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:29:52.925475 [info ] [MainThread]: 
[0m17:29:52.926753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:29:52.927989 [info ] [MainThread]: 
[0m17:29:52.929226 [info ] [MainThread]: Done. PASS=46 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=46
[0m17:29:52.931011 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:29:52.933867 [debug] [MainThread]: Command `-c test` succeeded at 17:29:52.933505 after 13.52 seconds
[0m17:29:52.934845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD3702620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD5109B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD5109450>]}
[0m17:29:52.935770 [debug] [MainThread]: Flushing usage events
[0m17:29:54.122601 [debug] [MainThread]: An error was encountered while trying to flush usage events
