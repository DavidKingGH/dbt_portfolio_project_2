[0m15:40:55.177027 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m15:40:55.311753 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m15:40:55.324685 [debug] [Thread-2 (]: SQL status: OK in 0.150 seconds
[0m15:40:55.328017 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m15:40:55.336362 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m15:40:55.337561 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m15:40:55.338647 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m15:40:55.466013 [debug] [Thread-2 (]: SQL status: OK in 0.125 seconds
[0m15:40:55.475261 [debug] [Thread-1 (]: SQL status: OK in 0.135 seconds
[0m15:40:55.477183 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m15:40:55.484449 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m15:40:55.485521 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m15:40:55.486575 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m15:40:55.597723 [debug] [Thread-2 (]: SQL status: OK in 0.110 seconds
[0m15:40:55.601200 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m15:40:55.602106 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m15:40:55.603224 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m15:40:55.606386 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m15:40:55.608683 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m15:40:55.609555 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m15:40:55.610233 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m15:40:55.768555 [debug] [Thread-1 (]: SQL status: OK in 0.158 seconds
[0m15:40:55.774642 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m15:40:55.775650 [debug] [Thread-2 (]: SQL status: OK in 0.171 seconds
[0m15:40:55.776713 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m15:40:55.781253 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m15:40:55.782582 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m15:40:55.943562 [debug] [Thread-2 (]: SQL status: OK in 0.160 seconds
[0m15:40:55.947962 [debug] [Thread-1 (]: SQL status: OK in 0.166 seconds
[0m15:40:55.949759 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m15:40:55.953368 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m15:40:55.954790 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70fd3fac-5b33-4063-9be3-ee248b91c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF5E04C130>]}
[0m15:40:55.956528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70fd3fac-5b33-4063-9be3-ee248b91c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF5E05E9E0>]}
[0m15:40:55.959417 [info ] [Thread-2 (]: 5 of 11 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.83s]
[0m15:40:55.964316 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m15:40:55.961478 [info ] [Thread-1 (]: 6 of 11 OK created sql view model analytics_dev.int__regime_classification ..... [[32mOK[0m in 0.83s]
[0m15:40:55.967870 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m15:40:55.969628 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m15:40:55.972473 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m15:40:55.971234 [info ] [Thread-3 (]: 7 of 11 START sql view model analytics_dev.int__rsi_sma ........................ [RUN]
[0m15:40:55.975282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now model.portfolio_project_2.int__rsi_sma)
[0m15:40:55.974132 [info ] [Thread-4 (]: 8 of 11 START sql view model analytics_dev.int__regime_changes ................. [RUN]
[0m15:40:55.976600 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m15:40:55.977678 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now model.portfolio_project_2.int__regime_changes)
[0m15:40:55.989577 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m15:40:55.988057 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m15:40:55.998520 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m15:40:56.002855 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m15:40:56.016343 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m15:40:56.021586 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m15:40:56.034773 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m15:40:56.038091 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m15:40:56.039854 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m15:40:56.041439 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m15:40:56.042801 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m15:40:56.044128 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:40:56.045626 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:40:56.049826 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:40:56.050968 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:40:56.052216 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m15:40:56.053497 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m15:40:56.055274 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m15:40:56.057403 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    sma_gain::decimal(18,2) as sma_gain,
    sma_loss::decimal(18,2) as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m15:40:56.304447 [debug] [Thread-3 (]: SQL status: OK in 0.245 seconds
[0m15:40:56.310158 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m15:40:56.311178 [debug] [Thread-4 (]: SQL status: OK in 0.252 seconds
[0m15:40:56.312297 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m15:40:56.323045 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m15:40:56.324959 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m15:40:56.413675 [debug] [Thread-3 (]: SQL status: OK in 0.089 seconds
[0m15:40:56.424798 [debug] [Thread-4 (]: SQL status: OK in 0.098 seconds
[0m15:40:56.427961 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m15:40:56.439796 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m15:40:56.441307 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m15:40:56.443196 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m15:40:56.574076 [debug] [Thread-3 (]: SQL status: OK in 0.130 seconds
[0m15:40:56.577621 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m15:40:56.578726 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m15:40:56.579725 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m15:40:56.585675 [debug] [Thread-4 (]: SQL status: OK in 0.141 seconds
[0m15:40:56.588490 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m15:40:56.589944 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m15:40:56.590677 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m15:40:56.715806 [debug] [Thread-3 (]: SQL status: OK in 0.135 seconds
[0m15:40:56.728624 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m15:40:56.730191 [debug] [Thread-4 (]: SQL status: OK in 0.139 seconds
[0m15:40:56.731337 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m15:40:56.738967 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m15:40:56.740995 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m15:40:56.879837 [debug] [Thread-3 (]: SQL status: OK in 0.139 seconds
[0m15:40:56.881250 [debug] [Thread-4 (]: SQL status: OK in 0.139 seconds
[0m15:40:56.886878 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m15:40:56.891205 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m15:40:56.892453 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70fd3fac-5b33-4063-9be3-ee248b91c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF5C30F650>]}
[0m15:40:56.895194 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70fd3fac-5b33-4063-9be3-ee248b91c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF5C30F650>]}
[0m15:40:56.893939 [info ] [Thread-3 (]: 7 of 11 OK created sql view model analytics_dev.int__rsi_sma ................... [[32mOK[0m in 0.92s]
[0m15:40:56.898905 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m15:40:56.897015 [info ] [Thread-4 (]: 8 of 11 OK created sql view model analytics_dev.int__regime_changes ............ [[32mOK[0m in 0.92s]
[0m15:40:56.902124 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m15:40:56.904080 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m15:40:56.907372 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m15:40:56.905858 [info ] [Thread-2 (]: 9 of 11 START sql view model analytics_dev.int__rsi_wilder ..................... [RUN]
[0m15:40:56.910117 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now model.portfolio_project_2.int__rsi_wilder)
[0m15:40:56.909091 [info ] [Thread-1 (]: 10 of 11 START sql incremental model analytics_dev.mrt__stocks_with_regimes .... [RUN]
[0m15:40:56.912042 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m15:40:56.913624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_classification, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m15:40:56.924607 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m15:40:56.926382 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m15:40:56.959964 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:56.961663 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m15:40:56.972245 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m15:40:56.973767 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m15:40:56.987329 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:56.988386 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__ee95eff4e998" cascade
    
[0m15:40:56.989356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:56.990776 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m15:40:56.992697 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m15:40:56.994117 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:40:56.997301 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:40:56.998629 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m15:40:57.000254 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    wilder_gain::decimal(18,2) as wilder_gain,
    wilder_loss::decimal(18,2) as wilder_loss
from wilder
  );

[0m15:40:57.047894 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m15:40:57.121128 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:57.122971 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m15:40:57.128427 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:40:57.133845 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:57.135587 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m15:40:57.138292 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:40:57.139414 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:57.141009 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m15:40:57.145217 [debug] [Thread-2 (]: SQL status: OK in 0.144 seconds
[0m15:40:57.155894 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m15:40:57.157029 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m15:40:57.200931 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m15:40:57.206037 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:57.207205 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m15:40:57.208362 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:40:57.211476 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m15:40:57.212508 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:57.213423 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m15:40:57.241959 [debug] [Thread-2 (]: SQL status: OK in 0.084 seconds
[0m15:40:57.249731 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m15:40:57.251084 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m15:40:57.270146 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m15:40:57.313425 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:57.314346 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:40:57.324526 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m15:40:57.337672 [debug] [Thread-2 (]: SQL status: OK in 0.085 seconds
[0m15:40:57.352202 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m15:40:57.359007 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m15:40:57.359780 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:57.360545 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m15:40:57.361386 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,0))
 as volume, 
      
    cast(null as text)
 as regime
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:40:57.364911 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:40:57.419450 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:57.420320 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."mrt__stocks_with_regimes__ee95eff4e998"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null
    
    )
 ;
    insert into "finance"."dbt_temp"."mrt__stocks_with_regimes__ee95eff4e998" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m15:40:57.650722 [debug] [Thread-2 (]: SQL status: OK in 0.288 seconds
[0m15:40:57.657095 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m15:40:57.658044 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m15:40:57.881398 [debug] [Thread-2 (]: SQL status: OK in 0.222 seconds
[0m15:40:57.885094 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m15:40:57.886385 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70fd3fac-5b33-4063-9be3-ee248b91c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF5C30FAD0>]}
[0m15:40:57.887864 [info ] [Thread-2 (]: 9 of 11 OK created sql view model analytics_dev.int__rsi_wilder ................ [[32mOK[0m in 0.98s]
[0m15:40:57.890048 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m15:40:57.891659 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.fct__rsi
[0m15:40:57.893203 [info ] [Thread-3 (]: 11 of 11 START sql incremental model analytics_dev.fct__rsi .................... [RUN]
[0m15:40:57.895162 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_sma, now model.portfolio_project_2.fct__rsi)
[0m15:40:57.896401 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m15:40:57.909863 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m15:40:57.912687 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m15:40:57.925835 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:40:57.927410 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__7f2909844585" cascade
    
[0m15:40:57.928357 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:40:58.009946 [debug] [Thread-3 (]: SQL status: OK in 0.081 seconds
[0m15:40:58.013125 [debug] [Thread-1 (]: SQL status: OK in 0.591 seconds
[0m15:40:58.026221 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:40:58.045624 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m15:40:58.072912 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:58.074947 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m15:40:58.076707 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m15:40:58.085077 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:40:58.087379 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m15:40:58.089566 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m15:40:58.092174 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:58.095166 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__ee95eff4e998'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m15:40:58.099280 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:40:58.101078 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:40:58.102895 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m15:40:58.127765 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m15:40:58.141961 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:58.143065 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m15:40:58.157379 [debug] [Thread-3 (]: SQL status: OK in 0.053 seconds
[0m15:40:58.160249 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:40:58.161272 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m15:40:58.162205 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    

  
[0m15:40:58.163753 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m15:40:58.169158 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m15:40:58.183674 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:40:58.206360 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m15:40:58.209939 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:58.211523 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__ee95eff4e998'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m15:40:58.231551 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m15:40:58.239315 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:58.240425 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m15:40:58.257953 [debug] [Thread-3 (]: SQL status: OK in 0.047 seconds
[0m15:40:58.260003 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:40:58.261591 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:40:58.264317 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m15:40:58.300153 [debug] [Thread-1 (]: 
    In "finance"."analytics_dev"."mrt__stocks_with_regimes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:40:58.301712 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:58.302713 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m15:40:58.303654 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
SELECT version()
[0m15:40:58.306593 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:40:58.344905 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:40:58.359362 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as sma_rs, 
      
    cast(null as decimal(18,2))
 as sma_rsi, 
      
    cast(null as decimal(18,2))
 as wilder_rs, 
      
    cast(null as decimal(18,2))
 as wilder_rsi
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:40:58.406799 [debug] [Thread-3 (]: SQL status: OK in 0.032 seconds
[0m15:40:58.443432 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:40:58.449044 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."fct__rsi__7f2909844585"
  
  (
    trade_date date not null,
    ticker text not null,
    sma_rs decimal(18,2),
    sma_rsi decimal(18,2),
    wilder_rs decimal(18,2),
    wilder_rsi decimal(18,2)
    
    )
 ;
    insert into "finance"."dbt_temp"."fct__rsi__7f2909844585" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      sma_rs ,
    
      
      sma_rsi ,
    
      
      wilder_rs ,
    
      
      wilder_rsi 
    
  )
 (
      
    select trade_date, ticker, sma_rs, sma_rsi, wilder_rs, wilder_rsi
    from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as model_subq
    );
  
  
  
[0m15:40:58.477604 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:58.479596 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:58.480890 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */


    MERGE INTO "finance"."analytics_dev"."mrt__stocks_with_regimes" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."mrt__stocks_with_regimes__ee95eff4e998" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m15:40:58.650435 [debug] [Thread-1 (]: SQL status: OK in 0.168 seconds
[0m15:40:58.653667 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m15:40:58.654473 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:58.655119 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m15:40:58.714527 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m15:40:58.722006 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:58.722758 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__ee95eff4e998" cascade
    
[0m15:40:58.867599 [debug] [Thread-1 (]: SQL status: OK in 0.144 seconds
[0m15:40:58.872701 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m15:40:58.873353 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__ee95eff4e998" cascade
    
[0m15:40:58.932725 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m15:40:58.935835 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m15:40:58.936830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70fd3fac-5b33-4063-9be3-ee248b91c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF5E0E3110>]}
[0m15:40:58.938008 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes  [[32mOK[0m in 2.02s]
[0m15:40:58.939982 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m15:41:00.160146 [debug] [Thread-3 (]: SQL status: OK in 1.696 seconds
[0m15:41:00.166454 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:41:00.167674 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m15:41:00.170100 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:41:00.170822 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:41:00.171463 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__7f2909844585'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m15:41:00.187177 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m15:41:00.194231 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:41:00.194960 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m15:41:00.205115 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m15:41:00.211037 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:41:00.211838 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__7f2909844585'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m15:41:00.222248 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m15:41:00.228984 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:41:00.229935 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m15:41:00.237916 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:41:00.241586 [debug] [Thread-3 (]: 
    In "finance"."analytics_dev"."fct__rsi":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:41:00.244225 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m15:41:00.246072 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:41:00.246764 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */


    MERGE INTO "finance"."analytics_dev"."fct__rsi" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."fct__rsi__7f2909844585" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m15:41:00.308183 [debug] [Thread-3 (]: SQL status: OK in 0.060 seconds
[0m15:41:00.314567 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m15:41:00.316837 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:41:00.318359 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m15:41:00.374524 [debug] [Thread-3 (]: SQL status: OK in 0.055 seconds
[0m15:41:00.378919 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:41:00.380219 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__7f2909844585" cascade
    
[0m15:41:00.539702 [debug] [Thread-3 (]: SQL status: OK in 0.158 seconds
[0m15:41:00.546172 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m15:41:00.547098 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__7f2909844585" cascade
    
[0m15:41:00.596696 [debug] [Thread-3 (]: SQL status: OK in 0.049 seconds
[0m15:41:00.599830 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: Close
[0m15:41:00.600746 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70fd3fac-5b33-4063-9be3-ee248b91c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF5E0E0B90>]}
[0m15:41:00.601724 [info ] [Thread-3 (]: 11 of 11 OK created sql incremental model analytics_dev.fct__rsi ............... [[32mOK[0m in 2.71s]
[0m15:41:00.603130 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m15:41:00.605579 [debug] [MainThread]: Using duckdb connection "master"
[0m15:41:00.606189 [debug] [MainThread]: On master: BEGIN
[0m15:41:00.606702 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:41:00.608754 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:41:00.609361 [debug] [MainThread]: On master: COMMIT
[0m15:41:00.609922 [debug] [MainThread]: Using duckdb connection "master"
[0m15:41:00.610439 [debug] [MainThread]: On master: COMMIT
[0m15:41:00.611758 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:41:00.612353 [debug] [MainThread]: On master: Close
[0m15:41:00.613534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:00.614629 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m15:41:00.615504 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m15:41:00.616336 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m15:41:00.617128 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m15:41:00.617704 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m15:41:00.618214 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m15:41:00.618719 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m15:41:00.619931 [info ] [MainThread]: 
[0m15:41:00.620963 [info ] [MainThread]: Finished running 2 incremental models, 9 view models in 0 hours 0 minutes and 8.99 seconds (8.99s).
[0m15:41:00.625378 [debug] [MainThread]: Command end result
[0m15:41:00.752490 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m15:41:00.757510 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m15:41:00.769138 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m15:41:00.769877 [info ] [MainThread]: 
[0m15:41:00.771094 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:41:00.772228 [info ] [MainThread]: 
[0m15:41:00.773085 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m15:41:00.774864 [debug] [MainThread]: Command `-c run` succeeded at 15:41:00.774659 after 11.66 seconds
[0m15:41:00.775507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF5A6F23F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF5C2F2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF5E0E0110>]}
[0m15:41:00.776116 [debug] [MainThread]: Flushing usage events
[0m15:41:02.209156 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:41:22.690626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A7FCB8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A014E42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A01B23ED0>]}


============================== 15:41:22.699257 | 6001e19a-2de2-4635-9737-63ba18f772b1 ==============================
[0m15:41:22.699257 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:41:22.700617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'invocation_command': 'dbt test', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:41:23.019772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6001e19a-2de2-4635-9737-63ba18f772b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A7FE70180>]}
[0m15:41:23.094818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6001e19a-2de2-4635-9737-63ba18f772b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A019CB790>]}
[0m15:41:23.098061 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:41:23.411983 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:41:23.715747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:41:23.716204 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:41:23.811203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6001e19a-2de2-4635-9737-63ba18f772b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0347CC50>]}
[0m15:41:24.068353 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m15:41:24.071378 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m15:41:24.157762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6001e19a-2de2-4635-9737-63ba18f772b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A030D7020>]}
[0m15:41:24.158474 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m15:41:24.159339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6001e19a-2de2-4635-9737-63ba18f772b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A01B1DA90>]}
[0m15:41:24.169030 [info ] [MainThread]: 
[0m15:41:24.169821 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:41:24.170355 [info ] [MainThread]: 
[0m15:41:24.171208 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:41:24.178779 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m15:41:24.192986 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m15:41:24.292316 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m15:41:24.292853 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m15:41:24.293225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:24.294203 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m15:41:24.294634 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m15:41:24.295035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:25.920093 [debug] [ThreadPool]: SQL status: OK in 1.625 seconds
[0m15:41:25.920776 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m15:41:25.921458 [debug] [ThreadPool]: SQL status: OK in 1.628 seconds
[0m15:41:25.922227 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m15:41:25.923065 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m15:41:25.924283 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m15:41:26.004246 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m15:41:26.004840 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m15:41:26.007167 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m15:41:26.009525 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m15:41:26.011213 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m15:41:26.011677 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m15:41:26.012537 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m15:41:26.014378 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m15:41:26.019022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6001e19a-2de2-4635-9737-63ba18f772b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A037D2340>]}
[0m15:41:26.019733 [debug] [MainThread]: Using duckdb connection "master"
[0m15:41:26.020187 [debug] [MainThread]: On master: BEGIN
[0m15:41:26.020552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:41:26.021879 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:41:26.022278 [debug] [MainThread]: On master: COMMIT
[0m15:41:26.022662 [debug] [MainThread]: Using duckdb connection "master"
[0m15:41:26.023026 [debug] [MainThread]: On master: COMMIT
[0m15:41:26.023916 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:41:26.024377 [debug] [MainThread]: On master: Close
[0m15:41:26.036647 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m15:41:26.037814 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.assert_regime_threshold_ordering
[0m15:41:26.038912 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m15:41:26.040992 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m15:41:26.039998 [info ] [Thread-1 (]: 1 of 111 START test accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis  [RUN]
[0m15:41:26.042492 [info ] [Thread-4 (]: 4 of 111 START test assert_regime_threshold_ordering ........................... [RUN]
[0m15:41:26.043559 [info ] [Thread-3 (]: 3 of 111 START test accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis  [RUN]
[0m15:41:26.046592 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47'
[0m15:41:26.048222 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.assert_regime_threshold_ordering'
[0m15:41:26.044973 [info ] [Thread-2 (]: 2 of 111 START test accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis  [RUN]
[0m15:41:26.050019 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8'
[0m15:41:26.051181 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m15:41:26.052320 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.assert_regime_threshold_ordering
[0m15:41:26.053708 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b'
[0m15:41:26.054834 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m15:41:26.086264 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m15:41:26.107449 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m15:41:26.108567 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m15:41:26.119148 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8"
[0m15:41:26.130347 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m15:41:26.132659 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m15:41:26.145533 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.assert_regime_threshold_ordering
[0m15:41:26.198214 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m15:41:26.199709 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m15:41:26.201220 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m15:41:26.202075 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m15:41:26.207177 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8"
[0m15:41:26.212601 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m15:41:26.214214 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m15:41:26.215472 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: BEGIN
[0m15:41:26.216518 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m15:41:26.217477 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:41:26.218575 [debug] [Thread-1 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: BEGIN
[0m15:41:26.220820 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m15:41:26.221938 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8"
[0m15:41:26.222999 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:41:26.224010 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:41:26.224991 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: BEGIN
[0m15:41:26.225967 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8: BEGIN
[0m15:41:26.227351 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m15:41:26.228333 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:41:26.229313 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:41:26.230340 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:41:26.231322 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.assert_regime_threshold_ordering"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select
    version_id,
    complacent_max,
    normal_max,
    elevated_max
from "finance"."analytics_dev"."regime_thresholds"
where not (complacent_max < normal_max and normal_max < elevated_max)
  
  
      
    ) dbt_internal_test
[0m15:41:26.233309 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m15:41:26.234860 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:41:26.235841 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:41:26.237010 [debug] [Thread-1 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regime as value_field,
        count(*) as n_records

    from "finance"."analytics_dev"."int__regime_changes"
    group by regime

)

select *
from all_values
where value_field not in (
    'complacent','normal','elevated','crisis'
)



  
  
      
    ) dbt_internal_test
[0m15:41:26.238200 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m15:41:26.239354 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8"
[0m15:41:26.241098 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regime as value_field,
        count(*) as n_records

    from "finance"."analytics_dev"."int__regime_classification"
    group by regime

)

select *
from all_values
where value_field not in (
    'complacent','normal','elevated','crisis'
)



  
  
      
    ) dbt_internal_test
[0m15:41:26.242370 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regime as value_field,
        count(*) as n_records

    from "finance"."analytics_dev"."mrt__stocks_with_regimes"
    group by regime

)

select *
from all_values
where value_field not in (
    'complacent','normal','elevated','crisis'
)



  
  
      
    ) dbt_internal_test
[0m15:41:26.290695 [debug] [Thread-4 (]: SQL status: OK in 0.056 seconds
[0m15:41:26.312496 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: ROLLBACK
[0m15:41:26.314289 [debug] [Thread-3 (]: SQL status: OK in 0.070 seconds
[0m15:41:26.317419 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.assert_regime_threshold_ordering'
[0m15:41:26.319108 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: Close
[0m15:41:26.324896 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8: ROLLBACK
[0m15:41:26.330132 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8'
[0m15:41:26.331806 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8: Close
[0m15:41:26.327240 [info ] [Thread-4 (]: 4 of 111 PASS assert_regime_threshold_ordering ................................. [[32mPASS[0m in 0.28s]
[0m15:41:26.335050 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.assert_regime_threshold_ordering
[0m15:41:26.339228 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m15:41:26.337451 [info ] [Thread-3 (]: 3 of 111 PASS accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis  [[32mPASS[0m in 0.29s]
[0m15:41:26.344438 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m15:41:26.341357 [info ] [Thread-4 (]: 5 of 111 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [RUN]
[0m15:41:26.346802 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m15:41:26.348986 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.assert_regime_threshold_ordering, now test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a)
[0m15:41:26.350994 [info ] [Thread-3 (]: 6 of 111 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [RUN]
[0m15:41:26.353342 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m15:41:26.355361 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8, now test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2)
[0m15:41:26.369735 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m15:41:26.400871 [debug] [Thread-1 (]: SQL status: OK in 0.160 seconds
[0m15:41:26.419713 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m15:41:26.420740 [debug] [Thread-2 (]: SQL status: OK in 0.177 seconds
[0m15:41:26.422109 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m15:41:26.425218 [debug] [Thread-1 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: ROLLBACK
[0m15:41:26.428136 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: ROLLBACK
[0m15:41:26.429267 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47'
[0m15:41:26.430754 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b'
[0m15:41:26.431937 [debug] [Thread-1 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: Close
[0m15:41:26.433079 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: Close
[0m15:41:26.434932 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m15:41:26.436189 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m15:41:26.443819 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m15:41:26.437623 [info ] [Thread-1 (]: 1 of 111 PASS accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis  [[32mPASS[0m in 0.39s]
[0m15:41:26.451524 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m15:41:26.445169 [info ] [Thread-2 (]: 2 of 111 PASS accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis  [[32mPASS[0m in 0.39s]
[0m15:41:26.453777 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m15:41:26.455816 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m15:41:26.457010 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m15:41:26.458150 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m15:41:26.459458 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m15:41:26.460807 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: BEGIN
[0m15:41:26.462000 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m15:41:26.463088 [info ] [Thread-1 (]: 7 of 111 START test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ........... [RUN]
[0m15:41:26.465429 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:26.466619 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: BEGIN
[0m15:41:26.464086 [info ] [Thread-2 (]: 8 of 111 START test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ........ [RUN]
[0m15:41:26.468094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47, now test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a)
[0m15:41:26.469632 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:26.470748 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b, now test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0)
[0m15:41:26.471960 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m15:41:26.473086 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m15:41:26.474680 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m15:41:26.498456 [debug] [Thread-4 (]: SQL status: OK in 0.029 seconds
[0m15:41:26.501306 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m15:41:26.502360 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m15:41:26.506797 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m15:41:26.513948 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m15:41:26.515510 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and wilder_rsi >= 0 and wilder_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m15:41:26.516905 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and sma_rsi >= 0 and sma_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m15:41:26.519119 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m15:41:26.526777 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m15:41:26.527866 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m15:41:26.534621 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m15:41:26.536597 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m15:41:26.537622 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: BEGIN
[0m15:41:26.538965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:26.540539 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m15:41:26.542161 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: BEGIN
[0m15:41:26.543145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:26.544477 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:41:26.545506 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m15:41:26.546558 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where sma_rs is not null) dbt_subquery

where not(sma_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:26.547623 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:41:26.549111 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m15:41:26.550186 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where wilder_rs is not null) dbt_subquery

where not(wilder_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:26.587847 [debug] [Thread-4 (]: SQL status: OK in 0.067 seconds
[0m15:41:26.589217 [debug] [Thread-3 (]: SQL status: OK in 0.071 seconds
[0m15:41:26.602350 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: ROLLBACK
[0m15:41:26.605334 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: ROLLBACK
[0m15:41:26.608343 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2'
[0m15:41:26.610677 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a'
[0m15:41:26.612415 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: Close
[0m15:41:26.614575 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: Close
[0m15:41:26.618423 [info ] [Thread-3 (]: 6 of 111 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[32mPASS[0m in 0.26s]
[0m15:41:26.623573 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m15:41:26.620596 [info ] [Thread-4 (]: 5 of 111 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[32mPASS[0m in 0.27s]
[0m15:41:26.625908 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m15:41:26.628823 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m15:41:26.633315 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m15:41:26.631082 [info ] [Thread-3 (]: 9 of 111 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m15:41:26.635729 [info ] [Thread-4 (]: 10 of 111 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m15:41:26.638320 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7)
[0m15:41:26.640755 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e)
[0m15:41:26.642756 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m15:41:26.644611 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m15:41:26.654790 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m15:41:26.661744 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m15:41:26.662993 [debug] [Thread-2 (]: SQL status: OK in 0.112 seconds
[0m15:41:26.672095 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m15:41:26.676510 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: ROLLBACK
[0m15:41:26.679238 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: ROLLBACK
[0m15:41:26.680682 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a'
[0m15:41:26.681764 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: Close
[0m15:41:26.683001 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0'
[0m15:41:26.684108 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: Close
[0m15:41:26.685423 [info ] [Thread-1 (]: 7 of 111 PASS dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ................. [[32mPASS[0m in 0.22s]
[0m15:41:26.687586 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m15:41:26.688542 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m15:41:26.690840 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m15:41:26.691694 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m15:41:26.696913 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m15:41:26.689825 [info ] [Thread-2 (]: 8 of 111 PASS dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 .............. [[32mPASS[0m in 0.22s]
[0m15:41:26.703760 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m15:41:26.698357 [info ] [Thread-1 (]: 11 of 111 START test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [RUN]
[0m15:41:26.705744 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m15:41:26.707083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd)
[0m15:41:26.708254 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m15:41:26.709217 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m15:41:26.710415 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m15:41:26.711331 [info ] [Thread-2 (]: 12 of 111 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .. [RUN]
[0m15:41:26.722714 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m15:41:26.723728 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m15:41:26.724716 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m15:41:26.725778 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m15:41:26.727042 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:26.728014 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m15:41:26.729096 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m15:41:26.730484 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m15:41:26.731511 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:26.733773 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:41:26.741079 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m15:41:26.746756 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m15:41:26.748421 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m15:41:26.749761 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m15:41:26.751244 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m15:41:26.752454 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m15:41:26.754320 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m15:41:26.755831 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m15:41:26.756928 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m15:41:26.762001 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m15:41:26.763409 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: BEGIN
[0m15:41:26.764624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:26.766632 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m15:41:26.767478 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m15:41:26.768205 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:41:26.769021 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:26.769865 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m15:41:26.770983 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(abs(delta) - (gain + loss)) <= 1e-9)


  
  
      
    ) dbt_internal_test
[0m15:41:26.771977 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:41:26.772646 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m15:41:26.773239 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:26.842353 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m15:41:26.844454 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m15:41:26.846170 [debug] [Thread-4 (]: SQL status: OK in 0.083 seconds
[0m15:41:26.848170 [debug] [Thread-3 (]: SQL status: OK in 0.094 seconds
[0m15:41:26.853870 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: ROLLBACK
[0m15:41:26.859648 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m15:41:26.865822 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m15:41:26.873341 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd'
[0m15:41:26.871797 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m15:41:26.877534 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m15:41:26.879973 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m15:41:26.882242 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: Close
[0m15:41:26.885080 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m15:41:26.886766 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m15:41:26.888587 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m15:41:26.890630 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m15:41:26.893134 [info ] [Thread-1 (]: 11 of 111 PASS dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[32mPASS[0m in 0.19s]
[0m15:41:26.896762 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m15:41:26.898286 [info ] [Thread-4 (]: 10 of 111 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.26s]
[0m15:41:26.906032 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m15:41:26.900509 [info ] [Thread-3 (]: 9 of 111 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.26s]
[0m15:41:26.909602 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m15:41:26.902655 [info ] [Thread-2 (]: 12 of 111 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 ........ [[32mPASS[0m in 0.18s]
[0m15:41:26.914847 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m15:41:26.916649 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m15:41:26.911697 [info ] [Thread-1 (]: 13 of 111 START test dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp  [RUN]
[0m15:41:26.918794 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m15:41:26.920020 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m15:41:26.922154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a)
[0m15:41:26.921098 [info ] [Thread-4 (]: 14 of 111 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .. [RUN]
[0m15:41:26.923697 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m15:41:26.925933 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m15:41:26.925015 [info ] [Thread-3 (]: 15 of 111 START test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [RUN]
[0m15:41:26.927474 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m15:41:26.941662 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m15:41:26.928693 [info ] [Thread-2 (]: 16 of 111 START test dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0  [RUN]
[0m15:41:26.943250 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96)
[0m15:41:26.944450 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m15:41:26.945722 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4)
[0m15:41:26.946728 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m15:41:26.955005 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m15:41:26.956003 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m15:41:26.966865 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m15:41:26.968126 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m15:41:26.976613 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m15:41:26.981816 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m15:41:26.983103 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m15:41:26.984135 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m15:41:26.988273 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m15:41:26.992322 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m15:41:26.993466 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m15:41:26.998937 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m15:41:26.999966 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m15:41:27.001046 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: BEGIN
[0m15:41:27.001875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:27.003214 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m15:41:27.004073 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m15:41:27.004888 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m15:41:27.005546 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:27.006403 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: BEGIN
[0m15:41:27.007116 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:41:27.007868 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m15:41:27.009023 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:27.009704 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m15:41:27.010453 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: BEGIN
[0m15:41:27.011179 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:41:27.012221 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m15:41:27.013005 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:27.013777 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m15:41:27.014826 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:41:27.015885 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:27.016645 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m15:41:27.017675 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:41:27.018356 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m15:41:27.019090 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m15:41:27.020119 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_changes"

where not(days_in_regime >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:27.091276 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m15:41:27.093243 [debug] [Thread-4 (]: SQL status: OK in 0.075 seconds
[0m15:41:27.095621 [debug] [Thread-3 (]: SQL status: OK in 0.075 seconds
[0m15:41:27.097283 [debug] [Thread-2 (]: SQL status: OK in 0.076 seconds
[0m15:41:27.103104 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: ROLLBACK
[0m15:41:27.108944 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m15:41:27.114518 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: ROLLBACK
[0m15:41:27.118073 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a'
[0m15:41:27.125231 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: ROLLBACK
[0m15:41:27.120439 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m15:41:27.128896 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96'
[0m15:41:27.130613 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: Close
[0m15:41:27.133396 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4'
[0m15:41:27.135116 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m15:41:27.137445 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: Close
[0m15:41:27.139601 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: Close
[0m15:41:27.142098 [info ] [Thread-1 (]: 13 of 111 PASS dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp  [[32mPASS[0m in 0.22s]
[0m15:41:27.145762 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m15:41:27.154247 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m15:41:27.148096 [info ] [Thread-4 (]: 14 of 111 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 ........ [[32mPASS[0m in 0.22s]
[0m15:41:27.159535 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m15:41:27.150206 [info ] [Thread-2 (]: 16 of 111 PASS dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0  [[32mPASS[0m in 0.20s]
[0m15:41:27.162190 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m15:41:27.152336 [info ] [Thread-3 (]: 15 of 111 PASS dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[32mPASS[0m in 0.21s]
[0m15:41:27.165155 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m15:41:27.156824 [info ] [Thread-1 (]: 17 of 111 START test dbt_utils_expression_is_true_int__regime_changes_start_date___end_date  [RUN]
[0m15:41:27.168638 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m15:41:27.166643 [info ] [Thread-4 (]: 18 of 111 START test dbt_utils_expression_is_true_int__regime_classification_close___0  [RUN]
[0m15:41:27.170188 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m15:41:27.171603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974)
[0m15:41:27.173119 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m15:41:27.174485 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6)
[0m15:41:27.176717 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m15:41:27.175812 [info ] [Thread-2 (]: 19 of 111 START test dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp  [RUN]
[0m15:41:27.178659 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m15:41:27.177919 [info ] [Thread-3 (]: 20 of 111 START test dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date  [RUN]
[0m15:41:27.193019 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m15:41:27.193778 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed)
[0m15:41:27.199743 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m15:41:27.200520 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f)
[0m15:41:27.201337 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m15:41:27.202236 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m15:41:27.202822 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m15:41:27.208610 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m15:41:27.215639 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m15:41:27.218243 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m15:41:27.219045 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m15:41:27.222810 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m15:41:27.230006 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m15:41:27.236162 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m15:41:27.237130 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m15:41:27.243361 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m15:41:27.244557 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m15:41:27.245816 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m15:41:27.247633 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: BEGIN
[0m15:41:27.248816 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: BEGIN
[0m15:41:27.250111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:27.251295 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:27.252454 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m15:41:27.254746 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m15:41:27.256186 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: BEGIN
[0m15:41:27.257731 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: BEGIN
[0m15:41:27.258795 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m15:41:27.260111 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m15:41:27.261160 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:27.262279 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:27.263416 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m15:41:27.264554 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m15:41:27.266657 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_classification"

where not(close > 0)


  
  
      
    ) dbt_internal_test
[0m15:41:27.267972 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_changes"

where not(start_date <= end_date)


  
  
      
    ) dbt_internal_test
[0m15:41:27.269125 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m15:41:27.270546 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m15:41:27.272093 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m15:41:27.273242 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m15:41:27.274420 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_classification"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m15:41:27.275653 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_classification"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m15:41:27.341121 [debug] [Thread-4 (]: SQL status: OK in 0.071 seconds
[0m15:41:27.350495 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: ROLLBACK
[0m15:41:27.353185 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6'
[0m15:41:27.354768 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: Close
[0m15:41:27.358304 [info ] [Thread-4 (]: 18 of 111 PASS dbt_utils_expression_is_true_int__regime_classification_close___0  [[32mPASS[0m in 0.18s]
[0m15:41:27.361866 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m15:41:27.363549 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m15:41:27.365444 [info ] [Thread-4 (]: 21 of 111 START test dbt_utils_expression_is_true_int__rsi_sma_gain___0 ........ [RUN]
[0m15:41:27.367811 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6)
[0m15:41:27.370711 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m15:41:27.388356 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m15:41:27.389688 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m15:41:27.390919 [debug] [Thread-2 (]: SQL status: OK in 0.114 seconds
[0m15:41:27.392134 [debug] [Thread-3 (]: SQL status: OK in 0.115 seconds
[0m15:41:27.394908 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m15:41:27.400866 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m15:41:27.403570 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: ROLLBACK
[0m15:41:27.405630 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: ROLLBACK
[0m15:41:27.407652 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: ROLLBACK
[0m15:41:27.408606 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974'
[0m15:41:27.409476 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m15:41:27.410276 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed'
[0m15:41:27.411088 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f'
[0m15:41:27.411683 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: Close
[0m15:41:27.412368 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: BEGIN
[0m15:41:27.412930 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: Close
[0m15:41:27.413473 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: Close
[0m15:41:27.414166 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:27.415123 [info ] [Thread-1 (]: 17 of 111 PASS dbt_utils_expression_is_true_int__regime_changes_start_date___end_date  [[32mPASS[0m in 0.24s]
[0m15:41:27.417862 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m15:41:27.418421 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m15:41:27.415843 [info ] [Thread-2 (]: 19 of 111 PASS dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp  [[32mPASS[0m in 0.22s]
[0m15:41:27.419973 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m15:41:27.420610 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:41:27.421362 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m15:41:27.417039 [info ] [Thread-3 (]: 20 of 111 PASS dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date  [[32mPASS[0m in 0.22s]
[0m15:41:27.422270 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m15:41:27.423688 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m15:41:27.418910 [info ] [Thread-1 (]: 22 of 111 START test dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp  [RUN]
[0m15:41:27.424458 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:27.425282 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m15:41:27.422917 [info ] [Thread-2 (]: 23 of 111 START test dbt_utils_expression_is_true_int__rsi_sma_loss___0 ........ [RUN]
[0m15:41:27.426264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772)
[0m15:41:27.427674 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62)
[0m15:41:27.427134 [info ] [Thread-3 (]: 24 of 111 START test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [RUN]
[0m15:41:27.428453 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m15:41:27.429046 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m15:41:27.429673 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704)
[0m15:41:27.435572 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m15:41:27.440463 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m15:41:27.441074 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m15:41:27.447004 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m15:41:27.451480 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m15:41:27.456577 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m15:41:27.457333 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m15:41:27.460449 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m15:41:27.461383 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m15:41:27.464670 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m15:41:27.465430 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m15:41:27.465944 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: BEGIN
[0m15:41:27.466426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:27.467792 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m15:41:27.468548 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: BEGIN
[0m15:41:27.469034 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:27.469899 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:41:27.470446 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m15:41:27.470980 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m15:41:27.471717 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:41:27.472229 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m15:41:27.472733 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:27.473667 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m15:41:27.474197 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: BEGIN
[0m15:41:27.474683 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:27.476286 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:41:27.476832 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m15:41:27.477321 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m15:41:27.509561 [debug] [Thread-4 (]: SQL status: OK in 0.082 seconds
[0m15:41:27.515135 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: ROLLBACK
[0m15:41:27.516808 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6'
[0m15:41:27.517849 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: Close
[0m15:41:27.520222 [info ] [Thread-4 (]: 21 of 111 PASS dbt_utils_expression_is_true_int__rsi_sma_gain___0 .............. [[32mPASS[0m in 0.15s]
[0m15:41:27.522278 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m15:41:27.523381 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m15:41:27.524610 [info ] [Thread-4 (]: 25 of 111 START test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 .... [RUN]
[0m15:41:27.526054 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9)
[0m15:41:27.527146 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m15:41:27.537510 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m15:41:27.539787 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m15:41:27.545655 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m15:41:27.547869 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m15:41:27.548881 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: BEGIN
[0m15:41:27.549609 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:27.551768 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:41:27.552418 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m15:41:27.553366 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:27.560210 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m15:41:27.564584 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: ROLLBACK
[0m15:41:27.565872 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772'
[0m15:41:27.566602 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: Close
[0m15:41:27.568136 [debug] [Thread-2 (]: SQL status: OK in 0.095 seconds
[0m15:41:27.572189 [debug] [Thread-3 (]: SQL status: OK in 0.094 seconds
[0m15:41:27.570358 [info ] [Thread-1 (]: 22 of 111 PASS dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp  [[32mPASS[0m in 0.14s]
[0m15:41:27.575313 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m15:41:27.580523 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: ROLLBACK
[0m15:41:27.582402 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m15:41:27.587395 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: ROLLBACK
[0m15:41:27.589719 [info ] [Thread-1 (]: 26 of 111 START test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 .... [RUN]
[0m15:41:27.591555 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62'
[0m15:41:27.593783 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704'
[0m15:41:27.595129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21)
[0m15:41:27.597180 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: Close
[0m15:41:27.599006 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: Close
[0m15:41:27.600681 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m15:41:27.616727 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m15:41:27.609625 [info ] [Thread-3 (]: 24 of 111 PASS dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[32mPASS[0m in 0.18s]
[0m15:41:27.619610 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m15:41:27.611321 [info ] [Thread-2 (]: 23 of 111 PASS dbt_utils_expression_is_true_int__rsi_sma_loss___0 .............. [[32mPASS[0m in 0.18s]
[0m15:41:27.621464 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m15:41:27.623488 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m15:41:27.624285 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m15:41:27.625906 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m15:41:27.624988 [info ] [Thread-3 (]: 27 of 111 START test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ..... [RUN]
[0m15:41:27.630819 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m15:41:27.632807 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90)
[0m15:41:27.631852 [info ] [Thread-2 (]: 28 of 111 START test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ..... [RUN]
[0m15:41:27.634822 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m15:41:27.636882 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703)
[0m15:41:27.648674 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m15:41:27.650277 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m15:41:27.651760 [debug] [Thread-4 (]: SQL status: OK in 0.097 seconds
[0m15:41:27.653391 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m15:41:27.675343 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m15:41:27.676759 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: BEGIN
[0m15:41:27.678367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:27.679768 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m15:41:27.683978 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: ROLLBACK
[0m15:41:27.690294 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m15:41:27.691976 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m15:41:27.694371 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9'
[0m15:41:27.695844 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m15:41:27.697125 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: Close
[0m15:41:27.699070 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m15:41:27.700489 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:27.707370 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m15:41:27.709235 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m15:41:27.710526 [info ] [Thread-4 (]: 25 of 111 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 .......... [[32mPASS[0m in 0.18s]
[0m15:41:27.712445 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: BEGIN
[0m15:41:27.714775 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m15:41:27.716560 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:27.718043 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m15:41:27.720194 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m15:41:27.723866 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:41:27.724869 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: BEGIN
[0m15:41:27.721930 [info ] [Thread-4 (]: 29 of 111 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [RUN]
[0m15:41:27.726995 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m15:41:27.728674 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:27.730698 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7)
[0m15:41:27.733044 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:27.735527 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m15:41:27.745985 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m15:41:27.752184 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m15:41:27.753719 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m15:41:27.755257 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:27.758340 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m15:41:27.769230 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m15:41:27.772855 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m15:41:27.774477 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: BEGIN
[0m15:41:27.776069 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:27.780588 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:41:27.782438 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m15:41:27.784472 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:27.805712 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m15:41:27.811552 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: ROLLBACK
[0m15:41:27.813157 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21'
[0m15:41:27.814542 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: Close
[0m15:41:27.817502 [info ] [Thread-1 (]: 26 of 111 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 .......... [[32mPASS[0m in 0.22s]
[0m15:41:27.819543 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m15:41:27.820756 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m15:41:27.822027 [info ] [Thread-1 (]: 30 of 111 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [RUN]
[0m15:41:27.823659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d)
[0m15:41:27.824651 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m15:41:27.835583 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m15:41:27.847750 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m15:41:27.855338 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m15:41:27.858201 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m15:41:27.859538 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: BEGIN
[0m15:41:27.860464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:27.863995 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:41:27.865390 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m15:41:27.866400 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:29.046942 [debug] [Thread-2 (]: SQL status: OK in 1.290 seconds
[0m15:41:29.050007 [debug] [Thread-4 (]: SQL status: OK in 1.264 seconds
[0m15:41:29.051593 [debug] [Thread-3 (]: SQL status: OK in 1.314 seconds
[0m15:41:29.062028 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: ROLLBACK
[0m15:41:29.071032 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: ROLLBACK
[0m15:41:29.073560 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7'
[0m15:41:29.080312 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: ROLLBACK
[0m15:41:29.083644 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703'
[0m15:41:29.085437 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: Close
[0m15:41:29.087508 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: Close
[0m15:41:29.089612 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90'
[0m15:41:29.092347 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: Close
[0m15:41:29.095640 [info ] [Thread-4 (]: 29 of 111 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0 .... [[32mPASS[0m in 1.36s]
[0m15:41:29.102460 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m15:41:29.098700 [info ] [Thread-2 (]: 28 of 111 PASS dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ........... [[32mPASS[0m in 1.46s]
[0m15:41:29.108022 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m15:41:29.112411 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m15:41:29.105180 [info ] [Thread-3 (]: 27 of 111 PASS dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ........... [[32mPASS[0m in 1.47s]
[0m15:41:29.118532 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m15:41:29.115830 [info ] [Thread-4 (]: 31 of 111 START test dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0  [RUN]
[0m15:41:29.122582 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m15:41:29.123831 [info ] [Thread-2 (]: 32 of 111 START test dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date  [RUN]
[0m15:41:29.126054 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7, now test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b)
[0m15:41:29.128426 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m15:41:29.130487 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703, now test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf)
[0m15:41:29.131933 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m15:41:29.134402 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m15:41:29.133359 [info ] [Thread-3 (]: 33 of 111 START test dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0  [RUN]
[0m15:41:29.150546 [debug] [Thread-1 (]: SQL status: OK in 1.282 seconds
[0m15:41:29.148705 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b"
[0m15:41:29.165435 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf"
[0m15:41:29.166918 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90, now test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe)
[0m15:41:29.169528 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m15:41:29.180556 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe"
[0m15:41:29.185463 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: ROLLBACK
[0m15:41:29.187152 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m15:41:29.188662 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d'
[0m15:41:29.195090 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b"
[0m15:41:29.196833 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: Close
[0m15:41:29.198875 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m15:41:29.200460 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m15:41:29.206052 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf"
[0m15:41:29.220724 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe"
[0m15:41:29.222118 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b"
[0m15:41:29.208443 [info ] [Thread-1 (]: 30 of 111 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0 .... [[32mPASS[0m in 1.38s]
[0m15:41:29.224440 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b: BEGIN
[0m15:41:29.226352 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m15:41:29.227415 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:29.229018 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m15:41:29.231084 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe"
[0m15:41:29.233484 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf"
[0m15:41:29.236419 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe: BEGIN
[0m15:41:29.238403 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m15:41:29.234950 [info ] [Thread-1 (]: 34 of 111 START test dbt_utils_expression_is_true_stg__stocks_close___0 ........ [RUN]
[0m15:41:29.240730 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf: BEGIN
[0m15:41:29.242493 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:29.243815 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b"
[0m15:41:29.244953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c)
[0m15:41:29.245970 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:29.248066 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."mrt__stocks_with_regimes"

where not(open >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:29.249594 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m15:41:29.251607 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m15:41:29.257656 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m15:41:29.265504 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m15:41:29.266560 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe"
[0m15:41:29.267625 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf"
[0m15:41:29.268980 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."mrt__stocks_with_regimes"

where not(volume >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:29.270578 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."mrt__stocks_with_regimes"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m15:41:29.273167 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m15:41:29.282016 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m15:41:29.285647 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m15:41:29.287387 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: BEGIN
[0m15:41:29.288402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:29.291758 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:41:29.292727 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m15:41:29.293702 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(close >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:29.382314 [debug] [Thread-2 (]: SQL status: OK in 0.109 seconds
[0m15:41:29.384753 [debug] [Thread-4 (]: SQL status: OK in 0.131 seconds
[0m15:41:29.387318 [debug] [Thread-3 (]: SQL status: OK in 0.115 seconds
[0m15:41:29.389016 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m15:41:29.396460 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf: ROLLBACK
[0m15:41:29.403705 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: ROLLBACK
[0m15:41:29.409822 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b: ROLLBACK
[0m15:41:29.414067 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe: ROLLBACK
[0m15:41:29.416325 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf'
[0m15:41:29.417800 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c'
[0m15:41:29.419176 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b'
[0m15:41:29.420346 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf: Close
[0m15:41:29.421610 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe'
[0m15:41:29.422617 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: Close
[0m15:41:29.423988 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b: Close
[0m15:41:29.425434 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe: Close
[0m15:41:29.427218 [info ] [Thread-2 (]: 32 of 111 PASS dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date  [[32mPASS[0m in 0.30s]
[0m15:41:29.429902 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m15:41:29.433780 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m15:41:29.431359 [info ] [Thread-1 (]: 34 of 111 PASS dbt_utils_expression_is_true_stg__stocks_close___0 .............. [[32mPASS[0m in 0.19s]
[0m15:41:29.432851 [info ] [Thread-3 (]: 33 of 111 PASS dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0  [[32mPASS[0m in 0.27s]
[0m15:41:29.440270 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m15:41:29.438342 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m15:41:29.442290 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m15:41:29.435494 [info ] [Thread-4 (]: 31 of 111 PASS dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0 .. [[32mPASS[0m in 0.31s]
[0m15:41:29.444057 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m15:41:29.436359 [info ] [Thread-2 (]: 35 of 111 START test dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high  [RUN]
[0m15:41:29.448363 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m15:41:29.446426 [info ] [Thread-3 (]: 36 of 111 START test dbt_utils_expression_is_true_stg__stocks_high___0 ......... [RUN]
[0m15:41:29.451033 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338)
[0m15:41:29.449883 [info ] [Thread-1 (]: 37 of 111 START test dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp  [RUN]
[0m15:41:29.452466 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m15:41:29.453698 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c)
[0m15:41:29.454751 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m15:41:29.455837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa)
[0m15:41:29.457884 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m15:41:29.456893 [info ] [Thread-4 (]: 38 of 111 START test dbt_utils_expression_is_true_stg__stocks_low___0 .......... [RUN]
[0m15:41:29.476991 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m15:41:29.479005 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m15:41:29.492983 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m15:41:29.494269 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99)
[0m15:41:29.505795 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m15:41:29.507416 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m15:41:29.520985 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m15:41:29.522697 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m15:41:29.530103 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m15:41:29.531782 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m15:41:29.548886 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m15:41:29.550176 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m15:41:29.551840 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m15:41:29.557736 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m15:41:29.558846 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: BEGIN
[0m15:41:29.559803 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m15:41:29.561465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:29.563348 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m15:41:29.570348 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m15:41:29.572127 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: BEGIN
[0m15:41:29.573822 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m15:41:29.575199 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:29.576431 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: BEGIN
[0m15:41:29.578355 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m15:41:29.580018 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:29.581523 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m15:41:29.582799 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m15:41:29.583821 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m15:41:29.585455 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(close >= low and close <= high)


  
  
      
    ) dbt_internal_test
[0m15:41:29.587183 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m15:41:29.588967 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: BEGIN
[0m15:41:29.590007 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m15:41:29.591641 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(high >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:29.593218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:29.594235 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m15:41:29.596399 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(low >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:29.599166 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:41:29.600811 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m15:41:29.602567 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m15:41:29.832375 [debug] [Thread-1 (]: SQL status: OK in 0.228 seconds
[0m15:41:29.834801 [debug] [Thread-2 (]: SQL status: OK in 0.243 seconds
[0m15:41:29.837640 [debug] [Thread-3 (]: SQL status: OK in 0.242 seconds
[0m15:41:29.840381 [debug] [Thread-4 (]: SQL status: OK in 0.242 seconds
[0m15:41:29.849529 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: ROLLBACK
[0m15:41:29.855625 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: ROLLBACK
[0m15:41:29.860936 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: ROLLBACK
[0m15:41:29.867478 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: ROLLBACK
[0m15:41:29.870573 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa'
[0m15:41:29.872901 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c'
[0m15:41:29.875705 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338'
[0m15:41:29.877976 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99'
[0m15:41:29.879671 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: Close
[0m15:41:29.881856 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: Close
[0m15:41:29.883541 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: Close
[0m15:41:29.885021 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: Close
[0m15:41:29.889344 [info ] [Thread-1 (]: 37 of 111 PASS dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp  [[32mPASS[0m in 0.43s]
[0m15:41:29.898618 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m15:41:29.891571 [info ] [Thread-3 (]: 36 of 111 PASS dbt_utils_expression_is_true_stg__stocks_high___0 ............... [[32mPASS[0m in 0.44s]
[0m15:41:29.900712 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m15:41:29.904567 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m15:41:29.893294 [info ] [Thread-4 (]: 38 of 111 PASS dbt_utils_expression_is_true_stg__stocks_low___0 ................ [[32mPASS[0m in 0.40s]
[0m15:41:29.894953 [info ] [Thread-2 (]: 35 of 111 PASS dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high  [[32mPASS[0m in 0.44s]
[0m15:41:29.909540 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m15:41:29.907147 [info ] [Thread-1 (]: 39 of 111 START test dbt_utils_expression_is_true_stg__stocks_open___0 ......... [RUN]
[0m15:41:29.914135 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m15:41:29.917722 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m15:41:29.921836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec)
[0m15:41:29.920138 [info ] [Thread-3 (]: 40 of 111 START test dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high  [RUN]
[0m15:41:29.924446 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m15:41:29.926991 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m15:41:29.929655 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m15:41:29.932646 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8)
[0m15:41:29.935191 [info ] [Thread-4 (]: 41 of 111 START test dbt_utils_expression_is_true_stg__stocks_trade_date___current_date  [RUN]
[0m15:41:29.948709 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m15:41:29.937269 [info ] [Thread-2 (]: 42 of 111 START test dbt_utils_expression_is_true_stg__stocks_volume___0 ....... [RUN]
[0m15:41:29.950174 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m15:41:29.952534 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4)
[0m15:41:29.954880 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e)
[0m15:41:29.968613 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m15:41:29.969796 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m15:41:29.970991 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m15:41:29.972395 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m15:41:29.989057 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m15:41:30.000666 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m15:41:30.008294 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m15:41:30.009446 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m15:41:30.018679 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m15:41:30.021138 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m15:41:30.023187 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m15:41:30.031212 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m15:41:30.032475 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m15:41:30.034583 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m15:41:30.039865 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m15:41:30.041129 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: BEGIN
[0m15:41:30.042557 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: BEGIN
[0m15:41:30.044086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:30.045372 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:30.047933 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m15:41:30.051180 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: BEGIN
[0m15:41:30.052328 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m15:41:30.050040 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m15:41:30.053583 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:30.054497 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m15:41:30.055482 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m15:41:30.056472 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: BEGIN
[0m15:41:30.058076 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m15:41:30.059793 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(open >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:30.061029 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:30.062037 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m15:41:30.063260 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(open >= low and open <= high)


  
  
      
    ) dbt_internal_test
[0m15:41:30.065435 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m15:41:30.067289 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(volume >= 0)


  
  
      
    ) dbt_internal_test
[0m15:41:30.069231 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m15:41:30.070800 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m15:41:30.072590 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m15:41:30.125914 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m15:41:30.135993 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: ROLLBACK
[0m15:41:30.138672 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec'
[0m15:41:30.140284 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: Close
[0m15:41:30.144948 [info ] [Thread-1 (]: 39 of 111 PASS dbt_utils_expression_is_true_stg__stocks_open___0 ............... [[32mPASS[0m in 0.22s]
[0m15:41:30.148824 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m15:41:30.150601 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m15:41:30.152717 [info ] [Thread-1 (]: 43 of 111 START test dbt_utils_expression_is_true_stg__vix_with_versions_close___0  [RUN]
[0m15:41:30.155715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd)
[0m15:41:30.158820 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m15:41:30.190111 [debug] [Thread-4 (]: SQL status: OK in 0.116 seconds
[0m15:41:30.192283 [debug] [Thread-3 (]: SQL status: OK in 0.125 seconds
[0m15:41:30.188050 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m15:41:30.195959 [debug] [Thread-2 (]: SQL status: OK in 0.127 seconds
[0m15:41:30.202470 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m15:41:30.210187 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m15:41:30.214575 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: ROLLBACK
[0m15:41:30.218239 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: ROLLBACK
[0m15:41:30.221388 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: ROLLBACK
[0m15:41:30.223643 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e'
[0m15:41:30.225360 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8'
[0m15:41:30.227023 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4'
[0m15:41:30.227978 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: Close
[0m15:41:30.230890 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m15:41:30.229279 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: Close
[0m15:41:30.232216 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: Close
[0m15:41:30.233605 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: BEGIN
[0m15:41:30.235368 [info ] [Thread-2 (]: 42 of 111 PASS dbt_utils_expression_is_true_stg__stocks_volume___0 ............. [[32mPASS[0m in 0.28s]
[0m15:41:30.237067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:30.241517 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m15:41:30.238467 [info ] [Thread-4 (]: 41 of 111 PASS dbt_utils_expression_is_true_stg__stocks_trade_date___current_date  [[32mPASS[0m in 0.29s]
[0m15:41:30.239931 [info ] [Thread-3 (]: 40 of 111 PASS dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high . [[32mPASS[0m in 0.31s]
[0m15:41:30.244306 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m15:41:30.247165 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m15:41:30.248433 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m15:41:30.250712 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m15:41:30.254665 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m15:41:30.252681 [info ] [Thread-2 (]: 44 of 111 START test dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max  [RUN]
[0m15:41:30.256538 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m15:41:30.257704 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m15:41:30.260007 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929)
[0m15:41:30.258916 [info ] [Thread-4 (]: 45 of 111 START test dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp  [RUN]
[0m15:41:30.262022 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(close > 0)


  
  
      
    ) dbt_internal_test
[0m15:41:30.265351 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m15:41:30.263943 [info ] [Thread-3 (]: 46 of 111 START test dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date  [RUN]
[0m15:41:30.267538 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17)
[0m15:41:30.285274 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m15:41:30.286394 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00)
[0m15:41:30.287472 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m15:41:30.290501 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m15:41:30.307860 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m15:41:30.327144 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m15:41:30.329174 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m15:41:30.338952 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m15:41:30.342002 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m15:41:30.355332 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m15:41:30.357458 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m15:41:30.362031 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m15:41:30.373033 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m15:41:30.375114 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: BEGIN
[0m15:41:30.377688 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:30.380137 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m15:41:30.382307 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: BEGIN
[0m15:41:30.384339 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:41:30.386171 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:30.388136 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m15:41:30.391038 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m15:41:30.393448 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(complacent_max < normal_max AND  normal_max < elevated_max)


  
  
      
    ) dbt_internal_test
[0m15:41:30.395667 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m15:41:30.397624 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: BEGIN
[0m15:41:30.400061 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m15:41:30.401594 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:30.403143 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m15:41:30.407489 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:41:30.409141 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m15:41:30.410866 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m15:41:30.418320 [debug] [Thread-1 (]: SQL status: OK in 0.150 seconds
[0m15:41:30.427389 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: ROLLBACK
[0m15:41:30.430344 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd'
[0m15:41:30.432010 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: Close
[0m15:41:30.435994 [info ] [Thread-1 (]: 43 of 111 PASS dbt_utils_expression_is_true_stg__vix_with_versions_close___0 ... [[32mPASS[0m in 0.28s]
[0m15:41:30.438500 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m15:41:30.439565 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m15:41:30.440877 [info ] [Thread-1 (]: 47 of 111 START test dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1  [RUN]
[0m15:41:30.443016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93)
[0m15:41:30.444359 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m15:41:30.461966 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m15:41:30.465122 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m15:41:30.482184 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m15:41:30.483340 [debug] [Thread-2 (]: SQL status: OK in 0.084 seconds
[0m15:41:30.484659 [debug] [Thread-4 (]: SQL status: OK in 0.080 seconds
[0m15:41:30.487766 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m15:41:30.489249 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: BEGIN
[0m15:41:30.494250 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: ROLLBACK
[0m15:41:30.499401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:30.498731 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: ROLLBACK
[0m15:41:30.501062 [debug] [Thread-3 (]: SQL status: OK in 0.089 seconds
[0m15:41:30.503239 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929'
[0m15:41:30.505122 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17'
[0m15:41:30.506426 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:41:30.507613 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: Close
[0m15:41:30.509064 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: Close
[0m15:41:30.512704 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: ROLLBACK
[0m15:41:30.514184 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m15:41:30.516444 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(version_rank >= 1)


  
  
      
    ) dbt_internal_test
[0m15:41:30.521003 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00'
[0m15:41:30.518188 [info ] [Thread-2 (]: 44 of 111 PASS dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max  [[32mPASS[0m in 0.26s]
[0m15:41:30.522925 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: Close
[0m15:41:30.519668 [info ] [Thread-4 (]: 45 of 111 PASS dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp  [[32mPASS[0m in 0.25s]
[0m15:41:30.525774 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m15:41:30.528217 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m15:41:30.530505 [info ] [Thread-3 (]: 46 of 111 PASS dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date  [[32mPASS[0m in 0.24s]
[0m15:41:30.532988 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m15:41:30.534942 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m15:41:30.537224 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m15:41:30.538175 [info ] [Thread-2 (]: 48 of 111 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m15:41:30.541075 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m15:41:30.539408 [info ] [Thread-4 (]: 49 of 111 START test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [RUN]
[0m15:41:30.542849 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m15:41:30.545140 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08)
[0m15:41:30.543962 [info ] [Thread-3 (]: 50 of 111 START test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [RUN]
[0m15:41:30.547061 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m15:41:30.548144 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m15:41:30.549225 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95)
[0m15:41:30.585900 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m15:41:30.598837 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m15:41:30.600821 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m15:41:30.612760 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m15:41:30.615218 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m15:41:30.616698 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m15:41:30.625755 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m15:41:30.632132 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m15:41:30.633859 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m15:41:30.634905 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m15:41:30.640615 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m15:41:30.643715 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m15:41:30.644917 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m15:41:30.646220 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:30.648297 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m15:41:30.649923 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m15:41:30.653865 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: ROLLBACK
[0m15:41:30.655019 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: BEGIN
[0m15:41:30.656127 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m15:41:30.657053 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: BEGIN
[0m15:41:30.658263 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:30.659568 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93'
[0m15:41:30.660592 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m15:41:30.661579 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:30.663239 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: Close
[0m15:41:30.664722 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m15:41:30.666372 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m15:41:30.668468 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:41:30.670721 [info ] [Thread-1 (]: 47 of 111 PASS dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1  [[32mPASS[0m in 0.23s]
[0m15:41:30.672090 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m15:41:30.673828 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m15:41:30.675943 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m15:41:30.677524 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_sma"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m15:41:30.678688 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_wilder"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m15:41:30.680566 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m15:41:30.683615 [info ] [Thread-1 (]: 51 of 111 START test dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker  [RUN]
[0m15:41:30.685497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de)
[0m15:41:30.687076 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m15:41:30.702473 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de"
[0m15:41:30.705747 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m15:41:30.715415 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de"
[0m15:41:30.718958 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de"
[0m15:41:30.720657 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de: BEGIN
[0m15:41:30.722247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:30.726570 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:41:30.728149 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de"
[0m15:41:30.729881 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        trade_date, ticker
    from "finance"."analytics_dev"."mrt__stocks_with_regimes"
    group by trade_date, ticker
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m15:41:30.771950 [debug] [Thread-2 (]: SQL status: OK in 0.104 seconds
[0m15:41:30.777972 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m15:41:30.780006 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m15:41:30.781346 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m15:41:30.783748 [info ] [Thread-2 (]: 48 of 111 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.24s]
[0m15:41:30.785988 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m15:41:30.787090 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m15:41:30.789903 [debug] [Thread-4 (]: SQL status: OK in 0.107 seconds
[0m15:41:30.788619 [info ] [Thread-2 (]: 52 of 111 START test dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker  [RUN]
[0m15:41:30.792045 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91)
[0m15:41:30.793101 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m15:41:30.808250 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: ROLLBACK
[0m15:41:30.804862 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m15:41:30.811821 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08'
[0m15:41:30.813774 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: Close
[0m15:41:30.815905 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m15:41:30.824944 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m15:41:30.817435 [info ] [Thread-4 (]: 49 of 111 PASS dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn . [[32mPASS[0m in 0.27s]
[0m15:41:30.826282 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m15:41:30.828005 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m15:41:30.829531 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m15:41:30.831154 [info ] [Thread-4 (]: 53 of 111 START test dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id  [RUN]
[0m15:41:30.833468 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e)
[0m15:41:30.837704 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de: ROLLBACK
[0m15:41:30.839665 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m15:41:30.841003 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m15:41:30.847152 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de'
[0m15:41:30.855859 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m15:41:30.856860 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: BEGIN
[0m15:41:30.858259 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de: Close
[0m15:41:30.860325 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:30.864289 [info ] [Thread-1 (]: 51 of 111 PASS dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker  [[32mPASS[0m in 0.18s]
[0m15:41:30.866472 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:41:30.867825 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m15:41:30.869243 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m15:41:30.870269 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m15:41:30.877045 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m15:41:30.878244 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m15:41:30.879942 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        trade_date, ticker
    from "finance"."analytics_dev"."stg__stocks"
    group by trade_date, ticker
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m15:41:30.881683 [info ] [Thread-1 (]: 54 of 111 START test not_null_int__price_changes_close ......................... [RUN]
[0m15:41:30.883871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m15:41:30.885145 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m15:41:30.904805 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m15:41:30.909470 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m15:41:30.911072 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: BEGIN
[0m15:41:30.912887 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:30.916118 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m15:41:30.923146 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m15:41:30.924310 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m15:41:30.925449 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m15:41:30.926876 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        trade_date, version_id
    from "finance"."analytics_dev"."stg__vix_with_versions"
    group by trade_date, version_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m15:41:30.929525 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m15:41:30.931432 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m15:41:30.932881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:30.936548 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:41:30.938162 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m15:41:30.939443 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m15:41:30.950581 [debug] [Thread-2 (]: SQL status: OK in 0.067 seconds
[0m15:41:30.958946 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: ROLLBACK
[0m15:41:30.960715 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91'
[0m15:41:30.961685 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: Close
[0m15:41:30.964877 [info ] [Thread-2 (]: 52 of 111 PASS dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker  [[32mPASS[0m in 0.17s]
[0m15:41:30.967144 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m15:41:30.968253 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m15:41:30.969484 [info ] [Thread-2 (]: 55 of 111 START test not_null_int__price_changes_gain .......................... [RUN]
[0m15:41:30.971270 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m15:41:30.972455 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m15:41:30.982840 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m15:41:30.985573 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m15:41:30.991924 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m15:41:30.994752 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m15:41:30.996509 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m15:41:30.997660 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:31.000853 [debug] [Thread-4 (]: SQL status: OK in 0.072 seconds
[0m15:41:31.002389 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:41:31.003861 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m15:41:31.005447 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.011556 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: ROLLBACK
[0m15:41:31.014420 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e'
[0m15:41:31.016318 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: Close
[0m15:41:31.018766 [info ] [Thread-4 (]: 53 of 111 PASS dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id  [[32mPASS[0m in 0.19s]
[0m15:41:31.020828 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m15:41:31.021886 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m15:41:31.023662 [info ] [Thread-4 (]: 56 of 111 START test not_null_int__price_changes_loaded_at ..................... [RUN]
[0m15:41:31.025990 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m15:41:31.027327 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m15:41:31.038433 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m15:41:31.039809 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m15:41:31.042539 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m15:41:31.051422 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m15:41:31.055888 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m15:41:31.058049 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m15:41:31.059082 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m15:41:31.060858 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m15:41:31.064949 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m15:41:31.063283 [info ] [Thread-1 (]: 54 of 111 PASS not_null_int__price_changes_close ............................... [[32mPASS[0m in 0.18s]
[0m15:41:31.066828 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:31.069302 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m15:41:31.071590 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m15:41:31.073053 [info ] [Thread-1 (]: 57 of 111 START test not_null_int__price_changes_loss .......................... [RUN]
[0m15:41:31.075051 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m15:41:31.076156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m15:41:31.077206 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m15:41:31.078843 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m15:41:31.080680 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.092346 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m15:41:31.096510 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m15:41:31.110102 [debug] [Thread-2 (]: SQL status: OK in 0.103 seconds
[0m15:41:31.114318 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m15:41:31.117660 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m15:41:31.119250 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m15:41:31.123112 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m15:41:31.124065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:31.126416 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m15:41:31.127924 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m15:41:31.129255 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:41:31.132162 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m15:41:31.131006 [info ] [Thread-2 (]: 55 of 111 PASS not_null_int__price_changes_gain ................................ [[32mPASS[0m in 0.16s]
[0m15:41:31.133580 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.135176 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m15:41:31.137196 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m15:41:31.138939 [info ] [Thread-2 (]: 58 of 111 START test not_null_int__price_changes_rn ............................ [RUN]
[0m15:41:31.140998 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m15:41:31.143189 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m15:41:31.154946 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m15:41:31.158277 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m15:41:31.166390 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m15:41:31.169246 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m15:41:31.170864 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m15:41:31.171776 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:31.175485 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:41:31.177001 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m15:41:31.179227 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.189644 [debug] [Thread-4 (]: SQL status: OK in 0.095 seconds
[0m15:41:31.198367 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m15:41:31.199747 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m15:41:31.200680 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m15:41:31.202381 [info ] [Thread-4 (]: 56 of 111 PASS not_null_int__price_changes_loaded_at ........................... [[32mPASS[0m in 0.18s]
[0m15:41:31.203747 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m15:41:31.204606 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m15:41:31.205296 [info ] [Thread-4 (]: 59 of 111 START test not_null_int__price_changes_ticker ........................ [RUN]
[0m15:41:31.206296 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m15:41:31.206918 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m15:41:31.218124 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m15:41:31.219232 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m15:41:31.221938 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m15:41:31.234750 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m15:41:31.238275 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m15:41:31.240460 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m15:41:31.241787 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m15:41:31.244154 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m15:41:31.247212 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m15:41:31.246030 [info ] [Thread-1 (]: 57 of 111 PASS not_null_int__price_changes_loss ................................ [[32mPASS[0m in 0.17s]
[0m15:41:31.248667 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:31.250888 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m15:41:31.253580 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m15:41:31.257336 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m15:41:31.255563 [info ] [Thread-1 (]: 60 of 111 START test not_null_int__price_changes_trade_date .................... [RUN]
[0m15:41:31.259295 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m15:41:31.260915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m15:41:31.262550 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.264126 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m15:41:31.280637 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m15:41:31.284204 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m15:41:31.292616 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m15:41:31.293683 [debug] [Thread-2 (]: SQL status: OK in 0.113 seconds
[0m15:41:31.296519 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m15:41:31.297650 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m15:41:31.302884 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m15:41:31.304167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:31.307686 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m15:41:31.309036 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m15:41:31.310610 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:41:31.311971 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m15:41:31.313646 [info ] [Thread-2 (]: 58 of 111 PASS not_null_int__price_changes_rn .................................. [[32mPASS[0m in 0.17s]
[0m15:41:31.314839 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.317006 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m15:41:31.318769 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m15:41:31.320445 [info ] [Thread-2 (]: 61 of 111 START test not_null_int__regime_changes_days_in_regime ............... [RUN]
[0m15:41:31.322395 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638, now test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0)
[0m15:41:31.324062 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m15:41:31.338297 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m15:41:31.339774 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m15:41:31.342204 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m15:41:31.351607 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m15:41:31.353188 [debug] [Thread-4 (]: SQL status: OK in 0.088 seconds
[0m15:41:31.354813 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m15:41:31.357450 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m15:41:31.358796 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m15:41:31.365690 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m15:41:31.361727 [info ] [Thread-1 (]: 60 of 111 PASS not_null_int__price_changes_trade_date .......................... [[32mPASS[0m in 0.10s]
[0m15:41:31.367793 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m15:41:31.369239 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m15:41:31.370488 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m15:41:31.373142 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m15:41:31.371892 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m15:41:31.375342 [info ] [Thread-1 (]: 62 of 111 START test not_null_int__regime_changes_end_date ..................... [RUN]
[0m15:41:31.379281 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: BEGIN
[0m15:41:31.380591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5, now test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755)
[0m15:41:31.377443 [info ] [Thread-4 (]: 59 of 111 PASS not_null_int__price_changes_ticker .............................. [[32mPASS[0m in 0.17s]
[0m15:41:31.382758 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:31.384346 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m15:41:31.386311 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m15:41:31.398685 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m15:41:31.400483 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m15:41:31.401962 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m15:41:31.404009 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m15:41:31.407216 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select days_in_regime
from "finance"."analytics_dev"."int__regime_changes"
where days_in_regime is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.405911 [info ] [Thread-4 (]: 63 of 111 START test not_null_int__regime_changes_regime ....................... [RUN]
[0m15:41:31.409364 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a, now test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006)
[0m15:41:31.410585 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m15:41:31.412219 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m15:41:31.426886 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m15:41:31.434914 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m15:41:31.438125 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m15:41:31.439362 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m15:41:31.440466 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: BEGIN
[0m15:41:31.444374 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m15:41:31.445087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:31.447143 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m15:41:31.448167 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: BEGIN
[0m15:41:31.448804 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:31.449596 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:41:31.450691 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m15:41:31.451545 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select end_date
from "finance"."analytics_dev"."int__regime_changes"
where end_date is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.452080 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:41:31.453613 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m15:41:31.455252 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select regime
from "finance"."analytics_dev"."int__regime_changes"
where regime is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.514768 [debug] [Thread-2 (]: SQL status: OK in 0.106 seconds
[0m15:41:31.520727 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: ROLLBACK
[0m15:41:31.522649 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0'
[0m15:41:31.523876 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: Close
[0m15:41:31.526275 [info ] [Thread-2 (]: 61 of 111 PASS not_null_int__regime_changes_days_in_regime ..................... [[32mPASS[0m in 0.20s]
[0m15:41:31.528466 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m15:41:31.530613 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m15:41:31.532158 [info ] [Thread-2 (]: 64 of 111 START test not_null_int__regime_changes_regime_period_id ............. [RUN]
[0m15:41:31.533845 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0, now test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257)
[0m15:41:31.535067 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m15:41:31.547255 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m15:41:31.550937 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m15:41:31.552174 [debug] [Thread-4 (]: SQL status: OK in 0.095 seconds
[0m15:41:31.553084 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m15:41:31.562358 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m15:41:31.568349 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m15:41:31.572485 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: ROLLBACK
[0m15:41:31.575647 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: ROLLBACK
[0m15:41:31.576611 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: BEGIN
[0m15:41:31.578709 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755'
[0m15:41:31.580667 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006'
[0m15:41:31.582178 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:31.583867 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: Close
[0m15:41:31.584888 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: Close
[0m15:41:31.588392 [info ] [Thread-4 (]: 63 of 111 PASS not_null_int__regime_changes_regime ............................. [[32mPASS[0m in 0.18s]
[0m15:41:31.591798 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m15:41:31.594192 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m15:41:31.590345 [info ] [Thread-1 (]: 62 of 111 PASS not_null_int__regime_changes_end_date ........................... [[32mPASS[0m in 0.21s]
[0m15:41:31.596081 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m15:41:31.597827 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m15:41:31.599454 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m15:41:31.600500 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select regime_period_id
from "finance"."analytics_dev"."int__regime_changes"
where regime_period_id is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.602846 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m15:41:31.601592 [info ] [Thread-4 (]: 65 of 111 START test not_null_int__regime_changes_start_date ................... [RUN]
[0m15:41:31.605715 [info ] [Thread-1 (]: 66 of 111 START test not_null_int__regime_classification_loaded_at ............. [RUN]
[0m15:41:31.607909 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006, now test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7)
[0m15:41:31.609987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755, now test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b)
[0m15:41:31.612101 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m15:41:31.614012 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m15:41:31.638074 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m15:41:31.645495 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m15:41:31.649521 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m15:41:31.659189 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m15:41:31.661015 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m15:41:31.667418 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m15:41:31.670117 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m15:41:31.671718 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m15:41:31.673155 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: BEGIN
[0m15:41:31.674251 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: BEGIN
[0m15:41:31.675238 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:31.676205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:31.679552 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:41:31.681296 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m15:41:31.682629 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m15:41:31.684356 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__regime_classification"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.685475 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m15:41:31.687202 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select start_date
from "finance"."analytics_dev"."int__regime_changes"
where start_date is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.709230 [debug] [Thread-2 (]: SQL status: OK in 0.104 seconds
[0m15:41:31.715937 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: ROLLBACK
[0m15:41:31.717570 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257'
[0m15:41:31.718513 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: Close
[0m15:41:31.720950 [info ] [Thread-2 (]: 64 of 111 PASS not_null_int__regime_changes_regime_period_id ................... [[32mPASS[0m in 0.19s]
[0m15:41:31.722924 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m15:41:31.723968 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m15:41:31.725192 [info ] [Thread-2 (]: 67 of 111 START test not_null_int__regime_classification_regime ................ [RUN]
[0m15:41:31.726972 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257, now test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6)
[0m15:41:31.728519 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m15:41:31.738372 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m15:41:31.741071 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m15:41:31.747739 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m15:41:31.750755 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m15:41:31.752407 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: BEGIN
[0m15:41:31.753730 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:31.758305 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:41:31.759323 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m15:41:31.760488 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select regime
from "finance"."analytics_dev"."int__regime_classification"
where regime is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.765933 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m15:41:31.772106 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: ROLLBACK
[0m15:41:31.773899 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b'
[0m15:41:31.774825 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: Close
[0m15:41:31.777168 [info ] [Thread-1 (]: 66 of 111 PASS not_null_int__regime_classification_loaded_at ................... [[32mPASS[0m in 0.17s]
[0m15:41:31.780241 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m15:41:31.781269 [debug] [Thread-4 (]: SQL status: OK in 0.093 seconds
[0m15:41:31.782735 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m15:41:31.785242 [info ] [Thread-1 (]: 68 of 111 START test not_null_int__regime_classification_trade_date ............ [RUN]
[0m15:41:31.787316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b, now test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade)
[0m15:41:31.788691 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m15:41:31.804983 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: ROLLBACK
[0m15:41:31.814430 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m15:41:31.816041 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7'
[0m15:41:31.817243 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: Close
[0m15:41:31.819573 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m15:41:31.828260 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m15:41:31.821365 [info ] [Thread-4 (]: 65 of 111 PASS not_null_int__regime_changes_start_date ......................... [[32mPASS[0m in 0.21s]
[0m15:41:31.831442 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m15:41:31.833455 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m15:41:31.835735 [info ] [Thread-4 (]: 69 of 111 START test not_null_int__rsi_sma_close ............................... [RUN]
[0m15:41:31.838405 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7, now test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b)
[0m15:41:31.839522 [debug] [Thread-2 (]: SQL status: OK in 0.077 seconds
[0m15:41:31.840579 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m15:41:31.841532 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m15:41:31.843152 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: BEGIN
[0m15:41:31.854116 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: ROLLBACK
[0m15:41:31.859610 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m15:41:31.860744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:31.862793 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6'
[0m15:41:31.864428 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: Close
[0m15:41:31.866421 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m15:41:31.875397 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m15:41:31.868376 [info ] [Thread-2 (]: 67 of 111 PASS not_null_int__regime_classification_regime ...................... [[32mPASS[0m in 0.14s]
[0m15:41:31.877236 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m15:41:31.879192 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m15:41:31.880666 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m15:41:31.882809 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m15:41:31.884812 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__regime_classification"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.888291 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m15:41:31.886689 [info ] [Thread-2 (]: 70 of 111 START test not_null_int__rsi_sma_gain ................................ [RUN]
[0m15:41:31.890161 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: BEGIN
[0m15:41:31.891648 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6, now test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953)
[0m15:41:31.892936 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:31.894409 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m15:41:31.905202 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m15:41:31.906779 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m15:41:31.909124 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m15:41:31.910986 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__rsi_sma"
where close is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.913455 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m15:41:31.919379 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m15:41:31.921531 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m15:41:31.922929 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: BEGIN
[0m15:41:31.923833 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:31.927289 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:41:31.928506 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m15:41:31.929484 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_sma"
where gain is null



  
  
      
    ) dbt_internal_test
[0m15:41:31.942336 [debug] [Thread-3 (]: SQL status: OK in 1.259 seconds
[0m15:41:31.949820 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: ROLLBACK
[0m15:41:31.951773 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95'
[0m15:41:31.952730 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: Close
[0m15:41:31.956277 [info ] [Thread-3 (]: 50 of 111 PASS dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[32mPASS[0m in 1.41s]
[0m15:41:31.958849 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m15:41:31.959939 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m15:41:31.961172 [info ] [Thread-3 (]: 71 of 111 START test not_null_int__rsi_sma_loaded_at ........................... [RUN]
[0m15:41:31.963141 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95, now test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0)
[0m15:41:31.964755 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m15:41:31.976666 [debug] [Thread-1 (]: SQL status: OK in 0.087 seconds
[0m15:41:31.978414 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m15:41:31.983156 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m15:41:31.988274 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: ROLLBACK
[0m15:41:31.994224 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m15:41:31.995792 [debug] [Thread-4 (]: SQL status: OK in 0.083 seconds
[0m15:41:31.997884 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade'
[0m15:41:31.999402 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: Close
[0m15:41:32.001394 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m15:41:32.004306 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: BEGIN
[0m15:41:32.003193 [info ] [Thread-1 (]: 68 of 111 PASS not_null_int__regime_classification_trade_date .................. [[32mPASS[0m in 0.22s]
[0m15:41:32.009016 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:32.012290 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: ROLLBACK
[0m15:41:32.014238 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m15:41:32.015881 [debug] [Thread-2 (]: SQL status: OK in 0.085 seconds
[0m15:41:32.018427 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m15:41:32.020868 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b'
[0m15:41:32.022288 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m15:41:32.023643 [info ] [Thread-1 (]: 72 of 111 START test not_null_int__rsi_sma_loss ................................ [RUN]
[0m15:41:32.028704 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: ROLLBACK
[0m15:41:32.024676 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: Close
[0m15:41:32.031050 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m15:41:32.032443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade, now test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065)
[0m15:41:32.035122 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953'
[0m15:41:32.037798 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__rsi_sma"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m15:41:32.036790 [info ] [Thread-4 (]: 69 of 111 PASS not_null_int__rsi_sma_close ..................................... [[32mPASS[0m in 0.20s]
[0m15:41:32.039846 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m15:41:32.041977 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: Close
[0m15:41:32.044801 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m15:41:32.060154 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m15:41:32.061800 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m15:41:32.063730 [info ] [Thread-2 (]: 70 of 111 PASS not_null_int__rsi_sma_gain ...................................... [[32mPASS[0m in 0.17s]
[0m15:41:32.067393 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m15:41:32.065791 [info ] [Thread-4 (]: 73 of 111 START test not_null_int__rsi_sma_rn .................................. [RUN]
[0m15:41:32.068905 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m15:41:32.070205 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b, now test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139)
[0m15:41:32.074852 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m15:41:32.073012 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m15:41:32.071655 [info ] [Thread-2 (]: 74 of 111 START test not_null_int__rsi_sma_sma_gain ............................ [RUN]
[0m15:41:32.090621 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m15:41:32.098854 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m15:41:32.100705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953, now test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416)
[0m15:41:32.103680 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m15:41:32.116952 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m15:41:32.119182 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m15:41:32.120534 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: BEGIN
[0m15:41:32.121767 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m15:41:32.123184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:32.131694 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m15:41:32.133585 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m15:41:32.140423 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m15:41:32.142025 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m15:41:32.143917 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m15:41:32.145441 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m15:41:32.146671 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_sma"
where loss is null



  
  
      
    ) dbt_internal_test
[0m15:41:32.148080 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: BEGIN
[0m15:41:32.149952 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m15:41:32.151089 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:32.152577 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: BEGIN
[0m15:41:32.154186 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:32.156496 [debug] [Thread-3 (]: SQL status: OK in 0.113 seconds
[0m15:41:32.157664 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m15:41:32.159127 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m15:41:32.160643 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:41:32.162249 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_sma"
where rn is null



  
  
      
    ) dbt_internal_test
[0m15:41:32.165214 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m15:41:32.167527 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: ROLLBACK
[0m15:41:32.169275 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_gain
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_gain is null



  
  
      
    ) dbt_internal_test
[0m15:41:32.171518 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0'
[0m15:41:32.172570 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: Close
[0m15:41:32.175035 [info ] [Thread-3 (]: 71 of 111 PASS not_null_int__rsi_sma_loaded_at ................................. [[32mPASS[0m in 0.21s]
[0m15:41:32.177040 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m15:41:32.178269 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m15:41:32.179912 [info ] [Thread-3 (]: 75 of 111 START test not_null_int__rsi_sma_sma_loss ............................ [RUN]
[0m15:41:32.181777 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0, now test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6)
[0m15:41:32.182993 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m15:41:32.193529 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m15:41:32.196384 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m15:41:32.203251 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m15:41:32.206460 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m15:41:32.207280 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: BEGIN
[0m15:41:32.208490 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:32.212592 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:41:32.214389 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m15:41:32.215737 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_loss
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_loss is null



  
  
      
    ) dbt_internal_test
[0m15:41:32.248318 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m15:41:32.253909 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: ROLLBACK
[0m15:41:32.255628 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065'
[0m15:41:32.256824 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: Close
[0m15:41:32.259139 [info ] [Thread-1 (]: 72 of 111 PASS not_null_int__rsi_sma_loss ...................................... [[32mPASS[0m in 0.23s]
[0m15:41:32.261228 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m15:41:32.263241 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m15:41:32.266463 [debug] [Thread-2 (]: SQL status: OK in 0.096 seconds
[0m15:41:32.265139 [info ] [Thread-1 (]: 76 of 111 START test not_null_int__rsi_sma_ticker .............................. [RUN]
[0m15:41:32.268508 [debug] [Thread-4 (]: SQL status: OK in 0.100 seconds
[0m15:41:32.270048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065, now test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d)
[0m15:41:32.276221 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: ROLLBACK
[0m15:41:32.280987 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: ROLLBACK
[0m15:41:32.282019 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m15:41:32.283924 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416'
[0m15:41:32.289741 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139'
[0m15:41:32.296903 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m15:41:32.297914 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: Close
[0m15:41:32.298915 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: Close
[0m15:41:32.304671 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m15:41:32.301882 [info ] [Thread-4 (]: 73 of 111 PASS not_null_int__rsi_sma_rn ........................................ [[32mPASS[0m in 0.23s]
[0m15:41:32.317288 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m15:41:32.303843 [info ] [Thread-2 (]: 74 of 111 PASS not_null_int__rsi_sma_sma_gain .................................. [[32mPASS[0m in 0.20s]
[0m15:41:32.319601 [debug] [Thread-3 (]: SQL status: OK in 0.103 seconds
[0m15:41:32.321119 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m15:41:32.322898 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m15:41:32.324957 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m15:41:32.326797 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m15:41:32.331190 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: ROLLBACK
[0m15:41:32.332521 [info ] [Thread-4 (]: 77 of 111 START test not_null_int__rsi_sma_trade_date .......................... [RUN]
[0m15:41:32.334765 [info ] [Thread-2 (]: 78 of 111 START test not_null_int__rsi_wilder_gain ............................. [RUN]
[0m15:41:32.338059 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m15:41:32.339998 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6'
[0m15:41:32.341529 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139, now test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0)
[0m15:41:32.343262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416, now test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda)
[0m15:41:32.344661 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: BEGIN
[0m15:41:32.346729 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: Close
[0m15:41:32.348466 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m15:41:32.350208 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m15:41:32.351691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:32.366183 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m15:41:32.374973 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m15:41:32.363651 [info ] [Thread-3 (]: 75 of 111 PASS not_null_int__rsi_sma_sma_loss .................................. [[32mPASS[0m in 0.18s]
[0m15:41:32.379130 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m15:41:32.381167 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m15:41:32.384822 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m15:41:32.386180 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m15:41:32.387563 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m15:41:32.388456 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m15:41:32.383387 [info ] [Thread-3 (]: 79 of 111 START test not_null_int__rsi_wilder_loss ............................. [RUN]
[0m15:41:32.389656 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_sma"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m15:41:32.404447 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m15:41:32.411934 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m15:41:32.413655 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6, now test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56)
[0m15:41:32.416157 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m15:41:32.431637 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m15:41:32.433820 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m15:41:32.435926 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m15:41:32.437312 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: BEGIN
[0m15:41:32.438637 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: BEGIN
[0m15:41:32.439991 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:32.441342 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m15:41:32.442269 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:32.450086 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m15:41:32.451734 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m15:41:32.453828 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m15:41:32.455938 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_wilder"
where gain is null



  
  
      
    ) dbt_internal_test
[0m15:41:32.458137 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m15:41:32.459221 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m15:41:32.460385 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_sma"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m15:41:32.462886 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m15:41:32.464226 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: BEGIN
[0m15:41:32.465113 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:32.468055 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:41:32.469000 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m15:41:32.469969 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_wilder"
where loss is null



  
  
      
    ) dbt_internal_test
[0m15:41:32.473143 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m15:41:32.480279 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: ROLLBACK
[0m15:41:32.481990 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0'
[0m15:41:32.482958 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: Close
[0m15:41:32.484700 [info ] [Thread-4 (]: 77 of 111 PASS not_null_int__rsi_sma_trade_date ................................ [[32mPASS[0m in 0.15s]
[0m15:41:32.486698 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m15:41:32.488029 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m15:41:32.489259 [info ] [Thread-4 (]: 80 of 111 START test not_null_int__rsi_wilder_rn ............................... [RUN]
[0m15:41:32.491081 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0, now test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d)
[0m15:41:32.492130 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m15:41:32.503270 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m15:41:32.508520 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m15:41:32.517010 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m15:41:32.519628 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m15:41:32.521233 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m15:41:32.522831 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: BEGIN
[0m15:41:32.527423 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:32.530216 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: ROLLBACK
[0m15:41:32.532779 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d'
[0m15:41:32.534268 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: Close
[0m15:41:32.535499 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m15:41:32.538112 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m15:41:32.537180 [info ] [Thread-1 (]: 76 of 111 PASS not_null_int__rsi_sma_ticker .................................... [[32mPASS[0m in 0.27s]
[0m15:41:32.539846 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_wilder"
where rn is null



  
  
      
    ) dbt_internal_test
[0m15:41:32.542178 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m15:41:32.545053 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m15:41:32.546985 [info ] [Thread-1 (]: 81 of 111 START test not_null_int__rsi_wilder_ticker ........................... [RUN]
[0m15:41:32.549064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d, now test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd)
[0m15:41:32.550410 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m15:41:32.561920 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m15:41:32.565088 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m15:41:32.574191 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m15:41:32.577097 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m15:41:32.578383 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: BEGIN
[0m15:41:32.579990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:32.583819 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:41:32.585089 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m15:41:32.587000 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_wilder"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m15:41:33.809561 [debug] [Thread-2 (]: SQL status: OK in 1.352 seconds
[0m15:41:33.811992 [debug] [Thread-3 (]: SQL status: OK in 1.341 seconds
[0m15:41:33.813858 [debug] [Thread-4 (]: SQL status: OK in 1.269 seconds
[0m15:41:33.818459 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: ROLLBACK
[0m15:41:33.824040 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: ROLLBACK
[0m15:41:33.826010 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda'
[0m15:41:33.830695 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: ROLLBACK
[0m15:41:33.832417 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56'
[0m15:41:33.833970 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: Close
[0m15:41:33.836161 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: Close
[0m15:41:33.838766 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d'
[0m15:41:33.843175 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: Close
[0m15:41:33.844912 [info ] [Thread-2 (]: 78 of 111 PASS not_null_int__rsi_wilder_gain ................................... [[32mPASS[0m in 1.50s]
[0m15:41:33.849470 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m15:41:33.850983 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m15:41:33.846937 [info ] [Thread-3 (]: 79 of 111 PASS not_null_int__rsi_wilder_loss ................................... [[32mPASS[0m in 1.43s]
[0m15:41:33.853053 [info ] [Thread-4 (]: 80 of 111 PASS not_null_int__rsi_wilder_rn ..................................... [[32mPASS[0m in 1.36s]
[0m15:41:33.855925 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m15:41:33.857887 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m15:41:33.853983 [info ] [Thread-2 (]: 82 of 111 START test not_null_int__rsi_wilder_trade_date ....................... [RUN]
[0m15:41:33.859377 [debug] [Thread-1 (]: SQL status: OK in 1.271 seconds
[0m15:41:33.860443 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m15:41:33.861900 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m15:41:33.863234 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda, now test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c)
[0m15:41:33.866912 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m15:41:33.864697 [info ] [Thread-3 (]: 83 of 111 START test not_null_int__rsi_wilder_wilder_gain ...................... [RUN]
[0m15:41:33.878306 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m15:41:33.882112 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: ROLLBACK
[0m15:41:33.883547 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9)
[0m15:41:33.865777 [info ] [Thread-4 (]: 84 of 111 START test not_null_int__rsi_wilder_wilder_loss ...................... [RUN]
[0m15:41:33.885420 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m15:41:33.886559 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd'
[0m15:41:33.887331 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb)
[0m15:41:33.893783 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: Close
[0m15:41:33.901591 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m15:41:33.903246 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m15:41:33.905174 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m15:41:33.920722 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m15:41:33.916282 [info ] [Thread-1 (]: 81 of 111 PASS not_null_int__rsi_wilder_ticker ................................. [[32mPASS[0m in 1.37s]
[0m15:41:33.929549 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m15:41:33.932019 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m15:41:33.933564 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m15:41:33.934957 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m15:41:33.936051 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m15:41:33.942578 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m15:41:33.951283 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m15:41:33.943994 [info ] [Thread-1 (]: 85 of 111 START test not_null_regime_thresholds_effective_date ................. [RUN]
[0m15:41:33.953358 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m15:41:33.955250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd, now test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5)
[0m15:41:33.956194 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: BEGIN
[0m15:41:33.957573 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m15:41:33.958784 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m15:41:33.959554 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:33.971458 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m15:41:33.972598 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m15:41:33.973302 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: BEGIN
[0m15:41:33.974527 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: BEGIN
[0m15:41:33.975817 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:33.976544 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:33.977508 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m15:41:33.979507 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m15:41:33.980438 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_wilder"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m15:41:33.981370 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:41:33.981939 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:41:33.982617 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m15:41:33.983544 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m15:41:33.984457 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m15:41:33.990942 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m15:41:33.991631 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_gain
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_gain is null



  
  
      
    ) dbt_internal_test
[0m15:41:33.992408 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_loss is null



  
  
      
    ) dbt_internal_test
[0m15:41:33.995126 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m15:41:33.996449 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: BEGIN
[0m15:41:33.997686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:34.000135 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:41:34.001036 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m15:41:34.001931 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_date
from "finance"."analytics_dev"."regime_thresholds"
where effective_date is null



  
  
      
    ) dbt_internal_test
[0m15:41:34.066567 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m15:41:34.077116 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: ROLLBACK
[0m15:41:34.081140 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5'
[0m15:41:34.082884 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: Close
[0m15:41:34.088133 [info ] [Thread-1 (]: 85 of 111 PASS not_null_regime_thresholds_effective_date ....................... [[32mPASS[0m in 0.13s]
[0m15:41:34.092768 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m15:41:34.095164 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m15:41:34.097808 [info ] [Thread-1 (]: 86 of 111 START test not_null_regime_thresholds_version_id ..................... [RUN]
[0m15:41:34.100863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5, now test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c)
[0m15:41:34.102688 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m15:41:34.122092 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m15:41:34.126536 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m15:41:34.138348 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m15:41:34.152513 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m15:41:34.155255 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: BEGIN
[0m15:41:34.157028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:34.163501 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:41:34.166064 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m15:41:34.169656 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_id
from "finance"."analytics_dev"."regime_thresholds"
where version_id is null



  
  
      
    ) dbt_internal_test
[0m15:41:34.235362 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m15:41:34.245688 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: ROLLBACK
[0m15:41:34.248782 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c'
[0m15:41:34.250357 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: Close
[0m15:41:34.254170 [info ] [Thread-1 (]: 86 of 111 PASS not_null_regime_thresholds_version_id ........................... [[32mPASS[0m in 0.15s]
[0m15:41:34.257656 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m15:41:34.259349 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m15:41:34.261556 [info ] [Thread-1 (]: 87 of 111 START test not_null_stg__stocks_close ................................ [RUN]
[0m15:41:34.264466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c, now test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f)
[0m15:41:34.267767 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m15:41:34.289697 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m15:41:34.293459 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m15:41:34.303238 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m15:41:34.307422 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m15:41:34.309226 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: BEGIN
[0m15:41:34.310902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:34.315160 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:41:34.316667 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m15:41:34.318299 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."stg__stocks"
where close is null



  
  
      
    ) dbt_internal_test
[0m15:41:34.380634 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m15:41:34.386115 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: ROLLBACK
[0m15:41:34.387696 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f'
[0m15:41:34.388620 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: Close
[0m15:41:34.391238 [info ] [Thread-1 (]: 87 of 111 PASS not_null_stg__stocks_close ...................................... [[32mPASS[0m in 0.13s]
[0m15:41:34.393638 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m15:41:34.394756 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m15:41:34.396054 [info ] [Thread-1 (]: 88 of 111 START test not_null_stg__stocks_high ................................. [RUN]
[0m15:41:34.397862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f, now test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4)
[0m15:41:34.399624 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m15:41:34.424748 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m15:41:34.427508 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m15:41:34.432996 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m15:41:34.435472 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m15:41:34.436521 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: BEGIN
[0m15:41:34.437436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:34.440885 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:41:34.442024 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m15:41:34.442953 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select high
from "finance"."analytics_dev"."stg__stocks"
where high is null



  
  
      
    ) dbt_internal_test
[0m15:41:34.498040 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m15:41:34.503213 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: ROLLBACK
[0m15:41:34.504441 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4'
[0m15:41:34.505047 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: Close
[0m15:41:34.506561 [info ] [Thread-1 (]: 88 of 111 PASS not_null_stg__stocks_high ....................................... [[32mPASS[0m in 0.11s]
[0m15:41:34.508344 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m15:41:34.509601 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m15:41:34.511494 [info ] [Thread-1 (]: 89 of 111 START test not_null_stg__stocks_loaded_at ............................ [RUN]
[0m15:41:34.513703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4, now test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf)
[0m15:41:34.514908 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m15:41:34.524533 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m15:41:34.527357 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m15:41:34.533261 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m15:41:34.535273 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m15:41:34.535966 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: BEGIN
[0m15:41:34.536558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:34.538880 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:41:34.539714 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m15:41:34.540544 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."stg__stocks"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m15:41:34.608596 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m15:41:34.617302 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: ROLLBACK
[0m15:41:34.619239 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf'
[0m15:41:34.620184 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: Close
[0m15:41:34.622975 [info ] [Thread-1 (]: 89 of 111 PASS not_null_stg__stocks_loaded_at .................................. [[32mPASS[0m in 0.11s]
[0m15:41:34.625714 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m15:41:34.626947 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m15:41:34.628532 [info ] [Thread-1 (]: 90 of 111 START test not_null_stg__stocks_low .................................. [RUN]
[0m15:41:34.630338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf, now test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52)
[0m15:41:34.631637 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m15:41:34.641867 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m15:41:34.653009 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m15:41:34.659219 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m15:41:34.662155 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m15:41:34.663620 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: BEGIN
[0m15:41:34.664537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:34.667741 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:41:34.668939 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m15:41:34.670714 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select low
from "finance"."analytics_dev"."stg__stocks"
where low is null



  
  
      
    ) dbt_internal_test
[0m15:41:34.736012 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m15:41:34.745114 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: ROLLBACK
[0m15:41:34.748078 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52'
[0m15:41:34.749581 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: Close
[0m15:41:34.753384 [info ] [Thread-1 (]: 90 of 111 PASS not_null_stg__stocks_low ........................................ [[32mPASS[0m in 0.12s]
[0m15:41:34.756682 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m15:41:34.758962 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m15:41:34.761201 [info ] [Thread-1 (]: 91 of 111 START test not_null_stg__stocks_open ................................. [RUN]
[0m15:41:34.763967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52, now test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7)
[0m15:41:34.766588 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m15:41:34.785600 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m15:41:34.789739 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m15:41:34.802870 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m15:41:34.809711 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m15:41:34.811091 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: BEGIN
[0m15:41:34.812259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:34.816103 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:41:34.817411 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m15:41:34.818493 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "finance"."analytics_dev"."stg__stocks"
where open is null



  
  
      
    ) dbt_internal_test
[0m15:41:34.882655 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m15:41:34.891902 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: ROLLBACK
[0m15:41:34.894590 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7'
[0m15:41:34.896235 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: Close
[0m15:41:34.900516 [info ] [Thread-1 (]: 91 of 111 PASS not_null_stg__stocks_open ....................................... [[32mPASS[0m in 0.14s]
[0m15:41:34.903962 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m15:41:34.905663 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m15:41:34.907650 [info ] [Thread-1 (]: 92 of 111 START test not_null_stg__stocks_ticker ............................... [RUN]
[0m15:41:34.911456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7, now test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71)
[0m15:41:34.913904 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m15:41:34.930901 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m15:41:34.934582 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m15:41:34.940810 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m15:41:34.943341 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m15:41:34.945046 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: BEGIN
[0m15:41:34.945990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:34.949525 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:41:34.950571 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m15:41:34.951511 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."stg__stocks"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m15:41:35.021034 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m15:41:35.031182 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: ROLLBACK
[0m15:41:35.033943 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71'
[0m15:41:35.035629 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: Close
[0m15:41:35.039927 [info ] [Thread-1 (]: 92 of 111 PASS not_null_stg__stocks_ticker ..................................... [[32mPASS[0m in 0.13s]
[0m15:41:35.043357 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m15:41:35.045139 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m15:41:35.047248 [info ] [Thread-1 (]: 93 of 111 START test not_null_stg__stocks_trade_date ........................... [RUN]
[0m15:41:35.050092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71, now test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182)
[0m15:41:35.053325 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m15:41:35.070720 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m15:41:35.075139 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m15:41:35.086708 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m15:41:35.089850 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m15:41:35.091494 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: BEGIN
[0m15:41:35.092453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:35.096010 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:41:35.096978 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m15:41:35.097948 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."stg__stocks"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m15:41:35.154386 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m15:41:35.160078 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: ROLLBACK
[0m15:41:35.161976 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182'
[0m15:41:35.162898 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: Close
[0m15:41:35.165258 [info ] [Thread-1 (]: 93 of 111 PASS not_null_stg__stocks_trade_date ................................. [[32mPASS[0m in 0.12s]
[0m15:41:35.167857 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m15:41:35.169013 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m15:41:35.170264 [info ] [Thread-1 (]: 94 of 111 START test not_null_stg__stocks_volume ............................... [RUN]
[0m15:41:35.172023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182, now test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0)
[0m15:41:35.173957 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m15:41:35.188754 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m15:41:35.191489 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m15:41:35.197951 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m15:41:35.200896 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m15:41:35.202387 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: BEGIN
[0m15:41:35.203337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:35.207433 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:41:35.209427 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m15:41:35.211588 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select volume
from "finance"."analytics_dev"."stg__stocks"
where volume is null



  
  
      
    ) dbt_internal_test
[0m15:41:35.253276 [debug] [Thread-3 (]: SQL status: OK in 1.260 seconds
[0m15:41:35.254529 [debug] [Thread-2 (]: SQL status: OK in 1.273 seconds
[0m15:41:35.255733 [debug] [Thread-4 (]: SQL status: OK in 1.262 seconds
[0m15:41:35.263923 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: ROLLBACK
[0m15:41:35.267284 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: ROLLBACK
[0m15:41:35.270985 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: ROLLBACK
[0m15:41:35.272453 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb'
[0m15:41:35.274163 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c'
[0m15:41:35.275546 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9'
[0m15:41:35.276603 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: Close
[0m15:41:35.277993 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: Close
[0m15:41:35.279317 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: Close
[0m15:41:35.281960 [info ] [Thread-2 (]: 82 of 111 PASS not_null_int__rsi_wilder_trade_date ............................. [[32mPASS[0m in 1.42s]
[0m15:41:35.286559 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m15:41:35.284170 [info ] [Thread-3 (]: 83 of 111 PASS not_null_int__rsi_wilder_wilder_gain ............................ [[32mPASS[0m in 1.40s]
[0m15:41:35.288030 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m15:41:35.285192 [info ] [Thread-4 (]: 84 of 111 PASS not_null_int__rsi_wilder_wilder_loss ............................ [[32mPASS[0m in 1.40s]
[0m15:41:35.290925 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m15:41:35.292212 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m15:41:35.296500 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m15:41:35.294300 [info ] [Thread-2 (]: 95 of 111 START test not_null_stg__vix_with_versions_close ..................... [RUN]
[0m15:41:35.298001 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m15:41:35.300235 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m15:41:35.302050 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c, now test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7)
[0m15:41:35.305412 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: ROLLBACK
[0m15:41:35.306145 [info ] [Thread-3 (]: 96 of 111 START test not_null_stg__vix_with_versions_complacent_max ............ [RUN]
[0m15:41:35.307899 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m15:41:35.306968 [info ] [Thread-4 (]: 97 of 111 START test not_null_stg__vix_with_versions_effective_date ............ [RUN]
[0m15:41:35.309722 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9, now test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a)
[0m15:41:35.311666 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0'
[0m15:41:35.322714 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m15:41:35.323843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb, now test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991)
[0m15:41:35.325443 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m15:41:35.327021 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: Close
[0m15:41:35.328728 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m15:41:35.339608 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m15:41:35.354894 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m15:41:35.355922 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m15:41:35.350391 [info ] [Thread-1 (]: 94 of 111 PASS not_null_stg__stocks_volume ..................................... [[32mPASS[0m in 0.18s]
[0m15:41:35.364199 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m15:41:35.365847 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m15:41:35.368571 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m15:41:35.370098 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m15:41:35.372840 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m15:41:35.371587 [info ] [Thread-1 (]: 98 of 111 START test not_null_stg__vix_with_versions_elevated_max .............. [RUN]
[0m15:41:35.381105 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m15:41:35.385471 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m15:41:35.390259 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m15:41:35.391423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0, now test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6)
[0m15:41:35.392812 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: BEGIN
[0m15:41:35.394452 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m15:41:35.396038 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:35.406317 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m15:41:35.409306 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m15:41:35.411131 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: BEGIN
[0m15:41:35.413390 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m15:41:35.415194 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m15:41:35.416066 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:35.416962 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: BEGIN
[0m15:41:35.417812 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m15:41:35.418431 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m15:41:35.420137 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:35.433168 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m15:41:35.435184 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."stg__vix_with_versions"
where close is null



  
  
      
    ) dbt_internal_test
[0m15:41:35.436334 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m15:41:35.438835 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m15:41:35.440646 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
where effective_date is null



  
  
      
    ) dbt_internal_test
[0m15:41:35.442876 [debug] [Thread-3 (]: SQL status: OK in 0.023 seconds
[0m15:41:35.444550 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m15:41:35.446180 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m15:41:35.447659 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select complacent_max
from "finance"."analytics_dev"."stg__vix_with_versions"
where complacent_max is null



  
  
      
    ) dbt_internal_test
[0m15:41:35.449510 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: BEGIN
[0m15:41:35.450605 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m15:41:35.452148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:35.459361 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: ROLLBACK
[0m15:41:35.460809 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m15:41:35.462592 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m15:41:35.464102 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991'
[0m15:41:35.465153 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select elevated_max
from "finance"."analytics_dev"."stg__vix_with_versions"
where elevated_max is null



  
  
      
    ) dbt_internal_test
[0m15:41:35.466256 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: Close
[0m15:41:35.469343 [info ] [Thread-4 (]: 97 of 111 PASS not_null_stg__vix_with_versions_effective_date .................. [[32mPASS[0m in 0.14s]
[0m15:41:35.471942 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m15:41:35.473531 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m15:41:35.475313 [info ] [Thread-4 (]: 99 of 111 START test not_null_stg__vix_with_versions_loaded_at ................. [RUN]
[0m15:41:35.477312 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991, now test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c)
[0m15:41:35.479116 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m15:41:35.490927 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m15:41:35.493050 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m15:41:35.615626 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m15:41:35.619233 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m15:41:35.621269 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: BEGIN
[0m15:41:35.620299 [debug] [Thread-2 (]: SQL status: OK in 0.182 seconds
[0m15:41:35.622559 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:35.626933 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:41:35.628348 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m15:41:35.629447 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."stg__vix_with_versions"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m15:41:35.630553 [debug] [Thread-1 (]: SQL status: OK in 0.163 seconds
[0m15:41:35.631771 [debug] [Thread-3 (]: SQL status: OK in 0.180 seconds
[0m15:41:35.635828 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: ROLLBACK
[0m15:41:35.638938 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7'
[0m15:41:35.640529 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: Close
[0m15:41:35.645912 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: ROLLBACK
[0m15:41:35.651019 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: ROLLBACK
[0m15:41:35.647472 [info ] [Thread-2 (]: 95 of 111 PASS not_null_stg__vix_with_versions_close ........................... [[32mPASS[0m in 0.35s]
[0m15:41:35.653356 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a'
[0m15:41:35.654790 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6'
[0m15:41:35.656230 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m15:41:35.657221 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: Close
[0m15:41:35.658207 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: Close
[0m15:41:35.659429 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m15:41:35.661355 [info ] [Thread-2 (]: 100 of 111 START test not_null_stg__vix_with_versions_normal_max ............... [RUN]
[0m15:41:35.667477 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7, now test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21)
[0m15:41:35.663374 [info ] [Thread-3 (]: 96 of 111 PASS not_null_stg__vix_with_versions_complacent_max .................. [[32mPASS[0m in 0.35s]
[0m15:41:35.669317 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m15:41:35.671965 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m15:41:35.666053 [info ] [Thread-1 (]: 98 of 111 PASS not_null_stg__vix_with_versions_elevated_max .................... [[32mPASS[0m in 0.27s]
[0m15:41:35.683610 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m15:41:35.684834 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m15:41:35.686435 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m15:41:35.687720 [info ] [Thread-3 (]: 101 of 111 START test not_null_stg__vix_with_versions_trade_date ............... [RUN]
[0m15:41:35.689857 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m15:41:35.691177 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a, now test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1)
[0m15:41:35.693875 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m15:41:35.695427 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m15:41:35.692456 [info ] [Thread-1 (]: 102 of 111 START test not_null_stg__vix_with_versions_version_id ............... [RUN]
[0m15:41:35.709228 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m15:41:35.720655 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m15:41:35.722774 [debug] [Thread-4 (]: SQL status: OK in 0.086 seconds
[0m15:41:35.724570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6, now test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c)
[0m15:41:35.727109 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m15:41:35.737698 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m15:41:35.742393 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: ROLLBACK
[0m15:41:35.744720 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m15:41:35.750966 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m15:41:35.752227 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m15:41:35.754225 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c'
[0m15:41:35.756116 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: BEGIN
[0m15:41:35.757597 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: Close
[0m15:41:35.758554 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m15:41:35.759771 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:35.769230 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m15:41:35.770669 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m15:41:35.764656 [info ] [Thread-4 (]: 99 of 111 PASS not_null_stg__vix_with_versions_loaded_at ....................... [[32mPASS[0m in 0.29s]
[0m15:41:35.773418 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: BEGIN
[0m15:41:35.776033 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m15:41:35.777720 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:35.778999 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m15:41:35.780743 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m15:41:35.783235 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m15:41:35.784664 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m15:41:35.787239 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m15:41:35.789029 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: BEGIN
[0m15:41:35.786109 [info ] [Thread-4 (]: 103 of 111 START test not_null_stg__vix_with_versions_version_name ............. [RUN]
[0m15:41:35.791517 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select normal_max
from "finance"."analytics_dev"."stg__vix_with_versions"
where normal_max is null



  
  
      
    ) dbt_internal_test
[0m15:41:35.793705 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m15:41:35.795436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:35.797154 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c, now test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb)
[0m15:41:35.799014 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."stg__vix_with_versions"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m15:41:35.801254 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m15:41:35.804943 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m15:41:35.813226 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m15:41:35.817548 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m15:41:35.818792 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_id
from "finance"."analytics_dev"."stg__vix_with_versions"
where version_id is null



  
  
      
    ) dbt_internal_test
[0m15:41:35.822227 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m15:41:35.829238 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m15:41:35.832527 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m15:41:35.834263 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: BEGIN
[0m15:41:35.835215 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:35.838407 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:41:35.839384 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m15:41:35.840512 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_name
from "finance"."analytics_dev"."stg__vix_with_versions"
where version_name is null



  
  
      
    ) dbt_internal_test
[0m15:41:35.864709 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m15:41:35.870265 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: ROLLBACK
[0m15:41:35.872052 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21'
[0m15:41:35.872981 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: Close
[0m15:41:35.875336 [info ] [Thread-2 (]: 100 of 111 PASS not_null_stg__vix_with_versions_normal_max ..................... [[32mPASS[0m in 0.21s]
[0m15:41:35.877542 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m15:41:35.878683 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m15:41:35.880029 [info ] [Thread-2 (]: 104 of 111 START test not_null_stg__vix_with_versions_version_rank ............. [RUN]
[0m15:41:35.881512 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21, now test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578)
[0m15:41:35.882498 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m15:41:35.894158 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m15:41:35.895613 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m15:41:35.896641 [debug] [Thread-3 (]: SQL status: OK in 0.094 seconds
[0m15:41:35.898917 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m15:41:35.905769 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m15:41:35.909730 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: ROLLBACK
[0m15:41:35.910999 [debug] [Thread-4 (]: SQL status: OK in 0.069 seconds
[0m15:41:35.914789 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: ROLLBACK
[0m15:41:35.917462 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c'
[0m15:41:35.923999 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: ROLLBACK
[0m15:41:35.919645 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m15:41:35.925460 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: Close
[0m15:41:35.927985 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1'
[0m15:41:35.929743 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: BEGIN
[0m15:41:35.931204 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb'
[0m15:41:35.932702 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: Close
[0m15:41:35.933926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:35.936561 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: Close
[0m15:41:35.935489 [info ] [Thread-1 (]: 102 of 111 PASS not_null_stg__vix_with_versions_version_id ..................... [[32mPASS[0m in 0.21s]
[0m15:41:35.939713 [info ] [Thread-3 (]: 101 of 111 PASS not_null_stg__vix_with_versions_trade_date ..................... [[32mPASS[0m in 0.25s]
[0m15:41:35.942540 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m15:41:35.944088 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m15:41:35.947269 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m15:41:35.945646 [info ] [Thread-4 (]: 103 of 111 PASS not_null_stg__vix_with_versions_version_name ................... [[32mPASS[0m in 0.15s]
[0m15:41:35.948714 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m15:41:35.949922 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m15:41:35.951144 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509
[0m15:41:35.952771 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m15:41:35.955699 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_rank
from "finance"."analytics_dev"."stg__vix_with_versions"
where version_rank is null



  
  
      
    ) dbt_internal_test
[0m15:41:35.953809 [info ] [Thread-1 (]: 105 of 111 START test relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_  [RUN]
[0m15:41:35.958794 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m15:41:35.957485 [info ] [Thread-3 (]: 106 of 111 START test relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_  [RUN]
[0m15:41:35.961239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c, now test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5)
[0m15:41:35.964466 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1, now test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509)
[0m15:41:35.963069 [info ] [Thread-4 (]: 107 of 111 START test unique_int__regime_changes_regime_period_id .............. [RUN]
[0m15:41:35.966680 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m15:41:35.968533 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509
[0m15:41:35.969716 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb, now test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1)
[0m15:41:36.005673 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m15:41:36.011516 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509"
[0m15:41:36.015676 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m15:41:36.032239 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m15:41:36.035437 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509
[0m15:41:36.044444 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509"
[0m15:41:36.046678 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m15:41:36.048426 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m15:41:36.054536 [debug] [Thread-2 (]: SQL status: OK in 0.094 seconds
[0m15:41:36.055864 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m15:41:36.062215 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m15:41:36.065008 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509"
[0m15:41:36.066131 [debug] [Thread-3 (]: On test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509: BEGIN
[0m15:41:36.067395 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:36.069762 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m15:41:36.071345 [debug] [Thread-1 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: BEGIN
[0m15:41:36.074706 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: ROLLBACK
[0m15:41:36.075909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:36.077821 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m15:41:36.078792 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m15:41:36.080804 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578'
[0m15:41:36.082633 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: BEGIN
[0m15:41:36.084244 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509"
[0m15:41:36.085466 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: Close
[0m15:41:36.086519 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m15:41:36.087424 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:36.088508 [debug] [Thread-3 (]: On test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select trade_date as from_field
    from "finance"."analytics_dev"."mrt__stocks_with_regimes"
    where trade_date is not null
),

parent as (
    select trade_date as to_field
    from "finance"."analytics_dev"."stg__stocks"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:41:36.090006 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m15:41:36.091684 [info ] [Thread-2 (]: 104 of 111 PASS not_null_stg__vix_with_versions_version_rank ................... [[32mPASS[0m in 0.21s]
[0m15:41:36.094797 [debug] [Thread-1 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select trade_date as from_field
    from "finance"."analytics_dev"."int__regime_classification"
    where trade_date is not null
),

parent as (
    select trade_date as to_field
    from "finance"."analytics_dev"."stg__vix_with_versions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:41:36.096773 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m15:41:36.097855 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m15:41:36.099666 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m15:41:36.101142 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m15:41:36.103391 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    regime_period_id as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."int__regime_changes"
where regime_period_id is not null
group by regime_period_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:41:36.102202 [info ] [Thread-2 (]: 108 of 111 START test unique_int__regime_classification_trade_date ............. [RUN]
[0m15:41:36.105818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578, now test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4)
[0m15:41:36.107413 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m15:41:36.119402 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m15:41:36.121811 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m15:41:36.128340 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m15:41:36.132900 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m15:41:36.134769 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: BEGIN
[0m15:41:36.136602 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:36.141166 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:41:36.141958 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m15:41:36.143355 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."int__regime_classification"
where trade_date is not null
group by trade_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:41:36.193856 [debug] [Thread-3 (]: SQL status: OK in 0.100 seconds
[0m15:41:36.199865 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m15:41:36.208273 [debug] [Thread-3 (]: On test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509: ROLLBACK
[0m15:41:36.211373 [debug] [Thread-4 (]: SQL status: OK in 0.106 seconds
[0m15:41:36.215296 [debug] [Thread-1 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: ROLLBACK
[0m15:41:36.217151 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509'
[0m15:41:36.218490 [debug] [Thread-3 (]: On test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509: Close
[0m15:41:36.220039 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5'
[0m15:41:36.222837 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: ROLLBACK
[0m15:41:36.224499 [debug] [Thread-1 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: Close
[0m15:41:36.223879 [info ] [Thread-3 (]: 106 of 111 PASS relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_  [[32mPASS[0m in 0.26s]
[0m15:41:36.226520 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1'
[0m15:41:36.229518 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509
[0m15:41:36.228111 [info ] [Thread-1 (]: 105 of 111 PASS relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_  [[32mPASS[0m in 0.27s]
[0m15:41:36.231114 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: Close
[0m15:41:36.233113 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m15:41:36.236237 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m15:41:36.242755 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m15:41:36.238688 [info ] [Thread-3 (]: 109 of 111 START test unique_regime_thresholds_effective_date .................. [RUN]
[0m15:41:36.247055 [debug] [Thread-2 (]: SQL status: OK in 0.102 seconds
[0m15:41:36.240951 [info ] [Thread-4 (]: 107 of 111 PASS unique_int__regime_changes_regime_period_id .................... [[32mPASS[0m in 0.27s]
[0m15:41:36.249317 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509, now test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c)
[0m15:41:36.245597 [info ] [Thread-1 (]: 110 of 111 START test unique_regime_thresholds_version_id ...................... [RUN]
[0m15:41:36.253116 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m15:41:36.254342 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m15:41:36.255821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5, now test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f)
[0m15:41:36.258318 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m15:41:36.263638 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: ROLLBACK
[0m15:41:36.280944 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m15:41:36.287249 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m15:41:36.288179 [info ] [Thread-4 (]: 111 of 111 START test wilder_seed_equals_sma ................................... [RUN]
[0m15:41:36.295109 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m15:41:36.296569 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4'
[0m15:41:36.297908 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1, now test.portfolio_project_2.wilder_seed_equals_sma)
[0m15:41:36.299600 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: Close
[0m15:41:36.301146 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.wilder_seed_equals_sma
[0m15:41:36.302850 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m15:41:36.308297 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m15:41:36.312015 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m15:41:36.315072 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m15:41:36.309647 [info ] [Thread-2 (]: 108 of 111 PASS unique_int__regime_classification_trade_date ................... [[32mPASS[0m in 0.20s]
[0m15:41:36.318862 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m15:41:36.320934 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m15:41:36.323734 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m15:41:36.325660 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: BEGIN
[0m15:41:36.327062 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.wilder_seed_equals_sma
[0m15:41:36.328219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:36.335618 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m15:41:36.336947 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m15:41:36.338897 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: BEGIN
[0m15:41:36.340513 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:36.342605 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m15:41:36.344341 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m15:41:36.345778 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    version_id as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."regime_thresholds"
where version_id is not null
group by version_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:41:36.346838 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:41:36.348809 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m15:41:36.350293 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m15:41:36.351319 [debug] [Thread-4 (]: On test.portfolio_project_2.wilder_seed_equals_sma: BEGIN
[0m15:41:36.352492 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    effective_date as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."regime_thresholds"
where effective_date is not null
group by effective_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:41:36.353608 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:36.358060 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:41:36.359753 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m15:41:36.361362 [debug] [Thread-4 (]: On test.portfolio_project_2.wilder_seed_equals_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.wilder_seed_equals_sma"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- asserts the seed matches SMA at rn=14
with w as (
  select ticker, trade_date, wilder_gain, wilder_loss
  from "finance"."analytics_dev"."int__rsi_wilder"
  where rn = 14
),
s as (
  select ticker, trade_date, sma_gain, sma_loss
  from "finance"."analytics_dev"."int__rsi_sma"
  where rn = 14
)
select
  w.ticker,
  w.trade_date
from w
join s using (ticker, trade_date)
where abs(w.wilder_gain - s.sma_gain) > 1e-9
   or abs(w.wilder_loss - s.sma_loss) > 1e-9
  
  
      
    ) dbt_internal_test
[0m15:41:36.485176 [debug] [Thread-3 (]: SQL status: OK in 0.130 seconds
[0m15:41:36.487116 [debug] [Thread-1 (]: SQL status: OK in 0.139 seconds
[0m15:41:36.501457 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: ROLLBACK
[0m15:41:36.507570 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: ROLLBACK
[0m15:41:36.510851 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c'
[0m15:41:36.515063 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: Close
[0m15:41:36.513573 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f'
[0m15:41:36.518930 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: Close
[0m15:41:36.522303 [info ] [Thread-3 (]: 109 of 111 PASS unique_regime_thresholds_effective_date ........................ [[32mPASS[0m in 0.27s]
[0m15:41:36.527043 [info ] [Thread-1 (]: 110 of 111 PASS unique_regime_thresholds_version_id ............................ [[32mPASS[0m in 0.27s]
[0m15:41:36.530802 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m15:41:36.535917 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m15:41:38.223196 [debug] [Thread-4 (]: SQL status: OK in 1.860 seconds
[0m15:41:38.236908 [debug] [Thread-4 (]: On test.portfolio_project_2.wilder_seed_equals_sma: ROLLBACK
[0m15:41:38.239942 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.wilder_seed_equals_sma'
[0m15:41:38.241790 [debug] [Thread-4 (]: On test.portfolio_project_2.wilder_seed_equals_sma: Close
[0m15:41:38.246504 [info ] [Thread-4 (]: 111 of 111 PASS wilder_seed_equals_sma ......................................... [[32mPASS[0m in 1.95s]
[0m15:41:38.249955 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m15:41:38.255738 [debug] [MainThread]: Using duckdb connection "master"
[0m15:41:38.257121 [debug] [MainThread]: On master: BEGIN
[0m15:41:38.258747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:41:38.264424 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m15:41:38.265829 [debug] [MainThread]: On master: COMMIT
[0m15:41:38.267147 [debug] [MainThread]: Using duckdb connection "master"
[0m15:41:38.268432 [debug] [MainThread]: On master: COMMIT
[0m15:41:38.272334 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:41:38.274109 [debug] [MainThread]: On master: Close
[0m15:41:38.276424 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:38.277264 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m15:41:38.278731 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m15:41:38.280165 [debug] [MainThread]: Connection 'test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f' was properly closed.
[0m15:41:38.280920 [debug] [MainThread]: Connection 'test.portfolio_project_2.wilder_seed_equals_sma' was properly closed.
[0m15:41:38.281647 [debug] [MainThread]: Connection 'test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c' was properly closed.
[0m15:41:38.282350 [debug] [MainThread]: Connection 'test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4' was properly closed.
[0m15:41:38.283333 [info ] [MainThread]: 
[0m15:41:38.284613 [info ] [MainThread]: Finished running 111 data tests in 0 hours 0 minutes and 14.11 seconds (14.11s).
[0m15:41:38.335989 [debug] [MainThread]: Command end result
[0m15:41:38.479978 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m15:41:38.483290 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m15:41:38.496748 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m15:41:38.497311 [info ] [MainThread]: 
[0m15:41:38.498367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:41:38.499169 [info ] [MainThread]: 
[0m15:41:38.499863 [info ] [MainThread]: Done. PASS=111 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=111
[0m15:41:38.501447 [debug] [MainThread]: Command `-c test` succeeded at 15:41:38.501289 after 16.08 seconds
[0m15:41:38.501893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A019171D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A04FA7E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A04FA7EE0>]}
[0m15:41:38.502351 [debug] [MainThread]: Flushing usage events
[0m15:41:39.591856 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:38.846372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260EC5F8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260ECE042D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260ED443ED0>]}


============================== 15:48:38.857662 | 2bdac8ba-f375-41df-8f10-15f9475f1cd2 ==============================
[0m15:48:38.857662 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:48:38.859371 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run-operation ingest_raw --args {source: stocks, folder: sources}', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:48:39.181400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bdac8ba-f375-41df-8f10-15f9475f1cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260EC7B0180>]}
[0m15:48:39.256569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bdac8ba-f375-41df-8f10-15f9475f1cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260ED2EB790>]}
[0m15:48:39.259739 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:48:39.562043 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:48:39.864177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:39.864676 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:39.956295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bdac8ba-f375-41df-8f10-15f9475f1cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260EED3CC50>]}
[0m15:48:40.208589 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m15:48:40.211511 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m15:48:40.260405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bdac8ba-f375-41df-8f10-15f9475f1cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260EC09C7D0>]}
[0m15:48:40.261467 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m15:48:40.262690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bdac8ba-f375-41df-8f10-15f9475f1cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260EE5EDE10>]}
[0m15:48:40.263758 [debug] [MainThread]: Acquiring new duckdb connection 'macro_ingest_raw'
[0m15:48:40.264626 [debug] [MainThread]: Using duckdb connection "macro_ingest_raw"
[0m15:48:40.265346 [debug] [MainThread]: On macro_ingest_raw: BEGIN
[0m15:48:40.266048 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:42.525574 [debug] [MainThread]: SQL status: OK in 2.259 seconds
[0m15:48:42.526670 [debug] [MainThread]: On macro_ingest_raw: COMMIT
[0m15:48:42.527609 [debug] [MainThread]: Using duckdb connection "macro_ingest_raw"
[0m15:48:42.528492 [debug] [MainThread]: On macro_ingest_raw: COMMIT
[0m15:48:42.530217 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:48:42.663112 [debug] [MainThread]: Using duckdb connection "macro_ingest_raw"
[0m15:48:42.663498 [debug] [MainThread]: On macro_ingest_raw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "macro_ingest_raw"} */

    create schema if not exists finance.raw;
  
[0m15:48:42.715043 [debug] [MainThread]: SQL status: OK in 0.051 seconds
[0m15:48:42.721189 [debug] [MainThread]: Using duckdb connection "macro_ingest_raw"
[0m15:48:42.722576 [debug] [MainThread]: On macro_ingest_raw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "macro_ingest_raw"} */

    create table if not exists finance.raw.stocks (trade_date date, ticker text, "open" double, high double, low double, "close" double, volume double, loaded_at timestamp default now());
  
[0m15:48:42.788142 [debug] [MainThread]: SQL status: OK in 0.064 seconds
[0m15:48:42.793743 [debug] [MainThread]: Using duckdb connection "macro_ingest_raw"
[0m15:48:42.795216 [debug] [MainThread]: On macro_ingest_raw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "macro_ingest_raw"} */

    
      insert into finance.raw.stocks
        (trade_date, ticker, "open", high, low, "close", volume, loaded_at)
      select
        cast(trade_date as date),
        cast(ticker as text),
        cast("open" as double),
        cast(high as double),
        cast(low as double),
        cast("close" as double),
        cast(volume as double),
        now()
      from read_csv_auto('sources/stocks/*.csv')
      where not exists (
        select 1
        from finance.raw.stocks t
        where t.ticker = cast(ticker as text)
          and t.trade_date = cast(trade_date as date)
      );
    
  
[0m15:48:43.431486 [debug] [MainThread]: SQL status: OK in 0.635 seconds
[0m15:48:43.434649 [debug] [MainThread]: On macro_ingest_raw: Close
[0m15:48:43.452716 [debug] [MainThread]: Wrote artifact RunResultsArtifact to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m15:48:43.455146 [debug] [MainThread]: Command `-c run-operation` succeeded at 15:48:43.454820 after 4.99 seconds
[0m15:48:43.455936 [debug] [MainThread]: Connection 'macro_ingest_raw' was properly closed.
[0m15:48:43.456622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F03CC870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260ED23F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260EE9DB590>]}
[0m15:48:43.457360 [debug] [MainThread]: Flushing usage events
[0m15:48:44.191250 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:55.208753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBA358050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBAB642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBB1A3ED0>]}


============================== 15:48:55.219920 | 555197ff-98a8-4b0f-aca6-596b3b87bde7 ==============================
[0m15:48:55.219920 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:48:55.221577 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation ingest_raw --args {source: vix, folder: sources}', 'printer_width': '80', 'target_path': 'None'}
[0m15:48:55.576401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '555197ff-98a8-4b0f-aca6-596b3b87bde7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBA510180>]}
[0m15:48:55.648079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '555197ff-98a8-4b0f-aca6-596b3b87bde7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBB04B790>]}
[0m15:48:55.651288 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:48:55.949307 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:48:56.212433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:56.212822 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:56.293493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '555197ff-98a8-4b0f-aca6-596b3b87bde7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBCB7CC50>]}
[0m15:48:56.531800 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m15:48:56.534876 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m15:48:56.580088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '555197ff-98a8-4b0f-aca6-596b3b87bde7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDB9DFC7D0>]}
[0m15:48:56.580739 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m15:48:56.581566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '555197ff-98a8-4b0f-aca6-596b3b87bde7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBC421E10>]}
[0m15:48:56.582232 [debug] [MainThread]: Acquiring new duckdb connection 'macro_ingest_raw'
[0m15:48:56.582616 [debug] [MainThread]: Using duckdb connection "macro_ingest_raw"
[0m15:48:56.583105 [debug] [MainThread]: On macro_ingest_raw: BEGIN
[0m15:48:56.583526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:59.035464 [debug] [MainThread]: SQL status: OK in 2.452 seconds
[0m15:48:59.037032 [debug] [MainThread]: On macro_ingest_raw: COMMIT
[0m15:48:59.038429 [debug] [MainThread]: Using duckdb connection "macro_ingest_raw"
[0m15:48:59.039757 [debug] [MainThread]: On macro_ingest_raw: COMMIT
[0m15:48:59.042371 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:48:59.189440 [debug] [MainThread]: Using duckdb connection "macro_ingest_raw"
[0m15:48:59.189850 [debug] [MainThread]: On macro_ingest_raw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "macro_ingest_raw"} */

    create schema if not exists finance.raw;
  
[0m15:48:59.268189 [debug] [MainThread]: SQL status: OK in 0.078 seconds
[0m15:48:59.273841 [debug] [MainThread]: Using duckdb connection "macro_ingest_raw"
[0m15:48:59.275117 [debug] [MainThread]: On macro_ingest_raw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "macro_ingest_raw"} */

    create table if not exists finance.raw.vix ("date" date, "close" double, loaded_at timestamp default now());
  
[0m15:48:59.339212 [debug] [MainThread]: SQL status: OK in 0.063 seconds
[0m15:48:59.344626 [debug] [MainThread]: Using duckdb connection "macro_ingest_raw"
[0m15:48:59.346888 [debug] [MainThread]: On macro_ingest_raw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "macro_ingest_raw"} */

    
      insert into finance.raw.vix
        (trade_date, "close", loaded_at)
      select
        cast(coalesce(trade_date) as date)        as trade_date,
        cast(coalesce("close") as double)   as "close",
        now()
      from read_csv_auto('sources/vix/*.csv')
      where not exists (
        select 1
        from finance.raw.vix t
        where t.trade_date = cast(coalesce(trade_date) as date)
      );
    
  
[0m15:48:59.651841 [debug] [MainThread]: SQL status: OK in 0.303 seconds
[0m15:48:59.657035 [debug] [MainThread]: On macro_ingest_raw: Close
[0m15:48:59.682631 [debug] [MainThread]: Wrote artifact RunResultsArtifact to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m15:48:59.685034 [debug] [MainThread]: Command `-c run-operation` succeeded at 15:48:59.684731 after 4.69 seconds
[0m15:48:59.685871 [debug] [MainThread]: Connection 'macro_ingest_raw' was properly closed.
[0m15:48:59.686742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBE20C870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBAF9B1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBC80B590>]}
[0m15:48:59.687652 [debug] [MainThread]: Flushing usage events
[0m15:49:00.393104 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:01:26.113518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB20398050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB20BA42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB211E7ED0>]}


============================== 16:01:26.131250 | da3a8485-4fe4-4001-888c-fc36204491e6 ==============================
[0m16:01:26.131250 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:01:26.134098 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m16:01:26.808946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB20550180>]}
[0m16:01:26.900930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB2108B790>]}
[0m16:01:26.904731 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:01:27.332511 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:01:27.663785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:01:27.664264 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:01:27.777497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB22B6CB50>]}
[0m16:01:28.078309 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:01:28.082397 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:01:28.174969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB22564B90>]}
[0m16:01:28.176441 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m16:01:28.178108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB22409B70>]}
[0m16:01:28.190536 [info ] [MainThread]: 
[0m16:01:28.192739 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:01:28.194193 [info ] [MainThread]: 
[0m16:01:28.196182 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:01:28.214683 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:01:28.432706 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:01:28.433223 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:01:28.433723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:30.705450 [debug] [ThreadPool]: SQL status: OK in 2.271 seconds
[0m16:01:30.710504 [debug] [ThreadPool]: On list_finance: Close
[0m16:01:30.713030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m16:01:30.714894 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m16:01:30.739601 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:01:30.741015 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:01:30.742232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:30.747892 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:01:30.752983 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:01:30.754231 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m16:01:30.757810 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:01:30.759086 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:01:30.760298 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m16:01:30.941121 [debug] [ThreadPool]: SQL status: OK in 0.179 seconds
[0m16:01:30.944809 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:01:30.946229 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:01:30.947551 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:01:30.999100 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m16:01:31.000639 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m16:01:31.010092 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m16:01:31.019671 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m16:01:31.041291 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:01:31.050612 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:01:31.052055 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m16:01:31.053632 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m16:01:31.055199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:31.056769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:31.060728 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:01:31.062688 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m16:01:31.064167 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:01:31.065738 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:01:31.067384 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m16:01:31.069097 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m16:01:31.163553 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m16:01:31.164270 [debug] [ThreadPool]: SQL status: OK in 0.094 seconds
[0m16:01:31.167032 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m16:01:31.169263 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m16:01:31.170930 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m16:01:31.171448 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m16:01:31.176742 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m16:01:31.177513 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m16:01:31.180535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB22DBADD0>]}
[0m16:01:31.181537 [debug] [MainThread]: Using duckdb connection "master"
[0m16:01:31.182240 [debug] [MainThread]: On master: BEGIN
[0m16:01:31.182911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:01:31.185207 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m16:01:31.185938 [debug] [MainThread]: On master: COMMIT
[0m16:01:31.186643 [debug] [MainThread]: Using duckdb connection "master"
[0m16:01:31.187332 [debug] [MainThread]: On master: COMMIT
[0m16:01:31.188644 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:01:31.189478 [debug] [MainThread]: On master: Close
[0m16:01:31.199441 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m16:01:31.200535 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m16:01:31.201922 [info ] [Thread-1 (]: 1 of 11 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m16:01:31.203200 [info ] [Thread-2 (]: 2 of 11 START sql view model analytics_dev.src_vix ............................. [RUN]
[0m16:01:31.204785 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m16:01:31.207138 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m16:01:31.208469 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m16:01:31.209691 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m16:01:31.232764 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m16:01:31.239506 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m16:01:31.242114 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m16:01:31.246625 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m16:01:31.379443 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m16:01:31.385322 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m16:01:31.389299 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:01:31.390838 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m16:01:31.392436 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:01:31.393961 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:01:31.395598 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m16:01:31.398433 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:01:31.400938 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:01:31.402580 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:01:31.404021 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m16:01:31.405678 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m16:01:31.407474 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:01:31.409966 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m16:01:31.509184 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m16:01:31.534497 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:01:31.536199 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m16:01:31.537822 [debug] [Thread-2 (]: SQL status: OK in 0.126 seconds
[0m16:01:31.552014 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:01:31.553662 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m16:01:31.642427 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m16:01:31.664482 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:01:31.666176 [debug] [Thread-2 (]: SQL status: OK in 0.111 seconds
[0m16:01:31.667895 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m16:01:31.680789 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:01:31.682461 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m16:01:31.774195 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m16:01:31.803035 [debug] [Thread-2 (]: SQL status: OK in 0.119 seconds
[0m16:01:31.835590 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m16:01:31.844653 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:01:31.846246 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:01:31.847961 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m16:01:31.849790 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:01:31.851863 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:01:32.017556 [debug] [Thread-2 (]: SQL status: OK in 0.164 seconds
[0m16:01:32.021059 [debug] [Thread-1 (]: SQL status: OK in 0.169 seconds
[0m16:01:32.061331 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:01:32.063647 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:01:32.065663 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m16:01:32.067594 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m16:01:32.298975 [debug] [Thread-2 (]: SQL status: OK in 0.229 seconds
[0m16:01:32.300719 [debug] [Thread-1 (]: SQL status: OK in 0.230 seconds
[0m16:01:32.310775 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m16:01:32.316309 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m16:01:32.326198 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB22F22810>]}
[0m16:01:32.327887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB22806DB0>]}
[0m16:01:32.330581 [info ] [Thread-2 (]: 2 of 11 OK created sql view model analytics_dev.src_vix ........................ [[32mOK[0m in 1.11s]
[0m16:01:32.336142 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m16:01:32.333112 [info ] [Thread-1 (]: 1 of 11 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 1.12s]
[0m16:01:32.340434 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m16:01:32.343335 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m16:01:32.345551 [info ] [Thread-3 (]: 3 of 11 START sql view model analytics_dev.stg__vix_with_versions .............. [RUN]
[0m16:01:32.348794 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__stocks
[0m16:01:32.351059 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m16:01:32.355231 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m16:01:32.353379 [info ] [Thread-4 (]: 4 of 11 START sql view model analytics_dev.stg__stocks ......................... [RUN]
[0m16:01:32.368926 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m16:01:32.371254 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m16:01:32.374208 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m16:01:32.387396 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m16:01:32.390385 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m16:01:32.405147 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m16:01:32.407668 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m16:01:32.422378 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m16:01:32.424727 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:01:32.426979 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m16:01:32.428659 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:01:32.432542 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:01:32.434268 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m16:01:32.435924 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m16:01:32.437746 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:01:32.439652 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:01:32.442389 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m16:01:32.445367 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m16:01:32.447472 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:01:32.449206 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m16:01:32.595770 [debug] [Thread-3 (]: SQL status: OK in 0.151 seconds
[0m16:01:32.608759 [debug] [Thread-4 (]: SQL status: OK in 0.157 seconds
[0m16:01:32.612365 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:01:32.624866 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:01:32.626668 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m16:01:32.628613 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m16:01:32.735660 [debug] [Thread-3 (]: SQL status: OK in 0.105 seconds
[0m16:01:32.753879 [debug] [Thread-4 (]: SQL status: OK in 0.123 seconds
[0m16:01:32.761168 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:01:32.773333 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:01:32.775105 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m16:01:32.777068 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m16:01:32.895119 [debug] [Thread-3 (]: SQL status: OK in 0.116 seconds
[0m16:01:32.901865 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m16:01:32.903742 [debug] [Thread-4 (]: SQL status: OK in 0.124 seconds
[0m16:01:32.905720 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:01:32.911337 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m16:01:32.913207 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m16:01:32.915541 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:01:32.917934 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m16:01:33.045317 [debug] [Thread-3 (]: SQL status: OK in 0.128 seconds
[0m16:01:33.049883 [debug] [Thread-4 (]: SQL status: OK in 0.130 seconds
[0m16:01:33.053289 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:01:33.060190 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:01:33.061379 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m16:01:33.062559 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m16:01:33.208083 [debug] [Thread-3 (]: SQL status: OK in 0.144 seconds
[0m16:01:33.209438 [debug] [Thread-4 (]: SQL status: OK in 0.145 seconds
[0m16:01:33.212867 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m16:01:33.216178 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: Close
[0m16:01:33.217746 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB244EACB0>]}
[0m16:01:33.220610 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB211EE750>]}
[0m16:01:33.219358 [info ] [Thread-3 (]: 3 of 11 OK created sql view model analytics_dev.stg__vix_with_versions ......... [[32mOK[0m in 0.87s]
[0m16:01:33.222554 [info ] [Thread-4 (]: 4 of 11 OK created sql view model analytics_dev.stg__stocks .................... [[32mOK[0m in 0.85s]
[0m16:01:33.224159 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m16:01:33.226522 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m16:01:33.228619 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m16:01:33.229723 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__price_changes
[0m16:01:33.231069 [info ] [Thread-2 (]: 5 of 11 START sql view model analytics_dev.int__regime_classification .......... [RUN]
[0m16:01:33.234158 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_classification)
[0m16:01:33.232345 [info ] [Thread-1 (]: 6 of 11 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m16:01:33.236184 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m16:01:33.237565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__price_changes)
[0m16:01:33.245652 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m16:01:33.246763 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m16:01:33.258790 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m16:01:33.260947 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m16:01:33.271237 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m16:01:33.273666 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m16:01:33.283061 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m16:01:33.284924 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:01:33.286007 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m16:01:33.287079 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:33.288918 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:01:33.290574 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m16:01:33.291584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:33.292624 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:01:33.294188 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:01:33.295419 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:01:33.297129 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:01:33.298196 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:01:33.299348 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."stg__stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:01:33.427566 [debug] [Thread-2 (]: SQL status: OK in 0.131 seconds
[0m16:01:33.435871 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:01:33.437358 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m16:01:33.446042 [debug] [Thread-1 (]: SQL status: OK in 0.145 seconds
[0m16:01:33.453530 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:01:33.454629 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m16:01:33.519885 [debug] [Thread-2 (]: SQL status: OK in 0.081 seconds
[0m16:01:33.527827 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:01:33.528931 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m16:01:33.655547 [debug] [Thread-2 (]: SQL status: OK in 0.125 seconds
[0m16:01:33.659715 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m16:01:33.661166 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:01:33.662474 [debug] [Thread-1 (]: SQL status: OK in 0.207 seconds
[0m16:01:33.663926 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m16:01:33.674624 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:01:33.676683 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m16:01:33.755565 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m16:01:33.758780 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m16:01:33.759797 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:01:33.760734 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m16:01:33.822739 [debug] [Thread-2 (]: SQL status: OK in 0.146 seconds
[0m16:01:33.828969 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:01:33.830085 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m16:01:33.907916 [debug] [Thread-1 (]: SQL status: OK in 0.146 seconds
[0m16:01:33.914928 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:01:33.916070 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m16:01:34.082184 [debug] [Thread-2 (]: SQL status: OK in 0.251 seconds
[0m16:01:34.083113 [debug] [Thread-1 (]: SQL status: OK in 0.166 seconds
[0m16:01:34.086163 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m16:01:34.089191 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: Close
[0m16:01:34.090389 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB244D40C0>]}
[0m16:01:34.091524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB245033F0>]}
[0m16:01:34.093002 [info ] [Thread-2 (]: 5 of 11 OK created sql view model analytics_dev.int__regime_classification ..... [[32mOK[0m in 0.86s]
[0m16:01:34.095903 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m16:01:34.094433 [info ] [Thread-1 (]: 6 of 11 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.85s]
[0m16:01:34.097606 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m16:01:34.099099 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m16:01:34.100006 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m16:01:34.101016 [info ] [Thread-3 (]: 7 of 11 START sql view model analytics_dev.int__regime_changes ................. [RUN]
[0m16:01:34.103500 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now model.portfolio_project_2.int__regime_changes)
[0m16:01:34.104292 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m16:01:34.102158 [info ] [Thread-4 (]: 8 of 11 START sql view model analytics_dev.int__rsi_sma ........................ [RUN]
[0m16:01:34.110266 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m16:01:34.111270 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now model.portfolio_project_2.int__rsi_sma)
[0m16:01:34.112414 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m16:01:34.120469 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m16:01:34.122323 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m16:01:34.130609 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m16:01:34.132191 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m16:01:34.139692 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m16:01:34.141653 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:01:34.142804 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m16:01:34.143731 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:34.145660 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:01:34.146712 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m16:01:34.147671 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:01:34.148692 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:34.150020 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:01:34.152739 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m16:01:34.155340 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m16:01:34.156461 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:01:34.157554 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    sma_gain::decimal(18,2) as sma_gain,
    sma_loss::decimal(18,2) as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m16:01:34.290248 [debug] [Thread-4 (]: SQL status: OK in 0.132 seconds
[0m16:01:34.298236 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:01:34.299370 [debug] [Thread-3 (]: SQL status: OK in 0.145 seconds
[0m16:01:34.300483 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m16:01:34.308717 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:01:34.310366 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m16:01:34.409511 [debug] [Thread-4 (]: SQL status: OK in 0.100 seconds
[0m16:01:34.427362 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:01:34.428504 [debug] [Thread-3 (]: SQL status: OK in 0.117 seconds
[0m16:01:34.429586 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m16:01:34.438121 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:01:34.439609 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m16:01:34.544935 [debug] [Thread-4 (]: SQL status: OK in 0.106 seconds
[0m16:01:34.548999 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m16:01:34.550312 [debug] [Thread-3 (]: SQL status: OK in 0.110 seconds
[0m16:01:34.551676 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:01:34.555911 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m16:01:34.557469 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m16:01:34.559076 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:01:34.560926 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m16:01:34.707750 [debug] [Thread-3 (]: SQL status: OK in 0.145 seconds
[0m16:01:34.715075 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:01:34.716172 [debug] [Thread-4 (]: SQL status: OK in 0.156 seconds
[0m16:01:34.717272 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m16:01:34.724128 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:01:34.725735 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m16:01:34.897773 [debug] [Thread-4 (]: SQL status: OK in 0.171 seconds
[0m16:01:34.898887 [debug] [Thread-3 (]: SQL status: OK in 0.174 seconds
[0m16:01:34.902429 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m16:01:34.905959 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m16:01:34.907522 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB22803290>]}
[0m16:01:34.908793 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB228035F0>]}
[0m16:01:34.910392 [info ] [Thread-4 (]: 8 of 11 OK created sql view model analytics_dev.int__rsi_sma ................... [[32mOK[0m in 0.80s]
[0m16:01:34.913877 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m16:01:34.911917 [info ] [Thread-3 (]: 7 of 11 OK created sql view model analytics_dev.int__regime_changes ............ [[32mOK[0m in 0.81s]
[0m16:01:34.915811 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m16:01:34.917575 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m16:01:34.919113 [info ] [Thread-2 (]: 9 of 11 START sql view model analytics_dev.int__rsi_wilder ..................... [RUN]
[0m16:01:34.921129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_classification, now model.portfolio_project_2.int__rsi_wilder)
[0m16:01:34.922404 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m16:01:34.923499 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:01:34.932534 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m16:01:34.934148 [info ] [Thread-1 (]: 10 of 11 START sql incremental model analytics_dev.mrt__stocks_with_regimes .... [RUN]
[0m16:01:34.936082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m16:01:34.937399 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:01:34.964200 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:34.965322 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m16:01:34.976818 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m16:01:34.978205 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:01:34.989048 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:34.990242 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__96180677858f" cascade
    
[0m16:01:34.991273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:34.992507 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:01:34.994310 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m16:01:34.995421 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:34.998280 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:01:34.999363 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:01:35.000780 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    wilder_gain::decimal(18,2) as wilder_gain,
    wilder_loss::decimal(18,2) as wilder_loss
from wilder
  );

[0m16:01:35.048092 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m16:01:35.130641 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:35.132068 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:01:35.137102 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:01:35.140909 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:35.141971 [debug] [Thread-2 (]: SQL status: OK in 0.139 seconds
[0m16:01:35.143127 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m16:01:35.151329 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:01:35.152911 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m16:01:35.154563 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:01:35.155644 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:35.156671 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m16:01:35.205782 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m16:01:35.208459 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:35.209659 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m16:01:35.210808 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:01:35.213635 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:01:35.214608 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:35.215546 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:01:35.237504 [debug] [Thread-2 (]: SQL status: OK in 0.083 seconds
[0m16:01:35.244893 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:01:35.245957 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m16:01:35.269983 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m16:01:35.343930 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:35.345846 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:01:35.351712 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m16:01:35.357630 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m16:01:35.359442 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:01:35.361444 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m16:01:35.364418 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m16:01:35.433048 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:35.434556 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,0))
 as volume, 
      
    cast(null as text)
 as regime
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:01:35.438615 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:01:35.483789 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:35.484576 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."mrt__stocks_with_regimes__96180677858f"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null
    
    )
 ;
    insert into "finance"."dbt_temp"."mrt__stocks_with_regimes__96180677858f" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m16:01:35.490971 [debug] [Thread-2 (]: SQL status: OK in 0.128 seconds
[0m16:01:35.495090 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:01:35.496110 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m16:01:35.685306 [debug] [Thread-2 (]: SQL status: OK in 0.188 seconds
[0m16:01:35.690542 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m16:01:35.692546 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB24414EF0>]}
[0m16:01:35.694804 [info ] [Thread-2 (]: 9 of 11 OK created sql view model analytics_dev.int__rsi_wilder ................ [[32mOK[0m in 0.77s]
[0m16:01:35.697793 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m16:01:35.700059 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.fct__rsi
[0m16:01:35.701997 [info ] [Thread-4 (]: 11 of 11 START sql incremental model analytics_dev.fct__rsi .................... [RUN]
[0m16:01:35.704490 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_sma, now model.portfolio_project_2.fct__rsi)
[0m16:01:35.706550 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m16:01:35.725115 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m16:01:35.727539 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m16:01:35.741897 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:35.742702 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__6589072d20f4" cascade
    
[0m16:01:35.743478 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:35.814282 [debug] [Thread-4 (]: SQL status: OK in 0.071 seconds
[0m16:01:35.820640 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:35.821701 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:01:35.825388 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:01:35.829007 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:35.830068 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m16:01:35.832847 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:01:35.833842 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:35.834785 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m16:01:35.847350 [debug] [Thread-1 (]: SQL status: OK in 0.362 seconds
[0m16:01:35.866138 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:35.867304 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m16:01:35.870301 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:01:35.871355 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:35.872372 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__96180677858f'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:01:35.887318 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m16:01:35.900256 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:35.901834 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:01:35.904220 [debug] [Thread-4 (]: SQL status: OK in 0.068 seconds
[0m16:01:35.906992 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:35.907973 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    

  
[0m16:01:35.909111 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m16:01:35.912111 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m16:01:35.913169 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:35.914176 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m16:01:35.916400 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m16:01:35.956077 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:35.957212 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__96180677858f'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:01:35.970633 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m16:01:35.978901 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:35.980655 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:01:35.990289 [debug] [Thread-4 (]: SQL status: OK in 0.075 seconds
[0m16:01:35.992483 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:35.993664 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:01:35.995963 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m16:01:36.018788 [debug] [Thread-1 (]: 
    In "finance"."analytics_dev"."mrt__stocks_with_regimes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:01:36.020135 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:36.021395 [debug] [Thread-4 (]: SQL status: OK in 0.026 seconds
[0m16:01:36.022505 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
SELECT version()
[0m16:01:36.024890 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:36.048306 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:36.054695 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as sma_rs, 
      
    cast(null as decimal(18,2))
 as sma_rsi, 
      
    cast(null as decimal(18,2))
 as wilder_rs, 
      
    cast(null as decimal(18,2))
 as wilder_rsi
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:01:36.096175 [debug] [Thread-4 (]: SQL status: OK in 0.033 seconds
[0m16:01:36.131306 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:36.143923 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."fct__rsi__6589072d20f4"
  
  (
    trade_date date not null,
    ticker text not null,
    sma_rs decimal(18,2),
    sma_rsi decimal(18,2),
    wilder_rs decimal(18,2),
    wilder_rsi decimal(18,2)
    
    )
 ;
    insert into "finance"."dbt_temp"."fct__rsi__6589072d20f4" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      sma_rs ,
    
      
      sma_rsi ,
    
      
      wilder_rs ,
    
      
      wilder_rsi 
    
  )
 (
      
    select trade_date, ticker, sma_rs, sma_rsi, wilder_rs, wilder_rsi
    from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as model_subq
    );
  
  
  
[0m16:01:36.222580 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:36.225052 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:36.226151 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */


    MERGE INTO "finance"."analytics_dev"."mrt__stocks_with_regimes" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."mrt__stocks_with_regimes__96180677858f" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m16:01:36.477623 [debug] [Thread-1 (]: SQL status: OK in 0.250 seconds
[0m16:01:36.482786 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:01:36.484410 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:36.485925 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:01:36.749373 [debug] [Thread-1 (]: SQL status: OK in 0.262 seconds
[0m16:01:36.759201 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:36.760723 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__96180677858f" cascade
    
[0m16:01:37.034449 [debug] [Thread-1 (]: SQL status: OK in 0.272 seconds
[0m16:01:37.042009 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:01:37.042834 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__96180677858f" cascade
    
[0m16:01:37.101013 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m16:01:37.106300 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m16:01:37.107678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB22B92090>]}
[0m16:01:37.109345 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes  [[32mOK[0m in 2.17s]
[0m16:01:37.111360 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:01:39.684432 [debug] [Thread-4 (]: SQL status: OK in 3.525 seconds
[0m16:01:39.698476 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:39.700224 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m16:01:39.704766 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:01:39.706459 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:39.708140 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__6589072d20f4'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:01:39.729634 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m16:01:39.741678 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:39.743822 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:01:39.764425 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m16:01:39.778081 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:39.779817 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__6589072d20f4'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:01:39.798497 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m16:01:39.806534 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:39.807431 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:01:39.817538 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m16:01:39.820849 [debug] [Thread-4 (]: 
    In "finance"."analytics_dev"."fct__rsi":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:01:39.823669 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m16:01:39.825175 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:39.825920 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */


    MERGE INTO "finance"."analytics_dev"."fct__rsi" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."fct__rsi__6589072d20f4" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m16:01:39.913230 [debug] [Thread-4 (]: SQL status: OK in 0.086 seconds
[0m16:01:39.918620 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m16:01:39.920301 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:39.921872 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m16:01:39.981233 [debug] [Thread-4 (]: SQL status: OK in 0.058 seconds
[0m16:01:39.991257 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:39.993058 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__6589072d20f4" cascade
    
[0m16:01:40.214625 [debug] [Thread-4 (]: SQL status: OK in 0.220 seconds
[0m16:01:40.220696 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:01:40.221376 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__6589072d20f4" cascade
    
[0m16:01:40.275882 [debug] [Thread-4 (]: SQL status: OK in 0.054 seconds
[0m16:01:40.279017 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: Close
[0m16:01:40.280391 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3a8485-4fe4-4001-888c-fc36204491e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB22B907D0>]}
[0m16:01:40.282719 [info ] [Thread-4 (]: 11 of 11 OK created sql incremental model analytics_dev.fct__rsi ............... [[32mOK[0m in 4.58s]
[0m16:01:40.285236 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m16:01:40.289716 [debug] [MainThread]: Using duckdb connection "master"
[0m16:01:40.291102 [debug] [MainThread]: On master: BEGIN
[0m16:01:40.292359 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:01:40.297608 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:01:40.299616 [debug] [MainThread]: On master: COMMIT
[0m16:01:40.301002 [debug] [MainThread]: Using duckdb connection "master"
[0m16:01:40.302311 [debug] [MainThread]: On master: COMMIT
[0m16:01:40.304974 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:01:40.306392 [debug] [MainThread]: On master: Close
[0m16:01:40.308153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:40.309480 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m16:01:40.310786 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m16:01:40.312003 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m16:01:40.313186 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m16:01:40.314365 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m16:01:40.315535 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m16:01:40.316710 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m16:01:40.318376 [info ] [MainThread]: 
[0m16:01:40.320636 [info ] [MainThread]: Finished running 2 incremental models, 9 view models in 0 hours 0 minutes and 12.12 seconds (12.12s).
[0m16:01:40.330771 [debug] [MainThread]: Command end result
[0m16:01:40.488522 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:01:40.492697 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:01:40.503395 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m16:01:40.503969 [info ] [MainThread]: 
[0m16:01:40.504862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:40.505641 [info ] [MainThread]: 
[0m16:01:40.506521 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m16:01:40.508132 [debug] [MainThread]: Command `-c run` succeeded at 16:01:40.507941 after 14.84 seconds
[0m16:01:40.508748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB20432E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB227B7D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB227B78F0>]}
[0m16:01:40.509361 [debug] [MainThread]: Flushing usage events
[0m16:01:41.777359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:12.347222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275CDC18050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275CE4242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275CEA63ED0>]}


============================== 16:07:12.363812 | c7fbbe7f-4617-4319-b28d-7b493a5c4f78 ==============================
[0m16:07:12.363812 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:07:12.366357 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt snapshot', 'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m16:07:12.881924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7fbbe7f-4617-4319-b28d-7b493a5c4f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275CDDD0180>]}
[0m16:07:13.025278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7fbbe7f-4617-4319-b28d-7b493a5c4f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275CE90B790>]}
[0m16:07:13.028976 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:07:13.640567 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:07:14.000480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:07:14.001430 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://macros\ingest_sources.sql
[0m16:07:14.303162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7fbbe7f-4617-4319-b28d-7b493a5c4f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275D03E0850>]}
[0m16:07:14.584181 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:07:14.587618 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:07:14.653594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7fbbe7f-4617-4319-b28d-7b493a5c4f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275CD6BC7D0>]}
[0m16:07:14.654374 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m16:07:14.655346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7fbbe7f-4617-4319-b28d-7b493a5c4f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275CE922970>]}
[0m16:07:14.661612 [info ] [MainThread]: 
[0m16:07:14.662678 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:07:14.663607 [info ] [MainThread]: 
[0m16:07:14.664861 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:07:14.673619 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:07:14.879441 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:07:14.880015 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:07:14.880482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:16.826485 [debug] [ThreadPool]: SQL status: OK in 1.946 seconds
[0m16:07:16.831478 [debug] [ThreadPool]: On list_finance: Close
[0m16:07:16.834032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev_snapshots)
[0m16:07:16.836049 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev_snapshots"
"
[0m16:07:16.859569 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:07:16.860911 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev_snapshots"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:07:16.862136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:16.867612 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:07:16.872683 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:07:16.873952 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: BEGIN
[0m16:07:16.877553 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:07:16.878796 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:07:16.880023 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev_snapshots"} */

    
    
        create schema if not exists "finance"."analytics_dev_snapshots"
    
[0m16:07:16.940175 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m16:07:16.944073 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: COMMIT
[0m16:07:16.946820 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:07:16.950446 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: COMMIT
[0m16:07:17.015046 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m16:07:17.016623 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: Close
[0m16:07:17.025582 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m16:07:17.037956 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m16:07:17.051836 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:07:17.060749 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:07:17.062493 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m16:07:17.064066 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m16:07:17.065573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:17.067096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:17.071077 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:07:17.072434 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:07:17.073716 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m16:07:17.075244 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m16:07:17.076856 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:07:17.079227 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m16:07:17.171539 [debug] [ThreadPool]: SQL status: OK in 0.093 seconds
[0m16:07:17.172305 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m16:07:17.174650 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m16:07:17.176901 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m16:07:17.179101 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m16:07:17.179914 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m16:07:17.180467 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m16:07:17.181090 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m16:07:17.186534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7fbbe7f-4617-4319-b28d-7b493a5c4f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275D06475F0>]}
[0m16:07:17.187242 [debug] [MainThread]: Using duckdb connection "master"
[0m16:07:17.187704 [debug] [MainThread]: On master: BEGIN
[0m16:07:17.188130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:17.189657 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m16:07:17.190125 [debug] [MainThread]: On master: COMMIT
[0m16:07:17.190577 [debug] [MainThread]: Using duckdb connection "master"
[0m16:07:17.191007 [debug] [MainThread]: On master: COMMIT
[0m16:07:17.191843 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:07:17.192308 [debug] [MainThread]: On master: Close
[0m16:07:17.199542 [debug] [Thread-1 (]: Began running node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:07:17.200263 [debug] [Thread-2 (]: Began running node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:07:17.201169 [info ] [Thread-1 (]: 1 of 2 START snapshot analytics_dev_snapshots.regime_classification_snapshot ... [RUN]
[0m16:07:17.202953 [debug] [Thread-1 (]: Acquiring new duckdb connection 'snapshot.portfolio_project_2.regime_classification_snapshot'
[0m16:07:17.203579 [debug] [Thread-1 (]: Began compiling node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:07:17.217125 [debug] [Thread-1 (]: Began executing node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:07:17.202013 [info ] [Thread-2 (]: 2 of 2 START snapshot analytics_dev_snapshots.stg__stocks_snapshot ............. [RUN]
[0m16:07:17.221939 [debug] [Thread-2 (]: Acquiring new duckdb connection 'snapshot.portfolio_project_2.stg__stocks_snapshot'
[0m16:07:17.222645 [debug] [Thread-2 (]: Began compiling node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:07:17.234128 [debug] [Thread-2 (]: Began executing node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:07:17.422521 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:07:17.424901 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: BEGIN
[0m16:07:17.436388 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:07:17.437896 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:07:17.439575 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: BEGIN
[0m16:07:17.444027 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:07:17.446604 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m16:07:17.448197 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:07:17.449713 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:07:17.451330 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:07:17.453072 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:07:17.455441 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:07:17.473585 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m16:07:17.475493 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:07:17.792655 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:07:17.794724 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:07:17.796557 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

        
  
    
    

    create  table
      "stg__stocks_snapshot__dbt_tmp20251113160717753940"
  
    as (
      
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."src_stocks"

    ),

    snapshotted_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    

        from "finance"."analytics_dev_snapshots"."stg__stocks_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(ticker as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
  
    
[0m16:07:17.798763 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

        
  
    
    

    create  table
      "regime_classification_snapshot__dbt_tmp20251113160717743034"
  
    as (
      
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."int__regime_classification"

    ),

    snapshotted_data as (

        select *, 
    
        trade_date as dbt_unique_key
    

        from "finance"."analytics_dev_snapshots"."regime_classification_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
  
    
[0m16:07:18.100053 [debug] [Thread-2 (]: SQL status: OK in 0.299 seconds
[0m16:07:18.121331 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:07:18.123090 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot__dbt_tmp20251113160717753940'
      
      
      order by ordinal_position

  
[0m16:07:18.144907 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m16:07:18.158154 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:07:18.159933 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:07:18.179252 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m16:07:18.187733 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:07:18.188684 [debug] [Thread-1 (]: SQL status: OK in 0.386 seconds
[0m16:07:18.189694 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot__dbt_tmp20251113160717753940'
      
      
      order by ordinal_position

  
[0m16:07:18.195442 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:07:18.196595 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251113160717743034'
      
      
      order by ordinal_position

  
[0m16:07:18.207651 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m16:07:18.216565 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:07:18.217656 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:07:18.218754 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m16:07:18.227749 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:07:18.228899 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:07:18.232097 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m16:07:18.248988 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:07:18.250086 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m16:07:18.251179 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot__dbt_tmp20251113160717753940'
      
      
      order by ordinal_position

  
[0m16:07:18.259901 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:07:18.261020 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251113160717743034'
      
      
      order by ordinal_position

  
[0m16:07:18.264444 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m16:07:18.306315 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m16:07:18.310357 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:07:18.312005 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */
DESCRIBE (select * from (
        
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."src_stocks"

    ),

    snapshotted_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    

        from "finance"."analytics_dev_snapshots"."stg__stocks_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(ticker as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:07:18.320791 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:07:18.323333 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:07:18.329509 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:07:18.336987 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m16:07:18.344860 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:07:18.345920 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251113160717743034'
      
      
      order by ordinal_position

  
[0m16:07:18.359749 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:07:18.360887 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:07:18.363697 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:07:18.365238 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:07:18.366445 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m16:07:18.371849 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:07:18.373063 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */
DESCRIBE (select * from (
        
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."int__regime_classification"

    ),

    snapshotted_data as (

        select *, 
    
        trade_date as dbt_unique_key
    

        from "finance"."analytics_dev_snapshots"."regime_classification_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:07:18.375702 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:07:18.376888 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      update "finance"."analytics_dev_snapshots"."stg__stocks_snapshot" as DBT_INTERNAL_TARGET
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "stg__stocks_snapshot__dbt_tmp20251113160717753940" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = DBT_INTERNAL_TARGET.dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and DBT_INTERNAL_TARGET.dbt_valid_to is null;
      

    insert into "finance"."analytics_dev_snapshots"."stg__stocks_snapshot" ("trade_date", "ticker", "open", "high", "low", "close", "volume", "loaded_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."trade_date",DBT_INTERNAL_SOURCE."ticker",DBT_INTERNAL_SOURCE."open",DBT_INTERNAL_SOURCE."high",DBT_INTERNAL_SOURCE."low",DBT_INTERNAL_SOURCE."close",DBT_INTERNAL_SOURCE."volume",DBT_INTERNAL_SOURCE."loaded_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "stg__stocks_snapshot__dbt_tmp20251113160717753940" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;


  
[0m16:07:18.382298 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:07:18.393815 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:07:18.394863 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:07:18.397273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:07:18.398801 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:07:18.401435 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:07:18.402538 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      update "finance"."analytics_dev_snapshots"."regime_classification_snapshot" as DBT_INTERNAL_TARGET
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "regime_classification_snapshot__dbt_tmp20251113160717743034" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = DBT_INTERNAL_TARGET.dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and DBT_INTERNAL_TARGET.dbt_valid_to is null;
      

    insert into "finance"."analytics_dev_snapshots"."regime_classification_snapshot" ("trade_date", "close", "regime", "loaded_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."trade_date",DBT_INTERNAL_SOURCE."close",DBT_INTERNAL_SOURCE."regime",DBT_INTERNAL_SOURCE."loaded_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "regime_classification_snapshot__dbt_tmp20251113160717743034" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;


  
[0m16:07:18.522017 [debug] [Thread-2 (]: SQL status: OK in 0.144 seconds
[0m16:07:18.562046 [debug] [Thread-1 (]: SQL status: OK in 0.158 seconds
[0m16:07:18.573743 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: COMMIT
[0m16:07:18.568924 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: COMMIT
[0m16:07:18.575788 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:07:18.577666 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:07:18.579539 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: COMMIT
[0m16:07:18.581523 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: COMMIT
[0m16:07:18.860032 [debug] [Thread-1 (]: SQL status: OK in 0.277 seconds
[0m16:07:18.871873 [debug] [Thread-2 (]: SQL status: OK in 0.288 seconds
[0m16:07:18.889016 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:07:18.886510 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:07:18.891425 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      drop table if exists "stg__stocks_snapshot__dbt_tmp20251113160717753940" cascade
    
[0m16:07:18.893356 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      drop table if exists "regime_classification_snapshot__dbt_tmp20251113160717743034" cascade
    
[0m16:07:19.048613 [debug] [Thread-2 (]: SQL status: OK in 0.153 seconds
[0m16:07:19.049925 [debug] [Thread-1 (]: SQL status: OK in 0.154 seconds
[0m16:07:19.056897 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: Close
[0m16:07:19.060820 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: Close
[0m16:07:19.067999 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7fbbe7f-4617-4319-b28d-7b493a5c4f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275D00A3D10>]}
[0m16:07:19.069163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7fbbe7f-4617-4319-b28d-7b493a5c4f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275D1D485D0>]}
[0m16:07:19.071515 [info ] [Thread-2 (]: 2 of 2 OK snapshotted analytics_dev_snapshots.stg__stocks_snapshot ............. [[32mOK[0m in 1.84s]
[0m16:07:19.075833 [debug] [Thread-2 (]: Finished running node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:07:19.073679 [info ] [Thread-1 (]: 1 of 2 OK snapshotted analytics_dev_snapshots.regime_classification_snapshot ... [[32mOK[0m in 1.86s]
[0m16:07:19.078664 [debug] [Thread-1 (]: Finished running node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:07:19.082728 [debug] [MainThread]: Using duckdb connection "master"
[0m16:07:19.083808 [debug] [MainThread]: On master: BEGIN
[0m16:07:19.084767 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:07:19.088009 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m16:07:19.089026 [debug] [MainThread]: On master: COMMIT
[0m16:07:19.089958 [debug] [MainThread]: Using duckdb connection "master"
[0m16:07:19.090866 [debug] [MainThread]: On master: COMMIT
[0m16:07:19.092612 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:07:19.094157 [debug] [MainThread]: On master: Close
[0m16:07:19.095784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:19.096708 [debug] [MainThread]: Connection 'create_finance_analytics_dev_snapshots' was properly closed.
[0m16:07:19.097560 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m16:07:19.098396 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m16:07:19.099252 [debug] [MainThread]: Connection 'snapshot.portfolio_project_2.regime_classification_snapshot' was properly closed.
[0m16:07:19.100092 [debug] [MainThread]: Connection 'snapshot.portfolio_project_2.stg__stocks_snapshot' was properly closed.
[0m16:07:19.101086 [info ] [MainThread]: 
[0m16:07:19.103029 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m16:07:19.108326 [debug] [MainThread]: Command end result
[0m16:07:19.267607 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:07:19.271733 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:07:19.281356 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m16:07:19.281930 [info ] [MainThread]: 
[0m16:07:19.282969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:19.283675 [info ] [MainThread]: 
[0m16:07:19.284447 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m16:07:19.285972 [debug] [MainThread]: Command `-c snapshot` succeeded at 16:07:19.285771 after 7.39 seconds
[0m16:07:19.286581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275D0082B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275D006A180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275CFFACF50>]}
[0m16:07:19.287184 [debug] [MainThread]: Flushing usage events
[0m16:07:20.197938 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:52.243677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4132C8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E413AD42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E414117ED0>]}


============================== 16:08:52.261792 | 28100e14-9e6a-471c-9585-84c4f377298a ==============================
[0m16:08:52.261792 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:08:52.264663 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m16:08:52.815179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E413480180>]}
[0m16:08:52.909155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E413FBB790>]}
[0m16:08:52.912942 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:08:53.354656 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:08:54.159738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:54.160228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:54.314025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E415A40B50>]}
[0m16:08:54.614763 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:08:54.618297 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:08:54.676848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E415444B90>]}
[0m16:08:54.677685 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m16:08:54.678727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41529DB70>]}
[0m16:08:54.685807 [info ] [MainThread]: 
[0m16:08:54.686821 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:08:54.687774 [info ] [MainThread]: 
[0m16:08:54.689125 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:08:54.702605 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:08:54.892043 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:08:54.892572 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:08:54.893017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:57.204123 [debug] [ThreadPool]: SQL status: OK in 2.311 seconds
[0m16:08:57.209426 [debug] [ThreadPool]: On list_finance: Close
[0m16:08:57.212050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m16:08:57.213947 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m16:08:57.237188 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:08:57.238312 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:08:57.239344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:57.243477 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:08:57.246474 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:08:57.247174 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m16:08:57.249521 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:08:57.250349 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:08:57.251139 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m16:08:57.423321 [debug] [ThreadPool]: SQL status: OK in 0.171 seconds
[0m16:08:57.427110 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:08:57.428498 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:08:57.429801 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:08:57.486065 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m16:08:57.487847 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m16:08:57.497688 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m16:08:57.512607 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m16:08:57.535221 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:08:57.528123 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:08:57.538103 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m16:08:57.539680 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m16:08:57.541203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:57.542738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:57.546908 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:08:57.548314 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:08:57.549724 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m16:08:57.551265 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m16:08:57.552919 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:08:57.555280 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m16:08:57.660210 [debug] [ThreadPool]: SQL status: OK in 0.103 seconds
[0m16:08:57.661334 [debug] [ThreadPool]: SQL status: OK in 0.107 seconds
[0m16:08:57.664536 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m16:08:57.667980 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m16:08:57.670422 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m16:08:57.671317 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m16:08:57.673138 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m16:08:57.675935 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m16:08:57.683269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E415C9AEA0>]}
[0m16:08:57.684464 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:57.685299 [debug] [MainThread]: On master: BEGIN
[0m16:08:57.686110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:57.688910 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m16:08:57.689807 [debug] [MainThread]: On master: COMMIT
[0m16:08:57.690671 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:57.691488 [debug] [MainThread]: On master: COMMIT
[0m16:08:57.693065 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:08:57.693948 [debug] [MainThread]: On master: Close
[0m16:08:57.704700 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m16:08:57.705823 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m16:08:57.707147 [info ] [Thread-1 (]: 1 of 11 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m16:08:57.709999 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m16:08:57.708398 [info ] [Thread-2 (]: 2 of 11 START sql view model analytics_dev.src_vix ............................. [RUN]
[0m16:08:57.711327 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m16:08:57.712711 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m16:08:57.732184 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m16:08:57.733396 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m16:08:57.740581 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m16:08:57.742622 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m16:08:57.754958 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m16:08:57.860131 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m16:08:57.867112 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m16:08:57.869411 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:08:57.870497 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m16:08:57.871665 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:08:57.872753 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:08:57.873893 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m16:08:57.875950 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:08:57.877588 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:08:57.878752 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:08:57.879738 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:08:57.880830 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m16:08:57.881988 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:08:57.883658 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m16:08:58.017665 [debug] [Thread-1 (]: SQL status: OK in 0.133 seconds
[0m16:08:58.036042 [debug] [Thread-2 (]: SQL status: OK in 0.152 seconds
[0m16:08:58.045665 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:08:58.060131 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:08:58.061878 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m16:08:58.063766 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m16:08:58.277770 [debug] [Thread-2 (]: SQL status: OK in 0.212 seconds
[0m16:08:58.289915 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:08:58.291824 [debug] [Thread-1 (]: SQL status: OK in 0.226 seconds
[0m16:08:58.293677 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m16:08:58.306359 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:08:58.309228 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m16:08:58.413697 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m16:08:58.436208 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m16:08:58.479794 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:08:58.484113 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:08:58.490258 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m16:08:58.491921 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:08:58.493767 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:08:58.495828 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m16:08:58.702971 [debug] [Thread-1 (]: SQL status: OK in 0.205 seconds
[0m16:08:58.724391 [debug] [Thread-2 (]: SQL status: OK in 0.229 seconds
[0m16:08:58.731125 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:08:58.740107 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m16:08:58.743929 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:08:58.746351 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m16:08:58.914456 [debug] [Thread-1 (]: SQL status: OK in 0.169 seconds
[0m16:08:58.915617 [debug] [Thread-2 (]: SQL status: OK in 0.168 seconds
[0m16:08:58.919316 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m16:08:58.921744 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m16:08:58.925701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4156EAC90>]}
[0m16:08:58.926454 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4156F26D0>]}
[0m16:08:58.927571 [info ] [Thread-1 (]: 1 of 11 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 1.21s]
[0m16:08:58.929693 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m16:08:58.930780 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__stocks
[0m16:08:58.928553 [info ] [Thread-2 (]: 2 of 11 OK created sql view model analytics_dev.src_vix ........................ [[32mOK[0m in 1.21s]
[0m16:08:58.932950 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m16:08:58.931896 [info ] [Thread-3 (]: 3 of 11 START sql view model analytics_dev.stg__stocks ......................... [RUN]
[0m16:08:58.934216 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m16:08:58.935068 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m16:08:58.936867 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m16:08:58.943454 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m16:08:58.936025 [info ] [Thread-4 (]: 4 of 11 START sql view model analytics_dev.stg__vix_with_versions .............. [RUN]
[0m16:08:58.944799 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m16:08:58.945450 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m16:08:58.951748 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m16:08:58.952698 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m16:08:58.958021 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m16:08:58.959327 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m16:08:58.966710 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m16:08:58.968009 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:08:58.968703 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m16:08:58.969321 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:08:58.971063 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:08:58.972426 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m16:08:58.973732 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:08:58.974624 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:08:58.975424 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:08:58.976944 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m16:08:58.978922 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:08:58.979640 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:08:58.980378 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m16:08:59.114303 [debug] [Thread-3 (]: SQL status: OK in 0.136 seconds
[0m16:08:59.125229 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:08:59.126644 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m16:08:59.171802 [debug] [Thread-4 (]: SQL status: OK in 0.190 seconds
[0m16:08:59.184331 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:08:59.186235 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m16:08:59.221955 [debug] [Thread-3 (]: SQL status: OK in 0.094 seconds
[0m16:08:59.248009 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:08:59.249755 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m16:08:59.303127 [debug] [Thread-4 (]: SQL status: OK in 0.115 seconds
[0m16:08:59.315577 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:08:59.317319 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m16:08:59.352847 [debug] [Thread-3 (]: SQL status: OK in 0.101 seconds
[0m16:08:59.356736 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m16:08:59.358095 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:08:59.359205 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m16:08:59.417817 [debug] [Thread-4 (]: SQL status: OK in 0.099 seconds
[0m16:08:59.422563 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m16:08:59.423588 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:08:59.424486 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m16:08:59.591721 [debug] [Thread-4 (]: SQL status: OK in 0.166 seconds
[0m16:08:59.600535 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:08:59.601867 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m16:08:59.603693 [debug] [Thread-3 (]: SQL status: OK in 0.243 seconds
[0m16:08:59.612094 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:08:59.613466 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m16:08:59.851126 [debug] [Thread-3 (]: SQL status: OK in 0.236 seconds
[0m16:08:59.852259 [debug] [Thread-4 (]: SQL status: OK in 0.249 seconds
[0m16:08:59.856520 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: Close
[0m16:08:59.859854 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m16:08:59.861333 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4173C4A50>]}
[0m16:08:59.862678 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E415E771D0>]}
[0m16:08:59.864263 [info ] [Thread-3 (]: 3 of 11 OK created sql view model analytics_dev.stg__stocks .................... [[32mOK[0m in 0.93s]
[0m16:08:59.867562 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m16:08:59.865755 [info ] [Thread-4 (]: 4 of 11 OK created sql view model analytics_dev.stg__vix_with_versions ......... [[32mOK[0m in 0.92s]
[0m16:08:59.869690 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__price_changes
[0m16:08:59.871317 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m16:08:59.872722 [info ] [Thread-1 (]: 5 of 11 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m16:08:59.874796 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m16:08:59.876228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__price_changes)
[0m16:08:59.878745 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m16:08:59.877700 [info ] [Thread-2 (]: 6 of 11 START sql view model analytics_dev.int__regime_classification .......... [RUN]
[0m16:08:59.886499 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m16:08:59.887791 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_classification)
[0m16:08:59.889473 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m16:08:59.902737 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m16:08:59.904439 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m16:08:59.912942 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m16:08:59.914938 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m16:08:59.925120 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m16:08:59.927059 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:08:59.928358 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m16:08:59.929629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:59.931810 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:08:59.933354 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m16:08:59.934469 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:08:59.935530 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:08:59.937015 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:08:59.938152 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."stg__stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:08:59.940117 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m16:08:59.941170 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:08:59.942281 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:09:00.047673 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m16:09:00.056410 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:09:00.057886 [debug] [Thread-2 (]: SQL status: OK in 0.114 seconds
[0m16:09:00.058934 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m16:09:00.066895 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:09:00.068551 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m16:09:00.146835 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m16:09:00.153658 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:09:00.154684 [debug] [Thread-2 (]: SQL status: OK in 0.085 seconds
[0m16:09:00.155690 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m16:09:00.163243 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:09:00.164255 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m16:09:00.256152 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m16:09:00.259481 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m16:09:00.260515 [debug] [Thread-2 (]: SQL status: OK in 0.095 seconds
[0m16:09:00.261583 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:09:00.264832 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m16:09:00.265915 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m16:09:00.267102 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:09:00.268522 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m16:09:00.396520 [debug] [Thread-2 (]: SQL status: OK in 0.127 seconds
[0m16:09:00.400770 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:09:00.401453 [debug] [Thread-1 (]: SQL status: OK in 0.133 seconds
[0m16:09:00.402177 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m16:09:00.406444 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:09:00.407460 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m16:09:00.566065 [debug] [Thread-2 (]: SQL status: OK in 0.159 seconds
[0m16:09:00.567190 [debug] [Thread-1 (]: SQL status: OK in 0.159 seconds
[0m16:09:00.571306 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m16:09:00.574714 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: Close
[0m16:09:00.576172 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4156A2430>]}
[0m16:09:00.577524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E417416C10>]}
[0m16:09:00.579111 [info ] [Thread-2 (]: 6 of 11 OK created sql view model analytics_dev.int__regime_classification ..... [[32mOK[0m in 0.69s]
[0m16:09:00.582423 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m16:09:00.580604 [info ] [Thread-1 (]: 5 of 11 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.70s]
[0m16:09:00.585202 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m16:09:00.586606 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m16:09:00.589645 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m16:09:00.588651 [info ] [Thread-3 (]: 7 of 11 START sql view model analytics_dev.int__regime_changes ................. [RUN]
[0m16:09:00.592409 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now model.portfolio_project_2.int__regime_changes)
[0m16:09:00.591276 [info ] [Thread-4 (]: 8 of 11 START sql view model analytics_dev.int__rsi_sma ........................ [RUN]
[0m16:09:00.593872 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m16:09:00.595251 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now model.portfolio_project_2.int__rsi_sma)
[0m16:09:00.603813 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m16:09:00.605313 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m16:09:00.614279 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m16:09:00.616688 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m16:09:00.627629 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m16:09:00.629349 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m16:09:00.640419 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m16:09:00.643094 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:09:00.644200 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m16:09:00.645383 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:09:00.646430 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:00.647584 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m16:09:00.649385 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:00.651701 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m16:09:00.653947 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:09:00.655096 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m16:09:00.656302 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m16:09:00.657591 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:09:00.660121 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    sma_gain::decimal(18,2) as sma_gain,
    sma_loss::decimal(18,2) as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m16:09:00.790213 [debug] [Thread-3 (]: SQL status: OK in 0.131 seconds
[0m16:09:00.798835 [debug] [Thread-4 (]: SQL status: OK in 0.137 seconds
[0m16:09:00.801213 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:09:00.808682 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:09:00.809910 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m16:09:00.811070 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m16:09:00.889938 [debug] [Thread-4 (]: SQL status: OK in 0.077 seconds
[0m16:09:00.906646 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:09:00.907693 [debug] [Thread-3 (]: SQL status: OK in 0.096 seconds
[0m16:09:00.908640 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m16:09:00.915035 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:09:00.916436 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m16:09:01.002624 [debug] [Thread-4 (]: SQL status: OK in 0.086 seconds
[0m16:09:01.006040 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m16:09:01.007120 [debug] [Thread-3 (]: SQL status: OK in 0.090 seconds
[0m16:09:01.008205 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:09:01.011608 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m16:09:01.012945 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m16:09:01.014143 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:09:01.016767 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m16:09:01.168549 [debug] [Thread-4 (]: SQL status: OK in 0.152 seconds
[0m16:09:01.172416 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:09:01.173153 [debug] [Thread-3 (]: SQL status: OK in 0.155 seconds
[0m16:09:01.173891 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m16:09:01.178816 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:09:01.179873 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m16:09:01.335187 [debug] [Thread-3 (]: SQL status: OK in 0.154 seconds
[0m16:09:01.342470 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m16:09:01.345518 [debug] [Thread-4 (]: SQL status: OK in 0.165 seconds
[0m16:09:01.348201 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4156EF7D0>]}
[0m16:09:01.355740 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m16:09:01.359101 [info ] [Thread-3 (]: 7 of 11 OK created sql view model analytics_dev.int__regime_changes ............ [[32mOK[0m in 0.76s]
[0m16:09:01.362426 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4156EF830>]}
[0m16:09:01.365264 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m16:09:01.368479 [info ] [Thread-4 (]: 8 of 11 OK created sql view model analytics_dev.int__rsi_sma ................... [[32mOK[0m in 0.77s]
[0m16:09:01.373922 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m16:09:01.376005 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:09:01.378005 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m16:09:01.380554 [info ] [Thread-2 (]: 9 of 11 START sql incremental model analytics_dev.mrt__stocks_with_regimes ..... [RUN]
[0m16:09:01.384973 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_classification, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m16:09:01.382786 [info ] [Thread-1 (]: 10 of 11 START sql view model analytics_dev.int__rsi_wilder .................... [RUN]
[0m16:09:01.388520 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:09:01.390626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now model.portfolio_project_2.int__rsi_wilder)
[0m16:09:01.421187 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m16:09:01.474019 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m16:09:01.480547 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:01.483353 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m16:09:01.492589 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m16:09:01.494113 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:09:01.501971 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:01.502830 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__3234f5aee523" cascade
    
[0m16:09:01.503623 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:01.505239 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:09:01.506223 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m16:09:01.507075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:01.509916 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:09:01.510778 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:09:01.511570 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    wilder_gain::decimal(18,2) as wilder_gain,
    wilder_loss::decimal(18,2) as wilder_loss
from wilder
  );

[0m16:09:01.622398 [debug] [Thread-2 (]: SQL status: OK in 0.119 seconds
[0m16:09:01.677292 [debug] [Thread-1 (]: SQL status: OK in 0.165 seconds
[0m16:09:01.694820 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:09:01.717677 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m16:09:01.727008 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:01.729382 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:09:01.735795 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:09:01.741745 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:01.743415 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m16:09:01.747601 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:09:01.749204 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:01.750784 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m16:09:01.821167 [debug] [Thread-2 (]: SQL status: OK in 0.068 seconds
[0m16:09:01.826477 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:01.828232 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m16:09:01.829997 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m16:09:01.844606 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:09:01.846703 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m16:09:01.848706 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:09:01.855558 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:09:01.857462 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:01.859071 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:09:01.902292 [debug] [Thread-2 (]: SQL status: OK in 0.041 seconds
[0m16:09:01.952602 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m16:09:01.965911 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m16:09:01.975072 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:09:01.984599 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m16:09:02.020825 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:02.022716 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:09:02.040117 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m16:09:02.109425 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:02.111272 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,0))
 as volume, 
      
    cast(null as text)
 as regime
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:09:02.117068 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:09:02.201030 [debug] [Thread-1 (]: SQL status: OK in 0.208 seconds
[0m16:09:02.226267 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:09:02.232600 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m16:09:02.245636 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:02.248507 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."mrt__stocks_with_regimes__3234f5aee523"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null
    
    )
 ;
    insert into "finance"."dbt_temp"."mrt__stocks_with_regimes__3234f5aee523" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m16:09:02.445183 [debug] [Thread-1 (]: SQL status: OK in 0.198 seconds
[0m16:09:02.453118 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m16:09:02.455554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4156EFD10>]}
[0m16:09:02.458062 [info ] [Thread-1 (]: 10 of 11 OK created sql view model analytics_dev.int__rsi_wilder ............... [[32mOK[0m in 1.07s]
[0m16:09:02.461593 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m16:09:02.464148 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.fct__rsi
[0m16:09:02.466207 [info ] [Thread-3 (]: 11 of 11 START sql incremental model analytics_dev.fct__rsi .................... [RUN]
[0m16:09:02.468834 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_changes, now model.portfolio_project_2.fct__rsi)
[0m16:09:02.471040 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m16:09:02.493586 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m16:09:02.498248 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m16:09:02.520856 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:02.523141 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__8ec985263fb0" cascade
    
[0m16:09:02.524897 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:02.611056 [debug] [Thread-3 (]: SQL status: OK in 0.086 seconds
[0m16:09:02.621871 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:02.623478 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:09:02.628210 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:09:02.632312 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:02.633751 [debug] [Thread-2 (]: SQL status: OK in 0.383 seconds
[0m16:09:02.635406 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m16:09:02.661719 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:02.662502 [debug] [Thread-3 (]: SQL status: OK in 0.026 seconds
[0m16:09:02.663187 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m16:09:02.663901 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:02.664878 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m16:09:02.665944 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:09:02.666618 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:02.667591 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__3234f5aee523'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:09:02.684100 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m16:09:02.694641 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:02.695383 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:09:02.704932 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m16:09:02.735709 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:02.736580 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__3234f5aee523'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:09:02.737505 [debug] [Thread-3 (]: SQL status: OK in 0.072 seconds
[0m16:09:02.739298 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:02.739951 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    

  
[0m16:09:02.740723 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m16:09:02.742579 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m16:09:02.743208 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:02.743941 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m16:09:02.745422 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m16:09:02.750681 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:02.751417 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:09:02.759674 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m16:09:02.776605 [debug] [Thread-2 (]: 
    In "finance"."analytics_dev"."mrt__stocks_with_regimes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:09:02.777467 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:02.778091 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
SELECT version()
[0m16:09:02.779537 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:09:02.821296 [debug] [Thread-3 (]: SQL status: OK in 0.076 seconds
[0m16:09:02.837680 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:02.846041 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:09:02.895074 [debug] [Thread-3 (]: SQL status: OK in 0.041 seconds
[0m16:09:02.961807 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:02.963554 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:02.964672 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as sma_rs, 
      
    cast(null as decimal(18,2))
 as sma_rsi, 
      
    cast(null as decimal(18,2))
 as wilder_rs, 
      
    cast(null as decimal(18,2))
 as wilder_rsi
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:09:02.967167 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:02.968306 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */


    MERGE INTO "finance"."analytics_dev"."mrt__stocks_with_regimes" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."mrt__stocks_with_regimes__3234f5aee523" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m16:09:02.969822 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:09:02.976382 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:02.977680 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."fct__rsi__8ec985263fb0"
  
  (
    trade_date date not null,
    ticker text not null,
    sma_rs decimal(18,2),
    sma_rsi decimal(18,2),
    wilder_rs decimal(18,2),
    wilder_rsi decimal(18,2)
    
    )
 ;
    insert into "finance"."dbt_temp"."fct__rsi__8ec985263fb0" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      sma_rs ,
    
      
      sma_rsi ,
    
      
      wilder_rs ,
    
      
      wilder_rsi 
    
  )
 (
      
    select trade_date, ticker, sma_rs, sma_rsi, wilder_rs, wilder_rsi
    from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as model_subq
    );
  
  
  
[0m16:09:03.128632 [debug] [Thread-2 (]: SQL status: OK in 0.159 seconds
[0m16:09:03.134362 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:09:03.136168 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:03.137798 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:09:03.216745 [debug] [Thread-2 (]: SQL status: OK in 0.077 seconds
[0m16:09:03.227445 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:03.229114 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__3234f5aee523" cascade
    
[0m16:09:03.426008 [debug] [Thread-2 (]: SQL status: OK in 0.195 seconds
[0m16:09:03.431414 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:09:03.432185 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__3234f5aee523" cascade
    
[0m16:09:03.496978 [debug] [Thread-2 (]: SQL status: OK in 0.064 seconds
[0m16:09:03.501730 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m16:09:03.503843 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E417347770>]}
[0m16:09:03.506212 [info ] [Thread-2 (]: 9 of 11 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes  [[32mOK[0m in 2.12s]
[0m16:09:03.509176 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:09:06.554973 [debug] [Thread-3 (]: SQL status: OK in 3.576 seconds
[0m16:09:06.566234 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:06.567882 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m16:09:06.572056 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:09:06.573634 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:06.575193 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__8ec985263fb0'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:09:06.596511 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m16:09:06.609918 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:06.611709 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:09:06.631388 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m16:09:06.640543 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:06.641799 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__8ec985263fb0'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:09:06.657472 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m16:09:06.668633 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:06.670208 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:09:06.686357 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m16:09:06.692383 [debug] [Thread-3 (]: 
    In "finance"."analytics_dev"."fct__rsi":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:09:06.696438 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m16:09:06.699909 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:06.701300 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */


    MERGE INTO "finance"."analytics_dev"."fct__rsi" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."fct__rsi__8ec985263fb0" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m16:09:06.766591 [debug] [Thread-3 (]: SQL status: OK in 0.064 seconds
[0m16:09:06.770377 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m16:09:06.771599 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:06.772758 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m16:09:06.833418 [debug] [Thread-3 (]: SQL status: OK in 0.059 seconds
[0m16:09:06.841217 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:06.842964 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__8ec985263fb0" cascade
    
[0m16:09:07.066903 [debug] [Thread-3 (]: SQL status: OK in 0.223 seconds
[0m16:09:07.071896 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:09:07.072639 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__8ec985263fb0" cascade
    
[0m16:09:07.127360 [debug] [Thread-3 (]: SQL status: OK in 0.054 seconds
[0m16:09:07.132678 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: Close
[0m16:09:07.134808 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28100e14-9e6a-471c-9585-84c4f377298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4173442F0>]}
[0m16:09:07.137235 [info ] [Thread-3 (]: 11 of 11 OK created sql incremental model analytics_dev.fct__rsi ............... [[32mOK[0m in 4.67s]
[0m16:09:07.140407 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m16:09:07.146185 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:07.148065 [debug] [MainThread]: On master: BEGIN
[0m16:09:07.149391 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:07.153606 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m16:09:07.155477 [debug] [MainThread]: On master: COMMIT
[0m16:09:07.156821 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:07.158155 [debug] [MainThread]: On master: COMMIT
[0m16:09:07.160789 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:09:07.162388 [debug] [MainThread]: On master: Close
[0m16:09:07.164113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:07.165368 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m16:09:07.166546 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m16:09:07.167729 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m16:09:07.168886 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m16:09:07.170049 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m16:09:07.171503 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m16:09:07.172703 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m16:09:07.174284 [info ] [MainThread]: 
[0m16:09:07.176410 [info ] [MainThread]: Finished running 2 incremental models, 9 view models in 0 hours 0 minutes and 12.49 seconds (12.49s).
[0m16:09:07.188071 [debug] [MainThread]: Command end result
[0m16:09:07.380355 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:09:07.385259 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:09:07.395716 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m16:09:07.396261 [info ] [MainThread]: 
[0m16:09:07.397127 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:07.397909 [info ] [MainThread]: 
[0m16:09:07.398853 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m16:09:07.400670 [debug] [MainThread]: Command `-c run` succeeded at 16:09:07.400440 after 15.65 seconds
[0m16:09:07.401365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E412CD1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E413F16990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41564AB10>]}
[0m16:09:07.402154 [debug] [MainThread]: Flushing usage events
[0m16:09:08.890370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:14.847013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C570D8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C578E42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C57F27ED0>]}


============================== 16:09:14.864638 | c92592c5-b0b8-4e24-a80d-a1cc9bc2cd4c ==============================
[0m16:09:14.864638 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:09:14.867817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt snapshot', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:09:15.570800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c92592c5-b0b8-4e24-a80d-a1cc9bc2cd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C57290180>]}
[0m16:09:15.729204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c92592c5-b0b8-4e24-a80d-a1cc9bc2cd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C57DCB790>]}
[0m16:09:15.733382 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:09:16.161136 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:09:16.490086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:16.490564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:16.605186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c92592c5-b0b8-4e24-a80d-a1cc9bc2cd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C59848B50>]}
[0m16:09:16.898233 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:09:16.901852 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:09:16.980206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c92592c5-b0b8-4e24-a80d-a1cc9bc2cd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C56B887D0>]}
[0m16:09:16.981414 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m16:09:16.982772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c92592c5-b0b8-4e24-a80d-a1cc9bc2cd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C5910EC10>]}
[0m16:09:16.991539 [info ] [MainThread]: 
[0m16:09:16.992895 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:09:16.994445 [info ] [MainThread]: 
[0m16:09:16.996505 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:09:17.009197 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:09:17.253227 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:09:17.254628 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:09:17.255982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:19.708449 [debug] [ThreadPool]: SQL status: OK in 2.452 seconds
[0m16:09:19.712438 [debug] [ThreadPool]: On list_finance: Close
[0m16:09:19.714419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev_snapshots)
[0m16:09:19.715940 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev_snapshots"
"
[0m16:09:19.734283 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:09:19.735358 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev_snapshots"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:09:19.736300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:19.740482 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:09:19.744991 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:09:19.746056 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: BEGIN
[0m16:09:19.748930 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:09:19.749895 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:09:19.750832 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev_snapshots"} */

    
    
        create schema if not exists "finance"."analytics_dev_snapshots"
    
[0m16:09:20.011769 [debug] [ThreadPool]: SQL status: OK in 0.260 seconds
[0m16:09:20.015591 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: COMMIT
[0m16:09:20.017130 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:09:20.018511 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: COMMIT
[0m16:09:20.090491 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m16:09:20.092244 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: Close
[0m16:09:20.101773 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m16:09:20.114954 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m16:09:20.148530 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:09:20.150540 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:09:20.151963 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m16:09:20.153536 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m16:09:20.155038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:20.156536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:20.160315 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:09:20.161850 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:09:20.163242 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m16:09:20.164747 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m16:09:20.166372 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:09:20.168706 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m16:09:20.260634 [debug] [ThreadPool]: SQL status: OK in 0.093 seconds
[0m16:09:20.261580 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m16:09:20.264827 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m16:09:20.267062 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m16:09:20.269537 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m16:09:20.270541 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m16:09:20.271264 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m16:09:20.271910 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m16:09:20.278633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c92592c5-b0b8-4e24-a80d-a1cc9bc2cd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C59AAB040>]}
[0m16:09:20.279513 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:20.280111 [debug] [MainThread]: On master: BEGIN
[0m16:09:20.280676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:20.282896 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m16:09:20.283496 [debug] [MainThread]: On master: COMMIT
[0m16:09:20.284339 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:20.284983 [debug] [MainThread]: On master: COMMIT
[0m16:09:20.286323 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:09:20.287161 [debug] [MainThread]: On master: Close
[0m16:09:20.297062 [debug] [Thread-1 (]: Began running node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:09:20.298051 [debug] [Thread-2 (]: Began running node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:09:20.299274 [info ] [Thread-1 (]: 1 of 2 START snapshot analytics_dev_snapshots.regime_classification_snapshot ... [RUN]
[0m16:09:20.302399 [debug] [Thread-1 (]: Acquiring new duckdb connection 'snapshot.portfolio_project_2.regime_classification_snapshot'
[0m16:09:20.300668 [info ] [Thread-2 (]: 2 of 2 START snapshot analytics_dev_snapshots.stg__stocks_snapshot ............. [RUN]
[0m16:09:20.303623 [debug] [Thread-1 (]: Began compiling node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:09:20.304914 [debug] [Thread-2 (]: Acquiring new duckdb connection 'snapshot.portfolio_project_2.stg__stocks_snapshot'
[0m16:09:20.324009 [debug] [Thread-1 (]: Began executing node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:09:20.325118 [debug] [Thread-2 (]: Began compiling node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:09:20.366088 [debug] [Thread-2 (]: Began executing node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:09:20.602798 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:09:20.604473 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:09:20.606042 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: BEGIN
[0m16:09:20.607682 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: BEGIN
[0m16:09:20.609445 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:09:20.611194 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:09:20.615543 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:09:20.617027 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:09:20.618488 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m16:09:20.620123 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:09:20.621875 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:09:20.624237 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:09:20.644039 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m16:09:20.645996 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m16:09:21.010394 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:09:21.020493 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:09:21.022438 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

        
  
    
    

    create  table
      "regime_classification_snapshot__dbt_tmp20251113160920962963"
  
    as (
      
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."int__regime_classification"

    ),

    snapshotted_data as (

        select *, 
    
        trade_date as dbt_unique_key
    

        from "finance"."analytics_dev_snapshots"."regime_classification_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
  
    
[0m16:09:21.025079 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

        
  
    
    

    create  table
      "stg__stocks_snapshot__dbt_tmp20251113160920960510"
  
    as (
      
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."src_stocks"

    ),

    snapshotted_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    

        from "finance"."analytics_dev_snapshots"."stg__stocks_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(ticker as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
  
    
[0m16:09:21.370266 [debug] [Thread-2 (]: SQL status: OK in 0.341 seconds
[0m16:09:21.376860 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:09:21.377988 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot__dbt_tmp20251113160920960510'
      
      
      order by ordinal_position

  
[0m16:09:21.392816 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m16:09:21.401825 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:09:21.402924 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:09:21.422023 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m16:09:21.429982 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:09:21.431112 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot__dbt_tmp20251113160920960510'
      
      
      order by ordinal_position

  
[0m16:09:21.445781 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m16:09:21.455543 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:09:21.456711 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:09:21.471805 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m16:09:21.488715 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:09:21.489809 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot__dbt_tmp20251113160920960510'
      
      
      order by ordinal_position

  
[0m16:09:21.503960 [debug] [Thread-1 (]: SQL status: OK in 0.477 seconds
[0m16:09:21.510902 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:09:21.512003 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m16:09:21.513091 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251113160920962963'
      
      
      order by ordinal_position

  
[0m16:09:21.548814 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m16:09:21.561605 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:09:21.563289 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */
DESCRIBE (select * from (
        
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."src_stocks"

    ),

    snapshotted_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    

        from "finance"."analytics_dev_snapshots"."stg__stocks_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(ticker as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:09:21.572467 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:09:21.575428 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:09:21.584668 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m16:09:21.591281 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m16:09:21.599910 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:09:21.606767 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251113160920962963'
      
      
      order by ordinal_position

  
[0m16:09:21.617082 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:09:21.618664 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:09:21.621365 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:09:21.623217 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:09:21.626330 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:09:21.627548 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      update "finance"."analytics_dev_snapshots"."stg__stocks_snapshot" as DBT_INTERNAL_TARGET
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "stg__stocks_snapshot__dbt_tmp20251113160920960510" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = DBT_INTERNAL_TARGET.dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and DBT_INTERNAL_TARGET.dbt_valid_to is null;
      

    insert into "finance"."analytics_dev_snapshots"."stg__stocks_snapshot" ("trade_date", "ticker", "open", "high", "low", "close", "volume", "loaded_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."trade_date",DBT_INTERNAL_SOURCE."ticker",DBT_INTERNAL_SOURCE."open",DBT_INTERNAL_SOURCE."high",DBT_INTERNAL_SOURCE."low",DBT_INTERNAL_SOURCE."close",DBT_INTERNAL_SOURCE."volume",DBT_INTERNAL_SOURCE."loaded_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "stg__stocks_snapshot__dbt_tmp20251113160920960510" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;


  
[0m16:09:21.640051 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m16:09:21.657869 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:09:21.659006 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:09:21.681904 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m16:09:21.691097 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:09:21.692251 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251113160920962963'
      
      
      order by ordinal_position

  
[0m16:09:21.706326 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m16:09:21.712128 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:09:21.713909 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */
DESCRIBE (select * from (
        
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."int__regime_classification"

    ),

    snapshotted_data as (

        select *, 
    
        trade_date as dbt_unique_key
    

        from "finance"."analytics_dev_snapshots"."regime_classification_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:09:21.723616 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:09:21.737189 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:09:21.738339 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:09:21.741093 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:09:21.742727 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:09:21.745080 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:09:21.747663 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      update "finance"."analytics_dev_snapshots"."regime_classification_snapshot" as DBT_INTERNAL_TARGET
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "regime_classification_snapshot__dbt_tmp20251113160920962963" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = DBT_INTERNAL_TARGET.dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and DBT_INTERNAL_TARGET.dbt_valid_to is null;
      

    insert into "finance"."analytics_dev_snapshots"."regime_classification_snapshot" ("trade_date", "close", "regime", "loaded_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."trade_date",DBT_INTERNAL_SOURCE."close",DBT_INTERNAL_SOURCE."regime",DBT_INTERNAL_SOURCE."loaded_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "regime_classification_snapshot__dbt_tmp20251113160920962963" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;


  
[0m16:09:21.947457 [debug] [Thread-2 (]: SQL status: OK in 0.318 seconds
[0m16:09:21.989009 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: COMMIT
[0m16:09:21.990746 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:09:21.992275 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: COMMIT
[0m16:09:21.997161 [debug] [Thread-1 (]: SQL status: OK in 0.247 seconds
[0m16:09:22.002178 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: COMMIT
[0m16:09:22.003787 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:09:22.005467 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: COMMIT
[0m16:09:22.158110 [debug] [Thread-1 (]: SQL status: OK in 0.151 seconds
[0m16:09:22.169477 [debug] [Thread-2 (]: SQL status: OK in 0.175 seconds
[0m16:09:22.197161 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:09:22.199465 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:09:22.201583 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      drop table if exists "stg__stocks_snapshot__dbt_tmp20251113160920960510" cascade
    
[0m16:09:22.203518 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      drop table if exists "regime_classification_snapshot__dbt_tmp20251113160920962963" cascade
    
[0m16:09:22.357853 [debug] [Thread-2 (]: SQL status: OK in 0.152 seconds
[0m16:09:22.367817 [debug] [Thread-1 (]: SQL status: OK in 0.162 seconds
[0m16:09:22.370649 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: Close
[0m16:09:22.376910 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: Close
[0m16:09:22.386432 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92592c5-b0b8-4e24-a80d-a1cc9bc2cd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C59C12A50>]}
[0m16:09:22.387999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92592c5-b0b8-4e24-a80d-a1cc9bc2cd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C59503120>]}
[0m16:09:22.391931 [info ] [Thread-2 (]: 2 of 2 OK snapshotted analytics_dev_snapshots.stg__stocks_snapshot ............. [[32mOK[0m in 2.07s]
[0m16:09:22.399000 [debug] [Thread-2 (]: Finished running node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:09:22.395796 [info ] [Thread-1 (]: 1 of 2 OK snapshotted analytics_dev_snapshots.regime_classification_snapshot ... [[32mOK[0m in 2.08s]
[0m16:09:22.403492 [debug] [Thread-1 (]: Finished running node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:09:22.409759 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:22.411287 [debug] [MainThread]: On master: BEGIN
[0m16:09:22.412545 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:22.416894 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m16:09:22.418282 [debug] [MainThread]: On master: COMMIT
[0m16:09:22.419598 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:22.420825 [debug] [MainThread]: On master: COMMIT
[0m16:09:22.423264 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:09:22.424736 [debug] [MainThread]: On master: Close
[0m16:09:22.426470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:22.427778 [debug] [MainThread]: Connection 'create_finance_analytics_dev_snapshots' was properly closed.
[0m16:09:22.428955 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m16:09:22.430108 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m16:09:22.431244 [debug] [MainThread]: Connection 'snapshot.portfolio_project_2.regime_classification_snapshot' was properly closed.
[0m16:09:22.432403 [debug] [MainThread]: Connection 'snapshot.portfolio_project_2.stg__stocks_snapshot' was properly closed.
[0m16:09:22.433906 [info ] [MainThread]: 
[0m16:09:22.435790 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m16:09:22.440126 [debug] [MainThread]: Command end result
[0m16:09:22.723674 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:09:22.730802 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:09:22.746638 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m16:09:22.747487 [info ] [MainThread]: 
[0m16:09:22.748774 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:22.749938 [info ] [MainThread]: 
[0m16:09:22.751172 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m16:09:22.753671 [debug] [MainThread]: Command `-c snapshot` succeeded at 16:09:22.753351 after 8.18 seconds
[0m16:09:22.754633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C5B1EC230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C594E3AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C5944D850>]}
[0m16:09:22.755590 [debug] [MainThread]: Flushing usage events
[0m16:09:24.172203 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:12:49.934350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F0708050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F0F142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F1557ED0>]}


============================== 16:12:49.952201 | b444aad9-c0e9-4816-831e-86dfae228311 ==============================
[0m16:12:49.952201 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:12:49.954936 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:12:50.428981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F08C0180>]}
[0m16:12:50.522760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F13FB790>]}
[0m16:12:50.527257 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:12:51.041012 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:12:51.664739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:12:51.665481 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:12:51.796263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F2E9CB50>]}
[0m16:12:52.280873 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:12:52.284514 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:12:52.363718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F2880B90>]}
[0m16:12:52.364885 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m16:12:52.366214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F26DDB70>]}
[0m16:12:52.375662 [info ] [MainThread]: 
[0m16:12:52.377208 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:12:52.378884 [info ] [MainThread]: 
[0m16:12:52.380851 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:12:52.398374 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:12:52.636441 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:12:52.636973 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:12:52.637417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:54.850032 [debug] [ThreadPool]: SQL status: OK in 2.212 seconds
[0m16:12:54.855626 [debug] [ThreadPool]: On list_finance: Close
[0m16:12:54.858439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m16:12:54.860507 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m16:12:54.877877 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:12:54.878711 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:12:54.879430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:54.883256 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:12:54.886597 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:12:54.887432 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m16:12:54.889579 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:12:54.890178 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:12:54.890815 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m16:12:54.949580 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m16:12:54.953293 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:12:54.955080 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:12:54.956613 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:12:55.025730 [debug] [ThreadPool]: SQL status: OK in 0.068 seconds
[0m16:12:55.028077 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m16:12:55.040270 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m16:12:55.059665 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m16:12:55.084223 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:12:55.096257 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:12:55.099568 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m16:12:55.101598 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m16:12:55.104777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:55.107812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:55.113883 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:12:55.117145 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:12:55.119976 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m16:12:55.123303 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m16:12:55.126407 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:12:55.129390 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m16:12:55.273694 [debug] [ThreadPool]: SQL status: OK in 0.142 seconds
[0m16:12:55.274848 [debug] [ThreadPool]: SQL status: OK in 0.147 seconds
[0m16:12:55.278226 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m16:12:55.281403 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m16:12:55.284381 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m16:12:55.285682 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m16:12:55.287969 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m16:12:55.289245 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m16:12:55.297242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F30EADD0>]}
[0m16:12:55.298207 [debug] [MainThread]: Using duckdb connection "master"
[0m16:12:55.298858 [debug] [MainThread]: On master: BEGIN
[0m16:12:55.299535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:12:55.302398 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m16:12:55.303626 [debug] [MainThread]: On master: COMMIT
[0m16:12:55.305148 [debug] [MainThread]: Using duckdb connection "master"
[0m16:12:55.306661 [debug] [MainThread]: On master: COMMIT
[0m16:12:55.309379 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:12:55.310969 [debug] [MainThread]: On master: Close
[0m16:12:55.322091 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m16:12:55.323499 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m16:12:55.325124 [info ] [Thread-1 (]: 1 of 11 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m16:12:55.327824 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m16:12:55.326185 [info ] [Thread-2 (]: 2 of 11 START sql view model analytics_dev.src_vix ............................. [RUN]
[0m16:12:55.329673 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m16:12:55.331367 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m16:12:55.358488 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m16:12:55.360334 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m16:12:55.367802 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m16:12:55.370285 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m16:12:55.440506 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m16:12:55.473453 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m16:12:55.475305 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m16:12:55.480074 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:12:55.484191 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m16:12:55.482427 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:12:55.488156 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:12:55.490598 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m16:12:55.495235 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:12:55.499167 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m16:12:55.502970 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:12:55.506378 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m16:12:55.509627 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m16:12:55.514547 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:12:55.518854 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m16:12:55.783610 [debug] [Thread-2 (]: SQL status: OK in 0.261 seconds
[0m16:12:55.801732 [debug] [Thread-1 (]: SQL status: OK in 0.284 seconds
[0m16:12:55.838205 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:12:55.851161 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m16:12:55.855318 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:12:55.859126 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m16:12:56.021505 [debug] [Thread-2 (]: SQL status: OK in 0.163 seconds
[0m16:12:56.037638 [debug] [Thread-1 (]: SQL status: OK in 0.175 seconds
[0m16:12:56.062211 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:12:56.064151 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:12:56.065992 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m16:12:56.067959 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m16:12:56.180985 [debug] [Thread-2 (]: SQL status: OK in 0.110 seconds
[0m16:12:56.194258 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m16:12:56.302315 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m16:12:56.293174 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:12:56.306998 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:12:56.309765 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:12:56.313845 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m16:12:56.318217 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:12:56.471458 [debug] [Thread-2 (]: SQL status: OK in 0.148 seconds
[0m16:12:56.480800 [debug] [Thread-1 (]: SQL status: OK in 0.158 seconds
[0m16:12:56.514799 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:12:56.522152 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m16:12:56.530407 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:12:56.532121 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m16:12:56.689233 [debug] [Thread-2 (]: SQL status: OK in 0.159 seconds
[0m16:12:56.695992 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m16:12:56.700203 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F3251E50>]}
[0m16:12:56.702532 [info ] [Thread-2 (]: 2 of 11 OK created sql view model analytics_dev.src_vix ........................ [[32mOK[0m in 1.37s]
[0m16:12:56.704628 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m16:12:56.706532 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m16:12:56.708820 [info ] [Thread-3 (]: 3 of 11 START sql view model analytics_dev.stg__vix_with_versions .............. [RUN]
[0m16:12:56.711137 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m16:12:56.712326 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m16:12:56.727173 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m16:12:56.729550 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m16:12:56.740176 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m16:12:56.743175 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:12:56.745189 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m16:12:56.747038 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:12:56.752541 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m16:12:56.754673 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:12:56.756038 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m16:12:56.855871 [debug] [Thread-1 (]: SQL status: OK in 0.321 seconds
[0m16:12:56.866485 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m16:12:56.867868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F2B32DB0>]}
[0m16:12:56.869386 [info ] [Thread-1 (]: 1 of 11 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 1.54s]
[0m16:12:56.872712 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m16:12:56.874356 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__stocks
[0m16:12:56.875648 [info ] [Thread-4 (]: 4 of 11 START sql view model analytics_dev.stg__stocks ......................... [RUN]
[0m16:12:56.877438 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m16:12:56.878486 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m16:12:56.889398 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m16:12:56.893100 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m16:12:56.907453 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m16:12:56.912422 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:12:56.914657 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m16:12:56.916773 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:12:56.922431 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m16:12:56.924447 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:12:56.926693 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m16:12:56.971520 [debug] [Thread-3 (]: SQL status: OK in 0.214 seconds
[0m16:12:56.986278 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:12:56.988375 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m16:12:57.030245 [debug] [Thread-4 (]: SQL status: OK in 0.102 seconds
[0m16:12:57.044085 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:12:57.046878 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m16:12:57.099854 [debug] [Thread-3 (]: SQL status: OK in 0.110 seconds
[0m16:12:57.134604 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:12:57.135993 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m16:12:57.175124 [debug] [Thread-4 (]: SQL status: OK in 0.126 seconds
[0m16:12:57.185323 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:12:57.186707 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m16:12:57.243200 [debug] [Thread-3 (]: SQL status: OK in 0.106 seconds
[0m16:12:57.247002 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m16:12:57.248038 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:12:57.248973 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m16:12:57.291033 [debug] [Thread-4 (]: SQL status: OK in 0.103 seconds
[0m16:12:57.297351 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m16:12:57.299499 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:12:57.301476 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m16:12:57.454076 [debug] [Thread-3 (]: SQL status: OK in 0.204 seconds
[0m16:12:57.460579 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:12:57.461982 [debug] [Thread-4 (]: SQL status: OK in 0.158 seconds
[0m16:12:57.463994 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m16:12:57.478902 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:12:57.480715 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m16:12:57.653984 [debug] [Thread-3 (]: SQL status: OK in 0.174 seconds
[0m16:12:57.655265 [debug] [Thread-4 (]: SQL status: OK in 0.173 seconds
[0m16:12:57.658853 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m16:12:57.663329 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: Close
[0m16:12:57.665238 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F481F610>]}
[0m16:12:57.666746 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F32C7020>]}
[0m16:12:57.668382 [info ] [Thread-3 (]: 3 of 11 OK created sql view model analytics_dev.stg__vix_with_versions ......... [[32mOK[0m in 0.95s]
[0m16:12:57.672577 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m16:12:57.669926 [info ] [Thread-4 (]: 4 of 11 OK created sql view model analytics_dev.stg__stocks .................... [[32mOK[0m in 0.79s]
[0m16:12:57.674746 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m16:12:57.676009 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m16:12:57.679262 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__price_changes
[0m16:12:57.677973 [info ] [Thread-2 (]: 5 of 11 START sql view model analytics_dev.int__regime_classification .......... [RUN]
[0m16:12:57.682094 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_classification)
[0m16:12:57.681116 [info ] [Thread-1 (]: 6 of 11 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m16:12:57.683692 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m16:12:57.684579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__price_changes)
[0m16:12:57.687586 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m16:12:57.706450 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m16:12:57.707949 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m16:12:57.710744 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m16:12:57.712341 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m16:12:57.723959 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m16:12:57.732987 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m16:12:57.735476 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:12:57.737323 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:12:57.738838 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m16:12:57.740439 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m16:12:57.741711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:57.742708 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:12:57.745479 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:12:57.746253 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:12:57.747171 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:12:57.748429 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:12:57.749497 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:12:57.751554 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."stg__stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:12:57.889801 [debug] [Thread-2 (]: SQL status: OK in 0.139 seconds
[0m16:12:57.906727 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:12:57.907844 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m16:12:57.925491 [debug] [Thread-1 (]: SQL status: OK in 0.172 seconds
[0m16:12:57.934985 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:12:57.936557 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m16:12:58.022052 [debug] [Thread-2 (]: SQL status: OK in 0.112 seconds
[0m16:12:58.048993 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:12:58.053028 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m16:12:58.064216 [debug] [Thread-1 (]: SQL status: OK in 0.126 seconds
[0m16:12:58.087369 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:12:58.091038 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m16:12:58.173334 [debug] [Thread-2 (]: SQL status: OK in 0.116 seconds
[0m16:12:58.183089 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m16:12:58.187811 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:12:58.191042 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m16:12:58.228973 [debug] [Thread-1 (]: SQL status: OK in 0.135 seconds
[0m16:12:58.239584 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m16:12:58.242473 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:12:58.244323 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m16:12:58.355232 [debug] [Thread-2 (]: SQL status: OK in 0.162 seconds
[0m16:12:58.367888 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:12:58.369530 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m16:12:58.371463 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m16:12:58.385544 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m16:12:58.388093 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m16:12:58.541350 [debug] [Thread-2 (]: SQL status: OK in 0.154 seconds
[0m16:12:58.543323 [debug] [Thread-1 (]: SQL status: OK in 0.153 seconds
[0m16:12:58.547777 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m16:12:58.552580 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: Close
[0m16:12:58.554724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F4850830>]}
[0m16:12:58.556559 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F48508A0>]}
[0m16:12:58.558731 [info ] [Thread-1 (]: 6 of 11 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.87s]
[0m16:12:58.562481 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m16:12:58.560558 [info ] [Thread-2 (]: 5 of 11 OK created sql view model analytics_dev.int__regime_classification ..... [[32mOK[0m in 0.87s]
[0m16:12:58.566049 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m16:12:58.568138 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m16:12:58.571541 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m16:12:58.570066 [info ] [Thread-3 (]: 7 of 11 START sql view model analytics_dev.int__rsi_sma ........................ [RUN]
[0m16:12:58.576458 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now model.portfolio_project_2.int__rsi_sma)
[0m16:12:58.578050 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m16:12:58.573673 [info ] [Thread-4 (]: 8 of 11 START sql view model analytics_dev.int__regime_changes ................. [RUN]
[0m16:12:58.586458 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now model.portfolio_project_2.int__regime_changes)
[0m16:12:58.592686 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m16:12:58.594009 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m16:12:58.604627 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m16:12:58.607420 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m16:12:58.614484 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m16:12:58.619431 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m16:12:58.628011 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m16:12:58.630486 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:12:58.632038 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:12:58.633233 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m16:12:58.634315 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m16:12:58.635225 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:12:58.636808 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:12:58.639300 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:12:58.640462 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:12:58.641292 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m16:12:58.641994 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m16:12:58.642968 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:12:58.644937 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    sma_gain::decimal(18,2) as sma_gain,
    sma_loss::decimal(18,2) as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m16:12:58.788807 [debug] [Thread-3 (]: SQL status: OK in 0.142 seconds
[0m16:12:58.806606 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:12:58.808597 [debug] [Thread-4 (]: SQL status: OK in 0.164 seconds
[0m16:12:58.810906 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m16:12:58.824048 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:12:58.825464 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m16:12:58.964831 [debug] [Thread-3 (]: SQL status: OK in 0.140 seconds
[0m16:12:58.984328 [debug] [Thread-4 (]: SQL status: OK in 0.158 seconds
[0m16:12:58.990486 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:12:59.001578 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:12:59.003190 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m16:12:59.005293 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m16:12:59.104000 [debug] [Thread-3 (]: SQL status: OK in 0.097 seconds
[0m16:12:59.106503 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m16:12:59.107470 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:12:59.108640 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m16:12:59.134255 [debug] [Thread-4 (]: SQL status: OK in 0.127 seconds
[0m16:12:59.138556 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m16:12:59.140385 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:12:59.141542 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m16:13:04.851345 [debug] [Thread-3 (]: SQL status: OK in 5.741 seconds
[0m16:13:04.860902 [debug] [Thread-4 (]: SQL status: OK in 5.718 seconds
[0m16:13:04.865050 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m16:13:04.874459 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:13:04.875618 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m16:13:04.876698 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m16:13:09.313159 [debug] [Thread-4 (]: SQL status: OK in 4.435 seconds
[0m16:13:09.317024 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m16:13:09.318066 [debug] [Thread-3 (]: SQL status: OK in 4.440 seconds
[0m16:13:09.319484 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F27CCFB0>]}
[0m16:13:09.322940 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m16:13:09.326106 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F2B2F650>]}
[0m16:13:09.324780 [info ] [Thread-4 (]: 8 of 11 OK created sql view model analytics_dev.int__regime_changes ............ [[32mOK[0m in 10.73s]
[0m16:13:09.329719 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m16:13:09.328009 [info ] [Thread-3 (]: 7 of 11 OK created sql view model analytics_dev.int__rsi_sma ................... [[32mOK[0m in 10.75s]
[0m16:13:09.331769 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:13:09.334121 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m16:13:09.335545 [info ] [Thread-1 (]: 9 of 11 START sql incremental model analytics_dev.mrt__stocks_with_regimes ..... [RUN]
[0m16:13:09.337384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m16:13:09.338473 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:13:09.339546 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m16:13:09.368173 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:09.369920 [info ] [Thread-2 (]: 10 of 11 START sql view model analytics_dev.int__rsi_wilder .................... [RUN]
[0m16:13:09.371853 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_classification, now model.portfolio_project_2.int__rsi_wilder)
[0m16:13:09.373037 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m16:13:09.386078 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m16:13:09.387976 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:13:09.408171 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:09.409943 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__cf6944359205" cascade
    
[0m16:13:09.411033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:09.412826 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m16:13:09.423862 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m16:13:09.427176 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:13:09.428610 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m16:13:09.429638 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:13:09.434229 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:13:09.435653 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:13:09.436818 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    wilder_gain::decimal(18,2) as wilder_gain,
    wilder_loss::decimal(18,2) as wilder_loss
from wilder
  );

[0m16:13:09.461665 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m16:13:09.548654 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:09.550263 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:13:09.554308 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:13:09.558205 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:09.559234 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m16:13:09.562691 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:13:09.564598 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:09.565606 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m16:13:10.250391 [debug] [Thread-1 (]: SQL status: OK in 0.684 seconds
[0m16:13:10.253157 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:10.254294 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m16:13:10.255715 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:13:10.259931 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:13:10.261389 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:10.263971 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:13:10.273512 [debug] [Thread-2 (]: SQL status: OK in 0.835 seconds
[0m16:13:10.284392 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:13:10.286253 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m16:13:10.358656 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m16:13:10.416896 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:10.418087 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:13:10.429350 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m16:13:10.473148 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:10.474604 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,0))
 as volume, 
      
    cast(null as text)
 as regime
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:13:10.478692 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:13:10.575163 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:10.576757 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."mrt__stocks_with_regimes__cf6944359205"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null
    
    )
 ;
    insert into "finance"."dbt_temp"."mrt__stocks_with_regimes__cf6944359205" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m16:13:11.212962 [debug] [Thread-2 (]: SQL status: OK in 0.925 seconds
[0m16:13:11.220498 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:13:11.221630 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m16:13:12.716827 [debug] [Thread-1 (]: SQL status: OK in 2.138 seconds
[0m16:13:12.737513 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:12.738601 [debug] [Thread-2 (]: SQL status: OK in 1.516 seconds
[0m16:13:12.739644 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m16:13:12.742960 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m16:13:12.744427 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:13:12.745435 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m16:13:12.746677 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:13:12.747697 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:12.748742 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__cf6944359205'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:13:12.762792 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m16:13:12.777536 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:12.778683 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:13:12.792104 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m16:13:12.825167 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:12.826275 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__cf6944359205'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:13:12.839450 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m16:13:12.848251 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:12.849360 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:13:12.862688 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m16:13:12.886558 [debug] [Thread-1 (]: 
    In "finance"."analytics_dev"."mrt__stocks_with_regimes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:13:12.887880 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:12.888864 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
SELECT version()
[0m16:13:12.890902 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:13:13.048730 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:13.051322 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:13.052415 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */


    MERGE INTO "finance"."analytics_dev"."mrt__stocks_with_regimes" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."mrt__stocks_with_regimes__cf6944359205" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m16:13:14.545598 [debug] [Thread-2 (]: SQL status: OK in 1.799 seconds
[0m16:13:14.553473 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m16:13:14.554848 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m16:13:19.767532 [debug] [Thread-1 (]: SQL status: OK in 6.714 seconds
[0m16:13:19.783581 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:13:19.785338 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:19.786791 [debug] [Thread-2 (]: SQL status: OK in 5.230 seconds
[0m16:13:19.787804 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:13:19.792020 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m16:13:19.794143 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F476E7B0>]}
[0m16:13:19.795843 [info ] [Thread-2 (]: 10 of 11 OK created sql view model analytics_dev.int__rsi_wilder ............... [[32mOK[0m in 10.42s]
[0m16:13:19.798077 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m16:13:19.799891 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.fct__rsi
[0m16:13:19.801735 [info ] [Thread-4 (]: 11 of 11 START sql incremental model analytics_dev.fct__rsi .................... [RUN]
[0m16:13:19.804175 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_changes, now model.portfolio_project_2.fct__rsi)
[0m16:13:19.805720 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m16:13:19.825145 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m16:13:19.829738 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m16:13:19.848900 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:19.850909 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__c33b66aff746" cascade
    
[0m16:13:19.852622 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:13:19.855532 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m16:13:19.867085 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:19.868185 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__cf6944359205" cascade
    
[0m16:13:19.918336 [debug] [Thread-4 (]: SQL status: OK in 0.066 seconds
[0m16:13:19.927553 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:19.928832 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:13:19.935306 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:13:19.942504 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:19.944090 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m16:13:19.948490 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:13:19.950282 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:19.951817 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m16:13:20.309592 [debug] [Thread-1 (]: SQL status: OK in 0.440 seconds
[0m16:13:20.315371 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:13:20.318039 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__cf6944359205" cascade
    
[0m16:13:20.533661 [debug] [Thread-1 (]: SQL status: OK in 0.214 seconds
[0m16:13:20.538658 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m16:13:20.540649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F32CCB90>]}
[0m16:13:20.542772 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes  [[32mOK[0m in 11.20s]
[0m16:13:20.545393 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:13:20.601446 [debug] [Thread-4 (]: SQL status: OK in 0.648 seconds
[0m16:13:20.605211 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:20.606209 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    

  
[0m16:13:20.608578 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m16:13:20.612769 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m16:13:20.613918 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:20.614833 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m16:13:20.677170 [debug] [Thread-4 (]: SQL status: OK in 0.061 seconds
[0m16:13:20.680937 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:20.682189 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:13:20.712343 [debug] [Thread-4 (]: SQL status: OK in 0.028 seconds
[0m16:13:20.729667 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:20.730813 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as sma_rs, 
      
    cast(null as decimal(18,2))
 as sma_rsi, 
      
    cast(null as decimal(18,2))
 as wilder_rs, 
      
    cast(null as decimal(18,2))
 as wilder_rsi
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:13:20.735441 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:13:20.744616 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:20.747118 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."fct__rsi__c33b66aff746"
  
  (
    trade_date date not null,
    ticker text not null,
    sma_rs decimal(18,2),
    sma_rsi decimal(18,2),
    wilder_rs decimal(18,2),
    wilder_rsi decimal(18,2)
    
    )
 ;
    insert into "finance"."dbt_temp"."fct__rsi__c33b66aff746" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      sma_rs ,
    
      
      sma_rsi ,
    
      
      wilder_rs ,
    
      
      wilder_rsi 
    
  )
 (
      
    select trade_date, ticker, sma_rs, sma_rsi, wilder_rs, wilder_rsi
    from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as model_subq
    );
  
  
  
[0m16:13:23.950414 [debug] [Thread-4 (]: SQL status: OK in 3.201 seconds
[0m16:13:23.962117 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:23.963801 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m16:13:23.968703 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:13:23.970303 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:23.972809 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__c33b66aff746'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:13:24.000624 [debug] [Thread-4 (]: SQL status: OK in 0.025 seconds
[0m16:13:24.023330 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:24.025179 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:13:24.047258 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m16:13:24.061511 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:24.062792 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__c33b66aff746'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:13:24.077052 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m16:13:24.089355 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:24.090535 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:13:24.111160 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m16:13:24.116674 [debug] [Thread-4 (]: 
    In "finance"."analytics_dev"."fct__rsi":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:13:24.120578 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m16:13:24.123834 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:24.125595 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */


    MERGE INTO "finance"."analytics_dev"."fct__rsi" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."fct__rsi__c33b66aff746" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m16:13:24.184643 [debug] [Thread-4 (]: SQL status: OK in 0.058 seconds
[0m16:13:24.188065 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m16:13:24.189370 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:24.191115 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m16:13:24.245713 [debug] [Thread-4 (]: SQL status: OK in 0.053 seconds
[0m16:13:24.252741 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:24.253805 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__c33b66aff746" cascade
    
[0m16:13:24.547302 [debug] [Thread-4 (]: SQL status: OK in 0.292 seconds
[0m16:13:24.556461 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m16:13:24.557689 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__c33b66aff746" cascade
    
[0m16:13:24.634016 [debug] [Thread-4 (]: SQL status: OK in 0.075 seconds
[0m16:13:24.643099 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: Close
[0m16:13:24.645610 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b444aad9-c0e9-4816-831e-86dfae228311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F2885C10>]}
[0m16:13:24.649693 [info ] [Thread-4 (]: 11 of 11 OK created sql incremental model analytics_dev.fct__rsi ............... [[32mOK[0m in 4.84s]
[0m16:13:24.653576 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m16:13:24.661223 [debug] [MainThread]: Using duckdb connection "master"
[0m16:13:24.664436 [debug] [MainThread]: On master: BEGIN
[0m16:13:24.666290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:13:24.672049 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:13:24.675016 [debug] [MainThread]: On master: COMMIT
[0m16:13:24.677493 [debug] [MainThread]: Using duckdb connection "master"
[0m16:13:24.679932 [debug] [MainThread]: On master: COMMIT
[0m16:13:24.683881 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m16:13:24.686049 [debug] [MainThread]: On master: Close
[0m16:13:24.688615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:24.691266 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m16:13:24.693342 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m16:13:24.696503 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m16:13:24.699385 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m16:13:24.702151 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m16:13:24.704775 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m16:13:24.707621 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m16:13:24.711081 [info ] [MainThread]: 
[0m16:13:24.714906 [info ] [MainThread]: Finished running 2 incremental models, 9 view models in 0 hours 0 minutes and 32.33 seconds (32.33s).
[0m16:13:24.733287 [debug] [MainThread]: Command end result
[0m16:13:25.081925 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:13:25.089153 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:13:25.105950 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m16:13:25.107197 [info ] [MainThread]: 
[0m16:13:25.108586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:25.109821 [info ] [MainThread]: 
[0m16:13:25.111151 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m16:13:25.113684 [debug] [MainThread]: Command `-c run` succeeded at 16:13:25.113368 after 35.64 seconds
[0m16:13:25.114997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F0ED99D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F49A3C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6F49A3770>]}
[0m16:13:25.116409 [debug] [MainThread]: Flushing usage events
[0m16:13:26.829610 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:14:31.367476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E30A88050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E312942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E318D7ED0>]}


============================== 16:14:31.378535 | 5b5d9f7a-01b5-4fc5-971c-1ac512371bfa ==============================
[0m16:14:31.378535 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:14:31.380313 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt snapshot', 'printer_width': '80', 'write_json': 'True'}
[0m16:14:31.917623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b5d9f7a-01b5-4fc5-971c-1ac512371bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E30C40180>]}
[0m16:14:32.045488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b5d9f7a-01b5-4fc5-971c-1ac512371bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E3177B790>]}
[0m16:14:32.050353 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:14:32.611182 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:14:33.032143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:14:33.032802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:14:33.194510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b5d9f7a-01b5-4fc5-971c-1ac512371bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E33258B50>]}
[0m16:14:33.550822 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:14:33.554673 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:14:33.651276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b5d9f7a-01b5-4fc5-971c-1ac512371bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E3053C7D0>]}
[0m16:14:33.653121 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m16:14:33.655188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b5d9f7a-01b5-4fc5-971c-1ac512371bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E32A62C10>]}
[0m16:14:33.670086 [info ] [MainThread]: 
[0m16:14:33.672158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:14:33.673995 [info ] [MainThread]: 
[0m16:14:33.676468 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:14:33.698120 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:14:33.930437 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:14:33.931115 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:14:33.931680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:36.093287 [debug] [ThreadPool]: SQL status: OK in 2.161 seconds
[0m16:14:36.096735 [debug] [ThreadPool]: On list_finance: Close
[0m16:14:36.098559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev_snapshots)
[0m16:14:36.099889 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev_snapshots"
"
[0m16:14:36.116364 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:14:36.117337 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev_snapshots"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:14:36.118160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:36.121946 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:14:36.125493 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:14:36.126409 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: BEGIN
[0m16:14:36.128898 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:14:36.129766 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:14:36.130477 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev_snapshots"} */

    
    
        create schema if not exists "finance"."analytics_dev_snapshots"
    
[0m16:14:36.238166 [debug] [ThreadPool]: SQL status: OK in 0.107 seconds
[0m16:14:36.240199 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: COMMIT
[0m16:14:36.240998 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:14:36.241682 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: COMMIT
[0m16:14:36.317431 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m16:14:36.319039 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: Close
[0m16:14:36.324476 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m16:14:36.331881 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m16:14:36.343180 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:14:36.348810 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:14:36.349889 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m16:14:36.350677 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m16:14:36.351689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:36.352475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:36.355114 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:14:36.356212 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:14:36.357001 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:14:36.357760 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m16:14:36.358591 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:14:36.359917 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m16:14:36.450764 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m16:14:36.451856 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m16:14:36.455595 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m16:14:36.458384 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m16:14:36.461910 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m16:14:36.462905 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m16:14:36.464706 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m16:14:36.466885 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m16:14:36.475973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b5d9f7a-01b5-4fc5-971c-1ac512371bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E334B7040>]}
[0m16:14:36.477261 [debug] [MainThread]: Using duckdb connection "master"
[0m16:14:36.478153 [debug] [MainThread]: On master: BEGIN
[0m16:14:36.478974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:36.482646 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m16:14:36.483952 [debug] [MainThread]: On master: COMMIT
[0m16:14:36.484801 [debug] [MainThread]: Using duckdb connection "master"
[0m16:14:36.485591 [debug] [MainThread]: On master: COMMIT
[0m16:14:36.487346 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:14:36.488234 [debug] [MainThread]: On master: Close
[0m16:14:36.500158 [debug] [Thread-1 (]: Began running node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:14:36.501955 [debug] [Thread-2 (]: Began running node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:14:36.503346 [info ] [Thread-1 (]: 1 of 2 START snapshot analytics_dev_snapshots.regime_classification_snapshot ... [RUN]
[0m16:14:36.506833 [debug] [Thread-1 (]: Acquiring new duckdb connection 'snapshot.portfolio_project_2.regime_classification_snapshot'
[0m16:14:36.504976 [info ] [Thread-2 (]: 2 of 2 START snapshot analytics_dev_snapshots.stg__stocks_snapshot ............. [RUN]
[0m16:14:36.508194 [debug] [Thread-1 (]: Began compiling node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:14:36.509464 [debug] [Thread-2 (]: Acquiring new duckdb connection 'snapshot.portfolio_project_2.stg__stocks_snapshot'
[0m16:14:36.531375 [debug] [Thread-2 (]: Began compiling node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:14:36.543900 [debug] [Thread-1 (]: Began executing node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:14:36.554159 [debug] [Thread-2 (]: Began executing node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:14:36.930853 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:14:36.933537 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:14:36.935940 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: BEGIN
[0m16:14:36.938386 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: BEGIN
[0m16:14:36.940320 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:14:36.942191 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:14:36.949662 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:14:36.952221 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:14:36.954220 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m16:14:36.956568 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:14:36.958901 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:14:36.962440 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:14:36.996695 [debug] [Thread-2 (]: SQL status: OK in 0.035 seconds
[0m16:14:37.008253 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m16:14:37.441844 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:14:37.451377 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

        
  
    
    

    create  table
      "regime_classification_snapshot__dbt_tmp20251113161437333618"
  
    as (
      
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."int__regime_classification"

    ),

    snapshotted_data as (

        select *, 
    
        trade_date as dbt_unique_key
    

        from "finance"."analytics_dev_snapshots"."regime_classification_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
  
    
[0m16:14:37.455058 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:14:37.460914 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

        
  
    
    

    create  table
      "stg__stocks_snapshot__dbt_tmp20251113161437341249"
  
    as (
      
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."src_stocks"

    ),

    snapshotted_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    

        from "finance"."analytics_dev_snapshots"."stg__stocks_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(ticker as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
  
    
[0m16:14:37.749636 [debug] [Thread-2 (]: SQL status: OK in 0.284 seconds
[0m16:14:37.776448 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:14:37.780326 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot__dbt_tmp20251113161437341249'
      
      
      order by ordinal_position

  
[0m16:14:37.819961 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m16:14:37.841316 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:14:37.843314 [debug] [Thread-1 (]: SQL status: OK in 0.386 seconds
[0m16:14:37.846240 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:14:37.853527 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:14:37.854959 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251113161437333618'
      
      
      order by ordinal_position

  
[0m16:14:37.866527 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m16:14:37.867491 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m16:14:37.874469 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:14:37.877004 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot__dbt_tmp20251113161437341249'
      
      
      order by ordinal_position

  
[0m16:14:37.881674 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:14:37.883130 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:14:37.895003 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m16:14:37.904998 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:14:37.906197 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:14:37.907054 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m16:14:37.918440 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:14:37.920152 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251113161437333618'
      
      
      order by ordinal_position

  
[0m16:14:37.928505 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m16:14:37.953158 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:14:37.954280 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m16:14:37.955337 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot__dbt_tmp20251113161437341249'
      
      
      order by ordinal_position

  
[0m16:14:37.969377 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:14:37.971138 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:14:37.974701 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m16:14:38.018365 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m16:14:38.036236 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:14:38.037787 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */
DESCRIBE (select * from (
        
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."src_stocks"

    ),

    snapshotted_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    

        from "finance"."analytics_dev_snapshots"."stg__stocks_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(ticker as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:14:38.046040 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:14:38.049498 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251113161437333618'
      
      
      order by ordinal_position

  
[0m16:14:38.059843 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m16:14:38.070031 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m16:14:38.075929 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:14:38.091724 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */
DESCRIBE (select * from (
        
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."int__regime_classification"

    ),

    snapshotted_data as (

        select *, 
    
        trade_date as dbt_unique_key
    

        from "finance"."analytics_dev_snapshots"."regime_classification_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:14:38.095351 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:14:38.098050 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:14:38.101254 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:14:38.102893 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:14:38.105402 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m16:14:38.107151 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:14:38.109627 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      update "finance"."analytics_dev_snapshots"."stg__stocks_snapshot" as DBT_INTERNAL_TARGET
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "stg__stocks_snapshot__dbt_tmp20251113161437341249" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = DBT_INTERNAL_TARGET.dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and DBT_INTERNAL_TARGET.dbt_valid_to is null;
      

    insert into "finance"."analytics_dev_snapshots"."stg__stocks_snapshot" ("trade_date", "ticker", "open", "high", "low", "close", "volume", "loaded_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."trade_date",DBT_INTERNAL_SOURCE."ticker",DBT_INTERNAL_SOURCE."open",DBT_INTERNAL_SOURCE."high",DBT_INTERNAL_SOURCE."low",DBT_INTERNAL_SOURCE."close",DBT_INTERNAL_SOURCE."volume",DBT_INTERNAL_SOURCE."loaded_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "stg__stocks_snapshot__dbt_tmp20251113161437341249" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;


  
[0m16:14:38.125058 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:14:38.126235 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:14:38.129114 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:14:38.131842 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:14:38.135016 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:14:38.137063 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      update "finance"."analytics_dev_snapshots"."regime_classification_snapshot" as DBT_INTERNAL_TARGET
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "regime_classification_snapshot__dbt_tmp20251113161437333618" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = DBT_INTERNAL_TARGET.dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and DBT_INTERNAL_TARGET.dbt_valid_to is null;
      

    insert into "finance"."analytics_dev_snapshots"."regime_classification_snapshot" ("trade_date", "close", "regime", "loaded_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."trade_date",DBT_INTERNAL_SOURCE."close",DBT_INTERNAL_SOURCE."regime",DBT_INTERNAL_SOURCE."loaded_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "regime_classification_snapshot__dbt_tmp20251113161437333618" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;


  
[0m16:14:38.237380 [debug] [Thread-2 (]: SQL status: OK in 0.126 seconds
[0m16:14:38.271826 [debug] [Thread-1 (]: SQL status: OK in 0.133 seconds
[0m16:14:38.273738 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: COMMIT
[0m16:14:38.276828 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: COMMIT
[0m16:14:38.277958 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:14:38.279048 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:14:38.280642 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: COMMIT
[0m16:14:38.281988 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: COMMIT
[0m16:14:38.438545 [debug] [Thread-2 (]: SQL status: OK in 0.155 seconds
[0m16:14:38.447092 [debug] [Thread-1 (]: SQL status: OK in 0.163 seconds
[0m16:14:38.461189 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:14:38.465044 [debug] [Thread-2 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:14:38.466263 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      drop table if exists "regime_classification_snapshot__dbt_tmp20251113161437333618" cascade
    
[0m16:14:38.467593 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      drop table if exists "stg__stocks_snapshot__dbt_tmp20251113161437341249" cascade
    
[0m16:14:38.623445 [debug] [Thread-2 (]: SQL status: OK in 0.154 seconds
[0m16:14:38.629952 [debug] [Thread-2 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: Close
[0m16:14:38.631392 [debug] [Thread-1 (]: SQL status: OK in 0.162 seconds
[0m16:14:38.639123 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: Close
[0m16:14:38.644182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b5d9f7a-01b5-4fc5-971c-1ac512371bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E32F07A10>]}
[0m16:14:38.643163 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b5d9f7a-01b5-4fc5-971c-1ac512371bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E33622A50>]}
[0m16:14:38.646244 [info ] [Thread-1 (]: 1 of 2 OK snapshotted analytics_dev_snapshots.regime_classification_snapshot ... [[32mOK[0m in 2.14s]
[0m16:14:38.649805 [debug] [Thread-1 (]: Finished running node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:14:38.648026 [info ] [Thread-2 (]: 2 of 2 OK snapshotted analytics_dev_snapshots.stg__stocks_snapshot ............. [[32mOK[0m in 2.12s]
[0m16:14:38.651792 [debug] [Thread-2 (]: Finished running node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:14:38.655329 [debug] [MainThread]: Using duckdb connection "master"
[0m16:14:38.656669 [debug] [MainThread]: On master: BEGIN
[0m16:14:38.657875 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:14:38.661848 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m16:14:38.663863 [debug] [MainThread]: On master: COMMIT
[0m16:14:38.665528 [debug] [MainThread]: Using duckdb connection "master"
[0m16:14:38.666750 [debug] [MainThread]: On master: COMMIT
[0m16:14:38.669250 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:14:38.670599 [debug] [MainThread]: On master: Close
[0m16:14:38.672256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:38.673340 [debug] [MainThread]: Connection 'create_finance_analytics_dev_snapshots' was properly closed.
[0m16:14:38.674103 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m16:14:38.674706 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m16:14:38.675311 [debug] [MainThread]: Connection 'snapshot.portfolio_project_2.regime_classification_snapshot' was properly closed.
[0m16:14:38.675945 [debug] [MainThread]: Connection 'snapshot.portfolio_project_2.stg__stocks_snapshot' was properly closed.
[0m16:14:38.676722 [info ] [MainThread]: 
[0m16:14:38.678788 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m16:14:38.682504 [debug] [MainThread]: Command end result
[0m16:14:38.881127 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:14:38.889079 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:14:38.911195 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m16:14:38.913054 [info ] [MainThread]: 
[0m16:14:38.915489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:14:38.918213 [info ] [MainThread]: 
[0m16:14:38.920734 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m16:14:38.926982 [debug] [MainThread]: Command `-c snapshot` succeeded at 16:14:38.926373 after 7.91 seconds
[0m16:14:38.928714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E34C55C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E32EE7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E32E3D850>]}
[0m16:14:38.931765 [debug] [MainThread]: Flushing usage events
[0m16:14:41.131872 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:06.422293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216426F8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021642F042D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021643547ED0>]}


============================== 16:19:06.436038 | e6cc1dcb-da39-41ed-bb0b-d383383680ce ==============================
[0m16:19:06.436038 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:19:06.438494 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt build --target dev', 'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m16:19:06.955027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216428B0180>]}
[0m16:19:07.050886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216433EB8A0>]}
[0m16:19:07.055131 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:19:07.469003 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m16:19:07.839422 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:19:07.841215 [debug] [MainThread]: previous checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, current checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe
[0m16:19:07.842433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021644E69950>]}
[0m16:19:11.411427 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m16:19:11.412541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021644FF73E0>]}
[0m16:19:12.427606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216451C1E10>]}
[0m16:19:12.644929 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:19:12.649161 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:19:12.742643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216455A7C70>]}
[0m16:19:12.743408 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m16:19:12.761907 [info ] [MainThread]: 
[0m16:19:12.763248 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:19:12.764265 [info ] [MainThread]: 
[0m16:19:12.765527 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:19:12.777947 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:19:12.788865 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:19:12.998827 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:19:12.999854 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:19:13.000792 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:19:13.002041 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:19:13.003047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:13.004060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:14.893026 [debug] [ThreadPool]: SQL status: OK in 1.889 seconds
[0m16:19:14.894454 [debug] [ThreadPool]: SQL status: OK in 1.891 seconds
[0m16:19:14.900665 [debug] [ThreadPool]: On list_finance: Close
[0m16:19:14.904929 [debug] [ThreadPool]: On list_finance: Close
[0m16:19:14.908420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m16:19:14.910084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev_snapshots)
[0m16:19:14.912327 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m16:19:14.914080 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev_snapshots"
"
[0m16:19:14.937906 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:19:14.947003 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:19:14.948515 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:19:14.950029 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev_snapshots"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:19:14.951488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:14.952904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:14.958014 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:19:14.959626 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m16:19:14.964908 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:19:14.969338 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:19:14.970649 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: BEGIN
[0m16:19:14.972070 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m16:19:14.975606 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:19:14.977267 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:19:14.978527 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:19:14.979909 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m16:19:14.981392 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:19:14.983381 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev_snapshots"} */

    
    
        create schema if not exists "finance"."analytics_dev_snapshots"
    
[0m16:19:15.041286 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m16:19:15.043411 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m16:19:15.046855 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:19:15.050338 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: COMMIT
[0m16:19:15.051851 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:19:15.053349 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m16:19:15.054787 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:19:15.056466 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: COMMIT
[0m16:19:15.116926 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m16:19:15.118206 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m16:19:15.119171 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m16:19:15.120526 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: Close
[0m16:19:15.128276 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m16:19:15.137809 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m16:19:15.145339 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:19:15.151171 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:19:15.152525 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m16:19:15.153435 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m16:19:15.154376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:15.155310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:15.157968 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:19:15.158895 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:19:15.159716 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:19:15.160646 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m16:19:15.161652 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:19:15.163056 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m16:19:15.232307 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m16:19:15.235830 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m16:19:15.237349 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m16:19:15.241394 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m16:19:15.243538 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m16:19:15.244738 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m16:19:15.246116 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m16:19:15.247429 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m16:19:15.256553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216453DC710>]}
[0m16:19:15.257940 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:15.258851 [debug] [MainThread]: On master: BEGIN
[0m16:19:15.259649 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:15.262307 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m16:19:15.263295 [debug] [MainThread]: On master: COMMIT
[0m16:19:15.264108 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:15.264882 [debug] [MainThread]: On master: COMMIT
[0m16:19:15.266483 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:19:15.267361 [debug] [MainThread]: On master: Close
[0m16:19:15.278309 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m16:19:15.279808 [debug] [Thread-3 (]: Began running node seed.portfolio_project_2.regime_thresholds
[0m16:19:15.280876 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m16:19:15.282232 [info ] [Thread-1 (]: 1 of 125 START sql view model analytics_dev.src_stocks ......................... [RUN]
[0m16:19:15.286525 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m16:19:15.283547 [info ] [Thread-3 (]: 3 of 125 START seed file analytics_dev.regime_thresholds ....................... [RUN]
[0m16:19:15.287921 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m16:19:15.289413 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.portfolio_project_2.regime_thresholds'
[0m16:19:15.285112 [info ] [Thread-2 (]: 2 of 125 START sql view model analytics_dev.src_vix ............................ [RUN]
[0m16:19:15.315215 [debug] [Thread-3 (]: Began compiling node seed.portfolio_project_2.regime_thresholds
[0m16:19:15.320022 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m16:19:15.321222 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m16:19:15.322184 [debug] [Thread-3 (]: Began executing node seed.portfolio_project_2.regime_thresholds
[0m16:19:15.323996 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m16:19:15.486507 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m16:19:15.489693 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m16:19:15.569919 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m16:19:15.595021 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m16:19:15.596114 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: BEGIN
[0m16:19:15.597060 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:19:15.599425 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m16:19:15.607234 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m16:19:15.608414 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:19:15.609863 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m16:19:15.610925 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m16:19:15.611968 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:19:15.613164 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m16:19:15.615185 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "seed.portfolio_project_2.regime_thresholds"} */
truncate table "finance"."analytics_dev"."regime_thresholds"
[0m16:19:15.617044 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:19:15.618289 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m16:19:15.619552 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:19:15.620614 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m16:19:15.622133 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:19:15.623221 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m16:19:15.625058 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:19:15.626132 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:19:15.627152 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m16:19:15.739257 [debug] [Thread-3 (]: SQL status: OK in 0.121 seconds
[0m16:19:15.769441 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m16:19:15.770526 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: 
          COPY "finance"."analytics_dev"."regime_thresholds" FROM 'C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\seeds\regime_thresholds.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:19:15.818081 [debug] [Thread-2 (]: SQL status: OK in 0.190 seconds
[0m16:19:15.834498 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:19:15.835589 [debug] [Thread-1 (]: SQL status: OK in 0.211 seconds
[0m16:19:15.837239 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m16:19:15.846492 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:19:15.848095 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m16:19:15.926486 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m16:19:15.938624 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:19:15.940175 [debug] [Thread-3 (]: SQL status: OK in 0.169 seconds
[0m16:19:15.941291 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m16:19:15.948170 [debug] [Thread-2 (]: SQL status: OK in 0.100 seconds
[0m16:19:15.956747 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.portfolio_project_2.regime_thresholds"
[0m16:19:15.965298 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:19:15.966777 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m16:19:15.992115 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m16:19:15.993191 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m16:19:15.994100 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m16:19:16.132994 [debug] [Thread-2 (]: SQL status: OK in 0.165 seconds
[0m16:19:16.140662 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:19:16.141677 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:19:16.142621 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:19:16.145300 [debug] [Thread-1 (]: SQL status: OK in 0.187 seconds
[0m16:19:16.148495 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m16:19:16.149480 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:19:16.150397 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m16:19:16.819410 [debug] [Thread-3 (]: SQL status: OK in 0.824 seconds
[0m16:19:16.823699 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: Close
[0m16:19:16.828543 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216455A9180>]}
[0m16:19:16.829762 [info ] [Thread-3 (]: 3 of 125 OK loaded seed file analytics_dev.regime_thresholds ................... [[32mINSERT 1[0m in 1.54s]
[0m16:19:16.831526 [debug] [Thread-3 (]: Finished running node seed.portfolio_project_2.regime_thresholds
[0m16:19:16.833159 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.assert_regime_threshold_ordering
[0m16:19:16.834057 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m16:19:16.834913 [info ] [Thread-4 (]: 4 of 125 START test assert_regime_threshold_ordering ........................... [RUN]
[0m16:19:16.837363 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.assert_regime_threshold_ordering'
[0m16:19:16.835847 [info ] [Thread-3 (]: 5 of 125 START test not_null_regime_thresholds_effective_date .................. [RUN]
[0m16:19:16.838496 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.assert_regime_threshold_ordering
[0m16:19:16.839567 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.portfolio_project_2.regime_thresholds, now test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5)
[0m16:19:16.846351 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m16:19:16.847364 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m16:19:16.861736 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m16:19:16.863406 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.assert_regime_threshold_ordering
[0m16:19:16.901651 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m16:19:16.902547 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m16:19:16.908150 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m16:19:16.909654 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m16:19:16.910441 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: BEGIN
[0m16:19:16.911167 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:19:16.913517 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m16:19:16.914757 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: BEGIN
[0m16:19:16.915583 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:16.916594 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:19:16.917865 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m16:19:16.918732 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.assert_regime_threshold_ordering"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select
    version_id,
    complacent_max,
    normal_max,
    elevated_max
from "finance"."analytics_dev"."regime_thresholds"
where not (complacent_max < normal_max and normal_max < elevated_max)
  
  
      
    ) dbt_internal_test
[0m16:19:16.919926 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:19:16.920821 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m16:19:16.921681 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_date
from "finance"."analytics_dev"."regime_thresholds"
where effective_date is null



  
  
      
    ) dbt_internal_test
[0m16:19:16.968988 [debug] [Thread-2 (]: SQL status: OK in 0.825 seconds
[0m16:19:16.978823 [debug] [Thread-1 (]: SQL status: OK in 0.827 seconds
[0m16:19:16.984848 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:19:16.993215 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m16:19:16.994452 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m16:19:16.995910 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m16:19:17.113416 [debug] [Thread-4 (]: SQL status: OK in 0.194 seconds
[0m16:19:17.114447 [debug] [Thread-3 (]: SQL status: OK in 0.192 seconds
[0m16:19:17.127893 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: ROLLBACK
[0m16:19:17.129104 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: ROLLBACK
[0m16:19:17.131672 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5'
[0m16:19:17.132596 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: Close
[0m16:19:17.130659 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.assert_regime_threshold_ordering'
[0m16:19:17.133843 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: Close
[0m16:19:17.135161 [info ] [Thread-3 (]: 5 of 125 PASS not_null_regime_thresholds_effective_date ........................ [[32mPASS[0m in 0.30s]
[0m16:19:17.136930 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m16:19:17.137875 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m16:19:17.138848 [info ] [Thread-3 (]: 6 of 125 START test not_null_regime_thresholds_version_id ...................... [RUN]
[0m16:19:17.142537 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5, now test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c)
[0m16:19:17.140491 [info ] [Thread-4 (]: 4 of 125 PASS assert_regime_threshold_ordering ................................. [[32mPASS[0m in 0.30s]
[0m16:19:17.143964 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m16:19:17.145450 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.assert_regime_threshold_ordering
[0m16:19:17.154483 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m16:19:17.155883 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m16:19:17.158689 [info ] [Thread-4 (]: 7 of 125 START test unique_regime_thresholds_effective_date .................... [RUN]
[0m16:19:17.160941 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.assert_regime_threshold_ordering, now test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c)
[0m16:19:17.162442 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m16:19:17.163551 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m16:19:17.176866 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m16:19:17.189247 [debug] [Thread-2 (]: SQL status: OK in 0.192 seconds
[0m16:19:17.195385 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m16:19:17.196521 [debug] [Thread-1 (]: SQL status: OK in 0.199 seconds
[0m16:19:17.201047 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m16:19:17.207905 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m16:19:17.210271 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m16:19:17.211976 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164530A710>]}
[0m16:19:17.213572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021644F223C0>]}
[0m16:19:17.215121 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: BEGIN
[0m16:19:17.217510 [info ] [Thread-2 (]: 2 of 125 OK created sql view model analytics_dev.src_vix ....................... [[32mOK[0m in 1.89s]
[0m16:19:17.221300 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:17.223413 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m16:19:17.225860 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m16:19:17.219821 [info ] [Thread-1 (]: 1 of 125 OK created sql view model analytics_dev.src_stocks .................... [[32mOK[0m in 1.93s]
[0m16:19:17.233776 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m16:19:17.235092 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m16:19:17.236954 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m16:19:17.238503 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m16:19:17.240749 [info ] [Thread-2 (]: 8 of 125 START test unique_regime_thresholds_version_id ........................ [RUN]
[0m16:19:17.244128 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m16:19:17.245942 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__stocks
[0m16:19:17.247643 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f)
[0m16:19:17.248990 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_id
from "finance"."analytics_dev"."regime_thresholds"
where version_id is null



  
  
      
    ) dbt_internal_test
[0m16:19:17.252280 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m16:19:17.250706 [info ] [Thread-1 (]: 9 of 125 START sql view model analytics_dev.stg__stocks ........................ [RUN]
[0m16:19:17.254218 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m16:19:17.293393 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m16:19:17.294574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.stg__stocks)
[0m16:19:17.295953 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: BEGIN
[0m16:19:17.297573 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m16:19:17.299206 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:17.308429 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m16:19:17.310936 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m16:19:17.319511 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m16:19:17.320770 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m16:19:17.322943 [debug] [Thread-3 (]: SQL status: OK in 0.067 seconds
[0m16:19:17.324770 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m16:19:17.326716 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m16:19:17.328321 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    effective_date as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."regime_thresholds"
where effective_date is not null
group by effective_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:19:17.330633 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m16:19:17.342936 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: ROLLBACK
[0m16:19:17.344843 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m16:19:17.346566 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: BEGIN
[0m16:19:17.348716 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c'
[0m16:19:17.350378 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:17.351610 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: Close
[0m16:19:17.353947 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:19:17.356950 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m16:19:17.355835 [info ] [Thread-3 (]: 6 of 125 PASS not_null_regime_thresholds_version_id ............................ [[32mPASS[0m in 0.21s]
[0m16:19:17.358392 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m16:19:17.359435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:17.362487 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m16:19:17.361147 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m16:19:17.364850 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    version_id as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."regime_thresholds"
where version_id is not null
group by version_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:19:17.366236 [debug] [Thread-3 (]: Began running node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:19:17.369704 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m16:19:17.368666 [info ] [Thread-3 (]: 10 of 125 START snapshot analytics_dev_snapshots.stg__stocks_snapshot .......... [RUN]
[0m16:19:17.371236 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:19:17.372718 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c, now snapshot.portfolio_project_2.stg__stocks_snapshot)
[0m16:19:17.374159 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m16:19:17.375454 [debug] [Thread-3 (]: Began compiling node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:19:17.387986 [debug] [Thread-3 (]: Began executing node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:19:17.427829 [debug] [Thread-4 (]: SQL status: OK in 0.081 seconds
[0m16:19:17.454503 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: ROLLBACK
[0m16:19:17.469168 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c'
[0m16:19:17.478423 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: Close
[0m16:19:17.487734 [debug] [Thread-2 (]: SQL status: OK in 0.120 seconds
[0m16:19:17.520418 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: ROLLBACK
[0m16:19:17.508862 [info ] [Thread-4 (]: 7 of 125 PASS unique_regime_thresholds_effective_date .......................... [[32mPASS[0m in 0.35s]
[0m16:19:17.537837 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:19:17.538950 [debug] [Thread-1 (]: SQL status: OK in 0.162 seconds
[0m16:19:17.540780 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f'
[0m16:19:17.543024 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m16:19:17.544505 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: BEGIN
[0m16:19:17.552855 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:19:17.554049 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: Close
[0m16:19:17.555543 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:17.556734 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m16:19:17.559749 [info ] [Thread-2 (]: 8 of 125 PASS unique_regime_thresholds_version_id .............................. [[32mPASS[0m in 0.31s]
[0m16:19:17.562087 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m16:19:17.563854 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m16:19:17.565181 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:19:17.566901 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:19:17.568217 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m16:19:17.570120 [info ] [Thread-4 (]: 11 of 125 START sql view model analytics_dev.stg__vix_with_versions ............ [RUN]
[0m16:19:17.572559 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c, now model.portfolio_project_2.stg__vix_with_versions)
[0m16:19:17.573819 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m16:19:17.583738 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m16:19:17.586263 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m16:19:17.601434 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m16:19:17.650420 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m16:19:17.667075 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m16:19:17.697310 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:19:17.722172 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m16:19:17.769894 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:19:17.778575 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:19:17.779674 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m16:19:17.781082 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

        
  
    
    

    create  table
      "stg__stocks_snapshot__dbt_tmp20251113161917754140"
  
    as (
      
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."src_stocks"

    ),

    snapshotted_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    

        from "finance"."analytics_dev_snapshots"."stg__stocks_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(ticker as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
  
    
[0m16:19:17.782450 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:17.786930 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:19:17.788006 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:19:17.789103 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m16:19:17.884593 [debug] [Thread-1 (]: SQL status: OK in 0.147 seconds
[0m16:19:17.887922 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m16:19:17.888911 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:19:17.889881 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m16:19:17.947028 [debug] [Thread-4 (]: SQL status: OK in 0.157 seconds
[0m16:19:17.956505 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:19:17.957853 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m16:19:17.975330 [debug] [Thread-3 (]: SQL status: OK in 0.191 seconds
[0m16:19:17.983788 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:19:17.985108 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot__dbt_tmp20251113161917754140'
      
      
      order by ordinal_position

  
[0m16:19:18.002604 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m16:19:18.013236 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:19:18.014622 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:19:18.031207 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m16:19:18.043221 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:19:18.044602 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot__dbt_tmp20251113161917754140'
      
      
      order by ordinal_position

  
[0m16:19:18.059881 [debug] [Thread-4 (]: SQL status: OK in 0.100 seconds
[0m16:19:18.069151 [debug] [Thread-3 (]: SQL status: OK in 0.023 seconds
[0m16:19:18.073081 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:19:18.075305 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m16:19:18.086026 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:19:18.087831 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:19:18.093799 [debug] [Thread-1 (]: SQL status: OK in 0.203 seconds
[0m16:19:18.102851 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m16:19:18.104544 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m16:19:18.107583 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m16:19:18.127984 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:19:18.129341 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__stocks_snapshot__dbt_tmp20251113161917754140'
      
      
      order by ordinal_position

  
[0m16:19:18.145367 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m16:19:18.198069 [debug] [Thread-4 (]: SQL status: OK in 0.113 seconds
[0m16:19:18.218144 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m16:19:18.234034 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:19:18.235501 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:19:18.238073 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */
DESCRIBE (select * from (
        
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."src_stocks"

    ),

    snapshotted_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    

        from "finance"."analytics_dev_snapshots"."stg__stocks_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(ticker as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            trade_date as dbt_unique_key_1 ,
        
            ticker as dbt_unique_key_2
        
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:19:18.240053 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m16:19:18.251016 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m16:19:18.276447 [debug] [Thread-1 (]: SQL status: OK in 0.170 seconds
[0m16:19:18.280985 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: Close
[0m16:19:18.299749 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:19:18.302203 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:19:18.303589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021646DD2040>]}
[0m16:19:18.307814 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:19:18.306321 [info ] [Thread-1 (]: 9 of 125 OK created sql view model analytics_dev.stg__stocks ................... [[32mOK[0m in 1.01s]
[0m16:19:18.310452 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m16:19:18.312214 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:19:18.315289 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m16:19:18.316663 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m16:19:18.318085 [info ] [Thread-2 (]: 12 of 125 START test dbt_utils_expression_is_true_stg__stocks_close___0 ........ [RUN]
[0m16:19:18.321755 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c)
[0m16:19:18.323353 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m16:19:18.320034 [info ] [Thread-1 (]: 13 of 125 START test dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high  [RUN]
[0m16:19:18.339597 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m16:19:18.342614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338)
[0m16:19:18.344710 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:19:18.346673 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m16:19:18.349605 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      update "finance"."analytics_dev_snapshots"."stg__stocks_snapshot" as DBT_INTERNAL_TARGET
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "stg__stocks_snapshot__dbt_tmp20251113161917754140" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = DBT_INTERNAL_TARGET.dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and DBT_INTERNAL_TARGET.dbt_valid_to is null;
      

    insert into "finance"."analytics_dev_snapshots"."stg__stocks_snapshot" ("trade_date", "ticker", "open", "high", "low", "close", "volume", "loaded_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."trade_date",DBT_INTERNAL_SOURCE."ticker",DBT_INTERNAL_SOURCE."open",DBT_INTERNAL_SOURCE."high",DBT_INTERNAL_SOURCE."low",DBT_INTERNAL_SOURCE."close",DBT_INTERNAL_SOURCE."volume",DBT_INTERNAL_SOURCE."loaded_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "stg__stocks_snapshot__dbt_tmp20251113161917754140" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;


  
[0m16:19:18.371909 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m16:19:18.374166 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m16:19:18.386094 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m16:19:18.390103 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m16:19:18.404515 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m16:19:18.406219 [debug] [Thread-4 (]: SQL status: OK in 0.163 seconds
[0m16:19:18.415625 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:19:18.417008 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m16:19:18.418580 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m16:19:18.420874 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: BEGIN
[0m16:19:18.423109 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m16:19:18.424782 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:18.426242 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: BEGIN
[0m16:19:18.428269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:18.430373 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m16:19:18.432380 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:19:18.433300 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m16:19:18.434676 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m16:19:18.436150 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(close >= 0)


  
  
      
    ) dbt_internal_test
[0m16:19:18.437684 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(close >= low and close <= high)


  
  
      
    ) dbt_internal_test
[0m16:19:18.569806 [debug] [Thread-3 (]: SQL status: OK in 0.196 seconds
[0m16:19:18.575979 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: COMMIT
[0m16:19:18.579394 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:19:18.581362 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: COMMIT
[0m16:19:18.596957 [debug] [Thread-4 (]: SQL status: OK in 0.176 seconds
[0m16:19:18.603288 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m16:19:18.605612 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021644DA2AB0>]}
[0m16:19:18.608220 [info ] [Thread-4 (]: 11 of 125 OK created sql view model analytics_dev.stg__vix_with_versions ....... [[32mOK[0m in 1.03s]
[0m16:19:18.611907 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m16:19:18.613693 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m16:19:18.615876 [info ] [Thread-4 (]: 14 of 125 START test dbt_utils_expression_is_true_stg__stocks_high___0 ......... [RUN]
[0m16:19:18.619677 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c)
[0m16:19:18.623309 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m16:19:18.649434 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m16:19:18.653710 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m16:19:18.666118 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m16:19:18.669535 [debug] [Thread-2 (]: SQL status: OK in 0.230 seconds
[0m16:19:18.672071 [debug] [Thread-1 (]: SQL status: OK in 0.229 seconds
[0m16:19:18.676317 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m16:19:18.678271 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: BEGIN
[0m16:19:18.685367 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: ROLLBACK
[0m16:19:18.687679 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:18.697108 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: ROLLBACK
[0m16:19:18.702099 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338'
[0m16:19:18.705379 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: Close
[0m16:19:18.707784 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c'
[0m16:19:18.710007 [debug] [Thread-4 (]: SQL status: OK in 0.022 seconds
[0m16:19:18.712110 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: Close
[0m16:19:18.714099 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m16:19:18.716290 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(high >= 0)


  
  
      
    ) dbt_internal_test
[0m16:19:18.725416 [info ] [Thread-2 (]: 12 of 125 PASS dbt_utils_expression_is_true_stg__stocks_close___0 .............. [[32mPASS[0m in 0.40s]
[0m16:19:18.731320 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m16:19:18.733040 [debug] [Thread-3 (]: SQL status: OK in 0.150 seconds
[0m16:19:18.727948 [info ] [Thread-1 (]: 13 of 125 PASS dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high  [[32mPASS[0m in 0.39s]
[0m16:19:18.736625 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m16:19:18.751742 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.stg__stocks_snapshot"
[0m16:19:18.754759 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m16:19:18.759541 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.stg__stocks_snapshot"} */

      drop table if exists "stg__stocks_snapshot__dbt_tmp20251113161917754140" cascade
    
[0m16:19:18.757428 [info ] [Thread-2 (]: 15 of 125 START test dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp  [RUN]
[0m16:19:18.762719 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m16:19:18.765620 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa)
[0m16:19:18.770463 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m16:19:18.767990 [info ] [Thread-1 (]: 16 of 125 START test dbt_utils_expression_is_true_stg__stocks_low___0 .......... [RUN]
[0m16:19:18.795915 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m16:19:18.797935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99)
[0m16:19:18.800991 [debug] [Thread-4 (]: SQL status: OK in 0.082 seconds
[0m16:19:18.804964 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m16:19:18.841955 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: ROLLBACK
[0m16:19:18.847139 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m16:19:18.850895 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c'
[0m16:19:18.853459 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m16:19:18.856589 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: Close
[0m16:19:18.871072 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m16:19:18.874460 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m16:19:18.890052 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m16:19:18.877518 [info ] [Thread-4 (]: 14 of 125 PASS dbt_utils_expression_is_true_stg__stocks_high___0 ............... [[32mPASS[0m in 0.26s]
[0m16:19:18.895396 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m16:19:18.898772 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m16:19:18.901296 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m16:19:18.905470 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: BEGIN
[0m16:19:18.909012 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m16:19:18.914562 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:18.911823 [info ] [Thread-4 (]: 17 of 125 START test dbt_utils_expression_is_true_stg__stocks_open___0 ......... [RUN]
[0m16:19:18.917772 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: BEGIN
[0m16:19:18.921137 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec)
[0m16:19:18.923435 [debug] [Thread-3 (]: SQL status: OK in 0.158 seconds
[0m16:19:18.925466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:18.927315 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m16:19:18.928701 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m16:19:18.933567 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.stg__stocks_snapshot: Close
[0m16:19:18.947772 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m16:19:18.949183 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m16:19:18.950507 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m16:19:18.952479 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216448656D0>]}
[0m16:19:18.954213 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m16:19:18.956658 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m16:19:18.962441 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(low >= 0)


  
  
      
    ) dbt_internal_test
[0m16:19:18.960156 [info ] [Thread-3 (]: 10 of 125 OK snapshotted analytics_dev_snapshots.stg__stocks_snapshot .......... [[32mOK[0m in 1.58s]
[0m16:19:18.964894 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m16:19:18.967758 [debug] [Thread-3 (]: Finished running node snapshot.portfolio_project_2.stg__stocks_snapshot
[0m16:19:18.978384 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m16:19:18.980700 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m16:19:18.982618 [info ] [Thread-3 (]: 18 of 125 START test dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high  [RUN]
[0m16:19:18.984604 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.portfolio_project_2.stg__stocks_snapshot, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8)
[0m16:19:18.986072 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m16:19:19.001637 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m16:19:19.003542 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m16:19:19.005620 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: BEGIN
[0m16:19:19.006878 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:19.009196 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m16:19:19.017272 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m16:19:19.018965 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m16:19:19.020248 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m16:19:19.021427 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(open >= 0)


  
  
      
    ) dbt_internal_test
[0m16:19:19.023848 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m16:19:19.025087 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: BEGIN
[0m16:19:19.026739 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:19.031248 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m16:19:19.032486 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m16:19:19.033642 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(open >= low and open <= high)


  
  
      
    ) dbt_internal_test
[0m16:19:19.106797 [debug] [Thread-4 (]: SQL status: OK in 0.084 seconds
[0m16:19:19.108503 [debug] [Thread-1 (]: SQL status: OK in 0.142 seconds
[0m16:19:19.109698 [debug] [Thread-2 (]: SQL status: OK in 0.145 seconds
[0m16:19:19.116018 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: ROLLBACK
[0m16:19:19.120799 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: ROLLBACK
[0m16:19:19.122887 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec'
[0m16:19:19.127290 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: ROLLBACK
[0m16:19:19.128551 [debug] [Thread-3 (]: SQL status: OK in 0.094 seconds
[0m16:19:19.130351 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99'
[0m16:19:19.131594 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: Close
[0m16:19:19.134846 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa'
[0m16:19:19.136623 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: Close
[0m16:19:19.142471 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: ROLLBACK
[0m16:19:19.144319 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: Close
[0m16:19:19.146619 [info ] [Thread-4 (]: 17 of 125 PASS dbt_utils_expression_is_true_stg__stocks_open___0 ............... [[32mPASS[0m in 0.23s]
[0m16:19:19.149785 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8'
[0m16:19:19.151456 [info ] [Thread-1 (]: 16 of 125 PASS dbt_utils_expression_is_true_stg__stocks_low___0 ................ [[32mPASS[0m in 0.35s]
[0m16:19:19.156323 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m16:19:19.160688 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: Close
[0m16:19:19.158894 [info ] [Thread-2 (]: 15 of 125 PASS dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp  [[32mPASS[0m in 0.39s]
[0m16:19:19.163983 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m16:19:19.166256 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m16:19:19.171197 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m16:19:19.178580 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m16:19:19.175764 [info ] [Thread-3 (]: 18 of 125 PASS dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high . [[32mPASS[0m in 0.19s]
[0m16:19:19.184505 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m16:19:19.181830 [info ] [Thread-4 (]: 19 of 125 START test dbt_utils_expression_is_true_stg__stocks_trade_date___current_date  [RUN]
[0m16:19:19.191641 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m16:19:19.188537 [info ] [Thread-1 (]: 20 of 125 START test dbt_utils_expression_is_true_stg__stocks_volume___0 ....... [RUN]
[0m16:19:19.196875 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4)
[0m16:19:19.194911 [info ] [Thread-2 (]: 21 of 125 START test dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker  [RUN]
[0m16:19:19.199557 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m16:19:19.202269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e)
[0m16:19:19.205596 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m16:19:19.207959 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91)
[0m16:19:19.212470 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m16:19:19.209974 [info ] [Thread-3 (]: 22 of 125 START test not_null_stg__stocks_close ................................ [RUN]
[0m16:19:19.237992 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m16:19:19.240099 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m16:19:19.258585 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m16:19:19.260435 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8, now test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f)
[0m16:19:19.280893 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m16:19:19.283435 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m16:19:19.302276 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m16:19:19.304192 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m16:19:19.324558 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m16:19:19.334428 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m16:19:19.342584 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m16:19:19.344795 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m16:19:19.356182 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m16:19:19.358281 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m16:19:19.369430 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m16:19:19.372092 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m16:19:19.373914 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: BEGIN
[0m16:19:19.375615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:19.378213 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m16:19:19.380929 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: BEGIN
[0m16:19:19.382619 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:19.385571 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m16:19:19.387522 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m16:19:19.389524 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m16:19:19.391245 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m16:19:19.392999 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m16:19:19.394787 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: BEGIN
[0m16:19:19.396650 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: BEGIN
[0m16:19:19.398574 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(volume >= 0)


  
  
      
    ) dbt_internal_test
[0m16:19:19.400521 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m16:19:19.402331 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:19.404130 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:19.406326 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m16:19:19.411464 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:19:19.413211 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m16:19:19.414877 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m16:19:19.416696 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        trade_date, ticker
    from "finance"."analytics_dev"."stg__stocks"
    group by trade_date, ticker
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m16:19:19.418643 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m16:19:19.421603 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."stg__stocks"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:19:19.674767 [debug] [Thread-4 (]: SQL status: OK in 0.264 seconds
[0m16:19:19.676636 [debug] [Thread-3 (]: SQL status: OK in 0.253 seconds
[0m16:19:19.678632 [debug] [Thread-2 (]: SQL status: OK in 0.258 seconds
[0m16:19:19.680698 [debug] [Thread-1 (]: SQL status: OK in 0.275 seconds
[0m16:19:19.685929 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: ROLLBACK
[0m16:19:19.691258 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: ROLLBACK
[0m16:19:19.696861 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: ROLLBACK
[0m16:19:19.701938 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: ROLLBACK
[0m16:19:19.704747 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f'
[0m16:19:19.707242 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4'
[0m16:19:19.710294 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91'
[0m16:19:19.712413 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e'
[0m16:19:19.713984 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: Close
[0m16:19:19.715651 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: Close
[0m16:19:19.717320 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: Close
[0m16:19:19.718987 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: Close
[0m16:19:19.722513 [info ] [Thread-3 (]: 22 of 125 PASS not_null_stg__stocks_close ...................................... [[32mPASS[0m in 0.46s]
[0m16:19:19.731322 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m16:19:19.726255 [info ] [Thread-1 (]: 20 of 125 PASS dbt_utils_expression_is_true_stg__stocks_volume___0 ............. [[32mPASS[0m in 0.52s]
[0m16:19:19.733628 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m16:19:19.736450 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m16:19:19.728133 [info ] [Thread-4 (]: 19 of 125 PASS dbt_utils_expression_is_true_stg__stocks_trade_date___current_date  [[32mPASS[0m in 0.53s]
[0m16:19:19.724472 [error] [Thread-2 (]: 21 of 125 FAIL 1255 dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker  [[31mFAIL 1255[0m in 0.52s]
[0m16:19:19.741651 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m16:19:19.738741 [info ] [Thread-3 (]: 23 of 125 START test not_null_stg__stocks_high ................................. [RUN]
[0m16:19:19.745455 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m16:19:19.747970 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m16:19:19.751349 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f, now test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4)
[0m16:19:19.749699 [info ] [Thread-1 (]: 24 of 125 START test not_null_stg__stocks_loaded_at ............................ [RUN]
[0m16:19:19.753876 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m16:19:19.755855 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m16:19:19.758306 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91' to be skipped because of status 'fail'.  Reason: Got 1255 results, configured to fail if != 0.
[0m16:19:19.759836 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m16:19:19.761595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e, now test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf)
[0m16:19:19.763403 [info ] [Thread-4 (]: 25 of 125 START test not_null_stg__stocks_low .................................. [RUN]
[0m16:19:19.785229 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m16:19:19.765356 [info ] [Thread-2 (]: 26 of 125 START test not_null_stg__stocks_open ................................. [RUN]
[0m16:19:19.787780 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m16:19:19.789888 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4, now test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52)
[0m16:19:19.792222 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91, now test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7)
[0m16:19:19.813643 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m16:19:19.815989 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m16:19:19.818449 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m16:19:19.822141 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m16:19:19.841949 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m16:19:19.860508 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m16:19:19.874108 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m16:19:19.876450 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m16:19:19.886723 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m16:19:19.890140 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m16:19:19.897839 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m16:19:19.901209 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m16:19:19.902982 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m16:19:19.911641 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m16:19:19.914511 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m16:19:19.916116 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: BEGIN
[0m16:19:19.918531 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: BEGIN
[0m16:19:19.920358 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m16:19:19.921932 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:19.923725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:19.925522 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: BEGIN
[0m16:19:19.928527 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m16:19:19.931652 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m16:19:19.933904 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:19.935617 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: BEGIN
[0m16:19:19.937360 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m16:19:19.939013 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m16:19:19.941185 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:19.942936 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select high
from "finance"."analytics_dev"."stg__stocks"
where high is null



  
  
      
    ) dbt_internal_test
[0m16:19:19.944759 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m16:19:19.946390 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m16:19:19.949227 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."stg__stocks"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m16:19:19.950954 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m16:19:19.952590 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m16:19:19.954998 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select low
from "finance"."analytics_dev"."stg__stocks"
where low is null



  
  
      
    ) dbt_internal_test
[0m16:19:19.957312 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m16:19:19.959929 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "finance"."analytics_dev"."stg__stocks"
where open is null



  
  
      
    ) dbt_internal_test
[0m16:19:20.085377 [debug] [Thread-3 (]: SQL status: OK in 0.137 seconds
[0m16:19:20.087002 [debug] [Thread-4 (]: SQL status: OK in 0.128 seconds
[0m16:19:20.088497 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m16:19:20.089645 [debug] [Thread-2 (]: SQL status: OK in 0.128 seconds
[0m16:19:20.093150 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: ROLLBACK
[0m16:19:20.095681 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4'
[0m16:19:20.097981 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: Close
[0m16:19:20.101547 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: ROLLBACK
[0m16:19:20.104362 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: ROLLBACK
[0m16:19:20.107800 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: ROLLBACK
[0m16:19:20.110818 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf'
[0m16:19:20.109412 [info ] [Thread-3 (]: 23 of 125 PASS not_null_stg__stocks_high ....................................... [[32mPASS[0m in 0.36s]
[0m16:19:20.112855 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52'
[0m16:19:20.114615 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7'
[0m16:19:20.115652 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: Close
[0m16:19:20.117375 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m16:19:20.118479 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: Close
[0m16:19:20.119603 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: Close
[0m16:19:20.121093 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m16:19:20.122984 [info ] [Thread-1 (]: 24 of 125 PASS not_null_stg__stocks_loaded_at .................................. [[32mPASS[0m in 0.36s]
[0m16:19:20.126625 [info ] [Thread-2 (]: 26 of 125 PASS not_null_stg__stocks_open ....................................... [[32mPASS[0m in 0.33s]
[0m16:19:20.129822 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m16:19:20.125132 [info ] [Thread-4 (]: 25 of 125 PASS not_null_stg__stocks_low ........................................ [[32mPASS[0m in 0.34s]
[0m16:19:20.131526 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m16:19:20.132497 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m16:19:20.134252 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m16:19:20.127954 [info ] [Thread-3 (]: 27 of 125 START test not_null_stg__stocks_ticker ............................... [RUN]
[0m16:19:20.135525 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m16:19:20.137444 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m16:19:20.136577 [info ] [Thread-1 (]: 28 of 125 START test not_null_stg__stocks_trade_date ........................... [RUN]
[0m16:19:20.138817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4, now test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71)
[0m16:19:20.139929 [info ] [Thread-2 (]: 29 of 125 START test not_null_stg__stocks_volume ............................... [RUN]
[0m16:19:20.142064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf, now test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182)
[0m16:19:20.143255 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m16:19:20.140776 [info ] [Thread-4 (]: 30 of 125 START test dbt_utils_expression_is_true_stg__vix_with_versions_close___0  [RUN]
[0m16:19:20.144590 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7, now test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0)
[0m16:19:20.145713 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m16:19:20.155367 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m16:19:20.156805 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd)
[0m16:19:20.157755 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m16:19:20.169121 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m16:19:20.170782 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m16:19:20.179438 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m16:19:20.190375 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m16:19:20.191997 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m16:19:20.199839 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m16:19:20.201061 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m16:19:20.206247 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m16:19:20.207831 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m16:19:20.215302 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m16:19:20.217636 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m16:19:20.219499 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m16:19:20.228025 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m16:19:20.229767 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: BEGIN
[0m16:19:20.231531 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m16:19:20.232559 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:20.233706 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m16:19:20.235283 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: BEGIN
[0m16:19:20.237511 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m16:19:20.239489 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: BEGIN
[0m16:19:20.241578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:20.243612 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m16:19:20.245580 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: BEGIN
[0m16:19:20.247439 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:20.249766 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m16:19:20.251024 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:20.252722 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."stg__stocks"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m16:19:20.253846 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m16:19:20.255816 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m16:19:20.258578 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m16:19:20.260763 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m16:19:20.262487 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m16:19:20.264561 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."stg__stocks"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m16:19:20.266996 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m16:19:20.269355 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select volume
from "finance"."analytics_dev"."stg__stocks"
where volume is null



  
  
      
    ) dbt_internal_test
[0m16:19:20.272389 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(close > 0)


  
  
      
    ) dbt_internal_test
[0m16:19:20.313397 [debug] [Thread-3 (]: SQL status: OK in 0.056 seconds
[0m16:19:20.319410 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: ROLLBACK
[0m16:19:20.321548 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71'
[0m16:19:20.322688 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: Close
[0m16:19:20.326125 [info ] [Thread-3 (]: 27 of 125 PASS not_null_stg__stocks_ticker ..................................... [[32mPASS[0m in 0.19s]
[0m16:19:20.329651 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m16:19:20.331834 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m16:19:20.334166 [info ] [Thread-3 (]: 31 of 125 START test dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max  [RUN]
[0m16:19:20.337765 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929)
[0m16:19:20.339987 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m16:19:20.374033 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m16:19:20.375462 [debug] [Thread-2 (]: SQL status: OK in 0.101 seconds
[0m16:19:20.377218 [debug] [Thread-4 (]: SQL status: OK in 0.102 seconds
[0m16:19:20.378702 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m16:19:20.381433 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m16:19:20.390416 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m16:19:20.394594 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: ROLLBACK
[0m16:19:20.398135 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: ROLLBACK
[0m16:19:20.402893 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: ROLLBACK
[0m16:19:20.405391 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd'
[0m16:19:20.407482 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0'
[0m16:19:20.409127 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182'
[0m16:19:20.410253 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: Close
[0m16:19:20.411597 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: Close
[0m16:19:20.412785 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m16:19:20.413490 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: Close
[0m16:19:20.414469 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: BEGIN
[0m16:19:20.415515 [info ] [Thread-4 (]: 30 of 125 PASS dbt_utils_expression_is_true_stg__vix_with_versions_close___0 ... [[32mPASS[0m in 0.26s]
[0m16:19:20.417223 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:20.416354 [info ] [Thread-2 (]: 29 of 125 PASS not_null_stg__stocks_volume ..................................... [[32mPASS[0m in 0.27s]
[0m16:19:20.419363 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m16:19:20.418177 [info ] [Thread-1 (]: 28 of 125 PASS not_null_stg__stocks_trade_date ................................. [[32mPASS[0m in 0.28s]
[0m16:19:20.420941 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m16:19:20.421759 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m16:19:20.422498 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m16:19:20.423587 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m16:19:20.424366 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m16:19:20.425863 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m16:19:20.425177 [info ] [Thread-4 (]: 32 of 125 START test dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp  [RUN]
[0m16:19:20.426841 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m16:19:20.427801 [info ] [Thread-2 (]: 33 of 125 START test dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date  [RUN]
[0m16:19:20.429149 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(complacent_max < normal_max AND  normal_max < elevated_max)


  
  
      
    ) dbt_internal_test
[0m16:19:20.429992 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17)
[0m16:19:20.431485 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00)
[0m16:19:20.430752 [info ] [Thread-1 (]: 34 of 125 START test dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1  [RUN]
[0m16:19:20.433120 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m16:19:20.433912 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m16:19:20.434776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93)
[0m16:19:20.443010 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m16:19:20.449919 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m16:19:20.450748 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m16:19:20.460779 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m16:19:20.462411 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m16:19:20.467152 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m16:19:20.468462 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m16:19:20.469420 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m16:19:20.473772 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m16:19:20.478751 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m16:19:20.480396 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m16:19:20.482157 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: BEGIN
[0m16:19:20.482953 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:20.485205 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m16:19:20.486590 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m16:19:20.487402 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: BEGIN
[0m16:19:20.488499 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:19:20.489741 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: BEGIN
[0m16:19:20.491100 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:20.491966 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m16:19:20.493035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:20.494549 [debug] [Thread-3 (]: SQL status: OK in 0.062 seconds
[0m16:19:20.496221 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m16:19:20.497914 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:19:20.499442 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:19:20.500789 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m16:19:20.503722 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: ROLLBACK
[0m16:19:20.504922 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m16:19:20.506304 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m16:19:20.507462 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(version_rank >= 1)


  
  
      
    ) dbt_internal_test
[0m16:19:20.509102 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929'
[0m16:19:20.511360 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: Close
[0m16:19:20.513726 [info ] [Thread-3 (]: 31 of 125 PASS dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max  [[32mPASS[0m in 0.18s]
[0m16:19:20.515411 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m16:19:20.516255 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m16:19:20.517232 [info ] [Thread-3 (]: 35 of 125 START test dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id  [RUN]
[0m16:19:20.518443 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e)
[0m16:19:20.519302 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m16:19:20.527756 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m16:19:20.529853 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m16:19:20.535441 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m16:19:20.537186 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m16:19:20.537958 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: BEGIN
[0m16:19:20.538665 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:20.540973 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:19:20.541785 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m16:19:20.542828 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        trade_date, version_id
    from "finance"."analytics_dev"."stg__vix_with_versions"
    group by trade_date, version_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m16:19:20.557785 [debug] [Thread-4 (]: SQL status: OK in 0.059 seconds
[0m16:19:20.562448 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: ROLLBACK
[0m16:19:20.563724 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17'
[0m16:19:20.564448 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: Close
[0m16:19:20.566136 [info ] [Thread-4 (]: 32 of 125 PASS dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp  [[32mPASS[0m in 0.14s]
[0m16:19:20.567627 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m16:19:20.568463 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m16:19:20.569232 [info ] [Thread-4 (]: 36 of 125 START test not_null_stg__vix_with_versions_close ..................... [RUN]
[0m16:19:20.570359 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17, now test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7)
[0m16:19:20.571176 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m16:19:20.580108 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m16:19:20.581928 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m16:19:20.583050 [debug] [Thread-2 (]: SQL status: OK in 0.072 seconds
[0m16:19:20.584673 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m16:19:20.589376 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m16:19:20.595192 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: ROLLBACK
[0m16:19:20.596342 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: ROLLBACK
[0m16:19:20.598669 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00'
[0m16:19:20.601155 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: Close
[0m16:19:20.600158 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93'
[0m16:19:20.603307 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: Close
[0m16:19:20.605450 [info ] [Thread-2 (]: 33 of 125 PASS dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date  [[32mPASS[0m in 0.17s]
[0m16:19:20.608045 [debug] [Thread-3 (]: SQL status: OK in 0.064 seconds
[0m16:19:20.610696 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m16:19:20.612322 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m16:19:20.614218 [info ] [Thread-1 (]: 34 of 125 PASS dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1  [[32mPASS[0m in 0.18s]
[0m16:19:20.616720 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m16:19:20.618837 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: BEGIN
[0m16:19:20.621446 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m16:19:20.629384 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: ROLLBACK
[0m16:19:20.628300 [info ] [Thread-2 (]: 37 of 125 START test not_null_stg__vix_with_versions_complacent_max ............ [RUN]
[0m16:19:20.631228 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:20.632884 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m16:19:20.634567 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00, now test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a)
[0m16:19:20.637343 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e'
[0m16:19:20.640954 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m16:19:20.639632 [info ] [Thread-1 (]: 38 of 125 START test not_null_stg__vix_with_versions_effective_date ............ [RUN]
[0m16:19:20.643558 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: Close
[0m16:19:20.645130 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m16:19:20.656015 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m16:19:20.657113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93, now test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991)
[0m16:19:20.659141 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m16:19:20.661721 [info ] [Thread-3 (]: 35 of 125 PASS dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id  [[32mPASS[0m in 0.14s]
[0m16:19:20.664402 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m16:19:20.666231 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."stg__vix_with_versions"
where close is null



  
  
      
    ) dbt_internal_test
[0m16:19:20.668127 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m16:19:20.676890 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m16:19:20.677976 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m16:19:20.679258 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m16:19:20.687114 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m16:19:20.688322 [info ] [Thread-3 (]: 39 of 125 START test not_null_stg__vix_with_versions_elevated_max .............. [RUN]
[0m16:19:20.689990 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e, now test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6)
[0m16:19:20.691000 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m16:19:20.692096 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m16:19:20.702205 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m16:19:20.708359 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m16:19:20.709491 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m16:19:20.710967 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: BEGIN
[0m16:19:20.711861 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:20.713865 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m16:19:20.714905 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m16:19:20.715998 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: BEGIN
[0m16:19:20.722247 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m16:19:20.723335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:20.724448 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m16:19:20.726281 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m16:19:20.727255 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select complacent_max
from "finance"."analytics_dev"."stg__vix_with_versions"
where complacent_max is null



  
  
      
    ) dbt_internal_test
[0m16:19:20.728826 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:19:20.729874 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m16:19:20.730808 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m16:19:20.731806 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: BEGIN
[0m16:19:20.732960 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
where effective_date is null



  
  
      
    ) dbt_internal_test
[0m16:19:20.734023 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:20.737879 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:19:20.739242 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m16:19:20.740233 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select elevated_max
from "finance"."analytics_dev"."stg__vix_with_versions"
where elevated_max is null



  
  
      
    ) dbt_internal_test
[0m16:19:20.741827 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:19:20.743266 [debug] [Thread-4 (]: SQL status: OK in 0.064 seconds
[0m16:19:20.748877 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: ROLLBACK
[0m16:19:20.752547 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: ROLLBACK
[0m16:19:20.754172 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991'
[0m16:19:20.755431 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: Close
[0m16:19:20.756817 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7'
[0m16:19:20.757917 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: Close
[0m16:19:20.759317 [info ] [Thread-1 (]: 38 of 125 PASS not_null_stg__vix_with_versions_effective_date .................. [[32mPASS[0m in 0.10s]
[0m16:19:20.761334 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m16:19:20.763674 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m16:19:20.762668 [info ] [Thread-4 (]: 36 of 125 PASS not_null_stg__vix_with_versions_close ........................... [[32mPASS[0m in 0.19s]
[0m16:19:20.766578 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m16:19:20.765064 [info ] [Thread-1 (]: 40 of 125 START test not_null_stg__vix_with_versions_loaded_at ................. [RUN]
[0m16:19:20.768333 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m16:19:20.769678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991, now test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c)
[0m16:19:20.771929 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m16:19:20.770922 [info ] [Thread-4 (]: 41 of 125 START test not_null_stg__vix_with_versions_normal_max ................ [RUN]
[0m16:19:20.780916 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m16:19:20.782598 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7, now test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21)
[0m16:19:20.783927 [debug] [Thread-2 (]: SQL status: OK in 0.056 seconds
[0m16:19:20.784908 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m16:19:20.795495 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m16:19:20.800364 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: ROLLBACK
[0m16:19:20.801909 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a'
[0m16:19:20.802804 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: Close
[0m16:19:20.803788 [debug] [Thread-3 (]: SQL status: OK in 0.063 seconds
[0m16:19:20.804963 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m16:19:20.816113 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m16:19:20.817189 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m16:19:20.820683 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: ROLLBACK
[0m16:19:20.807115 [info ] [Thread-2 (]: 37 of 125 PASS not_null_stg__vix_with_versions_complacent_max .................. [[32mPASS[0m in 0.17s]
[0m16:19:20.843673 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m16:19:20.846156 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6'
[0m16:19:20.848462 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m16:19:20.851060 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: Close
[0m16:19:20.853016 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m16:19:20.854849 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m16:19:20.857837 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: BEGIN
[0m16:19:20.862118 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m16:19:20.860440 [info ] [Thread-3 (]: 39 of 125 PASS not_null_stg__vix_with_versions_elevated_max .................... [[32mPASS[0m in 0.17s]
[0m16:19:20.866386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:20.864087 [info ] [Thread-2 (]: 42 of 125 START test not_null_stg__vix_with_versions_trade_date ................ [RUN]
[0m16:19:20.868453 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: BEGIN
[0m16:19:20.870451 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m16:19:20.872470 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a, now test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1)
[0m16:19:20.874043 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:20.875823 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m16:19:20.877594 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m16:19:20.878919 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m16:19:20.882354 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m16:19:20.881181 [info ] [Thread-3 (]: 43 of 125 START test not_null_stg__vix_with_versions_version_id ................ [RUN]
[0m16:19:20.894577 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m16:19:20.895798 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."stg__vix_with_versions"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m16:19:20.897522 [debug] [Thread-4 (]: SQL status: OK in 0.024 seconds
[0m16:19:20.898560 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6, now test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c)
[0m16:19:20.900424 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m16:19:20.901530 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m16:19:20.902596 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select normal_max
from "finance"."analytics_dev"."stg__vix_with_versions"
where normal_max is null



  
  
      
    ) dbt_internal_test
[0m16:19:20.903975 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m16:19:20.916897 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m16:19:20.927504 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m16:19:20.930863 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m16:19:20.931992 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m16:19:20.937471 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m16:19:20.939246 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: BEGIN
[0m16:19:20.941453 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:20.943902 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m16:19:20.945339 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: BEGIN
[0m16:19:20.946904 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:19:20.948363 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:20.950193 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m16:19:20.952289 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."stg__vix_with_versions"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m16:19:20.954866 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m16:19:20.956640 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m16:19:20.958632 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_id
from "finance"."analytics_dev"."stg__vix_with_versions"
where version_id is null



  
  
      
    ) dbt_internal_test
[0m16:19:20.965465 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m16:19:20.971015 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: ROLLBACK
[0m16:19:20.972620 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c'
[0m16:19:20.973608 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: Close
[0m16:19:20.975668 [info ] [Thread-1 (]: 40 of 125 PASS not_null_stg__vix_with_versions_loaded_at ....................... [[32mPASS[0m in 0.21s]
[0m16:19:20.977842 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m16:19:20.979004 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m16:19:20.979671 [info ] [Thread-1 (]: 44 of 125 START test not_null_stg__vix_with_versions_version_name .............. [RUN]
[0m16:19:20.980762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c, now test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb)
[0m16:19:20.981562 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m16:19:20.988509 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m16:19:20.989267 [debug] [Thread-4 (]: SQL status: OK in 0.071 seconds
[0m16:19:20.990749 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m16:19:20.996108 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m16:19:20.998711 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: ROLLBACK
[0m16:19:21.000139 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21'
[0m16:19:21.001024 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: Close
[0m16:19:21.002732 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m16:19:21.003850 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: BEGIN
[0m16:19:21.005804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:21.004914 [info ] [Thread-4 (]: 41 of 125 PASS not_null_stg__vix_with_versions_normal_max ...................... [[32mPASS[0m in 0.22s]
[0m16:19:21.007589 [debug] [Thread-2 (]: SQL status: OK in 0.053 seconds
[0m16:19:21.009587 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m16:19:21.010434 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:19:21.011506 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m16:19:21.012751 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m16:19:21.015390 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: ROLLBACK
[0m16:19:21.017021 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_name
from "finance"."analytics_dev"."stg__vix_with_versions"
where version_name is null



  
  
      
    ) dbt_internal_test
[0m16:19:21.016188 [info ] [Thread-4 (]: 45 of 125 START test not_null_stg__vix_with_versions_version_rank .............. [RUN]
[0m16:19:21.019760 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1'
[0m16:19:21.021008 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21, now test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578)
[0m16:19:21.022361 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: Close
[0m16:19:21.023266 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m16:19:21.030732 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m16:19:21.031759 [info ] [Thread-2 (]: 42 of 125 PASS not_null_stg__vix_with_versions_trade_date ...................... [[32mPASS[0m in 0.16s]
[0m16:19:21.033591 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m16:19:21.034484 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m16:19:21.035524 [info ] [Thread-2 (]: 46 of 125 SKIP relation analytics_dev.int__price_changes ....................... [[33mSKIP[0m]
[0m16:19:21.037005 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m16:19:21.038017 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m16:19:21.038946 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__price_changes' to be skipped because of status 'skipped'. 
[0m16:19:21.046105 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m16:19:21.047032 [debug] [Thread-3 (]: SQL status: OK in 0.087 seconds
[0m16:19:21.048771 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m16:19:21.050264 [info ] [Thread-2 (]: 47 of 125 SKIP test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[33mSKIP[0m]
[0m16:19:21.052044 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m16:19:21.053531 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m16:19:21.057004 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: ROLLBACK
[0m16:19:21.057817 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: BEGIN
[0m16:19:21.058626 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m16:19:21.059310 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7' to be skipped because of status 'skipped'. 
[0m16:19:21.060147 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:21.061116 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c'
[0m16:19:21.061949 [info ] [Thread-2 (]: 48 of 125 SKIP test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[33mSKIP[0m]
[0m16:19:21.063471 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: Close
[0m16:19:21.064329 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m16:19:21.065285 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:19:21.066261 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m16:19:21.068263 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m16:19:21.068905 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e' to be skipped because of status 'skipped'. 
[0m16:19:21.067476 [info ] [Thread-3 (]: 43 of 125 PASS not_null_stg__vix_with_versions_version_id ...................... [[32mPASS[0m in 0.17s]
[0m16:19:21.070877 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_rank
from "finance"."analytics_dev"."stg__vix_with_versions"
where version_rank is null



  
  
      
    ) dbt_internal_test
[0m16:19:21.069989 [info ] [Thread-2 (]: 49 of 125 SKIP test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[33mSKIP[0m]
[0m16:19:21.073136 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m16:19:21.074329 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m16:19:21.075535 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m16:19:21.076528 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m16:19:21.077997 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd' to be skipped because of status 'skipped'. 
[0m16:19:21.077402 [info ] [Thread-3 (]: 50 of 125 SKIP test dbt_utils_expression_is_true_int__price_changes_gain___0 ... [[33mSKIP[0m]
[0m16:19:21.079191 [info ] [Thread-2 (]: 51 of 125 SKIP test dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp  [[33mSKIP[0m]
[0m16:19:21.080510 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m16:19:21.081355 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m16:19:21.082202 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m16:19:21.082850 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724' to be skipped because of status 'skipped'. 
[0m16:19:21.083603 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m16:19:21.085329 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a' to be skipped because of status 'skipped'. 
[0m16:19:21.084488 [info ] [Thread-3 (]: 52 of 125 SKIP test dbt_utils_expression_is_true_int__price_changes_loss___0 ... [[33mSKIP[0m]
[0m16:19:21.086504 [info ] [Thread-2 (]: 53 of 125 SKIP test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[33mSKIP[0m]
[0m16:19:21.088031 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m16:19:21.088984 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m16:19:21.089922 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m16:19:21.090679 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5' to be skipped because of status 'skipped'. 
[0m16:19:21.091823 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m16:19:21.093876 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96' to be skipped because of status 'skipped'. 
[0m16:19:21.092972 [info ] [Thread-3 (]: 54 of 125 SKIP test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[33mSKIP[0m]
[0m16:19:21.095084 [info ] [Thread-2 (]: 55 of 125 SKIP test not_null_int__price_changes_close .......................... [[33mSKIP[0m]
[0m16:19:21.096527 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m16:19:21.097513 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m16:19:21.098481 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m16:19:21.099373 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97' to be skipped because of status 'skipped'. 
[0m16:19:21.100508 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m16:19:21.102451 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5' to be skipped because of status 'skipped'. 
[0m16:19:21.101520 [info ] [Thread-3 (]: 56 of 125 SKIP test not_null_int__price_changes_gain ........................... [[33mSKIP[0m]
[0m16:19:21.105195 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m16:19:21.103945 [info ] [Thread-2 (]: 57 of 125 SKIP test not_null_int__price_changes_loaded_at ...................... [[33mSKIP[0m]
[0m16:19:21.106417 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m16:19:21.107652 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m16:19:21.108733 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m16:19:21.109517 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13' to be skipped because of status 'skipped'. 
[0m16:19:21.110383 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m16:19:21.113036 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: ROLLBACK
[0m16:19:21.114809 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f' to be skipped because of status 'skipped'. 
[0m16:19:21.113971 [info ] [Thread-3 (]: 58 of 125 SKIP test not_null_int__price_changes_loss ........................... [[33mSKIP[0m]
[0m16:19:21.116264 [info ] [Thread-2 (]: 59 of 125 SKIP test not_null_int__price_changes_rn ............................. [[33mSKIP[0m]
[0m16:19:21.118296 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb'
[0m16:19:21.119746 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m16:19:21.121240 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m16:19:21.122952 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: Close
[0m16:19:21.125532 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m16:19:21.126708 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa' to be skipped because of status 'skipped'. 
[0m16:19:21.127901 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m16:19:21.129618 [debug] [Thread-4 (]: SQL status: OK in 0.056 seconds
[0m16:19:21.130578 [info ] [Thread-3 (]: 60 of 125 SKIP test not_null_int__price_changes_ticker ......................... [[33mSKIP[0m]
[0m16:19:21.133112 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638' to be skipped because of status 'skipped'. 
[0m16:19:21.131710 [info ] [Thread-1 (]: 44 of 125 PASS not_null_stg__vix_with_versions_version_name .................... [[32mPASS[0m in 0.15s]
[0m16:19:21.134436 [info ] [Thread-2 (]: 61 of 125 SKIP test not_null_int__price_changes_trade_date ..................... [[33mSKIP[0m]
[0m16:19:21.136091 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m16:19:21.139401 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: ROLLBACK
[0m16:19:21.141104 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m16:19:21.142179 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m16:19:21.143432 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a' to be skipped because of status 'skipped'. 
[0m16:19:21.145114 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578'
[0m16:19:21.146152 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5' to be skipped because of status 'skipped'. 
[0m16:19:21.147067 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: Close
[0m16:19:21.148404 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m16:19:21.149972 [info ] [Thread-3 (]: 62 of 125 SKIP relation analytics_dev.int__rsi_sma ............................. [[33mSKIP[0m]
[0m16:19:21.152618 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m16:19:21.151169 [info ] [Thread-4 (]: 45 of 125 PASS not_null_stg__vix_with_versions_version_rank .................... [[32mPASS[0m in 0.13s]
[0m16:19:21.153994 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_sma' to be skipped because of status 'skipped'. 
[0m16:19:21.155289 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m16:19:21.157564 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m16:19:21.159181 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m16:19:21.160115 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m16:19:21.158475 [info ] [Thread-1 (]: 63 of 125 SKIP test dbt_utils_expression_is_true_int__rsi_sma_gain___0 ......... [[33mSKIP[0m]
[0m16:19:21.162138 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m16:19:21.161420 [info ] [Thread-4 (]: 66 of 125 SKIP test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[33mSKIP[0m]
[0m16:19:21.164199 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m16:19:21.163310 [info ] [Thread-3 (]: 65 of 125 SKIP test dbt_utils_expression_is_true_int__rsi_sma_loss___0 ......... [[33mSKIP[0m]
[0m16:19:21.166761 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m16:19:21.165625 [info ] [Thread-2 (]: 64 of 125 SKIP test dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp  [[33mSKIP[0m]
[0m16:19:21.168298 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m16:19:21.169112 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6' to be skipped because of status 'skipped'. 
[0m16:19:21.170117 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m16:19:21.171444 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m16:19:21.172423 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m16:19:21.174234 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704' to be skipped because of status 'skipped'. 
[0m16:19:21.173392 [info ] [Thread-1 (]: 67 of 125 SKIP test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ..... [[33mSKIP[0m]
[0m16:19:21.175459 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m16:19:21.177259 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m16:19:21.176406 [info ] [Thread-4 (]: 68 of 125 SKIP test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ..... [[33mSKIP[0m]
[0m16:19:21.178489 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62' to be skipped because of status 'skipped'. 
[0m16:19:21.179463 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m16:19:21.182505 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m16:19:21.180403 [info ] [Thread-3 (]: 69 of 125 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [[33mSKIP[0m]
[0m16:19:21.183614 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772' to be skipped because of status 'skipped'. 
[0m16:19:21.181248 [info ] [Thread-2 (]: 70 of 125 SKIP test not_null_int__rsi_sma_close ................................ [[33mSKIP[0m]
[0m16:19:21.185072 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m16:19:21.186162 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m16:19:21.187374 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m16:19:21.188555 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9' to be skipped because of status 'skipped'. 
[0m16:19:21.189796 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m16:19:21.191573 [info ] [Thread-1 (]: 71 of 125 SKIP test not_null_int__rsi_sma_gain ................................. [[33mSKIP[0m]
[0m16:19:21.195067 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m16:19:21.196888 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21' to be skipped because of status 'skipped'. 
[0m16:19:21.193357 [info ] [Thread-4 (]: 72 of 125 SKIP test not_null_int__rsi_sma_loaded_at ............................ [[33mSKIP[0m]
[0m16:19:21.198973 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m16:19:21.201077 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m16:19:21.209835 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08' to be skipped because of status 'skipped'. 
[0m16:19:21.213515 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m16:19:21.221449 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m16:19:21.226510 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b' to be skipped because of status 'skipped'. 
[0m16:19:21.205373 [info ] [Thread-3 (]: 73 of 125 SKIP test not_null_int__rsi_sma_loss ................................. [[33mSKIP[0m]
[0m16:19:21.233859 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m16:19:21.218483 [info ] [Thread-2 (]: 74 of 125 SKIP test not_null_int__rsi_sma_rn ................................... [[33mSKIP[0m]
[0m16:19:21.244902 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953' to be skipped because of status 'skipped'. 
[0m16:19:21.239786 [info ] [Thread-1 (]: 75 of 125 SKIP test not_null_int__rsi_sma_sma_gain ............................. [[33mSKIP[0m]
[0m16:19:21.250255 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m16:19:21.257221 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m16:19:21.253651 [info ] [Thread-4 (]: 76 of 125 SKIP test not_null_int__rsi_sma_sma_loss ............................. [[33mSKIP[0m]
[0m16:19:21.261377 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0' to be skipped because of status 'skipped'. 
[0m16:19:21.264670 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m16:19:21.268186 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m16:19:21.272337 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m16:19:21.276085 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m16:19:21.279547 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065' to be skipped because of status 'skipped'. 
[0m16:19:21.282876 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m16:19:21.288728 [info ] [Thread-3 (]: 77 of 125 SKIP test not_null_int__rsi_sma_ticker ............................... [[33mSKIP[0m]
[0m16:19:21.297896 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139' to be skipped because of status 'skipped'. 
[0m16:19:21.291584 [info ] [Thread-2 (]: 78 of 125 SKIP test not_null_int__rsi_sma_trade_date ........................... [[33mSKIP[0m]
[0m16:19:21.310695 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m16:19:21.316017 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416' to be skipped because of status 'skipped'. 
[0m16:19:21.302484 [info ] [Thread-1 (]: 79 of 125 START sql view model analytics_dev.int__regime_classification ........ [RUN]
[0m16:19:21.320392 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m16:19:21.326549 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6' to be skipped because of status 'skipped'. 
[0m16:19:21.329352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb, now model.portfolio_project_2.int__regime_classification)
[0m16:19:21.332306 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d' to be skipped because of status 'skipped'. 
[0m16:19:21.334878 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m16:19:21.337116 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0' to be skipped because of status 'skipped'. 
[0m16:19:21.350761 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m16:19:21.353035 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m16:19:21.357233 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m16:19:21.355353 [info ] [Thread-4 (]: 80 of 125 SKIP relation analytics_dev.int__rsi_wilder .......................... [[33mSKIP[0m]
[0m16:19:21.371387 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m16:19:21.372241 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m16:19:21.373421 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_wilder' to be skipped because of status 'skipped'. 
[0m16:19:21.375240 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m16:19:21.376416 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m16:19:21.378049 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m16:19:21.379082 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:19:21.377398 [info ] [Thread-4 (]: 83 of 125 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [[33mSKIP[0m]
[0m16:19:21.380594 [info ] [Thread-2 (]: 82 of 125 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ...... [[33mSKIP[0m]
[0m16:19:21.382520 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m16:19:21.383672 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m16:19:21.381436 [info ] [Thread-3 (]: 81 of 125 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ...... [[33mSKIP[0m]
[0m16:19:21.384868 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m16:19:21.385712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:21.386527 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m16:19:21.387804 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m16:19:21.388721 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7' to be skipped because of status 'skipped'. 
[0m16:19:21.390585 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m16:19:21.394129 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m16:19:21.395988 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m16:19:21.392725 [info ] [Thread-4 (]: 84 of 125 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [[33mSKIP[0m]
[0m16:19:21.398093 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703' to be skipped because of status 'skipped'. 
[0m16:19:21.399804 [info ] [Thread-2 (]: 85 of 125 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[33mSKIP[0m]
[0m16:19:21.402705 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:19:21.401131 [info ] [Thread-3 (]: 86 of 125 SKIP test not_null_int__rsi_wilder_gain .............................. [[33mSKIP[0m]
[0m16:19:21.404467 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m16:19:21.405696 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90' to be skipped because of status 'skipped'. 
[0m16:19:21.406953 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m16:19:21.407847 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:19:21.408786 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m16:19:21.409580 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m16:19:21.410293 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d' to be skipped because of status 'skipped'. 
[0m16:19:21.411493 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m16:19:21.413295 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m16:19:21.414904 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95' to be skipped because of status 'skipped'. 
[0m16:19:21.414136 [info ] [Thread-4 (]: 87 of 125 SKIP test not_null_int__rsi_wilder_loss .............................. [[33mSKIP[0m]
[0m16:19:21.415961 [info ] [Thread-2 (]: 88 of 125 SKIP test not_null_int__rsi_wilder_rn ................................ [[33mSKIP[0m]
[0m16:19:21.418298 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda' to be skipped because of status 'skipped'. 
[0m16:19:21.416997 [info ] [Thread-3 (]: 89 of 125 SKIP test not_null_int__rsi_wilder_ticker ............................ [[33mSKIP[0m]
[0m16:19:21.419553 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m16:19:21.420379 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m16:19:21.421472 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m16:19:21.422316 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m16:19:21.422977 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56' to be skipped because of status 'skipped'. 
[0m16:19:21.423711 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m16:19:21.424634 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m16:19:21.426418 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d' to be skipped because of status 'skipped'. 
[0m16:19:21.425607 [info ] [Thread-4 (]: 90 of 125 SKIP test not_null_int__rsi_wilder_trade_date ........................ [[33mSKIP[0m]
[0m16:19:21.428032 [info ] [Thread-2 (]: 91 of 125 SKIP test not_null_int__rsi_wilder_wilder_gain ....................... [[33mSKIP[0m]
[0m16:19:21.429858 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd' to be skipped because of status 'skipped'. 
[0m16:19:21.428859 [info ] [Thread-3 (]: 92 of 125 SKIP test not_null_int__rsi_wilder_wilder_loss ....................... [[33mSKIP[0m]
[0m16:19:21.430806 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m16:19:21.431605 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m16:19:21.432566 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m16:19:21.433359 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m16:19:21.434125 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c' to be skipped because of status 'skipped'. 
[0m16:19:21.436288 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9' to be skipped because of status 'skipped'. 
[0m16:19:21.435080 [info ] [Thread-4 (]: 93 of 125 SKIP test wilder_seed_equals_sma ..................................... [[33mSKIP[0m]
[0m16:19:21.437715 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb' to be skipped because of status 'skipped'. 
[0m16:19:21.438676 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m16:19:21.439751 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.wilder_seed_equals_sma' to be skipped because of status 'skipped'. 
[0m16:19:21.440871 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.fct__rsi
[0m16:19:21.441675 [info ] [Thread-2 (]: 94 of 125 SKIP relation analytics_dev.fct__rsi ................................. [[33mSKIP[0m]
[0m16:19:21.442791 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m16:19:21.443817 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'skipped'. 
[0m16:19:21.445097 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m16:19:21.445847 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m16:19:21.446568 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m16:19:21.447398 [info ] [Thread-4 (]: 96 of 125 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[33mSKIP[0m]
[0m16:19:21.449855 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m16:19:21.448174 [info ] [Thread-2 (]: 97 of 125 SKIP test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ........... [[33mSKIP[0m]
[0m16:19:21.451009 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m16:19:21.451766 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2' to be skipped because of status 'skipped'. 
[0m16:19:21.452528 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m16:19:21.449099 [info ] [Thread-3 (]: 95 of 125 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[33mSKIP[0m]
[0m16:19:21.453512 [info ] [Thread-4 (]: 98 of 125 SKIP test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ........ [[33mSKIP[0m]
[0m16:19:21.454803 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a' to be skipped because of status 'skipped'. 
[0m16:19:21.456076 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m16:19:21.457580 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m16:19:21.459154 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a' to be skipped because of status 'skipped'. 
[0m16:19:21.460097 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0' to be skipped because of status 'skipped'. 
[0m16:19:21.686221 [debug] [Thread-1 (]: SQL status: OK in 0.274 seconds
[0m16:19:21.695351 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:19:21.696846 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m16:19:21.839300 [debug] [Thread-1 (]: SQL status: OK in 0.141 seconds
[0m16:19:21.853224 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:19:21.855800 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m16:19:21.946062 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m16:19:21.951418 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m16:19:21.953073 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:19:21.954615 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m16:19:22.081763 [debug] [Thread-1 (]: SQL status: OK in 0.126 seconds
[0m16:19:22.085856 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:19:22.087020 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m16:19:22.233222 [debug] [Thread-1 (]: SQL status: OK in 0.145 seconds
[0m16:19:22.237435 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m16:19:22.238925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216433D3770>]}
[0m16:19:22.240562 [info ] [Thread-1 (]: 79 of 125 OK created sql view model analytics_dev.int__regime_classification ... [[32mOK[0m in 0.91s]
[0m16:19:22.242591 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m16:19:22.244815 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m16:19:22.246076 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m16:19:22.247187 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m16:19:22.248260 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m16:19:22.249467 [info ] [Thread-2 (]: 99 of 125 START test accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis  [RUN]
[0m16:19:22.251690 [info ] [Thread-3 (]: 100 of 125 START test dbt_utils_expression_is_true_int__regime_classification_close___0  [RUN]
[0m16:19:22.253509 [info ] [Thread-1 (]: 102 of 125 START test dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date  [RUN]
[0m16:19:22.256573 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1, now test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b)
[0m16:19:22.257839 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6)
[0m16:19:22.259054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_classification, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f)
[0m16:19:22.255093 [info ] [Thread-4 (]: 101 of 125 START test dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp  [RUN]
[0m16:19:22.260803 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m16:19:22.262507 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m16:19:22.263890 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m16:19:22.265156 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed)
[0m16:19:22.279069 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m16:19:22.292751 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m16:19:22.303234 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m16:19:22.304540 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m16:19:22.320863 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m16:19:22.322395 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m16:19:22.329244 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m16:19:22.331459 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m16:19:22.337300 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m16:19:22.338599 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m16:19:22.340265 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m16:19:22.355785 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m16:19:22.361982 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m16:19:22.363515 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m16:19:22.364748 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m16:19:22.366185 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: BEGIN
[0m16:19:22.367340 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: BEGIN
[0m16:19:22.368660 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:22.369924 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:22.371147 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m16:19:22.372427 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m16:19:22.374484 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: BEGIN
[0m16:19:22.375607 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: BEGIN
[0m16:19:22.377435 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:22.378734 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m16:19:22.379801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:22.380858 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m16:19:22.382482 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m16:19:22.384246 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m16:19:22.386460 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m16:19:22.387677 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_classification"

where not(close > 0)


  
  
      
    ) dbt_internal_test
[0m16:19:22.389108 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regime as value_field,
        count(*) as n_records

    from "finance"."analytics_dev"."int__regime_classification"
    group by regime

)

select *
from all_values
where value_field not in (
    'complacent','normal','elevated','crisis'
)



  
  
      
    ) dbt_internal_test
[0m16:19:22.390316 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m16:19:22.391360 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m16:19:22.393529 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m16:19:22.394799 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_classification"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m16:19:22.396109 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_classification"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m16:19:22.533752 [debug] [Thread-4 (]: SQL status: OK in 0.136 seconds
[0m16:19:22.534622 [debug] [Thread-3 (]: SQL status: OK in 0.142 seconds
[0m16:19:22.536863 [debug] [Thread-1 (]: SQL status: OK in 0.139 seconds
[0m16:19:22.539565 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: ROLLBACK
[0m16:19:22.542074 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: ROLLBACK
[0m16:19:22.544477 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: ROLLBACK
[0m16:19:22.545603 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6'
[0m16:19:22.546866 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed'
[0m16:19:22.547907 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f'
[0m16:19:22.548623 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: Close
[0m16:19:22.549406 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: Close
[0m16:19:22.550188 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: Close
[0m16:19:22.551676 [debug] [Thread-2 (]: SQL status: OK in 0.159 seconds
[0m16:19:22.552710 [info ] [Thread-4 (]: 101 of 125 PASS dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp  [[32mPASS[0m in 0.29s]
[0m16:19:22.556433 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m16:19:22.553675 [info ] [Thread-1 (]: 102 of 125 PASS dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date  [[32mPASS[0m in 0.29s]
[0m16:19:22.557492 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m16:19:22.560201 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: ROLLBACK
[0m16:19:22.554747 [info ] [Thread-3 (]: 100 of 125 PASS dbt_utils_expression_is_true_int__regime_classification_close___0  [[32mPASS[0m in 0.30s]
[0m16:19:22.561549 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m16:19:22.562368 [info ] [Thread-4 (]: 103 of 125 START test not_null_int__regime_classification_loaded_at ............ [RUN]
[0m16:19:22.563721 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b'
[0m16:19:22.564856 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m16:19:22.565694 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m16:19:22.566640 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed, now test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b)
[0m16:19:22.567499 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: Close
[0m16:19:22.568405 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m16:19:22.570186 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m16:19:22.569374 [info ] [Thread-1 (]: 104 of 125 START test not_null_int__regime_classification_regime ............... [RUN]
[0m16:19:22.580304 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m16:19:22.571832 [info ] [Thread-3 (]: 105 of 125 START test not_null_int__regime_classification_trade_date ........... [RUN]
[0m16:19:22.581532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f, now test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6)
[0m16:19:22.572924 [info ] [Thread-2 (]: 99 of 125 PASS accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis  [[32mPASS[0m in 0.32s]
[0m16:19:22.582978 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6, now test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade)
[0m16:19:22.583826 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m16:19:22.585258 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m16:19:22.586168 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m16:19:22.586869 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m16:19:22.594987 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m16:19:22.596077 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m16:19:22.604079 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m16:19:22.611690 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m16:19:22.613437 [info ] [Thread-2 (]: 106 of 125 START test relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_  [RUN]
[0m16:19:22.615321 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b, now test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5)
[0m16:19:22.616175 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m16:19:22.617047 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m16:19:22.622871 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m16:19:22.623764 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m16:19:22.624383 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m16:19:22.634439 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m16:19:22.639086 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m16:19:22.639934 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: BEGIN
[0m16:19:22.641741 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:22.643699 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m16:19:22.644707 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m16:19:22.649402 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m16:19:22.650400 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m16:19:22.651142 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: BEGIN
[0m16:19:22.652140 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m16:19:22.653660 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m16:19:22.654644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:22.655602 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: BEGIN
[0m16:19:22.657721 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__regime_classification"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m16:19:22.659370 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m16:19:22.660265 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:22.661462 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:19:22.662237 [debug] [Thread-2 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: BEGIN
[0m16:19:22.663364 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m16:19:22.664217 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:22.665195 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select regime
from "finance"."analytics_dev"."int__regime_classification"
where regime is null



  
  
      
    ) dbt_internal_test
[0m16:19:22.666161 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m16:19:22.667808 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m16:19:22.668580 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__regime_classification"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m16:19:22.669337 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:19:22.670957 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m16:19:22.672647 [debug] [Thread-2 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select trade_date as from_field
    from "finance"."analytics_dev"."int__regime_classification"
    where trade_date is not null
),

parent as (
    select trade_date as to_field
    from "finance"."analytics_dev"."stg__vix_with_versions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:19:22.754003 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m16:19:22.755812 [debug] [Thread-3 (]: SQL status: OK in 0.085 seconds
[0m16:19:22.757970 [debug] [Thread-2 (]: SQL status: OK in 0.084 seconds
[0m16:19:22.760303 [debug] [Thread-4 (]: SQL status: OK in 0.099 seconds
[0m16:19:22.766140 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: ROLLBACK
[0m16:19:22.770228 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6'
[0m16:19:22.784457 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: ROLLBACK
[0m16:19:22.785930 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: ROLLBACK
[0m16:19:22.791862 [debug] [Thread-2 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: ROLLBACK
[0m16:19:22.793536 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: Close
[0m16:19:22.796764 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b'
[0m16:19:22.799514 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade'
[0m16:19:22.802248 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5'
[0m16:19:22.804214 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: Close
[0m16:19:22.808794 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: Close
[0m16:19:22.807205 [info ] [Thread-1 (]: 104 of 125 PASS not_null_int__regime_classification_regime ..................... [[32mPASS[0m in 0.23s]
[0m16:19:22.811084 [debug] [Thread-2 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: Close
[0m16:19:22.814484 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m16:19:22.816964 [info ] [Thread-4 (]: 103 of 125 PASS not_null_int__regime_classification_loaded_at .................. [[32mPASS[0m in 0.25s]
[0m16:19:22.821945 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m16:19:22.819068 [info ] [Thread-3 (]: 105 of 125 PASS not_null_int__regime_classification_trade_date ................. [[32mPASS[0m in 0.24s]
[0m16:19:22.829594 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m16:19:22.825880 [info ] [Thread-2 (]: 106 of 125 PASS relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_  [[32mPASS[0m in 0.21s]
[0m16:19:22.837041 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m16:19:22.833307 [info ] [Thread-1 (]: 107 of 125 START test unique_int__regime_classification_trade_date ............. [RUN]
[0m16:19:22.842224 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m16:19:22.845401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6, now test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4)
[0m16:19:22.849122 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m16:19:22.868525 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m16:19:22.873426 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m16:19:22.886034 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m16:19:22.890187 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m16:19:22.891957 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: BEGIN
[0m16:19:22.893512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:22.898085 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:19:22.899718 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m16:19:22.901311 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."int__regime_classification"
where trade_date is not null
group by trade_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:19:22.978661 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m16:19:22.982816 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: ROLLBACK
[0m16:19:22.983993 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4'
[0m16:19:22.984674 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: Close
[0m16:19:22.986448 [info ] [Thread-1 (]: 107 of 125 PASS unique_int__regime_classification_trade_date ................... [[32mPASS[0m in 0.14s]
[0m16:19:22.988195 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m16:19:22.989807 [debug] [Thread-3 (]: Began running node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:19:22.990577 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m16:19:22.991510 [info ] [Thread-3 (]: 109 of 125 START snapshot analytics_dev_snapshots.regime_classification_snapshot  [RUN]
[0m16:19:22.993915 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade, now snapshot.portfolio_project_2.regime_classification_snapshot)
[0m16:19:22.995229 [debug] [Thread-3 (]: Began compiling node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:19:22.992774 [info ] [Thread-4 (]: 108 of 125 START sql view model analytics_dev.int__regime_changes .............. [RUN]
[0m16:19:23.001095 [debug] [Thread-3 (]: Began executing node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:19:23.001988 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b, now model.portfolio_project_2.int__regime_changes)
[0m16:19:23.013656 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:19:23.014571 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m16:19:23.015437 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: BEGIN
[0m16:19:23.020616 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m16:19:23.021500 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:23.023149 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m16:19:23.028048 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m16:19:23.030684 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m16:19:23.031913 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:19:23.033108 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:19:23.034630 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:19:23.035309 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m16:19:23.036010 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:23.038615 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:19:23.039363 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:19:23.040098 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m16:19:23.043616 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m16:19:23.049400 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:19:23.050431 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

        
  
    
    

    create  table
      "regime_classification_snapshot__dbt_tmp20251113161923047778"
  
    as (
      
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."int__regime_classification"

    ),

    snapshotted_data as (

        select *, 
    
        trade_date as dbt_unique_key
    

        from "finance"."analytics_dev_snapshots"."regime_classification_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
  
    
[0m16:19:23.168807 [debug] [Thread-4 (]: SQL status: OK in 0.128 seconds
[0m16:19:23.182750 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:19:23.184893 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m16:19:23.225860 [debug] [Thread-3 (]: SQL status: OK in 0.174 seconds
[0m16:19:23.237052 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:19:23.239749 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251113161923047778'
      
      
      order by ordinal_position

  
[0m16:19:23.265051 [debug] [Thread-3 (]: SQL status: OK in 0.023 seconds
[0m16:19:23.295730 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:19:23.298595 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:19:23.303386 [debug] [Thread-4 (]: SQL status: OK in 0.115 seconds
[0m16:19:23.339095 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:19:23.342830 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m16:19:23.345905 [debug] [Thread-3 (]: SQL status: OK in 0.044 seconds
[0m16:19:23.378913 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:19:23.381000 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251113161923047778'
      
      
      order by ordinal_position

  
[0m16:19:23.401272 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m16:19:23.411511 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:19:23.412507 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m16:19:23.429871 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m16:19:23.441174 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:19:23.442004 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251113161923047778'
      
      
      order by ordinal_position

  
[0m16:19:23.451786 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m16:19:23.458414 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:19:23.459579 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */
DESCRIBE (select * from (
        
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."int__regime_classification"

    ),

    snapshotted_data as (

        select *, 
    
        trade_date as dbt_unique_key
    

        from "finance"."analytics_dev_snapshots"."regime_classification_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:19:23.467587 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m16:19:23.478149 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:19:23.479221 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:19:23.481592 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:19:23.483029 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:19:23.485122 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:19:23.486561 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      update "finance"."analytics_dev_snapshots"."regime_classification_snapshot" as DBT_INTERNAL_TARGET
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "regime_classification_snapshot__dbt_tmp20251113161923047778" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = DBT_INTERNAL_TARGET.dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and DBT_INTERNAL_TARGET.dbt_valid_to is null;
      

    insert into "finance"."analytics_dev_snapshots"."regime_classification_snapshot" ("trade_date", "close", "regime", "loaded_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."trade_date",DBT_INTERNAL_SOURCE."close",DBT_INTERNAL_SOURCE."regime",DBT_INTERNAL_SOURCE."loaded_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "regime_classification_snapshot__dbt_tmp20251113161923047778" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;


  
[0m16:19:23.498109 [debug] [Thread-4 (]: SQL status: OK in 0.153 seconds
[0m16:19:23.501108 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m16:19:23.502019 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:19:23.502849 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m16:19:23.667657 [debug] [Thread-3 (]: SQL status: OK in 0.179 seconds
[0m16:19:23.676965 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: COMMIT
[0m16:19:23.680631 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:19:23.682600 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: COMMIT
[0m16:19:23.684731 [debug] [Thread-4 (]: SQL status: OK in 0.181 seconds
[0m16:19:23.698195 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:19:23.700220 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m16:19:23.820046 [debug] [Thread-3 (]: SQL status: OK in 0.136 seconds
[0m16:19:23.822259 [debug] [Thread-3 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m16:19:23.823433 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      drop table if exists "regime_classification_snapshot__dbt_tmp20251113161923047778" cascade
    
[0m16:19:23.942205 [debug] [Thread-4 (]: SQL status: OK in 0.240 seconds
[0m16:19:23.946129 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m16:19:23.947733 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021644B0D430>]}
[0m16:19:23.949483 [info ] [Thread-4 (]: 108 of 125 OK created sql view model analytics_dev.int__regime_changes ......... [[32mOK[0m in 0.95s]
[0m16:19:23.951852 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m16:19:23.954050 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m16:19:23.955307 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m16:19:23.956935 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m16:19:23.958308 [info ] [Thread-2 (]: 110 of 125 START test accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis  [RUN]
[0m16:19:23.962939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5, now test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47)
[0m16:19:23.959649 [info ] [Thread-4 (]: 112 of 125 START test dbt_utils_expression_is_true_int__regime_changes_start_date___end_date  [RUN]
[0m16:19:23.965626 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m16:19:23.968111 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974)
[0m16:19:23.961350 [info ] [Thread-1 (]: 111 of 125 START test dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0  [RUN]
[0m16:19:23.983069 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m16:19:23.984812 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m16:19:23.986364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4)
[0m16:19:24.000296 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m16:19:24.001604 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m16:19:24.007907 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m16:19:24.022055 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m16:19:24.028061 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m16:19:24.031341 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m16:19:24.042240 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m16:19:24.043918 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m16:19:24.045932 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m16:19:24.047914 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: BEGIN
[0m16:19:24.056347 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m16:19:24.057785 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:24.060174 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m16:19:24.062170 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: BEGIN
[0m16:19:24.063410 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:24.065142 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m16:19:24.066549 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: BEGIN
[0m16:19:24.067939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:24.069117 [debug] [Thread-3 (]: SQL status: OK in 0.244 seconds
[0m16:19:24.070348 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m16:19:24.074874 [debug] [Thread-3 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: Close
[0m16:19:24.076135 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m16:19:24.077377 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m16:19:24.079775 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m16:19:24.081716 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m16:19:24.083601 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6cc1dcb-da39-41ed-bb0b-d383383680ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216447AE870>]}
[0m16:19:24.085417 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_changes"

where not(start_date <= end_date)


  
  
      
    ) dbt_internal_test
[0m16:19:24.087590 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m16:19:24.089426 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regime as value_field,
        count(*) as n_records

    from "finance"."analytics_dev"."int__regime_changes"
    group by regime

)

select *
from all_values
where value_field not in (
    'complacent','normal','elevated','crisis'
)



  
  
      
    ) dbt_internal_test
[0m16:19:24.092844 [info ] [Thread-3 (]: 109 of 125 OK snapshotted analytics_dev_snapshots.regime_classification_snapshot  [[32mOK[0m in 1.09s]
[0m16:19:24.095916 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_changes"

where not(days_in_regime >= 0)


  
  
      
    ) dbt_internal_test
[0m16:19:24.099543 [debug] [Thread-3 (]: Finished running node snapshot.portfolio_project_2.regime_classification_snapshot
[0m16:19:24.102155 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m16:19:24.105096 [info ] [Thread-3 (]: 113 of 125 START test not_null_int__regime_changes_days_in_regime .............. [RUN]
[0m16:19:24.107699 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.portfolio_project_2.regime_classification_snapshot, now test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0)
[0m16:19:24.109655 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m16:19:24.128165 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m16:19:24.133178 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m16:19:24.145177 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m16:19:24.148864 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m16:19:24.150920 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: BEGIN
[0m16:19:24.152582 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:24.157342 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m16:19:24.159064 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m16:19:24.160697 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select days_in_regime
from "finance"."analytics_dev"."int__regime_changes"
where days_in_regime is null



  
  
      
    ) dbt_internal_test
[0m16:19:24.216853 [debug] [Thread-4 (]: SQL status: OK in 0.122 seconds
[0m16:19:24.218863 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m16:19:24.220800 [debug] [Thread-2 (]: SQL status: OK in 0.123 seconds
[0m16:19:24.227109 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: ROLLBACK
[0m16:19:24.232711 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: ROLLBACK
[0m16:19:24.236485 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974'
[0m16:19:24.239551 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4'
[0m16:19:24.241329 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: Close
[0m16:19:24.247044 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: ROLLBACK
[0m16:19:24.248888 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: Close
[0m16:19:24.252299 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47'
[0m16:19:24.258535 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: Close
[0m16:19:24.254777 [info ] [Thread-4 (]: 112 of 125 PASS dbt_utils_expression_is_true_int__regime_changes_start_date___end_date  [[32mPASS[0m in 0.29s]
[0m16:19:24.257002 [info ] [Thread-1 (]: 111 of 125 PASS dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0  [[32mPASS[0m in 0.27s]
[0m16:19:24.261943 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m16:19:24.268223 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m16:19:24.264776 [info ] [Thread-2 (]: 110 of 125 PASS accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis  [[32mPASS[0m in 0.30s]
[0m16:19:24.271328 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m16:19:24.273853 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m16:19:24.276917 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m16:19:24.278853 [info ] [Thread-4 (]: 114 of 125 START test not_null_int__regime_changes_end_date .................... [RUN]
[0m16:19:24.283420 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m16:19:24.281062 [info ] [Thread-1 (]: 115 of 125 START test not_null_int__regime_changes_regime ...................... [RUN]
[0m16:19:24.287189 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974, now test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755)
[0m16:19:24.293007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4, now test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006)
[0m16:19:24.290418 [info ] [Thread-2 (]: 116 of 125 START test not_null_int__regime_changes_regime_period_id ............ [RUN]
[0m16:19:24.295942 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m16:19:24.297812 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m16:19:24.300225 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47, now test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257)
[0m16:19:24.318567 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m16:19:24.338131 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m16:19:24.339925 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m16:19:24.357437 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m16:19:24.360701 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m16:19:24.372291 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m16:19:24.375473 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m16:19:24.387663 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m16:19:24.389467 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m16:19:24.391345 [debug] [Thread-3 (]: SQL status: OK in 0.229 seconds
[0m16:19:24.395720 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m16:19:24.404243 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m16:19:24.407370 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: BEGIN
[0m16:19:24.410421 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m16:19:24.416609 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: ROLLBACK
[0m16:19:24.418534 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:24.420837 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: BEGIN
[0m16:19:24.423847 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0'
[0m16:19:24.426624 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m16:19:24.429090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:24.431382 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: Close
[0m16:19:24.433260 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m16:19:24.435002 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: BEGIN
[0m16:19:24.438072 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m16:19:24.440310 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:24.444496 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m16:19:24.442696 [info ] [Thread-3 (]: 113 of 125 PASS not_null_int__regime_changes_days_in_regime .................... [[32mPASS[0m in 0.33s]
[0m16:19:24.447242 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select end_date
from "finance"."analytics_dev"."int__regime_changes"
where end_date is null



  
  
      
    ) dbt_internal_test
[0m16:19:24.449972 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m16:19:24.452925 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m16:19:24.455112 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m16:19:24.456923 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select regime
from "finance"."analytics_dev"."int__regime_changes"
where regime is null



  
  
      
    ) dbt_internal_test
[0m16:19:24.459530 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m16:19:24.462284 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m16:19:24.466821 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select regime_period_id
from "finance"."analytics_dev"."int__regime_changes"
where regime_period_id is null



  
  
      
    ) dbt_internal_test
[0m16:19:24.464972 [info ] [Thread-3 (]: 117 of 125 START test not_null_int__regime_changes_start_date .................. [RUN]
[0m16:19:24.470937 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0, now test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7)
[0m16:19:24.473777 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m16:19:24.495342 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m16:19:24.499050 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m16:19:24.509278 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m16:19:24.513330 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m16:19:24.515209 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: BEGIN
[0m16:19:24.516915 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:24.521876 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m16:19:24.523609 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m16:19:24.525287 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select start_date
from "finance"."analytics_dev"."int__regime_changes"
where start_date is null



  
  
      
    ) dbt_internal_test
[0m16:19:24.576886 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m16:19:24.592273 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: ROLLBACK
[0m16:19:24.594233 [debug] [Thread-2 (]: SQL status: OK in 0.124 seconds
[0m16:19:24.595961 [debug] [Thread-4 (]: SQL status: OK in 0.141 seconds
[0m16:19:24.598577 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006'
[0m16:19:24.600900 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: Close
[0m16:19:24.606474 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: ROLLBACK
[0m16:19:24.612487 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: ROLLBACK
[0m16:19:24.614853 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257'
[0m16:19:24.619988 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755'
[0m16:19:24.621811 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: Close
[0m16:19:24.617675 [info ] [Thread-1 (]: 115 of 125 PASS not_null_int__regime_changes_regime ............................ [[32mPASS[0m in 0.32s]
[0m16:19:24.624287 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: Close
[0m16:19:24.627359 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m16:19:24.629884 [info ] [Thread-2 (]: 116 of 125 PASS not_null_int__regime_changes_regime_period_id .................. [[32mPASS[0m in 0.33s]
[0m16:19:24.631950 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m16:19:24.634715 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m16:19:24.633528 [info ] [Thread-4 (]: 114 of 125 PASS not_null_int__regime_changes_end_date .......................... [[32mPASS[0m in 0.35s]
[0m16:19:24.635749 [debug] [Thread-3 (]: SQL status: OK in 0.109 seconds
[0m16:19:24.636525 [info ] [Thread-1 (]: 118 of 125 START test unique_int__regime_changes_regime_period_id .............. [RUN]
[0m16:19:24.637963 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m16:19:24.639591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006, now test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1)
[0m16:19:24.641090 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m16:19:24.651982 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: ROLLBACK
[0m16:19:24.658630 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m16:19:24.659983 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7'
[0m16:19:24.660755 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: Close
[0m16:19:24.661780 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m16:19:24.662826 [info ] [Thread-3 (]: 117 of 125 PASS not_null_int__regime_changes_start_date ........................ [[32mPASS[0m in 0.19s]
[0m16:19:24.667886 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m16:19:24.669088 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m16:19:24.670847 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m16:19:24.671598 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: BEGIN
[0m16:19:24.672243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:24.674433 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:19:24.675201 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m16:19:24.675929 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    regime_period_id as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."int__regime_changes"
where regime_period_id is not null
group by regime_period_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:19:24.770353 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m16:19:24.780696 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: ROLLBACK
[0m16:19:24.783365 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1'
[0m16:19:24.785080 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: Close
[0m16:19:24.789124 [info ] [Thread-1 (]: 118 of 125 PASS unique_int__regime_changes_regime_period_id .................... [[32mPASS[0m in 0.15s]
[0m16:19:24.792369 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m16:19:24.795004 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:19:24.797425 [info ] [Thread-2 (]: 119 of 125 SKIP relation analytics_dev.mrt__stocks_with_regimes ................ [[33mSKIP[0m]
[0m16:19:24.800246 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:19:24.801979 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.mrt__stocks_with_regimes' to be skipped because of status 'skipped'. 
[0m16:19:24.805403 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m16:19:24.807480 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m16:19:24.809339 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m16:19:24.811131 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m16:19:24.813119 [info ] [Thread-4 (]: 120 of 125 SKIP test accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis  [[33mSKIP[0m]
[0m16:19:24.816456 [info ] [Thread-3 (]: 121 of 125 SKIP test dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0  [[33mSKIP[0m]
[0m16:19:24.818543 [info ] [Thread-1 (]: 122 of 125 SKIP test dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date  [[33mSKIP[0m]
[0m16:19:24.824680 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m16:19:24.826799 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m16:19:24.822267 [info ] [Thread-2 (]: 123 of 125 SKIP test dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0  [[33mSKIP[0m]
[0m16:19:24.829356 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m16:19:24.831341 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m16:19:24.833420 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8' to be skipped because of status 'skipped'. 
[0m16:19:24.835854 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509
[0m16:19:24.838577 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m16:19:24.842924 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b' to be skipped because of status 'skipped'. 
[0m16:19:24.841188 [info ] [Thread-4 (]: 124 of 125 SKIP test dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker  [[33mSKIP[0m]
[0m16:19:24.846080 [info ] [Thread-3 (]: 125 of 125 SKIP test relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_  [[33mSKIP[0m]
[0m16:19:24.849775 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf' to be skipped because of status 'skipped'. 
[0m16:19:24.851920 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m16:19:24.854203 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509
[0m16:19:24.856108 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe' to be skipped because of status 'skipped'. 
[0m16:19:24.858613 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de' to be skipped because of status 'skipped'. 
[0m16:19:24.860256 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509' to be skipped because of status 'skipped'. 
[0m16:19:24.866109 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:24.867630 [debug] [MainThread]: On master: BEGIN
[0m16:19:24.868936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:24.873527 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m16:19:24.874992 [debug] [MainThread]: On master: COMMIT
[0m16:19:24.876677 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:24.878070 [debug] [MainThread]: On master: COMMIT
[0m16:19:24.881525 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:19:24.882969 [debug] [MainThread]: On master: Close
[0m16:19:24.884647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:24.885884 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m16:19:24.887243 [debug] [MainThread]: Connection 'create_finance_analytics_dev_snapshots' was properly closed.
[0m16:19:24.888600 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m16:19:24.889831 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m16:19:24.890968 [debug] [MainThread]: Connection 'test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1' was properly closed.
[0m16:19:24.892118 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7' was properly closed.
[0m16:19:24.893273 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257' was properly closed.
[0m16:19:24.894413 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755' was properly closed.
[0m16:19:24.896770 [info ] [MainThread]: 
[0m16:19:24.899269 [info ] [MainThread]: Finished running 2 incremental models, 1 seed, 2 snapshots, 111 data tests, 9 view models in 0 hours 0 minutes and 12.13 seconds (12.13s).
[0m16:19:24.957295 [debug] [MainThread]: Command end result
[0m16:19:25.093954 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:19:25.098093 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:19:25.113167 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m16:19:25.113790 [info ] [MainThread]: 
[0m16:19:25.114656 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:19:25.115432 [info ] [MainThread]: 
[0m16:19:25.116639 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker (models\silver\silver_schema.yml)[0m
[0m16:19:25.117541 [error] [MainThread]:   Got 1255 results, configured to fail if != 0
[0m16:19:25.118353 [info ] [MainThread]: 
[0m16:19:25.119264 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\silver_schema.yml\dbt_utils_unique_combination_o_a1dbfb05e7c68a21f055be6037f68214.sql
[0m16:19:25.120290 [info ] [MainThread]: 
[0m16:19:25.121313 [info ] [MainThread]: Done. PASS=65 WARN=0 ERROR=1 SKIP=59 NO-OP=0 TOTAL=125
[0m16:19:25.122656 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 14 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:19:25.124336 [debug] [MainThread]: Command `-c build` failed at 16:19:25.124149 after 19.13 seconds
[0m16:19:25.124943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216427E0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216447AECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021646F6FBF0>]}
[0m16:19:25.125531 [debug] [MainThread]: Flushing usage events
[0m16:19:26.527884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:12.837554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0B3A8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0BBB42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0C1F7ED0>]}


============================== 16:40:12.853437 | 35a27624-8c0b-47eb-9e44-835f1156ff8f ==============================
[0m16:40:12.853437 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:40:12.856142 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt seed --full-refresh --select regime_thresholds', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:40:13.547112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35a27624-8c0b-47eb-9e44-835f1156ff8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0B560180>]}
[0m16:40:13.656538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35a27624-8c0b-47eb-9e44-835f1156ff8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0C09B790>]}
[0m16:40:13.660894 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:40:14.137234 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:40:14.469416 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:40:14.470503 [debug] [MainThread]: previous checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, current checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25
[0m16:40:14.471286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '35a27624-8c0b-47eb-9e44-835f1156ff8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0DBC9950>]}
[0m16:40:17.384296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '35a27624-8c0b-47eb-9e44-835f1156ff8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0DB568A0>]}
[0m16:40:17.994590 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m16:40:17.995469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '35a27624-8c0b-47eb-9e44-835f1156ff8f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0DF190F0>]}
[0m16:40:19.262523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35a27624-8c0b-47eb-9e44-835f1156ff8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0DABA340>]}
[0m16:40:19.562815 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:40:19.566556 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:40:19.620530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35a27624-8c0b-47eb-9e44-835f1156ff8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0DAFD610>]}
[0m16:40:19.621233 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m16:40:19.622147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35a27624-8c0b-47eb-9e44-835f1156ff8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0E21CE10>]}
[0m16:40:19.626263 [info ] [MainThread]: 
[0m16:40:19.627173 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:19.628004 [info ] [MainThread]: 
[0m16:40:19.629073 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:40:19.630582 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:40:19.805366 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:40:19.805979 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:40:19.806497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:22.430629 [debug] [ThreadPool]: SQL status: OK in 2.624 seconds
[0m16:40:22.436423 [debug] [ThreadPool]: On list_finance: Close
[0m16:40:22.439198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m16:40:22.441225 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m16:40:22.466374 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:40:22.468131 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:40:22.469337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:22.474814 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:40:22.479702 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:40:22.480974 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m16:40:22.484852 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:40:22.486096 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:40:22.487295 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m16:40:22.662075 [debug] [ThreadPool]: SQL status: OK in 0.173 seconds
[0m16:40:22.669240 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:40:22.670709 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:40:22.672007 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:40:22.721153 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m16:40:22.723292 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m16:40:22.748415 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m16:40:22.754496 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m16:40:22.774923 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:40:22.782951 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:40:22.784422 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m16:40:22.786022 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m16:40:22.787560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:22.789087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:22.793062 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:40:22.794424 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:40:22.795635 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m16:40:22.797150 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m16:40:22.798784 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:40:22.801113 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m16:40:22.899165 [debug] [ThreadPool]: SQL status: OK in 0.099 seconds
[0m16:40:22.900136 [debug] [ThreadPool]: SQL status: OK in 0.097 seconds
[0m16:40:22.902958 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m16:40:22.905323 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m16:40:22.907498 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m16:40:22.908478 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m16:40:22.909102 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m16:40:22.909780 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m16:40:22.915970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35a27624-8c0b-47eb-9e44-835f1156ff8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0E24E030>]}
[0m16:40:22.916838 [debug] [MainThread]: Using duckdb connection "master"
[0m16:40:22.917504 [debug] [MainThread]: On master: BEGIN
[0m16:40:22.918121 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:22.920358 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m16:40:22.920947 [debug] [MainThread]: On master: COMMIT
[0m16:40:22.921514 [debug] [MainThread]: Using duckdb connection "master"
[0m16:40:22.922065 [debug] [MainThread]: On master: COMMIT
[0m16:40:22.923104 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:40:22.923685 [debug] [MainThread]: On master: Close
[0m16:40:22.931795 [debug] [Thread-1 (]: Began running node seed.portfolio_project_2.regime_thresholds
[0m16:40:22.932762 [info ] [Thread-1 (]: 1 of 1 START seed file analytics_dev.regime_thresholds ......................... [RUN]
[0m16:40:22.934125 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.portfolio_project_2.regime_thresholds'
[0m16:40:22.934791 [debug] [Thread-1 (]: Began compiling node seed.portfolio_project_2.regime_thresholds
[0m16:40:22.935559 [debug] [Thread-1 (]: Began executing node seed.portfolio_project_2.regime_thresholds
[0m16:40:23.015467 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m16:40:23.016554 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "seed.portfolio_project_2.regime_thresholds"} */

      drop table if exists "finance"."analytics_dev"."regime_thresholds" cascade
    
[0m16:40:23.017516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:40:23.206608 [debug] [Thread-1 (]: SQL status: OK in 0.189 seconds
[0m16:40:23.231168 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m16:40:23.232123 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: BEGIN
[0m16:40:23.234515 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:40:23.235382 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m16:40:23.236229 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "seed.portfolio_project_2.regime_thresholds"} */

    create table "finance"."analytics_dev"."regime_thresholds" ("version_id" integer,"version_name" text,"complacent_max" integer,"normal_max" integer,"elevated_max" integer,"effective_date" date,"notes" text)
  
[0m16:40:23.305828 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m16:40:23.333416 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m16:40:23.334485 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: 
          COPY "finance"."analytics_dev"."regime_thresholds" FROM 'C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\seeds\regime_thresholds.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:40:23.468451 [debug] [Thread-1 (]: SQL status: OK in 0.133 seconds
[0m16:40:23.495054 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.portfolio_project_2.regime_thresholds"
[0m16:40:23.568272 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m16:40:23.570069 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m16:40:23.571610 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m16:40:23.946404 [debug] [Thread-1 (]: SQL status: OK in 0.373 seconds
[0m16:40:23.954965 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: Close
[0m16:40:23.963857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35a27624-8c0b-47eb-9e44-835f1156ff8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0B4DCC50>]}
[0m16:40:23.966619 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics_dev.regime_thresholds ..................... [[32mCREATE 2[0m in 1.02s]
[0m16:40:23.970129 [debug] [Thread-1 (]: Finished running node seed.portfolio_project_2.regime_thresholds
[0m16:40:23.976084 [debug] [MainThread]: Using duckdb connection "master"
[0m16:40:23.977630 [debug] [MainThread]: On master: BEGIN
[0m16:40:23.979651 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:23.984343 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:40:23.985816 [debug] [MainThread]: On master: COMMIT
[0m16:40:23.987260 [debug] [MainThread]: Using duckdb connection "master"
[0m16:40:23.988697 [debug] [MainThread]: On master: COMMIT
[0m16:40:23.991921 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m16:40:23.993763 [debug] [MainThread]: On master: Close
[0m16:40:23.995513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:23.996743 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m16:40:23.997923 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m16:40:23.999187 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m16:40:24.000476 [debug] [MainThread]: Connection 'seed.portfolio_project_2.regime_thresholds' was properly closed.
[0m16:40:24.001773 [info ] [MainThread]: 
[0m16:40:24.003672 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.37 seconds (4.37s).
[0m16:40:24.007452 [debug] [MainThread]: Command end result
[0m16:40:24.301119 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:40:24.305294 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:40:24.314747 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m16:40:24.315290 [info ] [MainThread]: 
[0m16:40:24.316186 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:24.316945 [info ] [MainThread]: 
[0m16:40:24.317789 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:40:24.318907 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 14 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:40:24.320678 [debug] [MainThread]: Command `-c seed` succeeded at 16:40:24.320483 after 11.93 seconds
[0m16:40:24.321358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0589F150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0E5CB070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0D5176B0>]}
[0m16:40:24.322017 [debug] [MainThread]: Flushing usage events
[0m16:40:25.407439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:40.338492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D4D89C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D4E0A42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D4E6E7ED0>]}


============================== 16:40:40.354621 | f8052fcc-9e26-433c-8f50-15fe2d24d9b1 ==============================
[0m16:40:40.354621 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:40:40.357197 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --select stg__vix_with_versions+', 'printer_width': '80', 'target_path': 'None'}
[0m16:40:40.963419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8052fcc-9e26-433c-8f50-15fe2d24d9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D4DA50180>]}
[0m16:40:41.139676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8052fcc-9e26-433c-8f50-15fe2d24d9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D4E58B790>]}
[0m16:40:41.146533 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:40:41.711449 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:40:42.162892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:42.163419 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:42.289622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8052fcc-9e26-433c-8f50-15fe2d24d9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D4F7D5E50>]}
[0m16:40:42.616436 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:40:42.620099 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:40:42.698652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8052fcc-9e26-433c-8f50-15fe2d24d9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D4FA10B90>]}
[0m16:40:42.699871 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m16:40:42.701177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8052fcc-9e26-433c-8f50-15fe2d24d9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D4FA66510>]}
[0m16:40:42.709016 [info ] [MainThread]: 
[0m16:40:42.710227 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:42.711601 [info ] [MainThread]: 
[0m16:40:42.713331 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:40:42.726337 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:40:42.955931 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:40:42.956678 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:40:42.957406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:44.930863 [debug] [ThreadPool]: SQL status: OK in 1.973 seconds
[0m16:40:44.936411 [debug] [ThreadPool]: On list_finance: Close
[0m16:40:44.939133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m16:40:44.941360 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m16:40:44.965871 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:40:44.966952 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:40:44.967905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:44.971738 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:40:44.974655 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:40:44.975381 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m16:40:44.977522 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:40:44.978253 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:40:44.978951 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m16:40:45.038292 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m16:40:45.041540 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:40:45.042953 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:40:45.044250 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:40:45.124071 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m16:40:45.125637 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m16:40:45.135187 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m16:40:45.152525 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m16:40:45.161882 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:40:45.170178 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:40:45.172021 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m16:40:45.173569 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m16:40:45.175057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:45.176945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:45.180946 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:40:45.182301 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:40:45.183672 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m16:40:45.185134 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:40:45.186830 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:40:45.188790 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m16:40:45.296614 [debug] [ThreadPool]: SQL status: OK in 0.110 seconds
[0m16:40:45.298151 [debug] [ThreadPool]: SQL status: OK in 0.108 seconds
[0m16:40:45.307086 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m16:40:45.309297 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m16:40:45.314348 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m16:40:45.316424 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m16:40:45.317867 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m16:40:45.320244 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m16:40:45.334176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8052fcc-9e26-433c-8f50-15fe2d24d9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D50251CC0>]}
[0m16:40:45.336561 [debug] [MainThread]: Using duckdb connection "master"
[0m16:40:45.337894 [debug] [MainThread]: On master: BEGIN
[0m16:40:45.339131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:45.343344 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m16:40:45.344694 [debug] [MainThread]: On master: COMMIT
[0m16:40:45.345992 [debug] [MainThread]: Using duckdb connection "master"
[0m16:40:45.347249 [debug] [MainThread]: On master: COMMIT
[0m16:40:45.349673 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:40:45.351289 [debug] [MainThread]: On master: Close
[0m16:40:45.367805 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m16:40:45.369979 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_dev.stg__vix_with_versions ............... [RUN]
[0m16:40:45.372720 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m16:40:45.374335 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m16:40:45.413961 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m16:40:45.417700 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m16:40:45.550383 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m16:40:45.553554 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:40:45.554697 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m16:40:45.556144 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:40:45.559772 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:40:45.560834 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:40:45.561756 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m16:40:45.681104 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m16:40:45.707103 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:40:45.708826 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m16:40:45.800738 [debug] [Thread-1 (]: SQL status: OK in 0.090 seconds
[0m16:40:45.813710 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:40:45.815297 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m16:40:45.909770 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m16:40:45.968959 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m16:40:45.970726 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:40:45.972285 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m16:40:46.190068 [debug] [Thread-1 (]: SQL status: OK in 0.216 seconds
[0m16:40:46.234264 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m16:40:46.241124 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m16:40:46.409727 [debug] [Thread-1 (]: SQL status: OK in 0.164 seconds
[0m16:40:46.416742 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m16:40:46.421406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8052fcc-9e26-433c-8f50-15fe2d24d9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D5034DC10>]}
[0m16:40:46.422776 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_dev.stg__vix_with_versions .......... [[32mOK[0m in 1.05s]
[0m16:40:46.424708 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m16:40:46.426162 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m16:40:46.427194 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m16:40:46.428720 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m16:40:46.429531 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m16:40:46.434815 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m16:40:46.436750 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m16:40:46.444212 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m16:40:46.446112 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:40:46.447042 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m16:40:46.447720 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:40:46.450894 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:40:46.451879 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:40:46.452625 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:40:46.531066 [debug] [Thread-2 (]: SQL status: OK in 0.078 seconds
[0m16:40:46.537361 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:40:46.538399 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m16:40:46.645561 [debug] [Thread-2 (]: SQL status: OK in 0.106 seconds
[0m16:40:46.659108 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:40:46.660766 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m16:40:46.944537 [debug] [Thread-2 (]: SQL status: OK in 0.282 seconds
[0m16:40:46.947597 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m16:40:46.948896 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:40:46.950758 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m16:40:47.229276 [debug] [Thread-2 (]: SQL status: OK in 0.277 seconds
[0m16:40:47.243398 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:40:47.244571 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m16:40:47.400823 [debug] [Thread-2 (]: SQL status: OK in 0.155 seconds
[0m16:40:47.404331 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m16:40:47.405754 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8052fcc-9e26-433c-8f50-15fe2d24d9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D4FCB0E10>]}
[0m16:40:47.407317 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.98s]
[0m16:40:47.409325 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m16:40:47.411012 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m16:40:47.412493 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m16:40:47.414676 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m16:40:47.416129 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m16:40:47.424173 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m16:40:47.426503 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m16:40:47.434902 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m16:40:47.437446 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:40:47.438750 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m16:40:47.439669 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:40:47.442676 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:40:47.443764 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:40:47.444928 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m16:40:47.600400 [debug] [Thread-3 (]: SQL status: OK in 0.154 seconds
[0m16:40:47.607894 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:40:47.608928 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m16:40:47.707596 [debug] [Thread-3 (]: SQL status: OK in 0.098 seconds
[0m16:40:47.715490 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:40:47.716573 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m16:40:47.803531 [debug] [Thread-3 (]: SQL status: OK in 0.086 seconds
[0m16:40:47.806776 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m16:40:47.807778 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:40:47.808710 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m16:40:47.936140 [debug] [Thread-3 (]: SQL status: OK in 0.126 seconds
[0m16:40:47.942537 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m16:40:47.943576 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m16:40:48.085668 [debug] [Thread-3 (]: SQL status: OK in 0.141 seconds
[0m16:40:48.089251 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m16:40:48.090675 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8052fcc-9e26-433c-8f50-15fe2d24d9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D50043750>]}
[0m16:40:48.092215 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.68s]
[0m16:40:48.094341 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m16:40:48.096452 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:40:48.097989 [info ] [Thread-4 (]: 4 of 4 START sql incremental model analytics_dev.mrt__stocks_with_regimes ...... [RUN]
[0m16:40:48.100385 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.mrt__stocks_with_regimes'
[0m16:40:48.101552 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:40:48.127529 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:48.130707 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:40:48.148367 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:48.149481 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__200b207d3daf" cascade
    
[0m16:40:48.150423 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:40:48.204584 [debug] [Thread-4 (]: SQL status: OK in 0.054 seconds
[0m16:40:48.315377 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:48.316747 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:40:48.321776 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:40:48.326166 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:48.327388 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m16:40:48.330606 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:40:48.331700 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:48.332584 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m16:40:48.785180 [debug] [Thread-4 (]: SQL status: OK in 0.452 seconds
[0m16:40:48.787465 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:48.788264 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m16:40:48.789159 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m16:40:48.791953 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:40:48.792831 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:48.793471 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:40:48.850567 [debug] [Thread-4 (]: SQL status: OK in 0.056 seconds
[0m16:40:48.899425 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:48.900338 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:40:48.908381 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m16:40:48.945912 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:48.951475 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,0))
 as volume, 
      
    cast(null as text)
 as regime
    ) as __dbt_sbq
    where false
    limit 0
)
[0m16:40:48.972832 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m16:40:49.086272 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:49.088296 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:49.089292 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m16:40:49.091787 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:40:49.092866 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:49.093595 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_tmp"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null
    
    )
 ;
    insert into "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_tmp" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m16:40:49.845635 [debug] [Thread-4 (]: SQL status: OK in 0.751 seconds
[0m16:40:49.858742 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:49.859696 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'analytics_dev'
      AND table_name = 'mrt__stocks_with_regimes'
  
[0m16:40:49.862369 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:40:49.865416 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:49.866344 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'analytics_dev'
      AND table_name = 'mrt__stocks_with_regimes'
  
[0m16:40:49.869124 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:40:49.877971 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:49.878919 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
alter table "finance"."analytics_dev"."mrt__stocks_with_regimes" rename to "mrt__stocks_with_regimes__dbt_backup"
[0m16:40:50.096731 [debug] [Thread-4 (]: SQL status: OK in 0.216 seconds
[0m16:40:50.111264 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:50.113178 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
alter table "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_tmp" rename to "mrt__stocks_with_regimes"
[0m16:40:50.233619 [debug] [Thread-4 (]: SQL status: OK in 0.119 seconds
[0m16:40:50.263871 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:40:50.266833 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:50.268613 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m16:40:50.539327 [debug] [Thread-4 (]: SQL status: OK in 0.269 seconds
[0m16:40:50.545973 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:50.547254 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__200b207d3daf" cascade
    
[0m16:40:50.609600 [debug] [Thread-4 (]: SQL status: OK in 0.061 seconds
[0m16:40:50.617049 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:50.618156 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_backup" cascade
    
[0m16:40:50.803233 [debug] [Thread-4 (]: SQL status: OK in 0.184 seconds
[0m16:40:50.810077 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m16:40:50.810803 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__200b207d3daf" cascade
    
[0m16:40:50.865874 [debug] [Thread-4 (]: SQL status: OK in 0.054 seconds
[0m16:40:50.869229 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m16:40:50.870563 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8052fcc-9e26-433c-8f50-15fe2d24d9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D502B0BD0>]}
[0m16:40:50.872108 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes . [[32mOK[0m in 2.77s]
[0m16:40:50.874291 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m16:40:50.877771 [debug] [MainThread]: Using duckdb connection "master"
[0m16:40:50.878715 [debug] [MainThread]: On master: BEGIN
[0m16:40:50.879531 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:50.882376 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m16:40:50.883902 [debug] [MainThread]: On master: COMMIT
[0m16:40:50.885591 [debug] [MainThread]: Using duckdb connection "master"
[0m16:40:50.887171 [debug] [MainThread]: On master: COMMIT
[0m16:40:50.889958 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:40:50.891488 [debug] [MainThread]: On master: Close
[0m16:40:50.893361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:50.894818 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m16:40:50.896244 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m16:40:50.897647 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m16:40:50.899060 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__vix_with_versions' was properly closed.
[0m16:40:50.900435 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m16:40:50.901811 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m16:40:50.903215 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m16:40:50.904879 [info ] [MainThread]: 
[0m16:40:50.906702 [info ] [MainThread]: Finished running 1 incremental model, 3 view models in 0 hours 0 minutes and 8.19 seconds (8.19s).
[0m16:40:50.910825 [debug] [MainThread]: Command end result
[0m16:40:51.091359 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:40:51.098040 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:40:51.114590 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m16:40:51.115513 [info ] [MainThread]: 
[0m16:40:51.116819 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:51.118007 [info ] [MainThread]: 
[0m16:40:51.119276 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:40:51.122324 [debug] [MainThread]: Command `-c run` succeeded at 16:40:51.121979 after 11.23 seconds
[0m16:40:51.123288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D4E5EFB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D47D8F150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D502BF590>]}
[0m16:40:51.124225 [debug] [MainThread]: Flushing usage events
[0m16:40:52.675596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:13:49.125769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C5B3A8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C5BBB42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C5C1F3ED0>]}


============================== 19:13:49.130454 | 2814e2d6-7fee-4773-9340-9aa6d69bd212 ==============================
[0m19:13:49.130454 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:13:49.131176 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt seed --full-refresh --select regime_thresholds', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m19:13:49.460737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2814e2d6-7fee-4773-9340-9aa6d69bd212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C5B560180>]}
[0m19:13:49.526725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2814e2d6-7fee-4773-9340-9aa6d69bd212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C5C09B790>]}
[0m19:13:49.542842 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:13:49.947712 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:13:51.087072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:13:51.087918 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://seeds\regime_thresholds.csv
[0m19:13:51.537196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2814e2d6-7fee-4773-9340-9aa6d69bd212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C5DBBEE50>]}
[0m19:13:51.687111 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:13:51.690829 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:13:51.728968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2814e2d6-7fee-4773-9340-9aa6d69bd212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C5DACD310>]}
[0m19:13:51.729463 [info ] [MainThread]: Found 11 models, 111 data tests, 2 snapshots, 1 seed, 2 sources, 853 macros
[0m19:13:51.730001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2814e2d6-7fee-4773-9340-9aa6d69bd212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C5DD0C910>]}
[0m19:13:51.732451 [info ] [MainThread]: 
[0m19:13:51.732972 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:13:51.733439 [info ] [MainThread]: 
[0m19:13:51.734060 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:13:51.735045 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m19:13:52.923427 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m19:13:52.923860 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m19:13:52.924190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:54.378338 [debug] [ThreadPool]: SQL status: OK in 1.454 seconds
[0m19:13:54.379700 [debug] [ThreadPool]: On list_finance: Close
[0m19:13:54.380374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m19:13:54.380857 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m19:13:54.386890 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:13:54.387220 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:13:54.387517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:54.388979 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:54.390209 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:13:54.390514 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m19:13:54.391457 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:54.391759 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:13:54.392056 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m19:13:54.438571 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m19:13:54.439529 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:13:54.439861 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:13:54.440166 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:13:54.487368 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m19:13:54.487795 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m19:13:54.494023 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m19:13:54.499453 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:13:54.499799 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m19:13:54.500081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:54.500844 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m19:13:54.503272 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:13:54.503654 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m19:13:54.503943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:54.504404 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:13:54.504767 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:13:54.505074 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m19:13:54.505498 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:13:54.505819 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:13:54.506143 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m19:13:54.530931 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m19:13:54.531332 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m19:13:54.533070 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m19:13:54.534248 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m19:13:54.547583 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m19:13:54.548070 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m19:13:54.548621 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m19:13:54.548931 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m19:13:54.552160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2814e2d6-7fee-4773-9340-9aa6d69bd212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C5E13D640>]}
[0m19:13:54.552620 [debug] [MainThread]: Using duckdb connection "master"
[0m19:13:54.552928 [debug] [MainThread]: On master: BEGIN
[0m19:13:54.553224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:13:54.554440 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:13:54.554768 [debug] [MainThread]: On master: COMMIT
[0m19:13:54.555084 [debug] [MainThread]: Using duckdb connection "master"
[0m19:13:54.555386 [debug] [MainThread]: On master: COMMIT
[0m19:13:54.555967 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:13:54.556295 [debug] [MainThread]: On master: Close
[0m19:13:54.561198 [debug] [Thread-1 (]: Began running node seed.portfolio_project_2.regime_thresholds
[0m19:13:54.561710 [info ] [Thread-1 (]: 1 of 1 START seed file analytics_dev.regime_thresholds ......................... [RUN]
[0m19:13:54.562400 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.portfolio_project_2.regime_thresholds'
[0m19:13:54.562776 [debug] [Thread-1 (]: Began compiling node seed.portfolio_project_2.regime_thresholds
[0m19:13:54.563152 [debug] [Thread-1 (]: Began executing node seed.portfolio_project_2.regime_thresholds
[0m19:13:54.591568 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m19:13:54.591975 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "seed.portfolio_project_2.regime_thresholds"} */

      drop table if exists "finance"."analytics_dev"."regime_thresholds" cascade
    
[0m19:13:54.592324 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:13:54.697510 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m19:13:54.704917 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m19:13:54.705353 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: BEGIN
[0m19:13:54.706533 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:54.706961 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m19:13:54.707358 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "seed.portfolio_project_2.regime_thresholds"} */

    create table "finance"."analytics_dev"."regime_thresholds" ("version_id" integer,"version_name" text,"complacent_max" integer,"normal_max" integer,"elevated_max" integer,"effective_date" date,"notes" text)
  
[0m19:13:54.780980 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m19:13:54.793394 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m19:13:54.793865 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: 
          COPY "finance"."analytics_dev"."regime_thresholds" FROM 'C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\seeds\regime_thresholds.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:13:54.961992 [debug] [Thread-1 (]: SQL status: OK in 0.168 seconds
[0m19:13:54.968470 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.portfolio_project_2.regime_thresholds"
[0m19:13:54.985252 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m19:13:54.985686 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m19:13:54.986105 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m19:13:55.122969 [debug] [Thread-1 (]: SQL status: OK in 0.136 seconds
[0m19:13:55.127437 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: Close
[0m19:13:55.131817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2814e2d6-7fee-4773-9340-9aa6d69bd212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C5DD92990>]}
[0m19:13:55.132783 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics_dev.regime_thresholds ..................... [[32mCREATE 2[0m in 0.57s]
[0m19:13:55.134222 [debug] [Thread-1 (]: Finished running node seed.portfolio_project_2.regime_thresholds
[0m19:13:55.136531 [debug] [MainThread]: Using duckdb connection "master"
[0m19:13:55.137055 [debug] [MainThread]: On master: BEGIN
[0m19:13:55.137511 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:13:55.139237 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:13:55.139758 [debug] [MainThread]: On master: COMMIT
[0m19:13:55.140267 [debug] [MainThread]: Using duckdb connection "master"
[0m19:13:55.140719 [debug] [MainThread]: On master: COMMIT
[0m19:13:55.141487 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:13:55.141908 [debug] [MainThread]: On master: Close
[0m19:13:55.142417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:55.142806 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m19:13:55.143175 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m19:13:55.143537 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m19:13:55.143901 [debug] [MainThread]: Connection 'seed.portfolio_project_2.regime_thresholds' was properly closed.
[0m19:13:55.144310 [info ] [MainThread]: 
[0m19:13:55.144874 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m19:13:55.146004 [debug] [MainThread]: Command end result
[0m19:13:55.216511 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:13:55.220944 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:13:55.227751 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m19:13:55.228162 [info ] [MainThread]: 
[0m19:13:55.228818 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:13:55.229439 [info ] [MainThread]: 
[0m19:13:55.230010 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:13:55.231146 [debug] [MainThread]: Command `-c seed` succeeded at 19:13:55.231007 after 6.25 seconds
[0m19:13:55.231541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C5DD87C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C5E09AE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C5E09AB70>]}
[0m19:13:55.231909 [debug] [MainThread]: Flushing usage events
[0m19:13:55.956361 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:14:00.932017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247707A8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024770FB42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247715F7ED0>]}


============================== 19:14:00.936350 | f4b64cb9-873d-4dce-8d67-5e58fb447e22 ==============================
[0m19:14:00.936350 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:14:00.937053 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m19:14:01.205836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024770960180>]}
[0m19:14:01.273237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477149B790>]}
[0m19:14:01.276282 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:14:01.565476 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:14:01.827880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:01.828738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:01.912819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247727A9E50>]}
[0m19:14:02.148376 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:14:02.151313 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:14:02.190584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024772984B90>]}
[0m19:14:02.191073 [info ] [MainThread]: Found 11 models, 111 data tests, 2 snapshots, 1 seed, 2 sources, 853 macros
[0m19:14:02.191625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247729DA270>]}
[0m19:14:02.195782 [info ] [MainThread]: 
[0m19:14:02.196477 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:14:02.197011 [info ] [MainThread]: 
[0m19:14:02.197696 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:14:02.203212 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m19:14:02.293760 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m19:14:02.294350 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m19:14:02.294898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:03.687366 [debug] [ThreadPool]: SQL status: OK in 1.392 seconds
[0m19:14:03.688882 [debug] [ThreadPool]: On list_finance: Close
[0m19:14:03.689665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m19:14:03.690194 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m19:14:03.697953 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:14:03.698376 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:14:03.698685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:03.700309 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:14:03.701720 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:14:03.702064 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m19:14:03.703065 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:14:03.703393 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:14:03.703703 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m19:14:03.750677 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m19:14:03.751773 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:14:03.752187 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:14:03.752519 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:14:03.803714 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m19:14:03.804162 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m19:14:03.806735 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m19:14:03.813375 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:14:03.813925 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m19:14:03.814258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:03.814911 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m19:14:03.817060 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:14:03.817390 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m19:14:03.817677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:03.818221 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:14:03.818550 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:14:03.818865 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m19:14:03.819298 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:14:03.819633 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:14:03.819963 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m19:14:03.847146 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m19:14:03.847638 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m19:14:03.849059 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m19:14:03.850566 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m19:14:03.851818 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m19:14:03.852142 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m19:14:03.852675 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m19:14:03.852997 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m19:14:03.857167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247731BE0D0>]}
[0m19:14:03.858067 [debug] [MainThread]: Using duckdb connection "master"
[0m19:14:03.858799 [debug] [MainThread]: On master: BEGIN
[0m19:14:03.859295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:03.861425 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:14:03.862466 [debug] [MainThread]: On master: COMMIT
[0m19:14:03.863384 [debug] [MainThread]: Using duckdb connection "master"
[0m19:14:03.863886 [debug] [MainThread]: On master: COMMIT
[0m19:14:03.864609 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:14:03.864951 [debug] [MainThread]: On master: Close
[0m19:14:03.870157 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m19:14:03.870656 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m19:14:03.871230 [info ] [Thread-1 (]: 1 of 11 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m19:14:03.872488 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m19:14:03.872881 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m19:14:03.884311 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m19:14:03.871809 [info ] [Thread-2 (]: 2 of 11 START sql view model analytics_dev.src_vix ............................. [RUN]
[0m19:14:03.885159 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m19:14:03.885577 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m19:14:03.888451 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m19:14:03.889891 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m19:14:03.922943 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m19:14:03.923464 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m19:14:03.928158 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m19:14:03.929523 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:14:03.929991 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m19:14:03.930371 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:14:03.931188 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:14:03.931591 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m19:14:03.931961 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:14:03.932601 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:14:03.933000 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:14:03.933399 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m19:14:03.934102 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:14:03.934490 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:14:03.934868 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m19:14:04.114699 [debug] [Thread-1 (]: SQL status: OK in 0.181 seconds
[0m19:14:04.124435 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:14:04.125013 [debug] [Thread-2 (]: SQL status: OK in 0.190 seconds
[0m19:14:04.125596 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m19:14:04.131345 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:14:04.132187 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m19:14:04.201749 [debug] [Thread-2 (]: SQL status: OK in 0.069 seconds
[0m19:14:04.204879 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:14:04.205317 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m19:14:04.205751 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m19:14:04.209078 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:14:04.209793 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m19:14:04.275938 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m19:14:04.289455 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m19:14:04.292984 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m19:14:04.295043 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m19:14:04.295677 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:14:04.296238 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:14:04.296787 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m19:14:04.297330 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m19:14:04.433499 [debug] [Thread-1 (]: SQL status: OK in 0.135 seconds
[0m19:14:04.442064 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:14:04.443042 [debug] [Thread-2 (]: SQL status: OK in 0.145 seconds
[0m19:14:04.444212 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m19:14:04.449221 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:14:04.450173 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m19:14:04.585201 [debug] [Thread-1 (]: SQL status: OK in 0.135 seconds
[0m19:14:04.587757 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m19:14:04.590237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247732BDE50>]}
[0m19:14:04.590984 [info ] [Thread-1 (]: 1 of 11 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.72s]
[0m19:14:04.592096 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m19:14:04.592996 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__stocks
[0m19:14:04.593636 [info ] [Thread-3 (]: 3 of 11 START sql view model analytics_dev.stg__stocks ......................... [RUN]
[0m19:14:04.594695 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m19:14:04.595171 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m19:14:04.598788 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m19:14:04.599802 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m19:14:04.603337 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m19:14:04.604397 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m19:14:04.604814 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m19:14:04.605162 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:14:04.606450 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:14:04.606893 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m19:14:04.607293 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m19:14:04.692214 [debug] [Thread-2 (]: SQL status: OK in 0.241 seconds
[0m19:14:04.694786 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m19:14:04.696960 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024772C26C50>]}
[0m19:14:04.697811 [info ] [Thread-2 (]: 2 of 11 OK created sql view model analytics_dev.src_vix ........................ [[32mOK[0m in 0.81s]
[0m19:14:04.698794 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m19:14:04.699588 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m19:14:04.700161 [info ] [Thread-4 (]: 4 of 11 START sql view model analytics_dev.stg__vix_with_versions .............. [RUN]
[0m19:14:04.701066 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m19:14:04.701494 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m19:14:04.704780 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m19:14:04.705796 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m19:14:04.711237 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m19:14:04.713598 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:14:04.714453 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m19:14:04.715145 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:14:04.716661 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:14:04.717172 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:14:04.717600 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m19:14:04.751159 [debug] [Thread-3 (]: SQL status: OK in 0.143 seconds
[0m19:14:04.755835 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m19:14:04.756314 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m19:14:04.807586 [debug] [Thread-4 (]: SQL status: OK in 0.089 seconds
[0m19:14:04.811466 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:14:04.811927 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m19:14:04.825918 [debug] [Thread-3 (]: SQL status: OK in 0.069 seconds
[0m19:14:04.829422 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m19:14:04.829881 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m19:14:04.872164 [debug] [Thread-4 (]: SQL status: OK in 0.060 seconds
[0m19:14:04.875988 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:14:04.876495 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m19:14:04.895799 [debug] [Thread-3 (]: SQL status: OK in 0.065 seconds
[0m19:14:04.897214 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m19:14:04.897631 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m19:14:04.897994 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m19:14:04.950959 [debug] [Thread-4 (]: SQL status: OK in 0.074 seconds
[0m19:14:04.952345 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m19:14:04.952786 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:14:04.953145 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m19:14:04.999290 [debug] [Thread-3 (]: SQL status: OK in 0.101 seconds
[0m19:14:05.002078 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m19:14:05.002482 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m19:14:05.087961 [debug] [Thread-4 (]: SQL status: OK in 0.134 seconds
[0m19:14:05.090556 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:14:05.091013 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m19:14:05.181011 [debug] [Thread-3 (]: SQL status: OK in 0.178 seconds
[0m19:14:05.186213 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: Close
[0m19:14:05.186824 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247748BB610>]}
[0m19:14:05.187762 [info ] [Thread-3 (]: 3 of 11 OK created sql view model analytics_dev.stg__stocks .................... [[32mOK[0m in 0.59s]
[0m19:14:05.189214 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m19:14:05.190315 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__price_changes
[0m19:14:05.191061 [info ] [Thread-1 (]: 5 of 11 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m19:14:05.191904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__price_changes)
[0m19:14:05.192349 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m19:14:05.196688 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m19:14:05.198131 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m19:14:05.201696 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m19:14:05.203065 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:14:05.203918 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m19:14:05.204333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:05.205648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:14:05.206102 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:14:05.206555 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."stg__stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m19:14:05.264406 [debug] [Thread-4 (]: SQL status: OK in 0.173 seconds
[0m19:14:05.265910 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m19:14:05.266462 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247731EAE50>]}
[0m19:14:05.267200 [info ] [Thread-4 (]: 4 of 11 OK created sql view model analytics_dev.stg__vix_with_versions ......... [[32mOK[0m in 0.57s]
[0m19:14:05.268027 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m19:14:05.268822 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m19:14:05.269347 [info ] [Thread-2 (]: 6 of 11 START sql view model analytics_dev.int__regime_classification .......... [RUN]
[0m19:14:05.269960 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_classification)
[0m19:14:05.270360 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m19:14:05.273187 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m19:14:05.274077 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m19:14:05.277484 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m19:14:05.278442 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:14:05.278818 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m19:14:05.279160 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:14:05.280330 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:14:05.280727 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:14:05.281125 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m19:14:05.370784 [debug] [Thread-2 (]: SQL status: OK in 0.089 seconds
[0m19:14:05.376194 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:14:05.376857 [debug] [Thread-1 (]: SQL status: OK in 0.170 seconds
[0m19:14:05.377514 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m19:14:05.381499 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:14:05.382297 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m19:14:05.449725 [debug] [Thread-2 (]: SQL status: OK in 0.067 seconds
[0m19:14:05.454130 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:14:05.454606 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m19:14:05.455044 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m19:14:05.458108 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:14:05.458807 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m19:14:05.531310 [debug] [Thread-2 (]: SQL status: OK in 0.073 seconds
[0m19:14:05.532781 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m19:14:05.533204 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:14:05.533572 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m19:14:05.535737 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m19:14:05.537079 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m19:14:05.537492 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:14:05.537869 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m19:14:05.651086 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m19:14:05.654073 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:14:05.654557 [debug] [Thread-2 (]: SQL status: OK in 0.121 seconds
[0m19:14:05.655003 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m19:14:05.657526 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:14:05.658205 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m19:14:05.769754 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m19:14:05.770253 [debug] [Thread-2 (]: SQL status: OK in 0.112 seconds
[0m19:14:05.771681 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: Close
[0m19:14:05.773026 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m19:14:05.773703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477485DC50>]}
[0m19:14:05.774331 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247748A4C20>]}
[0m19:14:05.775216 [info ] [Thread-1 (]: 5 of 11 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.58s]
[0m19:14:05.776625 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m19:14:05.777329 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m19:14:05.775914 [info ] [Thread-2 (]: 6 of 11 OK created sql view model analytics_dev.int__regime_classification ..... [[32mOK[0m in 0.50s]
[0m19:14:05.778510 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m19:14:05.777823 [info ] [Thread-3 (]: 7 of 11 START sql view model analytics_dev.int__rsi_sma ........................ [RUN]
[0m19:14:05.779239 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now model.portfolio_project_2.int__rsi_sma)
[0m19:14:05.779639 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m19:14:05.783041 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m19:14:05.783607 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m19:14:05.784110 [info ] [Thread-4 (]: 8 of 11 START sql view model analytics_dev.int__regime_changes ................. [RUN]
[0m19:14:05.784751 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now model.portfolio_project_2.int__regime_changes)
[0m19:14:05.785219 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m19:14:05.788210 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m19:14:05.788840 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m19:14:05.792617 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m19:14:05.793623 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m19:14:05.797346 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m19:14:05.798079 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:14:05.798669 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m19:14:05.799251 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:14:05.800241 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:14:05.800786 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m19:14:05.801153 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:14:05.801843 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m19:14:05.802255 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:14:05.802687 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    sma_gain::decimal(18,2) as sma_gain,
    sma_loss::decimal(18,2) as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m19:14:05.803551 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:14:05.803998 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:14:05.804466 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m19:14:05.922681 [debug] [Thread-3 (]: SQL status: OK in 0.119 seconds
[0m19:14:05.926709 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:14:05.927590 [debug] [Thread-4 (]: SQL status: OK in 0.122 seconds
[0m19:14:05.928092 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m19:14:05.931591 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:14:05.932330 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m19:14:06.011672 [debug] [Thread-3 (]: SQL status: OK in 0.080 seconds
[0m19:14:06.015346 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:14:06.015879 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m19:14:06.017992 [debug] [Thread-4 (]: SQL status: OK in 0.085 seconds
[0m19:14:06.020860 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:14:06.021234 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m19:14:06.086699 [debug] [Thread-3 (]: SQL status: OK in 0.070 seconds
[0m19:14:06.088029 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m19:14:06.088401 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:14:06.088749 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m19:14:06.334590 [debug] [Thread-4 (]: SQL status: OK in 0.313 seconds
[0m19:14:06.335943 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m19:14:06.336436 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:14:06.336943 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m19:14:06.380058 [debug] [Thread-3 (]: SQL status: OK in 0.291 seconds
[0m19:14:06.383342 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:14:06.383793 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m19:14:06.709738 [debug] [Thread-4 (]: SQL status: OK in 0.372 seconds
[0m19:14:06.712157 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:14:06.712536 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m19:14:06.847947 [debug] [Thread-4 (]: SQL status: OK in 0.135 seconds
[0m19:14:06.849911 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m19:14:06.850610 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477322F830>]}
[0m19:14:06.851241 [info ] [Thread-4 (]: 8 of 11 OK created sql view model analytics_dev.int__regime_changes ............ [[32mOK[0m in 1.07s]
[0m19:14:06.852080 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m19:14:06.852906 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:14:06.853425 [info ] [Thread-1 (]: 9 of 11 START sql incremental model analytics_dev.mrt__stocks_with_regimes ..... [RUN]
[0m19:14:06.854099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m19:14:06.854653 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:14:06.869935 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:06.871512 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:14:06.876965 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:06.877563 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__3ca198fc32a4" cascade
    
[0m19:14:06.878038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:07.038682 [debug] [Thread-3 (]: SQL status: OK in 0.654 seconds
[0m19:14:07.040408 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m19:14:07.041197 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477322FAD0>]}
[0m19:14:07.041804 [info ] [Thread-3 (]: 7 of 11 OK created sql view model analytics_dev.int__rsi_sma ................... [[32mOK[0m in 1.26s]
[0m19:14:07.043084 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m19:14:07.044056 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m19:14:07.044960 [info ] [Thread-2 (]: 10 of 11 START sql view model analytics_dev.int__rsi_wilder .................... [RUN]
[0m19:14:07.045740 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_classification, now model.portfolio_project_2.int__rsi_wilder)
[0m19:14:07.046128 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m19:14:07.049474 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m19:14:07.050651 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m19:14:07.054070 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m19:14:07.055270 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:14:07.055792 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m19:14:07.056144 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:14:07.058035 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:14:07.058523 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:14:07.058954 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    wilder_gain::decimal(18,2) as wilder_gain,
    wilder_loss::decimal(18,2) as wilder_loss
from wilder
  );

[0m19:14:07.326921 [debug] [Thread-1 (]: SQL status: OK in 0.449 seconds
[0m19:14:07.364091 [debug] [Thread-2 (]: SQL status: OK in 0.305 seconds
[0m19:14:07.364983 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:07.370648 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:14:07.371426 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:14:07.372017 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m19:14:07.374254 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:14:07.375854 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:07.376656 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m19:14:07.378309 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:14:07.378746 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:07.379200 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m19:14:07.665242 [debug] [Thread-1 (]: SQL status: OK in 0.285 seconds
[0m19:14:07.667401 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:07.668289 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m19:14:07.669046 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:14:07.671543 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:14:07.672415 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:07.673465 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:14:07.676233 [debug] [Thread-2 (]: SQL status: OK in 0.303 seconds
[0m19:14:07.682484 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:14:07.683785 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m19:14:07.720213 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m19:14:07.742591 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:07.743071 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:14:07.747778 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:14:07.764642 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:07.765096 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,0))
 as volume, 
      
    cast(null as text)
 as regime
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:14:07.766904 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:14:07.792521 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:07.793047 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."mrt__stocks_with_regimes__3ca198fc32a4"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null
    
    )
 ;
    insert into "finance"."dbt_temp"."mrt__stocks_with_regimes__3ca198fc32a4" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m19:14:07.808946 [debug] [Thread-2 (]: SQL status: OK in 0.124 seconds
[0m19:14:07.810315 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m19:14:07.810702 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:14:07.811056 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m19:14:07.960108 [debug] [Thread-2 (]: SQL status: OK in 0.149 seconds
[0m19:14:07.963616 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:14:07.964298 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m19:14:08.097862 [debug] [Thread-2 (]: SQL status: OK in 0.133 seconds
[0m19:14:08.099470 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m19:14:08.100125 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477322FCB0>]}
[0m19:14:08.100736 [info ] [Thread-2 (]: 10 of 11 OK created sql view model analytics_dev.int__rsi_wilder ............... [[32mOK[0m in 1.05s]
[0m19:14:08.101568 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m19:14:08.102169 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.fct__rsi
[0m19:14:08.102713 [info ] [Thread-4 (]: 11 of 11 START sql incremental model analytics_dev.fct__rsi .................... [RUN]
[0m19:14:08.103316 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_changes, now model.portfolio_project_2.fct__rsi)
[0m19:14:08.103690 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m19:14:08.109899 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m19:14:08.111223 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m19:14:08.115842 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:08.116261 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__8de136e6f4bf" cascade
    
[0m19:14:08.116686 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:14:08.165151 [debug] [Thread-4 (]: SQL status: OK in 0.048 seconds
[0m19:14:08.169730 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:08.170142 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:14:08.171679 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:14:08.173281 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:08.174040 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m19:14:08.175821 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:14:08.176582 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:08.177262 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m19:14:08.240267 [debug] [Thread-4 (]: SQL status: OK in 0.062 seconds
[0m19:14:08.241580 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:08.241967 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    

  
[0m19:14:08.242406 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m19:14:08.243520 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m19:14:08.243906 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:08.244254 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m19:14:08.272784 [debug] [Thread-1 (]: SQL status: OK in 0.479 seconds
[0m19:14:08.279719 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:08.280250 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m19:14:08.281544 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:14:08.281924 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:08.282297 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__3ca198fc32a4'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:14:08.284922 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m19:14:08.285895 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:08.286555 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:14:08.289484 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m19:14:08.295363 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:08.295819 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:14:08.296764 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m19:14:08.301953 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:08.302446 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as sma_rs, 
      
    cast(null as decimal(18,2))
 as sma_rsi, 
      
    cast(null as decimal(18,2))
 as wilder_rs, 
      
    cast(null as decimal(18,2))
 as wilder_rsi
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:14:08.302862 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m19:14:08.317463 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:08.317958 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m19:14:08.318518 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__3ca198fc32a4'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:14:08.322206 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:08.322896 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."fct__rsi__8de136e6f4bf"
  
  (
    trade_date date not null,
    ticker text not null,
    sma_rs decimal(18,2),
    sma_rsi decimal(18,2),
    wilder_rs decimal(18,2),
    wilder_rsi decimal(18,2)
    
    )
 ;
    insert into "finance"."dbt_temp"."fct__rsi__8de136e6f4bf" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      sma_rs ,
    
      
      sma_rsi ,
    
      
      wilder_rs ,
    
      
      wilder_rsi 
    
  )
 (
      
    select trade_date, ticker, sma_rs, sma_rsi, wilder_rs, wilder_rsi
    from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as model_subq
    );
  
  
  
[0m19:14:08.329247 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m19:14:08.332911 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:08.333700 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:14:08.339355 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:14:08.351457 [debug] [Thread-1 (]: 
    In "finance"."analytics_dev"."mrt__stocks_with_regimes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:14:08.352003 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:08.352372 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
SELECT version()
[0m19:14:08.353272 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:14:08.429033 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:08.430328 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:08.430761 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */


    MERGE INTO "finance"."analytics_dev"."mrt__stocks_with_regimes" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."mrt__stocks_with_regimes__3ca198fc32a4" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m19:14:08.604998 [debug] [Thread-1 (]: SQL status: OK in 0.174 seconds
[0m19:14:08.607034 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:14:08.607705 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:08.608461 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:14:08.662670 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m19:14:08.667969 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:08.668408 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__3ca198fc32a4" cascade
    
[0m19:14:08.821221 [debug] [Thread-1 (]: SQL status: OK in 0.152 seconds
[0m19:14:08.824509 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:14:08.824941 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__3ca198fc32a4" cascade
    
[0m19:14:08.935365 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m19:14:08.939029 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m19:14:08.940086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477481F170>]}
[0m19:14:08.941402 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes  [[32mOK[0m in 2.09s]
[0m19:14:08.943062 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:14:11.789778 [debug] [Thread-4 (]: SQL status: OK in 3.466 seconds
[0m19:14:11.793169 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:11.793594 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m19:14:11.795075 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:14:11.795482 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:11.795898 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__8de136e6f4bf'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:14:11.801756 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m19:14:11.805674 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:11.806132 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:14:11.814625 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m19:14:11.819232 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:11.819715 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__8de136e6f4bf'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:14:11.828327 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m19:14:11.831818 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:11.832261 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:14:11.839812 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m19:14:11.842073 [debug] [Thread-4 (]: 
    In "finance"."analytics_dev"."fct__rsi":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:14:11.843524 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m19:14:11.844697 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:11.845193 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */


    MERGE INTO "finance"."analytics_dev"."fct__rsi" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."fct__rsi__8de136e6f4bf" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m19:14:11.906124 [debug] [Thread-4 (]: SQL status: OK in 0.060 seconds
[0m19:14:11.907859 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m19:14:11.908447 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:11.908850 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m19:14:11.955809 [debug] [Thread-4 (]: SQL status: OK in 0.046 seconds
[0m19:14:11.958174 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:11.958544 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__8de136e6f4bf" cascade
    
[0m19:14:12.129288 [debug] [Thread-4 (]: SQL status: OK in 0.170 seconds
[0m19:14:12.132847 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:14:12.133250 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__8de136e6f4bf" cascade
    
[0m19:14:12.184093 [debug] [Thread-4 (]: SQL status: OK in 0.050 seconds
[0m19:14:12.185385 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: Close
[0m19:14:12.185909 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b64cb9-873d-4dce-8d67-5e58fb447e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477481EC90>]}
[0m19:14:12.186475 [info ] [Thread-4 (]: 11 of 11 OK created sql incremental model analytics_dev.fct__rsi ............... [[32mOK[0m in 4.08s]
[0m19:14:12.187330 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m19:14:12.188952 [debug] [MainThread]: Using duckdb connection "master"
[0m19:14:12.189508 [debug] [MainThread]: On master: BEGIN
[0m19:14:12.190020 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:14:12.191725 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:14:12.192268 [debug] [MainThread]: On master: COMMIT
[0m19:14:12.192800 [debug] [MainThread]: Using duckdb connection "master"
[0m19:14:12.193320 [debug] [MainThread]: On master: COMMIT
[0m19:14:12.194273 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:14:12.194809 [debug] [MainThread]: On master: Close
[0m19:14:12.195447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:12.195944 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m19:14:12.196419 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m19:14:12.196907 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m19:14:12.197196 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m19:14:12.197463 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m19:14:12.197727 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m19:14:12.197987 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m19:14:12.198385 [info ] [MainThread]: 
[0m19:14:12.198946 [info ] [MainThread]: Finished running 2 incremental models, 9 view models in 0 hours 0 minutes and 10.00 seconds (10.00s).
[0m19:14:12.202029 [debug] [MainThread]: Command end result
[0m19:14:12.338854 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:14:12.343262 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:14:12.354093 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m19:14:12.354930 [info ] [MainThread]: 
[0m19:14:12.355847 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:14:12.356712 [info ] [MainThread]: 
[0m19:14:12.357562 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m19:14:12.358925 [debug] [MainThread]: Command `-c run` succeeded at 19:14:12.358788 after 11.56 seconds
[0m19:14:12.359424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247714F7B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247759DFDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247759DF830>]}
[0m19:14:12.359824 [debug] [MainThread]: Flushing usage events
[0m19:14:13.063328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:52:56.509511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F6D88050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F75942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F7BD7ED0>]}


============================== 19:52:56.514002 | bbacb1b2-e061-4fe1-b317-480ebb48aa40 ==============================
[0m19:52:56.514002 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:52:56.514799 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt clean', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m19:52:56.660469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbacb1b2-e061-4fe1-b317-480ebb48aa40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F6F40180>]}
[0m19:52:56.861984 [debug] [MainThread]: Command `-c clean` succeeded at 19:52:56.861857 after 0.48 seconds
[0m19:52:56.862352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F7A7A360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F7A7A9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F7A73C50>]}
[0m19:52:56.862721 [debug] [MainThread]: Flushing usage events
[0m19:52:57.592736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:53:05.031015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B12BFE8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B12C7F42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B12CE37ED0>]}


============================== 19:53:05.035569 | cf738ab0-c871-4981-a46a-ad9c84dd14a6 ==============================
[0m19:53:05.035569 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:53:05.036265 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt seed --full-refresh', 'printer_width': '80', 'target_path': 'None'}
[0m19:53:05.290691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf738ab0-c871-4981-a46a-ad9c84dd14a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B12C1A0180>]}
[0m19:53:05.356662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf738ab0-c871-4981-a46a-ad9c84dd14a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B12CCDB790>]}
[0m19:53:05.359326 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:53:05.631617 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:53:05.632696 [debug] [MainThread]: Command `-c seed` failed at 19:53:05.632577 after 0.73 seconds
[0m19:53:05.633052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B12CF55450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B12CF55350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B12E180F50>]}
[0m19:53:05.633509 [debug] [MainThread]: Flushing usage events
[0m19:53:06.323944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:53:11.112462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E369618050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E369E242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36A463ED0>]}


============================== 19:53:11.117055 | c70b828d-1e71-4304-a1cd-d01cce335baf ==============================
[0m19:53:11.117055 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:53:11.117809 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt deps', 'printer_width': '80', 'target_path': 'None'}
[0m19:53:11.260657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c70b828d-1e71-4304-a1cd-d01cce335baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3697D0180>]}
[0m19:53:11.312289 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-0o8d93t9'
[0m19:53:11.312761 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:53:12.046774 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:53:12.048448 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:53:12.901672 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:53:12.909816 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m19:53:13.471104 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m19:53:13.476217 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m19:53:14.024770 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m19:53:14.028830 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:53:14.943035 [info ] [MainThread]: Installed from version 1.3.2
[0m19:53:14.943772 [info ] [MainThread]: Up to date!
[0m19:53:14.944410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c70b828d-1e71-4304-a1cd-d01cce335baf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36A30AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36A30A580>]}
[0m19:53:14.944841 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m19:53:19.104535 [info ] [MainThread]: Installed from version 0.10.9
[0m19:53:19.105137 [info ] [MainThread]: Up to date!
[0m19:53:19.105674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c70b828d-1e71-4304-a1cd-d01cce335baf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36B69D050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36A2F76B0>]}
[0m19:53:19.106068 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m19:53:19.996266 [info ] [MainThread]: Installed from version 0.16.1
[0m19:53:19.996922 [info ] [MainThread]: Up to date!
[0m19:53:19.997589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c70b828d-1e71-4304-a1cd-d01cce335baf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36B679A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36B679470>]}
[0m19:53:20.000619 [debug] [MainThread]: Command `-c deps` succeeded at 19:53:20.000425 after 9.02 seconds
[0m19:53:20.001045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36A25B1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36B61E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36B691E90>]}
[0m19:53:20.001451 [debug] [MainThread]: Flushing usage events
[0m19:53:20.718388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:53:44.524590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA59BD8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5A3E42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5AA27ED0>]}


============================== 19:53:44.530249 | 20464ba6-ef9b-40f5-a25b-1e2f814f12ab ==============================
[0m19:53:44.530249 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:53:44.531306 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt seed --full-refresh', 'printer_width': '80', 'target_path': 'None'}
[0m19:53:44.795984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20464ba6-ef9b-40f5-a25b-1e2f814f12ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA59D90180>]}
[0m19:53:44.862323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20464ba6-ef9b-40f5-a25b-1e2f814f12ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5A8CB790>]}
[0m19:53:44.865127 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:53:45.152662 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:53:45.153938 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:53:45.154481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '20464ba6-ef9b-40f5-a25b-1e2f814f12ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5BB19250>]}
[0m19:53:47.757045 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m19:53:47.757730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '20464ba6-ef9b-40f5-a25b-1e2f814f12ab', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5C5C1400>]}
[0m19:53:48.595993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20464ba6-ef9b-40f5-a25b-1e2f814f12ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5C818E50>]}
[0m19:53:48.762020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:53:48.764963 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:53:48.804685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20464ba6-ef9b-40f5-a25b-1e2f814f12ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5C925A50>]}
[0m19:53:48.805224 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m19:53:48.805841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20464ba6-ef9b-40f5-a25b-1e2f814f12ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5C622A50>]}
[0m19:53:48.809221 [info ] [MainThread]: 
[0m19:53:48.809843 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:53:48.810359 [info ] [MainThread]: 
[0m19:53:48.811096 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:53:48.812313 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m19:53:48.897854 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m19:53:48.898258 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m19:53:48.898578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:50.624514 [debug] [ThreadPool]: SQL status: OK in 1.726 seconds
[0m19:53:50.625909 [debug] [ThreadPool]: On list_finance: Close
[0m19:53:50.626594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m19:53:50.627114 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m19:53:50.633252 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:53:50.633582 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:53:50.633884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:50.635364 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:53:50.636701 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:53:50.637018 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m19:53:50.637946 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:53:50.638258 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:53:50.638623 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m19:53:50.690741 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m19:53:50.692216 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:53:50.692829 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:53:50.693333 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:53:50.746090 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m19:53:50.747266 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m19:53:50.753566 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m19:53:50.759466 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:53:50.759964 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m19:53:50.760314 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m19:53:50.763769 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:53:50.764155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:50.764537 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m19:53:50.765165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:50.765886 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:53:50.766230 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:53:50.766569 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m19:53:50.767159 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:53:50.767495 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:53:50.767823 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m19:53:50.790471 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m19:53:50.790865 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m19:53:50.792186 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m19:53:50.793537 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m19:53:50.794668 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m19:53:50.794974 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m19:53:50.795492 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m19:53:50.795801 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m19:53:50.799012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20464ba6-ef9b-40f5-a25b-1e2f814f12ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5CCD8100>]}
[0m19:53:50.799469 [debug] [MainThread]: Using duckdb connection "master"
[0m19:53:50.799777 [debug] [MainThread]: On master: BEGIN
[0m19:53:50.800072 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:53:50.801204 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:53:50.801516 [debug] [MainThread]: On master: COMMIT
[0m19:53:50.801819 [debug] [MainThread]: Using duckdb connection "master"
[0m19:53:50.802103 [debug] [MainThread]: On master: COMMIT
[0m19:53:50.802679 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:53:50.802986 [debug] [MainThread]: On master: Close
[0m19:53:50.807909 [debug] [Thread-1 (]: Began running node seed.portfolio_project_2.regime_thresholds
[0m19:53:50.808429 [info ] [Thread-1 (]: 1 of 1 START seed file analytics_dev.regime_thresholds ......................... [RUN]
[0m19:53:50.809070 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.portfolio_project_2.regime_thresholds'
[0m19:53:50.809435 [debug] [Thread-1 (]: Began compiling node seed.portfolio_project_2.regime_thresholds
[0m19:53:50.809783 [debug] [Thread-1 (]: Began executing node seed.portfolio_project_2.regime_thresholds
[0m19:53:50.838191 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m19:53:50.838883 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "seed.portfolio_project_2.regime_thresholds"} */

      drop table if exists "finance"."analytics_dev"."regime_thresholds" cascade
    
[0m19:53:50.839314 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:53:51.061253 [debug] [Thread-1 (]: SQL status: OK in 0.222 seconds
[0m19:53:51.069503 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m19:53:51.069998 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: BEGIN
[0m19:53:51.071602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:53:51.072085 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m19:53:51.072492 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "seed.portfolio_project_2.regime_thresholds"} */

    create table "finance"."analytics_dev"."regime_thresholds" ("version_id" integer,"version_name" text,"complacent_max" integer,"normal_max" integer,"elevated_max" integer,"effective_date" date,"notes" text)
  
[0m19:53:51.136335 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m19:53:51.149021 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m19:53:51.149507 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: 
          COPY "finance"."analytics_dev"."regime_thresholds" FROM 'C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\seeds\regime_thresholds.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:53:51.290350 [debug] [Thread-1 (]: SQL status: OK in 0.140 seconds
[0m19:53:51.295477 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.portfolio_project_2.regime_thresholds"
[0m19:53:51.311603 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m19:53:51.312042 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m19:53:51.312386 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m19:53:51.414884 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m19:53:51.417005 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: Close
[0m19:53:51.419237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20464ba6-ef9b-40f5-a25b-1e2f814f12ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA59D04550>]}
[0m19:53:51.419811 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics_dev.regime_thresholds ..................... [[32mCREATE 2[0m in 0.61s]
[0m19:53:51.420609 [debug] [Thread-1 (]: Finished running node seed.portfolio_project_2.regime_thresholds
[0m19:53:51.422572 [debug] [MainThread]: Using duckdb connection "master"
[0m19:53:51.422948 [debug] [MainThread]: On master: BEGIN
[0m19:53:51.423249 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:53:51.424551 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:53:51.424908 [debug] [MainThread]: On master: COMMIT
[0m19:53:51.425209 [debug] [MainThread]: Using duckdb connection "master"
[0m19:53:51.425492 [debug] [MainThread]: On master: COMMIT
[0m19:53:51.426066 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:53:51.426376 [debug] [MainThread]: On master: Close
[0m19:53:51.426767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:51.427041 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m19:53:51.427300 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m19:53:51.427603 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m19:53:51.427894 [debug] [MainThread]: Connection 'seed.portfolio_project_2.regime_thresholds' was properly closed.
[0m19:53:51.428224 [info ] [MainThread]: 
[0m19:53:51.428731 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.62 seconds (2.62s).
[0m19:53:51.429880 [debug] [MainThread]: Command end result
[0m19:53:51.495990 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:53:51.498781 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:53:51.504804 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m19:53:51.505153 [info ] [MainThread]: 
[0m19:53:51.505726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:53:51.506214 [info ] [MainThread]: 
[0m19:53:51.506732 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:53:51.507443 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 14 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:53:51.508520 [debug] [MainThread]: Command `-c seed` succeeded at 19:53:51.508405 after 7.12 seconds
[0m19:53:51.508896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5CBD12D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5C678250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5A92FB60>]}
[0m19:53:51.509306 [debug] [MainThread]: Flushing usage events
[0m19:53:52.253184 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:54:03.667732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6AD98050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6B5A42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6BBE3ED0>]}


============================== 19:54:03.672583 | 6a7c83d1-5044-40fc-bea9-bc9df9d8d047 ==============================
[0m19:54:03.672583 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:54:03.673324 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --full-refresh', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'target_path': 'None', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m19:54:03.939872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6AF50180>]}
[0m19:54:04.006916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6BA8B790>]}
[0m19:54:04.009618 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:54:04.291041 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:54:04.539978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:54:04.540347 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:54:04.621547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6CCE5E50>]}
[0m19:54:04.830787 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:54:04.833554 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:54:04.869860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6CED4B90>]}
[0m19:54:04.870343 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m19:54:04.870888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6CF16510>]}
[0m19:54:04.874675 [info ] [MainThread]: 
[0m19:54:04.875227 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:54:04.875842 [info ] [MainThread]: 
[0m19:54:04.876591 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:54:04.882806 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m19:54:04.969963 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m19:54:04.970363 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m19:54:04.970683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:06.373222 [debug] [ThreadPool]: SQL status: OK in 1.402 seconds
[0m19:54:06.374929 [debug] [ThreadPool]: On list_finance: Close
[0m19:54:06.375696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m19:54:06.376230 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m19:54:06.382436 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:54:06.382833 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:54:06.383139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:54:06.384711 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:54:06.385980 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:54:06.386285 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m19:54:06.387198 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:54:06.387507 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:54:06.387804 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m19:54:06.438742 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m19:54:06.440083 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:54:06.440604 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:54:06.441085 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:54:06.487584 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m19:54:06.489214 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m19:54:06.497816 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m19:54:06.503630 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:54:06.503977 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m19:54:06.504274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:06.504897 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m19:54:06.506850 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:54:06.507175 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m19:54:06.507464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:06.508111 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:54:06.508449 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:54:06.508782 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m19:54:06.509252 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:54:06.509594 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:54:06.509923 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m19:54:06.534381 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m19:54:06.534797 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m19:54:06.536168 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m19:54:06.537464 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m19:54:06.538642 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m19:54:06.538958 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m19:54:06.539475 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m19:54:06.539800 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m19:54:06.543092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6D70DD90>]}
[0m19:54:06.543597 [debug] [MainThread]: Using duckdb connection "master"
[0m19:54:06.543926 [debug] [MainThread]: On master: BEGIN
[0m19:54:06.544220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:54:06.545279 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:54:06.545594 [debug] [MainThread]: On master: COMMIT
[0m19:54:06.545899 [debug] [MainThread]: Using duckdb connection "master"
[0m19:54:06.546237 [debug] [MainThread]: On master: COMMIT
[0m19:54:06.546810 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:54:06.547128 [debug] [MainThread]: On master: Close
[0m19:54:06.551968 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m19:54:06.552893 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m19:54:06.552492 [info ] [Thread-1 (]: 1 of 11 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m19:54:06.553971 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m19:54:06.554351 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m19:54:06.563687 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m19:54:06.553371 [info ] [Thread-2 (]: 2 of 11 START sql view model analytics_dev.src_vix ............................. [RUN]
[0m19:54:06.564582 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m19:54:06.564987 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m19:54:06.567710 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m19:54:06.570679 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m19:54:06.601038 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m19:54:06.601540 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m19:54:06.605269 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m19:54:06.607941 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:54:06.608367 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m19:54:06.608741 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:54:06.609769 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:54:06.610207 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m19:54:06.610583 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:54:06.611238 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:54:06.611615 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:54:06.611982 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m19:54:06.612653 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:54:06.613050 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:54:06.613430 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m19:54:06.775063 [debug] [Thread-1 (]: SQL status: OK in 0.162 seconds
[0m19:54:06.789370 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:54:06.790086 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m19:54:06.797151 [debug] [Thread-2 (]: SQL status: OK in 0.183 seconds
[0m19:54:06.800522 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:54:06.800931 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m19:54:06.847995 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m19:54:06.851756 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:54:06.852251 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m19:54:06.863187 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m19:54:06.867203 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:54:06.867692 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m19:54:06.913381 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m19:54:06.924831 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m19:54:06.925264 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:54:06.925624 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m19:54:06.926717 [debug] [Thread-2 (]: SQL status: OK in 0.059 seconds
[0m19:54:06.928026 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m19:54:06.928404 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:54:06.928747 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m19:54:07.035683 [debug] [Thread-2 (]: SQL status: OK in 0.106 seconds
[0m19:54:07.041357 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:54:07.041862 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m19:54:07.042346 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m19:54:07.045716 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:54:07.046174 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m19:54:07.194147 [debug] [Thread-2 (]: SQL status: OK in 0.151 seconds
[0m19:54:07.197039 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m19:54:07.199633 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6D80DCD0>]}
[0m19:54:07.200459 [info ] [Thread-2 (]: 2 of 11 OK created sql view model analytics_dev.src_vix ........................ [[32mOK[0m in 0.63s]
[0m19:54:07.201600 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m19:54:07.202418 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m19:54:07.203186 [info ] [Thread-3 (]: 3 of 11 START sql view model analytics_dev.stg__vix_with_versions .............. [RUN]
[0m19:54:07.204050 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m19:54:07.204457 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m19:54:07.207937 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m19:54:07.209511 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m19:54:07.212748 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m19:54:07.214466 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:54:07.215161 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m19:54:07.215515 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:54:07.216972 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:54:07.217732 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:54:07.218400 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m19:54:07.303317 [debug] [Thread-1 (]: SQL status: OK in 0.257 seconds
[0m19:54:07.304821 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m19:54:07.305395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6D162990>]}
[0m19:54:07.306060 [info ] [Thread-1 (]: 1 of 11 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.75s]
[0m19:54:07.307178 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m19:54:07.307930 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__stocks
[0m19:54:07.308474 [info ] [Thread-4 (]: 4 of 11 START sql view model analytics_dev.stg__stocks ......................... [RUN]
[0m19:54:07.309549 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m19:54:07.310002 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m19:54:07.313238 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m19:54:07.314221 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m19:54:07.317662 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m19:54:07.318695 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m19:54:07.319091 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m19:54:07.319442 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:54:07.320691 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:54:07.321082 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m19:54:07.321492 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m19:54:07.399299 [debug] [Thread-4 (]: SQL status: OK in 0.077 seconds
[0m19:54:07.402520 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m19:54:07.403231 [debug] [Thread-3 (]: SQL status: OK in 0.184 seconds
[0m19:54:07.403665 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m19:54:07.406696 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:54:07.407393 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m19:54:07.494924 [debug] [Thread-4 (]: SQL status: OK in 0.088 seconds
[0m19:54:07.498617 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m19:54:07.499069 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m19:54:07.501410 [debug] [Thread-3 (]: SQL status: OK in 0.094 seconds
[0m19:54:07.504775 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:54:07.505231 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m19:54:07.613699 [debug] [Thread-4 (]: SQL status: OK in 0.114 seconds
[0m19:54:07.616407 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m19:54:07.617157 [debug] [Thread-3 (]: SQL status: OK in 0.111 seconds
[0m19:54:07.617814 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m19:54:07.619912 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m19:54:07.620621 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m19:54:07.621371 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:54:07.622164 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m19:54:07.756426 [debug] [Thread-3 (]: SQL status: OK in 0.134 seconds
[0m19:54:07.760134 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:54:07.760771 [debug] [Thread-4 (]: SQL status: OK in 0.139 seconds
[0m19:54:07.761199 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m19:54:07.764216 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m19:54:07.765111 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m19:54:07.902210 [debug] [Thread-3 (]: SQL status: OK in 0.137 seconds
[0m19:54:07.907416 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m19:54:07.907810 [debug] [Thread-4 (]: SQL status: OK in 0.137 seconds
[0m19:54:07.908426 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6EE3B7F0>]}
[0m19:54:07.909729 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: Close
[0m19:54:07.910956 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6EE3D150>]}
[0m19:54:07.910413 [info ] [Thread-3 (]: 3 of 11 OK created sql view model analytics_dev.stg__vix_with_versions ......... [[32mOK[0m in 0.70s]
[0m19:54:07.912335 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m19:54:07.911718 [info ] [Thread-4 (]: 4 of 11 OK created sql view model analytics_dev.stg__stocks .................... [[32mOK[0m in 0.60s]
[0m19:54:07.913303 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m19:54:07.913945 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m19:54:07.914814 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__price_changes
[0m19:54:07.914437 [info ] [Thread-2 (]: 5 of 11 START sql view model analytics_dev.int__regime_classification .......... [RUN]
[0m19:54:07.915820 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_classification)
[0m19:54:07.916225 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m19:54:07.919242 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m19:54:07.915296 [info ] [Thread-1 (]: 6 of 11 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m19:54:07.920061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__price_changes)
[0m19:54:07.920473 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m19:54:07.925857 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m19:54:07.927812 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m19:54:07.931031 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m19:54:07.931530 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m19:54:07.934751 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m19:54:07.936491 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:54:07.936932 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m19:54:07.937287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:07.938146 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:54:07.938612 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m19:54:07.938991 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:54:07.939674 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:54:07.940080 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:54:07.940506 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."stg__stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m19:54:07.941304 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:54:07.941712 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:54:07.942145 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m19:54:08.046598 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m19:54:08.049883 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:54:08.050285 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m19:54:08.102197 [debug] [Thread-2 (]: SQL status: OK in 0.159 seconds
[0m19:54:08.105260 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:54:08.105644 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m19:54:08.128859 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m19:54:08.131898 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:54:08.132267 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m19:54:08.178387 [debug] [Thread-2 (]: SQL status: OK in 0.072 seconds
[0m19:54:08.182142 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:54:08.182612 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m19:54:08.209038 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m19:54:08.210385 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m19:54:08.210762 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:54:08.211110 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m19:54:08.242358 [debug] [Thread-2 (]: SQL status: OK in 0.059 seconds
[0m19:54:08.243794 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m19:54:08.244203 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:54:08.244581 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m19:54:08.319402 [debug] [Thread-2 (]: SQL status: OK in 0.074 seconds
[0m19:54:08.322370 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:54:08.322819 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m19:54:08.323368 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m19:54:08.326237 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:54:08.326676 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m19:54:08.422411 [debug] [Thread-2 (]: SQL status: OK in 0.099 seconds
[0m19:54:08.423804 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m19:54:08.424318 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6EE7DF60>]}
[0m19:54:08.424908 [info ] [Thread-2 (]: 5 of 11 OK created sql view model analytics_dev.int__regime_classification ..... [[32mOK[0m in 0.51s]
[0m19:54:08.425737 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m19:54:08.426428 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m19:54:08.426932 [info ] [Thread-3 (]: 7 of 11 START sql view model analytics_dev.int__regime_changes ................. [RUN]
[0m19:54:08.427551 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now model.portfolio_project_2.int__regime_changes)
[0m19:54:08.427950 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m19:54:08.430945 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m19:54:08.433733 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m19:54:08.437173 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m19:54:08.438295 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:54:08.438681 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m19:54:08.439035 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:54:08.440266 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:54:08.440656 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:54:08.441084 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m19:54:08.532652 [debug] [Thread-1 (]: SQL status: OK in 0.206 seconds
[0m19:54:08.534068 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: Close
[0m19:54:08.534594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6D89D9D0>]}
[0m19:54:08.535189 [info ] [Thread-1 (]: 6 of 11 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.61s]
[0m19:54:08.536003 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m19:54:08.536691 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m19:54:08.537451 [info ] [Thread-4 (]: 8 of 11 START sql view model analytics_dev.int__rsi_sma ........................ [RUN]
[0m19:54:08.538109 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now model.portfolio_project_2.int__rsi_sma)
[0m19:54:08.538522 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m19:54:08.541550 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m19:54:08.542529 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m19:54:08.545970 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m19:54:08.547030 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:54:08.547412 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m19:54:08.547759 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:54:08.548878 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:54:08.549240 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:54:08.549662 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    sma_gain::decimal(18,2) as sma_gain,
    sma_loss::decimal(18,2) as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m19:54:08.634991 [debug] [Thread-3 (]: SQL status: OK in 0.193 seconds
[0m19:54:08.639004 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:54:08.639507 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m19:54:08.644465 [debug] [Thread-4 (]: SQL status: OK in 0.094 seconds
[0m19:54:08.648178 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:54:08.648757 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m19:54:08.708478 [debug] [Thread-3 (]: SQL status: OK in 0.068 seconds
[0m19:54:08.712299 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:54:08.712823 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m19:54:08.736345 [debug] [Thread-4 (]: SQL status: OK in 0.087 seconds
[0m19:54:08.739990 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:54:08.740477 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m19:54:08.779259 [debug] [Thread-3 (]: SQL status: OK in 0.066 seconds
[0m19:54:08.780635 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m19:54:08.781035 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:54:08.781394 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m19:54:08.815421 [debug] [Thread-4 (]: SQL status: OK in 0.074 seconds
[0m19:54:08.816793 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m19:54:08.817203 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:54:08.817563 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m19:54:09.002357 [debug] [Thread-3 (]: SQL status: OK in 0.221 seconds
[0m19:54:09.005245 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:54:09.005662 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m19:54:09.006217 [debug] [Thread-4 (]: SQL status: OK in 0.188 seconds
[0m19:54:09.012317 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:54:09.013128 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m19:54:09.122805 [debug] [Thread-3 (]: SQL status: OK in 0.117 seconds
[0m19:54:09.123275 [debug] [Thread-4 (]: SQL status: OK in 0.110 seconds
[0m19:54:09.124799 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m19:54:09.126184 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m19:54:09.126841 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6D77FB30>]}
[0m19:54:09.127360 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6D77F890>]}
[0m19:54:09.128029 [info ] [Thread-3 (]: 7 of 11 OK created sql view model analytics_dev.int__regime_changes ............ [[32mOK[0m in 0.70s]
[0m19:54:09.129322 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m19:54:09.128600 [info ] [Thread-4 (]: 8 of 11 OK created sql view model analytics_dev.int__rsi_sma ................... [[32mOK[0m in 0.59s]
[0m19:54:09.130175 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m19:54:09.130814 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:54:09.131813 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m19:54:09.131307 [info ] [Thread-1 (]: 10 of 11 START sql incremental model analytics_dev.mrt__stocks_with_regimes .... [RUN]
[0m19:54:09.132852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m19:54:09.133253 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:54:09.143331 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.132311 [info ] [Thread-2 (]: 9 of 11 START sql view model analytics_dev.int__rsi_wilder ..................... [RUN]
[0m19:54:09.144141 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_classification, now model.portfolio_project_2.int__rsi_wilder)
[0m19:54:09.144566 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m19:54:09.148003 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m19:54:09.149055 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m19:54:09.152296 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m19:54:09.152955 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:54:09.159137 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.159608 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__54274369965c" cascade
    
[0m19:54:09.159992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:09.161217 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:54:09.161958 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m19:54:09.162372 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:54:09.163710 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:54:09.164158 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:54:09.164561 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    wilder_gain::decimal(18,2) as wilder_gain,
    wilder_loss::decimal(18,2) as wilder_loss
from wilder
  );

[0m19:54:09.213008 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m19:54:09.246162 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.246638 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:54:09.248272 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:54:09.249758 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.250169 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m19:54:09.251553 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:54:09.252030 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.252390 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m19:54:09.260893 [debug] [Thread-2 (]: SQL status: OK in 0.096 seconds
[0m19:54:09.264102 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:54:09.264606 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m19:54:09.296911 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m19:54:09.298052 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.298437 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m19:54:09.298873 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:54:09.299949 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:54:09.300328 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.300679 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:54:09.331488 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m19:54:09.334373 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:54:09.334750 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m19:54:09.344018 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m19:54:09.365203 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.365678 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:54:09.369856 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:54:09.386108 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.386955 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,0))
 as volume, 
      
    cast(null as text)
 as regime
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:54:09.389211 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:54:09.414956 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.415440 [debug] [Thread-2 (]: SQL status: OK in 0.080 seconds
[0m19:54:09.416992 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m19:54:09.417383 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:54:09.417745 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m19:54:09.418606 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.419002 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m19:54:09.420064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:54:09.420422 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.420827 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_tmp"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null
    
    )
 ;
    insert into "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_tmp" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m19:54:09.539302 [debug] [Thread-2 (]: SQL status: OK in 0.121 seconds
[0m19:54:09.542364 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:54:09.542786 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m19:54:09.647608 [debug] [Thread-2 (]: SQL status: OK in 0.104 seconds
[0m19:54:09.649098 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m19:54:09.649648 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6D89CC50>]}
[0m19:54:09.650267 [info ] [Thread-2 (]: 9 of 11 OK created sql view model analytics_dev.int__rsi_wilder ................ [[32mOK[0m in 0.51s]
[0m19:54:09.651090 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m19:54:09.651767 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.fct__rsi
[0m19:54:09.652320 [info ] [Thread-3 (]: 11 of 11 START sql incremental model analytics_dev.fct__rsi .................... [RUN]
[0m19:54:09.652943 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_changes, now model.portfolio_project_2.fct__rsi)
[0m19:54:09.653348 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m19:54:09.658257 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m19:54:09.659522 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m19:54:09.663772 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:09.664171 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__a0d4328c7e44" cascade
    
[0m19:54:09.664720 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:54:09.665312 [debug] [Thread-1 (]: SQL status: OK in 0.244 seconds
[0m19:54:09.670946 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.671431 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'analytics_dev'
      AND table_name = 'mrt__stocks_with_regimes'
  
[0m19:54:09.672757 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:54:09.674142 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.674549 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'analytics_dev'
      AND table_name = 'mrt__stocks_with_regimes'
  
[0m19:54:09.675773 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:54:09.679164 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.679600 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
alter table "finance"."analytics_dev"."mrt__stocks_with_regimes" rename to "mrt__stocks_with_regimes__dbt_backup"
[0m19:54:09.737586 [debug] [Thread-3 (]: SQL status: OK in 0.073 seconds
[0m19:54:09.740269 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:09.740683 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:54:09.742459 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:54:09.743922 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:09.744301 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m19:54:09.745308 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:54:09.745669 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:09.746314 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m19:54:09.785037 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m19:54:09.788905 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.789371 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
alter table "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_tmp" rename to "mrt__stocks_with_regimes"
[0m19:54:09.800207 [debug] [Thread-3 (]: SQL status: OK in 0.053 seconds
[0m19:54:09.801390 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:09.801792 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    

  
[0m19:54:09.802244 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m19:54:09.803332 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m19:54:09.803756 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:09.804110 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m19:54:09.844699 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m19:54:09.849392 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:54:09.849830 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.850182 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:54:09.854681 [debug] [Thread-3 (]: SQL status: OK in 0.050 seconds
[0m19:54:09.855640 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:09.856119 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:54:09.864647 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m19:54:09.869079 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:09.869476 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as sma_rs, 
      
    cast(null as decimal(18,2))
 as sma_rsi, 
      
    cast(null as decimal(18,2))
 as wilder_rs, 
      
    cast(null as decimal(18,2))
 as wilder_rsi
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:54:09.870847 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:54:09.872891 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m19:54:09.873894 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:09.874278 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m19:54:09.875828 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:54:09.876223 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:09.876686 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."fct__rsi__dbt_tmp"
  
  (
    trade_date date not null,
    ticker text not null,
    sma_rs decimal(18,2),
    sma_rsi decimal(18,2),
    wilder_rs decimal(18,2),
    wilder_rsi decimal(18,2)
    
    )
 ;
    insert into "finance"."analytics_dev"."fct__rsi__dbt_tmp" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      sma_rs ,
    
      
      sma_rsi ,
    
      
      wilder_rs ,
    
      
      wilder_rsi 
    
  )
 (
      
    select trade_date, ticker, sma_rs, sma_rsi, wilder_rs, wilder_rsi
    from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as model_subq
    );
  
  
  
[0m19:54:09.959612 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m19:54:09.962301 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:09.962829 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__54274369965c" cascade
    
[0m19:54:10.016859 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m19:54:10.020057 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:10.020443 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_backup" cascade
    
[0m19:54:10.289991 [debug] [Thread-1 (]: SQL status: OK in 0.269 seconds
[0m19:54:10.293017 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:54:10.293421 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__54274369965c" cascade
    
[0m19:54:10.340501 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m19:54:10.341852 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m19:54:10.342399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6D77F350>]}
[0m19:54:10.343017 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes  [[32mOK[0m in 1.21s]
[0m19:54:10.343858 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:54:11.508618 [debug] [Thread-3 (]: SQL status: OK in 1.631 seconds
[0m19:54:11.509942 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:11.510384 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'analytics_dev'
      AND table_name = 'fct__rsi'
  
[0m19:54:11.511715 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:54:11.513163 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:11.513605 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'analytics_dev'
      AND table_name = 'fct__rsi'
  
[0m19:54:11.514717 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:54:11.521446 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:11.521900 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
alter table "finance"."analytics_dev"."fct__rsi" rename to "fct__rsi__dbt_backup"
[0m19:54:11.622624 [debug] [Thread-3 (]: SQL status: OK in 0.100 seconds
[0m19:54:11.625509 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:11.625888 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
alter table "finance"."analytics_dev"."fct__rsi__dbt_tmp" rename to "fct__rsi"
[0m19:54:11.697870 [debug] [Thread-3 (]: SQL status: OK in 0.071 seconds
[0m19:54:11.700171 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m19:54:11.700536 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:11.700873 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m19:54:11.829712 [debug] [Thread-3 (]: SQL status: OK in 0.128 seconds
[0m19:54:11.832414 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:11.832792 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__a0d4328c7e44" cascade
    
[0m19:54:11.879032 [debug] [Thread-3 (]: SQL status: OK in 0.046 seconds
[0m19:54:11.881927 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:11.882305 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."analytics_dev"."fct__rsi__dbt_backup" cascade
    
[0m19:54:12.000101 [debug] [Thread-3 (]: SQL status: OK in 0.117 seconds
[0m19:54:12.003388 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:54:12.003774 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__a0d4328c7e44" cascade
    
[0m19:54:12.059743 [debug] [Thread-3 (]: SQL status: OK in 0.056 seconds
[0m19:54:12.061076 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: Close
[0m19:54:12.061614 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7c83d1-5044-40fc-bea9-bc9df9d8d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6D89DEB0>]}
[0m19:54:12.062196 [info ] [Thread-3 (]: 11 of 11 OK created sql incremental model analytics_dev.fct__rsi ............... [[32mOK[0m in 2.41s]
[0m19:54:12.063003 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m19:54:12.064808 [debug] [MainThread]: Using duckdb connection "master"
[0m19:54:12.065142 [debug] [MainThread]: On master: BEGIN
[0m19:54:12.065432 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:54:12.066623 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:54:12.066939 [debug] [MainThread]: On master: COMMIT
[0m19:54:12.067241 [debug] [MainThread]: Using duckdb connection "master"
[0m19:54:12.067534 [debug] [MainThread]: On master: COMMIT
[0m19:54:12.068141 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:54:12.068458 [debug] [MainThread]: On master: Close
[0m19:54:12.069131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:12.069576 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m19:54:12.069851 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m19:54:12.070163 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m19:54:12.070525 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m19:54:12.070789 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m19:54:12.071156 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m19:54:12.071420 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m19:54:12.072001 [info ] [MainThread]: 
[0m19:54:12.072939 [info ] [MainThread]: Finished running 2 incremental models, 9 view models in 0 hours 0 minutes and 7.20 seconds (7.20s).
[0m19:54:12.075833 [debug] [MainThread]: Command end result
[0m19:54:12.140826 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:54:12.143876 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:54:12.150927 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m19:54:12.151310 [info ] [MainThread]: 
[0m19:54:12.151883 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:54:12.152447 [info ] [MainThread]: 
[0m19:54:12.152994 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m19:54:12.154046 [debug] [MainThread]: Command `-c run` succeeded at 19:54:12.153928 after 8.61 seconds
[0m19:54:12.154411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6AB8E630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6EF6FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6EF6F950>]}
[0m19:54:12.154777 [debug] [MainThread]: Flushing usage events
[0m19:54:12.986682 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:40.911195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EBF68050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EC7742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9ECDB7ED0>]}


============================== 20:00:40.915894 | 3a92c765-9639-49e9-a166-1dd31cad5188 ==============================
[0m20:00:40.915894 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:00:40.916626 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'invocation_command': 'dbt test', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m20:00:41.189871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a92c765-9639-49e9-a166-1dd31cad5188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EC120180>]}
[0m20:00:41.261256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a92c765-9639-49e9-a166-1dd31cad5188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9ECC5B790>]}
[0m20:00:41.264135 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:00:41.547755 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:00:41.830792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:00:41.831615 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://tests\TESTING_RESULTS.md
[0m20:00:42.043604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a92c765-9639-49e9-a166-1dd31cad5188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EE70E050>]}
[0m20:00:42.223171 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:00:42.226451 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:00:42.276218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a92c765-9639-49e9-a166-1dd31cad5188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EE343020>]}
[0m20:00:42.276719 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m20:00:42.277295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a92c765-9639-49e9-a166-1dd31cad5188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9ECEEB150>]}
[0m20:00:42.284063 [info ] [MainThread]: 
[0m20:00:42.284639 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:00:42.285074 [info ] [MainThread]: 
[0m20:00:42.285732 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:00:42.292620 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m20:00:42.303037 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m20:00:42.382609 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m20:00:42.382993 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m20:00:42.383303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:42.384124 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:00:42.384463 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m20:00:42.384761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:43.527281 [debug] [ThreadPool]: SQL status: OK in 1.142 seconds
[0m20:00:43.527993 [debug] [ThreadPool]: SQL status: OK in 1.145 seconds
[0m20:00:43.528650 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:00:43.529362 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m20:00:43.530177 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m20:00:43.531005 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m20:00:43.577843 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m20:00:43.578258 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m20:00:43.579911 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m20:00:43.581174 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m20:00:43.582536 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m20:00:43.582860 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m20:00:43.583373 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m20:00:43.583712 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m20:00:43.587335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a92c765-9639-49e9-a166-1dd31cad5188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EE8A17E0>]}
[0m20:00:43.587853 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:43.588181 [debug] [MainThread]: On master: BEGIN
[0m20:00:43.588511 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:43.589769 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:00:43.590157 [debug] [MainThread]: On master: COMMIT
[0m20:00:43.590474 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:43.590771 [debug] [MainThread]: On master: COMMIT
[0m20:00:43.591444 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:00:43.591788 [debug] [MainThread]: On master: Close
[0m20:00:43.598584 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m20:00:43.599081 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m20:00:43.599516 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m20:00:43.600386 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.assert_regime_threshold_ordering
[0m20:00:43.599967 [info ] [Thread-1 (]: 1 of 111 START test accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis  [RUN]
[0m20:00:43.602424 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47'
[0m20:00:43.602830 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m20:00:43.622790 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m20:00:43.600865 [info ] [Thread-2 (]: 2 of 111 START test accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis  [RUN]
[0m20:00:43.623723 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b'
[0m20:00:43.601414 [info ] [Thread-3 (]: 3 of 111 START test accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis  [RUN]
[0m20:00:43.624463 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m20:00:43.625114 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8'
[0m20:00:43.601882 [info ] [Thread-4 (]: 4 of 111 START test assert_regime_threshold_ordering ........................... [RUN]
[0m20:00:43.629938 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m20:00:43.630642 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m20:00:43.631410 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m20:00:43.631966 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.assert_regime_threshold_ordering'
[0m20:00:43.636536 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8"
[0m20:00:43.656504 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m20:00:43.657065 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.assert_regime_threshold_ordering
[0m20:00:43.657796 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m20:00:43.660808 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m20:00:43.663640 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m20:00:43.664930 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m20:00:43.667232 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8"
[0m20:00:43.668105 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.assert_regime_threshold_ordering
[0m20:00:43.673380 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m20:00:43.673936 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m20:00:43.674500 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m20:00:43.675048 [debug] [Thread-1 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: BEGIN
[0m20:00:43.675553 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: BEGIN
[0m20:00:43.676059 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:00:43.676534 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8"
[0m20:00:43.676985 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:00:43.677962 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8: BEGIN
[0m20:00:43.678523 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m20:00:43.679150 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:00:43.679602 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:00:43.680110 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: BEGIN
[0m20:00:43.680539 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:00:43.681015 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m20:00:43.681723 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:00:43.682223 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m20:00:43.682721 [debug] [Thread-1 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regime as value_field,
        count(*) as n_records

    from "finance"."analytics_dev"."int__regime_changes"
    group by regime

)

select *
from all_values
where value_field not in (
    'complacent','normal','elevated','crisis'
)



  
  
      
    ) dbt_internal_test
[0m20:00:43.683450 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:00:43.683941 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regime as value_field,
        count(*) as n_records

    from "finance"."analytics_dev"."int__regime_classification"
    group by regime

)

select *
from all_values
where value_field not in (
    'complacent','normal','elevated','crisis'
)



  
  
      
    ) dbt_internal_test
[0m20:00:43.684668 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:00:43.685120 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8"
[0m20:00:43.685783 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m20:00:43.686246 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regime as value_field,
        count(*) as n_records

    from "finance"."analytics_dev"."mrt__stocks_with_regimes"
    group by regime

)

select *
from all_values
where value_field not in (
    'complacent','normal','elevated','crisis'
)



  
  
      
    ) dbt_internal_test
[0m20:00:43.686810 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.assert_regime_threshold_ordering"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select
    version_id,
    complacent_max,
    normal_max,
    elevated_max
from "finance"."analytics_dev"."regime_thresholds"
where not (complacent_max < normal_max and normal_max < elevated_max)
  
  
      
    ) dbt_internal_test
[0m20:00:43.763559 [debug] [Thread-4 (]: SQL status: OK in 0.076 seconds
[0m20:00:43.764059 [debug] [Thread-3 (]: SQL status: OK in 0.077 seconds
[0m20:00:43.769860 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8: ROLLBACK
[0m20:00:43.771563 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: ROLLBACK
[0m20:00:43.772398 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8'
[0m20:00:43.772857 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8: Close
[0m20:00:43.773507 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.assert_regime_threshold_ordering'
[0m20:00:43.774079 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: Close
[0m20:00:43.775838 [debug] [Thread-2 (]: SQL status: OK in 0.090 seconds
[0m20:00:43.774788 [info ] [Thread-3 (]: 3 of 111 PASS accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis  [[32mPASS[0m in 0.15s]
[0m20:00:43.776732 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m20:00:43.777205 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m20:00:43.779088 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: ROLLBACK
[0m20:00:43.780004 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b'
[0m20:00:43.780454 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: Close
[0m20:00:43.775420 [info ] [Thread-4 (]: 4 of 111 PASS assert_regime_threshold_ordering ................................. [[32mPASS[0m in 0.14s]
[0m20:00:43.781311 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.assert_regime_threshold_ordering
[0m20:00:43.781783 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m20:00:43.777646 [info ] [Thread-3 (]: 5 of 111 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [RUN]
[0m20:00:43.783675 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8, now test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a)
[0m20:00:43.782213 [info ] [Thread-4 (]: 6 of 111 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [RUN]
[0m20:00:43.784455 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m20:00:43.782908 [info ] [Thread-2 (]: 2 of 111 PASS accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis  [[32mPASS[0m in 0.16s]
[0m20:00:43.785301 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.assert_regime_threshold_ordering, now test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2)
[0m20:00:43.802471 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m20:00:43.803411 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m20:00:43.803907 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m20:00:43.804537 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m20:00:43.809348 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m20:00:43.809929 [info ] [Thread-2 (]: 7 of 111 START test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ........... [RUN]
[0m20:00:43.810903 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m20:00:43.811527 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b, now test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a)
[0m20:00:43.813968 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m20:00:43.814512 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m20:00:43.824963 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m20:00:43.825646 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m20:00:43.828604 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m20:00:43.829314 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m20:00:43.829764 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: BEGIN
[0m20:00:43.830161 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:43.830798 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m20:00:43.833185 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m20:00:43.833829 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:00:43.834264 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m20:00:43.834700 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and sma_rsi >= 0 and sma_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m20:00:43.835638 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m20:00:43.836292 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m20:00:43.836962 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: BEGIN
[0m20:00:43.837692 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: BEGIN
[0m20:00:43.838180 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:43.838635 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:43.839758 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:00:43.840184 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m20:00:43.840594 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and wilder_rsi >= 0 and wilder_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m20:00:43.841276 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:00:43.841706 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m20:00:43.842099 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where sma_rs is not null) dbt_subquery

where not(sma_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:43.889085 [debug] [Thread-1 (]: SQL status: OK in 0.205 seconds
[0m20:00:43.891716 [debug] [Thread-1 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: ROLLBACK
[0m20:00:43.892374 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47'
[0m20:00:43.892745 [debug] [Thread-1 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: Close
[0m20:00:43.893737 [info ] [Thread-1 (]: 1 of 111 PASS accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis  [[32mPASS[0m in 0.29s]
[0m20:00:43.894484 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m20:00:43.894909 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m20:00:43.895305 [info ] [Thread-1 (]: 8 of 111 START test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ........ [RUN]
[0m20:00:43.895862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47, now test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0)
[0m20:00:43.896256 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m20:00:43.900415 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m20:00:43.901347 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m20:00:43.903501 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m20:00:43.904900 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m20:00:43.905956 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: BEGIN
[0m20:00:43.906485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:43.907709 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:43.908142 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m20:00:43.908532 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where wilder_rs is not null) dbt_subquery

where not(wilder_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:43.913222 [debug] [Thread-3 (]: SQL status: OK in 0.078 seconds
[0m20:00:43.913675 [debug] [Thread-2 (]: SQL status: OK in 0.071 seconds
[0m20:00:43.914089 [debug] [Thread-4 (]: SQL status: OK in 0.073 seconds
[0m20:00:43.916493 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: ROLLBACK
[0m20:00:43.917829 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: ROLLBACK
[0m20:00:43.918482 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2'
[0m20:00:43.918857 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: Close
[0m20:00:43.919772 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a'
[0m20:00:43.921466 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: ROLLBACK
[0m20:00:43.921989 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: Close
[0m20:00:43.923337 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a'
[0m20:00:43.923754 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: Close
[0m20:00:43.922754 [info ] [Thread-4 (]: 6 of 111 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[32mPASS[0m in 0.14s]
[0m20:00:43.925585 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m20:00:43.924641 [info ] [Thread-2 (]: 7 of 111 PASS dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ................. [[32mPASS[0m in 0.11s]
[0m20:00:43.926835 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m20:00:43.927513 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m20:00:43.926391 [info ] [Thread-3 (]: 5 of 111 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[32mPASS[0m in 0.14s]
[0m20:00:43.928692 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m20:00:43.928226 [info ] [Thread-4 (]: 9 of 111 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m20:00:43.929644 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m20:00:43.930639 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7)
[0m20:00:43.930127 [info ] [Thread-2 (]: 10 of 111 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m20:00:43.931394 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m20:00:43.931859 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m20:00:43.932403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e)
[0m20:00:43.937758 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m20:00:43.932880 [info ] [Thread-3 (]: 11 of 111 START test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [RUN]
[0m20:00:43.938423 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m20:00:43.939057 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd)
[0m20:00:43.944362 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m20:00:43.944943 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m20:00:43.949836 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m20:00:43.950365 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m20:00:43.953357 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m20:00:43.954241 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m20:00:43.955010 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m20:00:43.958119 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m20:00:43.958819 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m20:00:43.962177 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m20:00:43.963061 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m20:00:43.963741 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m20:00:43.965585 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: ROLLBACK
[0m20:00:43.966545 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:43.967897 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0'
[0m20:00:43.969120 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m20:00:43.969826 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: Close
[0m20:00:43.970661 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m20:00:43.971177 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m20:00:43.971737 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:00:43.972169 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:43.973240 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: BEGIN
[0m20:00:43.972795 [info ] [Thread-1 (]: 8 of 111 PASS dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 .............. [[32mPASS[0m in 0.08s]
[0m20:00:43.973874 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m20:00:43.974571 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:43.975304 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m20:00:43.975800 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m20:00:43.976844 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m20:00:43.977508 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:00:43.978279 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:00:43.979486 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m20:00:43.978910 [info ] [Thread-1 (]: 12 of 111 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .. [RUN]
[0m20:00:43.980329 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m20:00:43.981012 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m20:00:43.981578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m20:00:43.982082 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(abs(delta) - (gain + loss)) <= 1e-9)


  
  
      
    ) dbt_internal_test
[0m20:00:43.982806 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m20:00:43.991670 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m20:00:43.992700 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m20:00:43.995284 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m20:00:43.996873 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m20:00:43.997609 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m20:00:43.998319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:44.000000 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:44.000432 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m20:00:44.000810 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:44.053668 [debug] [Thread-2 (]: SQL status: OK in 0.071 seconds
[0m20:00:44.054312 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m20:00:44.054890 [debug] [Thread-3 (]: SQL status: OK in 0.072 seconds
[0m20:00:44.055492 [debug] [Thread-4 (]: SQL status: OK in 0.078 seconds
[0m20:00:44.057026 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m20:00:44.058409 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m20:00:44.059913 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: ROLLBACK
[0m20:00:44.061251 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m20:00:44.061858 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m20:00:44.062616 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m20:00:44.063135 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m20:00:44.063825 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m20:00:44.064386 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd'
[0m20:00:44.064835 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m20:00:44.065382 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m20:00:44.066463 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: Close
[0m20:00:44.065996 [info ] [Thread-2 (]: 10 of 111 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.13s]
[0m20:00:44.067590 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m20:00:44.068058 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m20:00:44.068443 [info ] [Thread-2 (]: 13 of 111 START test dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp  [RUN]
[0m20:00:44.070788 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a)
[0m20:00:44.071213 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m20:00:44.077682 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m20:00:44.068993 [info ] [Thread-3 (]: 11 of 111 PASS dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[32mPASS[0m in 0.13s]
[0m20:00:44.078668 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m20:00:44.079102 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m20:00:44.069527 [info ] [Thread-4 (]: 9 of 111 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.14s]
[0m20:00:44.080471 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m20:00:44.080874 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m20:00:44.070105 [info ] [Thread-1 (]: 12 of 111 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 ........ [[32mPASS[0m in 0.09s]
[0m20:00:44.082120 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m20:00:44.082535 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m20:00:44.083457 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m20:00:44.086551 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m20:00:44.079500 [info ] [Thread-3 (]: 14 of 111 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .. [RUN]
[0m20:00:44.081243 [info ] [Thread-4 (]: 15 of 111 START test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [RUN]
[0m20:00:44.087774 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m20:00:44.088594 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96)
[0m20:00:44.089099 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m20:00:44.082925 [info ] [Thread-1 (]: 16 of 111 START test dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0  [RUN]
[0m20:00:44.089796 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m20:00:44.093771 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m20:00:44.094288 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m20:00:44.094797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4)
[0m20:00:44.104078 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: BEGIN
[0m20:00:44.103009 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m20:00:44.105483 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m20:00:44.106220 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:44.110673 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m20:00:44.111157 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m20:00:44.114137 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m20:00:44.114759 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m20:00:44.115173 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m20:00:44.115580 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m20:00:44.116206 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m20:00:44.118867 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m20:00:44.119737 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m20:00:44.124230 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m20:00:44.124876 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m20:00:44.125289 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m20:00:44.125666 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:44.126535 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m20:00:44.127141 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:00:44.127665 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: BEGIN
[0m20:00:44.128198 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m20:00:44.128602 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m20:00:44.129039 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:44.129482 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: BEGIN
[0m20:00:44.129936 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:44.130599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:44.131386 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:00:44.131806 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m20:00:44.132212 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m20:00:44.132881 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:44.133266 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m20:00:44.133659 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_changes"

where not(days_in_regime >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:44.188183 [debug] [Thread-3 (]: SQL status: OK in 0.057 seconds
[0m20:00:44.188669 [debug] [Thread-2 (]: SQL status: OK in 0.073 seconds
[0m20:00:44.191127 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m20:00:44.192500 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: ROLLBACK
[0m20:00:44.193286 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m20:00:44.193683 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m20:00:44.194290 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a'
[0m20:00:44.194685 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: Close
[0m20:00:44.195272 [info ] [Thread-3 (]: 14 of 111 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 ........ [[32mPASS[0m in 0.11s]
[0m20:00:44.196184 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m20:00:44.197882 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m20:00:44.197114 [info ] [Thread-2 (]: 13 of 111 PASS dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp  [[32mPASS[0m in 0.13s]
[0m20:00:44.198993 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m20:00:44.199417 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m20:00:44.198285 [info ] [Thread-3 (]: 17 of 111 START test dbt_utils_expression_is_true_int__regime_changes_start_date___end_date  [RUN]
[0m20:00:44.200551 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974)
[0m20:00:44.201019 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m20:00:44.199807 [info ] [Thread-2 (]: 18 of 111 START test dbt_utils_expression_is_true_int__regime_classification_close___0  [RUN]
[0m20:00:44.206927 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m20:00:44.207551 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6)
[0m20:00:44.208155 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m20:00:44.208738 [debug] [Thread-4 (]: SQL status: OK in 0.076 seconds
[0m20:00:44.209238 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m20:00:44.214462 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m20:00:44.215947 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: ROLLBACK
[0m20:00:44.217259 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: ROLLBACK
[0m20:00:44.217681 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m20:00:44.218539 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4'
[0m20:00:44.219375 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96'
[0m20:00:44.222398 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m20:00:44.222995 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: Close
[0m20:00:44.223456 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: Close
[0m20:00:44.224044 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m20:00:44.227039 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m20:00:44.227793 [info ] [Thread-1 (]: 16 of 111 PASS dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0  [[32mPASS[0m in 0.13s]
[0m20:00:44.229591 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m20:00:44.230054 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m20:00:44.231185 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m20:00:44.231605 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: BEGIN
[0m20:00:44.231985 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:44.228568 [info ] [Thread-4 (]: 15 of 111 PASS dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[32mPASS[0m in 0.14s]
[0m20:00:44.233201 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m20:00:44.234130 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m20:00:44.230446 [info ] [Thread-1 (]: 19 of 111 START test dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp  [RUN]
[0m20:00:44.234749 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:00:44.235232 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: BEGIN
[0m20:00:44.235792 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m20:00:44.236482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed)
[0m20:00:44.237452 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m20:00:44.238004 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:44.239204 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m20:00:44.238628 [info ] [Thread-4 (]: 20 of 111 START test dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date  [RUN]
[0m20:00:44.240317 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_changes"

where not(start_date <= end_date)


  
  
      
    ) dbt_internal_test
[0m20:00:44.246437 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m20:00:44.247007 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f)
[0m20:00:44.247744 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m20:00:44.248310 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m20:00:44.248796 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m20:00:44.256113 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m20:00:44.256723 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_classification"

where not(close > 0)


  
  
      
    ) dbt_internal_test
[0m20:00:44.258030 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m20:00:44.261383 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m20:00:44.262394 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m20:00:44.265448 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m20:00:44.266276 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m20:00:44.266697 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: BEGIN
[0m20:00:44.267075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:44.267895 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m20:00:44.268362 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: BEGIN
[0m20:00:44.268740 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:44.269644 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:44.270539 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m20:00:44.271111 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:00:44.271586 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_classification"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m20:00:44.272319 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m20:00:44.273287 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_classification"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m20:00:44.319311 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m20:00:44.322050 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: ROLLBACK
[0m20:00:44.322762 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6'
[0m20:00:44.323139 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: Close
[0m20:00:44.323888 [debug] [Thread-3 (]: SQL status: OK in 0.076 seconds
[0m20:00:44.324589 [info ] [Thread-2 (]: 18 of 111 PASS dbt_utils_expression_is_true_int__regime_classification_close___0  [[32mPASS[0m in 0.12s]
[0m20:00:44.326158 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: ROLLBACK
[0m20:00:44.326789 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m20:00:44.327369 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m20:00:44.328318 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974'
[0m20:00:44.328719 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: Close
[0m20:00:44.327777 [info ] [Thread-2 (]: 21 of 111 START test dbt_utils_expression_is_true_int__rsi_sma_gain___0 ........ [RUN]
[0m20:00:44.329429 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6)
[0m20:00:44.329833 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m20:00:44.333829 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m20:00:44.334505 [info ] [Thread-3 (]: 17 of 111 PASS dbt_utils_expression_is_true_int__regime_changes_start_date___end_date  [[32mPASS[0m in 0.13s]
[0m20:00:44.335322 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m20:00:44.335804 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m20:00:44.336233 [info ] [Thread-3 (]: 22 of 111 START test dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp  [RUN]
[0m20:00:44.337174 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772)
[0m20:00:44.337771 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m20:00:44.342322 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m20:00:44.342783 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m20:00:44.345465 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m20:00:44.345974 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m20:00:44.346589 [debug] [Thread-4 (]: SQL status: OK in 0.073 seconds
[0m20:00:44.347534 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m20:00:44.347923 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: BEGIN
[0m20:00:44.348282 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:44.349811 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: ROLLBACK
[0m20:00:44.350472 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed'
[0m20:00:44.350848 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: Close
[0m20:00:44.352639 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: ROLLBACK
[0m20:00:44.353402 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m20:00:44.354504 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:00:44.354106 [info ] [Thread-1 (]: 19 of 111 PASS dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp  [[32mPASS[0m in 0.12s]
[0m20:00:44.355392 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f'
[0m20:00:44.357832 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m20:00:44.358334 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m20:00:44.359005 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m20:00:44.359458 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: Close
[0m20:00:44.360063 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:44.360621 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m20:00:44.362566 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m20:00:44.361482 [info ] [Thread-1 (]: 23 of 111 START test dbt_utils_expression_is_true_int__rsi_sma_loss___0 ........ [RUN]
[0m20:00:44.363167 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: BEGIN
[0m20:00:44.363730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62)
[0m20:00:44.362098 [info ] [Thread-4 (]: 20 of 111 PASS dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date  [[32mPASS[0m in 0.12s]
[0m20:00:44.364355 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:44.364828 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m20:00:44.365490 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m20:00:44.371246 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m20:00:44.371802 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m20:00:44.372486 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m20:00:44.372994 [info ] [Thread-4 (]: 24 of 111 START test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [RUN]
[0m20:00:44.373592 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m20:00:44.374388 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704)
[0m20:00:44.375257 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m20:00:44.375804 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m20:00:44.376226 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m20:00:44.378915 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m20:00:44.383581 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m20:00:44.385014 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m20:00:44.385444 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: BEGIN
[0m20:00:44.385821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:44.386496 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m20:00:44.392226 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m20:00:44.393029 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:00:44.393490 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m20:00:44.393881 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:44.394827 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m20:00:44.395259 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: BEGIN
[0m20:00:44.395645 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:44.396889 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:00:44.397289 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m20:00:44.397776 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m20:00:44.435153 [debug] [Thread-2 (]: SQL status: OK in 0.074 seconds
[0m20:00:44.437537 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: ROLLBACK
[0m20:00:44.438236 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6'
[0m20:00:44.438602 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: Close
[0m20:00:44.439542 [info ] [Thread-2 (]: 21 of 111 PASS dbt_utils_expression_is_true_int__rsi_sma_gain___0 .............. [[32mPASS[0m in 0.11s]
[0m20:00:44.440366 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m20:00:44.440826 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m20:00:44.441216 [info ] [Thread-2 (]: 25 of 111 START test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 .... [RUN]
[0m20:00:44.441803 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9)
[0m20:00:44.442192 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m20:00:44.446311 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m20:00:44.447273 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m20:00:44.449665 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m20:00:44.450577 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m20:00:44.451020 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: BEGIN
[0m20:00:44.451413 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:44.452020 [debug] [Thread-3 (]: SQL status: OK in 0.075 seconds
[0m20:00:44.452682 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:00:44.453121 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m20:00:44.453532 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:44.455167 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: ROLLBACK
[0m20:00:44.455824 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772'
[0m20:00:44.456183 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: Close
[0m20:00:44.457099 [info ] [Thread-3 (]: 22 of 111 PASS dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp  [[32mPASS[0m in 0.12s]
[0m20:00:44.457892 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m20:00:44.458329 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m20:00:44.458712 [info ] [Thread-3 (]: 26 of 111 START test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 .... [RUN]
[0m20:00:44.459335 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21)
[0m20:00:44.459874 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m20:00:44.464022 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m20:00:44.464999 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m20:00:44.467469 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m20:00:44.468381 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m20:00:44.468755 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: BEGIN
[0m20:00:44.469099 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:44.470388 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:00:44.470805 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m20:00:44.471200 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:44.479117 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m20:00:44.479668 [debug] [Thread-4 (]: SQL status: OK in 0.081 seconds
[0m20:00:44.482108 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: ROLLBACK
[0m20:00:44.483478 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: ROLLBACK
[0m20:00:44.484114 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704'
[0m20:00:44.484491 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: Close
[0m20:00:44.485036 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62'
[0m20:00:44.485421 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: Close
[0m20:00:44.486084 [info ] [Thread-4 (]: 24 of 111 PASS dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[32mPASS[0m in 0.11s]
[0m20:00:44.487435 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m20:00:44.487873 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m20:00:44.486662 [info ] [Thread-1 (]: 23 of 111 PASS dbt_utils_expression_is_true_int__rsi_sma_loss___0 .............. [[32mPASS[0m in 0.12s]
[0m20:00:44.488951 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m20:00:44.489355 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m20:00:44.488271 [info ] [Thread-4 (]: 27 of 111 START test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ..... [RUN]
[0m20:00:44.490476 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90)
[0m20:00:44.490878 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m20:00:44.495025 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m20:00:44.489737 [info ] [Thread-1 (]: 28 of 111 START test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ..... [RUN]
[0m20:00:44.495865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703)
[0m20:00:44.496360 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m20:00:44.500041 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m20:00:44.503093 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m20:00:44.505781 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m20:00:44.506506 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m20:00:44.510001 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m20:00:44.510992 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m20:00:44.511409 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: BEGIN
[0m20:00:44.511770 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:44.512664 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m20:00:44.513200 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: BEGIN
[0m20:00:44.513585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:44.514248 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:00:44.514779 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m20:00:44.515163 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:44.515719 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:44.516122 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m20:00:44.516516 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:44.524730 [debug] [Thread-2 (]: SQL status: OK in 0.071 seconds
[0m20:00:44.528428 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: ROLLBACK
[0m20:00:44.529173 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9'
[0m20:00:44.529567 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: Close
[0m20:00:44.530564 [info ] [Thread-2 (]: 25 of 111 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 .......... [[32mPASS[0m in 0.09s]
[0m20:00:44.531481 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m20:00:44.531920 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m20:00:44.532415 [info ] [Thread-2 (]: 29 of 111 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [RUN]
[0m20:00:44.533104 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7)
[0m20:00:44.533525 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m20:00:44.538547 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m20:00:44.539938 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m20:00:44.542305 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m20:00:44.543286 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m20:00:44.543675 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: BEGIN
[0m20:00:44.544030 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:44.545277 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:00:44.545679 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m20:00:44.546051 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:44.558601 [debug] [Thread-3 (]: SQL status: OK in 0.087 seconds
[0m20:00:44.561758 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: ROLLBACK
[0m20:00:44.562498 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21'
[0m20:00:44.562876 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: Close
[0m20:00:44.563834 [info ] [Thread-3 (]: 26 of 111 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 .......... [[32mPASS[0m in 0.10s]
[0m20:00:44.564680 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m20:00:44.565154 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m20:00:44.565566 [info ] [Thread-3 (]: 30 of 111 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [RUN]
[0m20:00:44.566246 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d)
[0m20:00:44.566717 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m20:00:44.571754 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m20:00:44.572965 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m20:00:44.575683 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m20:00:44.576758 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m20:00:44.577163 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: BEGIN
[0m20:00:44.577515 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:44.578951 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:00:44.579442 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m20:00:44.579846 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:45.810547 [debug] [Thread-1 (]: SQL status: OK in 1.293 seconds
[0m20:00:45.815321 [debug] [Thread-2 (]: SQL status: OK in 1.268 seconds
[0m20:00:45.817244 [debug] [Thread-4 (]: SQL status: OK in 1.301 seconds
[0m20:00:45.822930 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: ROLLBACK
[0m20:00:45.827094 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703'
[0m20:00:45.828832 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: ROLLBACK
[0m20:00:45.829332 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: Close
[0m20:00:45.830957 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: ROLLBACK
[0m20:00:45.831926 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7'
[0m20:00:45.832608 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: Close
[0m20:00:45.833318 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90'
[0m20:00:45.835343 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: Close
[0m20:00:45.834089 [info ] [Thread-1 (]: 28 of 111 PASS dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ........... [[32mPASS[0m in 1.34s]
[0m20:00:45.836563 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m20:00:45.834778 [info ] [Thread-2 (]: 29 of 111 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0 .... [[32mPASS[0m in 1.30s]
[0m20:00:45.837301 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m20:00:45.838754 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m20:00:45.837991 [info ] [Thread-4 (]: 27 of 111 PASS dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ........... [[32mPASS[0m in 1.35s]
[0m20:00:45.839892 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m20:00:45.840620 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m20:00:45.839409 [info ] [Thread-1 (]: 31 of 111 START test dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0  [RUN]
[0m20:00:45.841849 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m20:00:45.842544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703, now test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b)
[0m20:00:45.841209 [info ] [Thread-2 (]: 32 of 111 START test dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date  [RUN]
[0m20:00:45.843657 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m20:00:45.844262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7, now test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf)
[0m20:00:45.848402 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b"
[0m20:00:45.843083 [info ] [Thread-4 (]: 33 of 111 START test dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0  [RUN]
[0m20:00:45.849038 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m20:00:45.849627 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90, now test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe)
[0m20:00:45.854059 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf"
[0m20:00:45.854557 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m20:00:45.858775 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe"
[0m20:00:45.859372 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m20:00:45.862380 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b"
[0m20:00:45.863083 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m20:00:45.865598 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf"
[0m20:00:45.866333 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m20:00:45.868455 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe"
[0m20:00:45.869110 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b"
[0m20:00:45.869529 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b: BEGIN
[0m20:00:45.869903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:45.870755 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf"
[0m20:00:45.871265 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf: BEGIN
[0m20:00:45.871617 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:45.872205 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe"
[0m20:00:45.872607 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe: BEGIN
[0m20:00:45.872977 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:45.873522 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:00:45.873927 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b"
[0m20:00:45.874321 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."mrt__stocks_with_regimes"

where not(open >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:45.874971 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:00:45.875368 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf"
[0m20:00:45.875771 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."mrt__stocks_with_regimes"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m20:00:45.876336 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:00:45.876788 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe"
[0m20:00:45.877390 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."mrt__stocks_with_regimes"

where not(volume >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:46.026908 [debug] [Thread-3 (]: SQL status: OK in 1.446 seconds
[0m20:00:46.029539 [debug] [Thread-1 (]: SQL status: OK in 0.154 seconds
[0m20:00:46.032157 [debug] [Thread-4 (]: SQL status: OK in 0.154 seconds
[0m20:00:46.034260 [debug] [Thread-2 (]: SQL status: OK in 0.158 seconds
[0m20:00:46.039907 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: ROLLBACK
[0m20:00:46.043109 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe: ROLLBACK
[0m20:00:46.046203 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b: ROLLBACK
[0m20:00:46.049125 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf: ROLLBACK
[0m20:00:46.050080 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d'
[0m20:00:46.051223 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe'
[0m20:00:46.052172 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b'
[0m20:00:46.052852 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: Close
[0m20:00:46.053515 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf'
[0m20:00:46.054041 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe: Close
[0m20:00:46.054551 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b: Close
[0m20:00:46.055240 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf: Close
[0m20:00:46.056176 [info ] [Thread-3 (]: 30 of 111 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0 .... [[32mPASS[0m in 1.49s]
[0m20:00:46.057323 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m20:00:46.059053 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m20:00:46.057953 [info ] [Thread-1 (]: 31 of 111 PASS dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0 .. [[32mPASS[0m in 0.22s]
[0m20:00:46.061404 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m20:00:46.058630 [info ] [Thread-2 (]: 32 of 111 PASS dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date  [[32mPASS[0m in 0.21s]
[0m20:00:46.062175 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m20:00:46.062981 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m20:00:46.060111 [info ] [Thread-4 (]: 33 of 111 PASS dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0  [[32mPASS[0m in 0.21s]
[0m20:00:46.064461 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m20:00:46.060507 [info ] [Thread-3 (]: 34 of 111 START test dbt_utils_expression_is_true_stg__stocks_close___0 ........ [RUN]
[0m20:00:46.065750 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m20:00:46.063830 [info ] [Thread-1 (]: 35 of 111 START test dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high  [RUN]
[0m20:00:46.066921 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c)
[0m20:00:46.067373 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m20:00:46.067903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338)
[0m20:00:46.066370 [info ] [Thread-2 (]: 36 of 111 START test dbt_utils_expression_is_true_stg__stocks_high___0 ......... [RUN]
[0m20:00:46.068816 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m20:00:46.070143 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m20:00:46.069591 [info ] [Thread-4 (]: 37 of 111 START test dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp  [RUN]
[0m20:00:46.070774 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c)
[0m20:00:46.075349 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m20:00:46.081352 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m20:00:46.082051 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa)
[0m20:00:46.082495 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m20:00:46.083118 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m20:00:46.091001 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m20:00:46.095499 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m20:00:46.096429 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m20:00:46.097126 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m20:00:46.099958 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m20:00:46.102703 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m20:00:46.103438 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m20:00:46.104144 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m20:00:46.106947 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m20:00:46.109320 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m20:00:46.110432 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m20:00:46.110987 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: BEGIN
[0m20:00:46.111409 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:46.112131 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m20:00:46.112644 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: BEGIN
[0m20:00:46.113103 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m20:00:46.113503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:46.113959 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:00:46.114468 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: BEGIN
[0m20:00:46.115317 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m20:00:46.115843 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m20:00:46.116348 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:46.116744 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:00:46.117096 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: BEGIN
[0m20:00:46.117510 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(close >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:46.118150 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m20:00:46.118809 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:46.119582 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:00:46.120113 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(close >= low and close <= high)


  
  
      
    ) dbt_internal_test
[0m20:00:46.120977 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m20:00:46.121841 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m20:00:46.122469 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:00:46.123276 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m20:00:46.123916 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(high >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:46.185422 [debug] [Thread-3 (]: SQL status: OK in 0.066 seconds
[0m20:00:46.186448 [debug] [Thread-4 (]: SQL status: OK in 0.063 seconds
[0m20:00:46.187092 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m20:00:46.187937 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m20:00:46.190366 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: ROLLBACK
[0m20:00:46.192426 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: ROLLBACK
[0m20:00:46.193847 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c'
[0m20:00:46.194717 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa'
[0m20:00:46.195320 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: Close
[0m20:00:46.197845 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: ROLLBACK
[0m20:00:46.198453 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: Close
[0m20:00:46.200451 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: ROLLBACK
[0m20:00:46.201972 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338'
[0m20:00:46.202992 [info ] [Thread-3 (]: 34 of 111 PASS dbt_utils_expression_is_true_stg__stocks_close___0 .............. [[32mPASS[0m in 0.14s]
[0m20:00:46.205065 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c'
[0m20:00:46.205768 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: Close
[0m20:00:46.203912 [info ] [Thread-4 (]: 37 of 111 PASS dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp  [[32mPASS[0m in 0.12s]
[0m20:00:46.206884 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m20:00:46.207498 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: Close
[0m20:00:46.208861 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m20:00:46.210463 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m20:00:46.209743 [info ] [Thread-1 (]: 35 of 111 PASS dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high  [[32mPASS[0m in 0.14s]
[0m20:00:46.212285 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m20:00:46.214053 [info ] [Thread-3 (]: 38 of 111 START test dbt_utils_expression_is_true_stg__stocks_low___0 .......... [RUN]
[0m20:00:46.216730 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m20:00:46.215128 [info ] [Thread-2 (]: 36 of 111 PASS dbt_utils_expression_is_true_stg__stocks_high___0 ............... [[32mPASS[0m in 0.14s]
[0m20:00:46.218752 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99)
[0m20:00:46.217839 [info ] [Thread-4 (]: 39 of 111 START test dbt_utils_expression_is_true_stg__stocks_open___0 ......... [RUN]
[0m20:00:46.219718 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m20:00:46.220549 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m20:00:46.221238 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m20:00:46.222011 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec)
[0m20:00:46.223095 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m20:00:46.222577 [info ] [Thread-1 (]: 40 of 111 START test dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high  [RUN]
[0m20:00:46.227632 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m20:00:46.228345 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m20:00:46.230169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8)
[0m20:00:46.228772 [info ] [Thread-2 (]: 41 of 111 START test dbt_utils_expression_is_true_stg__stocks_trade_date___current_date  [RUN]
[0m20:00:46.234574 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m20:00:46.235098 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m20:00:46.235690 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4)
[0m20:00:46.241175 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m20:00:46.241556 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m20:00:46.242112 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m20:00:46.245024 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m20:00:46.251020 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m20:00:46.251629 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m20:00:46.255106 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m20:00:46.255667 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m20:00:46.262233 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m20:00:46.262881 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m20:00:46.263776 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: BEGIN
[0m20:00:46.264679 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:46.265972 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m20:00:46.266840 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m20:00:46.270622 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m20:00:46.271271 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: BEGIN
[0m20:00:46.271752 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m20:00:46.272120 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m20:00:46.272583 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:46.273126 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: BEGIN
[0m20:00:46.273552 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m20:00:46.274337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:46.274908 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m20:00:46.275307 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(low >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:46.275920 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:00:46.276384 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: BEGIN
[0m20:00:46.276983 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:00:46.277386 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m20:00:46.277914 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:46.278556 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m20:00:46.279144 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(open >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:46.279827 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(open >= low and open <= high)


  
  
      
    ) dbt_internal_test
[0m20:00:46.280769 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:00:46.281286 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m20:00:46.281660 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m20:00:46.344508 [debug] [Thread-4 (]: SQL status: OK in 0.064 seconds
[0m20:00:46.344986 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m20:00:46.345488 [debug] [Thread-3 (]: SQL status: OK in 0.069 seconds
[0m20:00:46.348030 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: ROLLBACK
[0m20:00:46.349380 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: ROLLBACK
[0m20:00:46.350732 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: ROLLBACK
[0m20:00:46.351432 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99'
[0m20:00:46.352192 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8'
[0m20:00:46.352806 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: Close
[0m20:00:46.353564 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec'
[0m20:00:46.353952 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: Close
[0m20:00:46.354497 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: Close
[0m20:00:46.355235 [info ] [Thread-3 (]: 38 of 111 PASS dbt_utils_expression_is_true_stg__stocks_low___0 ................ [[32mPASS[0m in 0.14s]
[0m20:00:46.356250 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m20:00:46.357744 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m20:00:46.356811 [info ] [Thread-4 (]: 39 of 111 PASS dbt_utils_expression_is_true_stg__stocks_open___0 ............... [[32mPASS[0m in 0.13s]
[0m20:00:46.358974 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m20:00:46.357368 [info ] [Thread-1 (]: 40 of 111 PASS dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high . [[32mPASS[0m in 0.13s]
[0m20:00:46.359524 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m20:00:46.358328 [info ] [Thread-3 (]: 42 of 111 START test dbt_utils_expression_is_true_stg__stocks_volume___0 ....... [RUN]
[0m20:00:46.360605 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m20:00:46.361958 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e)
[0m20:00:46.361340 [info ] [Thread-4 (]: 43 of 111 START test dbt_utils_expression_is_true_stg__vix_with_versions_close___0  [RUN]
[0m20:00:46.363016 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m20:00:46.363806 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m20:00:46.364604 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd)
[0m20:00:46.370447 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m20:00:46.365194 [info ] [Thread-1 (]: 44 of 111 START test dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max  [RUN]
[0m20:00:46.371211 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m20:00:46.371593 [debug] [Thread-2 (]: SQL status: OK in 0.090 seconds
[0m20:00:46.372191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929)
[0m20:00:46.377421 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m20:00:46.378267 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m20:00:46.384093 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m20:00:46.384628 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m20:00:46.386287 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: ROLLBACK
[0m20:00:46.389159 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m20:00:46.390251 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4'
[0m20:00:46.390997 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m20:00:46.391647 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m20:00:46.392230 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: Close
[0m20:00:46.394838 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m20:00:46.396932 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m20:00:46.397724 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m20:00:46.398637 [info ] [Thread-2 (]: 41 of 111 PASS dbt_utils_expression_is_true_stg__stocks_trade_date___current_date  [[32mPASS[0m in 0.16s]
[0m20:00:46.399541 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: BEGIN
[0m20:00:46.400620 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m20:00:46.401458 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:46.402255 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m20:00:46.402999 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m20:00:46.403731 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m20:00:46.404826 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: BEGIN
[0m20:00:46.405368 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: BEGIN
[0m20:00:46.404376 [info ] [Thread-2 (]: 45 of 111 START test dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp  [RUN]
[0m20:00:46.405951 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:46.406406 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:00:46.406783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:46.407216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17)
[0m20:00:46.407857 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m20:00:46.408673 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m20:00:46.409116 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:00:46.409591 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(volume >= 0)


  
  
      
    ) dbt_internal_test
[0m20:00:46.414825 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:00:46.420347 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m20:00:46.420852 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m20:00:46.421561 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m20:00:46.422495 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(close > 0)


  
  
      
    ) dbt_internal_test
[0m20:00:46.423256 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(complacent_max < normal_max AND  normal_max < elevated_max)


  
  
      
    ) dbt_internal_test
[0m20:00:46.424538 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m20:00:46.428382 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m20:00:46.429708 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m20:00:46.430379 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: BEGIN
[0m20:00:46.430823 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:46.432290 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:00:46.432662 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m20:00:46.433109 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m20:00:46.479861 [debug] [Thread-3 (]: SQL status: OK in 0.059 seconds
[0m20:00:46.482300 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: ROLLBACK
[0m20:00:46.483231 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e'
[0m20:00:46.483861 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: Close
[0m20:00:46.484393 [debug] [Thread-2 (]: SQL status: OK in 0.051 seconds
[0m20:00:46.484921 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m20:00:46.486362 [debug] [Thread-4 (]: SQL status: OK in 0.062 seconds
[0m20:00:46.485796 [info ] [Thread-3 (]: 42 of 111 PASS dbt_utils_expression_is_true_stg__stocks_volume___0 ............. [[32mPASS[0m in 0.12s]
[0m20:00:46.487677 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m20:00:46.488348 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m20:00:46.490035 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: ROLLBACK
[0m20:00:46.491612 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: ROLLBACK
[0m20:00:46.493223 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: ROLLBACK
[0m20:00:46.493787 [info ] [Thread-3 (]: 46 of 111 START test dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date  [RUN]
[0m20:00:46.494875 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17'
[0m20:00:46.495426 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd'
[0m20:00:46.496018 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00)
[0m20:00:46.496572 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929'
[0m20:00:46.496979 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: Close
[0m20:00:46.497364 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: Close
[0m20:00:46.497757 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m20:00:46.498143 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: Close
[0m20:00:46.503747 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m20:00:46.504678 [info ] [Thread-2 (]: 45 of 111 PASS dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp  [[32mPASS[0m in 0.10s]
[0m20:00:46.507330 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m20:00:46.505542 [info ] [Thread-4 (]: 43 of 111 PASS dbt_utils_expression_is_true_stg__vix_with_versions_close___0 ... [[32mPASS[0m in 0.14s]
[0m20:00:46.508035 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m20:00:46.508917 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m20:00:46.506361 [info ] [Thread-1 (]: 44 of 111 PASS dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max  [[32mPASS[0m in 0.13s]
[0m20:00:46.509986 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m20:00:46.510783 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m20:00:46.509497 [info ] [Thread-2 (]: 47 of 111 START test dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1  [RUN]
[0m20:00:46.511499 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m20:00:46.512287 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m20:00:46.511873 [info ] [Thread-4 (]: 48 of 111 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m20:00:46.513041 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93)
[0m20:00:46.515570 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m20:00:46.516441 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m20:00:46.516012 [info ] [Thread-1 (]: 49 of 111 START test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [RUN]
[0m20:00:46.517067 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m20:00:46.517596 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m20:00:46.518131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08)
[0m20:00:46.525089 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m20:00:46.535203 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m20:00:46.535830 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m20:00:46.536313 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m20:00:46.542098 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m20:00:46.542606 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: BEGIN
[0m20:00:46.543381 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m20:00:46.544024 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:46.544592 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m20:00:46.547124 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m20:00:46.550142 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m20:00:46.550779 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m20:00:46.551490 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m20:00:46.553759 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m20:00:46.554304 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m20:00:46.555211 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m20:00:46.556038 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m20:00:46.556956 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m20:00:46.558001 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m20:00:46.558756 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m20:00:46.559521 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:46.560092 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: BEGIN
[0m20:00:46.560766 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: BEGIN
[0m20:00:46.561405 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:46.561997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:46.562608 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:00:46.563329 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m20:00:46.563834 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:46.564385 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m20:00:46.564805 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:00:46.565165 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m20:00:46.565846 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m20:00:46.566440 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(version_rank >= 1)


  
  
      
    ) dbt_internal_test
[0m20:00:46.566994 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_sma"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m20:00:46.609269 [debug] [Thread-3 (]: SQL status: OK in 0.050 seconds
[0m20:00:46.611647 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: ROLLBACK
[0m20:00:46.612299 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00'
[0m20:00:46.612661 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: Close
[0m20:00:46.613634 [info ] [Thread-3 (]: 46 of 111 PASS dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date  [[32mPASS[0m in 0.12s]
[0m20:00:46.614465 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m20:00:46.614872 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m20:00:46.615409 [info ] [Thread-3 (]: 50 of 111 START test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [RUN]
[0m20:00:46.616055 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95)
[0m20:00:46.616432 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m20:00:46.620887 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m20:00:46.622283 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m20:00:46.625148 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m20:00:46.626451 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m20:00:46.627195 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: BEGIN
[0m20:00:46.627781 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:46.629462 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:00:46.630044 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m20:00:46.630510 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_wilder"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m20:00:46.639266 [debug] [Thread-2 (]: SQL status: OK in 0.072 seconds
[0m20:00:46.640062 [debug] [Thread-4 (]: SQL status: OK in 0.074 seconds
[0m20:00:46.642254 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: ROLLBACK
[0m20:00:46.644552 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m20:00:46.645485 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93'
[0m20:00:46.646188 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m20:00:46.646780 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m20:00:46.647316 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: Close
[0m20:00:46.647922 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m20:00:46.649167 [info ] [Thread-2 (]: 47 of 111 PASS dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1  [[32mPASS[0m in 0.14s]
[0m20:00:46.650849 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m20:00:46.651368 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m20:00:46.650020 [info ] [Thread-4 (]: 48 of 111 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.13s]
[0m20:00:46.654970 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: ROLLBACK
[0m20:00:46.652384 [info ] [Thread-2 (]: 51 of 111 START test dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker  [RUN]
[0m20:00:46.655974 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m20:00:46.656540 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de)
[0m20:00:46.657085 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08'
[0m20:00:46.657632 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m20:00:46.658089 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m20:00:46.658494 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: Close
[0m20:00:46.664109 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de"
[0m20:00:46.658897 [info ] [Thread-4 (]: 52 of 111 START test dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker  [RUN]
[0m20:00:46.664957 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91)
[0m20:00:46.665986 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m20:00:46.665521 [info ] [Thread-1 (]: 49 of 111 PASS dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn . [[32mPASS[0m in 0.15s]
[0m20:00:46.672478 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m20:00:46.673621 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m20:00:46.674321 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m20:00:46.675034 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m20:00:46.678033 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de"
[0m20:00:46.678500 [info ] [Thread-1 (]: 53 of 111 START test dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id  [RUN]
[0m20:00:46.679272 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m20:00:46.679954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e)
[0m20:00:46.682665 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m20:00:46.683245 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m20:00:46.684046 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de"
[0m20:00:46.689031 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m20:00:46.689670 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de: BEGIN
[0m20:00:46.690563 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:46.691984 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m20:00:46.692698 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m20:00:46.693237 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: BEGIN
[0m20:00:46.693745 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:00:46.696289 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m20:00:46.696686 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:46.697084 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de"
[0m20:00:46.697996 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        trade_date, ticker
    from "finance"."analytics_dev"."mrt__stocks_with_regimes"
    group by trade_date, ticker
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m20:00:46.699285 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m20:00:46.700082 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:00:46.700748 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: BEGIN
[0m20:00:46.701486 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m20:00:46.702072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:46.702616 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        trade_date, ticker
    from "finance"."analytics_dev"."stg__stocks"
    group by trade_date, ticker
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m20:00:46.704335 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:46.704983 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m20:00:46.705638 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        trade_date, version_id
    from "finance"."analytics_dev"."stg__vix_with_versions"
    group by trade_date, version_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m20:00:46.748684 [debug] [Thread-2 (]: SQL status: OK in 0.050 seconds
[0m20:00:46.752643 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de: ROLLBACK
[0m20:00:46.754284 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de'
[0m20:00:46.755125 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de: Close
[0m20:00:46.756755 [info ] [Thread-2 (]: 51 of 111 PASS dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker  [[32mPASS[0m in 0.10s]
[0m20:00:46.757784 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m20:00:46.758200 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m20:00:46.758680 [info ] [Thread-2 (]: 54 of 111 START test not_null_int__price_changes_close ......................... [RUN]
[0m20:00:46.759348 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m20:00:46.759725 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m20:00:46.768316 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m20:00:46.769090 [debug] [Thread-4 (]: SQL status: OK in 0.066 seconds
[0m20:00:46.770082 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m20:00:46.772819 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m20:00:46.774164 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: ROLLBACK
[0m20:00:46.774901 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91'
[0m20:00:46.775313 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: Close
[0m20:00:46.776214 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m20:00:46.777290 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m20:00:46.777809 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:46.778466 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m20:00:46.776899 [info ] [Thread-4 (]: 52 of 111 PASS dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker  [[32mPASS[0m in 0.11s]
[0m20:00:46.779430 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m20:00:46.780058 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m20:00:46.780591 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:00:46.786976 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: ROLLBACK
[0m20:00:46.787945 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m20:00:46.783884 [info ] [Thread-4 (]: 55 of 111 START test not_null_int__price_changes_gain .......................... [RUN]
[0m20:00:46.789229 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m20:00:46.790428 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e'
[0m20:00:46.791294 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m20:00:46.792417 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: Close
[0m20:00:46.793306 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m20:00:46.811179 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m20:00:46.807155 [info ] [Thread-1 (]: 53 of 111 PASS dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id  [[32mPASS[0m in 0.13s]
[0m20:00:46.812673 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m20:00:46.813632 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m20:00:46.815684 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m20:00:46.814616 [info ] [Thread-1 (]: 56 of 111 START test not_null_int__price_changes_loaded_at ..................... [RUN]
[0m20:00:46.822665 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m20:00:46.823704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m20:00:46.824915 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m20:00:46.832851 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m20:00:46.834170 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m20:00:46.835172 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m20:00:46.836013 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:46.836804 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m20:00:46.842232 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m20:00:46.843152 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m20:00:46.843827 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m20:00:46.844426 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m20:00:46.845500 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m20:00:46.846307 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m20:00:46.847077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:46.849747 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:00:46.850573 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m20:00:46.852266 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.048775 [debug] [Thread-1 (]: SQL status: OK in 0.195 seconds
[0m20:00:47.049222 [debug] [Thread-4 (]: SQL status: OK in 0.204 seconds
[0m20:00:47.049694 [debug] [Thread-2 (]: SQL status: OK in 0.258 seconds
[0m20:00:47.052205 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m20:00:47.053585 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m20:00:47.054895 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m20:00:47.055469 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m20:00:47.056013 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m20:00:47.056536 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m20:00:47.057018 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m20:00:47.057507 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m20:00:47.058591 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m20:00:47.058206 [info ] [Thread-1 (]: 56 of 111 PASS not_null_int__price_changes_loaded_at ........................... [[32mPASS[0m in 0.23s]
[0m20:00:47.059671 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m20:00:47.061083 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m20:00:47.060193 [info ] [Thread-4 (]: 55 of 111 PASS not_null_int__price_changes_gain ................................ [[32mPASS[0m in 0.27s]
[0m20:00:47.062263 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m20:00:47.060736 [info ] [Thread-2 (]: 54 of 111 PASS not_null_int__price_changes_close ............................... [[32mPASS[0m in 0.30s]
[0m20:00:47.062810 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m20:00:47.063590 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m20:00:47.061627 [info ] [Thread-1 (]: 57 of 111 START test not_null_int__price_changes_loss .......................... [RUN]
[0m20:00:47.064948 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m20:00:47.065780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m20:00:47.064151 [info ] [Thread-4 (]: 58 of 111 START test not_null_int__price_changes_rn ............................ [RUN]
[0m20:00:47.067199 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m20:00:47.066550 [info ] [Thread-2 (]: 59 of 111 START test not_null_int__price_changes_ticker ........................ [RUN]
[0m20:00:47.067955 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m20:00:47.072611 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m20:00:47.073098 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m20:00:47.073503 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m20:00:47.073993 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m20:00:47.078043 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m20:00:47.081362 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m20:00:47.082224 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m20:00:47.087809 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m20:00:47.089276 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m20:00:47.089884 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m20:00:47.090249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:47.091749 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:00:47.092132 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m20:00:47.092503 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.096846 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m20:00:47.100243 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m20:00:47.100835 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m20:00:47.104423 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m20:00:47.105975 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m20:00:47.106643 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m20:00:47.107239 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:47.108135 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m20:00:47.108563 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m20:00:47.109023 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:47.109393 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:00:47.109969 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m20:00:47.110577 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.111179 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:47.111760 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m20:00:47.112363 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.181018 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m20:00:47.181818 [debug] [Thread-4 (]: SQL status: OK in 0.071 seconds
[0m20:00:47.182448 [debug] [Thread-2 (]: SQL status: OK in 0.069 seconds
[0m20:00:47.185995 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m20:00:47.187435 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m20:00:47.188007 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m20:00:47.189299 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m20:00:47.189826 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m20:00:47.190186 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m20:00:47.190658 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m20:00:47.191136 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m20:00:47.191862 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m20:00:47.192559 [info ] [Thread-4 (]: 58 of 111 PASS not_null_int__price_changes_rn .................................. [[32mPASS[0m in 0.12s]
[0m20:00:47.194251 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m20:00:47.193085 [info ] [Thread-1 (]: 57 of 111 PASS not_null_int__price_changes_loss ................................ [[32mPASS[0m in 0.13s]
[0m20:00:47.194778 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m20:00:47.195501 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m20:00:47.193526 [info ] [Thread-2 (]: 59 of 111 PASS not_null_int__price_changes_ticker .............................. [[32mPASS[0m in 0.12s]
[0m20:00:47.196428 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m20:00:47.196005 [info ] [Thread-4 (]: 60 of 111 START test not_null_int__price_changes_trade_date .................... [RUN]
[0m20:00:47.197131 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m20:00:47.197940 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m20:00:47.197515 [info ] [Thread-1 (]: 61 of 111 START test not_null_int__regime_changes_days_in_regime ............... [RUN]
[0m20:00:47.198720 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m20:00:47.199382 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m20:00:47.199930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa, now test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0)
[0m20:00:47.205420 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m20:00:47.200611 [info ] [Thread-2 (]: 62 of 111 START test not_null_int__regime_changes_end_date ..................... [RUN]
[0m20:00:47.205990 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m20:00:47.206551 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a, now test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755)
[0m20:00:47.210402 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m20:00:47.210860 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m20:00:47.215635 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m20:00:47.216396 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m20:00:47.221096 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m20:00:47.222182 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m20:00:47.222802 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m20:00:47.225489 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m20:00:47.227760 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m20:00:47.228686 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m20:00:47.229301 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m20:00:47.229767 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:47.230751 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m20:00:47.231389 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: BEGIN
[0m20:00:47.231832 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:00:47.232345 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m20:00:47.233168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:47.234330 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m20:00:47.235592 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: BEGIN
[0m20:00:47.236789 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.237720 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:47.238708 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:00:47.239650 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m20:00:47.240243 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select days_in_regime
from "finance"."analytics_dev"."int__regime_changes"
where days_in_regime is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.240883 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:00:47.241469 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m20:00:47.242094 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select end_date
from "finance"."analytics_dev"."int__regime_changes"
where end_date is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.242905 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:00:47.245084 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m20:00:47.245804 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m20:00:47.246173 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m20:00:47.246931 [info ] [Thread-4 (]: 60 of 111 PASS not_null_int__price_changes_trade_date .......................... [[32mPASS[0m in 0.05s]
[0m20:00:47.247860 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m20:00:47.248486 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m20:00:47.249232 [info ] [Thread-4 (]: 63 of 111 START test not_null_int__regime_changes_regime ....................... [RUN]
[0m20:00:47.250157 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5, now test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006)
[0m20:00:47.250844 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m20:00:47.256557 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m20:00:47.257620 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m20:00:47.260271 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m20:00:47.261297 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m20:00:47.261714 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: BEGIN
[0m20:00:47.262054 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:47.263626 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:00:47.264076 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m20:00:47.264447 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select regime
from "finance"."analytics_dev"."int__regime_changes"
where regime is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.323669 [debug] [Thread-2 (]: SQL status: OK in 0.081 seconds
[0m20:00:47.324120 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m20:00:47.327159 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: ROLLBACK
[0m20:00:47.328389 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: ROLLBACK
[0m20:00:47.329072 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0'
[0m20:00:47.329580 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755'
[0m20:00:47.329937 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: Close
[0m20:00:47.330311 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: Close
[0m20:00:47.331252 [info ] [Thread-1 (]: 61 of 111 PASS not_null_int__regime_changes_days_in_regime ..................... [[32mPASS[0m in 0.13s]
[0m20:00:47.332600 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m20:00:47.331828 [info ] [Thread-2 (]: 62 of 111 PASS not_null_int__regime_changes_end_date ........................... [[32mPASS[0m in 0.13s]
[0m20:00:47.333156 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m20:00:47.333764 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m20:00:47.334645 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m20:00:47.334222 [info ] [Thread-1 (]: 64 of 111 START test not_null_int__regime_changes_regime_period_id ............. [RUN]
[0m20:00:47.335633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0, now test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257)
[0m20:00:47.335195 [info ] [Thread-2 (]: 65 of 111 START test not_null_int__regime_changes_start_date ................... [RUN]
[0m20:00:47.336127 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m20:00:47.336528 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755, now test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7)
[0m20:00:47.340106 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m20:00:47.340651 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m20:00:47.344973 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m20:00:47.346056 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m20:00:47.349142 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m20:00:47.349900 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m20:00:47.355229 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m20:00:47.356181 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m20:00:47.356624 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: BEGIN
[0m20:00:47.357150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:47.358121 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m20:00:47.358669 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: BEGIN
[0m20:00:47.359219 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:47.359794 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:47.360468 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m20:00:47.361317 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select regime_period_id
from "finance"."analytics_dev"."int__regime_changes"
where regime_period_id is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.362174 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:47.362766 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m20:00:47.363380 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select start_date
from "finance"."analytics_dev"."int__regime_changes"
where start_date is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.403594 [debug] [Thread-4 (]: SQL status: OK in 0.139 seconds
[0m20:00:47.406235 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: ROLLBACK
[0m20:00:47.406891 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006'
[0m20:00:47.407247 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: Close
[0m20:00:47.408275 [info ] [Thread-4 (]: 63 of 111 PASS not_null_int__regime_changes_regime ............................. [[32mPASS[0m in 0.16s]
[0m20:00:47.409241 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m20:00:47.409640 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m20:00:47.410111 [info ] [Thread-4 (]: 66 of 111 START test not_null_int__regime_classification_loaded_at ............. [RUN]
[0m20:00:47.410776 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006, now test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b)
[0m20:00:47.411393 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m20:00:47.415245 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m20:00:47.416342 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m20:00:47.419189 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m20:00:47.420493 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m20:00:47.421134 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: BEGIN
[0m20:00:47.421650 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:47.423025 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:00:47.423431 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m20:00:47.423794 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__regime_classification"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.458529 [debug] [Thread-2 (]: SQL status: OK in 0.095 seconds
[0m20:00:47.459146 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m20:00:47.462139 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: ROLLBACK
[0m20:00:47.463959 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: ROLLBACK
[0m20:00:47.464758 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7'
[0m20:00:47.465548 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: Close
[0m20:00:47.466530 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257'
[0m20:00:47.467337 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: Close
[0m20:00:47.468126 [info ] [Thread-2 (]: 65 of 111 PASS not_null_int__regime_changes_start_date ......................... [[32mPASS[0m in 0.13s]
[0m20:00:47.469199 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m20:00:47.470367 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m20:00:47.469884 [info ] [Thread-1 (]: 64 of 111 PASS not_null_int__regime_changes_regime_period_id ................... [[32mPASS[0m in 0.13s]
[0m20:00:47.471652 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m20:00:47.470978 [info ] [Thread-2 (]: 67 of 111 START test not_null_int__regime_classification_regime ................ [RUN]
[0m20:00:47.472286 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m20:00:47.472896 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7, now test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6)
[0m20:00:47.473771 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m20:00:47.473326 [info ] [Thread-1 (]: 68 of 111 START test not_null_int__regime_classification_trade_date ............ [RUN]
[0m20:00:47.478591 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m20:00:47.479142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257, now test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade)
[0m20:00:47.479723 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m20:00:47.485212 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m20:00:47.489183 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m20:00:47.492348 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m20:00:47.492977 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m20:00:47.497095 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m20:00:47.497854 [debug] [Thread-4 (]: SQL status: OK in 0.074 seconds
[0m20:00:47.498817 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m20:00:47.499521 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m20:00:47.500138 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: BEGIN
[0m20:00:47.502543 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: ROLLBACK
[0m20:00:47.503357 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: BEGIN
[0m20:00:47.504009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:47.504563 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:47.505142 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b'
[0m20:00:47.506026 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: Close
[0m20:00:47.506719 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:00:47.507629 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:00:47.508085 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m20:00:47.507282 [info ] [Thread-4 (]: 66 of 111 PASS not_null_int__regime_classification_loaded_at ................... [[32mPASS[0m in 0.10s]
[0m20:00:47.508581 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m20:00:47.509250 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__regime_classification"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.509953 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m20:00:47.510522 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select regime
from "finance"."analytics_dev"."int__regime_classification"
where regime is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.511611 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m20:00:47.512945 [info ] [Thread-4 (]: 69 of 111 START test not_null_int__rsi_sma_close ............................... [RUN]
[0m20:00:47.513777 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b, now test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b)
[0m20:00:47.514284 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m20:00:47.519556 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m20:00:47.521181 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m20:00:47.524314 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m20:00:47.525681 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m20:00:47.526337 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: BEGIN
[0m20:00:47.526679 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:47.528148 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:00:47.528501 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m20:00:47.528849 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__rsi_sma"
where close is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.589230 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m20:00:47.589784 [debug] [Thread-2 (]: SQL status: OK in 0.077 seconds
[0m20:00:47.593678 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: ROLLBACK
[0m20:00:47.595466 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: ROLLBACK
[0m20:00:47.596295 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6'
[0m20:00:47.596891 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade'
[0m20:00:47.597302 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: Close
[0m20:00:47.597735 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: Close
[0m20:00:47.598897 [info ] [Thread-1 (]: 68 of 111 PASS not_null_int__regime_classification_trade_date .................. [[32mPASS[0m in 0.12s]
[0m20:00:47.600408 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m20:00:47.599535 [info ] [Thread-2 (]: 67 of 111 PASS not_null_int__regime_classification_regime ...................... [[32mPASS[0m in 0.13s]
[0m20:00:47.601273 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m20:00:47.602315 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m20:00:47.603350 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m20:00:47.602797 [info ] [Thread-1 (]: 70 of 111 START test not_null_int__rsi_sma_gain ................................ [RUN]
[0m20:00:47.605201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade, now test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953)
[0m20:00:47.604306 [info ] [Thread-2 (]: 71 of 111 START test not_null_int__rsi_sma_loaded_at ........................... [RUN]
[0m20:00:47.605951 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m20:00:47.606439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6, now test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0)
[0m20:00:47.611982 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m20:00:47.612539 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m20:00:47.613003 [debug] [Thread-4 (]: SQL status: OK in 0.084 seconds
[0m20:00:47.617627 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m20:00:47.618909 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m20:00:47.624153 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m20:00:47.626955 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: ROLLBACK
[0m20:00:47.628030 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m20:00:47.628935 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b'
[0m20:00:47.632320 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m20:00:47.633018 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: Close
[0m20:00:47.634306 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m20:00:47.636108 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: BEGIN
[0m20:00:47.636765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:47.635517 [info ] [Thread-4 (]: 69 of 111 PASS not_null_int__rsi_sma_close ..................................... [[32mPASS[0m in 0.12s]
[0m20:00:47.638365 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m20:00:47.639071 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m20:00:47.639606 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:00:47.640045 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m20:00:47.641229 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m20:00:47.640580 [info ] [Thread-4 (]: 72 of 111 START test not_null_int__rsi_sma_loss ................................ [RUN]
[0m20:00:47.641994 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: BEGIN
[0m20:00:47.642527 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_sma"
where gain is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.643073 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b, now test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065)
[0m20:00:47.643794 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:47.644868 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m20:00:47.652968 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m20:00:47.653726 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m20:00:47.654441 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m20:00:47.655035 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__rsi_sma"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.656053 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m20:00:47.660612 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m20:00:47.662163 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m20:00:47.662849 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: BEGIN
[0m20:00:47.663548 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:47.665202 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:00:47.665685 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m20:00:47.666096 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_sma"
where loss is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.722789 [debug] [Thread-2 (]: SQL status: OK in 0.067 seconds
[0m20:00:47.723256 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m20:00:47.727198 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: ROLLBACK
[0m20:00:47.729793 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: ROLLBACK
[0m20:00:47.731055 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953'
[0m20:00:47.731897 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: Close
[0m20:00:47.732961 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0'
[0m20:00:47.733768 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: Close
[0m20:00:47.734939 [info ] [Thread-1 (]: 70 of 111 PASS not_null_int__rsi_sma_gain ...................................... [[32mPASS[0m in 0.13s]
[0m20:00:47.736086 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m20:00:47.736556 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m20:00:47.737140 [info ] [Thread-2 (]: 71 of 111 PASS not_null_int__rsi_sma_loaded_at ................................. [[32mPASS[0m in 0.13s]
[0m20:00:47.738283 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m20:00:47.737515 [info ] [Thread-1 (]: 73 of 111 START test not_null_int__rsi_sma_rn .................................. [RUN]
[0m20:00:47.738801 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m20:00:47.739279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953, now test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139)
[0m20:00:47.740081 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m20:00:47.746415 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m20:00:47.747029 [debug] [Thread-4 (]: SQL status: OK in 0.080 seconds
[0m20:00:47.739673 [info ] [Thread-2 (]: 74 of 111 START test not_null_int__rsi_sma_sma_gain ............................ [RUN]
[0m20:00:47.747789 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0, now test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416)
[0m20:00:47.748392 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m20:00:47.756434 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m20:00:47.758567 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: ROLLBACK
[0m20:00:47.759864 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065'
[0m20:00:47.760633 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m20:00:47.761228 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: Close
[0m20:00:47.763943 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m20:00:47.764792 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m20:00:47.768491 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m20:00:47.765415 [info ] [Thread-4 (]: 72 of 111 PASS not_null_int__rsi_sma_loss ...................................... [[32mPASS[0m in 0.12s]
[0m20:00:47.769662 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m20:00:47.770263 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m20:00:47.771439 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m20:00:47.770748 [info ] [Thread-4 (]: 75 of 111 START test not_null_int__rsi_sma_sma_loss ............................ [RUN]
[0m20:00:47.772432 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: BEGIN
[0m20:00:47.773235 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065, now test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6)
[0m20:00:47.773959 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m20:00:47.774460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:47.775214 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m20:00:47.775664 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: BEGIN
[0m20:00:47.780735 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m20:00:47.781498 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:47.781971 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:00:47.782961 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m20:00:47.783566 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_sma"
where rn is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.784772 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:00:47.785371 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m20:00:47.785778 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m20:00:47.793622 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m20:00:47.794131 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_gain
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_gain is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.795533 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m20:00:47.796110 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: BEGIN
[0m20:00:47.796708 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:47.798381 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:00:47.798984 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m20:00:47.799608 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_loss
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_loss is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.863445 [debug] [Thread-2 (]: SQL status: OK in 0.069 seconds
[0m20:00:47.865800 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: ROLLBACK
[0m20:00:47.866452 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416'
[0m20:00:47.866809 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: Close
[0m20:00:47.867884 [info ] [Thread-2 (]: 74 of 111 PASS not_null_int__rsi_sma_sma_gain .................................. [[32mPASS[0m in 0.12s]
[0m20:00:47.868845 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m20:00:47.869350 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m20:00:47.869826 [info ] [Thread-2 (]: 76 of 111 START test not_null_int__rsi_sma_ticker .............................. [RUN]
[0m20:00:47.870482 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416, now test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d)
[0m20:00:47.870854 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m20:00:47.875462 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m20:00:47.876745 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m20:00:47.879492 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m20:00:47.880508 [debug] [Thread-3 (]: SQL status: OK in 1.250 seconds
[0m20:00:47.881052 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m20:00:47.881777 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m20:00:47.882352 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: BEGIN
[0m20:00:47.882878 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:47.884863 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: ROLLBACK
[0m20:00:47.886203 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: ROLLBACK
[0m20:00:47.886716 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:00:47.887102 [debug] [Thread-4 (]: SQL status: OK in 0.087 seconds
[0m20:00:47.887637 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95'
[0m20:00:47.888101 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m20:00:47.888591 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139'
[0m20:00:47.889266 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: Close
[0m20:00:47.889792 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_sma"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.890210 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: Close
[0m20:00:47.891906 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: ROLLBACK
[0m20:00:47.893401 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6'
[0m20:00:47.894746 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: Close
[0m20:00:47.894200 [info ] [Thread-1 (]: 73 of 111 PASS not_null_int__rsi_sma_rn ........................................ [[32mPASS[0m in 0.15s]
[0m20:00:47.895408 [info ] [Thread-3 (]: 50 of 111 PASS dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[32mPASS[0m in 1.28s]
[0m20:00:47.896499 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m20:00:47.897849 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m20:00:47.897110 [info ] [Thread-4 (]: 75 of 111 PASS not_null_int__rsi_sma_sma_loss .................................. [[32mPASS[0m in 0.12s]
[0m20:00:47.898601 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m20:00:47.899143 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m20:00:47.900155 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m20:00:47.900670 [info ] [Thread-1 (]: 77 of 111 START test not_null_int__rsi_sma_trade_date .......................... [RUN]
[0m20:00:47.902043 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m20:00:47.902667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139, now test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0)
[0m20:00:47.901239 [info ] [Thread-3 (]: 78 of 111 START test not_null_int__rsi_wilder_gain ............................. [RUN]
[0m20:00:47.903628 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m20:00:47.903213 [info ] [Thread-4 (]: 79 of 111 START test not_null_int__rsi_wilder_loss ............................. [RUN]
[0m20:00:47.904213 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95, now test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda)
[0m20:00:47.909535 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m20:00:47.910195 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6, now test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56)
[0m20:00:47.911312 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m20:00:47.911878 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m20:00:47.916062 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m20:00:47.922444 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m20:00:47.923287 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m20:00:47.925876 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m20:00:47.926671 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m20:00:47.930841 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m20:00:47.931653 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m20:00:47.935108 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m20:00:47.935705 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m20:00:47.936515 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: BEGIN
[0m20:00:47.937280 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m20:00:47.937815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:47.938411 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: BEGIN
[0m20:00:47.939348 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:47.940007 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m20:00:47.940858 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: BEGIN
[0m20:00:47.941485 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:00:47.941982 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:47.942456 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m20:00:47.942864 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:00:47.943671 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_sma"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.944360 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m20:00:47.945110 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:00:47.945854 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_wilder"
where loss is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.946445 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m20:00:47.947202 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_wilder"
where gain is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.951101 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:00:47.954919 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: ROLLBACK
[0m20:00:47.955999 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0'
[0m20:00:47.956600 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: Close
[0m20:00:47.957686 [info ] [Thread-1 (]: 77 of 111 PASS not_null_int__rsi_sma_trade_date ................................ [[32mPASS[0m in 0.05s]
[0m20:00:47.958634 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m20:00:47.959046 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m20:00:47.959520 [info ] [Thread-1 (]: 80 of 111 START test not_null_int__rsi_wilder_rn ............................... [RUN]
[0m20:00:47.960180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0, now test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d)
[0m20:00:47.960555 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m20:00:47.964800 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m20:00:47.966040 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m20:00:47.969359 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m20:00:47.970639 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m20:00:47.971285 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: BEGIN
[0m20:00:47.971959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:47.973741 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:00:47.974156 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m20:00:47.974529 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_wilder"
where rn is null



  
  
      
    ) dbt_internal_test
[0m20:00:47.983844 [debug] [Thread-2 (]: SQL status: OK in 0.091 seconds
[0m20:00:47.988153 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: ROLLBACK
[0m20:00:47.989198 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d'
[0m20:00:47.989755 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: Close
[0m20:00:47.991022 [info ] [Thread-2 (]: 76 of 111 PASS not_null_int__rsi_sma_ticker .................................... [[32mPASS[0m in 0.12s]
[0m20:00:47.991943 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m20:00:47.992362 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m20:00:47.992845 [info ] [Thread-2 (]: 81 of 111 START test not_null_int__rsi_wilder_ticker ........................... [RUN]
[0m20:00:47.993517 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d, now test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd)
[0m20:00:47.993888 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m20:00:47.998038 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m20:00:48.007809 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m20:00:48.011406 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m20:00:48.012879 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m20:00:48.013487 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: BEGIN
[0m20:00:48.013847 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:48.015194 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:00:48.015564 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m20:00:48.016009 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_wilder"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m20:00:49.247089 [debug] [Thread-4 (]: SQL status: OK in 1.300 seconds
[0m20:00:49.248860 [debug] [Thread-1 (]: SQL status: OK in 1.274 seconds
[0m20:00:49.250464 [debug] [Thread-2 (]: SQL status: OK in 1.234 seconds
[0m20:00:49.252099 [debug] [Thread-3 (]: SQL status: OK in 1.304 seconds
[0m20:00:49.254793 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: ROLLBACK
[0m20:00:49.256051 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: ROLLBACK
[0m20:00:49.257479 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: ROLLBACK
[0m20:00:49.258763 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: ROLLBACK
[0m20:00:49.259328 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56'
[0m20:00:49.259970 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d'
[0m20:00:49.260562 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd'
[0m20:00:49.261082 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda'
[0m20:00:49.261431 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: Close
[0m20:00:49.261804 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: Close
[0m20:00:49.262173 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: Close
[0m20:00:49.262538 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: Close
[0m20:00:49.263586 [info ] [Thread-4 (]: 79 of 111 PASS not_null_int__rsi_wilder_loss ................................... [[32mPASS[0m in 1.35s]
[0m20:00:49.264194 [info ] [Thread-1 (]: 80 of 111 PASS not_null_int__rsi_wilder_rn ..................................... [[32mPASS[0m in 1.30s]
[0m20:00:49.266559 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m20:00:49.264639 [info ] [Thread-3 (]: 78 of 111 PASS not_null_int__rsi_wilder_gain ................................... [[32mPASS[0m in 1.36s]
[0m20:00:49.267156 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m20:00:49.267658 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m20:00:49.265049 [info ] [Thread-2 (]: 81 of 111 PASS not_null_int__rsi_wilder_ticker ................................. [[32mPASS[0m in 1.27s]
[0m20:00:49.268686 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m20:00:49.269388 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m20:00:49.270757 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m20:00:49.270026 [info ] [Thread-1 (]: 82 of 111 START test not_null_int__rsi_wilder_trade_date ....................... [RUN]
[0m20:00:49.271688 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m20:00:49.273024 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m20:00:49.272306 [info ] [Thread-4 (]: 83 of 111 START test not_null_int__rsi_wilder_wilder_gain ...................... [RUN]
[0m20:00:49.273708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d, now test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c)
[0m20:00:49.274110 [info ] [Thread-3 (]: 84 of 111 START test not_null_int__rsi_wilder_wilder_loss ...................... [RUN]
[0m20:00:49.275440 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9)
[0m20:00:49.275968 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m20:00:49.276814 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb)
[0m20:00:49.274725 [info ] [Thread-2 (]: 85 of 111 START test not_null_regime_thresholds_effective_date ................. [RUN]
[0m20:00:49.277619 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m20:00:49.284453 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m20:00:49.285116 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m20:00:49.285567 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd, now test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5)
[0m20:00:49.289791 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m20:00:49.293784 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m20:00:49.294461 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m20:00:49.299360 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m20:00:49.299908 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m20:00:49.303207 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m20:00:49.304355 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m20:00:49.307733 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m20:00:49.308172 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m20:00:49.311504 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m20:00:49.312149 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m20:00:49.313000 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: BEGIN
[0m20:00:49.313872 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m20:00:49.314531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:49.320575 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m20:00:49.321088 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m20:00:49.321837 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m20:00:49.322536 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: BEGIN
[0m20:00:49.322998 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: BEGIN
[0m20:00:49.323611 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:00:49.324135 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:49.324587 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:49.325043 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m20:00:49.325473 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m20:00:49.326279 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_wilder"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m20:00:49.326817 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: BEGIN
[0m20:00:49.327252 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:00:49.327758 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:00:49.328327 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:49.328962 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m20:00:49.329610 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m20:00:49.330493 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_gain
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_gain is null



  
  
      
    ) dbt_internal_test
[0m20:00:49.331274 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_loss is null



  
  
      
    ) dbt_internal_test
[0m20:00:49.332111 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:00:49.332896 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m20:00:49.333565 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_date
from "finance"."analytics_dev"."regime_thresholds"
where effective_date is null



  
  
      
    ) dbt_internal_test
[0m20:00:49.383743 [debug] [Thread-2 (]: SQL status: OK in 0.050 seconds
[0m20:00:49.386362 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: ROLLBACK
[0m20:00:49.387005 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5'
[0m20:00:49.387366 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: Close
[0m20:00:49.388296 [info ] [Thread-2 (]: 85 of 111 PASS not_null_regime_thresholds_effective_date ....................... [[32mPASS[0m in 0.10s]
[0m20:00:49.389120 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m20:00:49.389522 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m20:00:49.389994 [info ] [Thread-2 (]: 86 of 111 START test not_null_regime_thresholds_version_id ..................... [RUN]
[0m20:00:49.390636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5, now test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c)
[0m20:00:49.391004 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m20:00:49.394577 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m20:00:49.395652 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m20:00:49.398530 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m20:00:49.399801 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m20:00:49.400648 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: BEGIN
[0m20:00:49.401174 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:49.403079 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:49.403508 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m20:00:49.403988 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_id
from "finance"."analytics_dev"."regime_thresholds"
where version_id is null



  
  
      
    ) dbt_internal_test
[0m20:00:49.458107 [debug] [Thread-2 (]: SQL status: OK in 0.053 seconds
[0m20:00:49.461242 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: ROLLBACK
[0m20:00:49.462292 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c'
[0m20:00:49.462709 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: Close
[0m20:00:49.463831 [info ] [Thread-2 (]: 86 of 111 PASS not_null_regime_thresholds_version_id ........................... [[32mPASS[0m in 0.07s]
[0m20:00:49.464834 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m20:00:49.465318 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m20:00:49.465823 [info ] [Thread-2 (]: 87 of 111 START test not_null_stg__stocks_close ................................ [RUN]
[0m20:00:49.466586 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c, now test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f)
[0m20:00:49.467036 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m20:00:49.471504 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m20:00:49.472856 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m20:00:49.476025 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m20:00:49.477135 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m20:00:49.477788 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: BEGIN
[0m20:00:49.478271 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:49.479907 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:49.480320 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m20:00:49.480691 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."stg__stocks"
where close is null



  
  
      
    ) dbt_internal_test
[0m20:00:49.527872 [debug] [Thread-2 (]: SQL status: OK in 0.047 seconds
[0m20:00:49.530662 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: ROLLBACK
[0m20:00:49.531382 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f'
[0m20:00:49.531755 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: Close
[0m20:00:49.532783 [info ] [Thread-2 (]: 87 of 111 PASS not_null_stg__stocks_close ...................................... [[32mPASS[0m in 0.07s]
[0m20:00:49.533783 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m20:00:49.534225 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m20:00:49.534735 [info ] [Thread-2 (]: 88 of 111 START test not_null_stg__stocks_high ................................. [RUN]
[0m20:00:49.535439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f, now test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4)
[0m20:00:49.535818 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m20:00:49.540524 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m20:00:49.542062 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m20:00:49.545387 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m20:00:49.546678 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m20:00:49.547307 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: BEGIN
[0m20:00:49.547868 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:49.549345 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:00:49.549879 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m20:00:49.550289 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select high
from "finance"."analytics_dev"."stg__stocks"
where high is null



  
  
      
    ) dbt_internal_test
[0m20:00:49.598625 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m20:00:49.601709 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: ROLLBACK
[0m20:00:49.602516 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4'
[0m20:00:49.602899 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: Close
[0m20:00:49.603925 [info ] [Thread-2 (]: 88 of 111 PASS not_null_stg__stocks_high ....................................... [[32mPASS[0m in 0.07s]
[0m20:00:49.604924 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m20:00:49.605493 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m20:00:49.605982 [info ] [Thread-2 (]: 89 of 111 START test not_null_stg__stocks_loaded_at ............................ [RUN]
[0m20:00:49.606669 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4, now test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf)
[0m20:00:49.607053 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m20:00:49.611767 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m20:00:49.613041 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m20:00:49.616008 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m20:00:49.617560 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m20:00:49.618245 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: BEGIN
[0m20:00:49.618690 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:49.620239 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:00:49.620786 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m20:00:49.621329 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."stg__stocks"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m20:00:49.663998 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m20:00:49.667066 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: ROLLBACK
[0m20:00:49.668364 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf'
[0m20:00:49.669035 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: Close
[0m20:00:49.670153 [info ] [Thread-2 (]: 89 of 111 PASS not_null_stg__stocks_loaded_at .................................. [[32mPASS[0m in 0.06s]
[0m20:00:49.671047 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m20:00:49.671492 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m20:00:49.672000 [info ] [Thread-2 (]: 90 of 111 START test not_null_stg__stocks_low .................................. [RUN]
[0m20:00:49.672692 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf, now test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52)
[0m20:00:49.673091 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m20:00:49.677287 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m20:00:49.678439 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m20:00:49.681859 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m20:00:49.683391 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m20:00:49.684003 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: BEGIN
[0m20:00:49.684529 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:49.686218 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:49.686859 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m20:00:49.687268 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select low
from "finance"."analytics_dev"."stg__stocks"
where low is null



  
  
      
    ) dbt_internal_test
[0m20:00:49.729099 [debug] [Thread-2 (]: SQL status: OK in 0.041 seconds
[0m20:00:49.731603 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: ROLLBACK
[0m20:00:49.732254 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52'
[0m20:00:49.732611 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: Close
[0m20:00:49.733796 [info ] [Thread-2 (]: 90 of 111 PASS not_null_stg__stocks_low ........................................ [[32mPASS[0m in 0.06s]
[0m20:00:49.734668 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m20:00:49.735070 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m20:00:49.735541 [info ] [Thread-2 (]: 91 of 111 START test not_null_stg__stocks_open ................................. [RUN]
[0m20:00:49.736184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52, now test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7)
[0m20:00:49.736547 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m20:00:49.741019 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m20:00:49.742242 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m20:00:49.746311 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m20:00:49.747639 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m20:00:49.748311 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: BEGIN
[0m20:00:49.748719 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:49.750590 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:49.751051 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m20:00:49.751433 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "finance"."analytics_dev"."stg__stocks"
where open is null



  
  
      
    ) dbt_internal_test
[0m20:00:49.818236 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m20:00:49.821299 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: ROLLBACK
[0m20:00:49.822008 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7'
[0m20:00:49.822371 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: Close
[0m20:00:49.823377 [info ] [Thread-2 (]: 91 of 111 PASS not_null_stg__stocks_open ....................................... [[32mPASS[0m in 0.09s]
[0m20:00:49.824242 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m20:00:49.824653 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m20:00:49.825137 [info ] [Thread-2 (]: 92 of 111 START test not_null_stg__stocks_ticker ............................... [RUN]
[0m20:00:49.825777 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7, now test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71)
[0m20:00:49.826148 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m20:00:49.830399 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m20:00:49.840650 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m20:00:49.843315 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m20:00:49.844543 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m20:00:49.845170 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: BEGIN
[0m20:00:49.845697 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:49.847126 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:00:49.847660 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m20:00:49.848218 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."stg__stocks"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m20:00:49.898666 [debug] [Thread-2 (]: SQL status: OK in 0.050 seconds
[0m20:00:49.901295 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: ROLLBACK
[0m20:00:49.902041 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71'
[0m20:00:49.902430 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: Close
[0m20:00:49.903497 [info ] [Thread-2 (]: 92 of 111 PASS not_null_stg__stocks_ticker ..................................... [[32mPASS[0m in 0.08s]
[0m20:00:49.904400 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m20:00:49.904854 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m20:00:49.905373 [info ] [Thread-2 (]: 93 of 111 START test not_null_stg__stocks_trade_date ........................... [RUN]
[0m20:00:49.906185 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71, now test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182)
[0m20:00:49.906582 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m20:00:49.910363 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m20:00:49.911568 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m20:00:49.916126 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m20:00:49.917573 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m20:00:49.918301 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: BEGIN
[0m20:00:49.918933 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:49.920478 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:49.920855 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m20:00:49.921222 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."stg__stocks"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m20:00:49.970256 [debug] [Thread-2 (]: SQL status: OK in 0.049 seconds
[0m20:00:49.973276 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: ROLLBACK
[0m20:00:49.974357 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182'
[0m20:00:49.975079 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: Close
[0m20:00:49.976376 [info ] [Thread-2 (]: 93 of 111 PASS not_null_stg__stocks_trade_date ................................. [[32mPASS[0m in 0.07s]
[0m20:00:49.977429 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m20:00:49.977951 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m20:00:49.978556 [info ] [Thread-2 (]: 94 of 111 START test not_null_stg__stocks_volume ............................... [RUN]
[0m20:00:49.979353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182, now test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0)
[0m20:00:49.979838 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m20:00:49.985182 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m20:00:49.986529 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m20:00:49.990601 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m20:00:49.992222 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m20:00:49.993047 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: BEGIN
[0m20:00:49.993706 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:49.995504 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:49.995972 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m20:00:49.996394 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select volume
from "finance"."analytics_dev"."stg__stocks"
where volume is null



  
  
      
    ) dbt_internal_test
[0m20:00:50.051650 [debug] [Thread-2 (]: SQL status: OK in 0.054 seconds
[0m20:00:50.056317 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: ROLLBACK
[0m20:00:50.057073 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0'
[0m20:00:50.057431 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: Close
[0m20:00:50.058637 [info ] [Thread-2 (]: 94 of 111 PASS not_null_stg__stocks_volume ..................................... [[32mPASS[0m in 0.08s]
[0m20:00:50.059546 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m20:00:50.060074 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m20:00:50.060561 [info ] [Thread-2 (]: 95 of 111 START test not_null_stg__vix_with_versions_close ..................... [RUN]
[0m20:00:50.061258 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0, now test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7)
[0m20:00:50.061633 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m20:00:50.065831 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m20:00:50.067284 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m20:00:50.072094 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m20:00:50.073469 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m20:00:50.073863 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: BEGIN
[0m20:00:50.074235 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:50.075598 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:00:50.076087 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m20:00:50.076451 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."stg__vix_with_versions"
where close is null



  
  
      
    ) dbt_internal_test
[0m20:00:50.153654 [debug] [Thread-2 (]: SQL status: OK in 0.077 seconds
[0m20:00:50.156273 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: ROLLBACK
[0m20:00:50.157085 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7'
[0m20:00:50.157512 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: Close
[0m20:00:50.158615 [info ] [Thread-2 (]: 95 of 111 PASS not_null_stg__vix_with_versions_close ........................... [[32mPASS[0m in 0.10s]
[0m20:00:50.159496 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m20:00:50.159947 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m20:00:50.160639 [info ] [Thread-2 (]: 96 of 111 START test not_null_stg__vix_with_versions_complacent_max ............ [RUN]
[0m20:00:50.161459 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7, now test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a)
[0m20:00:50.161947 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m20:00:50.171263 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m20:00:50.175943 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m20:00:50.258249 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m20:00:50.262568 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m20:00:50.263243 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: BEGIN
[0m20:00:50.263890 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:50.265496 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:50.266066 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m20:00:50.266818 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select complacent_max
from "finance"."analytics_dev"."stg__vix_with_versions"
where complacent_max is null



  
  
      
    ) dbt_internal_test
[0m20:00:50.328977 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m20:00:50.331640 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: ROLLBACK
[0m20:00:50.332584 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a'
[0m20:00:50.333032 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: Close
[0m20:00:50.334135 [info ] [Thread-2 (]: 96 of 111 PASS not_null_stg__vix_with_versions_complacent_max .................. [[32mPASS[0m in 0.17s]
[0m20:00:50.335095 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m20:00:50.335549 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m20:00:50.336093 [info ] [Thread-2 (]: 97 of 111 START test not_null_stg__vix_with_versions_effective_date ............ [RUN]
[0m20:00:50.336810 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a, now test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991)
[0m20:00:50.337250 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m20:00:50.341501 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m20:00:50.342910 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m20:00:50.346454 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m20:00:50.347945 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m20:00:50.348744 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: BEGIN
[0m20:00:50.349602 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:50.351943 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:50.352509 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m20:00:50.352964 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
where effective_date is null



  
  
      
    ) dbt_internal_test
[0m20:00:50.355684 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:50.358940 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: ROLLBACK
[0m20:00:50.359691 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991'
[0m20:00:50.360072 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: Close
[0m20:00:50.360794 [info ] [Thread-2 (]: 97 of 111 PASS not_null_stg__vix_with_versions_effective_date .................. [[32mPASS[0m in 0.02s]
[0m20:00:50.361697 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m20:00:50.362291 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m20:00:50.362817 [info ] [Thread-2 (]: 98 of 111 START test not_null_stg__vix_with_versions_elevated_max .............. [RUN]
[0m20:00:50.363508 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991, now test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6)
[0m20:00:50.364194 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m20:00:50.369610 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m20:00:50.371136 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m20:00:50.375114 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m20:00:50.376490 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m20:00:50.377175 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: BEGIN
[0m20:00:50.377774 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:50.379415 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:00:50.380047 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m20:00:50.380553 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select elevated_max
from "finance"."analytics_dev"."stg__vix_with_versions"
where elevated_max is null



  
  
      
    ) dbt_internal_test
[0m20:00:50.439781 [debug] [Thread-2 (]: SQL status: OK in 0.059 seconds
[0m20:00:50.442606 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: ROLLBACK
[0m20:00:50.443535 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6'
[0m20:00:50.443957 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: Close
[0m20:00:50.445077 [info ] [Thread-2 (]: 98 of 111 PASS not_null_stg__vix_with_versions_elevated_max .................... [[32mPASS[0m in 0.08s]
[0m20:00:50.446039 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m20:00:50.446506 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m20:00:50.447063 [info ] [Thread-2 (]: 99 of 111 START test not_null_stg__vix_with_versions_loaded_at ................. [RUN]
[0m20:00:50.447816 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6, now test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c)
[0m20:00:50.448252 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m20:00:50.453376 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m20:00:50.454723 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m20:00:50.457303 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m20:00:50.458350 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m20:00:50.459030 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: BEGIN
[0m20:00:50.459525 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:50.461245 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:50.461944 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m20:00:50.462439 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."stg__vix_with_versions"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m20:00:50.519499 [debug] [Thread-2 (]: SQL status: OK in 0.057 seconds
[0m20:00:50.522447 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: ROLLBACK
[0m20:00:50.523206 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c'
[0m20:00:50.523573 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: Close
[0m20:00:50.524582 [info ] [Thread-2 (]: 99 of 111 PASS not_null_stg__vix_with_versions_loaded_at ....................... [[32mPASS[0m in 0.08s]
[0m20:00:50.525410 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m20:00:50.525817 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m20:00:50.526303 [info ] [Thread-2 (]: 100 of 111 START test not_null_stg__vix_with_versions_normal_max ............... [RUN]
[0m20:00:50.526956 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c, now test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21)
[0m20:00:50.527330 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m20:00:50.531249 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m20:00:50.532305 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m20:00:50.534923 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m20:00:50.536130 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m20:00:50.536855 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: BEGIN
[0m20:00:50.537426 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:50.538837 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:00:50.539224 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m20:00:50.539598 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select normal_max
from "finance"."analytics_dev"."stg__vix_with_versions"
where normal_max is null



  
  
      
    ) dbt_internal_test
[0m20:00:50.579461 [debug] [Thread-1 (]: SQL status: OK in 1.251 seconds
[0m20:00:50.580007 [debug] [Thread-4 (]: SQL status: OK in 1.248 seconds
[0m20:00:50.580407 [debug] [Thread-3 (]: SQL status: OK in 1.248 seconds
[0m20:00:50.583750 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: ROLLBACK
[0m20:00:50.585227 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: ROLLBACK
[0m20:00:50.587002 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: ROLLBACK
[0m20:00:50.588269 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb'
[0m20:00:50.589267 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9'
[0m20:00:50.590147 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c'
[0m20:00:50.590597 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: Close
[0m20:00:50.591060 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: Close
[0m20:00:50.591503 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: Close
[0m20:00:50.592902 [info ] [Thread-4 (]: 83 of 111 PASS not_null_int__rsi_wilder_wilder_gain ............................ [[32mPASS[0m in 1.32s]
[0m20:00:50.595239 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m20:00:50.593652 [info ] [Thread-3 (]: 84 of 111 PASS not_null_int__rsi_wilder_wilder_loss ............................ [[32mPASS[0m in 1.32s]
[0m20:00:50.595921 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m20:00:50.597090 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m20:00:50.594332 [info ] [Thread-1 (]: 82 of 111 PASS not_null_int__rsi_wilder_trade_date ............................. [[32mPASS[0m in 1.32s]
[0m20:00:50.598486 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m20:00:50.597944 [info ] [Thread-4 (]: 101 of 111 START test not_null_stg__vix_with_versions_trade_date ............... [RUN]
[0m20:00:50.600000 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m20:00:50.601916 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9, now test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1)
[0m20:00:50.600978 [info ] [Thread-3 (]: 102 of 111 START test not_null_stg__vix_with_versions_version_id ............... [RUN]
[0m20:00:50.602703 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m20:00:50.603277 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m20:00:50.603855 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb, now test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c)
[0m20:00:50.610296 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m20:00:50.604359 [info ] [Thread-1 (]: 103 of 111 START test not_null_stg__vix_with_versions_version_name ............. [RUN]
[0m20:00:50.610960 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m20:00:50.611603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c, now test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb)
[0m20:00:50.617009 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m20:00:50.617634 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m20:00:50.621535 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m20:00:50.622368 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m20:00:50.627196 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m20:00:50.628106 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m20:00:50.631394 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m20:00:50.631833 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m20:00:50.635265 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m20:00:50.636048 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m20:00:50.636635 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: BEGIN
[0m20:00:50.637104 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:50.637813 [debug] [Thread-2 (]: SQL status: OK in 0.098 seconds
[0m20:00:50.638492 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m20:00:50.639058 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: BEGIN
[0m20:00:50.639606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:50.640259 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:00:50.642637 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: ROLLBACK
[0m20:00:50.643326 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m20:00:50.643912 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m20:00:50.644464 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."stg__vix_with_versions"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m20:00:50.645134 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21'
[0m20:00:50.645595 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:00:50.645951 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: BEGIN
[0m20:00:50.646588 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: Close
[0m20:00:50.647157 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m20:00:50.647638 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:50.648387 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_name
from "finance"."analytics_dev"."stg__vix_with_versions"
where version_name is null



  
  
      
    ) dbt_internal_test
[0m20:00:50.649461 [info ] [Thread-2 (]: 100 of 111 PASS not_null_stg__vix_with_versions_normal_max ..................... [[32mPASS[0m in 0.12s]
[0m20:00:50.650315 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:00:50.650884 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m20:00:50.651274 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m20:00:50.651700 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m20:00:50.652199 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_id
from "finance"."analytics_dev"."stg__vix_with_versions"
where version_id is null



  
  
      
    ) dbt_internal_test
[0m20:00:50.652627 [info ] [Thread-2 (]: 104 of 111 START test not_null_stg__vix_with_versions_version_rank ............. [RUN]
[0m20:00:50.653409 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21, now test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578)
[0m20:00:50.653993 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m20:00:50.660047 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m20:00:50.661511 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m20:00:50.664043 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m20:00:50.665281 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m20:00:50.665943 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: BEGIN
[0m20:00:50.666348 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:50.667915 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:50.668380 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m20:00:50.668793 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_rank
from "finance"."analytics_dev"."stg__vix_with_versions"
where version_rank is null



  
  
      
    ) dbt_internal_test
[0m20:00:50.698625 [debug] [Thread-4 (]: SQL status: OK in 0.052 seconds
[0m20:00:50.705409 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: ROLLBACK
[0m20:00:50.706862 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1'
[0m20:00:50.707717 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: Close
[0m20:00:50.712865 [info ] [Thread-4 (]: 101 of 111 PASS not_null_stg__vix_with_versions_trade_date ..................... [[32mPASS[0m in 0.11s]
[0m20:00:50.718713 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m20:00:50.720847 [debug] [Thread-3 (]: SQL status: OK in 0.068 seconds
[0m20:00:50.721736 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m20:00:50.722454 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m20:00:50.723947 [info ] [Thread-4 (]: 105 of 111 START test relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_  [RUN]
[0m20:00:50.725557 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1, now test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5)
[0m20:00:50.729436 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: ROLLBACK
[0m20:00:50.730269 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m20:00:50.731704 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb'
[0m20:00:50.737822 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: ROLLBACK
[0m20:00:50.749203 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m20:00:50.750211 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: Close
[0m20:00:50.751400 [debug] [Thread-2 (]: SQL status: OK in 0.082 seconds
[0m20:00:50.752705 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c'
[0m20:00:50.754050 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: Close
[0m20:00:50.755021 [info ] [Thread-1 (]: 103 of 111 PASS not_null_stg__vix_with_versions_version_name ................... [[32mPASS[0m in 0.14s]
[0m20:00:50.756253 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m20:00:50.758074 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: ROLLBACK
[0m20:00:50.758556 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m20:00:50.759689 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509
[0m20:00:50.759147 [info ] [Thread-3 (]: 102 of 111 PASS not_null_stg__vix_with_versions_version_id ..................... [[32mPASS[0m in 0.16s]
[0m20:00:50.762522 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m20:00:50.763131 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578'
[0m20:00:50.764258 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m20:00:50.763557 [info ] [Thread-1 (]: 106 of 111 START test relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_  [RUN]
[0m20:00:50.765062 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: Close
[0m20:00:50.765638 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m20:00:50.766566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb, now test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509)
[0m20:00:50.768970 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m20:00:50.767407 [info ] [Thread-3 (]: 107 of 111 START test unique_int__regime_changes_regime_period_id .............. [RUN]
[0m20:00:50.769587 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509
[0m20:00:50.770437 [debug] [Thread-4 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: BEGIN
[0m20:00:50.768329 [info ] [Thread-2 (]: 104 of 111 PASS not_null_stg__vix_with_versions_version_rank ................... [[32mPASS[0m in 0.11s]
[0m20:00:50.770993 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c, now test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1)
[0m20:00:50.775432 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509"
[0m20:00:50.775826 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:50.776382 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m20:00:50.776750 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m20:00:50.777587 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m20:00:50.789359 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m20:00:50.790512 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m20:00:50.790024 [info ] [Thread-2 (]: 108 of 111 START test unique_int__regime_classification_trade_date ............. [RUN]
[0m20:00:50.791519 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m20:00:50.791945 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509
[0m20:00:50.792448 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578, now test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4)
[0m20:00:50.793004 [debug] [Thread-4 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select trade_date as from_field
    from "finance"."analytics_dev"."int__regime_classification"
    where trade_date is not null
),

parent as (
    select trade_date as to_field
    from "finance"."analytics_dev"."stg__vix_with_versions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:00:50.795636 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509"
[0m20:00:50.796042 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m20:00:50.796393 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m20:00:50.799449 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m20:00:50.805724 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m20:00:50.806884 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509"
[0m20:00:50.807360 [debug] [Thread-1 (]: On test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509: BEGIN
[0m20:00:50.807890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:50.808939 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m20:00:50.809532 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: BEGIN
[0m20:00:50.809922 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m20:00:50.810332 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:50.810718 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:00:50.813078 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m20:00:50.813708 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509"
[0m20:00:50.814447 [debug] [Thread-1 (]: On test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select trade_date as from_field
    from "finance"."analytics_dev"."mrt__stocks_with_regimes"
    where trade_date is not null
),

parent as (
    select trade_date as to_field
    from "finance"."analytics_dev"."stg__stocks"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:00:50.815484 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:00:50.816135 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m20:00:50.816716 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    regime_period_id as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."int__regime_changes"
where regime_period_id is not null
group by regime_period_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:00:50.817761 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m20:00:50.818455 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: BEGIN
[0m20:00:50.819061 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:50.820776 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:50.821393 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m20:00:50.822121 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."int__regime_classification"
where trade_date is not null
group by trade_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:00:50.870933 [debug] [Thread-4 (]: SQL status: OK in 0.074 seconds
[0m20:00:50.878074 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m20:00:50.885935 [debug] [Thread-4 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: ROLLBACK
[0m20:00:50.891398 [debug] [Thread-1 (]: On test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509: ROLLBACK
[0m20:00:50.894958 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5'
[0m20:00:50.896471 [debug] [Thread-4 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: Close
[0m20:00:50.897821 [debug] [Thread-2 (]: SQL status: OK in 0.075 seconds
[0m20:00:50.899786 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509'
[0m20:00:50.901660 [debug] [Thread-3 (]: SQL status: OK in 0.084 seconds
[0m20:00:50.904048 [debug] [Thread-1 (]: On test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509: Close
[0m20:00:50.906946 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: ROLLBACK
[0m20:00:50.903145 [info ] [Thread-4 (]: 105 of 111 PASS relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_  [[32mPASS[0m in 0.18s]
[0m20:00:50.908776 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m20:00:50.911328 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4'
[0m20:00:50.914547 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: ROLLBACK
[0m20:00:50.909990 [info ] [Thread-1 (]: 106 of 111 PASS relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_  [[32mPASS[0m in 0.14s]
[0m20:00:50.915846 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m20:00:50.917192 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: Close
[0m20:00:50.918492 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509
[0m20:00:50.919432 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1'
[0m20:00:50.921176 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m20:00:50.920182 [info ] [Thread-4 (]: 109 of 111 START test unique_regime_thresholds_effective_date .................. [RUN]
[0m20:00:50.923775 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: Close
[0m20:00:50.922921 [info ] [Thread-2 (]: 108 of 111 PASS unique_int__regime_classification_trade_date ................... [[32mPASS[0m in 0.13s]
[0m20:00:50.925633 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5, now test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c)
[0m20:00:50.924764 [info ] [Thread-1 (]: 110 of 111 START test unique_regime_thresholds_version_id ...................... [RUN]
[0m20:00:50.927678 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m20:00:50.929375 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m20:00:50.928695 [info ] [Thread-3 (]: 107 of 111 PASS unique_int__regime_changes_regime_period_id .................... [[32mPASS[0m in 0.16s]
[0m20:00:50.930564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_stg__stocks_.651272a509, now test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f)
[0m20:00:50.931502 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m20:00:50.938730 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m20:00:50.939618 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m20:00:50.940140 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m20:00:50.940690 [info ] [Thread-2 (]: 111 of 111 START test wilder_seed_equals_sma ................................... [RUN]
[0m20:00:50.945649 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m20:00:50.946194 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4, now test.portfolio_project_2.wilder_seed_equals_sma)
[0m20:00:50.946767 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.wilder_seed_equals_sma
[0m20:00:50.951922 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m20:00:50.952928 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m20:00:50.956471 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m20:00:50.957500 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.wilder_seed_equals_sma
[0m20:00:50.960520 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m20:00:50.960927 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m20:00:50.963353 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m20:00:50.964044 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m20:00:50.964465 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: BEGIN
[0m20:00:50.964832 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:50.965791 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m20:00:50.966641 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: BEGIN
[0m20:00:50.967180 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:00:50.967878 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:50.968681 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m20:00:50.969254 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m20:00:50.969887 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: BEGIN
[0m20:00:50.970733 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    effective_date as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."regime_thresholds"
where effective_date is not null
group by effective_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:00:50.971692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:50.972375 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:00:50.973217 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m20:00:50.973867 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.wilder_seed_equals_sma"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- asserts the seed matches SMA at rn=14
with w as (
  select ticker, trade_date, wilder_gain, wilder_loss
  from "finance"."analytics_dev"."int__rsi_wilder"
  where rn = 14
),
s as (
  select ticker, trade_date, sma_gain, sma_loss
  from "finance"."analytics_dev"."int__rsi_sma"
  where rn = 14
)
select
  w.ticker,
  w.trade_date
from w
join s using (ticker, trade_date)
where abs(w.wilder_gain - s.sma_gain) > 1e-9
   or abs(w.wilder_loss - s.sma_loss) > 1e-9
  
  
      
    ) dbt_internal_test
[0m20:00:50.974916 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:00:50.975473 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m20:00:50.975846 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    version_id as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."regime_thresholds"
where version_id is not null
group by version_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:00:51.025896 [debug] [Thread-4 (]: SQL status: OK in 0.053 seconds
[0m20:00:51.028411 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: ROLLBACK
[0m20:00:51.029154 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c'
[0m20:00:51.029530 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: Close
[0m20:00:51.030488 [info ] [Thread-4 (]: 109 of 111 PASS unique_regime_thresholds_effective_date ........................ [[32mPASS[0m in 0.11s]
[0m20:00:51.031433 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m20:00:51.038097 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m20:00:51.041483 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: ROLLBACK
[0m20:00:51.042486 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f'
[0m20:00:51.042878 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: Close
[0m20:00:51.044397 [info ] [Thread-1 (]: 110 of 111 PASS unique_regime_thresholds_version_id ............................ [[32mPASS[0m in 0.11s]
[0m20:00:51.045505 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m20:00:52.199172 [debug] [Thread-2 (]: SQL status: OK in 1.225 seconds
[0m20:00:52.203309 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: ROLLBACK
[0m20:00:52.204204 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.wilder_seed_equals_sma'
[0m20:00:52.204682 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: Close
[0m20:00:52.205980 [info ] [Thread-2 (]: 111 of 111 PASS wilder_seed_equals_sma ......................................... [[32mPASS[0m in 1.26s]
[0m20:00:52.207083 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m20:00:52.208986 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:52.209455 [debug] [MainThread]: On master: BEGIN
[0m20:00:52.209851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:00:52.211522 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:00:52.211939 [debug] [MainThread]: On master: COMMIT
[0m20:00:52.212334 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:52.212712 [debug] [MainThread]: On master: COMMIT
[0m20:00:52.213577 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:00:52.214369 [debug] [MainThread]: On master: Close
[0m20:00:52.215188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:52.216011 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m20:00:52.216644 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m20:00:52.217221 [debug] [MainThread]: Connection 'test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f' was properly closed.
[0m20:00:52.217790 [debug] [MainThread]: Connection 'test.portfolio_project_2.wilder_seed_equals_sma' was properly closed.
[0m20:00:52.218324 [debug] [MainThread]: Connection 'test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1' was properly closed.
[0m20:00:52.218813 [debug] [MainThread]: Connection 'test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c' was properly closed.
[0m20:00:52.219494 [info ] [MainThread]: 
[0m20:00:52.220231 [info ] [MainThread]: Finished running 111 data tests in 0 hours 0 minutes and 9.93 seconds (9.93s).
[0m20:00:52.239667 [debug] [MainThread]: Command end result
[0m20:00:52.309543 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:00:52.313217 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:00:52.324132 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m20:00:52.324542 [info ] [MainThread]: 
[0m20:00:52.325092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:52.325650 [info ] [MainThread]: 
[0m20:00:52.326184 [info ] [MainThread]: Done. PASS=111 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=111
[0m20:00:52.327375 [debug] [MainThread]: Command `-c test` succeeded at 20:00:52.327259 after 11.55 seconds
[0m20:00:52.327737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9ECBAB1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9F0113E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9F0113EE0>]}
[0m20:00:52.328097 [debug] [MainThread]: Flushing usage events
[0m20:00:53.119196 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:29.956638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59AB88050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59B3942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59B9D7ED0>]}


============================== 20:41:29.961306 | 6c19f190-60f2-4b27-a675-2b929d016719 ==============================
[0m20:41:29.961306 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:41:29.962036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select mrt__stocks_with_regimes --full-refresh', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m20:41:30.219080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c19f190-60f2-4b27-a675-2b929d016719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59AD40180>]}
[0m20:41:30.285134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c19f190-60f2-4b27-a675-2b929d016719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59B87B790>]}
[0m20:41:30.287921 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:41:30.579685 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:41:30.837505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:41:30.838278 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://tests\TESTING_RESULTS.md
[0m20:41:31.013135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c19f190-60f2-4b27-a675-2b929d016719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59D32A050>]}
[0m20:41:31.169939 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:41:31.172858 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:41:31.210395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c19f190-60f2-4b27-a675-2b929d016719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59CD20B90>]}
[0m20:41:31.210861 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m20:41:31.211405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c19f190-60f2-4b27-a675-2b929d016719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59CCAB230>]}
[0m20:41:31.213939 [info ] [MainThread]: 
[0m20:41:31.214475 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:41:31.214928 [info ] [MainThread]: 
[0m20:41:31.215551 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:41:31.216527 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m20:41:31.307982 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m20:41:31.308367 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m20:41:31.308674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:33.538042 [debug] [ThreadPool]: SQL status: OK in 2.229 seconds
[0m20:41:33.539436 [debug] [ThreadPool]: On list_finance: Close
[0m20:41:33.540109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m20:41:33.540591 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m20:41:33.547148 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:41:33.547624 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m20:41:33.547960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:33.549775 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:41:33.551292 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:41:33.551625 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m20:41:33.552611 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:41:33.552920 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:41:33.553219 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m20:41:33.604586 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m20:41:33.605565 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:41:33.605916 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:41:33.606217 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:41:33.649038 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m20:41:33.649480 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m20:41:33.656379 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m20:41:33.662271 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:41:33.662780 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m20:41:33.663130 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m20:41:33.665371 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m20:41:33.665761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:33.666150 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m20:41:33.666781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:33.667466 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:41:33.667821 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:41:33.668169 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m20:41:33.668777 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:41:33.669158 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m20:41:33.669491 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m20:41:33.694403 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m20:41:33.695944 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m20:41:33.697153 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m20:41:33.697510 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m20:41:33.697919 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m20:41:33.701378 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m20:41:33.702023 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m20:41:33.702339 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m20:41:33.703702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c19f190-60f2-4b27-a675-2b929d016719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59CAFA270>]}
[0m20:41:33.704211 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:33.704545 [debug] [MainThread]: On master: BEGIN
[0m20:41:33.704853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:41:33.706031 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:41:33.706362 [debug] [MainThread]: On master: COMMIT
[0m20:41:33.706683 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:33.706988 [debug] [MainThread]: On master: COMMIT
[0m20:41:33.707589 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:41:33.707940 [debug] [MainThread]: On master: Close
[0m20:41:33.713506 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m20:41:33.714148 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics_dev.mrt__stocks_with_regimes ...... [RUN]
[0m20:41:33.714871 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.mrt__stocks_with_regimes'
[0m20:41:33.715244 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m20:41:33.729561 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:33.730552 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m20:41:33.738381 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:33.738830 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__958c8aad9de7" cascade
    
[0m20:41:33.739195 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:41:33.807524 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m20:41:33.848394 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:33.848852 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m20:41:33.850404 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:33.851764 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:33.852202 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m20:41:33.853334 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:33.853775 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:33.854172 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m20:41:33.908321 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m20:41:33.909495 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:33.909887 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m20:41:33.910349 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:33.911518 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m20:41:33.911921 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:33.912290 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m20:41:33.968554 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m20:41:34.004348 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:34.004806 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:41:34.009268 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:41:34.024860 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:34.025306 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,0))
 as volume, 
      
    cast(null as text)
 as regime
    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:41:34.026924 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:34.052401 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:34.053453 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:34.053827 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m20:41:34.055068 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:34.055453 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:34.055877 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_tmp"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null
    
    )
 ;
    insert into "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_tmp" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m20:41:34.400036 [debug] [Thread-1 (]: SQL status: OK in 0.344 seconds
[0m20:41:34.406148 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:34.406602 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'analytics_dev'
      AND table_name = 'mrt__stocks_with_regimes'
  
[0m20:41:34.407882 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:34.409191 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:34.409617 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'analytics_dev'
      AND table_name = 'mrt__stocks_with_regimes'
  
[0m20:41:34.411913 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:34.420119 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:34.420562 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
alter table "finance"."analytics_dev"."mrt__stocks_with_regimes" rename to "mrt__stocks_with_regimes__dbt_backup"
[0m20:41:34.488015 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m20:41:34.491469 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:34.491914 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
alter table "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_tmp" rename to "mrt__stocks_with_regimes"
[0m20:41:34.560381 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m20:41:34.587169 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m20:41:34.588511 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:34.589434 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m20:41:34.820263 [debug] [Thread-1 (]: SQL status: OK in 0.230 seconds
[0m20:41:34.824539 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:34.825034 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__958c8aad9de7" cascade
    
[0m20:41:34.879850 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m20:41:34.883616 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:34.884187 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_backup" cascade
    
[0m20:41:35.015666 [debug] [Thread-1 (]: SQL status: OK in 0.131 seconds
[0m20:41:35.019020 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:35.019442 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__958c8aad9de7" cascade
    
[0m20:41:35.064011 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m20:41:35.069140 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m20:41:35.073002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c19f190-60f2-4b27-a675-2b929d016719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59D563050>]}
[0m20:41:35.074299 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes . [[32mOK[0m in 1.36s]
[0m20:41:35.075613 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m20:41:35.077861 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:35.078579 [debug] [MainThread]: On master: BEGIN
[0m20:41:35.079184 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:41:35.081080 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:41:35.081758 [debug] [MainThread]: On master: COMMIT
[0m20:41:35.082354 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:35.082928 [debug] [MainThread]: On master: COMMIT
[0m20:41:35.084074 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:41:35.084709 [debug] [MainThread]: On master: Close
[0m20:41:35.085278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:35.085576 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m20:41:35.085895 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m20:41:35.086388 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m20:41:35.086685 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m20:41:35.087019 [info ] [MainThread]: 
[0m20:41:35.087434 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.87 seconds (3.87s).
[0m20:41:35.088223 [debug] [MainThread]: Command end result
[0m20:41:35.161339 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:41:35.164329 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:41:35.170617 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m20:41:35.170970 [info ] [MainThread]: 
[0m20:41:35.171505 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:35.171968 [info ] [MainThread]: 
[0m20:41:35.172465 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:41:35.173445 [debug] [MainThread]: Command `-c run` succeeded at 20:41:35.173330 after 5.34 seconds
[0m20:41:35.173829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59CF67EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59EBAD090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59EBAFB10>]}
[0m20:41:35.174207 [debug] [MainThread]: Flushing usage events
[0m20:41:35.855976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:46.156780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDB228050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDBA342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDC077ED0>]}


============================== 20:41:46.161418 | da8bfbe3-fe03-4d45-9877-f0f9d1c015f7 ==============================
[0m20:41:46.161418 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:41:46.162112 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select mrt__stocks_with_regimes', 'printer_width': '80', 'target_path': 'None'}
[0m20:41:46.418625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da8bfbe3-fe03-4d45-9877-f0f9d1c015f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDB3E0180>]}
[0m20:41:46.484764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da8bfbe3-fe03-4d45-9877-f0f9d1c015f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDBF1B790>]}
[0m20:41:46.487793 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:41:46.785101 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:41:47.034654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:41:47.035014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:41:47.113381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da8bfbe3-fe03-4d45-9877-f0f9d1c015f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDD1B9E50>]}
[0m20:41:47.318649 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:41:47.321486 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:41:47.357658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da8bfbe3-fe03-4d45-9877-f0f9d1c015f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDD390B90>]}
[0m20:41:47.358132 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m20:41:47.358662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da8bfbe3-fe03-4d45-9877-f0f9d1c015f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDD3E6510>]}
[0m20:41:47.361566 [info ] [MainThread]: 
[0m20:41:47.362143 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:41:47.362608 [info ] [MainThread]: 
[0m20:41:47.363308 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:41:47.364575 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m20:41:47.452094 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m20:41:47.452489 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m20:41:47.452803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:49.123381 [debug] [ThreadPool]: SQL status: OK in 1.671 seconds
[0m20:41:49.125299 [debug] [ThreadPool]: On list_finance: Close
[0m20:41:49.126158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m20:41:49.126786 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m20:41:49.133805 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:41:49.134243 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m20:41:49.134649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:49.136868 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:41:49.138334 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:41:49.138670 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m20:41:49.139846 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:41:49.140255 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:41:49.140553 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m20:41:49.192605 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m20:41:49.194055 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:41:49.194523 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:41:49.194945 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:41:49.363369 [debug] [ThreadPool]: SQL status: OK in 0.168 seconds
[0m20:41:49.363853 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m20:41:49.370485 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m20:41:49.376397 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m20:41:49.376898 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m20:41:49.377248 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m20:41:49.379368 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:41:49.379712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:49.380057 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m20:41:49.380626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:49.381488 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:41:49.381893 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m20:41:49.382197 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:41:49.382563 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m20:41:49.383007 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:41:49.383561 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m20:41:49.409284 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m20:41:49.409684 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m20:41:49.411050 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m20:41:49.412360 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m20:41:49.413537 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m20:41:49.413864 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m20:41:49.414392 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m20:41:49.414714 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m20:41:49.418735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da8bfbe3-fe03-4d45-9877-f0f9d1c015f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDDBCDCC0>]}
[0m20:41:49.419283 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:49.419595 [debug] [MainThread]: On master: BEGIN
[0m20:41:49.419876 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:41:49.421123 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:41:49.421439 [debug] [MainThread]: On master: COMMIT
[0m20:41:49.421736 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:49.422022 [debug] [MainThread]: On master: COMMIT
[0m20:41:49.422577 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:41:49.422889 [debug] [MainThread]: On master: Close
[0m20:41:49.427743 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m20:41:49.428257 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics_dev.mrt__stocks_with_regimes ...... [RUN]
[0m20:41:49.428957 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.mrt__stocks_with_regimes'
[0m20:41:49.429329 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m20:41:49.444544 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:49.445513 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m20:41:49.453066 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:49.453551 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__b3578989bd09" cascade
    
[0m20:41:49.454146 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:41:49.503786 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m20:41:49.544714 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:49.545157 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m20:41:49.546742 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:49.548126 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:49.548512 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m20:41:49.549510 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:49.549889 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:49.550264 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m20:41:49.600775 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m20:41:49.602126 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:49.602539 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m20:41:49.603000 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:49.604158 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m20:41:49.604555 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:49.604932 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m20:41:49.653944 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m20:41:49.684269 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:49.684745 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:41:49.689148 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:41:49.705681 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:49.706123 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,0))
 as volume, 
      
    cast(null as text)
 as regime
    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:41:49.707666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:49.731704 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:49.732187 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."mrt__stocks_with_regimes__b3578989bd09"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null
    
    )
 ;
    insert into "finance"."dbt_temp"."mrt__stocks_with_regimes__b3578989bd09" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m20:41:50.137290 [debug] [Thread-1 (]: SQL status: OK in 0.404 seconds
[0m20:41:50.147126 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:50.147492 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m20:41:50.148618 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:50.148953 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:50.149294 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__b3578989bd09'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m20:41:50.155057 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:41:50.159838 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:50.160223 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m20:41:50.165140 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:41:50.177018 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:50.177432 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__b3578989bd09'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m20:41:50.182323 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:41:50.185697 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:50.186101 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m20:41:50.190963 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:41:50.198948 [debug] [Thread-1 (]: 
    In "finance"."analytics_dev"."mrt__stocks_with_regimes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:41:50.199397 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:50.199741 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
SELECT version()
[0m20:41:50.200653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:50.267038 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:50.268082 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:50.268579 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */


    MERGE INTO "finance"."analytics_dev"."mrt__stocks_with_regimes" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."mrt__stocks_with_regimes__b3578989bd09" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m20:41:50.377771 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:41:50.387730 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m20:41:50.388132 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:50.388470 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m20:41:50.438470 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m20:41:50.441830 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:50.442328 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__b3578989bd09" cascade
    
[0m20:41:50.554549 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m20:41:50.557767 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m20:41:50.558155 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__b3578989bd09" cascade
    
[0m20:41:50.608249 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m20:41:50.610804 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m20:41:50.613141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da8bfbe3-fe03-4d45-9877-f0f9d1c015f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDDCCE510>]}
[0m20:41:50.613864 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes . [[32mOK[0m in 1.18s]
[0m20:41:50.614809 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m20:41:50.616422 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:50.616806 [debug] [MainThread]: On master: BEGIN
[0m20:41:50.617158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:41:50.618474 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:41:50.618871 [debug] [MainThread]: On master: COMMIT
[0m20:41:50.619239 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:50.619595 [debug] [MainThread]: On master: COMMIT
[0m20:41:50.620288 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:41:50.620663 [debug] [MainThread]: On master: Close
[0m20:41:50.621251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:50.621652 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m20:41:50.621979 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m20:41:50.622288 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m20:41:50.622595 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m20:41:50.622965 [info ] [MainThread]: 
[0m20:41:50.623549 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m20:41:50.624589 [debug] [MainThread]: Command end result
[0m20:41:50.686297 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:41:50.688865 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:41:50.694682 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m20:41:50.695036 [info ] [MainThread]: 
[0m20:41:50.695618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:50.696106 [info ] [MainThread]: 
[0m20:41:50.696623 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:41:50.697646 [debug] [MainThread]: Command `-c run` succeeded at 20:41:50.697529 after 4.67 seconds
[0m20:41:50.698030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDD633D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDDD9AFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDDD9AAD0>]}
[0m20:41:50.698430 [debug] [MainThread]: Flushing usage events
[0m20:41:51.442144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:50.699602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5C82F5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5C95E6DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5C95E5D60>]}


============================== 12:10:50.703978 | ddea6dd8-8b09-49d2-8823-915ddfd94b1d ==============================
[0m12:10:50.703978 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:10:50.705176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:10:51.010656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddea6dd8-8b09-49d2-8823-915ddfd94b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5CBA93800>]}
[0m12:10:51.150915 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.2', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.2'}} is not valid under any of the given schemas
  
[0m12:10:51.151925 [debug] [MainThread]: Command `cli deps` failed at 12:10:51.151925 after 0.57 seconds
[0m12:10:51.151925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5C82F5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5CBCA4C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5CBEE8290>]}
[0m12:10:51.152930 [debug] [MainThread]: Flushing usage events
[0m13:34:58.562598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE01D8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE09E42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE1027ED0>]}


============================== 13:34:58.571475 | df1ea348-c56f-4701-9f7a-9bad07559b7e ==============================
[0m13:34:58.571475 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:34:58.572186 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --no-version-check', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:34:59.036374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df1ea348-c56f-4701-9f7a-9bad07559b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE0390180>]}
[0m13:34:59.104473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df1ea348-c56f-4701-9f7a-9bad07559b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE0ECB790>]}
[0m13:34:59.122902 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:34:59.517913 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m13:34:59.518941 [debug] [MainThread]: Command `-c run` failed at 13:34:59.518816 after 1.08 seconds
[0m13:34:59.519327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE21B5450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE21B5350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE2390F50>]}
[0m13:34:59.519689 [debug] [MainThread]: Flushing usage events
[0m13:35:00.169885 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:10.115544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACB6D8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACBEE42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACC523ED0>]}


============================== 13:35:10.120158 | 76a0b6a1-f201-474f-88ce-1d3de50514e3 ==============================
[0m13:35:10.120158 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:35:10.120866 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'target_path': 'None', 'invocation_command': 'dbt deps', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m13:35:10.262916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76a0b6a1-f201-474f-88ce-1d3de50514e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACB890180>]}
[0m13:35:10.306128 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-fejrjpjm'
[0m13:35:10.306587 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:35:10.856919 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:35:10.858345 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:35:11.290306 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:35:11.294805 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m13:35:11.789815 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m13:35:11.793857 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m13:35:12.243388 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m13:35:12.248307 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:35:12.994965 [info ] [MainThread]: Installed from version 1.3.2
[0m13:35:12.995446 [info ] [MainThread]: Up to date!
[0m13:35:12.995976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '76a0b6a1-f201-474f-88ce-1d3de50514e3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACC3CAF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACC3CA580>]}
[0m13:35:12.996392 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m13:35:13.872643 [info ] [MainThread]: Installed from version 0.10.9
[0m13:35:13.873147 [info ] [MainThread]: Up to date!
[0m13:35:13.873586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '76a0b6a1-f201-474f-88ce-1d3de50514e3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACD83D050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACC3B76B0>]}
[0m13:35:13.873989 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m13:35:14.553326 [info ] [MainThread]: Installed from version 0.16.1
[0m13:35:14.553875 [info ] [MainThread]: Updated version available: 0.17.0
[0m13:35:14.554594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '76a0b6a1-f201-474f-88ce-1d3de50514e3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACD819A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACD819470>]}
[0m13:35:14.554998 [info ] [MainThread]: 
[0m13:35:14.555487 [info ] [MainThread]: Updates available for packages: ['godatadriven/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m13:35:14.558258 [debug] [MainThread]: Command `-c deps` succeeded at 13:35:14.558115 after 4.56 seconds
[0m13:35:14.558658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACC31F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACD7CA810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACD831F40>]}
[0m13:35:14.559030 [debug] [MainThread]: Flushing usage events
[0m13:35:15.074696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:58.282515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E72F98050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E737A42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E73DE7ED0>]}


============================== 13:35:58.287002 | 3f55b619-acb0-49d1-99c8-f916c07097a2 ==============================
[0m13:35:58.287002 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:35:58.287709 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --no-version-check', 'printer_width': '80', 'target_path': 'None'}
[0m13:35:58.554002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E73150180>]}
[0m13:35:58.623086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E73C8B790>]}
[0m13:35:58.625735 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:35:58.939458 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:36:01.564957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:36:01.565783 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://tests\TESTING_RESULTS.md
[0m13:36:01.760079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E7570E150>]}
[0m13:36:01.912954 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m13:36:01.937898 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m13:36:01.976776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E750F1130>]}
[0m13:36:01.977285 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m13:36:01.977897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E75077230>]}
[0m13:36:01.981640 [info ] [MainThread]: 
[0m13:36:01.982180 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:36:01.982653 [info ] [MainThread]: 
[0m13:36:01.983537 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:36:01.989627 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m13:36:04.631629 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m13:36:04.632060 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m13:36:04.632368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:06.957367 [debug] [ThreadPool]: SQL status: OK in 2.325 seconds
[0m13:36:06.959163 [debug] [ThreadPool]: On list_finance: Close
[0m13:36:06.959867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m13:36:06.960365 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m13:36:06.966424 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:36:06.966755 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m13:36:06.967086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:06.970644 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:36:06.972064 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:36:06.972377 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m13:36:06.973421 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:36:06.973754 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:36:06.974058 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m13:36:06.994757 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m13:36:06.995745 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m13:36:06.996068 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:36:06.996361 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m13:36:07.012989 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:36:07.013420 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m13:36:07.015743 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m13:36:07.021395 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m13:36:07.021739 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m13:36:07.022029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:07.023016 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m13:36:07.025031 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m13:36:07.025352 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m13:36:07.025636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:07.026280 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:36:07.026704 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m13:36:07.027017 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m13:36:07.027449 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:36:07.027806 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m13:36:07.028114 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m13:36:07.065206 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m13:36:07.066582 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m13:36:07.067058 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m13:36:07.068388 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m13:36:07.080740 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m13:36:07.081131 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m13:36:07.081661 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m13:36:07.081979 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m13:36:07.085001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E759428F0>]}
[0m13:36:07.085476 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:07.085776 [debug] [MainThread]: On master: BEGIN
[0m13:36:07.086059 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:07.087179 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:36:07.087508 [debug] [MainThread]: On master: COMMIT
[0m13:36:07.087806 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:07.088090 [debug] [MainThread]: On master: COMMIT
[0m13:36:07.088659 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:07.088967 [debug] [MainThread]: On master: Close
[0m13:36:07.094392 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m13:36:07.094864 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m13:36:07.095452 [info ] [Thread-1 (]: 1 of 11 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m13:36:07.096707 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m13:36:07.097074 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m13:36:07.104181 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m13:36:07.096069 [info ] [Thread-2 (]: 2 of 11 START sql view model analytics_dev.src_vix ............................. [RUN]
[0m13:36:07.105231 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m13:36:07.105771 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m13:36:07.108884 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m13:36:07.109670 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m13:36:07.144463 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m13:36:07.145166 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m13:36:07.148845 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m13:36:07.149851 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:36:07.150293 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m13:36:07.150653 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:36:07.151618 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:36:07.152025 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m13:36:07.152400 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:36:07.153058 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:36:07.153464 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:36:07.153835 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m13:36:07.154456 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:36:07.154860 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:36:07.155224 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m13:36:07.183720 [debug] [Thread-2 (]: SQL status: OK in 0.028 seconds
[0m13:36:07.189900 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:36:07.190365 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m13:36:07.190788 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m13:36:07.193958 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:36:07.194334 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m13:36:07.230254 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m13:36:07.233416 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:36:07.233870 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m13:36:07.234477 [debug] [Thread-2 (]: SQL status: OK in 0.044 seconds
[0m13:36:07.237808 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:36:07.238259 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m13:36:07.265004 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m13:36:07.278542 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m13:36:07.279000 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:36:07.279389 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m13:36:07.280944 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m13:36:07.282267 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m13:36:07.282669 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:36:07.283025 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m13:36:07.361582 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m13:36:07.373904 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:36:07.374671 [debug] [Thread-2 (]: SQL status: OK in 0.091 seconds
[0m13:36:07.375529 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m13:36:07.379965 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:36:07.381135 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m13:36:07.444792 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m13:36:07.445266 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m13:36:07.447861 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m13:36:07.449398 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m13:36:07.452428 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E75932E10>]}
[0m13:36:07.452972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E75337800>]}
[0m13:36:07.453733 [info ] [Thread-2 (]: 2 of 11 OK created sql view model analytics_dev.src_vix ........................ [[32mOK[0m in 0.35s]
[0m13:36:07.455277 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m13:36:07.454467 [info ] [Thread-1 (]: 1 of 11 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.35s]
[0m13:36:07.456588 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m13:36:07.457104 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m13:36:07.458310 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__stocks
[0m13:36:07.457919 [info ] [Thread-3 (]: 3 of 11 START sql view model analytics_dev.stg__vix_with_versions .............. [RUN]
[0m13:36:07.459753 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m13:36:07.458947 [info ] [Thread-4 (]: 4 of 11 START sql view model analytics_dev.stg__stocks ......................... [RUN]
[0m13:36:07.460670 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m13:36:07.461395 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m13:36:07.465968 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m13:36:07.466585 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m13:36:07.470716 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m13:36:07.471812 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m13:36:07.481693 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m13:36:07.482861 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m13:36:07.486948 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m13:36:07.487604 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:36:07.488273 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m13:36:07.488796 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:36:07.489768 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:36:07.490733 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m13:36:07.491160 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:36:07.491793 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:36:07.492299 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:36:07.492719 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m13:36:07.493566 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:36:07.493935 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:36:07.494374 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m13:36:07.527873 [debug] [Thread-4 (]: SQL status: OK in 0.033 seconds
[0m13:36:07.532734 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:36:07.533206 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m13:36:07.536612 [debug] [Thread-3 (]: SQL status: OK in 0.043 seconds
[0m13:36:07.539631 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:36:07.540030 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m13:36:07.560327 [debug] [Thread-4 (]: SQL status: OK in 0.027 seconds
[0m13:36:07.563686 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:36:07.564139 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m13:36:07.567280 [debug] [Thread-3 (]: SQL status: OK in 0.027 seconds
[0m13:36:07.570123 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:36:07.570505 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m13:36:07.590391 [debug] [Thread-4 (]: SQL status: OK in 0.026 seconds
[0m13:36:07.591817 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m13:36:07.592226 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:36:07.592578 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m13:36:07.599548 [debug] [Thread-3 (]: SQL status: OK in 0.029 seconds
[0m13:36:07.600889 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m13:36:07.601282 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:36:07.601659 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m13:36:07.648011 [debug] [Thread-4 (]: SQL status: OK in 0.055 seconds
[0m13:36:07.651363 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:36:07.651865 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m13:36:07.652551 [debug] [Thread-3 (]: SQL status: OK in 0.050 seconds
[0m13:36:07.655336 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:36:07.655788 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m13:36:07.707454 [debug] [Thread-3 (]: SQL status: OK in 0.051 seconds
[0m13:36:07.707978 [debug] [Thread-4 (]: SQL status: OK in 0.056 seconds
[0m13:36:07.709409 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m13:36:07.710698 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: Close
[0m13:36:07.711286 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E76F8B430>]}
[0m13:36:07.712618 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E759EAC50>]}
[0m13:36:07.712031 [info ] [Thread-3 (]: 3 of 11 OK created sql view model analytics_dev.stg__vix_with_versions ......... [[32mOK[0m in 0.25s]
[0m13:36:07.713920 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m13:36:07.714646 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m13:36:07.713194 [info ] [Thread-4 (]: 4 of 11 OK created sql view model analytics_dev.stg__stocks .................... [[32mOK[0m in 0.25s]
[0m13:36:07.715828 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m13:36:07.715145 [info ] [Thread-2 (]: 5 of 11 START sql view model analytics_dev.int__regime_classification .......... [RUN]
[0m13:36:07.716592 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_classification)
[0m13:36:07.716993 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m13:36:07.720021 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m13:36:07.720550 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__price_changes
[0m13:36:07.721024 [info ] [Thread-1 (]: 6 of 11 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m13:36:07.721709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__price_changes)
[0m13:36:07.722478 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m13:36:07.729156 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m13:36:07.728551 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m13:36:07.733201 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m13:36:07.734688 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m13:36:07.735192 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:36:07.738562 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m13:36:07.739067 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m13:36:07.739651 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:36:07.740531 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:36:07.740923 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m13:36:07.741274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:07.741972 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:36:07.742354 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:36:07.742772 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m13:36:07.743510 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:36:07.743913 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:36:07.744312 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."stg__stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m13:36:07.773039 [debug] [Thread-2 (]: SQL status: OK in 0.030 seconds
[0m13:36:07.776113 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:36:07.776558 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m13:36:07.784148 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m13:36:07.787408 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:36:07.787829 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m13:36:07.825339 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m13:36:07.828510 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:36:07.828927 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m13:36:07.829398 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m13:36:07.832207 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:36:07.832826 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m13:36:07.862400 [debug] [Thread-2 (]: SQL status: OK in 0.030 seconds
[0m13:36:07.863828 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m13:36:07.864260 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:36:07.864649 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m13:36:07.865096 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m13:36:07.866575 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m13:36:07.867304 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:36:07.867930 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m13:36:07.920237 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m13:36:07.922986 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:36:07.923389 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m13:36:07.923917 [debug] [Thread-2 (]: SQL status: OK in 0.059 seconds
[0m13:36:07.926248 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:36:07.926685 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m13:36:07.988575 [debug] [Thread-2 (]: SQL status: OK in 0.061 seconds
[0m13:36:07.989072 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m13:36:07.990443 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m13:36:07.991778 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: Close
[0m13:36:07.992392 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E75A60EC0>]}
[0m13:36:07.992979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E75B0A270>]}
[0m13:36:07.993641 [info ] [Thread-2 (]: 5 of 11 OK created sql view model analytics_dev.int__regime_classification ..... [[32mOK[0m in 0.28s]
[0m13:36:07.994928 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m13:36:07.995552 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m13:36:07.994220 [info ] [Thread-1 (]: 6 of 11 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.27s]
[0m13:36:07.996764 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m13:36:07.996063 [info ] [Thread-3 (]: 7 of 11 START sql view model analytics_dev.int__regime_changes ................. [RUN]
[0m13:36:07.997513 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m13:36:07.997967 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now model.portfolio_project_2.int__regime_changes)
[0m13:36:07.998930 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m13:36:08.002212 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m13:36:07.998522 [info ] [Thread-4 (]: 8 of 11 START sql view model analytics_dev.int__rsi_sma ........................ [RUN]
[0m13:36:08.002969 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now model.portfolio_project_2.int__rsi_sma)
[0m13:36:08.003422 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m13:36:08.006243 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m13:36:08.007689 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m13:36:08.014152 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m13:36:08.014630 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m13:36:08.018049 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m13:36:08.019580 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:36:08.019978 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m13:36:08.020355 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:36:08.020984 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:36:08.021387 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m13:36:08.021894 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:08.022841 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:36:08.023283 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:36:08.023738 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    sma_gain::decimal(18,2) as sma_gain,
    sma_loss::decimal(18,2) as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m13:36:08.024510 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:36:08.024948 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:36:08.025380 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m13:36:08.057090 [debug] [Thread-4 (]: SQL status: OK in 0.033 seconds
[0m13:36:08.060061 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:36:08.060446 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m13:36:08.075070 [debug] [Thread-3 (]: SQL status: OK in 0.049 seconds
[0m13:36:08.078293 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:36:08.078687 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m13:36:08.091458 [debug] [Thread-4 (]: SQL status: OK in 0.031 seconds
[0m13:36:08.094615 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:36:08.095003 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m13:36:08.106223 [debug] [Thread-3 (]: SQL status: OK in 0.027 seconds
[0m13:36:08.109116 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:36:08.109529 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m13:36:08.168199 [debug] [Thread-4 (]: SQL status: OK in 0.073 seconds
[0m13:36:08.171360 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m13:36:08.172106 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:36:08.172701 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m13:36:08.175716 [debug] [Thread-3 (]: SQL status: OK in 0.066 seconds
[0m13:36:08.177643 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m13:36:08.178182 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:36:08.178698 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m13:36:08.226802 [debug] [Thread-3 (]: SQL status: OK in 0.048 seconds
[0m13:36:08.230541 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:36:08.231065 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m13:36:08.231783 [debug] [Thread-4 (]: SQL status: OK in 0.059 seconds
[0m13:36:08.234707 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:36:08.235199 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m13:36:08.286020 [debug] [Thread-3 (]: SQL status: OK in 0.054 seconds
[0m13:36:08.287855 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m13:36:08.288543 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E75A41E50>]}
[0m13:36:08.289326 [info ] [Thread-3 (]: 7 of 11 OK created sql view model analytics_dev.int__regime_changes ............ [[32mOK[0m in 0.29s]
[0m13:36:08.290469 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m13:36:08.291314 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:36:08.291983 [info ] [Thread-2 (]: 9 of 11 START sql incremental model analytics_dev.mrt__stocks_with_regimes ..... [RUN]
[0m13:36:08.292778 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_classification, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m13:36:08.293280 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:36:08.303241 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:08.304434 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:36:08.308746 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:08.309435 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__3b1df40b9659" cascade
    
[0m13:36:08.309862 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:36:08.331581 [debug] [Thread-4 (]: SQL status: OK in 0.096 seconds
[0m13:36:08.333382 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m13:36:08.333981 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E75A43B90>]}
[0m13:36:08.334568 [info ] [Thread-4 (]: 8 of 11 OK created sql view model analytics_dev.int__rsi_sma ................... [[32mOK[0m in 0.33s]
[0m13:36:08.335606 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m13:36:08.336289 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m13:36:08.337017 [info ] [Thread-1 (]: 10 of 11 START sql view model analytics_dev.int__rsi_wilder .................... [RUN]
[0m13:36:08.338018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now model.portfolio_project_2.int__rsi_wilder)
[0m13:36:08.338479 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m13:36:08.341682 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m13:36:08.342586 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m13:36:08.345527 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m13:36:08.346479 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:36:08.346935 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m13:36:08.347306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:08.348818 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:36:08.349278 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:36:08.349715 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    wilder_gain::decimal(18,2) as wilder_gain,
    wilder_loss::decimal(18,2) as wilder_loss
from wilder
  );

[0m13:36:08.415871 [debug] [Thread-2 (]: SQL status: OK in 0.106 seconds
[0m13:36:08.440794 [debug] [Thread-1 (]: SQL status: OK in 0.091 seconds
[0m13:36:08.450118 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:08.452988 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:36:08.453443 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m13:36:08.453900 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m13:36:08.455571 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:36:08.457013 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:08.457420 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m13:36:08.458476 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:36:08.458836 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:08.459250 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m13:36:08.478849 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m13:36:08.480165 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:08.480579 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m13:36:08.481026 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:36:08.482136 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:36:08.482545 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:08.482899 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:36:08.490334 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m13:36:08.493699 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:36:08.494100 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m13:36:08.505071 [debug] [Thread-2 (]: SQL status: OK in 0.022 seconds
[0m13:36:08.526013 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:08.526490 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:36:08.527935 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m13:36:08.529270 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m13:36:08.529650 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:36:08.529999 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m13:36:08.530785 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:36:08.546223 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:08.546667 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,0))
 as volume, 
      
    cast(null as text)
 as regime
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:36:08.548315 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:36:08.572109 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:08.572593 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."mrt__stocks_with_regimes__3b1df40b9659"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null
    
    )
 ;
    insert into "finance"."dbt_temp"."mrt__stocks_with_regimes__3b1df40b9659" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m13:36:08.592108 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m13:36:08.595024 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:36:08.595457 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m13:36:08.721518 [debug] [Thread-1 (]: SQL status: OK in 0.126 seconds
[0m13:36:08.722938 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m13:36:08.723636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E75089670>]}
[0m13:36:08.724228 [info ] [Thread-1 (]: 10 of 11 OK created sql view model analytics_dev.int__rsi_wilder ............... [[32mOK[0m in 0.39s]
[0m13:36:08.725002 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m13:36:08.725677 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.fct__rsi
[0m13:36:08.726144 [info ] [Thread-3 (]: 11 of 11 START sql incremental model analytics_dev.fct__rsi .................... [RUN]
[0m13:36:08.726770 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_changes, now model.portfolio_project_2.fct__rsi)
[0m13:36:08.727140 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m13:36:08.731780 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m13:36:08.732777 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m13:36:08.741873 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:08.742289 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__8f3af230f638" cascade
    
[0m13:36:08.742795 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:08.799408 [debug] [Thread-3 (]: SQL status: OK in 0.057 seconds
[0m13:36:08.802322 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:08.802715 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m13:36:08.804270 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:36:08.805593 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:08.805952 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m13:36:08.807039 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:36:08.807434 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:08.807796 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m13:36:08.824937 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m13:36:08.826050 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:08.826422 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    

  
[0m13:36:08.826874 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:36:08.827964 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:36:08.828335 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:08.828710 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:36:08.848459 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m13:36:08.849503 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:08.850085 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:36:08.861896 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m13:36:08.867924 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:08.868397 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as sma_rs, 
      
    cast(null as decimal(18,2))
 as sma_rsi, 
      
    cast(null as decimal(18,2))
 as wilder_rs, 
      
    cast(null as decimal(18,2))
 as wilder_rsi
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:36:08.870307 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:36:08.872404 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:08.872899 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."fct__rsi__8f3af230f638"
  
  (
    trade_date date not null,
    ticker text not null,
    sma_rs decimal(18,2),
    sma_rsi decimal(18,2),
    wilder_rs decimal(18,2),
    wilder_rsi decimal(18,2)
    
    )
 ;
    insert into "finance"."dbt_temp"."fct__rsi__8f3af230f638" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      sma_rs ,
    
      
      sma_rsi ,
    
      
      wilder_rs ,
    
      
      wilder_rsi 
    
  )
 (
      
    select trade_date, ticker, sma_rs, sma_rsi, wilder_rs, wilder_rsi
    from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as model_subq
    );
  
  
  
[0m13:36:09.020076 [debug] [Thread-2 (]: SQL status: OK in 0.447 seconds
[0m13:36:09.027395 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:09.027834 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m13:36:09.029089 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:36:09.029497 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:09.029872 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__3b1df40b9659'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:36:09.041423 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m13:36:09.046749 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:09.047178 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:36:09.052501 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:36:09.065222 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:09.065670 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__3b1df40b9659'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:36:09.070973 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:36:09.074438 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:09.074844 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:36:09.080038 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:36:09.089027 [debug] [Thread-2 (]: 
    In "finance"."analytics_dev"."mrt__stocks_with_regimes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:36:09.089548 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:09.089913 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
SELECT version()
[0m13:36:09.091078 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:36:09.154096 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:09.155123 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:09.155710 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */


    MERGE INTO "finance"."analytics_dev"."mrt__stocks_with_regimes" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."mrt__stocks_with_regimes__3b1df40b9659" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m13:36:09.206515 [debug] [Thread-2 (]: SQL status: OK in 0.050 seconds
[0m13:36:09.208175 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:36:09.208683 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:09.209131 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:36:09.228557 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m13:36:09.231799 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:09.232315 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__3b1df40b9659" cascade
    
[0m13:36:09.289532 [debug] [Thread-2 (]: SQL status: OK in 0.057 seconds
[0m13:36:09.292413 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:36:09.292789 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__3b1df40b9659" cascade
    
[0m13:36:09.313797 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m13:36:09.315079 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m13:36:09.315588 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E770DAC90>]}
[0m13:36:09.316168 [info ] [Thread-2 (]: 9 of 11 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes  [[32mOK[0m in 1.02s]
[0m13:36:09.316987 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:36:10.360208 [debug] [Thread-3 (]: SQL status: OK in 1.487 seconds
[0m13:36:10.363756 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:10.364310 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m13:36:10.365597 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:36:10.366117 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:10.366568 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__8f3af230f638'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:36:10.372767 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:36:10.376344 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:10.376826 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:36:10.383299 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:36:10.387236 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:10.387709 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__8f3af230f638'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:36:10.393349 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:36:10.398509 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:10.399127 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:36:10.404728 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:36:10.406779 [debug] [Thread-3 (]: 
    In "finance"."analytics_dev"."fct__rsi":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:36:10.408038 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m13:36:10.409113 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:10.409566 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */


    MERGE INTO "finance"."analytics_dev"."fct__rsi" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."fct__rsi__8f3af230f638" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m13:36:10.443024 [debug] [Thread-3 (]: SQL status: OK in 0.033 seconds
[0m13:36:10.446146 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:36:10.447117 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:10.448036 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:36:10.476138 [debug] [Thread-3 (]: SQL status: OK in 0.027 seconds
[0m13:36:10.483758 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:10.485201 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__8f3af230f638" cascade
    
[0m13:36:10.564145 [debug] [Thread-3 (]: SQL status: OK in 0.078 seconds
[0m13:36:10.567378 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:36:10.567780 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__8f3af230f638" cascade
    
[0m13:36:10.593390 [debug] [Thread-3 (]: SQL status: OK in 0.025 seconds
[0m13:36:10.594677 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: Close
[0m13:36:10.595185 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f55b619-acb0-49d1-99c8-f916c07097a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E75AF2ED0>]}
[0m13:36:10.595902 [info ] [Thread-3 (]: 11 of 11 OK created sql incremental model analytics_dev.fct__rsi ............... [[32mOK[0m in 1.87s]
[0m13:36:10.596719 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m13:36:10.598593 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:10.599000 [debug] [MainThread]: On master: BEGIN
[0m13:36:10.599290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:36:10.600399 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:36:10.600709 [debug] [MainThread]: On master: COMMIT
[0m13:36:10.601026 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:10.601313 [debug] [MainThread]: On master: COMMIT
[0m13:36:10.601895 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:10.602226 [debug] [MainThread]: On master: Close
[0m13:36:10.602606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:10.602886 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m13:36:10.603171 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m13:36:10.603433 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m13:36:10.603693 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m13:36:10.603970 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m13:36:10.604235 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m13:36:10.604493 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m13:36:10.604917 [info ] [MainThread]: 
[0m13:36:10.605444 [info ] [MainThread]: Finished running 2 incremental models, 9 view models in 0 hours 0 minutes and 8.62 seconds (8.62s).
[0m13:36:10.608277 [debug] [MainThread]: Command end result
[0m13:36:10.671562 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m13:36:10.674237 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m13:36:10.680738 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m13:36:10.681149 [info ] [MainThread]: 
[0m13:36:10.681717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:36:10.682320 [info ] [MainThread]: 
[0m13:36:10.682883 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m13:36:10.683883 [debug] [MainThread]: Command `-c run` succeeded at 13:36:10.683764 after 12.52 seconds
[0m13:36:10.684256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E730EBE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E759ABD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E759AB8F0>]}
[0m13:36:10.684625 [debug] [MainThread]: Flushing usage events
[0m13:36:11.260705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:56.043109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EC44A8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EC4CB42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EC52F3ED0>]}


============================== 13:36:56.047839 | 6028adde-1c7b-4c57-9253-14573d66477d ==============================
[0m13:36:56.047839 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:36:56.048562 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:36:56.190513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6028adde-1c7b-4c57-9253-14573d66477d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EC4660180>]}
[0m13:36:56.231922 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-0ucuwllt'
[0m13:36:56.233023 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:36:56.703632 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:36:56.705073 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:36:57.146440 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:36:57.153749 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m13:36:57.597287 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m13:36:57.601366 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m13:36:58.059942 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m13:36:58.075019 [info ] [MainThread]: Updating lock file in file path: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2/package-lock.yml
[0m13:36:58.182853 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-3w6hls75'
[0m13:36:58.190606 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:36:58.885857 [info ] [MainThread]: Installed from version 1.3.2
[0m13:36:58.886477 [info ] [MainThread]: Up to date!
[0m13:36:58.886953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6028adde-1c7b-4c57-9253-14573d66477d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EC6545370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EC65456A0>]}
[0m13:36:58.887356 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m13:36:59.740843 [info ] [MainThread]: Installed from version 0.10.9
[0m13:36:59.741536 [info ] [MainThread]: Up to date!
[0m13:36:59.742205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6028adde-1c7b-4c57-9253-14573d66477d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EC655D150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EC5185040>]}
[0m13:36:59.742674 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m13:37:00.325343 [info ] [MainThread]: Installed from version 0.17.0
[0m13:37:00.325849 [info ] [MainThread]: Up to date!
[0m13:37:00.326356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6028adde-1c7b-4c57-9253-14573d66477d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EC6535EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EC6535390>]}
[0m13:37:00.329118 [debug] [MainThread]: Command `-c deps` succeeded at 13:37:00.328963 after 4.41 seconds
[0m13:37:00.329507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EC50EF1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EC64EAC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EC6552200>]}
[0m13:37:00.329908 [debug] [MainThread]: Flushing usage events
[0m13:37:00.806021 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:37:05.850587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E457788050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E457F942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4585D7ED0>]}


============================== 13:37:05.855072 | 1e11ad7b-264d-452c-bc09-eb08e087f8ce ==============================
[0m13:37:05.855072 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:37:05.855748 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --no-version-check', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m13:37:06.137075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E457940180>]}
[0m13:37:06.204737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45847B790>]}
[0m13:37:06.207358 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:37:06.482655 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:37:06.642232 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:37:06.642868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E459F6DA50>]}
[0m13:37:09.120553 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m13:37:09.121239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45A279130>]}
[0m13:37:09.910946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E459DE9A90>]}
[0m13:37:10.058384 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m13:37:10.061040 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m13:37:10.091154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45A5AEA90>]}
[0m13:37:10.091632 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m13:37:10.092136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45A2D3950>]}
[0m13:37:10.095487 [info ] [MainThread]: 
[0m13:37:10.095947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:37:10.096473 [info ] [MainThread]: 
[0m13:37:10.097120 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:37:10.102860 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m13:37:10.183986 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m13:37:10.184384 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m13:37:10.184800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:11.356038 [debug] [ThreadPool]: SQL status: OK in 1.171 seconds
[0m13:37:11.357477 [debug] [ThreadPool]: On list_finance: Close
[0m13:37:11.358348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m13:37:11.358820 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m13:37:11.365127 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:37:11.365529 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m13:37:11.365837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:11.367351 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:37:11.368664 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:37:11.368978 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m13:37:11.369939 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:37:11.370273 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:37:11.370576 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m13:37:11.392998 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m13:37:11.395288 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m13:37:11.396132 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:37:11.396933 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m13:37:11.420185 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m13:37:11.421146 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m13:37:11.426544 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m13:37:11.438636 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m13:37:11.442062 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m13:37:11.445706 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m13:37:11.446677 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m13:37:11.447729 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m13:37:11.448328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:11.448987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:11.450587 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:37:11.451114 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m13:37:11.451636 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m13:37:11.452498 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:37:11.453014 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m13:37:11.453468 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m13:37:11.479104 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m13:37:11.479562 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m13:37:11.481173 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m13:37:11.482363 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m13:37:11.483421 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m13:37:11.483734 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m13:37:11.484280 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m13:37:11.484613 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m13:37:11.488064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45A5AA8E0>]}
[0m13:37:11.488563 [debug] [MainThread]: Using duckdb connection "master"
[0m13:37:11.488889 [debug] [MainThread]: On master: BEGIN
[0m13:37:11.489204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:37:11.490447 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:37:11.490797 [debug] [MainThread]: On master: COMMIT
[0m13:37:11.491101 [debug] [MainThread]: Using duckdb connection "master"
[0m13:37:11.491410 [debug] [MainThread]: On master: COMMIT
[0m13:37:11.491973 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:37:11.492307 [debug] [MainThread]: On master: Close
[0m13:37:11.497155 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m13:37:11.498107 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m13:37:11.497702 [info ] [Thread-1 (]: 1 of 11 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m13:37:11.499257 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m13:37:11.499635 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m13:37:11.506580 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m13:37:11.498651 [info ] [Thread-2 (]: 2 of 11 START sql view model analytics_dev.src_vix ............................. [RUN]
[0m13:37:11.507586 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m13:37:11.508079 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m13:37:11.511470 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m13:37:11.512228 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m13:37:11.543846 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m13:37:11.544527 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m13:37:11.548323 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m13:37:11.549399 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:37:11.549961 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:37:11.550437 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m13:37:11.550893 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m13:37:11.551326 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:37:11.551769 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:37:11.553124 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:37:11.553558 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:37:11.553972 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m13:37:11.554745 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:37:11.555157 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:37:11.555572 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m13:37:11.589968 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m13:37:11.596264 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:37:11.596753 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m13:37:11.597193 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m13:37:11.603228 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:37:11.603962 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m13:37:11.635813 [debug] [Thread-2 (]: SQL status: OK in 0.032 seconds
[0m13:37:11.638849 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:37:11.639322 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m13:37:11.639742 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m13:37:11.707154 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:37:11.707964 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m13:37:11.740112 [debug] [Thread-2 (]: SQL status: OK in 0.032 seconds
[0m13:37:11.751634 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m13:37:11.755608 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m13:37:11.756149 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m13:37:11.756578 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:37:11.757042 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:37:11.757493 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m13:37:11.757934 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m13:37:11.818580 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m13:37:11.824445 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:37:11.824887 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m13:37:11.825307 [debug] [Thread-2 (]: SQL status: OK in 0.067 seconds
[0m13:37:11.827550 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:37:11.827963 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m13:37:11.886158 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m13:37:11.886616 [debug] [Thread-2 (]: SQL status: OK in 0.058 seconds
[0m13:37:11.888949 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m13:37:11.890217 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m13:37:11.892455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45A954910>]}
[0m13:37:11.893403 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4578BCC50>]}
[0m13:37:11.893087 [info ] [Thread-1 (]: 1 of 11 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.39s]
[0m13:37:11.894686 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m13:37:11.895332 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__stocks
[0m13:37:11.893995 [info ] [Thread-2 (]: 2 of 11 OK created sql view model analytics_dev.src_vix ........................ [[32mOK[0m in 0.38s]
[0m13:37:11.896601 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m13:37:11.895826 [info ] [Thread-3 (]: 3 of 11 START sql view model analytics_dev.stg__stocks ......................... [RUN]
[0m13:37:11.897565 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m13:37:11.897935 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m13:37:11.898312 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m13:37:11.901424 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m13:37:11.901960 [info ] [Thread-4 (]: 4 of 11 START sql view model analytics_dev.stg__vix_with_versions .............. [RUN]
[0m13:37:11.902846 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m13:37:11.903464 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m13:37:11.906555 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m13:37:11.907401 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m13:37:11.907978 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m13:37:11.911844 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m13:37:11.915292 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m13:37:11.917237 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:37:11.917810 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:37:11.918245 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m13:37:11.918685 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m13:37:11.919127 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:37:11.919658 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:37:11.921369 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:37:11.921872 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:37:11.922261 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m13:37:11.923014 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:37:11.923691 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:37:11.924282 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m13:37:11.956804 [debug] [Thread-3 (]: SQL status: OK in 0.034 seconds
[0m13:37:11.960223 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:37:11.960674 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m13:37:11.967922 [debug] [Thread-4 (]: SQL status: OK in 0.043 seconds
[0m13:37:11.970961 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:37:11.971361 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m13:37:11.992728 [debug] [Thread-3 (]: SQL status: OK in 0.032 seconds
[0m13:37:11.996065 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:37:11.996490 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m13:37:12.001540 [debug] [Thread-4 (]: SQL status: OK in 0.030 seconds
[0m13:37:12.004538 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:37:12.004957 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m13:37:12.027332 [debug] [Thread-3 (]: SQL status: OK in 0.030 seconds
[0m13:37:12.028722 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m13:37:12.029145 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:37:12.029548 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m13:37:12.036412 [debug] [Thread-4 (]: SQL status: OK in 0.031 seconds
[0m13:37:12.037794 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m13:37:12.038180 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:37:12.038537 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m13:37:12.089384 [debug] [Thread-4 (]: SQL status: OK in 0.050 seconds
[0m13:37:12.093384 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:37:12.093948 [debug] [Thread-3 (]: SQL status: OK in 0.064 seconds
[0m13:37:12.094398 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m13:37:12.097259 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:37:12.097930 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m13:37:12.158956 [debug] [Thread-3 (]: SQL status: OK in 0.061 seconds
[0m13:37:12.159418 [debug] [Thread-4 (]: SQL status: OK in 0.062 seconds
[0m13:37:12.160785 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: Close
[0m13:37:12.162037 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m13:37:12.162620 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45A87B700>]}
[0m13:37:12.163298 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E459DB5010>]}
[0m13:37:12.163951 [info ] [Thread-3 (]: 3 of 11 OK created sql view model analytics_dev.stg__stocks .................... [[32mOK[0m in 0.27s]
[0m13:37:12.165250 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m13:37:12.165915 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__price_changes
[0m13:37:12.164546 [info ] [Thread-4 (]: 4 of 11 OK created sql view model analytics_dev.stg__vix_with_versions ......... [[32mOK[0m in 0.26s]
[0m13:37:12.167065 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m13:37:12.166401 [info ] [Thread-1 (]: 5 of 11 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m13:37:12.167844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__price_changes)
[0m13:37:12.168230 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m13:37:12.170930 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m13:37:12.171417 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m13:37:12.171905 [info ] [Thread-2 (]: 6 of 11 START sql view model analytics_dev.int__regime_classification .......... [RUN]
[0m13:37:12.172599 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_classification)
[0m13:37:12.173164 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m13:37:12.173711 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m13:37:12.177090 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m13:37:12.180765 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m13:37:12.181925 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m13:37:12.185524 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m13:37:12.186039 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:37:12.186562 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m13:37:12.186917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:12.187896 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:37:12.188486 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m13:37:12.188843 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:37:12.189490 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:37:12.189931 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:37:12.190325 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."stg__stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m13:37:12.191094 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:37:12.191465 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:37:12.191846 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m13:37:12.229111 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m13:37:12.232961 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:37:12.233426 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m13:37:12.241360 [debug] [Thread-2 (]: SQL status: OK in 0.049 seconds
[0m13:37:12.244393 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:37:12.244808 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m13:37:12.288344 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m13:37:12.294505 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:37:12.294944 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m13:37:12.295553 [debug] [Thread-2 (]: SQL status: OK in 0.050 seconds
[0m13:37:12.298531 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:37:12.298928 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m13:37:12.328300 [debug] [Thread-2 (]: SQL status: OK in 0.029 seconds
[0m13:37:12.329805 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m13:37:12.330255 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:37:12.330641 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m13:37:12.331063 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m13:37:12.332368 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m13:37:12.332800 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:37:12.333186 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m13:37:12.386180 [debug] [Thread-2 (]: SQL status: OK in 0.055 seconds
[0m13:37:12.390311 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:37:12.390945 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m13:37:12.391564 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m13:37:12.395107 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:37:12.396038 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m13:37:12.461607 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m13:37:12.462071 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m13:37:12.463422 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m13:37:12.464653 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: Close
[0m13:37:12.465248 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E459FB2F30>]}
[0m13:37:12.465768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E459FB26F0>]}
[0m13:37:12.466414 [info ] [Thread-2 (]: 6 of 11 OK created sql view model analytics_dev.int__regime_classification ..... [[32mOK[0m in 0.29s]
[0m13:37:12.468010 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m13:37:12.466985 [info ] [Thread-1 (]: 5 of 11 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.30s]
[0m13:37:12.468906 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m13:37:12.469660 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m13:37:12.470545 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m13:37:12.470151 [info ] [Thread-4 (]: 8 of 11 START sql view model analytics_dev.int__rsi_sma ........................ [RUN]
[0m13:37:12.471621 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now model.portfolio_project_2.int__rsi_sma)
[0m13:37:12.471991 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m13:37:12.474740 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m13:37:12.471047 [info ] [Thread-3 (]: 7 of 11 START sql view model analytics_dev.int__regime_changes ................. [RUN]
[0m13:37:12.475691 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now model.portfolio_project_2.int__regime_changes)
[0m13:37:12.476314 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m13:37:12.479487 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m13:37:12.480270 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m13:37:12.483624 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m13:37:12.484414 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m13:37:12.488507 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m13:37:12.489617 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:37:12.490162 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:37:12.490671 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m13:37:12.491128 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m13:37:12.491610 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:37:12.492087 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:37:12.493260 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:37:12.493704 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:37:12.494119 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m13:37:12.494980 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:37:12.495416 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:37:12.495833 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    sma_gain::decimal(18,2) as sma_gain,
    sma_loss::decimal(18,2) as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m13:37:12.538851 [debug] [Thread-4 (]: SQL status: OK in 0.043 seconds
[0m13:37:12.542205 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:37:12.542595 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m13:37:12.543034 [debug] [Thread-3 (]: SQL status: OK in 0.048 seconds
[0m13:37:12.545966 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:37:12.546354 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m13:37:12.580958 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m13:37:12.584218 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:37:12.584605 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m13:37:12.585047 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m13:37:12.587729 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:37:12.588292 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m13:37:12.644919 [debug] [Thread-4 (]: SQL status: OK in 0.060 seconds
[0m13:37:12.646623 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m13:37:12.647106 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:37:12.647561 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m13:37:12.648039 [debug] [Thread-3 (]: SQL status: OK in 0.059 seconds
[0m13:37:12.649509 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m13:37:12.649957 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:37:12.650413 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m13:37:12.702248 [debug] [Thread-3 (]: SQL status: OK in 0.051 seconds
[0m13:37:12.705808 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:37:12.706338 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m13:37:12.706972 [debug] [Thread-4 (]: SQL status: OK in 0.059 seconds
[0m13:37:12.709460 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:37:12.709841 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m13:37:12.778516 [debug] [Thread-4 (]: SQL status: OK in 0.068 seconds
[0m13:37:12.779005 [debug] [Thread-3 (]: SQL status: OK in 0.072 seconds
[0m13:37:12.780423 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m13:37:12.781715 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m13:37:12.782326 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45A125730>]}
[0m13:37:12.782869 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45A394CB0>]}
[0m13:37:12.783528 [info ] [Thread-4 (]: 8 of 11 OK created sql view model analytics_dev.int__rsi_sma ................... [[32mOK[0m in 0.31s]
[0m13:37:12.784916 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m13:37:12.784176 [info ] [Thread-3 (]: 7 of 11 OK created sql view model analytics_dev.int__regime_changes ............ [[32mOK[0m in 0.31s]
[0m13:37:12.785874 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m13:37:12.786307 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m13:37:12.786771 [info ] [Thread-2 (]: 9 of 11 START sql view model analytics_dev.int__rsi_wilder ..................... [RUN]
[0m13:37:12.787619 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_classification, now model.portfolio_project_2.int__rsi_wilder)
[0m13:37:12.787999 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m13:37:12.788401 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:37:12.792928 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m13:37:12.793579 [info ] [Thread-1 (]: 10 of 11 START sql incremental model analytics_dev.mrt__stocks_with_regimes .... [RUN]
[0m13:37:12.794304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m13:37:12.794741 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:37:12.801937 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:12.802995 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m13:37:12.806661 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m13:37:12.807210 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:37:12.812545 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:12.813577 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__75326d8a7f69" cascade
    
[0m13:37:12.814243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:12.815387 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:37:12.816014 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m13:37:12.816547 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:37:12.817940 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:37:12.818346 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:37:12.818738 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    wilder_gain::decimal(18,2) as wilder_gain,
    wilder_loss::decimal(18,2) as wilder_loss
from wilder
  );

[0m13:37:12.839722 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m13:37:12.872079 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:12.872581 [debug] [Thread-2 (]: SQL status: OK in 0.053 seconds
[0m13:37:12.873035 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m13:37:12.879864 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:37:12.880742 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m13:37:12.881668 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:37:12.883219 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:12.883626 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m13:37:12.884718 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:37:12.885124 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:12.885491 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m13:37:12.908290 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m13:37:12.909489 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:12.909907 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m13:37:12.910359 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:37:12.911490 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:37:12.911901 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:12.912270 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:37:12.912768 [debug] [Thread-2 (]: SQL status: OK in 0.032 seconds
[0m13:37:12.915773 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:37:12.916202 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m13:37:12.934677 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m13:37:12.956636 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:12.957161 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:37:12.958671 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m13:37:12.960215 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m13:37:12.960634 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:37:12.961018 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m13:37:12.961853 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:37:12.977757 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:12.978242 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,0))
 as volume, 
      
    cast(null as text)
 as regime
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:37:12.979769 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:37:13.005109 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:13.005625 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."mrt__stocks_with_regimes__75326d8a7f69"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null
    
    )
 ;
    insert into "finance"."dbt_temp"."mrt__stocks_with_regimes__75326d8a7f69" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m13:37:13.017183 [debug] [Thread-2 (]: SQL status: OK in 0.056 seconds
[0m13:37:13.020528 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:37:13.020952 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m13:37:13.116532 [debug] [Thread-2 (]: SQL status: OK in 0.095 seconds
[0m13:37:13.118006 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m13:37:13.118563 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E459FEA390>]}
[0m13:37:13.119162 [info ] [Thread-2 (]: 9 of 11 OK created sql view model analytics_dev.int__rsi_wilder ................ [[32mOK[0m in 0.33s]
[0m13:37:13.120001 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m13:37:13.120714 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.fct__rsi
[0m13:37:13.121189 [info ] [Thread-4 (]: 11 of 11 START sql incremental model analytics_dev.fct__rsi .................... [RUN]
[0m13:37:13.121806 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_sma, now model.portfolio_project_2.fct__rsi)
[0m13:37:13.122219 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m13:37:13.127293 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m13:37:13.128567 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m13:37:13.132952 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:13.133404 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__70f0feda6f90" cascade
    
[0m13:37:13.133766 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:37:13.189324 [debug] [Thread-4 (]: SQL status: OK in 0.055 seconds
[0m13:37:13.191891 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:13.192308 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m13:37:13.193760 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:37:13.195113 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:13.195475 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m13:37:13.196449 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:37:13.196813 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:13.197193 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m13:37:13.207613 [debug] [Thread-1 (]: SQL status: OK in 0.201 seconds
[0m13:37:13.214875 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:13.215339 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m13:37:13.215839 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m13:37:13.217268 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:13.217681 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    

  
[0m13:37:13.218113 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:37:13.219253 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:37:13.219660 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:13.220014 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:37:13.220500 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:37:13.220927 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:13.221314 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__75326d8a7f69'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:37:13.226745 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:37:13.231753 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:13.232195 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:37:13.237334 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:37:13.250240 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:13.250694 [debug] [Thread-4 (]: SQL status: OK in 0.030 seconds
[0m13:37:13.251140 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__75326d8a7f69'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:37:13.252025 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:13.252741 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:37:13.257360 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:37:13.260550 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:13.260968 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:37:13.261686 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m13:37:13.267265 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:13.267752 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as sma_rs, 
      
    cast(null as decimal(18,2))
 as sma_rsi, 
      
    cast(null as decimal(18,2))
 as wilder_rs, 
      
    cast(null as decimal(18,2))
 as wilder_rsi
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:37:13.268371 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:37:13.277221 [debug] [Thread-1 (]: 
    In "finance"."analytics_dev"."mrt__stocks_with_regimes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:37:13.277750 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:13.278133 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
SELECT version()
[0m13:37:13.278640 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m13:37:13.279154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:37:13.298731 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:13.299279 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."fct__rsi__70f0feda6f90"
  
  (
    trade_date date not null,
    ticker text not null,
    sma_rs decimal(18,2),
    sma_rsi decimal(18,2),
    wilder_rs decimal(18,2),
    wilder_rsi decimal(18,2)
    
    )
 ;
    insert into "finance"."dbt_temp"."fct__rsi__70f0feda6f90" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      sma_rs ,
    
      
      sma_rsi ,
    
      
      wilder_rs ,
    
      
      wilder_rsi 
    
  )
 (
      
    select trade_date, ticker, sma_rs, sma_rsi, wilder_rs, wilder_rsi
    from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as model_subq
    );
  
  
  
[0m13:37:13.348779 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:13.349835 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:13.350244 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */


    MERGE INTO "finance"."analytics_dev"."mrt__stocks_with_regimes" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."mrt__stocks_with_regimes__75326d8a7f69" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m13:37:13.400287 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m13:37:13.401669 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:37:13.402048 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:13.402423 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:37:13.470928 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m13:37:13.476143 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:13.477046 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__75326d8a7f69" cascade
    
[0m13:37:13.533451 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m13:37:13.536516 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:37:13.536907 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__75326d8a7f69" cascade
    
[0m13:37:13.557856 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m13:37:13.559160 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m13:37:13.559804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E459FDD850>]}
[0m13:37:13.560399 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes  [[32mOK[0m in 0.77s]
[0m13:37:13.561202 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:37:14.638516 [debug] [Thread-4 (]: SQL status: OK in 1.338 seconds
[0m13:37:14.645891 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:14.646656 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m13:37:14.648793 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:37:14.649522 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:14.650240 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__70f0feda6f90'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:37:14.656650 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m13:37:14.659607 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:14.659994 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:37:14.664931 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:37:14.668191 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:14.668576 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__70f0feda6f90'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:37:14.673429 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:37:14.676268 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:14.676648 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:37:14.681554 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:37:14.683374 [debug] [Thread-4 (]: 
    In "finance"."analytics_dev"."fct__rsi":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:37:14.684571 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m13:37:14.685682 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:14.686119 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */


    MERGE INTO "finance"."analytics_dev"."fct__rsi" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."fct__rsi__70f0feda6f90" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m13:37:14.708513 [debug] [Thread-4 (]: SQL status: OK in 0.022 seconds
[0m13:37:14.709812 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:37:14.710200 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:14.710548 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:37:14.732474 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m13:37:14.739135 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:14.739664 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__70f0feda6f90" cascade
    
[0m13:37:14.806228 [debug] [Thread-4 (]: SQL status: OK in 0.066 seconds
[0m13:37:14.809564 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:37:14.809933 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__70f0feda6f90" cascade
    
[0m13:37:14.836159 [debug] [Thread-4 (]: SQL status: OK in 0.026 seconds
[0m13:37:14.837463 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: Close
[0m13:37:14.837963 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e11ad7b-264d-452c-bc09-eb08e087f8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E459FEA570>]}
[0m13:37:14.838532 [info ] [Thread-4 (]: 11 of 11 OK created sql incremental model analytics_dev.fct__rsi ............... [[32mOK[0m in 1.72s]
[0m13:37:14.839318 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m13:37:14.840907 [debug] [MainThread]: Using duckdb connection "master"
[0m13:37:14.841252 [debug] [MainThread]: On master: BEGIN
[0m13:37:14.841539 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:37:14.842670 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:37:14.842981 [debug] [MainThread]: On master: COMMIT
[0m13:37:14.843297 [debug] [MainThread]: Using duckdb connection "master"
[0m13:37:14.843581 [debug] [MainThread]: On master: COMMIT
[0m13:37:14.844143 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:37:14.844452 [debug] [MainThread]: On master: Close
[0m13:37:14.844821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:14.845117 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m13:37:14.845384 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m13:37:14.845646 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m13:37:14.845907 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m13:37:14.846186 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m13:37:14.846452 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m13:37:14.846712 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m13:37:14.847207 [info ] [MainThread]: 
[0m13:37:14.847979 [info ] [MainThread]: Finished running 2 incremental models, 9 view models in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m13:37:14.850477 [debug] [MainThread]: Command end result
[0m13:37:14.914048 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m13:37:14.916699 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m13:37:14.923204 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m13:37:14.923603 [info ] [MainThread]: 
[0m13:37:14.924166 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:37:14.924649 [info ] [MainThread]: 
[0m13:37:14.925165 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m13:37:14.925847 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 14 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:37:14.926804 [debug] [MainThread]: Command `-c run` succeeded at 13:37:14.926695 after 9.19 seconds
[0m13:37:14.927182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E458463E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45A967D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45A9677D0>]}
[0m13:37:14.927535 [debug] [MainThread]: Flushing usage events
[0m13:37:15.448670 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:37:58.843220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FD8A8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE0B42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE6F3ED0>]}


============================== 13:37:58.847774 | fb52bb08-962d-434e-a34a-ed93f05ae7d0 ==============================
[0m13:37:58.847774 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:37:58.848638 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt clean', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m13:37:58.990373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb52bb08-962d-434e-a34a-ed93f05ae7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FDA60180>]}
[0m13:37:59.194418 [debug] [MainThread]: Command `-c clean` succeeded at 13:37:59.194293 after 0.48 seconds
[0m13:37:59.194823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE599E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE599F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE593E50>]}
[0m13:37:59.195195 [debug] [MainThread]: Flushing usage events
[0m13:37:59.787662 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:04.392306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FA668050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FAE742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FB4B7ED0>]}


============================== 13:38:04.396844 | 68c34538-0826-445f-916f-e0945f21cd4c ==============================
[0m13:38:04.396844 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:38:04.397841 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m13:38:04.540345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68c34538-0826-445f-916f-e0945f21cd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FA820180>]}
[0m13:38:04.573313 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-5ig9z2rl'
[0m13:38:04.573779 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:38:05.138505 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:38:05.139992 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:38:05.612419 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:38:05.616936 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m13:38:06.081518 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m13:38:06.085830 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m13:38:06.524407 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m13:38:06.528606 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:38:07.248312 [info ] [MainThread]: Installed from version 1.3.2
[0m13:38:07.248829 [info ] [MainThread]: Up to date!
[0m13:38:07.249309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '68c34538-0826-445f-916f-e0945f21cd4c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FB35AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FB35A580>]}
[0m13:38:07.249718 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m13:38:08.080959 [info ] [MainThread]: Installed from version 0.10.9
[0m13:38:08.081456 [info ] [MainThread]: Up to date!
[0m13:38:08.081924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '68c34538-0826-445f-916f-e0945f21cd4c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FC6BD050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FB34B890>]}
[0m13:38:08.082337 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m13:38:08.653036 [info ] [MainThread]: Installed from version 0.17.0
[0m13:38:08.653595 [info ] [MainThread]: Up to date!
[0m13:38:08.654102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '68c34538-0826-445f-916f-e0945f21cd4c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FC699A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FC699470>]}
[0m13:38:08.656757 [debug] [MainThread]: Command `-c deps` succeeded at 13:38:08.656618 after 4.39 seconds
[0m13:38:08.657136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FB2AF1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FC64A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FC6B1DE0>]}
[0m13:38:08.657526 [debug] [MainThread]: Flushing usage events
[0m13:38:09.151259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:13.898139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C725C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C7A642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C80A3ED0>]}


============================== 13:38:13.902483 | e1f581dd-7634-48d1-9a5a-71e7a25e350f ==============================
[0m13:38:13.902483 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:38:13.903352 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt run', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:38:14.158492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C7410180>]}
[0m13:38:14.225552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C7F4B790>]}
[0m13:38:14.228230 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:38:14.496928 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:38:14.498283 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:38:14.498831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C9191650>]}
[0m13:38:17.092945 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m13:38:17.093634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C9C4F5C0>]}
[0m13:38:17.667206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C97AD2B0>]}
[0m13:38:17.819542 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m13:38:17.824158 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m13:38:17.859081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C9FEDB20>]}
[0m13:38:17.859591 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m13:38:17.860125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C9EAAC90>]}
[0m13:38:17.863674 [info ] [MainThread]: 
[0m13:38:17.864189 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:17.864678 [info ] [MainThread]: 
[0m13:38:17.865709 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:38:17.871258 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m13:38:17.953606 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m13:38:17.954033 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m13:38:17.954356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:19.534658 [debug] [ThreadPool]: SQL status: OK in 1.580 seconds
[0m13:38:19.536109 [debug] [ThreadPool]: On list_finance: Close
[0m13:38:19.536820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m13:38:19.537316 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m13:38:19.543553 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:38:19.543888 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m13:38:19.544204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:19.545886 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:38:19.547217 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:38:19.547636 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m13:38:19.548741 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:38:19.549093 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:38:19.549409 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m13:38:19.571228 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:38:19.572222 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m13:38:19.572569 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:38:19.572875 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m13:38:19.599235 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m13:38:19.599697 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m13:38:19.602289 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m13:38:19.607416 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m13:38:19.610093 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m13:38:19.611870 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m13:38:19.612361 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m13:38:19.612956 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m13:38:19.613343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:19.613726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:19.614842 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:38:19.615194 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m13:38:19.615547 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m13:38:19.616052 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:38:19.616425 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m13:38:19.616766 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m13:38:19.642429 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m13:38:19.642843 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m13:38:19.644265 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m13:38:19.645632 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m13:38:19.646692 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m13:38:19.647060 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m13:38:19.647702 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m13:38:19.648030 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m13:38:19.651377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298CB324260>]}
[0m13:38:19.651861 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:19.652165 [debug] [MainThread]: On master: BEGIN
[0m13:38:19.652450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:19.653528 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:38:19.653868 [debug] [MainThread]: On master: COMMIT
[0m13:38:19.655961 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:19.656397 [debug] [MainThread]: On master: COMMIT
[0m13:38:19.657165 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:19.657501 [debug] [MainThread]: On master: Close
[0m13:38:19.662381 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m13:38:19.663302 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m13:38:19.662912 [info ] [Thread-1 (]: 1 of 11 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m13:38:19.664438 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m13:38:19.664817 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m13:38:19.671856 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m13:38:19.663816 [info ] [Thread-2 (]: 2 of 11 START sql view model analytics_dev.src_vix ............................. [RUN]
[0m13:38:19.672854 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m13:38:19.673250 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m13:38:19.676317 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m13:38:19.679160 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m13:38:19.684725 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m13:38:19.723123 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m13:38:19.724295 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m13:38:19.728154 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:38:19.728667 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:38:19.729094 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m13:38:19.729498 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m13:38:19.729913 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:38:19.730338 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:38:19.731616 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:38:19.732057 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:38:19.732456 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m13:38:19.733083 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:38:19.733496 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:38:19.733918 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m13:38:19.771834 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m13:38:19.777949 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:38:19.778419 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m13:38:19.779050 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m13:38:19.782325 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:38:19.782717 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m13:38:19.816947 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m13:38:19.820161 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:38:19.820603 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m13:38:19.821040 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m13:38:19.824199 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:38:19.824600 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m13:38:19.865771 [debug] [Thread-2 (]: SQL status: OK in 0.045 seconds
[0m13:38:19.872653 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m13:38:19.883186 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m13:38:19.885089 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m13:38:19.885732 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:38:19.886390 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:38:19.887034 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m13:38:19.887658 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m13:38:19.955724 [debug] [Thread-2 (]: SQL status: OK in 0.067 seconds
[0m13:38:19.961523 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:38:19.961927 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m13:38:19.962335 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m13:38:19.964919 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:38:19.965388 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m13:38:20.025856 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m13:38:20.028347 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m13:38:20.030582 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C7380550>]}
[0m13:38:20.031223 [info ] [Thread-2 (]: 2 of 11 OK created sql view model analytics_dev.src_vix ........................ [[32mOK[0m in 0.36s]
[0m13:38:20.032028 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m13:38:20.032696 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m13:38:20.033176 [info ] [Thread-3 (]: 3 of 11 START sql view model analytics_dev.stg__vix_with_versions .............. [RUN]
[0m13:38:20.033934 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m13:38:20.034316 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m13:38:20.037569 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m13:38:20.039078 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m13:38:20.042154 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m13:38:20.043714 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:38:20.044362 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m13:38:20.044845 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:38:20.046218 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:38:20.046611 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:38:20.047575 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m13:38:20.084340 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m13:38:20.085806 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m13:38:20.086348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298CB2CDF50>]}
[0m13:38:20.086943 [info ] [Thread-1 (]: 1 of 11 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.42s]
[0m13:38:20.087748 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m13:38:20.088435 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__stocks
[0m13:38:20.088923 [info ] [Thread-4 (]: 4 of 11 START sql view model analytics_dev.stg__stocks ......................... [RUN]
[0m13:38:20.089606 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m13:38:20.090045 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m13:38:20.092722 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m13:38:20.095240 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m13:38:20.099377 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m13:38:20.100592 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:38:20.101002 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m13:38:20.101762 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:38:20.103010 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:38:20.103370 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:38:20.103772 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m13:38:20.113148 [debug] [Thread-3 (]: SQL status: OK in 0.065 seconds
[0m13:38:20.116415 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:38:20.116847 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m13:38:20.142098 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m13:38:20.145410 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:38:20.145815 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m13:38:20.153721 [debug] [Thread-3 (]: SQL status: OK in 0.036 seconds
[0m13:38:20.156733 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:38:20.157140 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m13:38:20.180047 [debug] [Thread-4 (]: SQL status: OK in 0.034 seconds
[0m13:38:20.186770 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:38:20.187230 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m13:38:20.188803 [debug] [Thread-3 (]: SQL status: OK in 0.031 seconds
[0m13:38:20.190127 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m13:38:20.190511 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:38:20.190876 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m13:38:20.222442 [debug] [Thread-4 (]: SQL status: OK in 0.035 seconds
[0m13:38:20.223894 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m13:38:20.224330 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:38:20.224717 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m13:38:20.293201 [debug] [Thread-4 (]: SQL status: OK in 0.068 seconds
[0m13:38:20.366031 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:38:20.366643 [debug] [Thread-3 (]: SQL status: OK in 0.175 seconds
[0m13:38:20.367239 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m13:38:20.371175 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:38:20.372060 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m13:38:20.438436 [debug] [Thread-3 (]: SQL status: OK in 0.066 seconds
[0m13:38:20.438931 [debug] [Thread-4 (]: SQL status: OK in 0.067 seconds
[0m13:38:20.440296 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m13:38:20.441529 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: Close
[0m13:38:20.442135 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298CC95F380>]}
[0m13:38:20.442665 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298CC9B5320>]}
[0m13:38:20.443316 [info ] [Thread-3 (]: 3 of 11 OK created sql view model analytics_dev.stg__vix_with_versions ......... [[32mOK[0m in 0.41s]
[0m13:38:20.444599 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m13:38:20.445324 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m13:38:20.443909 [info ] [Thread-4 (]: 4 of 11 OK created sql view model analytics_dev.stg__stocks .................... [[32mOK[0m in 0.35s]
[0m13:38:20.446622 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m13:38:20.445956 [info ] [Thread-2 (]: 5 of 11 START sql view model analytics_dev.int__regime_classification .......... [RUN]
[0m13:38:20.447578 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_classification)
[0m13:38:20.447951 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m13:38:20.450911 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m13:38:20.451400 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__price_changes
[0m13:38:20.451875 [info ] [Thread-1 (]: 6 of 11 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m13:38:20.452611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__price_changes)
[0m13:38:20.453199 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m13:38:20.456249 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m13:38:20.457039 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m13:38:20.461465 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m13:38:20.462391 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m13:38:20.466296 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m13:38:20.467444 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:38:20.467865 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m13:38:20.468211 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:38:20.468871 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:38:20.469275 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m13:38:20.469609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:20.470284 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:38:20.470678 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:38:20.471060 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m13:38:20.471813 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:38:20.472172 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:38:20.472556 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."stg__stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m13:38:20.506030 [debug] [Thread-2 (]: SQL status: OK in 0.035 seconds
[0m13:38:20.509427 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:38:20.509892 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m13:38:20.543470 [debug] [Thread-2 (]: SQL status: OK in 0.033 seconds
[0m13:38:20.546885 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:38:20.547306 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m13:38:20.547898 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m13:38:20.551197 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:38:20.551640 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m13:38:20.582164 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m13:38:20.585224 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:38:20.585653 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m13:38:20.586224 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m13:38:20.587465 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m13:38:20.587847 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:38:20.588217 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m13:38:20.617030 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m13:38:20.618427 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m13:38:20.618821 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:38:20.619179 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m13:38:20.651554 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m13:38:20.655069 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:38:20.655612 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m13:38:20.683428 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m13:38:20.685885 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:38:20.686306 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m13:38:20.740253 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m13:38:20.742230 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: Close
[0m13:38:20.742696 [debug] [Thread-2 (]: SQL status: OK in 0.087 seconds
[0m13:38:20.743927 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m13:38:20.744444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C9DC07D0>]}
[0m13:38:20.745499 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C9D61190>]}
[0m13:38:20.745021 [info ] [Thread-1 (]: 6 of 11 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.29s]
[0m13:38:20.746710 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m13:38:20.746059 [info ] [Thread-2 (]: 5 of 11 OK created sql view model analytics_dev.int__regime_classification ..... [[32mOK[0m in 0.30s]
[0m13:38:20.747585 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m13:38:20.748070 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m13:38:20.748563 [info ] [Thread-3 (]: 7 of 11 START sql view model analytics_dev.int__rsi_sma ........................ [RUN]
[0m13:38:20.749115 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now model.portfolio_project_2.int__rsi_sma)
[0m13:38:20.749512 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m13:38:20.752151 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m13:38:20.752703 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m13:38:20.753196 [info ] [Thread-4 (]: 8 of 11 START sql view model analytics_dev.int__regime_changes ................. [RUN]
[0m13:38:20.753794 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now model.portfolio_project_2.int__regime_changes)
[0m13:38:20.754355 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m13:38:20.761113 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m13:38:20.762307 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m13:38:20.766802 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m13:38:20.767896 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m13:38:20.772315 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m13:38:20.773370 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:38:20.773794 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m13:38:20.774164 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:38:20.775073 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:38:20.775604 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m13:38:20.775982 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:38:20.776635 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:38:20.777022 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:38:20.777448 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    sma_gain::decimal(18,2) as sma_gain,
    sma_loss::decimal(18,2) as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m13:38:20.778207 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:38:20.778653 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:38:20.779201 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m13:38:20.818038 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m13:38:20.822671 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:38:20.823338 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m13:38:20.829318 [debug] [Thread-4 (]: SQL status: OK in 0.050 seconds
[0m13:38:20.832419 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:38:20.832828 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m13:38:20.857206 [debug] [Thread-3 (]: SQL status: OK in 0.033 seconds
[0m13:38:20.860431 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:38:20.860844 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m13:38:20.893895 [debug] [Thread-3 (]: SQL status: OK in 0.033 seconds
[0m13:38:20.895271 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m13:38:20.895688 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:38:20.896051 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m13:38:20.896619 [debug] [Thread-4 (]: SQL status: OK in 0.063 seconds
[0m13:38:20.899685 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:38:20.900159 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m13:38:20.935347 [debug] [Thread-4 (]: SQL status: OK in 0.035 seconds
[0m13:38:20.940621 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m13:38:20.941061 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:38:20.941423 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m13:38:20.958687 [debug] [Thread-3 (]: SQL status: OK in 0.062 seconds
[0m13:38:20.961404 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:38:20.961839 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m13:38:20.996553 [debug] [Thread-4 (]: SQL status: OK in 0.055 seconds
[0m13:38:20.999337 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:38:20.999740 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m13:38:21.065159 [debug] [Thread-3 (]: SQL status: OK in 0.103 seconds
[0m13:38:21.065653 [debug] [Thread-4 (]: SQL status: OK in 0.065 seconds
[0m13:38:21.067120 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m13:38:21.068366 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m13:38:21.068955 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C962A930>]}
[0m13:38:21.069508 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C9DC07D0>]}
[0m13:38:21.070170 [info ] [Thread-3 (]: 7 of 11 OK created sql view model analytics_dev.int__rsi_sma ................... [[32mOK[0m in 0.32s]
[0m13:38:21.071447 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m13:38:21.072188 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m13:38:21.070768 [info ] [Thread-4 (]: 8 of 11 OK created sql view model analytics_dev.int__regime_changes ............ [[32mOK[0m in 0.32s]
[0m13:38:21.073353 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m13:38:21.072666 [info ] [Thread-1 (]: 9 of 11 START sql view model analytics_dev.int__rsi_wilder ..................... [RUN]
[0m13:38:21.074049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now model.portfolio_project_2.int__rsi_wilder)
[0m13:38:21.074449 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m13:38:21.077312 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m13:38:21.077849 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:38:21.078396 [info ] [Thread-2 (]: 10 of 11 START sql incremental model analytics_dev.mrt__stocks_with_regimes .... [RUN]
[0m13:38:21.079047 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_classification, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m13:38:21.079585 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:38:21.080082 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m13:38:21.086795 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.090388 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m13:38:21.091542 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:38:21.091968 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m13:38:21.092327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:21.093218 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:38:21.097399 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.097846 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__2ddf216f344e" cascade
    
[0m13:38:21.098214 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:38:21.099072 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:38:21.099616 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:38:21.100033 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    wilder_gain::decimal(18,2) as wilder_gain,
    wilder_loss::decimal(18,2) as wilder_loss
from wilder
  );

[0m13:38:21.129677 [debug] [Thread-2 (]: SQL status: OK in 0.031 seconds
[0m13:38:21.159629 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m13:38:21.164517 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.167657 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:38:21.168127 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m13:38:21.168591 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m13:38:21.170277 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:38:21.171679 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.172080 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m13:38:21.173075 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:38:21.173439 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.173797 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m13:38:21.198556 [debug] [Thread-2 (]: SQL status: OK in 0.024 seconds
[0m13:38:21.199020 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m13:38:21.200144 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.203044 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:38:21.203487 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m13:38:21.203998 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m13:38:21.204527 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:38:21.205887 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:38:21.206306 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.206666 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:38:21.231993 [debug] [Thread-2 (]: SQL status: OK in 0.025 seconds
[0m13:38:21.253671 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.254132 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m13:38:21.254685 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:38:21.256050 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m13:38:21.256789 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:38:21.257196 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m13:38:21.260445 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:38:21.275508 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.275943 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,0))
 as volume, 
      
    cast(null as text)
 as regime
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:38:21.277473 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:38:21.301881 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.302403 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."mrt__stocks_with_regimes__2ddf216f344e"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null
    
    )
 ;
    insert into "finance"."dbt_temp"."mrt__stocks_with_regimes__2ddf216f344e" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m13:38:21.316377 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m13:38:21.319244 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:38:21.319616 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m13:38:21.386406 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m13:38:21.387824 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m13:38:21.388345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C955D5B0>]}
[0m13:38:21.388963 [info ] [Thread-1 (]: 9 of 11 OK created sql view model analytics_dev.int__rsi_wilder ................ [[32mOK[0m in 0.31s]
[0m13:38:21.389916 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m13:38:21.390579 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.fct__rsi
[0m13:38:21.391310 [info ] [Thread-3 (]: 11 of 11 START sql incremental model analytics_dev.fct__rsi .................... [RUN]
[0m13:38:21.392210 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_sma, now model.portfolio_project_2.fct__rsi)
[0m13:38:21.392602 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m13:38:21.397568 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m13:38:21.399993 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m13:38:21.404055 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:21.404505 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__52c30d3b4e4f" cascade
    
[0m13:38:21.404920 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:38:21.463012 [debug] [Thread-3 (]: SQL status: OK in 0.058 seconds
[0m13:38:21.465719 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:21.466122 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m13:38:21.467803 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:38:21.469175 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:21.469574 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m13:38:21.470560 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:38:21.470928 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:21.471288 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m13:38:21.482288 [debug] [Thread-2 (]: SQL status: OK in 0.179 seconds
[0m13:38:21.489581 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.490004 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m13:38:21.491218 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:38:21.491618 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.491987 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__2ddf216f344e'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:38:21.493284 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m13:38:21.494358 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:21.494768 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    

  
[0m13:38:21.495187 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:38:21.496278 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:38:21.496678 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:21.497030 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:38:21.498264 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:38:21.503218 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.503642 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:38:21.508723 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:38:21.521790 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.522287 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__2ddf216f344e'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:38:21.522843 [debug] [Thread-3 (]: SQL status: OK in 0.025 seconds
[0m13:38:21.523689 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:21.524140 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:38:21.527532 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:38:21.534973 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.535447 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:38:21.536078 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m13:38:21.540953 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:21.541375 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as sma_rs, 
      
    cast(null as decimal(18,2))
 as sma_rsi, 
      
    cast(null as decimal(18,2))
 as wilder_rs, 
      
    cast(null as decimal(18,2))
 as wilder_rsi
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:38:21.542047 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:38:21.550913 [debug] [Thread-2 (]: 
    In "finance"."analytics_dev"."mrt__stocks_with_regimes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:38:21.551465 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.551849 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
SELECT version()
[0m13:38:21.552448 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m13:38:21.552942 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:38:21.579136 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:21.579647 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."fct__rsi__52c30d3b4e4f"
  
  (
    trade_date date not null,
    ticker text not null,
    sma_rs decimal(18,2),
    sma_rsi decimal(18,2),
    wilder_rs decimal(18,2),
    wilder_rsi decimal(18,2)
    
    )
 ;
    insert into "finance"."dbt_temp"."fct__rsi__52c30d3b4e4f" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      sma_rs ,
    
      
      sma_rsi ,
    
      
      wilder_rs ,
    
      
      wilder_rsi 
    
  )
 (
      
    select trade_date, ticker, sma_rs, sma_rsi, wilder_rs, wilder_rsi
    from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as model_subq
    );
  
  
  
[0m13:38:21.621115 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.622716 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.623181 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */


    MERGE INTO "finance"."analytics_dev"."mrt__stocks_with_regimes" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."mrt__stocks_with_regimes__2ddf216f344e" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m13:38:21.694133 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m13:38:21.698456 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:38:21.699873 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.701218 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:38:21.769730 [debug] [Thread-2 (]: SQL status: OK in 0.067 seconds
[0m13:38:21.781390 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.782832 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__2ddf216f344e" cascade
    
[0m13:38:21.878055 [debug] [Thread-2 (]: SQL status: OK in 0.093 seconds
[0m13:38:21.884221 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:38:21.884982 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__2ddf216f344e" cascade
    
[0m13:38:21.909249 [debug] [Thread-2 (]: SQL status: OK in 0.024 seconds
[0m13:38:21.910804 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m13:38:21.911468 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C9D60F50>]}
[0m13:38:21.912173 [info ] [Thread-2 (]: 10 of 11 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes  [[32mOK[0m in 0.83s]
[0m13:38:21.913106 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:38:22.990558 [debug] [Thread-3 (]: SQL status: OK in 1.398 seconds
[0m13:38:22.995130 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:22.995627 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m13:38:22.997118 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:38:22.997647 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:22.998201 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__52c30d3b4e4f'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:38:23.005288 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:38:23.009685 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:23.010301 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:38:23.018246 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m13:38:23.023300 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:23.023858 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__52c30d3b4e4f'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:38:23.035115 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m13:38:23.043031 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:23.044025 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:38:23.055861 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m13:38:23.060064 [debug] [Thread-3 (]: 
    In "finance"."analytics_dev"."fct__rsi":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:38:23.063151 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m13:38:23.065312 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:23.066505 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */


    MERGE INTO "finance"."analytics_dev"."fct__rsi" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."fct__rsi__52c30d3b4e4f" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m13:38:23.092320 [debug] [Thread-3 (]: SQL status: OK in 0.025 seconds
[0m13:38:23.093780 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:38:23.094217 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:23.094585 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:38:23.115377 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m13:38:23.118235 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:23.118626 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__52c30d3b4e4f" cascade
    
[0m13:38:23.202209 [debug] [Thread-3 (]: SQL status: OK in 0.083 seconds
[0m13:38:23.205599 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:38:23.205982 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__52c30d3b4e4f" cascade
    
[0m13:38:23.230398 [debug] [Thread-3 (]: SQL status: OK in 0.024 seconds
[0m13:38:23.231919 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: Close
[0m13:38:23.232617 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f581dd-7634-48d1-9a5a-71e7a25e350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C941D970>]}
[0m13:38:23.233268 [info ] [Thread-3 (]: 11 of 11 OK created sql incremental model analytics_dev.fct__rsi ............... [[32mOK[0m in 1.84s]
[0m13:38:23.234124 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m13:38:23.235729 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:23.236072 [debug] [MainThread]: On master: BEGIN
[0m13:38:23.236411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:23.237692 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:38:23.238060 [debug] [MainThread]: On master: COMMIT
[0m13:38:23.238368 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:23.238687 [debug] [MainThread]: On master: COMMIT
[0m13:38:23.239262 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:23.239585 [debug] [MainThread]: On master: Close
[0m13:38:23.240011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:23.240356 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m13:38:23.240668 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m13:38:23.240945 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m13:38:23.241216 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m13:38:23.241491 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m13:38:23.241790 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m13:38:23.242058 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m13:38:23.242443 [info ] [MainThread]: 
[0m13:38:23.242991 [info ] [MainThread]: Finished running 2 incremental models, 9 view models in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m13:38:23.245525 [debug] [MainThread]: Command end result
[0m13:38:23.308341 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m13:38:23.311118 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m13:38:23.317854 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m13:38:23.318235 [info ] [MainThread]: 
[0m13:38:23.318816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:23.319349 [info ] [MainThread]: 
[0m13:38:23.319887 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m13:38:23.320665 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 14 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:38:23.321685 [debug] [MainThread]: Command `-c run` succeeded at 13:38:23.321566 after 9.54 seconds
[0m13:38:23.322076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C72F0E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298C9EEA2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298CB307050>]}
[0m13:38:23.322438 [debug] [MainThread]: Flushing usage events
[0m13:38:23.932907 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:40:00.232993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019358BE8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193593F42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019359A33ED0>]}


============================== 13:40:00.237516 | 9ed7676a-6377-41f3-92cd-4f7ae090b760 ==============================
[0m13:40:00.237516 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:40:00.238209 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'target_path': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m13:40:00.511384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019358DA0180>]}
[0m13:40:00.578628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193598DB790>]}
[0m13:40:00.581234 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:40:00.861033 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:40:01.029823 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:40:01.030428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935B311A50>]}
[0m13:40:03.170301 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m13:40:03.171014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935B625220>]}
[0m13:40:03.957368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935B6A9A90>]}
[0m13:40:04.105990 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m13:40:04.108612 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m13:40:04.143094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935B954600>]}
[0m13:40:04.143584 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m13:40:04.144111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935B687650>]}
[0m13:40:04.147472 [info ] [MainThread]: 
[0m13:40:04.148000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:40:04.148476 [info ] [MainThread]: 
[0m13:40:04.149172 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:40:04.156295 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m13:40:04.236051 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m13:40:04.236437 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m13:40:04.236773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:05.420348 [debug] [ThreadPool]: SQL status: OK in 1.184 seconds
[0m13:40:05.421831 [debug] [ThreadPool]: On list_finance: Close
[0m13:40:05.422523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m13:40:05.422990 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m13:40:05.429318 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:40:05.429656 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m13:40:05.429963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:05.431514 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:40:05.432840 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:40:05.433155 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m13:40:05.434129 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:40:05.434470 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:40:05.434774 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m13:40:05.457846 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m13:40:05.458889 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m13:40:05.459216 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:40:05.459536 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m13:40:05.476023 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:40:05.476476 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m13:40:05.478935 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m13:40:05.485233 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m13:40:05.485640 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m13:40:05.485968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:05.486977 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m13:40:05.488999 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m13:40:05.489386 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m13:40:05.489700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:05.490710 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:40:05.491101 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m13:40:05.491449 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m13:40:05.491966 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:40:05.492311 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m13:40:05.492647 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m13:40:05.519202 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m13:40:05.519670 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m13:40:05.521071 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m13:40:05.522433 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m13:40:05.523737 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m13:40:05.524056 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m13:40:05.524553 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m13:40:05.524874 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m13:40:05.527985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935B976AF0>]}
[0m13:40:05.528454 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:05.528843 [debug] [MainThread]: On master: BEGIN
[0m13:40:05.529137 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:05.530229 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:40:05.530548 [debug] [MainThread]: On master: COMMIT
[0m13:40:05.530875 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:05.531170 [debug] [MainThread]: On master: COMMIT
[0m13:40:05.531778 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:40:05.532100 [debug] [MainThread]: On master: Close
[0m13:40:05.536834 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m13:40:05.537763 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m13:40:05.537384 [info ] [Thread-1 (]: 1 of 11 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m13:40:05.538855 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m13:40:05.539254 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m13:40:05.546427 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m13:40:05.538253 [info ] [Thread-2 (]: 2 of 11 START sql view model analytics_dev.src_vix ............................. [RUN]
[0m13:40:05.547273 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m13:40:05.547659 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m13:40:05.550863 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m13:40:05.551806 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m13:40:05.559996 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m13:40:05.588335 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m13:40:05.589974 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m13:40:05.591375 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:40:05.591808 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m13:40:05.592193 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:40:05.593086 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:40:05.593462 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m13:40:05.593845 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:40:05.594402 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:40:05.594811 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:40:05.595178 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m13:40:05.595740 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:40:05.596136 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:40:05.596503 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m13:40:05.627878 [debug] [Thread-2 (]: SQL status: OK in 0.032 seconds
[0m13:40:05.634146 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:40:05.634570 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m13:40:05.635124 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m13:40:05.641220 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:40:05.641678 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m13:40:05.662501 [debug] [Thread-2 (]: SQL status: OK in 0.027 seconds
[0m13:40:05.665548 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:40:05.665980 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m13:40:05.671270 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m13:40:05.741481 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:40:05.742019 [debug] [Thread-2 (]: SQL status: OK in 0.076 seconds
[0m13:40:05.742513 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m13:40:05.755493 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m13:40:05.756186 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:40:05.756579 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m13:40:05.784458 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m13:40:05.785942 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m13:40:05.786333 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:40:05.786710 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m13:40:05.859437 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m13:40:05.865951 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:40:05.866457 [debug] [Thread-2 (]: SQL status: OK in 0.109 seconds
[0m13:40:05.866893 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m13:40:05.869669 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:40:05.870386 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m13:40:05.942232 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m13:40:05.944678 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m13:40:05.946842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935B6F9770>]}
[0m13:40:05.947526 [info ] [Thread-1 (]: 1 of 11 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.41s]
[0m13:40:05.948361 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m13:40:05.949166 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__stocks
[0m13:40:05.949718 [info ] [Thread-3 (]: 3 of 11 START sql view model analytics_dev.stg__stocks ......................... [RUN]
[0m13:40:05.950456 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m13:40:05.950862 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m13:40:05.953937 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m13:40:05.954869 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m13:40:05.958160 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m13:40:05.959245 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:40:05.959674 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m13:40:05.960088 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:40:05.961323 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:40:05.961691 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:40:05.962114 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m13:40:05.983538 [debug] [Thread-2 (]: SQL status: OK in 0.113 seconds
[0m13:40:05.985040 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m13:40:05.985595 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935B65B550>]}
[0m13:40:05.986210 [info ] [Thread-2 (]: 2 of 11 OK created sql view model analytics_dev.src_vix ........................ [[32mOK[0m in 0.44s]
[0m13:40:05.987148 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m13:40:05.988204 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m13:40:05.988785 [info ] [Thread-4 (]: 4 of 11 START sql view model analytics_dev.stg__vix_with_versions .............. [RUN]
[0m13:40:05.989528 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m13:40:05.989912 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m13:40:05.993001 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:05.993913 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m13:40:05.997753 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:05.998908 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:05.999483 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m13:40:05.999865 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:40:06.001183 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:40:06.001638 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:06.002043 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m13:40:06.025086 [debug] [Thread-3 (]: SQL status: OK in 0.062 seconds
[0m13:40:06.028637 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:40:06.029130 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m13:40:06.035807 [debug] [Thread-4 (]: SQL status: OK in 0.033 seconds
[0m13:40:06.038863 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:06.039252 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m13:40:06.064341 [debug] [Thread-3 (]: SQL status: OK in 0.035 seconds
[0m13:40:06.067801 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:40:06.068214 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m13:40:06.071651 [debug] [Thread-4 (]: SQL status: OK in 0.032 seconds
[0m13:40:06.074596 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:06.074978 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m13:40:06.095229 [debug] [Thread-3 (]: SQL status: OK in 0.027 seconds
[0m13:40:06.096562 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m13:40:06.096963 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:40:06.097320 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m13:40:06.104683 [debug] [Thread-4 (]: SQL status: OK in 0.029 seconds
[0m13:40:06.106028 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m13:40:06.106438 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:06.106806 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m13:40:06.153665 [debug] [Thread-4 (]: SQL status: OK in 0.046 seconds
[0m13:40:06.156508 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:06.156901 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m13:40:06.157504 [debug] [Thread-3 (]: SQL status: OK in 0.060 seconds
[0m13:40:06.160063 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:40:06.160486 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m13:40:06.226837 [debug] [Thread-4 (]: SQL status: OK in 0.069 seconds
[0m13:40:06.227339 [debug] [Thread-3 (]: SQL status: OK in 0.066 seconds
[0m13:40:06.228741 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m13:40:06.230084 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: Close
[0m13:40:06.230702 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935BD2BF50>]}
[0m13:40:06.231284 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935E1CB310>]}
[0m13:40:06.231987 [info ] [Thread-4 (]: 4 of 11 OK created sql view model analytics_dev.stg__vix_with_versions ......... [[32mOK[0m in 0.24s]
[0m13:40:06.233312 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m13:40:06.232592 [info ] [Thread-3 (]: 3 of 11 OK created sql view model analytics_dev.stg__stocks .................... [[32mOK[0m in 0.28s]
[0m13:40:06.234417 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m13:40:06.234939 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m13:40:06.235463 [info ] [Thread-1 (]: 5 of 11 START sql view model analytics_dev.int__regime_classification .......... [RUN]
[0m13:40:06.236108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__regime_classification)
[0m13:40:06.236481 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m13:40:06.239291 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m13:40:06.239796 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m13:40:06.240297 [info ] [Thread-2 (]: 6 of 11 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m13:40:06.240965 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__price_changes)
[0m13:40:06.241379 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m13:40:06.244797 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m13:40:06.245260 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m13:40:06.248464 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m13:40:06.249215 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m13:40:06.252723 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m13:40:06.253641 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:40:06.254113 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m13:40:06.254521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:06.255300 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:40:06.255697 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m13:40:06.256048 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:40:06.256628 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:40:06.257069 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:40:06.257476 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m13:40:06.258251 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:40:06.258733 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:40:06.259168 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."stg__stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m13:40:06.295580 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m13:40:06.299024 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:40:06.299420 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m13:40:06.332102 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m13:40:06.335098 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:40:06.335510 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m13:40:06.335916 [debug] [Thread-2 (]: SQL status: OK in 0.076 seconds
[0m13:40:06.342475 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:40:06.343055 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m13:40:06.384352 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m13:40:06.385775 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m13:40:06.386162 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:40:06.386551 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m13:40:06.388485 [debug] [Thread-2 (]: SQL status: OK in 0.045 seconds
[0m13:40:06.391436 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:40:06.391840 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m13:40:06.421581 [debug] [Thread-2 (]: SQL status: OK in 0.029 seconds
[0m13:40:06.422950 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m13:40:06.423334 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:40:06.423722 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m13:40:06.443851 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m13:40:06.446681 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:40:06.447054 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m13:40:06.482070 [debug] [Thread-2 (]: SQL status: OK in 0.058 seconds
[0m13:40:06.485217 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:40:06.485656 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m13:40:06.546680 [debug] [Thread-2 (]: SQL status: OK in 0.061 seconds
[0m13:40:06.547167 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m13:40:06.548519 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m13:40:06.549751 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m13:40:06.550461 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935B212930>]}
[0m13:40:06.550984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935B213A10>]}
[0m13:40:06.551633 [info ] [Thread-2 (]: 6 of 11 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.31s]
[0m13:40:06.552944 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m13:40:06.552224 [info ] [Thread-1 (]: 5 of 11 OK created sql view model analytics_dev.int__regime_classification ..... [[32mOK[0m in 0.31s]
[0m13:40:06.553850 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m13:40:06.554466 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m13:40:06.555327 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m13:40:06.554923 [info ] [Thread-4 (]: 7 of 11 START sql view model analytics_dev.int__rsi_sma ........................ [RUN]
[0m13:40:06.556337 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now model.portfolio_project_2.int__rsi_sma)
[0m13:40:06.556737 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m13:40:06.559434 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m13:40:06.555790 [info ] [Thread-3 (]: 8 of 11 START sql view model analytics_dev.int__regime_changes ................. [RUN]
[0m13:40:06.560050 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now model.portfolio_project_2.int__regime_changes)
[0m13:40:06.560444 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m13:40:06.563324 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m13:40:06.564870 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m13:40:06.568463 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m13:40:06.568931 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m13:40:06.572608 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m13:40:06.573721 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:40:06.574347 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m13:40:06.574898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:40:06.575575 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:40:06.576136 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m13:40:06.576567 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:40:06.577275 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:40:06.577658 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:40:06.578145 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m13:40:06.579028 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:40:06.579455 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:40:06.579873 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    sma_gain::decimal(18,2) as sma_gain,
    sma_loss::decimal(18,2) as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m13:40:06.624544 [debug] [Thread-4 (]: SQL status: OK in 0.044 seconds
[0m13:40:06.627947 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:40:06.628357 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m13:40:06.628825 [debug] [Thread-3 (]: SQL status: OK in 0.050 seconds
[0m13:40:06.631816 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:40:06.632358 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m13:40:06.662211 [debug] [Thread-4 (]: SQL status: OK in 0.033 seconds
[0m13:40:06.665503 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:40:06.665881 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m13:40:06.689190 [debug] [Thread-3 (]: SQL status: OK in 0.056 seconds
[0m13:40:06.692368 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:40:06.692798 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m13:40:06.694411 [debug] [Thread-4 (]: SQL status: OK in 0.028 seconds
[0m13:40:06.696071 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m13:40:06.696548 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:40:06.696929 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m13:40:06.725672 [debug] [Thread-3 (]: SQL status: OK in 0.032 seconds
[0m13:40:06.727046 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m13:40:06.727453 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:40:06.727814 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m13:40:06.755295 [debug] [Thread-4 (]: SQL status: OK in 0.058 seconds
[0m13:40:06.758171 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:40:06.758553 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m13:40:06.791455 [debug] [Thread-3 (]: SQL status: OK in 0.063 seconds
[0m13:40:06.794285 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:40:06.794675 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m13:40:06.864521 [debug] [Thread-3 (]: SQL status: OK in 0.069 seconds
[0m13:40:06.865943 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m13:40:06.866368 [debug] [Thread-4 (]: SQL status: OK in 0.107 seconds
[0m13:40:06.867545 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m13:40:06.868048 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935B95BEF0>]}
[0m13:40:06.869103 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935B653650>]}
[0m13:40:06.868630 [info ] [Thread-4 (]: 7 of 11 OK created sql view model analytics_dev.int__rsi_sma ................... [[32mOK[0m in 0.31s]
[0m13:40:06.870364 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m13:40:06.869681 [info ] [Thread-3 (]: 8 of 11 OK created sql view model analytics_dev.int__regime_changes ............ [[32mOK[0m in 0.31s]
[0m13:40:06.871301 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m13:40:06.871727 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m13:40:06.872233 [info ] [Thread-2 (]: 9 of 11 START sql view model analytics_dev.int__rsi_wilder ..................... [RUN]
[0m13:40:06.872862 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now model.portfolio_project_2.int__rsi_wilder)
[0m13:40:06.873255 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m13:40:06.876173 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:06.876838 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:40:06.877578 [info ] [Thread-1 (]: 10 of 11 START sql incremental model analytics_dev.mrt__stocks_with_regimes .... [RUN]
[0m13:40:06.878406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_classification, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m13:40:06.878887 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:40:06.886971 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:06.887445 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m13:40:06.890653 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:06.891415 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:40:06.896146 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:06.896762 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__a9984cf98a78" cascade
    
[0m13:40:06.897123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:06.897808 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:06.898360 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m13:40:06.898799 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:40:06.900223 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:40:06.900712 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:06.901219 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    wilder_gain::decimal(18,2) as wilder_gain,
    wilder_loss::decimal(18,2) as wilder_loss
from wilder
  );

[0m13:40:06.922726 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m13:40:06.954483 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:06.955068 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m13:40:06.956621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:40:06.957290 [debug] [Thread-2 (]: SQL status: OK in 0.056 seconds
[0m13:40:06.963784 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:06.964241 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m13:40:06.965688 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:06.966116 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m13:40:06.967296 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:40:06.967689 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:06.968097 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m13:40:06.991876 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m13:40:06.993025 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:06.993431 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m13:40:06.993835 [debug] [Thread-2 (]: SQL status: OK in 0.029 seconds
[0m13:40:06.996735 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:06.997113 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m13:40:06.997599 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:40:06.998732 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:40:06.999249 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:06.999637 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:40:07.017933 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m13:40:07.040868 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:07.041382 [debug] [Thread-2 (]: SQL status: OK in 0.044 seconds
[0m13:40:07.041868 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:40:07.043243 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m13:40:07.044035 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:07.044436 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m13:40:07.047626 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:40:07.063156 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:07.063604 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,0))
 as volume, 
      
    cast(null as text)
 as regime
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:40:07.065146 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:40:07.089491 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:07.090007 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."mrt__stocks_with_regimes__a9984cf98a78"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null
    
    )
 ;
    insert into "finance"."dbt_temp"."mrt__stocks_with_regimes__a9984cf98a78" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m13:40:07.104301 [debug] [Thread-2 (]: SQL status: OK in 0.059 seconds
[0m13:40:07.107200 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:07.107620 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m13:40:07.161774 [debug] [Thread-2 (]: SQL status: OK in 0.054 seconds
[0m13:40:07.163221 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m13:40:07.163776 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193589DE150>]}
[0m13:40:07.164420 [info ] [Thread-2 (]: 9 of 11 OK created sql view model analytics_dev.int__rsi_wilder ................ [[32mOK[0m in 0.29s]
[0m13:40:07.165222 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m13:40:07.165876 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.fct__rsi
[0m13:40:07.166367 [info ] [Thread-4 (]: 11 of 11 START sql incremental model analytics_dev.fct__rsi .................... [RUN]
[0m13:40:07.166981 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_sma, now model.portfolio_project_2.fct__rsi)
[0m13:40:07.167367 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m13:40:07.172236 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m13:40:07.173247 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m13:40:07.177799 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:07.178197 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__fe253538732f" cascade
    
[0m13:40:07.178549 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:40:07.251649 [debug] [Thread-4 (]: SQL status: OK in 0.073 seconds
[0m13:40:07.254892 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:07.255387 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m13:40:07.257302 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:40:07.259037 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:07.259593 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m13:40:07.260853 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:40:07.261350 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:07.261876 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m13:40:07.276792 [debug] [Thread-1 (]: SQL status: OK in 0.186 seconds
[0m13:40:07.284437 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:07.284857 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m13:40:07.285995 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:40:07.286360 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:07.286729 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__a9984cf98a78'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:07.292208 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:40:07.297984 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:07.298449 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:07.299492 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m13:40:07.300566 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:07.300972 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    

  
[0m13:40:07.301397 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:40:07.302504 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:40:07.302899 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:07.303256 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:40:07.303796 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:40:07.316616 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:07.317103 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__a9984cf98a78'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:07.322348 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:40:07.325428 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:07.325878 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:07.326547 [debug] [Thread-4 (]: SQL status: OK in 0.023 seconds
[0m13:40:07.327371 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:07.327823 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:40:07.331122 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:40:07.340844 [debug] [Thread-1 (]: 
    In "finance"."analytics_dev"."mrt__stocks_with_regimes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:40:07.341420 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m13:40:07.341963 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:07.342521 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
SELECT version()
[0m13:40:07.343319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:40:07.355857 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:07.356277 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as sma_rs, 
      
    cast(null as decimal(18,2))
 as sma_rsi, 
      
    cast(null as decimal(18,2))
 as wilder_rs, 
      
    cast(null as decimal(18,2))
 as wilder_rsi
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:40:07.385922 [debug] [Thread-4 (]: SQL status: OK in 0.029 seconds
[0m13:40:07.411167 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:07.413321 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:07.413814 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."fct__rsi__fe253538732f"
  
  (
    trade_date date not null,
    ticker text not null,
    sma_rs decimal(18,2),
    sma_rsi decimal(18,2),
    wilder_rs decimal(18,2),
    wilder_rsi decimal(18,2)
    
    )
 ;
    insert into "finance"."dbt_temp"."fct__rsi__fe253538732f" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      sma_rs ,
    
      
      sma_rsi ,
    
      
      wilder_rs ,
    
      
      wilder_rsi 
    
  )
 (
      
    select trade_date, ticker, sma_rs, sma_rsi, wilder_rs, wilder_rsi
    from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as model_subq
    );
  
  
  
[0m13:40:07.415100 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:07.415533 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */


    MERGE INTO "finance"."analytics_dev"."mrt__stocks_with_regimes" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."mrt__stocks_with_regimes__a9984cf98a78" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m13:40:07.443951 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m13:40:07.445310 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:40:07.446007 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:07.446373 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:40:07.473953 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m13:40:07.476386 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:07.476777 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__a9984cf98a78" cascade
    
[0m13:40:07.606277 [debug] [Thread-1 (]: SQL status: OK in 0.129 seconds
[0m13:40:07.609597 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:07.609989 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__a9984cf98a78" cascade
    
[0m13:40:07.630831 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m13:40:07.632179 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m13:40:07.632844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935B3C9190>]}
[0m13:40:07.633465 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes  [[32mOK[0m in 0.75s]
[0m13:40:07.634312 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:40:08.813067 [debug] [Thread-4 (]: SQL status: OK in 1.399 seconds
[0m13:40:08.816190 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:08.816604 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m13:40:08.817668 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:40:08.818030 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:08.818455 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__fe253538732f'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:08.823805 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:40:08.827176 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:08.827599 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:08.832729 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:40:08.835704 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:08.836091 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__fe253538732f'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:08.841113 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:40:08.844436 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:08.844863 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:08.849766 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:40:08.851618 [debug] [Thread-4 (]: 
    In "finance"."analytics_dev"."fct__rsi":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:40:08.852826 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m13:40:08.853866 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:08.854298 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */


    MERGE INTO "finance"."analytics_dev"."fct__rsi" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."fct__rsi__fe253538732f" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m13:40:08.878747 [debug] [Thread-4 (]: SQL status: OK in 0.024 seconds
[0m13:40:08.880127 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:40:08.880520 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:08.880866 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:40:09.006726 [debug] [Thread-4 (]: SQL status: OK in 0.125 seconds
[0m13:40:09.025396 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:09.026424 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__fe253538732f" cascade
    
[0m13:40:09.119788 [debug] [Thread-4 (]: SQL status: OK in 0.093 seconds
[0m13:40:09.122861 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:09.123236 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__fe253538732f" cascade
    
[0m13:40:09.150120 [debug] [Thread-4 (]: SQL status: OK in 0.026 seconds
[0m13:40:09.151442 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: Close
[0m13:40:09.151973 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed7676a-6377-41f3-92cd-4f7ae090b760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935B334C50>]}
[0m13:40:09.152546 [info ] [Thread-4 (]: 11 of 11 OK created sql incremental model analytics_dev.fct__rsi ............... [[32mOK[0m in 1.98s]
[0m13:40:09.153371 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m13:40:09.154963 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:09.155329 [debug] [MainThread]: On master: BEGIN
[0m13:40:09.155641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:09.156878 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:40:09.157222 [debug] [MainThread]: On master: COMMIT
[0m13:40:09.157525 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:09.157814 [debug] [MainThread]: On master: COMMIT
[0m13:40:09.158392 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:40:09.158704 [debug] [MainThread]: On master: Close
[0m13:40:09.159099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:09.159381 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m13:40:09.159649 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m13:40:09.159930 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m13:40:09.160201 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m13:40:09.160464 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m13:40:09.160727 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m13:40:09.161007 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m13:40:09.161378 [info ] [MainThread]: 
[0m13:40:09.161884 [info ] [MainThread]: Finished running 2 incremental models, 9 view models in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m13:40:09.164458 [debug] [MainThread]: Command end result
[0m13:40:09.224169 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m13:40:09.226859 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m13:40:09.233274 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m13:40:09.233628 [info ] [MainThread]: 
[0m13:40:09.234217 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:09.234686 [info ] [MainThread]: 
[0m13:40:09.235226 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m13:40:09.235973 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 14 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:40:09.236989 [debug] [MainThread]: Command `-c run` succeeded at 13:40:09.236877 after 9.13 seconds
[0m13:40:09.237352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193585F9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935BD13C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935BD13710>]}
[0m13:40:09.237734 [debug] [MainThread]: Flushing usage events
[0m13:40:09.872909 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:40:23.043629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A35C22C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A35CA342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A35D077ED0>]}


============================== 13:40:23.048233 | 104d26bf-eeff-43c4-842e-a361f057c28a ==============================
[0m13:40:23.048233 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:40:23.048993 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt clean', 'printer_width': '80', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m13:40:23.191467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '104d26bf-eeff-43c4-842e-a361f057c28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A35C3E0180>]}
[0m13:40:23.321408 [debug] [MainThread]: Command `-c clean` succeeded at 13:40:23.321278 after 0.40 seconds
[0m13:40:23.321818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A35CF1A470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A35CF19F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A35CF13C50>]}
[0m13:40:23.322195 [debug] [MainThread]: Flushing usage events
[0m13:40:23.814008 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:40:27.642055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D99778050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D99F842D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9A5C3ED0>]}


============================== 13:40:27.646743 | 7d11278b-cc61-4a6e-800d-8773fb36e0be ==============================
[0m13:40:27.646743 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:40:27.647512 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'printer_width': '80', 'target_path': 'None'}
[0m13:40:27.790212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d11278b-cc61-4a6e-800d-8773fb36e0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D99930180>]}
[0m13:40:27.822931 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-atyrpqhj'
[0m13:40:27.823388 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:40:28.435064 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:40:28.436576 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:40:28.905160 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:40:28.909830 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m13:40:29.341068 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m13:40:29.345155 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m13:40:29.813839 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m13:40:29.818111 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:40:30.599608 [info ] [MainThread]: Installed from version 1.3.2
[0m13:40:30.600194 [info ] [MainThread]: Up to date!
[0m13:40:30.600713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7d11278b-cc61-4a6e-800d-8773fb36e0be', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9A46AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9A46A580>]}
[0m13:40:30.601108 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m13:40:31.470888 [info ] [MainThread]: Installed from version 0.10.9
[0m13:40:31.471468 [info ] [MainThread]: Up to date!
[0m13:40:31.471970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7d11278b-cc61-4a6e-800d-8773fb36e0be', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9B88D050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9A457980>]}
[0m13:40:31.472366 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m13:40:32.087936 [info ] [MainThread]: Installed from version 0.17.0
[0m13:40:32.088555 [info ] [MainThread]: Up to date!
[0m13:40:32.089054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7d11278b-cc61-4a6e-800d-8773fb36e0be', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9B861C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9B861630>]}
[0m13:40:32.091728 [debug] [MainThread]: Command `-c deps` succeeded at 13:40:32.091575 after 4.58 seconds
[0m13:40:32.092115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9A3CAF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9B80A390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9B881E90>]}
[0m13:40:32.092559 [debug] [MainThread]: Flushing usage events
[0m13:40:32.589664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:40:36.236238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC7758050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC7F642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC85A7ED0>]}


============================== 13:40:36.241902 | 3fea471d-390d-4596-80c3-a44a6a0a130f ==============================
[0m13:40:36.241902 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:40:36.243108 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:40:36.534017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC7910180>]}
[0m13:40:36.607035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC844B790>]}
[0m13:40:36.609987 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:40:36.903833 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:40:36.905188 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:40:36.905758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC9691650>]}
[0m13:40:39.727458 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m13:40:39.728158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCA3388C0>]}
[0m13:40:40.269040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCA0F2350>]}
[0m13:40:40.427991 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m13:40:40.432488 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m13:40:40.466474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCA4C9A50>]}
[0m13:40:40.466988 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 2 snapshots, 2 sources, 853 macros
[0m13:40:40.467519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCA37EA50>]}
[0m13:40:40.470959 [info ] [MainThread]: 
[0m13:40:40.471406 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:40:40.471863 [info ] [MainThread]: 
[0m13:40:40.472707 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:40:40.478238 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m13:40:40.561258 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m13:40:40.561664 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m13:40:40.561986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:41.602712 [debug] [ThreadPool]: SQL status: OK in 1.041 seconds
[0m13:40:41.604169 [debug] [ThreadPool]: On list_finance: Close
[0m13:40:41.604858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m13:40:41.605363 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m13:40:41.611744 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:40:41.612152 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m13:40:41.612515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:41.614283 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:40:41.616046 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:40:41.616599 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m13:40:41.617919 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:40:41.618344 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:40:41.618705 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m13:40:41.644106 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m13:40:41.645461 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m13:40:41.645886 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m13:40:41.646360 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m13:40:41.661407 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:40:41.661828 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m13:40:41.664446 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m13:40:41.673835 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m13:40:41.676185 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m13:40:41.673427 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m13:40:41.676921 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m13:40:41.677766 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m13:40:41.678183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:41.678629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:41.680207 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:40:41.681019 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m13:40:41.681731 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:40:41.682411 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m13:40:41.683202 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m13:40:41.684011 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m13:40:41.715390 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m13:40:41.717101 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m13:40:41.717760 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m13:40:41.719364 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m13:40:41.720361 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m13:40:41.720753 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m13:40:41.723701 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m13:40:41.724048 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m13:40:41.725336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCA7083C0>]}
[0m13:40:41.725868 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:41.726214 [debug] [MainThread]: On master: BEGIN
[0m13:40:41.726556 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:41.727838 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:40:41.728221 [debug] [MainThread]: On master: COMMIT
[0m13:40:41.728571 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:41.728880 [debug] [MainThread]: On master: COMMIT
[0m13:40:41.729647 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:40:41.730020 [debug] [MainThread]: On master: Close
[0m13:40:41.734795 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m13:40:41.735279 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m13:40:41.735821 [info ] [Thread-1 (]: 1 of 11 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m13:40:41.736922 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m13:40:41.736321 [info ] [Thread-2 (]: 2 of 11 START sql view model analytics_dev.src_vix ............................. [RUN]
[0m13:40:41.737407 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m13:40:41.737916 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m13:40:41.745050 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m13:40:41.745459 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m13:40:41.748407 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m13:40:41.750673 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m13:40:41.751193 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m13:40:41.781552 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m13:40:41.785241 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m13:40:41.788899 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:40:41.789595 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m13:40:41.790014 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:40:41.790825 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:40:41.791219 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m13:40:41.791590 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:40:41.792272 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:40:41.792698 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:40:41.793082 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m13:40:41.793784 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:40:41.794160 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:40:41.794526 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m13:40:41.822987 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m13:40:41.829456 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:40:41.829933 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m13:40:41.832031 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m13:40:41.835700 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:40:41.836139 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m13:40:41.860151 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m13:40:41.863258 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:40:41.863667 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m13:40:41.867923 [debug] [Thread-2 (]: SQL status: OK in 0.031 seconds
[0m13:40:41.871183 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:40:41.871594 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m13:40:41.896653 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m13:40:41.909696 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m13:40:41.910172 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m13:40:41.910594 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:40:41.911939 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m13:40:41.912395 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m13:40:41.912832 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:40:41.913461 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m13:40:41.967463 [debug] [Thread-2 (]: SQL status: OK in 0.054 seconds
[0m13:40:41.973446 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m13:40:41.973894 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m13:40:41.974573 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m13:40:41.976969 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m13:40:41.977372 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m13:40:42.038608 [debug] [Thread-2 (]: SQL status: OK in 0.064 seconds
[0m13:40:42.041016 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m13:40:42.043144 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC7880550>]}
[0m13:40:42.043866 [info ] [Thread-2 (]: 2 of 11 OK created sql view model analytics_dev.src_vix ........................ [[32mOK[0m in 0.30s]
[0m13:40:42.044990 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m13:40:42.045865 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m13:40:42.046423 [info ] [Thread-3 (]: 3 of 11 START sql view model analytics_dev.stg__vix_with_versions .............. [RUN]
[0m13:40:42.047224 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m13:40:42.047631 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m13:40:42.051331 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:42.052868 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m13:40:42.056320 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:42.057735 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:42.058153 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m13:40:42.058507 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:40:42.059944 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:40:42.060374 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:42.060812 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m13:40:42.093394 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m13:40:42.094833 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m13:40:42.095399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCA7B7BD0>]}
[0m13:40:42.095988 [info ] [Thread-1 (]: 1 of 11 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.36s]
[0m13:40:42.096845 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m13:40:42.097528 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__stocks
[0m13:40:42.098172 [info ] [Thread-4 (]: 4 of 11 START sql view model analytics_dev.stg__stocks ......................... [RUN]
[0m13:40:42.098907 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m13:40:42.099308 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m13:40:42.102210 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m13:40:42.103229 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m13:40:42.106937 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m13:40:42.107951 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:40:42.108336 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m13:40:42.108702 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:40:42.109885 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:40:42.110283 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:40:42.110697 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m13:40:42.126700 [debug] [Thread-3 (]: SQL status: OK in 0.065 seconds
[0m13:40:42.129774 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:42.130158 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m13:40:42.140498 [debug] [Thread-4 (]: SQL status: OK in 0.029 seconds
[0m13:40:42.143800 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:40:42.144210 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m13:40:42.161630 [debug] [Thread-3 (]: SQL status: OK in 0.031 seconds
[0m13:40:42.164729 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:42.165123 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m13:40:42.177455 [debug] [Thread-4 (]: SQL status: OK in 0.033 seconds
[0m13:40:42.185187 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:40:42.185742 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m13:40:42.194188 [debug] [Thread-3 (]: SQL status: OK in 0.029 seconds
[0m13:40:42.195703 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m13:40:42.196099 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:42.196481 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m13:40:42.221008 [debug] [Thread-4 (]: SQL status: OK in 0.035 seconds
[0m13:40:42.222642 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m13:40:42.223085 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:40:42.223446 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m13:40:42.255869 [debug] [Thread-3 (]: SQL status: OK in 0.059 seconds
[0m13:40:42.328971 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m13:40:42.329579 [debug] [Thread-4 (]: SQL status: OK in 0.106 seconds
[0m13:40:42.330181 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m13:40:42.333403 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m13:40:42.334223 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m13:40:42.386968 [debug] [Thread-4 (]: SQL status: OK in 0.052 seconds
[0m13:40:42.387467 [debug] [Thread-3 (]: SQL status: OK in 0.054 seconds
[0m13:40:42.388864 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: Close
[0m13:40:42.390235 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m13:40:42.390895 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCBE4BD90>]}
[0m13:40:42.391454 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCBED4C90>]}
[0m13:40:42.392170 [info ] [Thread-4 (]: 4 of 11 OK created sql view model analytics_dev.stg__stocks .................... [[32mOK[0m in 0.29s]
[0m13:40:42.393538 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m13:40:42.392807 [info ] [Thread-3 (]: 3 of 11 OK created sql view model analytics_dev.stg__vix_with_versions ......... [[32mOK[0m in 0.34s]
[0m13:40:42.394501 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m13:40:42.394935 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m13:40:42.395425 [info ] [Thread-2 (]: 5 of 11 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m13:40:42.396052 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__price_changes)
[0m13:40:42.396452 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m13:40:42.399684 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m13:40:42.400278 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m13:40:42.400792 [info ] [Thread-1 (]: 6 of 11 START sql view model analytics_dev.int__regime_classification .......... [RUN]
[0m13:40:42.401435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__regime_classification)
[0m13:40:42.401865 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m13:40:42.404590 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m13:40:42.406107 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m13:40:42.409630 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m13:40:42.410080 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m13:40:42.413361 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m13:40:42.414797 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:40:42.415584 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:40:42.416033 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m13:40:42.416487 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m13:40:42.416945 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:40:42.417392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:42.418531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:40:42.418913 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:40:42.419341 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m13:40:42.419993 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:40:42.420464 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:40:42.420942 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."stg__stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m13:40:42.455027 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m13:40:42.458131 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:40:42.458539 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m13:40:42.491208 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m13:40:42.494559 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:40:42.494996 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m13:40:42.495534 [debug] [Thread-2 (]: SQL status: OK in 0.074 seconds
[0m13:40:42.498611 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:40:42.499001 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m13:40:42.524806 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m13:40:42.526269 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m13:40:42.526667 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:40:42.527144 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m13:40:42.532462 [debug] [Thread-2 (]: SQL status: OK in 0.033 seconds
[0m13:40:42.535489 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:40:42.535871 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m13:40:42.563072 [debug] [Thread-2 (]: SQL status: OK in 0.027 seconds
[0m13:40:42.564464 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m13:40:42.564851 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:40:42.565208 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m13:40:42.578291 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m13:40:42.581194 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m13:40:42.581588 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m13:40:42.620460 [debug] [Thread-2 (]: SQL status: OK in 0.055 seconds
[0m13:40:42.622998 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m13:40:42.623386 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m13:40:42.662623 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m13:40:42.664326 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m13:40:42.664850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCA3D0770>]}
[0m13:40:42.665454 [info ] [Thread-1 (]: 6 of 11 OK created sql view model analytics_dev.int__regime_classification ..... [[32mOK[0m in 0.26s]
[0m13:40:42.666263 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m13:40:42.666931 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m13:40:42.667425 [info ] [Thread-4 (]: 7 of 11 START sql view model analytics_dev.int__regime_changes ................. [RUN]
[0m13:40:42.668041 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now model.portfolio_project_2.int__regime_changes)
[0m13:40:42.668417 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m13:40:42.671166 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m13:40:42.672575 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m13:40:42.675904 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m13:40:42.677300 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:40:42.678003 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m13:40:42.678381 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:40:42.679655 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:40:42.680099 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:40:42.680532 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m13:40:42.706276 [debug] [Thread-2 (]: SQL status: OK in 0.082 seconds
[0m13:40:42.707742 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m13:40:42.708281 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCA1E5010>]}
[0m13:40:42.708890 [info ] [Thread-2 (]: 5 of 11 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.31s]
[0m13:40:42.709709 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m13:40:42.710365 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m13:40:42.710856 [info ] [Thread-3 (]: 8 of 11 START sql view model analytics_dev.int__rsi_sma ........................ [RUN]
[0m13:40:42.711469 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now model.portfolio_project_2.int__rsi_sma)
[0m13:40:42.711852 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m13:40:42.714638 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m13:40:42.715796 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m13:40:42.719671 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m13:40:42.720753 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:40:42.721153 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m13:40:42.721530 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:40:42.723352 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:40:42.723812 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:40:42.724230 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    sma_gain::decimal(18,2) as sma_gain,
    sma_loss::decimal(18,2) as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m13:40:42.768629 [debug] [Thread-3 (]: SQL status: OK in 0.044 seconds
[0m13:40:42.772075 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:40:42.772528 [debug] [Thread-4 (]: SQL status: OK in 0.092 seconds
[0m13:40:42.772964 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m13:40:42.775831 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:40:42.776489 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m13:40:42.831065 [debug] [Thread-3 (]: SQL status: OK in 0.055 seconds
[0m13:40:42.835127 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:40:42.835630 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m13:40:42.836339 [debug] [Thread-4 (]: SQL status: OK in 0.059 seconds
[0m13:40:42.839943 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:40:42.840436 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m13:40:42.867626 [debug] [Thread-3 (]: SQL status: OK in 0.031 seconds
[0m13:40:42.869372 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m13:40:42.869840 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:40:42.870247 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m13:40:42.873837 [debug] [Thread-4 (]: SQL status: OK in 0.033 seconds
[0m13:40:42.875145 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m13:40:42.875552 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:40:42.875915 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m13:40:42.924602 [debug] [Thread-4 (]: SQL status: OK in 0.048 seconds
[0m13:40:42.932775 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m13:40:42.933329 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m13:40:42.934139 [debug] [Thread-3 (]: SQL status: OK in 0.063 seconds
[0m13:40:42.937587 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m13:40:42.938180 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m13:40:42.998783 [debug] [Thread-3 (]: SQL status: OK in 0.060 seconds
[0m13:40:42.999302 [debug] [Thread-4 (]: SQL status: OK in 0.065 seconds
[0m13:40:43.000762 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m13:40:43.002044 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m13:40:43.002663 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC9A2D670>]}
[0m13:40:43.003206 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC5D27530>]}
[0m13:40:43.003853 [info ] [Thread-3 (]: 8 of 11 OK created sql view model analytics_dev.int__rsi_sma ................... [[32mOK[0m in 0.29s]
[0m13:40:43.005159 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m13:40:43.005854 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m13:40:43.004447 [info ] [Thread-4 (]: 7 of 11 OK created sql view model analytics_dev.int__regime_changes ............ [[32mOK[0m in 0.34s]
[0m13:40:43.007021 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m13:40:43.006351 [info ] [Thread-1 (]: 9 of 11 START sql view model analytics_dev.int__rsi_wilder ..................... [RUN]
[0m13:40:43.007754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_classification, now model.portfolio_project_2.int__rsi_wilder)
[0m13:40:43.008159 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m13:40:43.011125 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:43.011629 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:40:43.012126 [info ] [Thread-2 (]: 10 of 11 START sql incremental model analytics_dev.mrt__stocks_with_regimes .... [RUN]
[0m13:40:43.012770 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m13:40:43.013179 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:40:43.020120 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.020845 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m13:40:43.024089 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:43.025052 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:40:43.029060 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.029455 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__6ffe09623ae7" cascade
    
[0m13:40:43.029844 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:40:43.030547 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:43.031012 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m13:40:43.031478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:43.032854 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:40:43.033325 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:43.034051 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    wilder_gain::decimal(18,2) as wilder_gain,
    wilder_loss::decimal(18,2) as wilder_loss
from wilder
  );

[0m13:40:43.056317 [debug] [Thread-2 (]: SQL status: OK in 0.026 seconds
[0m13:40:43.088598 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.089064 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m13:40:43.089519 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m13:40:43.092826 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:43.093499 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m13:40:43.094523 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:40:43.095962 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.096338 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m13:40:43.097350 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:40:43.097714 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.098104 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m13:40:43.115711 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m13:40:43.116849 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.117229 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m13:40:43.117695 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:40:43.118801 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:40:43.119175 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.119553 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:40:43.125588 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m13:40:43.128662 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:43.129064 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m13:40:43.141817 [debug] [Thread-2 (]: SQL status: OK in 0.022 seconds
[0m13:40:43.164110 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.164628 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:40:43.166058 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m13:40:43.167394 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m13:40:43.167780 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:43.168156 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m13:40:43.168995 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:40:43.186593 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.187051 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,0))
 as volume, 
      
    cast(null as text)
 as regime
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:40:43.188766 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:40:43.213503 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.213994 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."mrt__stocks_with_regimes__6ffe09623ae7"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null
    
    )
 ;
    insert into "finance"."dbt_temp"."mrt__stocks_with_regimes__6ffe09623ae7" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
    where trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, date '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m13:40:43.246472 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m13:40:43.249585 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m13:40:43.250036 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m13:40:43.364280 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m13:40:43.365711 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m13:40:43.366233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCA0A5A30>]}
[0m13:40:43.366839 [info ] [Thread-1 (]: 9 of 11 OK created sql view model analytics_dev.int__rsi_wilder ................ [[32mOK[0m in 0.36s]
[0m13:40:43.367646 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m13:40:43.368361 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.fct__rsi
[0m13:40:43.368848 [info ] [Thread-3 (]: 11 of 11 START sql incremental model analytics_dev.fct__rsi .................... [RUN]
[0m13:40:43.369675 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_sma, now model.portfolio_project_2.fct__rsi)
[0m13:40:43.370053 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m13:40:43.374741 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m13:40:43.375977 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m13:40:43.380307 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:43.380730 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__2649bd55ce73" cascade
    
[0m13:40:43.381081 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:40:43.426259 [debug] [Thread-2 (]: SQL status: OK in 0.212 seconds
[0m13:40:43.435341 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.435841 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m13:40:43.436746 [debug] [Thread-3 (]: SQL status: OK in 0.056 seconds
[0m13:40:43.439381 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:43.439813 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m13:40:43.440365 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:40:43.440769 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.441190 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__6ffe09623ae7'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:43.441733 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:40:43.443092 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:43.443493 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m13:40:43.444528 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:40:43.444898 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:43.445296 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m13:40:43.446809 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:40:43.452270 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.452736 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:43.457929 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:40:43.470900 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.471386 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__6ffe09623ae7'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:43.471970 [debug] [Thread-3 (]: SQL status: OK in 0.026 seconds
[0m13:40:43.473035 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:43.473448 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    

  
[0m13:40:43.473871 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:40:43.474984 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:40:43.475380 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:43.475735 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:40:43.476681 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:40:43.479751 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.480198 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:43.485402 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:40:43.494311 [debug] [Thread-2 (]: 
    In "finance"."analytics_dev"."mrt__stocks_with_regimes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:40:43.494904 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.495292 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
SELECT version()
[0m13:40:43.496284 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:40:43.525871 [debug] [Thread-3 (]: SQL status: OK in 0.050 seconds
[0m13:40:43.541679 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:43.556454 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:40:43.575918 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.577235 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.577699 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */


    MERGE INTO "finance"."analytics_dev"."mrt__stocks_with_regimes" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."mrt__stocks_with_regimes__6ffe09623ae7" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m13:40:43.580590 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m13:40:43.585510 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:43.585979 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as sma_rs, 
      
    cast(null as decimal(18,2))
 as sma_rsi, 
      
    cast(null as decimal(18,2))
 as wilder_rs, 
      
    cast(null as decimal(18,2))
 as wilder_rsi
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:40:43.587499 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:40:43.589711 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:43.590232 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

    
  
    
    
      
    

    create  table
      "finance"."dbt_temp"."fct__rsi__2649bd55ce73"
  
  (
    trade_date date not null,
    ticker text not null,
    sma_rs decimal(18,2),
    sma_rsi decimal(18,2),
    wilder_rs decimal(18,2),
    wilder_rsi decimal(18,2)
    
    )
 ;
    insert into "finance"."dbt_temp"."fct__rsi__2649bd55ce73" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      sma_rs ,
    
      
      sma_rsi ,
    
      
      wilder_rs ,
    
      
      wilder_rsi 
    
  )
 (
      
    select trade_date, ticker, sma_rs, sma_rsi, wilder_rs, wilder_rsi
    from (
        

with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"

where trade_date >= (
    select coalesce((max(trade_date) - interval '30 days'), date '1900-01-01')
    from "finance"."analytics_dev"."fct__rsi"
)

),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as model_subq
    );
  
  
  
[0m13:40:43.599633 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m13:40:43.601135 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:40:43.601608 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.601979 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m13:40:43.650092 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m13:40:43.652899 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.653323 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__6ffe09623ae7" cascade
    
[0m13:40:43.764728 [debug] [Thread-2 (]: SQL status: OK in 0.111 seconds
[0m13:40:43.767778 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m13:40:43.768168 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__6ffe09623ae7" cascade
    
[0m13:40:43.785555 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m13:40:43.786972 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m13:40:43.787513 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC9F8C0B0>]}
[0m13:40:43.788137 [info ] [Thread-2 (]: 10 of 11 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes  [[32mOK[0m in 0.77s]
[0m13:40:43.788974 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m13:40:44.979965 [debug] [Thread-3 (]: SQL status: OK in 1.389 seconds
[0m13:40:44.983453 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:44.983855 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m13:40:44.984989 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:40:44.985356 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:44.985760 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__2649bd55ce73'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:44.991188 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:40:44.994359 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:44.994774 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:45.000144 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:40:45.003090 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:45.003539 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi__2649bd55ce73'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:45.008643 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:40:45.011803 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:45.012179 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct__rsi'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m13:40:45.017099 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:40:45.018977 [debug] [Thread-3 (]: 
    In "finance"."analytics_dev"."fct__rsi":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:40:45.020207 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m13:40:45.021418 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:45.022011 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */


    MERGE INTO "finance"."analytics_dev"."fct__rsi" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."fct__rsi__2649bd55ce73" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m13:40:45.049951 [debug] [Thread-3 (]: SQL status: OK in 0.027 seconds
[0m13:40:45.051265 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:40:45.051693 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:45.052035 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m13:40:45.067197 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m13:40:45.069734 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:45.070103 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__2649bd55ce73" cascade
    
[0m13:40:45.159549 [debug] [Thread-3 (]: SQL status: OK in 0.089 seconds
[0m13:40:45.162941 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m13:40:45.163319 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop table if exists "finance"."dbt_temp"."fct__rsi__2649bd55ce73" cascade
    
[0m13:40:45.185206 [debug] [Thread-3 (]: SQL status: OK in 0.021 seconds
[0m13:40:45.186489 [debug] [Thread-3 (]: On model.portfolio_project_2.fct__rsi: Close
[0m13:40:45.186998 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fea471d-390d-4596-80c3-a44a6a0a130f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCA0A5D90>]}
[0m13:40:45.187580 [info ] [Thread-3 (]: 11 of 11 OK created sql incremental model analytics_dev.fct__rsi ............... [[32mOK[0m in 1.82s]
[0m13:40:45.188407 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m13:40:45.190090 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:45.190497 [debug] [MainThread]: On master: BEGIN
[0m13:40:45.190793 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:45.192067 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:40:45.192387 [debug] [MainThread]: On master: COMMIT
[0m13:40:45.192716 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:45.193007 [debug] [MainThread]: On master: COMMIT
[0m13:40:45.193590 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:40:45.193905 [debug] [MainThread]: On master: Close
[0m13:40:45.194291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:45.194595 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m13:40:45.194870 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m13:40:45.195143 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m13:40:45.195418 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m13:40:45.195712 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m13:40:45.195982 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m13:40:45.196248 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m13:40:45.196639 [info ] [MainThread]: 
[0m13:40:45.197141 [info ] [MainThread]: Finished running 2 incremental models, 9 view models in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m13:40:45.199905 [debug] [MainThread]: Command end result
[0m13:40:45.265138 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m13:40:45.268127 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m13:40:45.274762 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m13:40:45.275122 [info ] [MainThread]: 
[0m13:40:45.275670 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:45.276164 [info ] [MainThread]: 
[0m13:40:45.276715 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m13:40:45.277427 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 14 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:40:45.278389 [debug] [MainThread]: Command `-c run` succeeded at 13:40:45.278276 after 9.17 seconds
[0m13:40:45.278753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC5474A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCA4AF170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCA4AF710>]}
[0m13:40:45.279136 [debug] [MainThread]: Flushing usage events
[0m13:40:45.801648 [debug] [MainThread]: An error was encountered while trying to flush usage events
