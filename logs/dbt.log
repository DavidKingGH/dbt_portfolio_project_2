[0m09:50:33.419774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C989DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996CB48E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996CB490A0>]}


============================== 09:50:33.423708 | 2131af59-0490-442c-a22b-02b36e6cc1f3 ==============================
[0m09:50:33.423708 [info ] [MainThread]: Running with dbt=1.8.0
[0m09:50:33.424841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\portfolio_project_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:50:33.614074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2131af59-0490-442c-a22b-02b36e6cc1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C9898E0>]}
[0m09:50:33.648746 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:50:33.650740 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:50:33.651943 [debug] [MainThread]: Command `cli deps` succeeded at 09:50:33.651943 after 0.36 seconds
[0m09:50:33.651943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996C9898E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996CB95760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996DDA7FB0>]}
[0m09:50:33.653328 [debug] [MainThread]: Flushing usage events
[0m14:46:33.312374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8772F1460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A87722DA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8772CDAF0>]}


============================== 14:46:33.316752 | ecd24de3-887e-4855-91a2-7ab6da255ba4 ==============================
[0m14:46:33.316752 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:46:33.317757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:46:33.508270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecd24de3-887e-4855-91a2-7ab6da255ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A87760A570>]}
[0m14:46:33.539367 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:46:33.541364 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:46:33.542362 [debug] [MainThread]: Command `cli deps` succeeded at 14:46:33.542362 after 0.36 seconds
[0m14:46:33.543359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A876FC0BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8772CF260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8777B5DF0>]}
[0m14:46:33.543359 [debug] [MainThread]: Flushing usage events
[0m14:46:53.634270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC75CB8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC764C42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC76B07ED0>]}


============================== 14:46:53.638786 | 17328ad3-a59a-4f63-89e3-797e95b84802 ==============================
[0m14:46:53.638786 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:46:53.639523 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target prod', 'printer_width': '80', 'target_path': 'None'}
[0m14:46:53.984953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC75E70180>]}
[0m14:46:54.051306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC769ABAC0>]}
[0m14:46:54.069612 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:46:54.515395 [debug] [MainThread]: checksum: fd5f499d60404c73e369f2149bd6aa6c74754a4e78aa98476ca57564d99f7088, vars: {}, profile: , target: prod, version: 1.10.13
[0m14:46:54.593281 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:46:54.593875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC77C99750>]}
[0m14:46:56.876189 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.portfolio_project_2.example
[0m14:46:56.885310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC77E0EE40>]}
[0m14:46:56.955067 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:46:56.978652 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:46:57.010470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78451B70>]}
[0m14:46:57.011008 [info ] [MainThread]: Found 2 models, 2 sources, 461 macros
[0m14:46:57.011548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78077C70>]}
[0m14:46:57.013873 [info ] [MainThread]: 
[0m14:46:57.014445 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:46:57.014912 [info ] [MainThread]: 
[0m14:46:57.015546 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:46:57.020650 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m14:46:59.783272 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m14:46:59.783844 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m14:46:59.784149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:40.658600 [debug] [ThreadPool]: SQL status: OK in 40.874 seconds
[0m14:47:40.660355 [debug] [ThreadPool]: On list_finance: Close
[0m14:47:40.661093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_prod)
[0m14:47:40.661582 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_prod"
"
[0m14:47:40.667722 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:47:40.668143 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m14:47:40.668468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:40.670893 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:47:40.672373 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:47:40.672690 [debug] [ThreadPool]: On create_finance_analytics_prod: BEGIN
[0m14:47:40.673666 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:47:40.673975 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:47:40.674280 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
    
        create schema if not exists "finance"."analytics_prod"
    
[0m14:47:40.728701 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m14:47:40.729794 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m14:47:40.730187 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:47:40.730500 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m14:47:40.840907 [debug] [ThreadPool]: SQL status: OK in 0.110 seconds
[0m14:47:40.841483 [debug] [ThreadPool]: On create_finance_analytics_prod: Close
[0m14:47:40.843328 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_prod'
[0m14:47:40.849291 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m14:47:40.849710 [debug] [ThreadPool]: On list_finance_analytics_prod: BEGIN
[0m14:47:40.850009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:40.851154 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:47:40.851544 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m14:47:40.851868 [debug] [ThreadPool]: On list_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance_analytics_prod"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_prod'
    and lower(table_catalog) = 'finance'
  
[0m14:47:40.891567 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m14:47:40.892981 [debug] [ThreadPool]: On list_finance_analytics_prod: ROLLBACK
[0m14:47:40.909926 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_prod'
[0m14:47:40.910347 [debug] [ThreadPool]: On list_finance_analytics_prod: Close
[0m14:47:40.911285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78440D10>]}
[0m14:47:40.911778 [debug] [MainThread]: Using duckdb connection "master"
[0m14:47:40.912114 [debug] [MainThread]: On master: BEGIN
[0m14:47:40.912428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:47:40.913625 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:47:40.913957 [debug] [MainThread]: On master: COMMIT
[0m14:47:40.914264 [debug] [MainThread]: Using duckdb connection "master"
[0m14:47:40.914558 [debug] [MainThread]: On master: COMMIT
[0m14:47:40.915185 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:47:40.915535 [debug] [MainThread]: On master: Close
[0m14:47:40.922119 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m14:47:40.922624 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m14:47:40.923208 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_prod.src_stocks .......................... [RUN]
[0m14:47:40.924565 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m14:47:40.925012 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m14:47:40.931923 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m14:47:40.923771 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_prod.src_vix ............................. [RUN]
[0m14:47:40.932841 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m14:47:40.933382 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m14:47:40.936851 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m14:47:40.940469 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m14:47:40.940954 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m14:47:40.974123 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m14:47:40.977779 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m14:47:40.981187 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:47:40.981948 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m14:47:40.982746 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:47:40.983390 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:47:40.984237 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m14:47:40.984623 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:47:40.985276 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:47:40.985667 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:47:40.986068 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_prod"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high:double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m14:47:40.986497 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:47:41.002041 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_prod"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high:double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m14:47:41.002588 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:47:41.003071 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:47:41.003539 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_prod"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close"
from src
  );

[0m14:47:41.004110 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: ROLLBACK
[0m14:47:41.072228 [debug] [Thread-2 (]: SQL status: OK in 0.067 seconds
[0m14:47:41.078436 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:47:41.078904 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_prod"."src_vix__dbt_tmp" rename to "src_vix"
[0m14:47:41.145144 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m14:47:41.159639 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:47:41.160545 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:47:41.161346 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:47:41.177419 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.src_stocks'
[0m14:47:41.177865 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m14:47:41.182022 [debug] [Thread-1 (]: Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^
[0m14:47:41.184176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7864D860>]}
[0m14:47:41.184804 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model analytics_prod.src_stocks ................. [[31mERROR[0m in 0.26s]
[0m14:47:41.185623 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m14:47:41.186268 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.src_stocks' to be skipped because of status 'error'.  Reason: Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^.
[0m14:47:41.274430 [debug] [Thread-2 (]: SQL status: OK in 0.113 seconds
[0m14:47:41.279688 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:47:41.280116 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_prod"."src_vix__dbt_backup" cascade
    
[0m14:47:41.325498 [debug] [Thread-2 (]: SQL status: OK in 0.045 seconds
[0m14:47:41.327996 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m14:47:41.328570 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17328ad3-a59a-4f63-89e3-797e95b84802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0118E530>]}
[0m14:47:41.329156 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_prod.src_vix ........................ [[32mOK[0m in 0.40s]
[0m14:47:41.329969 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m14:47:41.331433 [debug] [MainThread]: Using duckdb connection "master"
[0m14:47:41.331761 [debug] [MainThread]: On master: BEGIN
[0m14:47:41.332055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:47:41.333306 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:47:41.333647 [debug] [MainThread]: On master: COMMIT
[0m14:47:41.333976 [debug] [MainThread]: Using duckdb connection "master"
[0m14:47:41.334290 [debug] [MainThread]: On master: COMMIT
[0m14:47:41.334966 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:47:41.335305 [debug] [MainThread]: On master: Close
[0m14:47:41.335712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:41.336067 [debug] [MainThread]: Connection 'create_finance_analytics_prod' was properly closed.
[0m14:47:41.336341 [debug] [MainThread]: Connection 'list_finance_analytics_prod' was properly closed.
[0m14:47:41.336612 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_stocks' was properly closed.
[0m14:47:41.336876 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m14:47:41.340398 [info ] [MainThread]: 
[0m14:47:41.341324 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 44.32 seconds (44.32s).
[0m14:47:41.343093 [debug] [MainThread]: Command end result
[0m14:47:41.371594 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:47:41.374695 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:47:41.382625 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m14:47:41.383043 [info ] [MainThread]: 
[0m14:47:41.383614 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:47:41.384146 [info ] [MainThread]: 
[0m14:47:41.384871 [error] [MainThread]: [31mFailure in model src_stocks (models\bronze\src_stocks.sql)[0m
[0m14:47:41.385705 [error] [MainThread]:   Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^
[0m14:47:41.386443 [info ] [MainThread]: 
[0m14:47:41.387338 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\bronze\src_stocks.sql
[0m14:47:41.388147 [info ] [MainThread]: 
[0m14:47:41.388727 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m14:47:41.389780 [debug] [MainThread]: Command `-c run` failed at 14:47:41.389594 after 47.88 seconds
[0m14:47:41.390297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC786327D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78675150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC701AF150>]}
[0m14:47:41.390903 [debug] [MainThread]: Flushing usage events
[0m14:47:42.202135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:47:44.771591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBE558050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBED642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBF3A7ED0>]}


============================== 14:47:44.775945 | cbcf40c9-a4db-4334-8ca3-01e30d7a4faa ==============================
[0m14:47:44.775945 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:47:44.776785 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'write_json': 'True', 'invocation_command': 'dbt run --target prodclear', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:47:44.779433 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'portfolio_project_2' does not have a target named 'prodclear'. The valid target names for this profile are:
   - dev
   - prod
[0m14:47:44.780365 [debug] [MainThread]: Command `-c run` failed at 14:47:44.780246 after 0.13 seconds
[0m14:47:44.780733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBF4242B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBF2AA8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFBF249AE0>]}
[0m14:47:44.781124 [debug] [MainThread]: Flushing usage events
[0m14:47:45.533611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:48:30.536473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7D768050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7DF742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7E5B3ED0>]}


============================== 14:48:30.541105 | fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2 ==============================
[0m14:48:30.541105 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:48:30.541814 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target prod', 'printer_width': '80', 'target_path': 'None'}
[0m14:48:30.788802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7D920180>]}
[0m14:48:30.853194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7E45BAC0>]}
[0m14:48:30.855768 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:48:31.110806 [debug] [MainThread]: checksum: fd5f499d60404c73e369f2149bd6aa6c74754a4e78aa98476ca57564d99f7088, vars: {}, profile: , target: prod, version: 1.10.13
[0m14:48:31.188580 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:48:31.189166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7F6E9750>]}
[0m14:48:32.394734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7F85EE40>]}
[0m14:48:32.457491 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:48:32.459953 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:48:32.487434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7FEA1A90>]}
[0m14:48:32.487962 [info ] [MainThread]: Found 2 models, 2 sources, 461 macros
[0m14:48:32.488523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7FBA82C0>]}
[0m14:48:32.490267 [info ] [MainThread]: 
[0m14:48:32.490772 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:48:32.491311 [info ] [MainThread]: 
[0m14:48:32.491932 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:48:32.496832 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m14:48:32.575229 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m14:48:32.575644 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m14:48:32.575973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:33.855543 [debug] [ThreadPool]: SQL status: OK in 1.279 seconds
[0m14:48:33.857093 [debug] [ThreadPool]: On list_finance: Close
[0m14:48:33.857810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_prod)
[0m14:48:33.858318 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_prod"
"
[0m14:48:33.864662 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:48:33.865067 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m14:48:33.865380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:33.867059 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:48:33.868366 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:48:33.868678 [debug] [ThreadPool]: On create_finance_analytics_prod: BEGIN
[0m14:48:33.869601 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:48:33.869922 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:48:33.870224 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
    
        create schema if not exists "finance"."analytics_prod"
    
[0m14:48:33.923943 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m14:48:33.924978 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m14:48:33.925337 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m14:48:33.925663 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m14:48:33.985490 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m14:48:33.986044 [debug] [ThreadPool]: On create_finance_analytics_prod: Close
[0m14:48:33.988135 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_prod'
[0m14:48:33.995933 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m14:48:33.996426 [debug] [ThreadPool]: On list_finance_analytics_prod: BEGIN
[0m14:48:33.996856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:33.998372 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:48:33.998912 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m14:48:33.999524 [debug] [ThreadPool]: On list_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance_analytics_prod"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_prod'
    and lower(table_catalog) = 'finance'
  
[0m14:48:34.025467 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m14:48:34.026811 [debug] [ThreadPool]: On list_finance_analytics_prod: ROLLBACK
[0m14:48:34.027842 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_prod'
[0m14:48:34.028164 [debug] [ThreadPool]: On list_finance_analytics_prod: Close
[0m14:48:34.029302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7FE90D10>]}
[0m14:48:34.029776 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:34.030071 [debug] [MainThread]: On master: BEGIN
[0m14:48:34.030349 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:48:34.031569 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:48:34.031909 [debug] [MainThread]: On master: COMMIT
[0m14:48:34.032231 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:34.032536 [debug] [MainThread]: On master: COMMIT
[0m14:48:34.033105 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:48:34.033425 [debug] [MainThread]: On master: Close
[0m14:48:34.038175 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m14:48:34.039228 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m14:48:34.038770 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_prod.src_stocks .......................... [RUN]
[0m14:48:34.040538 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m14:48:34.040001 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_prod.src_vix ............................. [RUN]
[0m14:48:34.041066 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m14:48:34.041554 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m14:48:34.049486 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m14:48:34.050365 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m14:48:34.054721 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m14:48:34.055991 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m14:48:34.056638 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m14:48:34.089569 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m14:48:34.093389 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m14:48:34.095197 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:48:34.095715 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m14:48:34.096065 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:48:34.097049 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.097494 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m14:48:34.097874 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:48:34.098541 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:48:34.099139 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:48:34.099647 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_prod"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high:double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m14:48:34.102598 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_prod"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high:double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m14:48:34.103011 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:48:34.103467 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: ROLLBACK
[0m14:48:34.103934 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:48:34.104318 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.105714 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_prod"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close"
from src
  );

[0m14:48:34.112602 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.src_stocks'
[0m14:48:34.113026 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m14:48:34.117847 [debug] [Thread-1 (]: Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^
[0m14:48:34.121670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A000DD650>]}
[0m14:48:34.122950 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model analytics_prod.src_stocks ................. [[31mERROR[0m in 0.08s]
[0m14:48:34.124373 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m14:48:34.125467 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.src_stocks' to be skipped because of status 'error'.  Reason: Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^.
[0m14:48:34.168341 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m14:48:34.175088 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.175600 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_prod"."src_vix" rename to "src_vix__dbt_backup"
[0m14:48:34.231528 [debug] [Thread-2 (]: SQL status: OK in 0.055 seconds
[0m14:48:34.240942 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.241910 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_prod"."src_vix__dbt_tmp" rename to "src_vix"
[0m14:48:34.307170 [debug] [Thread-2 (]: SQL status: OK in 0.064 seconds
[0m14:48:34.331597 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:48:34.332127 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.332575 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:48:34.446466 [debug] [Thread-2 (]: SQL status: OK in 0.113 seconds
[0m14:48:34.451838 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:48:34.452346 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_prod"."src_vix__dbt_backup" cascade
    
[0m14:48:34.601804 [debug] [Thread-2 (]: SQL status: OK in 0.149 seconds
[0m14:48:34.604393 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m14:48:34.605031 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd78f20-ba24-4c3f-8eb7-9f36d701ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A002E1770>]}
[0m14:48:34.605661 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_prod.src_vix ........................ [[32mOK[0m in 0.56s]
[0m14:48:34.606546 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m14:48:34.608261 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:34.608613 [debug] [MainThread]: On master: BEGIN
[0m14:48:34.608907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:48:34.610196 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:48:34.610547 [debug] [MainThread]: On master: COMMIT
[0m14:48:34.610856 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:34.611146 [debug] [MainThread]: On master: COMMIT
[0m14:48:34.611800 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:48:34.612121 [debug] [MainThread]: On master: Close
[0m14:48:34.612537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:34.612818 [debug] [MainThread]: Connection 'create_finance_analytics_prod' was properly closed.
[0m14:48:34.613083 [debug] [MainThread]: Connection 'list_finance_analytics_prod' was properly closed.
[0m14:48:34.613350 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_stocks' was properly closed.
[0m14:48:34.613615 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m14:48:34.613967 [info ] [MainThread]: 
[0m14:48:34.614519 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m14:48:34.616101 [debug] [MainThread]: Command end result
[0m14:48:34.644235 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:48:34.647221 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:48:34.654773 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m14:48:34.655182 [info ] [MainThread]: 
[0m14:48:34.655814 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:48:34.656519 [info ] [MainThread]: 
[0m14:48:34.657230 [error] [MainThread]: [31mFailure in model src_stocks (models\bronze\src_stocks.sql)[0m
[0m14:48:34.657911 [error] [MainThread]:   Runtime Error in model src_stocks (models\bronze\src_stocks.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14:     high:double as high, 
                           ^
[0m14:48:34.659019 [info ] [MainThread]: 
[0m14:48:34.659798 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\bronze\src_stocks.sql
[0m14:48:34.660398 [info ] [MainThread]: 
[0m14:48:34.660899 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m14:48:34.662211 [debug] [MainThread]: Command `-c run` failed at 14:48:34.661964 after 4.26 seconds
[0m14:48:34.662844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A000C24D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A000F56D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7E4BBB60>]}
[0m14:48:34.663448 [debug] [MainThread]: Flushing usage events
[0m14:48:35.319960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:48:54.063059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C084E8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C08CF42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C09337ED0>]}


============================== 14:48:54.067582 | c9c2ad72-85e8-40be-b214-9ef8f32ce8c4 ==============================
[0m14:48:54.067582 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:48:54.068542 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt parse', 'printer_width': '80', 'write_json': 'True'}
[0m14:48:54.313823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9c2ad72-85e8-40be-b214-9ef8f32ce8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C086A0180>]}
[0m14:48:54.379559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9c2ad72-85e8-40be-b214-9ef8f32ce8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C091DB9B0>]}
[0m14:48:54.382204 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:48:54.628170 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:48:54.705334 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:48:54.705941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9c2ad72-85e8-40be-b214-9ef8f32ce8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0A441650>]}
[0m14:48:55.956655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9c2ad72-85e8-40be-b214-9ef8f32ce8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0A5BAE40>]}
[0m14:48:55.960906 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m14:48:56.027976 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:48:56.031160 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:48:56.032156 [debug] [MainThread]: Command `-c parse` succeeded at 14:48:56.032030 after 2.09 seconds
[0m14:48:56.032574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C091F3E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0A670C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0A82FEE0>]}
[0m14:48:56.032937 [debug] [MainThread]: Flushing usage events
[0m14:48:56.694280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:06.552791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3DDC8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3E5D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3EC17ED0>]}


============================== 14:50:06.557528 | 4799b82d-ea87-4fe1-b5db-edfc45a2191f ==============================
[0m14:50:06.557528 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:50:06.558247 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m14:50:06.817994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4799b82d-ea87-4fe1-b5db-edfc45a2191f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3DF80180>]}
[0m14:50:06.884180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4799b82d-ea87-4fe1-b5db-edfc45a2191f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3EABB9B0>]}
[0m14:50:06.886925 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:50:07.151310 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:50:07.280305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:07.280684 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:07.314825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4799b82d-ea87-4fe1-b5db-edfc45a2191f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3FD0F150>]}
[0m14:50:07.318514 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m14:50:07.402323 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:50:07.405088 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:50:07.405941 [debug] [MainThread]: Command `-c parse` succeeded at 14:50:07.405802 after 1.04 seconds
[0m14:50:07.406365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3EA43E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3D86C7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3EAD3E70>]}
[0m14:50:07.406768 [debug] [MainThread]: Flushing usage events
[0m14:50:08.137014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:18.927465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191DFF8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191E8042D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191EE47ED0>]}


============================== 14:50:18.932634 | fb3f3cfb-4482-441b-85f0-518ae232b0f3 ==============================
[0m14:50:18.932634 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:50:18.933696 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m14:50:19.203665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191E1B0180>]}
[0m14:50:19.274314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191ECEBAC0>]}
[0m14:50:19.276927 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:50:19.545401 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m14:50:19.625979 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:50:19.626762 [debug] [MainThread]: previous checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, current checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe
[0m14:50:19.627239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191FFE5750>]}
[0m14:50:20.994097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192015EE40>]}
[0m14:50:21.061447 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:50:21.064095 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:50:21.090915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219207A5A90>]}
[0m14:50:21.091461 [info ] [MainThread]: Found 2 models, 2 sources, 461 macros
[0m14:50:21.092061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219204A7C70>]}
[0m14:50:21.093899 [info ] [MainThread]: 
[0m14:50:21.094447 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:21.094902 [info ] [MainThread]: 
[0m14:50:21.095511 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:50:21.100463 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m14:50:21.188980 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m14:50:21.189380 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m14:50:21.189697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:22.637508 [debug] [ThreadPool]: SQL status: OK in 1.448 seconds
[0m14:50:22.639326 [debug] [ThreadPool]: On list_finance: Close
[0m14:50:22.640349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m14:50:22.640923 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m14:50:22.647177 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m14:50:22.647592 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m14:50:22.647909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:22.649678 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:50:22.651129 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m14:50:22.651496 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m14:50:22.652631 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:50:22.652976 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m14:50:22.653288 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m14:50:22.700762 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m14:50:22.701725 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m14:50:22.702066 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m14:50:22.702365 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m14:50:22.911032 [debug] [ThreadPool]: SQL status: OK in 0.208 seconds
[0m14:50:22.911849 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m14:50:22.913908 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m14:50:22.919712 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m14:50:22.920106 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m14:50:22.920394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:22.921595 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:50:22.921916 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m14:50:22.922230 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m14:50:22.947405 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m14:50:22.948763 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m14:50:22.950011 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m14:50:22.950413 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m14:50:22.951413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021920794D10>]}
[0m14:50:22.951962 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:22.952331 [debug] [MainThread]: On master: BEGIN
[0m14:50:22.952661 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:22.954196 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:50:22.954913 [debug] [MainThread]: On master: COMMIT
[0m14:50:22.955533 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:22.956124 [debug] [MainThread]: On master: COMMIT
[0m14:50:22.957254 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:50:22.957883 [debug] [MainThread]: On master: Close
[0m14:50:22.963593 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m14:50:22.964088 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m14:50:22.964654 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m14:50:22.965864 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m14:50:22.966248 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m14:50:22.973808 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m14:50:22.965181 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m14:50:22.974889 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m14:50:22.975395 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m14:50:22.978730 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m14:50:22.979865 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m14:50:23.005018 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m14:50:23.030366 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m14:50:23.031261 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m14:50:23.032455 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:50:23.033057 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m14:50:23.033445 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:23.034463 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:50:23.035007 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m14:50:23.035410 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:23.036192 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:50:23.036697 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:50:23.037111 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close"
from src
  );

[0m14:50:23.037773 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:50:23.038557 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:50:23.039408 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m14:50:23.106477 [debug] [Thread-2 (]: SQL status: OK in 0.069 seconds
[0m14:50:23.112835 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:50:23.113336 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m14:50:23.125256 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m14:50:23.128482 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:50:23.128931 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m14:50:23.170014 [debug] [Thread-2 (]: SQL status: OK in 0.056 seconds
[0m14:50:23.180114 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:50:23.180563 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:50:23.180940 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m14:50:23.183426 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m14:50:23.184711 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m14:50:23.188043 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:50:23.188424 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m14:50:23.285532 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m14:50:23.285987 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m14:50:23.291536 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m14:50:23.294260 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m14:50:23.294830 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m14:50:23.295305 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m14:50:23.348730 [debug] [Thread-2 (]: SQL status: OK in 0.053 seconds
[0m14:50:23.349339 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m14:50:23.351787 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m14:50:23.353258 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m14:50:23.356105 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192099D2E0>]}
[0m14:50:23.357185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb3f3cfb-4482-441b-85f0-518ae232b0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191E130550>]}
[0m14:50:23.356836 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.39s]
[0m14:50:23.358686 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m14:50:23.358030 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.38s]
[0m14:50:23.359615 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m14:50:23.361377 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:23.361768 [debug] [MainThread]: On master: BEGIN
[0m14:50:23.362072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:23.363292 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:50:23.363701 [debug] [MainThread]: On master: COMMIT
[0m14:50:23.364043 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:23.364353 [debug] [MainThread]: On master: COMMIT
[0m14:50:23.365038 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:50:23.365405 [debug] [MainThread]: On master: Close
[0m14:50:23.365840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:23.366165 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m14:50:23.366442 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m14:50:23.366714 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m14:50:23.366983 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_stocks' was properly closed.
[0m14:50:23.367361 [info ] [MainThread]: 
[0m14:50:23.367922 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m14:50:23.369513 [debug] [MainThread]: Command end result
[0m14:50:23.397585 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m14:50:23.400189 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m14:50:23.407508 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m14:50:23.408049 [info ] [MainThread]: 
[0m14:50:23.408923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:23.409728 [info ] [MainThread]: 
[0m14:50:23.410379 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:50:23.411427 [debug] [MainThread]: Command `-c run` succeeded at 14:50:23.411275 after 4.62 seconds
[0m14:50:23.411823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191DA3C750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191E12FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191853F150>]}
[0m14:50:23.412195 [debug] [MainThread]: Flushing usage events
[0m14:50:24.184904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:57:40.918310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808018050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8088242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808E67ED0>]}


============================== 14:57:40.923891 | 47ecd736-1bfe-49ac-a2f9-14d8628c5446 ==============================
[0m14:57:40.923891 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:57:40.924582 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt clean', 'printer_width': '80', 'target_path': 'None'}
[0m14:57:41.061902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47ecd736-1bfe-49ac-a2f9-14d8628c5446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8081D0180>]}
[0m14:57:41.095718 [debug] [MainThread]: Command `-c clean` succeeded at 14:57:41.095524 after 0.37 seconds
[0m14:57:41.096147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808D0A470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808D09F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808D03B50>]}
[0m14:57:41.096560 [debug] [MainThread]: Flushing usage events
[0m14:57:41.866239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:13:42.051627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC7EC8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC86D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC8D17ED0>]}


============================== 18:13:42.056001 | 778e2293-7214-474e-b4f7-b4d7601ca520 ==============================
[0m18:13:42.056001 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:13:42.056784 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --target prod', 'printer_width': '80', 'target_path': 'None'}
[0m18:13:42.304019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC8080180>]}
[0m18:13:42.369313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC8BBBAC0>]}
[0m18:13:42.371978 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:13:42.624611 [debug] [MainThread]: checksum: fd5f499d60404c73e369f2149bd6aa6c74754a4e78aa98476ca57564d99f7088, vars: {}, profile: , target: prod, version: 1.10.13
[0m18:13:42.703106 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:13:42.703671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC9E15750>]}
[0m18:13:43.925897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFC9F8EE40>]}
[0m18:13:43.988711 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:13:43.999904 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:13:44.048272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA6197F0>]}
[0m18:13:44.048755 [info ] [MainThread]: Found 2 models, 2 sources, 461 macros
[0m18:13:44.050762 [info ] [MainThread]: 
[0m18:13:44.051286 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m18:13:44.051746 [info ] [MainThread]: 
[0m18:13:44.052363 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:13:44.057504 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m18:13:44.133632 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m18:13:44.134025 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m18:13:44.134340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:45.359809 [debug] [ThreadPool]: SQL status: OK in 1.225 seconds
[0m18:13:45.361190 [debug] [ThreadPool]: On list_finance: Close
[0m18:13:45.361908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_prod)
[0m18:13:45.362378 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_prod"
"
[0m18:13:45.368133 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m18:13:45.368497 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m18:13:45.368803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:45.370276 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:45.371613 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m18:13:45.371929 [debug] [ThreadPool]: On create_finance_analytics_prod: BEGIN
[0m18:13:45.373109 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:45.373682 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m18:13:45.373999 [debug] [ThreadPool]: On create_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "create_finance_analytics_prod"} */

    
    
        create schema if not exists "finance"."analytics_prod"
    
[0m18:13:45.424623 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m18:13:45.425570 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m18:13:45.425897 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_prod"
[0m18:13:45.426194 [debug] [ThreadPool]: On create_finance_analytics_prod: COMMIT
[0m18:13:45.473200 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m18:13:45.473619 [debug] [ThreadPool]: On create_finance_analytics_prod: Close
[0m18:13:45.475121 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_prod'
[0m18:13:45.480423 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m18:13:45.480839 [debug] [ThreadPool]: On list_finance_analytics_prod: BEGIN
[0m18:13:45.481153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:45.482374 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:45.482710 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_prod"
[0m18:13:45.483043 [debug] [ThreadPool]: On list_finance_analytics_prod: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "connection_name": "list_finance_analytics_prod"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_prod'
    and lower(table_catalog) = 'finance'
  
[0m18:13:45.507574 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m18:13:45.509231 [debug] [ThreadPool]: On list_finance_analytics_prod: ROLLBACK
[0m18:13:45.510478 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_prod'
[0m18:13:45.510854 [debug] [ThreadPool]: On list_finance_analytics_prod: Close
[0m18:13:45.512183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA883380>]}
[0m18:13:45.512687 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:45.513019 [debug] [MainThread]: On master: BEGIN
[0m18:13:45.513334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:45.514557 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:45.514914 [debug] [MainThread]: On master: COMMIT
[0m18:13:45.515221 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:45.515511 [debug] [MainThread]: On master: COMMIT
[0m18:13:45.516113 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:45.516433 [debug] [MainThread]: On master: Close
[0m18:13:45.520779 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m18:13:45.521682 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m18:13:45.521311 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_prod.src_stocks .......................... [RUN]
[0m18:13:45.523268 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m18:13:45.523828 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m18:13:45.530855 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m18:13:45.522164 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_prod.src_vix ............................. [RUN]
[0m18:13:45.531605 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m18:13:45.531982 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m18:13:45.536797 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m18:13:45.539292 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m18:13:45.539923 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m18:13:45.569270 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m18:13:45.572445 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m18:13:45.575631 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.576153 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m18:13:45.576560 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:13:45.577387 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m18:13:45.577804 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m18:13:45.578167 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:13:45.578809 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:13:45.579196 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.579577 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_prod"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close"
from src
  );

[0m18:13:45.580234 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:45.580618 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m18:13:45.581008 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_prod"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m18:13:45.655677 [debug] [Thread-2 (]: SQL status: OK in 0.076 seconds
[0m18:13:45.656264 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m18:13:45.661965 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.664506 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m18:13:45.664945 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_prod"."src_vix" rename to "src_vix__dbt_backup"
[0m18:13:45.665389 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_prod"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m18:13:45.713777 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m18:13:45.716800 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.717193 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_prod"."src_vix__dbt_tmp" rename to "src_vix"
[0m18:13:45.717599 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m18:13:45.727514 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m18:13:45.727942 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m18:13:45.728287 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m18:13:45.765464 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m18:13:45.768662 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:13:45.769062 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.769403 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:13:45.856185 [debug] [Thread-2 (]: SQL status: OK in 0.086 seconds
[0m18:13:45.861310 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:13:45.861709 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_prod"."src_vix__dbt_backup" cascade
    
[0m18:13:45.862253 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m18:13:45.864497 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m18:13:45.864883 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "prod", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_prod"."src_stocks__dbt_backup" cascade
    
[0m18:13:45.966596 [debug] [Thread-2 (]: SQL status: OK in 0.104 seconds
[0m18:13:45.968952 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m18:13:45.971379 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA66D850>]}
[0m18:13:45.972726 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m18:13:45.972171 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_prod.src_vix ........................ [[32mOK[0m in 0.44s]
[0m18:13:45.974325 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m18:13:45.974994 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m18:13:45.975611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778e2293-7214-474e-b4f7-b4d7601ca520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCAA70680>]}
[0m18:13:45.976397 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_prod.src_stocks ..................... [[32mOK[0m in 0.45s]
[0m18:13:45.977185 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m18:13:45.978775 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:45.979172 [debug] [MainThread]: On master: BEGIN
[0m18:13:45.979481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:45.980676 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:45.981043 [debug] [MainThread]: On master: COMMIT
[0m18:13:45.981347 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:45.981635 [debug] [MainThread]: On master: COMMIT
[0m18:13:45.982236 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:45.982548 [debug] [MainThread]: On master: Close
[0m18:13:45.982977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:45.983324 [debug] [MainThread]: Connection 'create_finance_analytics_prod' was properly closed.
[0m18:13:45.983618 [debug] [MainThread]: Connection 'list_finance_analytics_prod' was properly closed.
[0m18:13:45.983893 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_stocks' was properly closed.
[0m18:13:45.984164 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m18:13:45.984521 [info ] [MainThread]: 
[0m18:13:45.985077 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m18:13:45.986492 [debug] [MainThread]: Command end result
[0m18:13:46.006912 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:13:46.009215 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:13:46.015501 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m18:13:46.015926 [info ] [MainThread]: 
[0m18:13:46.016785 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:46.017498 [info ] [MainThread]: 
[0m18:13:46.018025 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:13:46.018944 [debug] [MainThread]: Command `-c build` succeeded at 18:13:46.018820 after 4.15 seconds
[0m18:13:46.019328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA9AC690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA627EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFCA518D50>]}
[0m18:13:46.019739 [debug] [MainThread]: Flushing usage events
[0m18:13:46.744053 [debug] [MainThread]: An error was encountered while trying to flush usage events
<<<<<<< HEAD
[0m12:48:23.260576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39BB28050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39C3342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39C973ED0>]}


============================== 12:48:23.265177 | 29d5d14d-0b1e-4c42-960f-43b7dd783c25 ==============================
[0m12:48:23.265177 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:48:23.265860 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select +fct__rsi', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m12:48:23.508254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39BCE0180>]}
[0m12:48:23.572533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39C81B9B0>]}
[0m12:48:23.575231 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:48:23.827197 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:48:23.905984 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:48:23.906557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39DA71B50>]}
[0m12:48:25.171983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39DBEEE40>]}
[0m12:48:25.238688 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:48:25.241000 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:48:25.268220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E245C50>]}
[0m12:48:25.268694 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:48:25.269203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39DE88870>]}
[0m12:48:25.270871 [info ] [MainThread]: 
[0m12:48:25.271364 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:48:25.271828 [info ] [MainThread]: 
[0m12:48:25.272468 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:48:25.277535 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:48:25.355448 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:48:25.355852 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */
=======
[0m20:48:19.314869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001961FEB8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196206C42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019620D03ED0>]}


============================== 20:48:19.325571 | 111018e3-ab84-45ee-af77-7911f083b6ff ==============================
[0m20:48:19.325571 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:48:19.327224 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt parse', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m20:48:19.940469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '111018e3-ab84-45ee-af77-7911f083b6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019620070180>]}
[0m20:48:20.057180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '111018e3-ab84-45ee-af77-7911f083b6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019620BAB9B0>]}
[0m20:48:20.091711 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:48:21.053195 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:48:21.236985 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:48:21.238190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '111018e3-ab84-45ee-af77-7911f083b6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019621E31B50>]}
[0m20:48:26.470820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '111018e3-ab84-45ee-af77-7911f083b6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019621FAAE40>]}
[0m20:48:26.479955 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m20:48:26.611648 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:48:26.641702 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:48:26.644093 [debug] [MainThread]: Command `-c parse` succeeded at 20:48:26.643791 after 7.72 seconds
[0m20:48:26.644864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019620BC3E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019622064BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019622217EE0>]}
[0m20:48:26.645674 [debug] [MainThread]: Flushing usage events
[0m20:48:28.215030 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:53.782491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F1FA38050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F202442D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F20887ED0>]}


============================== 20:48:53.793818 | bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30 ==============================
[0m20:48:53.793818 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:48:53.795560 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select stg__rsi', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m20:48:54.356873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F1FBF0180>]}
[0m20:48:54.467255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F2072B9B0>]}
[0m20:48:54.471229 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:48:54.941820 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:48:55.207157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:48:55.208271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:48:55.313587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F2198B150>]}
[0m20:48:55.447471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:48:55.451584 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:48:55.497053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F206B3E30>]}
[0m20:48:55.497901 [info ] [MainThread]: Found 3 models, 2 sources, 461 macros
[0m20:48:55.498854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F21A23230>]}
[0m20:48:55.501625 [info ] [MainThread]: 
[0m20:48:55.502513 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:48:55.503444 [info ] [MainThread]: 
[0m20:48:55.504875 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:48:55.506867 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m20:49:01.393083 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m20:49:01.394072 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
<<<<<<< HEAD
[0m12:48:25.356171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:27.096239 [debug] [ThreadPool]: SQL status: OK in 1.740 seconds
[0m12:48:27.097624 [debug] [ThreadPool]: On list_finance: Close
[0m12:48:27.098341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:48:27.098818 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:48:27.105499 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:48:27.105905 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */
=======
[0m20:49:01.394884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:03.709439 [debug] [ThreadPool]: SQL status: OK in 2.314 seconds
[0m20:49:03.712988 [debug] [ThreadPool]: On list_finance: Close
[0m20:49:03.714750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m20:49:03.716081 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m20:49:03.731367 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:03.732321 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
<<<<<<< HEAD
[0m12:48:27.106220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:27.107807 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:48:27.109144 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:48:27.109456 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:48:27.110513 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:48:27.110824 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:48:27.111130 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */
=======
[0m20:49:03.733117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:03.736915 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:49:03.740273 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:03.741138 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m20:49:03.743837 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:49:03.744722 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:03.745520 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

    
    
        create schema if not exists "finance"."analytics_dev"
    
<<<<<<< HEAD
[0m12:48:27.160850 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m12:48:27.161821 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:48:27.162165 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:48:27.162481 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:48:27.213547 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m12:48:27.213981 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:48:27.215865 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:48:27.221452 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:48:27.221901 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:48:27.222187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:27.223374 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:48:27.223684 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:48:27.224011 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
=======
[0m20:49:03.817884 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m20:49:03.822096 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:03.823801 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:03.825449 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:03.896702 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m20:49:03.897456 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m20:49:03.906390 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m20:49:03.916764 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:03.917348 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m20:49:03.917818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:03.919549 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:49:03.920113 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:03.920636 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
<<<<<<< HEAD
[0m12:48:27.248249 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m12:48:27.249655 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:48:27.250715 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:48:27.251024 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:48:27.252882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E125250>]}
[0m12:48:27.253314 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:27.253613 [debug] [MainThread]: On master: BEGIN
[0m12:48:27.253895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:27.255129 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:48:27.255443 [debug] [MainThread]: On master: COMMIT
[0m12:48:27.255738 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:27.256018 [debug] [MainThread]: On master: COMMIT
[0m12:48:27.256652 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:48:27.256952 [debug] [MainThread]: On master: Close
[0m12:48:27.262016 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m12:48:27.262561 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m12:48:27.263437 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m12:48:27.263797 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m12:48:27.270405 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m12:48:27.271334 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m12:48:27.302413 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m12:48:27.303523 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:48:27.304099 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m12:48:27.304569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:48:27.306741 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:48:27.307484 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:48:27.307855 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
=======
[0m20:49:03.961650 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m20:49:03.963840 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m20:49:03.994839 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m20:49:03.995429 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m20:49:03.997404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F2208B380>]}
[0m20:49:03.998164 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:03.998699 [debug] [MainThread]: On master: BEGIN
[0m20:49:03.999172 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:04.000925 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:49:04.001504 [debug] [MainThread]: On master: COMMIT
[0m20:49:04.002012 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:04.002498 [debug] [MainThread]: On master: COMMIT
[0m20:49:04.003604 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:04.004292 [debug] [MainThread]: On master: Close
[0m20:49:04.010675 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__rsi
[0m20:49:04.011582 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.stg__rsi ............................. [RUN]
[0m20:49:04.013160 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__rsi'
[0m20:49:04.013877 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__rsi
[0m20:49:04.025832 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__rsi"
[0m20:49:04.028333 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__rsi
[0m20:49:04.079470 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__rsi"
[0m20:49:04.081471 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:04.082124 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: BEGIN
[0m20:49:04.082706 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:49:04.084937 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:04.085721 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:04.086481 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


with recursive wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:04.115069 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


with recursive wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:04.116013 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:49:04.117453 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: ROLLBACK
[0m20:49:04.352567 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.stg__rsi'
[0m20:49:04.353591 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: Close
[0m20:49:04.363452 [debug] [Thread-1 (]: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "with"
  
  LINE 78: with recursive wilder as (
           ^
[0m20:49:04.368545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd9aa3ea-43ac-45ef-bdb3-1aa2835ade30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F220F8650>]}
[0m20:49:04.370251 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.stg__rsi .................... [[31mERROR[0m in 0.35s]
[0m20:49:04.372346 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__rsi
[0m20:49:04.373941 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.stg__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "with"
  
  LINE 78: with recursive wilder as (
           ^.
[0m20:49:04.378701 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:04.379607 [debug] [MainThread]: On master: BEGIN
[0m20:49:04.380380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:04.383014 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m20:49:04.383880 [debug] [MainThread]: On master: COMMIT
[0m20:49:04.384701 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:04.385505 [debug] [MainThread]: On master: COMMIT
[0m20:49:04.387243 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:04.388490 [debug] [MainThread]: On master: Close
[0m20:49:04.389642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:04.390438 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m20:49:04.391168 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m20:49:04.391877 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__rsi' was properly closed.
[0m20:49:04.392639 [info ] [MainThread]: 
[0m20:49:04.394042 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m20:49:04.396215 [debug] [MainThread]: Command end result
[0m20:49:04.444186 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:49:04.447829 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:49:04.459718 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m20:49:04.460368 [info ] [MainThread]: 
[0m20:49:04.461236 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:49:04.462076 [info ] [MainThread]: 
[0m20:49:04.463005 [error] [MainThread]: [31mFailure in model stg__rsi (models\silver\stg__rsi.sql)[0m
[0m20:49:04.463910 [error] [MainThread]:   Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "with"
  
  LINE 78: with recursive wilder as (
           ^
[0m20:49:04.464695 [info ] [MainThread]: 
[0m20:49:04.465516 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\stg__rsi.sql
[0m20:49:04.466274 [info ] [MainThread]: 
[0m20:49:04.467229 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:49:04.468769 [debug] [MainThread]: Command `-c run` failed at 20:49:04.468544 after 10.97 seconds
[0m20:49:04.469439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F220D5BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F221E5D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F221E7C50>]}
[0m20:49:04.470038 [debug] [MainThread]: Flushing usage events
[0m20:49:05.703591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:21.808901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780BE28050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780C6342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780CC77ED0>]}


============================== 20:49:21.815658 | b0342c31-503d-4727-b873-0681fcb97da8 ==============================
[0m20:49:21.815658 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:49:21.816743 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select stg__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m20:49:22.338093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780BFE0180>]}
[0m20:49:22.456812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780CB1B9B0>]}
[0m20:49:22.461293 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:49:23.045476 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:49:23.190228 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:49:23.191265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780DD89B50>]}
[0m20:49:25.273143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780DEFEE40>]}
[0m20:49:25.373088 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:49:25.376269 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:49:25.416548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E541C50>]}
[0m20:49:25.417249 [info ] [MainThread]: Found 3 models, 2 sources, 461 macros
[0m20:49:25.418243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E167C70>]}
[0m20:49:25.420617 [info ] [MainThread]: 
[0m20:49:25.421393 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:49:25.422119 [info ] [MainThread]: 
[0m20:49:25.423099 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:49:25.424628 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m20:49:25.560364 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m20:49:25.561000 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m20:49:25.561527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:27.654626 [debug] [ThreadPool]: SQL status: OK in 2.093 seconds
[0m20:49:27.658365 [debug] [ThreadPool]: On list_finance: Close
[0m20:49:27.660071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m20:49:27.661470 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m20:49:27.675472 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:27.676314 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m20:49:27.677163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:27.680810 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:49:27.684124 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:27.684959 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m20:49:27.687556 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:49:27.688431 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:27.689277 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m20:49:27.751837 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m20:49:27.754173 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:27.755028 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:27.755799 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:27.807902 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m20:49:27.808899 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m20:49:27.822002 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m20:49:27.836589 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:27.837480 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m20:49:27.838238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:27.840908 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:49:27.841714 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:27.842538 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m20:49:27.897035 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m20:49:27.899170 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m20:49:27.900695 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m20:49:27.901182 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m20:49:27.903201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E52DE50>]}
[0m20:49:27.904106 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:27.904693 [debug] [MainThread]: On master: BEGIN
[0m20:49:27.905306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:27.907505 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:49:27.908205 [debug] [MainThread]: On master: COMMIT
[0m20:49:27.908881 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:27.909563 [debug] [MainThread]: On master: COMMIT
[0m20:49:27.910841 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:27.911457 [debug] [MainThread]: On master: Close
[0m20:49:27.919392 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__rsi
[0m20:49:27.920523 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.stg__rsi ............................. [RUN]
[0m20:49:27.921802 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__rsi'
[0m20:49:27.922515 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__rsi
[0m20:49:27.936105 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__rsi"
[0m20:49:27.937747 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__rsi
[0m20:49:27.997293 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__rsi"
[0m20:49:27.999033 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:27.999770 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: BEGIN
[0m20:49:28.000444 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:49:28.003012 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:28.003767 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:28.004716 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


recursive wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:28.031878 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


recursive wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:28.033097 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:49:28.033994 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: ROLLBACK
[0m20:49:28.046646 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.stg__rsi'
[0m20:49:28.047408 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: Close
[0m20:49:28.057213 [debug] [Thread-1 (]: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "wilder"
  
  LINE 78: recursive wilder as (
                     ^
[0m20:49:28.060850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0342c31-503d-4727-b873-0681fcb97da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E7495A0>]}
[0m20:49:28.062081 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.stg__rsi .................... [[31mERROR[0m in 0.14s]
[0m20:49:28.063647 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__rsi
[0m20:49:28.064854 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.stg__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "wilder"
  
  LINE 78: recursive wilder as (
                     ^.
[0m20:49:28.068444 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:28.069112 [debug] [MainThread]: On master: BEGIN
[0m20:49:28.069707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:28.071967 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:49:28.073028 [debug] [MainThread]: On master: COMMIT
[0m20:49:28.073690 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:28.074269 [debug] [MainThread]: On master: COMMIT
[0m20:49:28.075484 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:28.076106 [debug] [MainThread]: On master: Close
[0m20:49:28.076856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:28.077402 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m20:49:28.077931 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m20:49:28.078443 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__rsi' was properly closed.
[0m20:49:28.079015 [info ] [MainThread]: 
[0m20:49:28.079896 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m20:49:28.081581 [debug] [MainThread]: Command end result
[0m20:49:28.127657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:49:28.131797 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:49:28.143095 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m20:49:28.143736 [info ] [MainThread]: 
[0m20:49:28.144816 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:49:28.145723 [info ] [MainThread]: 
[0m20:49:28.146768 [error] [MainThread]: [31mFailure in model stg__rsi (models\silver\stg__rsi.sql)[0m
[0m20:49:28.147986 [error] [MainThread]:   Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Parser Error: syntax error at or near "wilder"
  
  LINE 78: recursive wilder as (
                     ^
[0m20:49:28.148905 [info ] [MainThread]: 
[0m20:49:28.149965 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\stg__rsi.sql
[0m20:49:28.150794 [info ] [MainThread]: 
[0m20:49:28.151671 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:49:28.153336 [debug] [MainThread]: Command `-c run` failed at 20:49:28.153103 after 6.53 seconds
[0m20:49:28.154215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E51A530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E54DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780E722C50>]}
[0m20:49:28.155532 [debug] [MainThread]: Flushing usage events
[0m20:49:29.436579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:42.038086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FFA28050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1812E42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F181923ED0>]}


============================== 20:49:42.045560 | 5ea5a74c-428f-4309-ac17-91512b519e1f ==============================
[0m20:49:42.045560 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:49:42.046942 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt run --select stg__rsi', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m20:49:42.451743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FFBE0180>]}
[0m20:49:42.570146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1817CB9B0>]}
[0m20:49:42.575815 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:49:43.014978 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:49:43.187376 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:49:43.188428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F182A71B50>]}
[0m20:49:45.780008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F182BEAE40>]}
[0m20:49:45.888411 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:49:45.892049 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:49:45.942408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F183235C50>]}
[0m20:49:45.943312 [info ] [MainThread]: Found 3 models, 2 sources, 461 macros
[0m20:49:45.944300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F182E53C70>]}
[0m20:49:45.947326 [info ] [MainThread]: 
[0m20:49:45.948417 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:49:45.949331 [info ] [MainThread]: 
[0m20:49:45.950582 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:49:45.952481 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m20:49:46.108798 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m20:49:46.109526 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m20:49:46.110137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:47.713087 [debug] [ThreadPool]: SQL status: OK in 1.603 seconds
[0m20:49:47.716754 [debug] [ThreadPool]: On list_finance: Close
[0m20:49:47.718901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m20:49:47.720184 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m20:49:47.735864 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:47.737252 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m20:49:47.738120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:47.741779 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:49:47.745396 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:47.746287 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m20:49:47.748800 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:49:47.749677 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:47.750498 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m20:49:47.817504 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m20:49:47.819799 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:47.820707 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:49:47.821507 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:49:47.894450 [debug] [ThreadPool]: SQL status: OK in 0.072 seconds
[0m20:49:47.895473 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m20:49:47.908991 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m20:49:47.922883 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:47.923800 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m20:49:47.924694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:47.927550 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:49:47.928452 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:49:47.929277 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m20:49:47.993610 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m20:49:47.997025 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m20:49:47.999590 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m20:49:48.000359 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m20:49:48.002955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F183225E50>]}
[0m20:49:48.004149 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:48.004781 [debug] [MainThread]: On master: BEGIN
[0m20:49:48.005406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:48.007969 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m20:49:48.008809 [debug] [MainThread]: On master: COMMIT
[0m20:49:48.009476 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:48.010100 [debug] [MainThread]: On master: COMMIT
[0m20:49:48.011405 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:48.012098 [debug] [MainThread]: On master: Close
[0m20:49:48.020839 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__rsi
[0m20:49:48.021989 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.stg__rsi ............................. [RUN]
[0m20:49:48.023824 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__rsi'
[0m20:49:48.024750 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__rsi
[0m20:49:48.039293 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__rsi"
[0m20:49:48.041575 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__rsi
[0m20:49:48.109369 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__rsi"
[0m20:49:48.111356 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:48.112910 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: BEGIN
[0m20:49:48.113816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:49:48.116718 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:48.117615 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:49:48.118736 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:48.200449 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:49:48.201639 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:49:48.202589 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: ROLLBACK
[0m20:49:48.217589 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.stg__rsi'
[0m20:49:48.218512 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: Close
[0m20:49:48.227877 [debug] [Thread-1 (]: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Binder Error: Referenced column "loaded_at" not found in FROM clause!
  Candidate bindings: "trade_date", "close", "daily_gain", "daily_change", "sma_gain"
  
  LINE 72: ...number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
                                                                         ^
[0m20:49:48.231783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea5a74c-428f-4309-ac17-91512b519e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1834394F0>]}
[0m20:49:48.233224 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.stg__rsi .................... [[31mERROR[0m in 0.21s]
[0m20:49:48.234924 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__rsi
[0m20:49:48.236261 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.stg__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Binder Error: Referenced column "loaded_at" not found in FROM clause!
  Candidate bindings: "trade_date", "close", "daily_gain", "daily_change", "sma_gain"
  
  LINE 72: ...number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
                                                                         ^.
[0m20:49:48.240693 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:48.241475 [debug] [MainThread]: On master: BEGIN
[0m20:49:48.242123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:48.244397 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:49:48.245098 [debug] [MainThread]: On master: COMMIT
[0m20:49:48.245766 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:48.246417 [debug] [MainThread]: On master: COMMIT
[0m20:49:48.247873 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:48.248623 [debug] [MainThread]: On master: Close
[0m20:49:48.249502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:48.250123 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m20:49:48.250720 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m20:49:48.251294 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__rsi' was properly closed.
[0m20:49:48.251917 [info ] [MainThread]: 
[0m20:49:48.252871 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m20:49:48.254653 [debug] [MainThread]: Command end result
[0m20:49:48.317301 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:49:48.322924 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:49:48.336327 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m20:49:48.337343 [info ] [MainThread]: 
[0m20:49:48.338745 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:49:48.339868 [info ] [MainThread]: 
[0m20:49:48.342006 [error] [MainThread]: [31mFailure in model stg__rsi (models\silver\stg__rsi.sql)[0m
[0m20:49:48.343393 [error] [MainThread]:   Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Binder Error: Referenced column "loaded_at" not found in FROM clause!
  Candidate bindings: "trade_date", "close", "daily_gain", "daily_change", "sma_gain"
  
  LINE 72: ...number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
                                                                         ^
[0m20:49:48.344621 [info ] [MainThread]: 
[0m20:49:48.346286 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\stg__rsi.sql
[0m20:49:48.347455 [info ] [MainThread]: 
[0m20:49:48.358514 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:49:48.374762 [debug] [MainThread]: Command `-c run` failed at 20:49:48.374190 after 6.54 seconds
[0m20:49:48.376429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18320E530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F183241D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FFB70F50>]}
[0m20:49:48.378174 [debug] [MainThread]: Flushing usage events
[0m20:49:49.834253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:25.119211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F43E88050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F446942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F44CD7ED0>]}


============================== 20:50:25.126201 | c1cc3688-3a5f-477b-b62f-c1e5310bff93 ==============================
[0m20:50:25.126201 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:50:25.127405 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select stg__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m20:50:25.497793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F44040180>]}
[0m20:50:25.593469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F44B7B9B0>]}
[0m20:50:25.597044 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:50:25.976212 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:50:26.095587 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:50:26.096449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F45DD9B50>]}
[0m20:50:27.956372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F45F4EE40>]}
[0m20:50:28.058459 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:50:28.061747 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:50:28.096517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F46595C50>]}
[0m20:50:28.097170 [info ] [MainThread]: Found 3 models, 2 sources, 461 macros
[0m20:50:28.097846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F461B3C70>]}
[0m20:50:28.099896 [info ] [MainThread]: 
[0m20:50:28.100595 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:50:28.101263 [info ] [MainThread]: 
[0m20:50:28.102166 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:50:28.103652 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m20:50:28.234893 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m20:50:28.235515 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m20:50:28.236031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:29.915685 [debug] [ThreadPool]: SQL status: OK in 1.679 seconds
[0m20:50:29.919089 [debug] [ThreadPool]: On list_finance: Close
[0m20:50:29.921117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m20:50:29.922412 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m20:50:29.937430 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:50:29.938346 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m20:50:29.939144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:29.942873 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:50:29.946389 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:50:29.947226 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m20:50:29.949743 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:50:29.950560 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:50:29.951351 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m20:50:30.022548 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m20:50:30.025105 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:50:30.026189 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m20:50:30.027005 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m20:50:30.089333 [debug] [ThreadPool]: SQL status: OK in 0.061 seconds
[0m20:50:30.090290 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m20:50:30.103292 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m20:50:30.117077 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:50:30.117984 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m20:50:30.118739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:30.121459 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:50:30.122308 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m20:50:30.123181 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m20:50:30.184419 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m20:50:30.187258 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m20:50:30.189309 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m20:50:30.189956 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m20:50:30.192512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4657DE50>]}
[0m20:50:30.193308 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:30.193893 [debug] [MainThread]: On master: BEGIN
[0m20:50:30.194380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:30.196257 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:50:30.196790 [debug] [MainThread]: On master: COMMIT
[0m20:50:30.197365 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:30.197855 [debug] [MainThread]: On master: COMMIT
[0m20:50:30.198870 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:50:30.199401 [debug] [MainThread]: On master: Close
[0m20:50:30.206117 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__rsi
[0m20:50:30.206979 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.stg__rsi ............................. [RUN]
[0m20:50:30.208145 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__rsi'
[0m20:50:30.208789 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__rsi
[0m20:50:30.220055 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__rsi"
[0m20:50:30.221506 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__rsi
[0m20:50:30.270261 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__rsi"
[0m20:50:30.271716 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:50:30.272323 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: BEGIN
[0m20:50:30.272886 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:50:30.275800 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:50:30.276493 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__rsi"
[0m20:50:30.277305 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        loaded_at,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:50:30.359519 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__rsi"} */

  
  create view "finance"."analytics_dev"."stg__rsi__dbt_tmp" as (
    with base as (
    SELECT 
        trade_date,
        ticker,
        "close",
        loaded_at
    FROm "finance"."analytics_dev"."src_stocks"
),

period_change as (

    select
        trade_date,
        ticker,
        "close",
        "close" - LAG("close", 1) OVER(partition by ticker order by trade_date asc, loaded_at asc) as daily_change,
        count(*) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

bucket_gain_loss as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        (CASE WHEN daily_change > 0 THEN daily_change ELSE 0 END) AS daily_gain,
        (CASE WHEN daily_change < 0 THEN ABS(daily_change) ELSE 0 END)  AS daily_loss,
        period_check,
        loaded_at
    from period_change
),

sma_avg as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        AVG(daily_gain) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        AVG(daily_loss) OVER(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        loaded_at,
        period_check
    from bucket_gain_loss
),

row_num as (
    select
        trade_date,
        ticker,
        "close",
        daily_change,
        daily_gain,
        daily_loss,
        sma_gain,
        sma_loss,
        row_number() OVER(PARTITION BY ticker ORDER BY trade_date asc, loaded_at asc) as rn,
        period_check
    from sma_avg
),


wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.daily_gain,
        r.daily_loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from row_num r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.daily_gain,
        nxt.daily_loss,
        (prev.wilder_gain * 13 + nxt.daily_gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.daily_loss) / 14.0 as wilder_loss
    from row_num nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
),


rsi as (
    select
        trade_date,
        ticker,
        (wilder_gain / NULLIF(wilder_loss,0)) as rs,
        100 - (100 / (1 + (wilder_gain / NULLIF(wilder_loss,0)))) as rsi
    from wilder
), 

final as ( 
    select 
        r.trade_date,
        r.ticker,
        (CASE WHEN pc.period_check < 14 then null else r.rs end) as rs,
        (case when pc.period_check < 14 then null else r.rsi end) as rsi
    from rsi r
    join period_change pc on r.trade_date = pc.trade_date and r.ticker = pc.ticker
    )

select *
from final
  );

[0m20:50:30.360547 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:50:30.361402 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: ROLLBACK
[0m20:50:30.373376 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.stg__rsi'
[0m20:50:30.374452 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__rsi: Close
[0m20:50:30.381896 [debug] [Thread-1 (]: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Catalog Error: Table with name wilder does not exist!
  Did you mean "pg_index"?
  
  LINE 104:     join wilder prev
                     ^
[0m20:50:30.385086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1cc3688-3a5f-477b-b62f-c1e5310bff93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F467995A0>]}
[0m20:50:30.386169 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.stg__rsi .................... [[31mERROR[0m in 0.17s]
[0m20:50:30.387440 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__rsi
[0m20:50:30.388448 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.stg__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Catalog Error: Table with name wilder does not exist!
  Did you mean "pg_index"?
  
  LINE 104:     join wilder prev
                     ^.
[0m20:50:30.391447 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:30.392025 [debug] [MainThread]: On master: BEGIN
[0m20:50:30.392523 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:30.394407 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:50:30.395008 [debug] [MainThread]: On master: COMMIT
[0m20:50:30.395563 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:30.396040 [debug] [MainThread]: On master: COMMIT
[0m20:50:30.397004 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:50:30.397510 [debug] [MainThread]: On master: Close
[0m20:50:30.398352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:30.399264 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m20:50:30.399921 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m20:50:30.400365 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__rsi' was properly closed.
[0m20:50:30.400854 [info ] [MainThread]: 
[0m20:50:30.401550 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m20:50:30.402948 [debug] [MainThread]: Command end result
[0m20:50:30.441501 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:50:30.445051 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:50:30.455340 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m20:50:30.455970 [info ] [MainThread]: 
[0m20:50:30.456990 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:50:30.457837 [info ] [MainThread]: 
[0m20:50:30.458811 [error] [MainThread]: [31mFailure in model stg__rsi (models\silver\stg__rsi.sql)[0m
[0m20:50:30.459778 [error] [MainThread]:   Runtime Error in model stg__rsi (models\silver\stg__rsi.sql)
  Catalog Error: Table with name wilder does not exist!
  Did you mean "pg_index"?
  
  LINE 104:     join wilder prev
                     ^
[0m20:50:30.460874 [info ] [MainThread]: 
[0m20:50:30.462368 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\stg__rsi.sql
[0m20:50:30.463292 [info ] [MainThread]: 
[0m20:50:30.464209 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:50:30.465801 [debug] [MainThread]: Command `-c run` failed at 20:50:30.465567 after 5.55 seconds
[0m20:50:30.466541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F46562530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4659DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F46772C50>]}
[0m20:50:30.467258 [debug] [MainThread]: Flushing usage events
[0m20:50:31.464541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:42.759070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021933098050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219338A42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021933EE3ED0>]}


============================== 12:38:42.765569 | c3c0a9d0-7cbd-4c4b-8e01-dd920b403997 ==============================
[0m12:38:42.765569 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:38:42.766237 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m12:38:43.188944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3c0a9d0-7cbd-4c4b-8e01-dd920b403997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021933250180>]}
[0m12:38:43.252910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3c0a9d0-7cbd-4c4b-8e01-dd920b403997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021933D8B9B0>]}
[0m12:38:43.271380 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:38:43.687760 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:38:43.765406 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:38:43.766066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3c0a9d0-7cbd-4c4b-8e01-dd920b403997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021934FDDB50>]}
[0m12:38:46.187167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3c0a9d0-7cbd-4c4b-8e01-dd920b403997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193515EE40>]}
[0m12:38:46.191038 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m12:38:46.260167 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:38:46.283619 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:38:46.284420 [debug] [MainThread]: Command `-c parse` succeeded at 12:38:46.284300 after 3.70 seconds
[0m12:38:46.284784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021933DA3E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021935210C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219353C7EE0>]}
[0m12:38:46.285144 [debug] [MainThread]: Flushing usage events
[0m12:38:47.035873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:36.728689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132C608050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132CE142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D457ED0>]}


============================== 12:39:36.732893 | 1647c0db-536d-40d7-9ec6-dccf16440c45 ==============================
[0m12:39:36.732893 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:39:36.733529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'invocation_command': 'dbt clean', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m12:39:36.867135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1647c0db-536d-40d7-9ec6-dccf16440c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132C7C0180>]}
[0m12:39:36.901861 [debug] [MainThread]: Command `-c clean` succeeded at 12:39:36.901696 after 0.30 seconds
[0m12:39:36.902268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D2FA470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D2F9F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D2F3A50>]}
[0m12:39:36.902648 [debug] [MainThread]: Flushing usage events
[0m12:39:37.819313 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:41.068807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE659A8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE661B42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE667F3ED0>]}


============================== 12:39:41.073626 | 3479392e-08f1-424d-bf45-fff4c452d3b3 ==============================
[0m12:39:41.073626 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:39:41.074544 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt parse', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m12:39:41.353453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3479392e-08f1-424d-bf45-fff4c452d3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE65B60180>]}
[0m12:39:41.418345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3479392e-08f1-424d-bf45-fff4c452d3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6669B9B0>]}
[0m12:39:41.420938 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:39:41.661486 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:39:41.662444 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:39:41.663010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3479392e-08f1-424d-bf45-fff4c452d3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE66911350>]}
[0m12:39:42.884989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3479392e-08f1-424d-bf45-fff4c452d3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE67ADEE40>]}
[0m12:39:42.888969 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m12:39:42.966614 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:39:42.968975 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:39:42.969858 [debug] [MainThread]: Command `-c parse` succeeded at 12:39:42.969737 after 2.02 seconds
[0m12:39:42.970228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE5FE302F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE67F24AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE67E13EE0>]}
[0m12:39:42.970590 [debug] [MainThread]: Flushing usage events
[0m12:39:43.784187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:00.128484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FB0D8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FB8E42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FBF27ED0>]}


============================== 12:40:00.132848 | 5e845d5e-fc7e-42ff-985c-0dcb8db987d7 ==============================
[0m12:40:00.132848 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:40:00.133538 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_rsi', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m12:40:00.370288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e845d5e-fc7e-42ff-985c-0dcb8db987d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FB290180>]}
[0m12:40:00.434405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e845d5e-fc7e-42ff-985c-0dcb8db987d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FBDCB9B0>]}
[0m12:40:00.436841 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:40:00.681818 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:40:00.807443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:00.807801 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:00.841419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e845d5e-fc7e-42ff-985c-0dcb8db987d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FD017350>]}
[0m12:40:00.913734 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:00.916261 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:00.953083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e845d5e-fc7e-42ff-985c-0dcb8db987d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FBD53E30>]}
[0m12:40:00.953574 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:40:00.954086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e845d5e-fc7e-42ff-985c-0dcb8db987d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FD0B3230>]}
[0m12:40:00.954996 [warn ] [MainThread]: The selection criterion 'fct_rsi' does not match any enabled nodes
[0m12:40:00.956340 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:40:00.958533 [debug] [MainThread]: Command end result
[0m12:40:00.979395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:00.982239 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:00.986575 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:40:00.987903 [debug] [MainThread]: Command `-c run` succeeded at 12:40:00.987728 after 0.99 seconds
[0m12:40:00.988541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FD5D7D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FBD1B1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FD59F7D0>]}
[0m12:40:00.989205 [debug] [MainThread]: Flushing usage events
[0m12:40:01.829410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:10.259052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266366C8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026636ED42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026637517ED0>]}


============================== 12:40:10.263478 | abaabc25-e582-4b7d-afb3-3971ac46d6e2 ==============================
[0m12:40:10.263478 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:40:10.264186 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select fct__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m12:40:10.506114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026636880180>]}
[0m12:40:10.570624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266373BB9B0>]}
[0m12:40:10.573177 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:40:10.823913 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:40:10.936860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:10.937209 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:10.970132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638617350>]}
[0m12:40:11.040547 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:11.042772 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:11.068722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026637343E30>]}
[0m12:40:11.069181 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:40:11.069812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266386AF230>]}
[0m12:40:11.071288 [info ] [MainThread]: 
[0m12:40:11.071879 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:11.072427 [info ] [MainThread]: 
[0m12:40:11.073229 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:40:11.074248 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:40:13.709721 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:40:13.710105 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m12:40:13.710414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:21.676716 [debug] [ThreadPool]: SQL status: OK in 7.966 seconds
[0m12:40:21.678466 [debug] [ThreadPool]: On list_finance: Close
[0m12:40:21.679299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:40:21.680001 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:40:21.686602 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:21.687023 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m12:40:21.687333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:21.689338 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:40:21.690894 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:21.691279 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:40:21.692441 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:40:21.692786 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:21.693122 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m12:40:21.753475 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m12:40:21.754503 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:40:21.754897 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:21.755241 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:40:21.803452 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m12:40:21.803907 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:40:21.810016 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:40:21.816153 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:40:21.816651 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:40:21.817011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:21.818950 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:40:21.819372 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:40:21.819720 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m12:40:21.854238 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m12:40:21.856773 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:40:21.872256 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:40:21.872929 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:40:21.874589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638D0BA00>]}
[0m12:40:21.875180 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:21.875496 [debug] [MainThread]: On master: BEGIN
[0m12:40:21.875786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:21.876881 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:40:21.877212 [debug] [MainThread]: On master: COMMIT
[0m12:40:21.877518 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:21.877809 [debug] [MainThread]: On master: COMMIT
[0m12:40:21.878388 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:40:21.878702 [debug] [MainThread]: On master: Close
[0m12:40:21.884162 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:40:21.884741 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:40:21.885472 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.fct__rsi'
[0m12:40:21.885865 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:40:21.893083 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:40:21.894872 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:40:21.928959 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:40:21.930978 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:40:21.931448 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:40:21.931820 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:21.933182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:40:21.933604 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:40:21.934042 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:40:22.079976 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:40:22.080595 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:40:22.081084 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: ROLLBACK
[0m12:40:22.208768 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.fct__rsi'
[0m12:40:22.209207 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:40:22.213613 [debug] [Thread-1 (]: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^
[0m12:40:22.215638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abaabc25-e582-4b7d-afb3-3971ac46d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638D950D0>]}
[0m12:40:22.216264 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.fct__rsi .................... [[31mERROR[0m in 0.33s]
[0m12:40:22.217070 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:40:22.217669 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^.
[0m12:40:22.219613 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:22.219945 [debug] [MainThread]: On master: BEGIN
[0m12:40:22.220244 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:22.221641 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:40:22.221969 [debug] [MainThread]: On master: COMMIT
[0m12:40:22.222262 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:22.222542 [debug] [MainThread]: On master: COMMIT
[0m12:40:22.223396 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:40:22.223770 [debug] [MainThread]: On master: Close
[0m12:40:22.224162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:22.224434 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:40:22.224691 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:40:22.224949 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:40:22.225243 [info ] [MainThread]: 
[0m12:40:22.225760 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 11.15 seconds (11.15s).
[0m12:40:22.226636 [debug] [MainThread]: Command end result
[0m12:40:22.251137 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:22.253738 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:22.260308 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:40:22.260907 [info ] [MainThread]: 
[0m12:40:22.261759 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:40:22.262676 [info ] [MainThread]: 
[0m12:40:22.263497 [error] [MainThread]: [31mFailure in model fct__rsi (models\gold\fct__rsi.sql)[0m
[0m12:40:22.264280 [error] [MainThread]:   Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^
[0m12:40:22.265090 [info ] [MainThread]: 
[0m12:40:22.265866 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\fct__rsi.sql
[0m12:40:22.266436 [info ] [MainThread]: 
[0m12:40:22.267105 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:40:22.268481 [debug] [MainThread]: Command `-c run` failed at 12:40:22.268313 after 12.13 seconds
[0m12:40:22.268994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638D6CF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638E6A2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638E69E50>]}
[0m12:40:22.269692 [debug] [MainThread]: Flushing usage events
[0m12:40:23.094324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:53.908356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F2128050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F29342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F2F77ED0>]}


============================== 12:40:53.912510 | ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb ==============================
[0m12:40:53.912510 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:40:53.913146 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select *fct__rsi', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m12:40:54.149646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F22E0180>]}
[0m12:40:54.213414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F2E1B9B0>]}
[0m12:40:54.215766 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:40:54.465868 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:40:54.581338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:54.581689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:54.614989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F4167350>]}
[0m12:40:54.686014 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:54.688215 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:54.715383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F2E0B2F0>]}
[0m12:40:54.715863 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:40:54.716362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F4203230>]}
[0m12:40:54.717895 [info ] [MainThread]: 
[0m12:40:54.718429 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:54.718886 [info ] [MainThread]: 
[0m12:40:54.719515 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:40:54.720436 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:40:54.802501 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:40:54.802896 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m12:40:54.803210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:56.512850 [debug] [ThreadPool]: SQL status: OK in 1.710 seconds
[0m12:40:56.514368 [debug] [ThreadPool]: On list_finance: Close
[0m12:40:56.515164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:40:56.515630 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:40:56.521483 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:56.521822 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m12:40:56.522132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:56.523709 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:40:56.525021 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:56.525349 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:40:56.526404 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:40:56.526726 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:56.527031 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m12:40:56.579257 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m12:40:56.580218 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:40:56.580553 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:40:56.580855 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:40:56.743806 [debug] [ThreadPool]: SQL status: OK in 0.163 seconds
[0m12:40:56.744217 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:40:56.749726 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:40:56.755112 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:40:56.755463 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:40:56.755747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:56.756926 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:40:56.757274 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:40:56.757576 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m12:40:56.780497 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:40:56.781835 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:40:56.782858 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:40:56.783165 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:40:56.784382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F485BA00>]}
[0m12:40:56.784935 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:56.785231 [debug] [MainThread]: On master: BEGIN
[0m12:40:56.785509 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:56.786743 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:40:56.787098 [debug] [MainThread]: On master: COMMIT
[0m12:40:56.787414 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:56.787716 [debug] [MainThread]: On master: COMMIT
[0m12:40:56.788398 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:40:56.788712 [debug] [MainThread]: On master: Close
[0m12:40:56.793315 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:40:56.793843 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:40:56.794671 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.fct__rsi'
[0m12:40:56.795068 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:40:56.801834 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:40:56.802783 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:40:56.833900 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:40:56.834876 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:40:56.835258 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:40:56.835604 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:56.836946 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:40:56.837325 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:40:56.837744 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:40:56.898187 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:40:56.898713 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:40:56.899190 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: ROLLBACK
[0m12:40:56.905891 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.fct__rsi'
[0m12:40:56.906301 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:40:56.910648 [debug] [Thread-1 (]: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^
[0m12:40:56.912685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce010f7e-2bc2-416e-9cdf-9f8611ec9cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F48E50D0>]}
[0m12:40:56.913315 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.fct__rsi .................... [[31mERROR[0m in 0.12s]
[0m12:40:56.914131 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:40:56.914741 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^.
[0m12:40:56.916574 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:56.916905 [debug] [MainThread]: On master: BEGIN
[0m12:40:56.917210 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:56.918468 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:40:56.918877 [debug] [MainThread]: On master: COMMIT
[0m12:40:56.919182 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:56.919469 [debug] [MainThread]: On master: COMMIT
[0m12:40:56.920038 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:40:56.920354 [debug] [MainThread]: On master: Close
[0m12:40:56.920741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:56.921019 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:40:56.921291 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:40:56.921554 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:40:56.921851 [info ] [MainThread]: 
[0m12:40:56.922335 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m12:40:56.923213 [debug] [MainThread]: Command end result
[0m12:40:56.944507 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:40:56.947271 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:40:56.953780 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:40:56.954144 [info ] [MainThread]: 
[0m12:40:56.954674 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:40:56.955201 [info ] [MainThread]: 
[0m12:40:56.955753 [error] [MainThread]: [31mFailure in model fct__rsi (models\gold\fct__rsi.sql)[0m
[0m12:40:56.956306 [error] [MainThread]:   Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Catalog Error: Table with name int__rsi_sma does not exist!
  Did you mean "src_stocks"?
  
  LINE 14: from "finance"."analytics_dev"."int__rsi_sma" 
                ^
[0m12:40:56.956796 [info ] [MainThread]: 
[0m12:40:56.957332 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\fct__rsi.sql
[0m12:40:56.957820 [info ] [MainThread]: 
[0m12:40:56.958366 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:40:56.959298 [debug] [MainThread]: Command `-c run` failed at 12:40:56.959180 after 3.17 seconds
[0m12:40:56.959737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F48BCF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F49E2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4F4A6D1D0>]}
[0m12:40:56.960127 [debug] [MainThread]: Flushing usage events
[0m12:40:57.864414 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:57.843528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A72F88050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A737942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73DD7ED0>]}


============================== 12:41:57.847975 | e7d7796d-4b55-4b47-a15a-f8a95b482e95 ==============================
[0m12:41:57.847975 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:41:57.848740 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --select +fct__rsi', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m12:41:58.112028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73140180>]}
[0m12:41:58.183530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73C7B9B0>]}
[0m12:41:58.186204 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:41:58.454718 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:41:58.587532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:41:58.587908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:41:58.625981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A74F17350>]}
[0m12:41:58.708661 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:41:58.711062 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:41:58.740641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73C03E30>]}
[0m12:41:58.741256 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:41:58.741893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A74FB3230>]}
[0m12:41:58.743768 [info ] [MainThread]: 
[0m12:41:58.744464 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:41:58.745130 [info ] [MainThread]: 
[0m12:41:58.745982 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:41:58.751156 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:41:58.839439 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:41:58.839860 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m12:41:58.840179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:00.469764 [debug] [ThreadPool]: SQL status: OK in 1.629 seconds
[0m12:42:00.471209 [debug] [ThreadPool]: On list_finance: Close
[0m12:42:00.472029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:42:00.472636 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:42:00.479805 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:00.480182 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m12:42:00.480480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:00.482145 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:42:00.483430 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:00.483738 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:42:00.484706 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:00.485004 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:00.485294 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m12:42:00.542873 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m12:42:00.544076 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:00.544460 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:00.544772 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:00.591328 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m12:42:00.591742 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:42:00.593552 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:42:00.598908 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:00.599264 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:42:00.599556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:00.600675 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:00.600989 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:00.601303 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m12:42:00.624553 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:42:00.626009 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:42:00.627082 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:42:00.627416 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:42:00.628667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7560FA00>]}
[0m12:42:00.629157 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:00.629487 [debug] [MainThread]: On master: BEGIN
[0m12:42:00.629795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:00.630976 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:00.631323 [debug] [MainThread]: On master: COMMIT
[0m12:42:00.631664 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:00.631957 [debug] [MainThread]: On master: COMMIT
[0m12:42:00.632550 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:00.632863 [debug] [MainThread]: On master: Close
[0m12:42:00.637368 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m12:42:00.637903 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m12:42:00.638595 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m12:42:00.638978 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m12:42:00.645920 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m12:42:00.648050 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m12:42:00.681649 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m12:42:00.683194 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.683653 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m12:42:00.684029 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:00.685431 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:00.685811 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.686180 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

<<<<<<< HEAD
[0m12:48:27.375254 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m12:48:27.382168 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:48:27.382745 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m12:48:27.439332 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m12:48:27.442008 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:48:27.442430 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m12:48:27.500010 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m12:48:27.512485 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:48:27.512919 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:48:27.513271 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:48:27.738122 [debug] [Thread-1 (]: SQL status: OK in 0.224 seconds
[0m12:48:27.743293 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:48:27.743698 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m12:48:27.854823 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m12:48:27.857311 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m12:48:27.859485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E43D2E0>]}
[0m12:48:27.860166 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.59s]
[0m12:48:27.861221 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m12:48:27.861990 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m12:48:27.862620 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_dev.int__price_changes ................... [RUN]
[0m12:48:27.863451 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m12:48:27.864011 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m12:48:27.866895 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m12:48:27.867931 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m12:48:27.873209 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m12:48:27.874194 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:48:27.874669 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m12:48:27.875039 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:48:27.876321 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:48:27.876703 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:48:27.877159 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
=======
[0m12:42:00.733917 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m12:42:00.739562 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.739989 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m12:42:00.803755 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m12:42:00.806384 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.806767 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m12:42:00.847442 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m12:42:00.859720 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:00.860172 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.860545 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:00.977443 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m12:42:00.982506 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:00.982885 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m12:42:01.088978 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m12:42:01.091296 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m12:42:01.093636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A75675CD0>]}
[0m12:42:01.094350 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.45s]
[0m12:42:01.095241 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m12:42:01.096005 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m12:42:01.096477 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_dev.int__price_changes ................... [RUN]
[0m12:42:01.097233 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m12:42:01.097592 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m12:42:01.099949 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m12:42:01.101498 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m12:42:01.104448 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m12:42:01.105845 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:01.106240 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m12:42:01.106611 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:42:01.107871 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:42:01.108359 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:01.108842 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

<<<<<<< HEAD
[0m12:48:27.974215 [debug] [Thread-2 (]: SQL status: OK in 0.096 seconds
[0m12:48:27.977001 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:48:27.977426 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m12:48:28.026207 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m12:48:28.029266 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:48:28.030231 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m12:48:28.085174 [debug] [Thread-2 (]: SQL status: OK in 0.054 seconds
[0m12:48:28.086634 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:48:28.087068 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:48:28.087426 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:48:28.266132 [debug] [Thread-2 (]: SQL status: OK in 0.178 seconds
[0m12:48:28.268598 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:48:28.268994 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m12:48:28.375900 [debug] [Thread-2 (]: SQL status: OK in 0.106 seconds
[0m12:48:28.377392 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m12:48:28.377926 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E6039D0>]}
[0m12:48:28.378499 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_dev.int__price_changes .............. [[32mOK[0m in 0.51s]
[0m12:48:28.379439 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m12:48:28.380109 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m12:48:28.380778 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_dev.int__rsi_sma ......................... [RUN]
[0m12:48:28.381532 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_sma'
[0m12:48:28.381884 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m12:48:28.384234 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.385121 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m12:48:28.388056 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.388911 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.389324 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m12:48:28.389662 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:48:28.390974 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:48:28.391333 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.391715 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
=======
[0m12:42:01.179316 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m12:42:01.181928 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:01.182323 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m12:42:01.232917 [debug] [Thread-2 (]: SQL status: OK in 0.050 seconds
[0m12:42:01.234264 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:42:01.234661 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:01.235015 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:42:01.327903 [debug] [Thread-2 (]: SQL status: OK in 0.092 seconds
[0m12:42:01.330425 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:01.330843 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m12:42:01.447875 [debug] [Thread-2 (]: SQL status: OK in 0.117 seconds
[0m12:42:01.449315 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m12:42:01.449833 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7566DB20>]}
[0m12:42:01.450401 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_dev.int__price_changes .............. [[32mOK[0m in 0.35s]
[0m12:42:01.451331 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m12:42:01.452140 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m12:42:01.452909 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_dev.int__rsi_sma ......................... [RUN]
[0m12:42:01.453708 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_sma'
[0m12:42:01.454197 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m12:42:01.457334 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.458893 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m12:42:01.462404 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.463534 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.464002 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m12:42:01.464392 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:42:01.466094 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:42:01.466673 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.467261 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    sma_gain::decimal as sma_gain,
    sma_loss::decimal as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

<<<<<<< HEAD
[0m12:48:28.479535 [debug] [Thread-3 (]: SQL status: OK in 0.087 seconds
[0m12:48:28.482192 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.482586 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m12:48:28.529160 [debug] [Thread-3 (]: SQL status: OK in 0.046 seconds
[0m12:48:28.531875 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.532289 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m12:48:28.578797 [debug] [Thread-3 (]: SQL status: OK in 0.046 seconds
[0m12:48:28.580592 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:48:28.580990 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.581344 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:48:28.683354 [debug] [Thread-3 (]: SQL status: OK in 0.102 seconds
[0m12:48:28.685606 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:48:28.685980 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m12:48:28.775440 [debug] [Thread-3 (]: SQL status: OK in 0.089 seconds
[0m12:48:28.777379 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m12:48:28.777918 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E505F50>]}
[0m12:48:28.778530 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_dev.int__rsi_sma .................... [[32mOK[0m in 0.40s]
[0m12:48:28.779488 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m12:48:28.780212 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m12:48:28.780700 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_dev.int__rsi_wilder ...................... [RUN]
[0m12:48:28.781517 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_wilder'
[0m12:48:28.781888 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m12:48:28.784841 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:28.785748 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m12:48:28.788832 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:28.789709 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:28.790130 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m12:48:28.790468 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:48:28.791673 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:48:28.792033 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:28.792412 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
=======
[0m12:42:01.540453 [debug] [Thread-3 (]: SQL status: OK in 0.073 seconds
[0m12:42:01.543214 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.543616 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m12:42:01.587528 [debug] [Thread-3 (]: SQL status: OK in 0.043 seconds
[0m12:42:01.588812 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:42:01.589195 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.589536 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:42:01.676809 [debug] [Thread-3 (]: SQL status: OK in 0.087 seconds
[0m12:42:01.678860 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:01.679233 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m12:42:01.721423 [debug] [Thread-3 (]: SQL status: OK in 0.042 seconds
[0m12:42:01.722860 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m12:42:01.723369 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A75822AD0>]}
[0m12:42:01.723937 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_dev.int__rsi_sma .................... [[32mOK[0m in 0.27s]
[0m12:42:01.724706 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m12:42:01.725354 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m12:42:01.725842 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_dev.int__rsi_wilder ...................... [RUN]
[0m12:42:01.726515 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_wilder'
[0m12:42:01.726904 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m12:42:01.732947 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:01.742758 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m12:42:01.745519 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:01.746577 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:01.746992 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m12:42:01.747362 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:42:01.748601 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:42:01.749099 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:01.749506 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal as gain,
    loss::decimal as loss,
    wilder_gain::decimal as wilder_gain,
    wilder_loss::decimal as wilder_loss
from wilder
  );

<<<<<<< HEAD
[0m12:48:28.891238 [debug] [Thread-4 (]: SQL status: OK in 0.098 seconds
[0m12:48:28.893931 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:28.894317 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m12:48:28.944513 [debug] [Thread-4 (]: SQL status: OK in 0.050 seconds
[0m12:48:28.947115 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:28.947495 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m12:48:28.986895 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m12:48:28.988243 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:48:28.988623 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:28.988969 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:48:29.069070 [debug] [Thread-4 (]: SQL status: OK in 0.080 seconds
[0m12:48:29.071531 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:48:29.071899 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m12:48:29.166151 [debug] [Thread-4 (]: SQL status: OK in 0.094 seconds
[0m12:48:29.167505 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m12:48:29.168011 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E5F5010>]}
[0m12:48:29.168581 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_dev.int__rsi_wilder ................. [[32mOK[0m in 0.39s]
[0m12:48:29.169413 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m12:48:29.170182 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:48:29.170846 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:48:29.171597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.fct__rsi)
[0m12:48:29.171952 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:48:29.174836 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:48:29.175780 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:48:29.178741 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:48:29.179596 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:48:29.179975 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:48:29.180307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:29.181587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:48:29.181942 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:48:29.182340 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
=======
[0m12:42:01.859403 [debug] [Thread-4 (]: SQL status: OK in 0.109 seconds
[0m12:42:01.909770 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:01.910224 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m12:42:02.077586 [debug] [Thread-4 (]: SQL status: OK in 0.167 seconds
[0m12:42:02.078859 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:42:02.079239 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:02.079580 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:42:02.184437 [debug] [Thread-4 (]: SQL status: OK in 0.104 seconds
[0m12:42:02.187576 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:02.188140 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m12:42:02.236874 [debug] [Thread-4 (]: SQL status: OK in 0.048 seconds
[0m12:42:02.238261 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m12:42:02.238772 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7570A0D0>]}
[0m12:42:02.239347 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_dev.int__rsi_wilder ................. [[32mOK[0m in 0.51s]
[0m12:42:02.240116 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m12:42:02.240973 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:42:02.241473 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:42:02.242075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.fct__rsi)
[0m12:42:02.242463 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:42:02.245192 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:42:02.246132 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:42:02.249263 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:42:02.250484 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:42:02.251118 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:42:02.251475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:02.252774 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:02.253223 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:42:02.253682 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:42:02.319773 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:42:02.320347 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:42:02.320810 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: ROLLBACK
[0m12:42:02.327483 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.fct__rsi'
[0m12:42:02.327870 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:42:02.332219 [debug] [Thread-1 (]: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47:     left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
                                                         ^
[0m12:42:02.332689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d7796d-4b55-4b47-a15a-f8a95b482e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A758A1470>]}
[0m12:42:02.333280 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model analytics_dev.fct__rsi .................... [[31mERROR[0m in 0.09s]
[0m12:42:02.334083 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:42:02.334693 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47:     left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
                                                         ^.
[0m12:42:02.336525 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:02.336881 [debug] [MainThread]: On master: BEGIN
[0m12:42:02.337188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:42:02.338337 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:02.338653 [debug] [MainThread]: On master: COMMIT
[0m12:42:02.338956 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:02.339246 [debug] [MainThread]: On master: COMMIT
[0m12:42:02.339811 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:02.340163 [debug] [MainThread]: On master: Close
[0m12:42:02.340600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:02.340894 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:42:02.341164 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:42:02.341432 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:42:02.341697 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__price_changes' was properly closed.
[0m12:42:02.341967 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m12:42:02.342230 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m12:42:02.342585 [info ] [MainThread]: 
[0m12:42:02.343084 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m12:42:02.344630 [debug] [MainThread]: Command end result
[0m12:42:02.365769 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:42:02.368019 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:42:02.374376 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:42:02.374776 [info ] [MainThread]: 
[0m12:42:02.375497 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:42:02.375995 [info ] [MainThread]: 
[0m12:42:02.376584 [error] [MainThread]: [31mFailure in model fct__rsi (models\gold\fct__rsi.sql)[0m
[0m12:42:02.377173 [error] [MainThread]:   Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47:     left join wilder_sma ws on s.trade_date = sma.trade_date and s.ticker = sma.ticker
                                                         ^
[0m12:42:02.377670 [info ] [MainThread]: 
[0m12:42:02.378333 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\fct__rsi.sql
[0m12:42:02.378877 [info ] [MainThread]: 
[0m12:42:02.379400 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m12:42:02.380336 [debug] [MainThread]: Command `-c run` failed at 12:42:02.380204 after 4.68 seconds
[0m12:42:02.380729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73BD6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7504AB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A73E4BEF0>]}
[0m12:42:02.381091 [debug] [MainThread]: Flushing usage events
[0m12:42:03.065416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:20.514332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6F4D8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6FCE42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E70323ED0>]}


============================== 12:42:20.519347 | a6371ac5-9517-4897-aeb3-60b2b2b2945c ==============================
[0m12:42:20.519347 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:42:20.520039 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select +fct__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m12:42:20.772928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6F690180>]}
[0m12:42:20.839067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E701CB9B0>]}
[0m12:42:20.841691 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:42:21.084774 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:42:21.162305 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:42:21.162950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71419B50>]}
[0m12:42:22.403543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E7159EE40>]}
[0m12:42:22.474984 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:42:22.478618 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:42:22.506776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71BF5C50>]}
[0m12:42:22.507479 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:42:22.508167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E718CC870>]}
[0m12:42:22.510037 [info ] [MainThread]: 
[0m12:42:22.510730 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:42:22.511328 [info ] [MainThread]: 
[0m12:42:22.512292 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:42:22.519022 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:42:22.603915 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:42:22.604320 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m12:42:22.604636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:23.914116 [debug] [ThreadPool]: SQL status: OK in 1.309 seconds
[0m12:42:23.915504 [debug] [ThreadPool]: On list_finance: Close
[0m12:42:23.916184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:42:23.916660 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:42:23.922287 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:23.922609 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m12:42:23.922960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:23.924746 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:42:23.926091 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:23.926404 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:42:23.927409 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:23.927714 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:23.928005 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m12:42:23.977790 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m12:42:23.978743 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:23.979062 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:23.979359 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:24.026267 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m12:42:24.026664 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:42:24.028428 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:42:24.033798 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:24.034153 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:42:24.034432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:24.035606 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:24.035906 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:24.036209 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m12:42:24.059989 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:42:24.061365 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:42:24.062467 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:42:24.062776 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:42:24.064570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71A1D250>]}
[0m12:42:24.065004 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:24.065296 [debug] [MainThread]: On master: BEGIN
[0m12:42:24.065616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:24.066761 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:24.067074 [debug] [MainThread]: On master: COMMIT
[0m12:42:24.067367 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:24.067649 [debug] [MainThread]: On master: COMMIT
[0m12:42:24.068235 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:24.068722 [debug] [MainThread]: On master: Close
[0m12:42:24.073449 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m12:42:24.073997 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m12:42:24.074896 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m12:42:24.075248 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m12:42:24.081619 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m12:42:24.082495 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m12:42:24.112769 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m12:42:24.113711 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.114100 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m12:42:24.114446 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:24.115949 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:24.116317 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.116683 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m12:42:24.176644 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m12:42:24.182329 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.182722 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m12:42:24.225090 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m12:42:24.227833 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.228208 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m12:42:24.275421 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m12:42:24.288304 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:24.288723 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.289063 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:24.383375 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m12:42:24.388764 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:24.389143 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m12:42:24.500531 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m12:42:24.502838 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m12:42:24.504817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71DE9390>]}
[0m12:42:24.505527 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.43s]
[0m12:42:24.514460 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m12:42:24.515466 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m12:42:24.515956 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_dev.int__price_changes ................... [RUN]
[0m12:42:24.516733 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m12:42:24.517191 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m12:42:24.519759 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m12:42:24.520698 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m12:42:24.526629 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m12:42:24.527580 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.527958 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m12:42:24.528307 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:42:24.529477 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:42:24.529840 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.530244 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m12:42:24.610711 [debug] [Thread-2 (]: SQL status: OK in 0.080 seconds
[0m12:42:24.613360 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.613752 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m12:42:24.670830 [debug] [Thread-2 (]: SQL status: OK in 0.057 seconds
[0m12:42:24.673429 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.674197 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m12:42:24.723708 [debug] [Thread-2 (]: SQL status: OK in 0.049 seconds
[0m12:42:24.725075 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:42:24.725478 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.725816 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:42:24.812875 [debug] [Thread-2 (]: SQL status: OK in 0.087 seconds
[0m12:42:24.814997 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:24.815373 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m12:42:25.008765 [debug] [Thread-2 (]: SQL status: OK in 0.193 seconds
[0m12:42:25.010117 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m12:42:25.010630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71FB3A70>]}
[0m12:42:25.011197 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_dev.int__price_changes .............. [[32mOK[0m in 0.49s]
[0m12:42:25.012093 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m12:42:25.012821 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m12:42:25.013336 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_dev.int__rsi_sma ......................... [RUN]
[0m12:42:25.014383 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_sma'
[0m12:42:25.014754 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m12:42:25.017058 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.017916 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m12:42:25.021095 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.022707 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.023424 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m12:42:25.023799 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:42:25.025434 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:42:25.025908 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.026381 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    sma_gain::decimal as sma_gain,
    sma_loss::decimal as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m12:42:25.101462 [debug] [Thread-3 (]: SQL status: OK in 0.074 seconds
[0m12:42:25.104049 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.104419 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m12:42:25.152999 [debug] [Thread-3 (]: SQL status: OK in 0.048 seconds
[0m12:42:25.155681 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.156057 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m12:42:25.208546 [debug] [Thread-3 (]: SQL status: OK in 0.052 seconds
[0m12:42:25.210405 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:42:25.210814 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.211167 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:42:25.313262 [debug] [Thread-3 (]: SQL status: OK in 0.102 seconds
[0m12:42:25.315386 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:42:25.315761 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m12:42:25.421739 [debug] [Thread-3 (]: SQL status: OK in 0.106 seconds
[0m12:42:25.423071 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m12:42:25.423568 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71EB22D0>]}
[0m12:42:25.424125 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_dev.int__rsi_sma .................... [[32mOK[0m in 0.41s]
[0m12:42:25.424976 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m12:42:25.425652 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m12:42:25.426161 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_dev.int__rsi_wilder ...................... [RUN]
[0m12:42:25.426947 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_wilder'
[0m12:42:25.427410 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m12:42:25.430116 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.431078 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m12:42:25.434073 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.437766 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.438640 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m12:42:25.439069 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:42:25.440809 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:42:25.441384 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.441853 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal as gain,
    loss::decimal as loss,
    wilder_gain::decimal as wilder_gain,
    wilder_loss::decimal as wilder_loss
from wilder
  );

[0m12:42:25.532033 [debug] [Thread-4 (]: SQL status: OK in 0.090 seconds
[0m12:42:25.534830 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.535254 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m12:42:25.585938 [debug] [Thread-4 (]: SQL status: OK in 0.050 seconds
[0m12:42:25.588718 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.589106 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m12:42:25.635717 [debug] [Thread-4 (]: SQL status: OK in 0.046 seconds
[0m12:42:25.637065 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:42:25.637454 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.637804 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:42:25.740558 [debug] [Thread-4 (]: SQL status: OK in 0.102 seconds
[0m12:42:25.742991 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:42:25.743405 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m12:42:25.846718 [debug] [Thread-4 (]: SQL status: OK in 0.103 seconds
[0m12:42:25.848117 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m12:42:25.848612 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71FA6890>]}
[0m12:42:25.849180 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_dev.int__rsi_wilder ................. [[32mOK[0m in 0.42s]
[0m12:42:25.850083 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m12:42:25.850839 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:42:25.851331 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:42:25.852049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.fct__rsi)
[0m12:42:25.852406 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:42:25.855008 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:42:25.855843 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:42:25.858713 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:42:25.859634 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:42:25.860042 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:42:25.860369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:25.861774 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:25.871120 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:42:25.871615 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = s.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:42:25.936927 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = s.trade_date and s.ticker = sma.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m12:42:25.937451 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:42:25.937908 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: ROLLBACK
[0m12:42:25.944739 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.fct__rsi'
[0m12:42:25.945152 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:42:25.949427 [debug] [Thread-1 (]: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47: ... wilder_sma ws on s.trade_date = s.trade_date and s.ticker = sma.ticker
                                                                           ^
[0m12:42:25.949868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6371ac5-9517-4897-aeb3-60b2b2b2945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E734B2C90>]}
[0m12:42:25.950443 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model analytics_dev.fct__rsi .................... [[31mERROR[0m in 0.10s]
[0m12:42:25.951252 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:42:25.951837 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'error'.  Reason: Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47: ... wilder_sma ws on s.trade_date = s.trade_date and s.ticker = sma.ticker
                                                                           ^.
[0m12:42:25.953665 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:25.953998 [debug] [MainThread]: On master: BEGIN
[0m12:42:25.954302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:42:25.955460 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:25.955805 [debug] [MainThread]: On master: COMMIT
[0m12:42:25.956126 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:25.956484 [debug] [MainThread]: On master: COMMIT
[0m12:42:25.957151 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:25.957485 [debug] [MainThread]: On master: Close
[0m12:42:25.957901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:25.958189 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:42:25.958458 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:42:25.958724 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:42:25.958989 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__price_changes' was properly closed.
[0m12:42:25.959256 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m12:42:25.959519 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m12:42:25.959867 [info ] [MainThread]: 
[0m12:42:25.960318 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m12:42:25.961788 [debug] [MainThread]: Command end result
[0m12:42:25.982533 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:42:25.984720 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:42:25.991710 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:42:25.992084 [info ] [MainThread]: 
[0m12:42:25.992594 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:42:25.993154 [info ] [MainThread]: 
[0m12:42:25.993799 [error] [MainThread]: [31mFailure in model fct__rsi (models\gold\fct__rsi.sql)[0m
[0m12:42:25.994426 [error] [MainThread]:   Runtime Error in model fct__rsi (models\gold\fct__rsi.sql)
  Binder Error: Referenced table "sma" not found!
  Candidate tables: "s"
  
  LINE 47: ... wilder_sma ws on s.trade_date = s.trade_date and s.ticker = sma.ticker
                                                                           ^
[0m12:42:25.995175 [info ] [MainThread]: 
[0m12:42:25.995784 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\fct__rsi.sql
[0m12:42:25.996257 [info ] [MainThread]: 
[0m12:42:25.996781 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m12:42:25.997704 [debug] [MainThread]: Command `-c run` failed at 12:42:25.997589 after 5.62 seconds
[0m12:42:25.998078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71FFC2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E71995F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6F5250D0>]}
[0m12:42:25.998440 [debug] [MainThread]: Flushing usage events
[0m12:42:26.762957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:55.045874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014020058050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140208642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014020EA7ED0>]}


============================== 12:42:55.050081 | 0b91ea45-4f77-4488-bb01-30428f9e0a1a ==============================
[0m12:42:55.050081 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:42:55.050769 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +fct__rsi', 'printer_width': '80', 'write_json': 'True'}
[0m12:42:55.291467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014020210180>]}
[0m12:42:55.356383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014020D4B9B0>]}
[0m12:42:55.358858 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:42:55.600901 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:42:55.680837 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:42:55.681437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014021F91B50>]}
[0m12:42:56.914940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001402217AE40>]}
[0m12:42:56.978162 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:42:56.980364 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:42:57.004376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140227D5C50>]}
[0m12:42:57.004843 [info ] [MainThread]: Found 6 models, 2 sources, 461 macros
[0m12:42:57.005340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022410870>]}
[0m12:42:57.006979 [info ] [MainThread]: 
[0m12:42:57.007471 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:42:57.007945 [info ] [MainThread]: 
[0m12:42:57.008579 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:42:57.013754 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m12:42:57.090591 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m12:42:57.090981 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m12:42:57.091295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:58.938618 [debug] [ThreadPool]: SQL status: OK in 1.847 seconds
[0m12:42:58.940062 [debug] [ThreadPool]: On list_finance: Close
[0m12:42:58.940788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m12:42:58.941367 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m12:42:58.947112 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:58.947448 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m12:42:58.947744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:58.949349 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:42:58.950603 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:58.950907 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m12:42:58.951872 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:58.952169 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:58.952465 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m12:42:58.996973 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m12:42:58.997898 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:58.998219 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m12:42:58.998511 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m12:42:59.046750 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m12:42:59.047163 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m12:42:59.049023 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m12:42:59.054511 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:59.054842 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m12:42:59.055116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:59.056302 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:42:59.056604 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m12:42:59.056902 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m12:42:59.080426 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:42:59.081800 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m12:42:59.082989 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m12:42:59.083307 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m12:42:59.085164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022605250>]}
[0m12:42:59.085671 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:59.085965 [debug] [MainThread]: On master: BEGIN
[0m12:42:59.086240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:59.087431 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:59.087773 [debug] [MainThread]: On master: COMMIT
[0m12:42:59.088074 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:59.088359 [debug] [MainThread]: On master: COMMIT
[0m12:42:59.088969 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:59.089280 [debug] [MainThread]: On master: Close
[0m12:42:59.094035 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m12:42:59.094550 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m12:42:59.095470 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m12:42:59.095831 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m12:42:59.102407 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m12:42:59.103271 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m12:42:59.133432 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m12:42:59.134446 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.134864 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m12:42:59.135243 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:59.136940 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:42:59.137512 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.137926 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m12:42:59.194070 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m12:42:59.199678 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.200066 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m12:42:59.260544 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m12:42:59.263256 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.263652 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m12:42:59.310688 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m12:42:59.322600 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:59.323024 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.323360 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m12:42:59.435638 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m12:42:59.440759 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m12:42:59.441175 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m12:42:59.550645 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m12:42:59.552970 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m12:42:59.554944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140229CD4F0>]}
[0m12:42:59.555577 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.46s]
[0m12:42:59.556455 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m12:42:59.557179 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m12:42:59.557701 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_dev.int__price_changes ................... [RUN]
[0m12:42:59.558412 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m12:42:59.558798 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m12:42:59.561171 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m12:42:59.562009 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m12:42:59.567694 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m12:42:59.568748 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:59.569134 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m12:42:59.569467 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:42:59.570820 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:42:59.571299 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:59.571705 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m12:42:59.755998 [debug] [Thread-2 (]: SQL status: OK in 0.184 seconds
[0m12:42:59.758798 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:59.759202 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m12:42:59.819412 [debug] [Thread-2 (]: SQL status: OK in 0.060 seconds
[0m12:42:59.821969 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:59.822728 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m12:42:59.959855 [debug] [Thread-2 (]: SQL status: OK in 0.137 seconds
[0m12:42:59.961179 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:42:59.961554 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:42:59.961892 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m12:43:00.065736 [debug] [Thread-2 (]: SQL status: OK in 0.103 seconds
[0m12:43:00.067870 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m12:43:00.068247 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m12:43:00.165738 [debug] [Thread-2 (]: SQL status: OK in 0.097 seconds
[0m12:43:00.167206 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m12:43:00.167765 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022B939D0>]}
[0m12:43:00.168383 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_dev.int__price_changes .............. [[32mOK[0m in 0.61s]
[0m12:43:00.169157 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m12:43:00.169843 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m12:43:00.170342 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_dev.int__rsi_sma ......................... [RUN]
[0m12:43:00.171022 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_sma'
[0m12:43:00.171408 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m12:43:00.173846 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.174681 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m12:43:00.177638 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.178446 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.178815 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m12:43:00.179155 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:43:00.180295 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:43:00.180660 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.181047 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    sma_gain::decimal as sma_gain,
    sma_loss::decimal as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m12:43:00.366410 [debug] [Thread-3 (]: SQL status: OK in 0.185 seconds
[0m12:43:00.369339 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.369740 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m12:43:00.424108 [debug] [Thread-3 (]: SQL status: OK in 0.054 seconds
[0m12:43:00.427181 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.427637 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m12:43:00.474797 [debug] [Thread-3 (]: SQL status: OK in 0.047 seconds
[0m12:43:00.476586 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:43:00.476972 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.477322 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m12:43:00.574223 [debug] [Thread-3 (]: SQL status: OK in 0.096 seconds
[0m12:43:00.576482 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m12:43:00.576857 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m12:43:00.686282 [debug] [Thread-3 (]: SQL status: OK in 0.109 seconds
[0m12:43:00.687627 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m12:43:00.688127 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022A962D0>]}
[0m12:43:00.688679 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_dev.int__rsi_sma .................... [[32mOK[0m in 0.52s]
[0m12:43:00.689503 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m12:43:00.690213 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m12:43:00.690679 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_dev.int__rsi_wilder ...................... [RUN]
[0m12:43:00.691721 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__rsi_wilder'
[0m12:43:00.692327 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m12:43:00.695215 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.696175 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m12:43:00.699231 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.700111 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.700497 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m12:43:00.700833 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:43:00.702106 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:43:00.702468 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.702853 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal as gain,
    loss::decimal as loss,
    wilder_gain::decimal as wilder_gain,
    wilder_loss::decimal as wilder_loss
from wilder
  );

[0m12:43:00.790525 [debug] [Thread-4 (]: SQL status: OK in 0.087 seconds
[0m12:43:00.793152 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.793533 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m12:43:00.850822 [debug] [Thread-4 (]: SQL status: OK in 0.057 seconds
[0m12:43:00.853499 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.853879 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m12:43:00.916534 [debug] [Thread-4 (]: SQL status: OK in 0.062 seconds
[0m12:43:00.917865 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:43:00.918236 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:00.918578 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m12:43:01.040219 [debug] [Thread-4 (]: SQL status: OK in 0.121 seconds
[0m12:43:01.042703 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m12:43:01.043072 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m12:43:01.161150 [debug] [Thread-4 (]: SQL status: OK in 0.118 seconds
[0m12:43:01.162768 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m12:43:01.163449 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022B89FD0>]}
[0m12:43:01.164082 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_dev.int__rsi_wilder ................. [[32mOK[0m in 0.47s]
[0m12:43:01.164952 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m12:43:01.165654 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m12:43:01.166167 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics_dev.fct__rsi ............................. [RUN]
[0m12:43:01.167115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.fct__rsi)
[0m12:43:01.167482 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m12:43:01.170117 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m12:43:01.171024 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m12:43:01.174179 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m12:43:01.175286 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:43:01.175714 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m12:43:01.176061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:01.177487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:01.177921 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:43:01.178343 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb

  
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = s.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

<<<<<<< HEAD
[0m12:48:29.286313 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m12:48:29.288946 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:48:29.289322 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
alter view "finance"."analytics_dev"."fct__rsi" rename to "fct__rsi__dbt_backup"
[0m12:48:29.373810 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m12:48:29.376469 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:48:29.376866 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
alter view "finance"."analytics_dev"."fct__rsi__dbt_tmp" rename to "fct__rsi"
[0m12:48:29.418665 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m12:48:29.420000 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m12:48:29.420371 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:48:29.420744 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m12:48:29.518868 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m12:48:29.521327 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:48:29.521698 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop view if exists "finance"."analytics_dev"."fct__rsi__dbt_backup" cascade
    
[0m12:48:29.624526 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m12:48:29.631111 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:48:29.631836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29d5d14d-0b1e-4c42-960f-43b7dd783c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E4D2330>]}
[0m12:48:29.632464 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics_dev.fct__rsi ........................ [[32mOK[0m in 0.46s]
[0m12:48:29.633389 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:48:29.635065 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:29.635388 [debug] [MainThread]: On master: BEGIN
[0m12:48:29.635718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:48:29.637062 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:48:29.637408 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.637711 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:29.638004 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.638679 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:48:29.638990 [debug] [MainThread]: On master: Close
[0m12:48:29.639383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:29.639659 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:48:29.639921 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:48:29.640179 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:48:29.640438 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__price_changes' was properly closed.
[0m12:48:29.640701 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m12:48:29.640957 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m12:48:29.641302 [info ] [MainThread]: 
[0m12:48:29.641739 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.37 seconds (4.37s).
[0m12:48:29.643581 [debug] [MainThread]: Command end result
[0m12:48:29.667851 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:48:29.671082 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:48:29.677536 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:48:29.677920 [info ] [MainThread]: 
[0m12:48:29.678459 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:48:29.678989 [info ] [MainThread]: 
[0m12:48:29.679614 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m12:48:29.680813 [debug] [MainThread]: Command `-c run` succeeded at 12:48:29.680678 after 6.59 seconds
[0m12:48:29.681216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39A0F75F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39DAF0E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E64F830>]}
[0m12:48:29.681728 [debug] [MainThread]: Flushing usage events
[0m12:48:30.372312 [debug] [MainThread]: An error was encountered while trying to flush usage events
=======
[0m12:43:01.287136 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m12:43:01.289761 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:43:01.290139 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
alter view "finance"."analytics_dev"."fct__rsi__dbt_tmp" rename to "fct__rsi"
[0m12:43:01.390494 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m12:43:01.391778 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m12:43:01.392152 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:43:01.392494 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m12:43:01.490811 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m12:43:01.492912 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m12:43:01.493271 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop view if exists "finance"."analytics_dev"."fct__rsi__dbt_backup" cascade
    
[0m12:43:01.538978 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m12:43:01.540307 [debug] [Thread-1 (]: On model.portfolio_project_2.fct__rsi: Close
[0m12:43:01.540811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91ea45-4f77-4488-bb01-30428f9e0a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022A63410>]}
[0m12:43:01.541415 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics_dev.fct__rsi ........................ [[32mOK[0m in 0.37s]
[0m12:43:01.542436 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m12:43:01.543829 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:01.544201 [debug] [MainThread]: On master: BEGIN
[0m12:43:01.544484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:01.545771 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:43:01.546127 [debug] [MainThread]: On master: COMMIT
[0m12:43:01.546429 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:01.546715 [debug] [MainThread]: On master: COMMIT
[0m12:43:01.547323 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:43:01.547631 [debug] [MainThread]: On master: Close
[0m12:43:01.548014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:01.548297 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m12:43:01.548563 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m12:43:01.548823 [debug] [MainThread]: Connection 'model.portfolio_project_2.fct__rsi' was properly closed.
[0m12:43:01.549082 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__price_changes' was properly closed.
[0m12:43:01.549339 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_sma' was properly closed.
[0m12:43:01.549600 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__rsi_wilder' was properly closed.
[0m12:43:01.549943 [info ] [MainThread]: 
[0m12:43:01.550512 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m12:43:01.552158 [debug] [MainThread]: Command end result
[0m12:43:01.573839 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m12:43:01.576204 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m12:43:01.582391 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m12:43:01.582761 [info ] [MainThread]: 
[0m12:43:01.583412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:01.584084 [info ] [MainThread]: 
[0m12:43:01.584743 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m12:43:01.585717 [debug] [MainThread]: Command `-c run` succeeded at 12:43:01.585607 after 6.66 seconds
[0m12:43:01.586068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014020148DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022BDFD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014022BDF7D0>]}
[0m12:43:01.586422 [debug] [MainThread]: Flushing usage events
[0m12:43:02.292486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:21.957046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8DF6B8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8DFEC42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E0503ED0>]}


============================== 13:38:21.961552 | 942553ef-0a93-41b1-9e6f-88e5ed65ca6e ==============================
[0m13:38:21.961552 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:38:21.962517 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt deps', 'printer_width': '80', 'target_path': 'None'}
[0m13:38:22.107680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '942553ef-0a93-41b1-9e6f-88e5ed65ca6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8DF870180>]}
[0m13:38:22.136436 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-szcmxnzx'
[0m13:38:22.136994 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:38:22.715103 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:38:22.716563 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:38:23.221100 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:38:23.233528 [info ] [MainThread]: Updating lock file in file path: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2/package-lock.yml
[0m13:38:23.244030 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-z8qfqz3l'
[0m13:38:23.247276 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:38:24.079550 [info ] [MainThread]: Installed from version 1.3.1
[0m13:38:24.080079 [info ] [MainThread]: Updated version available: 1.3.2
[0m13:38:24.080553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '942553ef-0a93-41b1-9e6f-88e5ed65ca6e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E03AA580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E03AAF10>]}
[0m13:38:24.080947 [info ] [MainThread]: 
[0m13:38:24.081369 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m13:38:24.083015 [debug] [MainThread]: Command `-c deps` succeeded at 13:38:24.082873 after 2.30 seconds
[0m13:38:24.083417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E178CD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8DFDF4C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E0395040>]}
[0m13:38:24.083777 [debug] [MainThread]: Flushing usage events
[0m13:38:24.746088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:55.941021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD6703C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD678442D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD67E87ED0>]}


============================== 13:38:55.945622 | e0705e42-2d08-41fd-b776-837ff0743a81 ==============================
[0m13:38:55.945622 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:38:55.946343 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m13:38:56.088908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0705e42-2d08-41fd-b776-837ff0743a81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD671F0180>]}
[0m13:38:56.121229 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-gjl388uo'
[0m13:38:56.121764 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:38:56.840248 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:38:56.841654 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:38:57.451490 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:38:57.462286 [info ] [MainThread]: Updating lock file in file path: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2/package-lock.yml
[0m13:38:57.527712 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-1r869tt3'
[0m13:38:57.531087 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:38:58.544608 [info ] [MainThread]: Installed from version 1.3.2
[0m13:38:58.545139 [info ] [MainThread]: Up to date!
[0m13:38:58.545642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e0705e42-2d08-41fd-b776-837ff0743a81', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD67D2A580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD67D2AF10>]}
[0m13:38:58.547199 [debug] [MainThread]: Command `-c deps` succeeded at 13:38:58.547064 after 2.75 seconds
[0m13:38:58.547569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD690D8D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD67D19040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD67D1B6B0>]}
[0m13:38:58.547971 [debug] [MainThread]: Flushing usage events
[0m13:38:59.174887 [debug] [MainThread]: An error was encountered while trying to flush usage events
>>>>>>> 2a42cdf4a770c3dab83c0b3f3e65d8a118a13edb
[0m13:48:49.178635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0FB5472F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0FA573290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0FD9CFAA0>]}


============================== 13:48:49.183079 | d31bdab1-f542-4f06-a624-802c5d473a45 ==============================
[0m13:48:49.183079 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:48:49.184076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m13:48:49.441622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd31bdab1-f542-4f06-a624-802c5d473a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0FDDA9F40>]}
[0m13:48:49.530707 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.2', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.2'}} is not valid under any of the given schemas
  
[0m13:48:49.531707 [debug] [MainThread]: Command `cli deps` failed at 13:48:49.531707 after 0.47 seconds
[0m13:48:49.531707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0FDB77680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0FDFEB6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0FF0D4AA0>]}
[0m13:48:49.533205 [debug] [MainThread]: Flushing usage events
[0m14:12:51.127093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E2E58050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E36642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E3CA3ED0>]}


============================== 14:12:51.131558 | 96545b6f-a8a2-49c9-abd4-c348371625ab ==============================
[0m14:12:51.131558 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:12:51.132301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt build --select int__price_changes', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:12:51.451453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96545b6f-a8a2-49c9-abd4-c348371625ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E3010180>]}
[0m14:12:51.516199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96545b6f-a8a2-49c9-abd4-c348371625ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E3B4B9B0>]}
[0m14:12:51.531435 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:12:51.854531 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m14:12:51.855511 [debug] [MainThread]: Command `-c build` failed at 14:12:51.855393 after 0.90 seconds
[0m14:12:51.855883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E4D95450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E4D95350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6E4FE4D70>]}
[0m14:12:51.856238 [debug] [MainThread]: Flushing usage events
[0m14:12:52.497182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:58.365935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C834B8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C83CC42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C84303ED0>]}


============================== 14:12:58.370264 | 62ec1f2d-ef31-48d0-ab1e-438fd72f1603 ==============================
[0m14:12:58.370264 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:12:58.370986 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt deps', 'printer_width': '80', 'log_format': 'default', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:12:58.505529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62ec1f2d-ef31-48d0-ab1e-438fd72f1603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C83670180>]}
[0m14:12:58.539288 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-wm8v2l2v'
[0m14:12:58.539752 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:12:59.139453 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:12:59.141826 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:12:59.674629 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:12:59.680534 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:13:00.526628 [info ] [MainThread]: Installed from version 1.3.2
[0m14:13:00.527168 [info ] [MainThread]: Up to date!
[0m14:13:00.527692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '62ec1f2d-ef31-48d0-ab1e-438fd72f1603', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C841AAF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C841AA580>]}
[0m14:13:00.529161 [debug] [MainThread]: Command `-c deps` succeeded at 14:13:00.529021 after 2.28 seconds
[0m14:13:00.529539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C8560CD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C8419B6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C84199040>]}
[0m14:13:00.529901 [debug] [MainThread]: Flushing usage events
[0m14:13:01.250343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:04.907688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014619AC8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461A2D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461A913ED0>]}


============================== 14:13:04.912083 | 55c2b991-5750-4497-bbe8-948acabe5462 ==============================
[0m14:13:04.912083 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:13:04.912978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt build --select int__price_changes', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:13:05.168726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55c2b991-5750-4497-bbe8-948acabe5462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014619C80180>]}
[0m14:13:05.235706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55c2b991-5750-4497-bbe8-948acabe5462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461A7BB9B0>]}
[0m14:13:05.238351 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:13:05.491742 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:13:05.573409 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:13:05.574035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '55c2b991-5750-4497-bbe8-948acabe5462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461BA95E50>]}
[0m14:13:07.358998 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__price_changes', 'description': '...', 'data_tests': [{'dbt_utils.unique_combination_of_columns': {'combination_of_columns': ['trade_date', 'ticker', 'rn', 'loaded_at']}}, {'dbt_utils.expression_is_true': None, 'expression': 'abs(delta) - (gain + loss)) = 0'}, {'dbt_utils.expression_is_true': {'expression': '(delta > 0 and gain = delta) or (delta <= 0 and gain = 0)'}}, {'dbt_utils.expression_is_true': {'expression': '(delta < 0 and loss = -delta) or (delta >= 0 and loss = 0)'}}], 'columns': [{'name': 'trade_date', 'description': None, 'data_tests': ['not_null']}, {'name': 'ticker', 'data_tests': ['not_null']}, {'name': 'close', 'data_tests': ['not_null']}, {'name': 'gain', 'data_tests': ['not_null', {'dbt_utils.expression_is_true': {'arguments': {'expression': 'gain >= 0'}}}]}, {'name': 'loss', 'data_tests': ['not_null', {'dbt_utils.expression_is_true': {'arguments': {'expression': 'loss >= 0'}}}]}, {'name': 'rn', 'data_tests': ['not_null']}, {'name': 'period_check', 'data_tests': [{'dbt_utils.expression_is_true': {'expression': 'period_check between 1 and 14'}}]}, {'name': 'loaded_at', 'data_tests': ['not_null']}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['columns'][0]['description']: None is not of type 'string'
[0m14:13:07.360294 [debug] [MainThread]: Command `-c build` failed at 14:13:07.360176 after 2.59 seconds
[0m14:13:07.360703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461C210140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461C210050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461A7D3E70>]}
[0m14:13:07.361048 [debug] [MainThread]: Flushing usage events
[0m14:13:07.942753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:01.882691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F35248050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F35A542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F36097ED0>]}


============================== 14:14:01.887595 | 4167dc35-79a3-46ed-b2d2-51ca0b93b7eb ==============================
[0m14:14:01.887595 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:14:01.888283 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt parse', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m14:14:02.152249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4167dc35-79a3-46ed-b2d2-51ca0b93b7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F35400180>]}
[0m14:14:02.221784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4167dc35-79a3-46ed-b2d2-51ca0b93b7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F35F3B9B0>]}
[0m14:14:02.224603 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:14:02.488647 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:14:02.575958 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:14:02.576592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4167dc35-79a3-46ed-b2d2-51ca0b93b7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F37185E50>]}
[0m14:14:04.065255 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__price_changes', 'description': '...', 'data_tests': [{'dbt_utils.unique_combination_of_columns': {'combination_of_columns': ['trade_date', 'ticker', 'rn', 'loaded_at']}}, {'dbt_utils.expression_is_true': None, 'expression': 'abs(delta) - (gain + loss)) = 0'}, {'dbt_utils.expression_is_true': {'expression': '(delta > 0 and gain = delta) or (delta <= 0 and gain = 0)'}}, {'dbt_utils.expression_is_true': {'expression': '(delta < 0 and loss = -delta) or (delta >= 0 and loss = 0)'}}], 'columns': [{'name': 'trade_date', 'description': None, 'data_tests': ['not_null']}, {'name': 'ticker', 'data_tests': ['not_null']}, {'name': 'close', 'data_tests': ['not_null']}, {'name': 'gain', 'data_tests': ['not_null', {'dbt_utils.expression_is_true': {'arguments': {'expression': 'gain >= 0'}}}]}, {'name': 'loss', 'data_tests': ['not_null', {'dbt_utils.expression_is_true': {'arguments': {'expression': 'loss >= 0'}}}]}, {'name': 'rn', 'data_tests': ['not_null']}, {'name': 'period_check', 'data_tests': [{'dbt_utils.expression_is_true': {'expression': 'period_check between 1 and 14'}}]}, {'name': 'loaded_at', 'data_tests': ['not_null']}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['columns'][0]['description']: None is not of type 'string'
[0m14:14:04.066686 [debug] [MainThread]: Command `-c parse` failed at 14:14:04.066549 after 2.33 seconds
[0m14:14:04.067103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F37934140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F37934050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F35F53E70>]}
[0m14:14:04.067483 [debug] [MainThread]: Flushing usage events
[0m14:14:04.784317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:03.212022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026788148050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267889542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026788F97ED0>]}


============================== 14:16:03.216348 | b32d27b1-cbc1-4480-9203-2d9e1d3f55e3 ==============================
[0m14:16:03.216348 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:16:03.217060 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'printer_width': '80', 'target_path': 'None'}
[0m14:16:03.461762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b32d27b1-cbc1-4480-9203-2d9e1d3f55e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026788300180>]}
[0m14:16:03.525768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b32d27b1-cbc1-4480-9203-2d9e1d3f55e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026788E3B9B0>]}
[0m14:16:03.528364 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:16:03.780551 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:16:03.856931 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:16:03.857525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b32d27b1-cbc1-4480-9203-2d9e1d3f55e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678A111E50>]}
[0m14:16:05.226696 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__rsi_sma', 'description': '...', 'data_tests': None, 'columns': [{'name': 'trade_date', 'data_tests': ['not_null', {'relationships': {'arguments': {'to': "ref('fct_events')", 'field': 'event_id'}}}]}, {'name': 'order_date', 'data_tests': ['not_null']}, {'name': 'user_id', 'data_tests': ['not_null']}, {'name': 'ga_session_id', 'data_tests': ['not_null']}, {'name': 'device_category', 'data_tests': [{'accepted_values': {'arguments': {'values': ['desktop', 'mobile', 'tablet']}}}]}, {'name': 'revenue', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}, {'name': 'total_items', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>= 1'}}}]}, {'name': 'distinct_products', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['data_tests']: None is not of type 'array'
[0m14:16:05.227921 [debug] [MainThread]: Command `-c parse` failed at 14:16:05.227786 after 2.18 seconds
[0m14:16:05.228324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678A890E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678A890F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026788E53E70>]}
[0m14:16:05.228702 [debug] [MainThread]: Flushing usage events
[0m14:16:06.018466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:03.048024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017268748050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017268F542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017269597ED0>]}


============================== 14:17:03.052356 | 8ba98aa5-b6b0-44b7-ba54-a5fc0f1c0a33 ==============================
[0m14:17:03.052356 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:17:03.053088 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:17:03.300662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ba98aa5-b6b0-44b7-ba54-a5fc0f1c0a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017268900180>]}
[0m14:17:03.366477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ba98aa5-b6b0-44b7-ba54-a5fc0f1c0a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726943B9B0>]}
[0m14:17:03.369044 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:17:03.619056 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:17:03.696484 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:17:03.697093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8ba98aa5-b6b0-44b7-ba54-a5fc0f1c0a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726A6FDE50>]}
[0m14:17:05.067801 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__rsi_sma', 'description': '...', 'data_tests': None, 'columns': [{'name': 'trade_date', 'data_tests': ['not_null', {'relationships': {'arguments': {'to': "ref('fct_events')", 'field': 'event_id'}}}]}, {'name': 'order_date', 'data_tests': ['not_null']}, {'name': 'user_id', 'data_tests': ['not_null']}, {'name': 'ga_session_id', 'data_tests': ['not_null']}, {'name': 'device_category', 'data_tests': [{'accepted_values': {'arguments': {'values': ['desktop', 'mobile', 'tablet']}}}]}, {'name': 'revenue', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}, {'name': 'total_items', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>= 1'}}}]}, {'name': 'distinct_products', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['data_tests']: None is not of type 'array'
[0m14:17:05.068923 [debug] [MainThread]: Command `-c parse` failed at 14:17:05.068780 after 2.14 seconds
[0m14:17:05.069285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726AE80E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726AE80F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017269453E70>]}
[0m14:17:05.069630 [debug] [MainThread]: Flushing usage events
[0m14:17:05.810729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:29.454446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A59468050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A59C742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A5A2B7ED0>]}


============================== 14:17:29.458859 | 7227c1c2-70da-4a03-8865-3be51b41cc9f ==============================
[0m14:17:29.458859 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:17:29.459742 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'printer_width': '80', 'write_json': 'True'}
[0m14:17:29.707724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7227c1c2-70da-4a03-8865-3be51b41cc9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A59620180>]}
[0m14:17:29.772759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7227c1c2-70da-4a03-8865-3be51b41cc9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A5A15B9B0>]}
[0m14:17:29.775399 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:17:30.022577 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:17:30.101458 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:17:30.102077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7227c1c2-70da-4a03-8865-3be51b41cc9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A5B3A5E50>]}
[0m14:17:31.494899 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__rsi_sma', 'description': '...', 'data_tests': None, 'columns': [{'name': 'trade_date', 'data_tests': ['not_null', {'relationships': {'arguments': {'to': "ref('fct_events')", 'field': 'event_id'}}}]}, {'name': 'order_date', 'data_tests': ['not_null']}, {'name': 'user_id', 'data_tests': ['not_null']}, {'name': 'ga_session_id', 'data_tests': ['not_null']}, {'name': 'device_category', 'data_tests': [{'accepted_values': {'arguments': {'values': ['desktop', 'mobile', 'tablet']}}}]}, {'name': 'revenue', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}, {'name': 'total_items', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>= 1'}}}]}, {'name': 'distinct_products', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['data_tests']: None is not of type 'array'
[0m14:17:31.496036 [debug] [MainThread]: Command `-c parse` failed at 14:17:31.495910 after 2.16 seconds
[0m14:17:31.496424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A5BBD0E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A5BBD0F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A5A173E70>]}
[0m14:17:31.496802 [debug] [MainThread]: Flushing usage events
[0m14:17:32.098314 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:53.427836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C7AE8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C82F42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C8937ED0>]}


============================== 14:17:53.432296 | d978ffb8-218d-41ef-a0e2-8922ed9f78a6 ==============================
[0m14:17:53.432296 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:17:53.433003 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:17:53.693333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd978ffb8-218d-41ef-a0e2-8922ed9f78a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C7CA0180>]}
[0m14:17:53.759455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd978ffb8-218d-41ef-a0e2-8922ed9f78a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C87DB9B0>]}
[0m14:17:53.762211 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:17:54.012156 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:17:54.090565 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:17:54.091167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd978ffb8-218d-41ef-a0e2-8922ed9f78a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C8A55E50>]}
[0m14:17:55.481932 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__rsi_sma', 'description': '...', 'data_tests': None, 'columns': [{'name': 'trade_date', 'data_tests': ['not_null', {'relationships': {'arguments': {'to': "ref('fct_events')", 'field': 'event_id'}}}]}, {'name': 'order_date', 'data_tests': ['not_null']}, {'name': 'user_id', 'data_tests': ['not_null']}, {'name': 'ga_session_id', 'data_tests': ['not_null']}, {'name': 'device_category', 'data_tests': [{'accepted_values': {'arguments': {'values': ['desktop', 'mobile', 'tablet']}}}]}, {'name': 'revenue', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}, {'name': 'total_items', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>= 1'}}}]}, {'name': 'distinct_products', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['data_tests']: None is not of type 'array'
[0m14:17:55.483067 [debug] [MainThread]: Command `-c parse` failed at 14:17:55.482945 after 2.18 seconds
[0m14:17:55.483454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CA244E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CA244F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C87F3E70>]}
[0m14:17:55.483831 [debug] [MainThread]: Flushing usage events
[0m14:17:56.081358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:30.508606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A47068050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A478742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A47EB7ED0>]}


============================== 14:18:30.513075 | 9c7b4b27-c03a-401d-a553-104a035a6029 ==============================
[0m14:18:30.513075 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:18:30.513776 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'invocation_command': 'dbt parse', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m14:18:30.762351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c7b4b27-c03a-401d-a553-104a035a6029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A47220180>]}
[0m14:18:30.827532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c7b4b27-c03a-401d-a553-104a035a6029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A47D5B9B0>]}
[0m14:18:30.830007 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:18:31.075902 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:18:31.153347 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:18:31.153898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c7b4b27-c03a-401d-a553-104a035a6029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A48FB5E50>]}
[0m14:18:32.542014 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__rsi_sma', 'description': '...', 'data_tests': None, 'columns': [{'name': 'trade_date', 'data_tests': ['not_null', {'relationships': {'arguments': {'to': "ref('fct_events')", 'field': 'event_id'}}}]}, {'name': 'order_date', 'data_tests': ['not_null']}, {'name': 'user_id', 'data_tests': ['not_null']}, {'name': 'ga_session_id', 'data_tests': ['not_null']}, {'name': 'device_category', 'data_tests': [{'accepted_values': {'arguments': {'values': ['desktop', 'mobile', 'tablet']}}}]}, {'name': 'revenue', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}, {'name': 'total_items', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>= 1'}}}]}, {'name': 'distinct_products', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['data_tests']: None is not of type 'array'
[0m14:18:32.543156 [debug] [MainThread]: Command `-c parse` failed at 14:18:32.543036 after 2.16 seconds
[0m14:18:32.543527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A49740E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A49740F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A47D73E70>]}
[0m14:18:32.543924 [debug] [MainThread]: Flushing usage events
[0m14:18:33.268045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:19:20.933664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FCE08050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FD6142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FDC53ED0>]}


============================== 14:19:20.938374 | 0b3e87a0-707a-446f-821e-23d0dfc2a99c ==============================
[0m14:19:20.938374 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:19:20.939082 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'printer_width': '80', 'target_path': 'None'}
[0m14:19:21.183419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b3e87a0-707a-446f-821e-23d0dfc2a99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FCFC0180>]}
[0m14:19:21.249708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b3e87a0-707a-446f-821e-23d0dfc2a99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FDAFB9B0>]}
[0m14:19:21.252194 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:19:21.498752 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:19:21.576094 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:19:21.576669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b3e87a0-707a-446f-821e-23d0dfc2a99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FDD71E50>]}
[0m14:19:22.944814 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\silver\silver_schema.yml @ models: {'name': 'int__rsi_sma', 'description': '...', 'data_tests': None, 'columns': [{'name': 'trade_date', 'data_tests': ['not_null', {'relationships': {'arguments': {'to': "ref('fct_events')", 'field': 'event_id'}}}]}, {'name': 'order_date', 'data_tests': ['not_null']}, {'name': 'user_id', 'data_tests': ['not_null']}, {'name': 'ga_session_id', 'data_tests': ['not_null']}, {'name': 'device_category', 'data_tests': [{'accepted_values': {'arguments': {'values': ['desktop', 'mobile', 'tablet']}}}]}, {'name': 'revenue', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}, {'name': 'total_items', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>= 1'}}}]}, {'name': 'distinct_products', 'data_tests': [{'dbt_utils.expression_is_true': {'arguments': {'expression': '>=0'}}}]}], 'original_file_path': 'models\\silver\\silver_schema.yml', 'yaml_key': 'models', 'package_name': 'portfolio_project_2'} - at path ['data_tests']: None is not of type 'array'
[0m14:19:22.946161 [debug] [MainThread]: Command `-c parse` failed at 14:19:22.946023 after 2.15 seconds
[0m14:19:22.946652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FF550E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FF550F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150FDB13E70>]}
[0m14:19:22.947007 [debug] [MainThread]: Flushing usage events
[0m14:19:23.555541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:40.490652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B4E708050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B4EF142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B4F557ED0>]}


============================== 17:00:40.507789 | 3a657c19-1e9c-454d-bac1-ec5c715dab82 ==============================
[0m17:00:40.507789 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:00:40.510569 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:00:40.986649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a657c19-1e9c-454d-bac1-ec5c715dab82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B4E8C0180>]}
[0m17:00:41.076013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a657c19-1e9c-454d-bac1-ec5c715dab82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B4F3FB9B0>]}
[0m17:00:41.079442 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:00:41.434320 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:00:41.541620 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:00:41.542367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a657c19-1e9c-454d-bac1-ec5c715dab82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B50691E50>]}
[0m17:00:43.735213 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:00:43.870272 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m17:00:43.871138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3a657c19-1e9c-454d-bac1-ec5c715dab82', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B50873F20>]}
[0m17:00:44.240180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a657c19-1e9c-454d-bac1-ec5c715dab82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B50F95470>]}
[0m17:00:44.246265 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m17:00:44.448278 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:00:44.453608 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:00:44.454444 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 11 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:00:44.455854 [debug] [MainThread]: Command `-c parse` succeeded at 17:00:44.455686 after 4.39 seconds
[0m17:00:44.456418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B51087520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B4F34F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B50F528D0>]}
[0m17:00:44.456946 [debug] [MainThread]: Flushing usage events
[0m17:00:45.535166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:03:00.672847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DC0E8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DC8F42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DCF37ED0>]}


============================== 17:03:00.683514 | 71c4ee88-12d0-484a-ad09-9220e8e2290b ==============================
[0m17:03:00.683514 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:03:00.685452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:03:01.274107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71c4ee88-12d0-484a-ad09-9220e8e2290b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DC2A0180>]}
[0m17:03:01.408937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71c4ee88-12d0-484a-ad09-9220e8e2290b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DCDDB9B0>]}
[0m17:03:01.417800 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:03:01.967320 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:03:02.362287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:03:02.364182 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\silver_schema.yml
[0m17:03:02.365090 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\gold\gold_schema.yml
[0m17:03:03.190150 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:03:03.207220 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models\gold\gold_schema.yml:
  	test definition dictionary must have exactly one key, got [('dbt_expectations.expect_column_values_to_be_between', None), ('arguments', {'min_value': 0, 'max_value': 100})] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m17:03:03.208622 [debug] [MainThread]: Command `-c parse` failed at 17:03:03.208440 after 2.89 seconds
[0m17:03:03.209157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DE5ED850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DE5ED550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DE40ED50>]}
[0m17:03:03.209672 [debug] [MainThread]: Flushing usage events
[0m17:03:04.164995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:37.910272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DAB28050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DB3342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DB977ED0>]}


============================== 17:05:37.925609 | c0bafb6d-7c2a-4b93-8bad-bdd94450a8b5 ==============================
[0m17:05:37.925609 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:05:37.928145 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt deps', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m17:05:38.185572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0bafb6d-7c2a-4b93-8bad-bdd94450a8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DACE0180>]}
[0m17:05:38.234080 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-hzu8_xy_'
[0m17:05:38.235252 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:05:39.285936 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:05:39.293124 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:05:40.101229 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:05:40.129631 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m17:05:40.940584 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m17:05:40.955419 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m17:05:41.725103 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m17:05:41.779665 [info ] [MainThread]: Updating lock file in file path: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2/package-lock.yml
[0m17:05:41.967150 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-wlimr7zt'
[0m17:05:41.989996 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:05:43.566871 [info ] [MainThread]: Installed from version 1.3.2
[0m17:05:43.567888 [info ] [MainThread]: Up to date!
[0m17:05:43.568740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c0bafb6d-7c2a-4b93-8bad-bdd94450a8b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DCC35370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DCC35480>]}
[0m17:05:43.569391 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m17:05:48.438507 [info ] [MainThread]: Installed from version 0.10.9
[0m17:05:48.439280 [info ] [MainThread]: Up to date!
[0m17:05:48.440016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c0bafb6d-7c2a-4b93-8bad-bdd94450a8b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DCC4D050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DB809040>]}
[0m17:05:48.440568 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m17:05:49.957765 [info ] [MainThread]: Installed from version 0.16.1
[0m17:05:49.959697 [info ] [MainThread]: Up to date!
[0m17:05:49.961670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c0bafb6d-7c2a-4b93-8bad-bdd94450a8b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DCC29EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DCC29C50>]}
[0m17:05:49.972664 [debug] [MainThread]: Command `-c deps` succeeded at 17:05:49.972086 after 12.59 seconds
[0m17:05:49.974174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DB7671D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DCB33290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218DCC422B0>]}
[0m17:05:49.975706 [debug] [MainThread]: Flushing usage events
[0m17:05:51.802790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:03.756064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39FC78050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A04842D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A0AC3ED0>]}


============================== 17:06:03.771322 | 97e3d6b7-c84f-4dc2-8cff-b7d9237e3136 ==============================
[0m17:06:03.771322 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:06:03.773828 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'printer_width': '80', 'write_json': 'True'}
[0m17:06:04.320517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97e3d6b7-c84f-4dc2-8cff-b7d9237e3136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39FE30180>]}
[0m17:06:04.421456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97e3d6b7-c84f-4dc2-8cff-b7d9237e3136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A096B790>]}
[0m17:06:04.425365 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:06:04.964544 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:06:05.209915 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:06:05.210939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '97e3d6b7-c84f-4dc2-8cff-b7d9237e3136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A1DFD250>]}
[0m17:06:10.850722 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:06:11.041626 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models\gold\gold_schema.yml:
  	test definition dictionary must have exactly one key, got [('dbt_expectations.expect_column_values_to_be_between', None), ('arguments', {'min_value': 0, 'max_value': 100})] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m17:06:11.043278 [debug] [MainThread]: Command `-c parse` failed at 17:06:11.043071 after 7.54 seconds
[0m17:06:11.043889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A25F0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A25F0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A0983E70>]}
[0m17:06:11.044484 [debug] [MainThread]: Flushing usage events
[0m17:06:12.110367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:14.807103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05C848050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05D0542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05D697ED0>]}


============================== 17:11:14.820044 | 746bbbcc-85c9-48ee-bebf-bc7cc271ef6b ==============================
[0m17:11:14.820044 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:11:14.822079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:11:15.247382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '746bbbcc-85c9-48ee-bebf-bc7cc271ef6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05CA00180>]}
[0m17:11:15.337937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '746bbbcc-85c9-48ee-bebf-bc7cc271ef6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05D53B790>]}
[0m17:11:15.341252 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:11:15.714635 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:11:15.871735 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:11:15.872488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '746bbbcc-85c9-48ee-bebf-bc7cc271ef6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05EA0D250>]}
[0m17:11:18.583269 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:11:18.717808 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m17:11:18.718671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '746bbbcc-85c9-48ee-bebf-bc7cc271ef6b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05ED597C0>]}
[0m17:11:18.748157 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models\gold\gold_schema.yml:
  	test definition dictionary must have exactly one key, got [('dbt_expectations.expect_column_values_to_be_between', None), ('arguments', {'min_value': 0, 'max_value': 100})] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m17:11:18.749402 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:11:18.751060 [debug] [MainThread]: Command `-c parse` failed at 17:11:18.750791 after 4.31 seconds
[0m17:11:18.751866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05D553E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05F1CF3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05EE3E680>]}
[0m17:11:18.752434 [debug] [MainThread]: Flushing usage events
[0m17:11:19.618703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:46.172428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E578050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8ED842D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8F3C3ED0>]}


============================== 17:11:46.189592 | e08525d7-6759-4674-b946-93ef6b2942a8 ==============================
[0m17:11:46.189592 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:11:46.192295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:11:46.619182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e08525d7-6759-4674-b946-93ef6b2942a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E730180>]}
[0m17:11:46.709973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e08525d7-6759-4674-b946-93ef6b2942a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8F26B790>]}
[0m17:11:46.713332 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:11:47.069535 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:11:47.312551 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:11:47.313954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e08525d7-6759-4674-b946-93ef6b2942a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF9071D250>]}
[0m17:11:50.094221 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:11:50.238056 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m17:11:50.239148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e08525d7-6759-4674-b946-93ef6b2942a8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF90A717C0>]}
[0m17:11:50.664816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e08525d7-6759-4674-b946-93ef6b2942a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF90C77850>]}
[0m17:11:50.670518 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m17:11:50.874897 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:11:50.878157 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:11:50.878883 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:11:50.880337 [debug] [MainThread]: Command `-c parse` succeeded at 17:11:50.880170 after 4.97 seconds
[0m17:11:50.880860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF90B6CBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8F1BB1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF90AFE090>]}
[0m17:11:50.881452 [debug] [MainThread]: Flushing usage events
[0m17:11:52.185254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:21.561701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282E82A8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282E8AB42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282E90F7ED0>]}


============================== 17:13:21.568704 | c4381fbf-2491-4417-b06c-af8f2635f80e ==============================
[0m17:13:21.568704 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:13:21.569785 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt parse', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:13:21.962732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4381fbf-2491-4417-b06c-af8f2635f80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282E8460180>]}
[0m17:13:22.053218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4381fbf-2491-4417-b06c-af8f2635f80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282E8F9B790>]}
[0m17:13:22.056930 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:13:22.459227 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:13:22.772631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:13:22.773748 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\gold\gold_schema.yml
[0m17:13:23.240531 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:13:23.241735 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m17:13:23.242445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c4381fbf-2491-4417-b06c-af8f2635f80e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282EA935B50>]}
[0m17:13:23.552149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4381fbf-2491-4417-b06c-af8f2635f80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282EA85FB60>]}
[0m17:13:23.557573 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m17:13:23.749447 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:13:23.752536 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:13:23.753242 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:13:23.754779 [debug] [MainThread]: Command `-c parse` succeeded at 17:13:23.754574 after 2.53 seconds
[0m17:13:23.755497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282E8FB3E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282EA424AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282EAA7BEE0>]}
[0m17:13:23.756040 [debug] [MainThread]: Flushing usage events
[0m17:13:24.583848 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:45.959013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF6D68050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF75742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF7BB7ED0>]}


============================== 17:13:45.974581 | a87a6ca9-37f2-4de3-99c3-a4fbad44bfa2 ==============================
[0m17:13:45.974581 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:13:45.977625 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt build --target +fact__rsi', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m17:13:45.988135 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'portfolio_project_2' does not have a target named '+fact__rsi'. The valid target names for this profile are:
   - dev
   - prod
[0m17:13:45.991566 [debug] [MainThread]: Command `-c build` failed at 17:13:45.991068 after 0.30 seconds
[0m17:13:45.993007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF7C342B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF7AB68D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF7A59AE0>]}
[0m17:13:45.994458 [debug] [MainThread]: Flushing usage events
[0m17:13:46.896927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:57.592834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758A7F8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758B0042D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758B647ED0>]}


============================== 17:13:57.608105 | c9f0dae3-9834-4ace-b3ff-02009404608d ==============================
[0m17:13:57.608105 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:13:57.610577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt build --target +fct__rsi', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:13:57.620454 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'portfolio_project_2' does not have a target named '+fct__rsi'. The valid target names for this profile are:
   - dev
   - prod
[0m17:13:57.623814 [debug] [MainThread]: Command `-c build` failed at 17:13:57.623320 after 0.26 seconds
[0m17:13:57.625243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758B6C42B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758B5468D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758B4E9AE0>]}
[0m17:13:57.626689 [debug] [MainThread]: Flushing usage events
[0m17:13:58.576945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:16.506750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C4D58050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C55642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C5BA3ED0>]}


============================== 17:14:16.521701 | 2516613b-6de9-4b1c-ab6d-c64d597a1999 ==============================
[0m17:14:16.521701 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:14:16.524161 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select +fct__rsi', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m17:14:16.981025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2516613b-6de9-4b1c-ab6d-c64d597a1999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C4F10180>]}
[0m17:14:17.071488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2516613b-6de9-4b1c-ab6d-c64d597a1999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C5A4B790>]}
[0m17:14:17.074945 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:14:17.544742 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:14:18.350732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:18.351451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:18.430214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2516613b-6de9-4b1c-ab6d-c64d597a1999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C6C94F50>]}
[0m17:14:18.690547 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:14:18.694074 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:14:18.798199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2516613b-6de9-4b1c-ab6d-c64d597a1999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C75AD5E0>]}
[0m17:14:18.799640 [info ] [MainThread]: Found 6 models, 47 data tests, 2 sources, 853 macros
[0m17:14:18.814937 [info ] [MainThread]: 
[0m17:14:18.816632 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:14:18.818191 [info ] [MainThread]: 
[0m17:14:18.820473 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:14:18.838948 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:14:21.890354 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:14:21.890948 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:14:21.891432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:24.704952 [debug] [ThreadPool]: SQL status: OK in 2.813 seconds
[0m17:14:24.710660 [debug] [ThreadPool]: On list_finance: Close
[0m17:14:24.713550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:14:24.715710 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:14:24.742554 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:14:24.744067 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:14:24.745482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:24.750352 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:14:24.754348 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:14:24.755247 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:14:24.757473 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:14:24.758233 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:14:24.758939 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:14:24.816290 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m17:14:24.820048 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:14:24.822108 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:14:24.824928 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:14:24.880907 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m17:14:24.883021 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:14:24.890375 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:14:24.920910 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:14:24.922414 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:14:24.923725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:24.928640 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:14:24.930233 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:14:24.931781 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:14:25.083779 [debug] [ThreadPool]: SQL status: OK in 0.150 seconds
[0m17:14:25.089634 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:14:25.142926 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:14:25.144662 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:14:25.152255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2516613b-6de9-4b1c-ab6d-c64d597a1999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C74CA190>]}
[0m17:14:25.154142 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:25.155501 [debug] [MainThread]: On master: BEGIN
[0m17:14:25.156761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:25.161033 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:14:25.162613 [debug] [MainThread]: On master: COMMIT
[0m17:14:25.164252 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:25.165532 [debug] [MainThread]: On master: COMMIT
[0m17:14:25.168219 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:14:25.169576 [debug] [MainThread]: On master: Close
[0m17:14:25.185443 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m17:14:25.187549 [info ] [Thread-1 (]: 1 of 52 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m17:14:25.190410 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m17:14:25.192069 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m17:14:25.223026 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m17:14:25.227584 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m17:14:25.365615 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m17:14:25.369740 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:14:25.371528 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m17:14:25.373120 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:14:25.378901 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:14:25.381009 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:14:25.382663 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:14:25.487633 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m17:14:25.512631 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:14:25.514283 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m17:14:25.571734 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m17:14:25.585048 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:14:25.586643 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m17:14:25.650887 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m17:14:25.698673 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:14:25.700427 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:14:25.701956 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:14:25.932823 [debug] [Thread-1 (]: SQL status: OK in 0.229 seconds
[0m17:14:25.971431 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:14:25.973359 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m17:14:26.093083 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m17:14:26.102540 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m17:14:26.110681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2516613b-6de9-4b1c-ab6d-c64d597a1999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C8DC5F30>]}
[0m17:14:26.113325 [info ] [Thread-1 (]: 1 of 52 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.91s]
[0m17:14:26.116506 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m17:14:26.119387 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m17:14:26.121715 [info ] [Thread-2 (]: 2 of 52 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m17:14:26.124496 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m17:14:26.126179 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m17:14:26.137355 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m17:14:26.141298 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m17:14:26.155064 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m17:14:26.159300 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:14:26.160968 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m17:14:26.162495 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:14:26.167176 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:14:26.168730 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:14:26.170435 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:14:26.281036 [debug] [Thread-2 (]: SQL status: OK in 0.108 seconds
[0m17:14:26.293711 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:14:26.296618 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m17:14:26.364854 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m17:14:26.376546 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:14:26.378464 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m17:14:26.448032 [debug] [Thread-2 (]: SQL status: OK in 0.068 seconds
[0m17:14:26.453916 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:14:26.455704 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:14:26.457409 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:14:26.628627 [debug] [Thread-2 (]: SQL status: OK in 0.170 seconds
[0m17:14:26.641956 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:14:26.644773 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m17:14:26.777093 [debug] [Thread-2 (]: SQL status: OK in 0.130 seconds
[0m17:14:26.783863 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m17:14:26.786785 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2516613b-6de9-4b1c-ab6d-c64d597a1999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C719AB10>]}
[0m17:14:26.790658 [info ] [Thread-2 (]: 2 of 52 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.66s]
[0m17:14:26.796314 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m17:14:26.801543 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:14:26.803727 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:14:26.806058 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca
[0m17:14:26.808242 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:14:26.811282 [info ] [Thread-3 (]: 3 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m17:14:26.813291 [info ] [Thread-1 (]: 5 of 52 START test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9  [RUN]
[0m17:14:26.820854 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:14:26.823354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de)
[0m17:14:26.815637 [info ] [Thread-2 (]: 6 of 52 START test dbt_utils_expression_is_true_int__price_changes_gain__gain_0  [RUN]
[0m17:14:26.826393 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:14:26.828596 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:14:26.817684 [info ] [Thread-4 (]: 4 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m17:14:26.831323 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca)
[0m17:14:26.926056 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:14:26.933055 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:14:26.937755 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:14:26.939907 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca
[0m17:14:26.941520 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:14:26.954913 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca"
[0m17:14:26.967165 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:14:26.969529 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:14:26.971311 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:14:27.017618 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:14:27.022195 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca
[0m17:14:27.097171 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:14:27.106934 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:14:27.118265 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:14:27.122348 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca"
[0m17:14:27.127779 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:14:27.128664 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m17:14:27.129617 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca"
[0m17:14:27.130465 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:14:27.131279 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca: BEGIN
[0m17:14:27.132474 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:14:27.133290 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:14:27.134070 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: BEGIN
[0m17:14:27.135050 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:14:27.136141 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:14:27.137076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:27.137870 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:14:27.138609 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:14:27.139377 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m17:14:27.140741 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m17:14:27.141548 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca"
[0m17:14:27.142460 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:14:27.143781 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:14:27.145528 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:14:27.147373 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:14:27.149023 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:14:27.156842 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:14:27.157809 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(delta) - (gain + loss)) > 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:14:27.158705 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:14:27.159557 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:14:27.164677 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(delta) - (gain + loss)) > 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:14:27.165731 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m17:14:27.167289 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:14:27.168115 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca: ROLLBACK
[0m17:14:27.170187 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: ROLLBACK
[0m17:14:27.264349 [debug] [Thread-4 (]: SQL status: OK in 0.119 seconds
[0m17:14:27.272662 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m17:14:27.274818 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:14:27.276316 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m17:14:27.278523 [info ] [Thread-4 (]: 4 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.35s]
[0m17:14:27.280673 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:14:27.282137 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152
[0m17:14:27.283582 [info ] [Thread-4 (]: 7 of 52 START test dbt_utils_expression_is_true_int__price_changes_loss__loss_0  [RUN]
[0m17:14:27.285139 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152)
[0m17:14:27.285960 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152
[0m17:14:27.295885 [debug] [Thread-3 (]: SQL status: OK in 0.127 seconds
[0m17:14:27.299909 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152"
[0m17:14:27.302902 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152
[0m17:14:27.306596 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m17:14:27.312849 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152"
[0m17:14:27.315081 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:14:27.316816 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m17:14:27.318792 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152"
[0m17:14:27.323073 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152: BEGIN
[0m17:14:27.321489 [info ] [Thread-3 (]: 3 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.50s]
[0m17:14:27.325330 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:14:27.327075 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:14:27.328955 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:14:27.330456 [info ] [Thread-3 (]: 8 of 52 START test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14  [RUN]
[0m17:14:27.332344 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m17:14:27.333363 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182)
[0m17:14:27.334407 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152"
[0m17:14:27.336228 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:14:27.338739 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:14:27.353075 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:14:27.360038 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:14:27.361923 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:14:27.363280 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152: ROLLBACK
[0m17:14:27.366967 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:14:27.374704 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:14:27.377050 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:14:27.377930 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: BEGIN
[0m17:14:27.378759 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:14:27.383374 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:14:27.429793 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:14:27.433562 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:14:27.456697 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:14:27.457868 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:14:27.459012 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: ROLLBACK
[0m17:14:27.568308 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152'
[0m17:14:27.570929 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182'
[0m17:14:27.572054 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152: Close
[0m17:14:27.578521 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de'
[0m17:14:27.579944 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: Close
[0m17:14:27.581777 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca'
[0m17:14:27.582903 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: Close
[0m17:14:27.588371 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca: Close
[0m17:14:27.603055 [debug] [Thread-4 (]: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_loss__loss_0 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "loss"
  
  LINE 18: where not(loss loss >= 0)
                          ^
[0m17:14:27.604403 [error] [Thread-4 (]: 7 of 52 ERROR dbt_utils_expression_is_true_int__price_changes_loss__loss_0 ..... [[31mERROR[0m in 0.32s]
[0m17:14:27.607264 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152
[0m17:14:27.612686 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:14:27.618271 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152' to be skipped because of status 'error'.  Reason: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_loss__loss_0 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "loss"
  
  LINE 18: where not(loss loss >= 0)
                          ^.
[0m17:14:27.621680 [debug] [Thread-3 (]: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "period_check"
  
  LINE 18: where not(period_check period_check between 1 and 14)
                                  ^
[0m17:14:27.619157 [info ] [Thread-4 (]: 9 of 52 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m17:14:27.627088 [debug] [Thread-1 (]: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near ")"
  
  LINE 24:     ) dbt_internal_test
               ^
[0m17:14:27.628620 [error] [Thread-3 (]: 8 of 52 ERROR dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14  [[31mERROR[0m in 0.29s]
[0m17:14:27.634271 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss__loss_0.928309b152, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m17:14:27.636595 [debug] [Thread-2 (]: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_gain__gain_0 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "gain"
  
  LINE 18: where not(gain gain >= 0)
                          ^
[0m17:14:27.639463 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:14:27.638023 [error] [Thread-1 (]: 5 of 52 ERROR dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9  [[31mERROR[0m in 0.82s]
[0m17:14:27.640832 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:14:27.643705 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:14:27.642267 [error] [Thread-2 (]: 6 of 52 ERROR dbt_utils_expression_is_true_int__price_changes_gain__gain_0 ..... [[31mERROR[0m in 0.81s]
[0m17:14:27.646495 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182' to be skipped because of status 'error'.  Reason: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "period_check"
  
  LINE 18: where not(period_check period_check between 1 and 14)
                                  ^.
[0m17:14:27.648230 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:14:27.672728 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:14:27.676747 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca
[0m17:14:27.674284 [info ] [Thread-3 (]: 10 of 52 START test not_null_int__price_changes_close .......................... [RUN]
[0m17:14:27.679271 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:14:27.681087 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de' to be skipped because of status 'error'.  Reason: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near ")"
  
  LINE 24:     ) dbt_internal_test
               ^.
[0m17:14:27.682789 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:14:27.684110 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m17:14:27.685367 [info ] [Thread-1 (]: 11 of 52 START test not_null_int__price_changes_gain ........................... [RUN]
[0m17:14:27.688053 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca' to be skipped because of status 'error'.  Reason: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_gain__gain_0 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "gain"
  
  LINE 18: where not(gain gain >= 0)
                          ^.
[0m17:14:27.691612 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:14:27.689864 [info ] [Thread-2 (]: 12 of 52 START test not_null_int__price_changes_loaded_at ...................... [RUN]
[0m17:14:27.694273 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:14:27.695635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m17:14:27.715273 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:14:27.716438 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain__gain_0.592edb36ca, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m17:14:27.738496 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:14:27.740495 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:14:27.743020 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:14:27.761713 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:14:27.770094 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:14:27.797778 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:14:27.799998 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m17:14:27.802711 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:14:27.806137 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:14:27.818222 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:14:27.821758 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:14:27.825268 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:14:27.839255 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:14:27.849905 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:14:27.853498 [debug] [Thread-4 (]: SQL status: OK in 0.047 seconds
[0m17:14:27.857255 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:14:27.861012 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:14:27.864074 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m17:14:27.867332 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:14:27.869817 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:14:27.873448 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:14:27.876088 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:14:27.878153 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m17:14:27.882139 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m17:14:27.884496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:27.887350 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:14:27.889657 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m17:14:27.893816 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:14:27.897177 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:14:27.899749 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m17:14:27.901831 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m17:14:27.904351 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:14:27.907913 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:14:27.910398 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:14:27.912734 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:14:27.974579 [debug] [Thread-4 (]: SQL status: OK in 0.094 seconds
[0m17:14:27.987209 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m17:14:27.991565 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m17:14:27.993817 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m17:14:27.995944 [debug] [Thread-3 (]: SQL status: OK in 0.097 seconds
[0m17:14:28.007555 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m17:14:28.000589 [info ] [Thread-4 (]: 9 of 52 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.37s]
[0m17:14:28.011429 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m17:14:28.014549 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:14:28.016671 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m17:14:28.019007 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:14:28.022408 [info ] [Thread-4 (]: 13 of 52 START test not_null_int__price_changes_loss ........................... [RUN]
[0m17:14:28.027851 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m17:14:28.025345 [info ] [Thread-3 (]: 10 of 52 PASS not_null_int__price_changes_close ................................ [[32mPASS[0m in 0.34s]
[0m17:14:28.030681 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:14:28.034289 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:14:28.054776 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:14:28.056864 [debug] [Thread-1 (]: SQL status: OK in 0.142 seconds
[0m17:14:28.058971 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:14:28.061276 [debug] [Thread-2 (]: SQL status: OK in 0.146 seconds
[0m17:14:28.064015 [info ] [Thread-3 (]: 14 of 52 START test not_null_int__price_changes_rn ............................. [RUN]
[0m17:14:28.067044 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m17:14:28.073438 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:14:28.077189 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m17:14:28.083136 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m17:14:28.099522 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:14:28.102818 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:14:28.105189 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m17:14:28.107752 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m17:14:28.117447 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:14:28.120412 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m17:14:28.122365 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m17:14:28.125125 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:14:28.127655 [info ] [Thread-1 (]: 11 of 52 PASS not_null_int__price_changes_gain ................................. [[32mPASS[0m in 0.43s]
[0m17:14:28.140890 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:14:28.144179 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:14:28.129825 [info ] [Thread-2 (]: 12 of 52 PASS not_null_int__price_changes_loaded_at ............................ [[32mPASS[0m in 0.41s]
[0m17:14:28.146664 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:14:28.149121 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:14:28.151997 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:14:28.153949 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m17:14:28.157738 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:14:28.159989 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:14:28.155945 [info ] [Thread-1 (]: 15 of 52 START test not_null_int__price_changes_ticker ......................... [RUN]
[0m17:14:28.162142 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:14:28.165746 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m17:14:28.164082 [info ] [Thread-2 (]: 16 of 52 START test not_null_int__price_changes_trade_date ..................... [RUN]
[0m17:14:28.168113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m17:14:28.170752 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:14:28.172942 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m17:14:28.175007 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:14:28.176827 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m17:14:28.179334 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:14:28.195249 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:14:28.197179 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:14:28.198956 [debug] [Thread-3 (]: SQL status: OK in 0.028 seconds
[0m17:14:28.215582 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:14:28.218049 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:14:28.220024 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:14:28.223692 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:14:28.226304 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:14:28.237161 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:14:28.239636 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:14:28.251564 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:14:28.254367 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:14:28.256097 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m17:14:28.257585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:28.260453 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:14:28.262134 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m17:14:28.263852 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:14:28.265407 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:14:28.267093 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:14:28.269615 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:14:28.272439 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:14:28.274104 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:14:28.275751 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:14:28.441146 [debug] [Thread-4 (]: SQL status: OK in 0.219 seconds
[0m17:14:28.442164 [debug] [Thread-3 (]: SQL status: OK in 0.203 seconds
[0m17:14:28.447400 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m17:14:28.450700 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m17:14:28.452760 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m17:14:28.455515 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m17:14:28.456748 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m17:14:28.458070 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m17:14:28.462036 [info ] [Thread-4 (]: 13 of 52 PASS not_null_int__price_changes_loss ................................. [[32mPASS[0m in 0.43s]
[0m17:14:28.466971 [debug] [Thread-1 (]: SQL status: OK in 0.195 seconds
[0m17:14:28.468668 [debug] [Thread-2 (]: SQL status: OK in 0.191 seconds
[0m17:14:28.464745 [info ] [Thread-3 (]: 14 of 52 PASS not_null_int__price_changes_rn ................................... [[32mPASS[0m in 0.40s]
[0m17:14:28.473278 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:14:28.477669 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:14:28.486336 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m17:14:28.492206 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m17:14:28.496150 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m17:14:28.499834 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m17:14:28.501831 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m17:14:28.503865 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m17:14:28.509943 [info ] [Thread-2 (]: 16 of 52 PASS not_null_int__price_changes_trade_date ........................... [[32mPASS[0m in 0.34s]
[0m17:14:28.516828 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:14:28.512712 [info ] [Thread-1 (]: 15 of 52 PASS not_null_int__price_changes_ticker ............................... [[32mPASS[0m in 0.34s]
[0m17:14:28.522662 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:14:28.525981 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m17:14:28.528703 [info ] [Thread-4 (]: 17 of 52 SKIP relation analytics_dev.int__rsi_sma .............................. [[33mSKIP[0m]
[0m17:14:28.533031 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m17:14:28.535010 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_sma' to be skipped because of status 'skipped'. 
[0m17:14:28.540367 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:14:28.544087 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14.52086331c6
[0m17:14:28.547527 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain__sma_gain_0.e90a9c84e7
[0m17:14:28.552557 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:14:28.550103 [info ] [Thread-2 (]: 19 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_loss___0 .......... [[33mSKIP[0m]
[0m17:14:28.557318 [info ] [Thread-1 (]: 20 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14  [[33mSKIP[0m]
[0m17:14:28.559737 [info ] [Thread-4 (]: 21 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_sma_gain__sma_gain_0  [[33mSKIP[0m]
[0m17:14:28.565555 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:14:28.568348 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14.52086331c6
[0m17:14:28.562762 [info ] [Thread-3 (]: 18 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_gain___0 .......... [[33mSKIP[0m]
[0m17:14:28.571670 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain__sma_gain_0.e90a9c84e7
[0m17:14:28.574995 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss__sma_loss_0.fea3f2e739
[0m17:14:28.577546 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62' to be skipped because of status 'skipped'. 
[0m17:14:28.579774 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:14:28.581960 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:14:28.584104 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:14:28.590483 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14.52086331c6' to be skipped because of status 'skipped'. 
[0m17:14:28.587816 [info ] [Thread-2 (]: 22 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_sma_loss__sma_loss_0  [[33mSKIP[0m]
[0m17:14:28.597772 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:14:28.595372 [info ] [Thread-1 (]: 23 of 52 SKIP test dbt_utils_not_null_where_int__rsi_sma_sma_gain .............. [[33mSKIP[0m]
[0m17:14:28.602713 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain__sma_gain_0.e90a9c84e7' to be skipped because of status 'skipped'. 
[0m17:14:28.600719 [info ] [Thread-4 (]: 24 of 52 SKIP test dbt_utils_not_null_where_int__rsi_sma_sma_loss .............. [[33mSKIP[0m]
[0m17:14:28.605554 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss__sma_loss_0.fea3f2e739
[0m17:14:28.609963 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:14:28.607992 [info ] [Thread-3 (]: 25 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [[33mSKIP[0m]
[0m17:14:28.613733 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6' to be skipped because of status 'skipped'. 
[0m17:14:28.616396 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:14:28.619115 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:14:28.622248 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:14:28.624930 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:14:28.628021 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss__sma_loss_0.fea3f2e739' to be skipped because of status 'skipped'. 
[0m17:14:28.631518 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:14:28.633701 [info ] [Thread-2 (]: 26 of 52 SKIP test not_null_int__rsi_sma_close ................................. [[33mSKIP[0m]
[0m17:14:28.641000 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:14:28.643869 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e' to be skipped because of status 'skipped'. 
[0m17:14:28.637120 [info ] [Thread-1 (]: 27 of 52 SKIP test not_null_int__rsi_sma_gain .................................. [[33mSKIP[0m]
[0m17:14:28.650166 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:14:28.647551 [info ] [Thread-4 (]: 28 of 52 SKIP test not_null_int__rsi_sma_loaded_at ............................. [[33mSKIP[0m]
[0m17:14:28.656281 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d' to be skipped because of status 'skipped'. 
[0m17:14:28.654029 [info ] [Thread-3 (]: 29 of 52 SKIP test not_null_int__rsi_sma_loss .................................. [[33mSKIP[0m]
[0m17:14:28.659352 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:14:28.662412 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:14:28.665444 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:14:28.668174 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08' to be skipped because of status 'skipped'. 
[0m17:14:28.672179 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:14:28.675120 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:14:28.681136 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:14:28.679146 [info ] [Thread-2 (]: 30 of 52 SKIP test not_null_int__rsi_sma_rn .................................... [[33mSKIP[0m]
[0m17:14:28.683851 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b' to be skipped because of status 'skipped'. 
[0m17:14:28.687508 [info ] [Thread-1 (]: 31 of 52 SKIP test not_null_int__rsi_sma_ticker ................................ [[33mSKIP[0m]
[0m17:14:28.696309 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:14:28.691238 [info ] [Thread-4 (]: 32 of 52 SKIP test not_null_int__rsi_sma_trade_date ............................ [[33mSKIP[0m]
[0m17:14:28.700976 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953' to be skipped because of status 'skipped'. 
[0m17:14:28.705676 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:14:28.709326 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:14:28.712041 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0' to be skipped because of status 'skipped'. 
[0m17:14:28.715534 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065' to be skipped because of status 'skipped'. 
[0m17:14:28.717519 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139' to be skipped because of status 'skipped'. 
[0m17:14:28.721209 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d' to be skipped because of status 'skipped'. 
[0m17:14:28.724796 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0' to be skipped because of status 'skipped'. 
[0m17:14:28.728944 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m17:14:28.731895 [info ] [Thread-3 (]: 33 of 52 SKIP relation analytics_dev.int__rsi_wilder ........................... [[33mSKIP[0m]
[0m17:14:28.735580 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m17:14:28.739259 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_wilder' to be skipped because of status 'skipped'. 
[0m17:14:28.743273 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss__wilder_loss_0.1590da64c7
[0m17:14:28.745783 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:14:28.748147 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain__wilder_gain_0.a5859537ad
[0m17:14:28.750249 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:14:28.753371 [info ] [Thread-3 (]: 37 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss__wilder_loss_0  [[33mSKIP[0m]
[0m17:14:28.756570 [info ] [Thread-1 (]: 35 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ....... [[33mSKIP[0m]
[0m17:14:28.764981 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss__wilder_loss_0.1590da64c7
[0m17:14:28.759220 [info ] [Thread-4 (]: 36 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain__wilder_gain_0  [[33mSKIP[0m]
[0m17:14:28.772266 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:14:28.762507 [info ] [Thread-2 (]: 34 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ....... [[33mSKIP[0m]
[0m17:14:28.777595 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:14:28.780765 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss__wilder_loss_0.1590da64c7' to be skipped because of status 'skipped'. 
[0m17:14:28.782949 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain__wilder_gain_0.a5859537ad
[0m17:14:28.786217 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:14:28.790259 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:14:28.794943 [info ] [Thread-3 (]: 38 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[33mSKIP[0m]
[0m17:14:28.799350 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703' to be skipped because of status 'skipped'. 
[0m17:14:28.803302 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:14:28.810417 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:14:28.807566 [info ] [Thread-1 (]: 39 of 52 SKIP test not_null_int__rsi_wilder_gain ............................... [[33mSKIP[0m]
[0m17:14:28.814388 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:14:28.816553 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain__wilder_gain_0.a5859537ad' to be skipped because of status 'skipped'. 
[0m17:14:28.819833 [info ] [Thread-4 (]: 40 of 52 SKIP test not_null_int__rsi_wilder_loss ............................... [[33mSKIP[0m]
[0m17:14:28.826042 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:14:28.823518 [info ] [Thread-2 (]: 41 of 52 SKIP test not_null_int__rsi_wilder_rn ................................. [[33mSKIP[0m]
[0m17:14:28.828781 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:14:28.840917 [info ] [Thread-3 (]: 42 of 52 SKIP test not_null_int__rsi_wilder_ticker ............................. [[33mSKIP[0m]
[0m17:14:28.843505 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:14:28.845982 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:14:28.831820 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:14:28.849934 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:14:28.830285 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90' to be skipped because of status 'skipped'. 
[0m17:14:28.859377 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95' to be skipped because of status 'skipped'. 
[0m17:14:28.861313 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda' to be skipped because of status 'skipped'. 
[0m17:14:28.833214 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:14:28.834556 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:14:28.870770 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:14:28.848242 [info ] [Thread-3 (]: 44 of 52 SKIP test not_null_int__rsi_wilder_wilder_gain ........................ [[33mSKIP[0m]
[0m17:14:28.851995 [info ] [Thread-4 (]: 45 of 52 SKIP test not_null_int__rsi_wilder_wilder_loss ........................ [[33mSKIP[0m]
[0m17:14:28.863066 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd' to be skipped because of status 'skipped'. 
[0m17:14:28.874565 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:14:28.876518 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:14:28.868443 [info ] [Thread-1 (]: 43 of 52 SKIP test not_null_int__rsi_wilder_trade_date ......................... [[33mSKIP[0m]
[0m17:14:28.881265 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:14:28.878441 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56' to be skipped because of status 'skipped'. 
[0m17:14:28.883725 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d' to be skipped because of status 'skipped'. 
[0m17:14:28.885883 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9' to be skipped because of status 'skipped'. 
[0m17:14:28.888039 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb' to be skipped because of status 'skipped'. 
[0m17:14:28.892823 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c' to be skipped because of status 'skipped'. 
[0m17:14:28.872909 [info ] [Thread-2 (]: 46 of 52 SKIP test wilder_seed_equals_sma ...................................... [[33mSKIP[0m]
[0m17:14:28.895514 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:14:28.897500 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.wilder_seed_equals_sma' to be skipped because of status 'skipped'. 
[0m17:14:28.900028 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.fct__rsi
[0m17:14:28.901651 [info ] [Thread-3 (]: 47 of 52 SKIP relation analytics_dev.fct__rsi .................................. [[33mSKIP[0m]
[0m17:14:28.906818 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m17:14:28.909019 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'skipped'. 
[0m17:14:28.911868 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:14:28.915527 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:14:28.917311 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:14:28.919019 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:14:28.913743 [info ] [Thread-1 (]: 49 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[33mSKIP[0m]
[0m17:14:28.921242 [info ] [Thread-4 (]: 48 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[33mSKIP[0m]
[0m17:14:28.927112 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:14:28.929156 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:14:28.923622 [info ] [Thread-3 (]: 51 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ......... [[33mSKIP[0m]
[0m17:14:28.931958 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:14:28.933312 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2' to be skipped because of status 'skipped'. 
[0m17:14:28.935358 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:14:28.925184 [info ] [Thread-2 (]: 50 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............ [[33mSKIP[0m]
[0m17:14:28.940853 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a' to be skipped because of status 'skipped'. 
[0m17:14:28.939211 [info ] [Thread-1 (]: 52 of 52 SKIP test dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker  [[33mSKIP[0m]
[0m17:14:28.943632 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:14:28.945103 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0' to be skipped because of status 'skipped'. 
[0m17:14:28.946686 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:14:28.948427 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a' to be skipped because of status 'skipped'. 
[0m17:14:28.950288 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400' to be skipped because of status 'skipped'. 
[0m17:14:28.957244 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:28.958571 [debug] [MainThread]: On master: BEGIN
[0m17:14:28.959441 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:14:28.965704 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m17:14:28.967002 [debug] [MainThread]: On master: COMMIT
[0m17:14:28.968308 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:28.969489 [debug] [MainThread]: On master: COMMIT
[0m17:14:28.972951 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:14:28.974270 [debug] [MainThread]: On master: Close
[0m17:14:28.976002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:28.977369 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:14:28.978751 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:14:28.980011 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a' was properly closed.
[0m17:14:28.981265 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5' was properly closed.
[0m17:14:28.982328 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638' was properly closed.
[0m17:14:28.983054 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa' was properly closed.
[0m17:14:28.984196 [info ] [MainThread]: 
[0m17:14:28.987761 [info ] [MainThread]: Finished running 47 data tests, 5 view models in 0 hours 0 minutes and 10.16 seconds (10.16s).
[0m17:14:29.000426 [debug] [MainThread]: Command end result
[0m17:14:29.228389 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:14:29.233967 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:14:29.252174 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:14:29.253170 [info ] [MainThread]: 
[0m17:14:29.254257 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m17:14:29.255469 [info ] [MainThread]: 
[0m17:14:29.256651 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int__price_changes_loss__loss_0 (models\silver\silver_schema.yml)[0m
[0m17:14:29.257757 [error] [MainThread]:   Runtime Error in test dbt_utils_expression_is_true_int__price_changes_loss__loss_0 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "loss"
  
  LINE 18: where not(loss loss >= 0)
                          ^
[0m17:14:29.258834 [info ] [MainThread]: 
[0m17:14:29.259955 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\silver_schema.yml\dbt_utils_expression_is_true_int__price_changes_loss__loss_0.sql
[0m17:14:29.260926 [info ] [MainThread]: 
[0m17:14:29.262058 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)[0m
[0m17:14:29.263187 [error] [MainThread]:   Runtime Error in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "period_check"
  
  LINE 18: where not(period_check period_check between 1 and 14)
                                  ^
[0m17:14:29.264644 [info ] [MainThread]: 
[0m17:14:29.266474 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\silver_schema.yml\dbt_utils_expression_is_true_i_02fc6d0de4be0787745a8150f25c1081.sql
[0m17:14:29.267878 [info ] [MainThread]: 
[0m17:14:29.269491 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)[0m
[0m17:14:29.271359 [error] [MainThread]:   Runtime Error in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near ")"
  
  LINE 24:     ) dbt_internal_test
               ^
[0m17:14:29.273328 [info ] [MainThread]: 
[0m17:14:29.275407 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\silver_schema.yml\dbt_utils_expression_is_true_i_42ddde861532075e91a49918f22e3300.sql
[0m17:14:29.277025 [info ] [MainThread]: 
[0m17:14:29.278678 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int__price_changes_gain__gain_0 (models\silver\silver_schema.yml)[0m
[0m17:14:29.280027 [error] [MainThread]:   Runtime Error in test dbt_utils_expression_is_true_int__price_changes_gain__gain_0 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "gain"
  
  LINE 18: where not(gain gain >= 0)
                          ^
[0m17:14:29.281093 [info ] [MainThread]: 
[0m17:14:29.282435 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\silver_schema.yml\dbt_utils_expression_is_true_int__price_changes_gain__gain_0.sql
[0m17:14:29.283754 [info ] [MainThread]: 
[0m17:14:29.284951 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=4 SKIP=36 NO-OP=0 TOTAL=52
[0m17:14:29.287661 [debug] [MainThread]: Command `-c build` failed at 17:14:29.287165 after 13.03 seconds
[0m17:14:29.288952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C75E1C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C8E899F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C8E88C30>]}
[0m17:14:29.289863 [debug] [MainThread]: Flushing usage events
[0m17:14:30.666016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:43.506208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B678618050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B678E242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67946BED0>]}


============================== 17:18:43.521568 | 7c403f86-6ba9-46b7-b310-1db54117b702 ==============================
[0m17:18:43.521568 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:18:43.524062 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt build --select +fct__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m17:18:43.947862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c403f86-6ba9-46b7-b310-1db54117b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6787D0180>]}
[0m17:18:44.036652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c403f86-6ba9-46b7-b310-1db54117b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67930B790>]}
[0m17:18:44.040350 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:18:44.402988 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:18:44.744744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:18:44.746282 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\silver_schema.yml
[0m17:18:45.585959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c403f86-6ba9-46b7-b310-1db54117b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67AD75E50>]}
[0m17:18:45.741436 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:18:45.744511 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:18:45.859919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c403f86-6ba9-46b7-b310-1db54117b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67AF798B0>]}
[0m17:18:45.861479 [info ] [MainThread]: Found 6 models, 47 data tests, 2 sources, 853 macros
[0m17:18:45.877435 [info ] [MainThread]: 
[0m17:18:45.878751 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:18:45.879911 [info ] [MainThread]: 
[0m17:18:45.881445 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:18:45.893979 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:18:46.057517 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:18:46.058037 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:18:46.058463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:47.811845 [debug] [ThreadPool]: SQL status: OK in 1.753 seconds
[0m17:18:47.817861 [debug] [ThreadPool]: On list_finance: Close
[0m17:18:47.821320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:18:47.823573 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:18:47.849426 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:18:47.851303 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:18:47.852632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:47.858644 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:18:47.864253 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:18:47.865691 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:18:47.869793 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:18:47.871129 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:18:47.872431 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:18:47.936845 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m17:18:47.940717 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:18:47.943076 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:18:47.944388 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:18:47.995971 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m17:18:47.997452 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:18:48.003782 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:18:48.025241 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:18:48.026561 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:18:48.027697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:48.031572 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:18:48.032786 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:18:48.034025 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:18:48.110027 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m17:18:48.112528 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:18:48.114305 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:18:48.114862 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:18:48.118274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c403f86-6ba9-46b7-b310-1db54117b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67B0C99B0>]}
[0m17:18:48.118997 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:48.119485 [debug] [MainThread]: On master: BEGIN
[0m17:18:48.119923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:48.121427 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:18:48.121901 [debug] [MainThread]: On master: COMMIT
[0m17:18:48.122354 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:48.122793 [debug] [MainThread]: On master: COMMIT
[0m17:18:48.123631 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:18:48.124110 [debug] [MainThread]: On master: Close
[0m17:18:48.130710 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m17:18:48.131580 [info ] [Thread-1 (]: 1 of 52 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m17:18:48.132914 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m17:18:48.133543 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m17:18:48.145640 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m17:18:48.147067 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m17:18:48.210131 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m17:18:48.212270 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:18:48.213444 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m17:18:48.214297 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:18:48.217012 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:18:48.218144 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:18:48.218995 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:18:48.276738 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m17:18:48.291435 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:18:48.292458 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m17:18:48.342495 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m17:18:48.350975 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:18:48.352344 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m17:18:48.408451 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m17:18:48.463020 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:18:48.464587 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:18:48.465952 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:18:48.578963 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m17:18:48.609657 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:18:48.610824 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m17:18:48.713441 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m17:18:48.717158 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m17:18:48.720692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c403f86-6ba9-46b7-b310-1db54117b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67B50F380>]}
[0m17:18:48.721804 [info ] [Thread-1 (]: 1 of 52 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.59s]
[0m17:18:48.723341 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m17:18:48.724609 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m17:18:48.725605 [info ] [Thread-2 (]: 2 of 52 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m17:18:48.726836 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m17:18:48.727674 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m17:18:48.733290 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m17:18:48.735124 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m17:18:48.743563 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m17:18:48.746477 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:18:48.747410 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m17:18:48.748216 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:18:48.750679 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:18:48.751815 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:18:48.753375 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:18:48.866085 [debug] [Thread-2 (]: SQL status: OK in 0.112 seconds
[0m17:18:48.873158 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:18:48.874159 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m17:18:48.946369 [debug] [Thread-2 (]: SQL status: OK in 0.071 seconds
[0m17:18:48.954155 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:18:48.955129 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m17:18:49.028213 [debug] [Thread-2 (]: SQL status: OK in 0.072 seconds
[0m17:18:49.032291 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:18:49.033513 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:18:49.034634 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:18:49.217359 [debug] [Thread-2 (]: SQL status: OK in 0.181 seconds
[0m17:18:49.227540 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:18:49.229232 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m17:18:49.356835 [debug] [Thread-2 (]: SQL status: OK in 0.126 seconds
[0m17:18:49.361480 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m17:18:49.363289 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c403f86-6ba9-46b7-b310-1db54117b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67B0F2BD0>]}
[0m17:18:49.365264 [info ] [Thread-2 (]: 2 of 52 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.64s]
[0m17:18:49.368027 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m17:18:49.371096 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:18:49.372592 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:18:49.374056 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:18:49.376975 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:18:49.375661 [info ] [Thread-3 (]: 3 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m17:18:49.378608 [info ] [Thread-4 (]: 4 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m17:18:49.381173 [info ] [Thread-2 (]: 6 of 52 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .... [RUN]
[0m17:18:49.384791 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:18:49.386842 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:18:49.382576 [info ] [Thread-1 (]: 5 of 52 START test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9  [RUN]
[0m17:18:49.389086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m17:18:49.390704 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:18:49.392360 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:18:49.394052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de)
[0m17:18:49.395653 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:18:49.410115 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:18:49.425816 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:18:49.427456 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:18:49.440650 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:18:49.459267 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:18:49.463362 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:18:49.466159 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:18:49.488322 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:18:49.584915 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:18:49.590854 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:18:49.597135 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:18:49.599203 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:18:49.610407 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:18:49.613649 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:18:49.615595 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:18:49.617350 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: BEGIN
[0m17:18:49.619205 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:18:49.621133 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:18:49.623064 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m17:18:49.625144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.626908 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m17:18:49.628732 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m17:18:49.630532 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:18:49.633087 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:18:49.634893 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.637330 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:18:49.640932 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:18:49.642933 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"
[0m17:18:49.644989 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:18:49.646780 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m17:18:49.648521 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(delta) - (gain + loss)) > 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:18:49.650459 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m17:18:49.652574 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m17:18:49.654427 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:18:49.656936 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:18:49.658487 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:18:49.669719 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(delta) - (gain + loss)) > 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:18:49.672332 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m17:18:49.674093 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:18:49.676803 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: ROLLBACK
[0m17:18:49.702484 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de'
[0m17:18:49.704098 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de: Close
[0m17:18:49.719578 [debug] [Thread-1 (]: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near ")"
  
  LINE 24:     ) dbt_internal_test
               ^
[0m17:18:49.721515 [error] [Thread-1 (]: 5 of 52 ERROR dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9  [[31mERROR[0m in 0.33s]
[0m17:18:49.724579 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de
[0m17:18:49.726236 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:18:49.728350 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de' to be skipped because of status 'error'.  Reason: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near ")"
  
  LINE 24:     ) dbt_internal_test
               ^.
[0m17:18:49.729995 [info ] [Thread-1 (]: 7 of 52 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .... [RUN]
[0m17:18:49.733129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9.4b59aea7de, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m17:18:49.734639 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:18:49.750074 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:18:49.752021 [debug] [Thread-2 (]: SQL status: OK in 0.081 seconds
[0m17:18:49.754034 [debug] [Thread-3 (]: SQL status: OK in 0.097 seconds
[0m17:18:49.756394 [debug] [Thread-4 (]: SQL status: OK in 0.080 seconds
[0m17:18:49.768873 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m17:18:49.775678 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m17:18:49.781632 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m17:18:49.783848 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m17:18:49.785446 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:18:49.787878 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:18:49.789786 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m17:18:49.791896 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:18:49.802578 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:18:49.804327 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m17:18:49.806379 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m17:18:49.808752 [info ] [Thread-2 (]: 6 of 52 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 .......... [[32mPASS[0m in 0.42s]
[0m17:18:49.812487 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:18:49.814097 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:18:49.816174 [info ] [Thread-3 (]: 3 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.43s]
[0m17:18:49.824425 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:18:49.819205 [info ] [Thread-4 (]: 4 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.43s]
[0m17:18:49.826688 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:18:49.828390 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:18:49.820798 [info ] [Thread-2 (]: 8 of 52 START test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14  [RUN]
[0m17:18:49.831839 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:18:49.835367 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m17:18:49.833811 [info ] [Thread-3 (]: 9 of 52 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m17:18:49.837609 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182)
[0m17:18:49.839553 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:18:49.841423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.843431 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m17:18:49.845645 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:18:49.847378 [info ] [Thread-4 (]: 10 of 52 START test not_null_int__price_changes_close .......................... [RUN]
[0m17:18:49.850267 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:18:49.866057 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:18:49.868619 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m17:18:49.867755 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m17:18:49.886424 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:18:49.888671 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:18:49.890416 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:18:49.918363 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:18:49.919993 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:18:49.921686 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:18:49.928545 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:18:49.933019 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:18:49.953479 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:18:49.956060 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:18:49.965345 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:18:49.967414 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:18:49.969108 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: BEGIN
[0m17:18:49.970589 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.972868 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:18:49.974479 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m17:18:49.975946 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:49.978357 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:18:49.980026 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:18:49.981568 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"
[0m17:18:49.983274 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m17:18:49.984913 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m17:18:49.986676 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:18:49.988324 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:49.990003 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:18:50.001596 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:18:50.003910 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:18:50.005720 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:18:50.007325 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m17:18:50.009438 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: ROLLBACK
[0m17:18:50.011653 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:18:50.013739 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:18:50.030870 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182'
[0m17:18:50.032536 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182: Close
[0m17:18:50.048039 [debug] [Thread-2 (]: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "period_check"
  
  LINE 18: where not(period_check period_check between 1 and 14)
                                  ^
[0m17:18:50.049944 [error] [Thread-2 (]: 8 of 52 ERROR dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14  [[31mERROR[0m in 0.21s]
[0m17:18:50.052878 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182
[0m17:18:50.054496 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:18:50.056611 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182' to be skipped because of status 'error'.  Reason: Runtime Error in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "period_check"
  
  LINE 18: where not(period_check period_check between 1 and 14)
                                  ^.
[0m17:18:50.058202 [info ] [Thread-2 (]: 11 of 52 START test not_null_int__price_changes_gain ........................... [RUN]
[0m17:18:50.060616 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14.ebfb5cd182, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m17:18:50.062303 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:18:50.076846 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:18:50.080253 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:18:50.088469 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:18:50.091836 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:18:50.094072 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m17:18:50.096658 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:50.100750 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:18:50.102210 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:18:50.103685 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:18:50.114206 [debug] [Thread-1 (]: SQL status: OK in 0.179 seconds
[0m17:18:50.120122 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m17:18:50.122087 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m17:18:50.123211 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m17:18:50.125685 [info ] [Thread-1 (]: 7 of 52 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 .......... [[32mPASS[0m in 0.39s]
[0m17:18:50.128498 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:18:50.129747 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:18:50.130911 [debug] [Thread-3 (]: SQL status: OK in 0.122 seconds
[0m17:18:50.132059 [info ] [Thread-1 (]: 12 of 52 START test not_null_int__price_changes_loaded_at ...................... [RUN]
[0m17:18:50.133965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m17:18:50.135112 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:18:50.145569 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:18:50.149911 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m17:18:50.151613 [debug] [Thread-4 (]: SQL status: OK in 0.134 seconds
[0m17:18:50.153471 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m17:18:50.155063 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m17:18:50.156628 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:18:50.161274 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m17:18:50.169292 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:18:50.171249 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m17:18:50.162284 [info ] [Thread-3 (]: 9 of 52 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.32s]
[0m17:18:50.173441 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m17:18:50.175851 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:18:50.177044 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m17:18:50.178521 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:18:50.182322 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m17:18:50.183828 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:18:50.185324 [info ] [Thread-3 (]: 13 of 52 START test not_null_int__price_changes_loss ........................... [RUN]
[0m17:18:50.189116 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m17:18:50.190387 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m17:18:50.187636 [info ] [Thread-4 (]: 10 of 52 PASS not_null_int__price_changes_close ................................ [[32mPASS[0m in 0.32s]
[0m17:18:50.192052 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m17:18:50.193304 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m17:18:50.194507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:50.196258 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:18:50.197412 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:18:50.199423 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:18:50.201230 [info ] [Thread-2 (]: 11 of 52 PASS not_null_int__price_changes_gain ................................. [[32mPASS[0m in 0.14s]
[0m17:18:50.204548 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:18:50.213586 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:18:50.216655 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:18:50.214816 [info ] [Thread-4 (]: 14 of 52 START test not_null_int__price_changes_rn ............................. [RUN]
[0m17:18:50.218475 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:18:50.220417 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:18:50.221923 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m17:18:50.223244 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:18:50.225922 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:18:50.227369 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:18:50.224559 [info ] [Thread-2 (]: 15 of 52 START test not_null_int__price_changes_ticker ......................... [RUN]
[0m17:18:50.236281 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:18:50.247026 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:18:50.248240 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m17:18:50.250212 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:18:50.261013 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:18:50.263214 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:18:50.264851 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:18:50.266074 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m17:18:50.272732 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:18:50.274183 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:50.276012 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:18:50.283090 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:18:50.284603 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:18:50.285753 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m17:18:50.286842 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:50.288369 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m17:18:50.289509 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:18:50.290638 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:18:50.292454 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:18:50.293719 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:18:50.294831 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:18:50.296027 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m17:18:50.297284 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:18:50.298495 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:50.302274 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:18:50.303921 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:18:50.305305 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:18:50.315423 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m17:18:50.321315 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m17:18:50.322990 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m17:18:50.324005 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m17:18:50.326348 [info ] [Thread-1 (]: 12 of 52 PASS not_null_int__price_changes_loaded_at ............................ [[32mPASS[0m in 0.19s]
[0m17:18:50.328500 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:18:50.329670 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:18:50.330779 [info ] [Thread-1 (]: 16 of 52 START test not_null_int__price_changes_trade_date ..................... [RUN]
[0m17:18:50.332287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m17:18:50.333399 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:18:50.344236 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:18:50.346948 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:18:50.352843 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:18:50.355256 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:18:50.356419 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m17:18:50.357401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:50.360349 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:18:50.361357 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:18:50.362363 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:18:50.382031 [debug] [Thread-3 (]: SQL status: OK in 0.090 seconds
[0m17:18:50.383326 [debug] [Thread-4 (]: SQL status: OK in 0.084 seconds
[0m17:18:50.384601 [debug] [Thread-2 (]: SQL status: OK in 0.078 seconds
[0m17:18:50.389120 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m17:18:50.392703 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m17:18:50.396904 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m17:18:50.398696 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m17:18:50.400552 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m17:18:50.402169 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m17:18:50.403461 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m17:18:50.404682 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m17:18:50.406190 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m17:18:50.407850 [info ] [Thread-3 (]: 13 of 52 PASS not_null_int__price_changes_loss ................................. [[32mPASS[0m in 0.22s]
[0m17:18:50.409992 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:18:50.410917 [info ] [Thread-4 (]: 14 of 52 PASS not_null_int__price_changes_rn ................................... [[32mPASS[0m in 0.19s]
[0m17:18:50.415670 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:18:50.413341 [info ] [Thread-2 (]: 15 of 52 PASS not_null_int__price_changes_ticker ............................... [[32mPASS[0m in 0.16s]
[0m17:18:50.418077 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:18:50.426963 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m17:18:50.433010 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m17:18:50.434820 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m17:18:50.435852 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m17:18:50.438259 [info ] [Thread-1 (]: 16 of 52 PASS not_null_int__price_changes_trade_date ........................... [[32mPASS[0m in 0.11s]
[0m17:18:50.440356 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:18:50.442154 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m17:18:50.443583 [info ] [Thread-3 (]: 17 of 52 SKIP relation analytics_dev.int__rsi_sma .............................. [[33mSKIP[0m]
[0m17:18:50.445935 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m17:18:50.447766 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_sma' to be skipped because of status 'skipped'. 
[0m17:18:50.451057 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:18:50.453589 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:18:50.454896 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:18:50.457252 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14.52086331c6
[0m17:18:50.456200 [info ] [Thread-3 (]: 21 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ...... [[33mSKIP[0m]
[0m17:18:50.458988 [info ] [Thread-4 (]: 18 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_gain___0 .......... [[33mSKIP[0m]
[0m17:18:50.460824 [info ] [Thread-2 (]: 19 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_loss___0 .......... [[33mSKIP[0m]
[0m17:18:50.463724 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:18:50.465103 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:18:50.462072 [info ] [Thread-1 (]: 20 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14  [[33mSKIP[0m]
[0m17:18:50.466689 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:18:50.468286 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:18:50.469440 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9' to be skipped because of status 'skipped'. 
[0m17:18:50.470740 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:18:50.472390 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14.52086331c6
[0m17:18:50.474646 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:18:50.477485 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6' to be skipped because of status 'skipped'. 
[0m17:18:50.476226 [info ] [Thread-3 (]: 22 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ...... [[33mSKIP[0m]
[0m17:18:50.480446 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:18:50.479215 [info ] [Thread-4 (]: 23 of 52 SKIP test dbt_utils_not_null_where_int__rsi_sma_sma_gain .............. [[33mSKIP[0m]
[0m17:18:50.483268 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62' to be skipped because of status 'skipped'. 
[0m17:18:50.482106 [info ] [Thread-2 (]: 24 of 52 SKIP test dbt_utils_not_null_where_int__rsi_sma_sma_loss .............. [[33mSKIP[0m]
[0m17:18:50.484986 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:18:50.487554 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:18:50.486377 [info ] [Thread-1 (]: 25 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [[33mSKIP[0m]
[0m17:18:50.489130 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__period_check_between_1_and_14.52086331c6' to be skipped because of status 'skipped'. 
[0m17:18:50.490427 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:18:50.491701 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:18:50.493352 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:18:50.494932 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:18:50.496339 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21' to be skipped because of status 'skipped'. 
[0m17:18:50.497730 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:18:50.498982 [info ] [Thread-3 (]: 26 of 52 SKIP test not_null_int__rsi_sma_close ................................. [[33mSKIP[0m]
[0m17:18:50.502030 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:18:50.503446 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e' to be skipped because of status 'skipped'. 
[0m17:18:50.500148 [info ] [Thread-4 (]: 27 of 52 SKIP test not_null_int__rsi_sma_gain .................................. [[33mSKIP[0m]
[0m17:18:50.506435 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:18:50.505238 [info ] [Thread-2 (]: 28 of 52 SKIP test not_null_int__rsi_sma_loaded_at ............................. [[33mSKIP[0m]
[0m17:18:50.509266 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d' to be skipped because of status 'skipped'. 
[0m17:18:50.508093 [info ] [Thread-1 (]: 29 of 52 SKIP test not_null_int__rsi_sma_loss .................................. [[33mSKIP[0m]
[0m17:18:50.510832 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:18:50.512201 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:18:50.513481 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:18:50.514735 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08' to be skipped because of status 'skipped'. 
[0m17:18:50.516016 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:18:50.517648 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:18:50.520433 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:18:50.519166 [info ] [Thread-3 (]: 30 of 52 SKIP test not_null_int__rsi_sma_rn .................................... [[33mSKIP[0m]
[0m17:18:50.522237 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b' to be skipped because of status 'skipped'. 
[0m17:18:50.526470 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:18:50.523886 [info ] [Thread-4 (]: 31 of 52 SKIP test not_null_int__rsi_sma_ticker ................................ [[33mSKIP[0m]
[0m17:18:50.528100 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953' to be skipped because of status 'skipped'. 
[0m17:18:50.525068 [info ] [Thread-2 (]: 32 of 52 SKIP test not_null_int__rsi_sma_trade_date ............................ [[33mSKIP[0m]
[0m17:18:50.530149 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:18:50.531612 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0' to be skipped because of status 'skipped'. 
[0m17:18:50.532904 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:18:50.534784 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065' to be skipped because of status 'skipped'. 
[0m17:18:50.536172 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139' to be skipped because of status 'skipped'. 
[0m17:18:50.537261 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d' to be skipped because of status 'skipped'. 
[0m17:18:50.538339 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0' to be skipped because of status 'skipped'. 
[0m17:18:50.539977 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m17:18:50.541197 [info ] [Thread-1 (]: 33 of 52 SKIP relation analytics_dev.int__rsi_wilder ........................... [[33mSKIP[0m]
[0m17:18:50.543675 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m17:18:50.545552 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_wilder' to be skipped because of status 'skipped'. 
[0m17:18:50.548043 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:18:50.549443 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:18:50.550679 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:18:50.553080 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:18:50.551894 [info ] [Thread-1 (]: 37 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [[33mSKIP[0m]
[0m17:18:50.554807 [info ] [Thread-3 (]: 34 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ....... [[33mSKIP[0m]
[0m17:18:50.559123 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:18:50.556447 [info ] [Thread-2 (]: 36 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [[33mSKIP[0m]
[0m17:18:50.560807 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:18:50.557908 [info ] [Thread-4 (]: 35 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ....... [[33mSKIP[0m]
[0m17:18:50.562475 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:18:50.563558 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d' to be skipped because of status 'skipped'. 
[0m17:18:50.564755 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:18:50.566012 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:18:50.567733 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:18:50.570705 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90' to be skipped because of status 'skipped'. 
[0m17:18:50.569311 [info ] [Thread-1 (]: 38 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[33mSKIP[0m]
[0m17:18:50.572559 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:18:50.575210 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:18:50.573889 [info ] [Thread-3 (]: 39 of 52 SKIP test not_null_int__rsi_wilder_gain ............................... [[33mSKIP[0m]
[0m17:18:50.577270 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7' to be skipped because of status 'skipped'. 
[0m17:18:50.578652 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:18:50.580004 [info ] [Thread-2 (]: 40 of 52 SKIP test not_null_int__rsi_wilder_loss ............................... [[33mSKIP[0m]
[0m17:18:50.582857 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:18:50.584212 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703' to be skipped because of status 'skipped'. 
[0m17:18:50.581199 [info ] [Thread-4 (]: 41 of 52 SKIP test not_null_int__rsi_wilder_rn ................................. [[33mSKIP[0m]
[0m17:18:50.585876 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:18:50.587137 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:18:50.588393 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:18:50.589615 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95' to be skipped because of status 'skipped'. 
[0m17:18:50.590892 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:18:50.593572 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:18:50.592292 [info ] [Thread-1 (]: 42 of 52 SKIP test not_null_int__rsi_wilder_ticker ............................. [[33mSKIP[0m]
[0m17:18:50.596601 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda' to be skipped because of status 'skipped'. 
[0m17:18:50.594929 [info ] [Thread-3 (]: 43 of 52 SKIP test not_null_int__rsi_wilder_trade_date ......................... [[33mSKIP[0m]
[0m17:18:50.598362 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:18:50.600926 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:18:50.599699 [info ] [Thread-2 (]: 44 of 52 SKIP test not_null_int__rsi_wilder_wilder_gain ........................ [[33mSKIP[0m]
[0m17:18:50.602752 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56' to be skipped because of status 'skipped'. 
[0m17:18:50.604103 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:18:50.606586 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:18:50.607930 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:18:50.605382 [info ] [Thread-4 (]: 45 of 52 SKIP test not_null_int__rsi_wilder_wilder_loss ........................ [[33mSKIP[0m]
[0m17:18:50.609476 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d' to be skipped because of status 'skipped'. 
[0m17:18:50.610998 [info ] [Thread-1 (]: 46 of 52 SKIP test wilder_seed_equals_sma ...................................... [[33mSKIP[0m]
[0m17:18:50.612687 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:18:50.614152 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd' to be skipped because of status 'skipped'. 
[0m17:18:50.615605 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:18:50.617062 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c' to be skipped because of status 'skipped'. 
[0m17:18:50.618740 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9' to be skipped because of status 'skipped'. 
[0m17:18:50.619819 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb' to be skipped because of status 'skipped'. 
[0m17:18:50.620876 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.wilder_seed_equals_sma' to be skipped because of status 'skipped'. 
[0m17:18:50.622717 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.fct__rsi
[0m17:18:50.624004 [info ] [Thread-3 (]: 47 of 52 SKIP relation analytics_dev.fct__rsi .................................. [[33mSKIP[0m]
[0m17:18:50.625991 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m17:18:50.627286 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'skipped'. 
[0m17:18:50.629335 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:18:50.630520 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:18:50.631629 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:18:50.632880 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:18:50.634396 [info ] [Thread-4 (]: 49 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[33mSKIP[0m]
[0m17:18:50.635648 [info ] [Thread-2 (]: 48 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[33mSKIP[0m]
[0m17:18:50.640234 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:18:50.642025 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:18:50.637352 [info ] [Thread-1 (]: 50 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............ [[33mSKIP[0m]
[0m17:18:50.644085 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:18:50.645234 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2' to be skipped because of status 'skipped'. 
[0m17:18:50.638700 [info ] [Thread-3 (]: 51 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ......... [[33mSKIP[0m]
[0m17:18:50.647302 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:18:50.649737 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a' to be skipped because of status 'skipped'. 
[0m17:18:50.648645 [info ] [Thread-4 (]: 52 of 52 SKIP test dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker  [[33mSKIP[0m]
[0m17:18:50.651461 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:18:50.652752 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a' to be skipped because of status 'skipped'. 
[0m17:18:50.654028 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:18:50.655371 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0' to be skipped because of status 'skipped'. 
[0m17:18:50.656728 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400' to be skipped because of status 'skipped'. 
[0m17:18:50.660465 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:50.661477 [debug] [MainThread]: On master: BEGIN
[0m17:18:50.662372 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:18:50.665217 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:18:50.666217 [debug] [MainThread]: On master: COMMIT
[0m17:18:50.667121 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:50.667991 [debug] [MainThread]: On master: COMMIT
[0m17:18:50.669740 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:18:50.670690 [debug] [MainThread]: On master: Close
[0m17:18:50.671789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:50.672593 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:18:50.673345 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:18:50.674103 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5' was properly closed.
[0m17:18:50.674856 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a' was properly closed.
[0m17:18:50.675604 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa' was properly closed.
[0m17:18:50.676361 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638' was properly closed.
[0m17:18:50.677377 [info ] [MainThread]: 
[0m17:18:50.678658 [info ] [MainThread]: Finished running 47 data tests, 5 view models in 0 hours 0 minutes and 4.80 seconds (4.80s).
[0m17:18:50.694596 [debug] [MainThread]: Command end result
[0m17:18:50.807247 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:18:50.810798 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:18:50.821656 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:18:50.822212 [info ] [MainThread]: 
[0m17:18:50.823023 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:18:50.823825 [info ] [MainThread]: 
[0m17:18:50.824737 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)[0m
[0m17:18:50.825669 [error] [MainThread]:   Runtime Error in test dbt_utils_expression_is_true_int__price_changes_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near ")"
  
  LINE 24:     ) dbt_internal_test
               ^
[0m17:18:50.826533 [info ] [MainThread]: 
[0m17:18:50.827392 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\silver_schema.yml\dbt_utils_expression_is_true_i_42ddde861532075e91a49918f22e3300.sql
[0m17:18:50.828227 [info ] [MainThread]: 
[0m17:18:50.829032 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)[0m
[0m17:18:50.829982 [error] [MainThread]:   Runtime Error in test dbt_utils_expression_is_true_int__price_changes_period_check__period_check_between_1_and_14 (models\silver\silver_schema.yml)
  Parser Error: syntax error at or near "period_check"
  
  LINE 18: where not(period_check period_check between 1 and 14)
                                  ^
[0m17:18:50.830887 [info ] [MainThread]: 
[0m17:18:50.831788 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\silver_schema.yml\dbt_utils_expression_is_true_i_02fc6d0de4be0787745a8150f25c1081.sql
[0m17:18:50.832680 [info ] [MainThread]: 
[0m17:18:50.833603 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=2 SKIP=36 NO-OP=0 TOTAL=52
[0m17:18:50.835142 [debug] [MainThread]: Command `-c build` failed at 17:18:50.834928 after 7.72 seconds
[0m17:18:50.835845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67B0F7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67B034190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67B034550>]}
[0m17:18:50.836480 [debug] [MainThread]: Flushing usage events
[0m17:18:51.777236 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:20:08.802366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EEF6D8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EEFEE42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF0527ED0>]}


============================== 17:20:08.817756 | 230c252a-5bec-4e98-b77f-9189ed750040 ==============================
[0m17:20:08.817756 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:20:08.820264 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt build --select +fct__rsi', 'printer_width': '80', 'target_path': 'None'}
[0m17:20:09.316176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '230c252a-5bec-4e98-b77f-9189ed750040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EEF890180>]}
[0m17:20:09.407236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '230c252a-5bec-4e98-b77f-9189ed750040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF03CB790>]}
[0m17:20:09.410694 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:20:09.852146 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:20:10.246851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:20:10.248486 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\silver_schema.yml
[0m17:20:11.150876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '230c252a-5bec-4e98-b77f-9189ed750040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF1D6DD50>]}
[0m17:20:11.367233 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:20:11.372395 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:20:11.510884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '230c252a-5bec-4e98-b77f-9189ed750040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF1FD1C70>]}
[0m17:20:11.512176 [info ] [MainThread]: Found 6 models, 47 data tests, 2 sources, 853 macros
[0m17:20:11.522454 [info ] [MainThread]: 
[0m17:20:11.523488 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:20:11.524441 [info ] [MainThread]: 
[0m17:20:11.525677 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:20:11.536229 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:20:11.729164 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:20:11.729665 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:20:11.730083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:13.255570 [debug] [ThreadPool]: SQL status: OK in 1.525 seconds
[0m17:20:13.260619 [debug] [ThreadPool]: On list_finance: Close
[0m17:20:13.263268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:20:13.265113 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:20:13.281251 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:20:13.282107 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:20:13.282779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:13.285706 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:20:13.288009 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:20:13.288564 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:20:13.290124 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:20:13.290675 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:20:13.291202 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:20:13.345693 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m17:20:13.350133 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:20:13.351699 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:20:13.353303 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:20:13.407666 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m17:20:13.409147 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:20:13.415355 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:20:13.436471 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:20:13.437968 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:20:13.439123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:13.443067 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:20:13.443969 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:20:13.444858 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:20:13.507608 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m17:20:13.511115 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:20:13.513676 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:20:13.514491 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:20:13.518986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '230c252a-5bec-4e98-b77f-9189ed750040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF20B73F0>]}
[0m17:20:13.520194 [debug] [MainThread]: Using duckdb connection "master"
[0m17:20:13.520994 [debug] [MainThread]: On master: BEGIN
[0m17:20:13.521747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:20:13.524501 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:20:13.525374 [debug] [MainThread]: On master: COMMIT
[0m17:20:13.526212 [debug] [MainThread]: Using duckdb connection "master"
[0m17:20:13.527017 [debug] [MainThread]: On master: COMMIT
[0m17:20:13.528651 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:20:13.529493 [debug] [MainThread]: On master: Close
[0m17:20:13.541224 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m17:20:13.543092 [info ] [Thread-1 (]: 1 of 52 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m17:20:13.545575 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m17:20:13.547074 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m17:20:13.574994 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m17:20:13.578933 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m17:20:13.691045 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m17:20:13.693461 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:20:13.694511 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m17:20:13.695323 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:20:13.698018 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:20:13.698840 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:20:13.699752 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:20:13.758723 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m17:20:13.780837 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:20:13.782388 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m17:20:13.840817 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m17:20:13.853651 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:20:13.855119 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m17:20:13.925346 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m17:20:13.969861 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:20:13.971289 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:20:13.972560 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:20:14.124273 [debug] [Thread-1 (]: SQL status: OK in 0.150 seconds
[0m17:20:14.146847 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:20:14.148379 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m17:20:14.267179 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m17:20:14.276220 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m17:20:14.283553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '230c252a-5bec-4e98-b77f-9189ed750040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF25032B0>]}
[0m17:20:14.285895 [info ] [Thread-1 (]: 1 of 52 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.73s]
[0m17:20:14.288944 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m17:20:14.291538 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m17:20:14.293588 [info ] [Thread-2 (]: 2 of 52 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m17:20:14.296286 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m17:20:14.297862 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m17:20:14.307996 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m17:20:14.311566 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m17:20:14.324467 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m17:20:14.327933 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:20:14.329461 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m17:20:14.330891 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:20:14.335247 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:20:14.336910 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:20:14.339155 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:20:14.557082 [debug] [Thread-2 (]: SQL status: OK in 0.216 seconds
[0m17:20:14.568642 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:20:14.570122 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m17:20:14.636121 [debug] [Thread-2 (]: SQL status: OK in 0.064 seconds
[0m17:20:14.656623 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:20:14.658354 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m17:20:14.718277 [debug] [Thread-2 (]: SQL status: OK in 0.058 seconds
[0m17:20:14.723891 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:20:14.725569 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:20:14.727158 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:20:14.845366 [debug] [Thread-2 (]: SQL status: OK in 0.116 seconds
[0m17:20:14.856531 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:20:14.858143 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m17:20:15.050303 [debug] [Thread-2 (]: SQL status: OK in 0.190 seconds
[0m17:20:15.055873 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m17:20:15.061509 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '230c252a-5bec-4e98-b77f-9189ed750040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF20FB650>]}
[0m17:20:15.063913 [info ] [Thread-2 (]: 2 of 52 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.77s]
[0m17:20:15.066888 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m17:20:15.070292 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:20:15.071908 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:20:15.073480 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06
[0m17:20:15.075144 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:20:15.076838 [info ] [Thread-3 (]: 3 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m17:20:15.078589 [info ] [Thread-4 (]: 4 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m17:20:15.084989 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:20:15.080917 [info ] [Thread-1 (]: 5 of 52 START test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [RUN]
[0m17:20:15.087547 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:20:15.089397 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:20:15.082908 [info ] [Thread-2 (]: 6 of 52 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .... [RUN]
[0m17:20:15.091577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06)
[0m17:20:15.093290 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:20:15.109726 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:20:15.111800 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m17:20:15.113837 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06
[0m17:20:15.133867 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:20:15.136356 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:20:15.154161 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06"
[0m17:20:15.172669 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:20:15.175198 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:20:15.177703 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:20:15.278846 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:20:15.309132 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:20:15.312029 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:20:15.313590 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06
[0m17:20:15.319752 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:20:15.329496 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06"
[0m17:20:15.332812 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:20:15.334581 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m17:20:15.336388 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:20:15.338205 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:20:15.340169 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m17:20:15.342989 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:20:15.344846 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:20:15.346924 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m17:20:15.348868 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m17:20:15.351296 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06"
[0m17:20:15.353130 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:20:15.355041 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:20:15.356855 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m17:20:15.358557 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06: BEGIN
[0m17:20:15.361382 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m17:20:15.363394 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:20:15.365201 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m17:20:15.366838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:15.369397 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:20:15.371402 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:20:15.374959 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m17:20:15.378552 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:20:15.380278 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06"
[0m17:20:15.382003 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(abs(delta) - (gain + loss)) > 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:20:15.508213 [debug] [Thread-4 (]: SQL status: OK in 0.130 seconds
[0m17:20:15.510028 [debug] [Thread-3 (]: SQL status: OK in 0.141 seconds
[0m17:20:15.511953 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m17:20:15.513717 [debug] [Thread-2 (]: SQL status: OK in 0.140 seconds
[0m17:20:15.526728 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m17:20:15.532274 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m17:20:15.537690 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06: ROLLBACK
[0m17:20:15.543081 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m17:20:15.546133 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:20:15.548943 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m17:20:15.551494 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06'
[0m17:20:15.553815 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:20:15.555374 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m17:20:15.556986 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m17:20:15.558646 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06: Close
[0m17:20:15.560301 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m17:20:15.563707 [info ] [Thread-4 (]: 4 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.48s]
[0m17:20:15.572613 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:20:15.565724 [info ] [Thread-2 (]: 6 of 52 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 .......... [[32mPASS[0m in 0.45s]
[0m17:20:15.575125 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:20:15.567868 [info ] [Thread-3 (]: 3 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.48s]
[0m17:20:15.579058 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:20:15.569889 [error] [Thread-1 (]: 5 of 52 FAIL 1265 dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[31mFAIL 1265[0m in 0.48s]
[0m17:20:15.586651 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:20:15.590363 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:20:15.594225 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06
[0m17:20:15.581686 [info ] [Thread-4 (]: 7 of 52 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .... [RUN]
[0m17:20:15.596801 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:20:15.601748 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06' to be skipped because of status 'fail'.  Reason: Got 1265 results, configured to fail if != 0.
[0m17:20:15.604045 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m17:20:15.598893 [info ] [Thread-2 (]: 8 of 52 START test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [RUN]
[0m17:20:15.606564 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:20:15.610070 [info ] [Thread-3 (]: 9 of 52 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m17:20:15.613738 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:20:15.615735 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96)
[0m17:20:15.618034 [info ] [Thread-1 (]: 10 of 52 START test not_null_int__price_changes_close .......................... [RUN]
[0m17:20:15.620698 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m17:20:15.645320 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:20:15.647318 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:20:15.649319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.5ab469ae06, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m17:20:15.651775 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:20:15.671235 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:20:15.673080 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:20:15.690814 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:20:15.693564 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:20:15.721119 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:20:15.724385 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:20:15.734747 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:20:15.744794 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:20:15.748073 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:20:15.758310 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:20:15.760193 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:20:15.774628 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:20:15.776597 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:20:15.778961 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:20:15.781374 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m17:20:15.783538 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:20:15.785234 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: BEGIN
[0m17:20:15.787136 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:20:15.789058 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m17:20:15.791085 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:20:15.792769 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:20:15.795282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:15.797441 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m17:20:15.799281 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m17:20:15.802282 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:20:15.806400 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:20:15.804104 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:20:15.808461 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:20:15.810163 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m17:20:15.811911 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:20:15.813641 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:20:15.815572 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:20:15.817442 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:20:15.819189 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:20:15.822434 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:20:15.824397 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:20:15.959107 [debug] [Thread-1 (]: SQL status: OK in 0.137 seconds
[0m17:20:15.961107 [debug] [Thread-4 (]: SQL status: OK in 0.140 seconds
[0m17:20:15.963156 [debug] [Thread-2 (]: SQL status: OK in 0.137 seconds
[0m17:20:15.964827 [debug] [Thread-3 (]: SQL status: OK in 0.138 seconds
[0m17:20:15.970640 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m17:20:15.976125 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m17:20:15.981398 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: ROLLBACK
[0m17:20:15.984563 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m17:20:15.987044 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m17:20:15.993056 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m17:20:15.995424 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96'
[0m17:20:15.997119 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m17:20:15.998893 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m17:20:16.001522 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m17:20:16.003296 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: Close
[0m17:20:16.005620 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m17:20:16.008584 [info ] [Thread-4 (]: 7 of 52 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 .......... [[32mPASS[0m in 0.40s]
[0m17:20:16.016126 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:20:16.017940 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:20:16.010748 [info ] [Thread-1 (]: 10 of 52 PASS not_null_int__price_changes_close ................................ [[32mPASS[0m in 0.36s]
[0m17:20:16.025311 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:20:16.026988 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:20:16.012879 [info ] [Thread-2 (]: 8 of 52 PASS dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[32mPASS[0m in 0.40s]
[0m17:20:16.032062 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:20:16.020849 [info ] [Thread-3 (]: 9 of 52 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.40s]
[0m17:20:16.034385 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:20:16.038156 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:20:16.022406 [info ] [Thread-4 (]: 11 of 52 START test not_null_int__price_changes_gain ........................... [RUN]
[0m17:20:16.042207 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:20:16.044243 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m17:20:16.029474 [info ] [Thread-1 (]: 12 of 52 START test not_null_int__price_changes_loaded_at ...................... [RUN]
[0m17:20:16.039951 [info ] [Thread-2 (]: 13 of 52 START test not_null_int__price_changes_loss ........................... [RUN]
[0m17:20:16.049184 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:20:16.047001 [info ] [Thread-3 (]: 14 of 52 START test not_null_int__price_changes_rn ............................. [RUN]
[0m17:20:16.051475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m17:20:16.054244 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m17:20:16.069859 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m17:20:16.073991 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:20:16.075855 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:20:16.077679 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:20:16.079652 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:20:16.123979 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:20:16.108746 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:20:16.141658 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:20:16.144935 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:20:16.154929 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:20:16.157793 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:20:16.159657 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:20:16.162238 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:20:16.171489 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:20:16.181595 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:20:16.183526 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:20:16.192219 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:20:16.195274 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m17:20:16.198097 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:20:16.200737 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:20:16.202468 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m17:20:16.204041 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:20:16.206493 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:20:16.208305 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m17:20:16.210206 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m17:20:16.211971 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:20:16.213620 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:20:16.215422 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:20:16.217177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:16.218909 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:20:16.220697 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:20:16.222569 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m17:20:16.225268 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:20:16.227835 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:20:16.229574 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:20:16.232501 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:20:16.234155 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:20:16.236282 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m17:20:16.237965 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:20:16.239622 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:20:16.451836 [debug] [Thread-4 (]: SQL status: OK in 0.225 seconds
[0m17:20:16.453755 [debug] [Thread-3 (]: SQL status: OK in 0.212 seconds
[0m17:20:16.455499 [debug] [Thread-2 (]: SQL status: OK in 0.224 seconds
[0m17:20:16.457705 [debug] [Thread-1 (]: SQL status: OK in 0.222 seconds
[0m17:20:16.463346 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m17:20:16.468893 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m17:20:16.474196 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m17:20:16.479657 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m17:20:16.482347 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m17:20:16.484857 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m17:20:16.487682 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m17:20:16.490173 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m17:20:16.491803 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m17:20:16.493576 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m17:20:16.495336 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m17:20:16.497097 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m17:20:16.500656 [info ] [Thread-4 (]: 11 of 52 PASS not_null_int__price_changes_gain ................................. [[32mPASS[0m in 0.46s]
[0m17:20:16.509976 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:20:16.502783 [info ] [Thread-2 (]: 13 of 52 PASS not_null_int__price_changes_loss ................................. [[32mPASS[0m in 0.45s]
[0m17:20:16.512504 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:20:16.504907 [info ] [Thread-1 (]: 12 of 52 PASS not_null_int__price_changes_loaded_at ............................ [[32mPASS[0m in 0.45s]
[0m17:20:16.516120 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:20:16.507510 [info ] [Thread-3 (]: 14 of 52 PASS not_null_int__price_changes_rn ................................... [[32mPASS[0m in 0.44s]
[0m17:20:16.521915 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:20:16.524576 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:20:16.518218 [info ] [Thread-4 (]: 15 of 52 START test not_null_int__price_changes_ticker ......................... [RUN]
[0m17:20:16.528299 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:20:16.532985 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m17:20:16.531172 [info ] [Thread-2 (]: 16 of 52 START test not_null_int__price_changes_trade_date ..................... [RUN]
[0m17:20:16.535928 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:20:16.538348 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m17:20:16.556792 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:20:16.558554 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:20:16.575034 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:20:16.577688 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:20:16.588053 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:20:16.591480 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:20:16.603217 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:20:16.605585 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:20:16.607201 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m17:20:16.608732 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:20:16.612256 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:20:16.613976 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m17:20:16.615563 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m17:20:16.617203 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:20:16.618988 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:20:16.621556 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:20:16.624825 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:20:16.626539 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:20:16.628269 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:20:16.690097 [debug] [Thread-4 (]: SQL status: OK in 0.066 seconds
[0m17:20:16.698961 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m17:20:16.701640 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m17:20:16.703177 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m17:20:16.706633 [info ] [Thread-4 (]: 15 of 52 PASS not_null_int__price_changes_ticker ............................... [[32mPASS[0m in 0.17s]
[0m17:20:16.709824 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:20:16.716662 [debug] [Thread-2 (]: SQL status: OK in 0.086 seconds
[0m17:20:16.725946 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m17:20:16.728560 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m17:20:16.730127 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m17:20:16.733813 [info ] [Thread-2 (]: 16 of 52 PASS not_null_int__price_changes_trade_date ........................... [[32mPASS[0m in 0.20s]
[0m17:20:16.737110 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:20:16.739738 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m17:20:16.742200 [info ] [Thread-1 (]: 17 of 52 SKIP relation analytics_dev.int__rsi_sma .............................. [[33mSKIP[0m]
[0m17:20:16.744919 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m17:20:16.746699 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_sma' to be skipped because of status 'skipped'. 
[0m17:20:16.751174 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:20:16.754126 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:20:16.756794 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:20:16.759813 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:20:16.758831 [info ] [Thread-1 (]: 21 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ...... [[33mSKIP[0m]
[0m17:20:16.761994 [info ] [Thread-4 (]: 19 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_loss___0 .......... [[33mSKIP[0m]
[0m17:20:16.768856 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:20:16.764371 [info ] [Thread-2 (]: 20 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[33mSKIP[0m]
[0m17:20:16.771386 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:20:16.774054 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:20:16.776234 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9' to be skipped because of status 'skipped'. 
[0m17:20:16.766968 [info ] [Thread-3 (]: 18 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_gain___0 .......... [[33mSKIP[0m]
[0m17:20:16.778637 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:20:16.780621 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:20:16.782732 [info ] [Thread-1 (]: 22 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ...... [[33mSKIP[0m]
[0m17:20:16.785290 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62' to be skipped because of status 'skipped'. 
[0m17:20:16.787269 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:20:16.789540 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:20:16.793606 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:20:16.795570 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704' to be skipped because of status 'skipped'. 
[0m17:20:16.791795 [info ] [Thread-4 (]: 23 of 52 SKIP test dbt_utils_not_null_where_int__rsi_sma_sma_gain .............. [[33mSKIP[0m]
[0m17:20:16.798474 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:20:16.802208 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:20:16.800419 [info ] [Thread-2 (]: 24 of 52 SKIP test dbt_utils_not_null_where_int__rsi_sma_sma_loss .............. [[33mSKIP[0m]
[0m17:20:16.804630 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6' to be skipped because of status 'skipped'. 
[0m17:20:16.806630 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:20:16.808639 [info ] [Thread-3 (]: 25 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [[33mSKIP[0m]
[0m17:20:16.812651 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:20:16.815153 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21' to be skipped because of status 'skipped'. 
[0m17:20:16.810447 [info ] [Thread-1 (]: 26 of 52 SKIP test not_null_int__rsi_sma_close ................................. [[33mSKIP[0m]
[0m17:20:16.817510 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:20:16.819492 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:20:16.821534 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:20:16.823704 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e' to be skipped because of status 'skipped'. 
[0m17:20:16.826198 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:20:16.830077 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:20:16.828244 [info ] [Thread-4 (]: 27 of 52 SKIP test not_null_int__rsi_sma_gain .................................. [[33mSKIP[0m]
[0m17:20:16.834561 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d' to be skipped because of status 'skipped'. 
[0m17:20:16.832562 [info ] [Thread-2 (]: 28 of 52 SKIP test not_null_int__rsi_sma_loaded_at ............................. [[33mSKIP[0m]
[0m17:20:16.837377 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:20:16.841400 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:20:16.839338 [info ] [Thread-3 (]: 29 of 52 SKIP test not_null_int__rsi_sma_loss .................................. [[33mSKIP[0m]
[0m17:20:16.843747 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08' to be skipped because of status 'skipped'. 
[0m17:20:16.845794 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:20:16.850270 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:20:16.847826 [info ] [Thread-1 (]: 30 of 52 SKIP test not_null_int__rsi_sma_rn .................................... [[33mSKIP[0m]
[0m17:20:16.852778 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:20:16.854676 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b' to be skipped because of status 'skipped'. 
[0m17:20:16.857332 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:20:16.862509 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:20:16.860678 [info ] [Thread-4 (]: 31 of 52 SKIP test not_null_int__rsi_sma_ticker ................................ [[33mSKIP[0m]
[0m17:20:16.865360 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953' to be skipped because of status 'skipped'. 
[0m17:20:16.867337 [info ] [Thread-2 (]: 32 of 52 SKIP test not_null_int__rsi_sma_trade_date ............................ [[33mSKIP[0m]
[0m17:20:16.869938 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:20:16.871943 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0' to be skipped because of status 'skipped'. 
[0m17:20:16.874067 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:20:16.876345 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065' to be skipped because of status 'skipped'. 
[0m17:20:16.878471 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139' to be skipped because of status 'skipped'. 
[0m17:20:16.880180 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d' to be skipped because of status 'skipped'. 
[0m17:20:16.881861 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0' to be skipped because of status 'skipped'. 
[0m17:20:16.884407 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m17:20:16.886183 [info ] [Thread-3 (]: 33 of 52 SKIP relation analytics_dev.int__rsi_wilder ........................... [[33mSKIP[0m]
[0m17:20:16.888651 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m17:20:16.890785 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_wilder' to be skipped because of status 'skipped'. 
[0m17:20:16.894475 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:20:16.896458 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:20:16.898200 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:20:16.900034 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:20:16.901852 [info ] [Thread-3 (]: 37 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [[33mSKIP[0m]
[0m17:20:16.903756 [info ] [Thread-1 (]: 34 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ....... [[33mSKIP[0m]
[0m17:20:16.911437 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:20:16.907001 [info ] [Thread-2 (]: 36 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [[33mSKIP[0m]
[0m17:20:16.913970 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:20:16.916074 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:20:16.909526 [info ] [Thread-4 (]: 35 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ....... [[33mSKIP[0m]
[0m17:20:16.918545 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:20:16.920067 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d' to be skipped because of status 'skipped'. 
[0m17:20:16.922105 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:20:16.926600 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:20:16.924705 [info ] [Thread-3 (]: 38 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[33mSKIP[0m]
[0m17:20:16.929246 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:20:16.931400 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90' to be skipped because of status 'skipped'. 
[0m17:20:16.935877 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:20:16.933760 [info ] [Thread-1 (]: 39 of 52 SKIP test not_null_int__rsi_wilder_gain ............................... [[33mSKIP[0m]
[0m17:20:16.938317 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:20:16.942224 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7' to be skipped because of status 'skipped'. 
[0m17:20:16.940509 [info ] [Thread-2 (]: 40 of 52 SKIP test not_null_int__rsi_wilder_loss ............................... [[33mSKIP[0m]
[0m17:20:16.946555 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:20:16.944740 [info ] [Thread-4 (]: 41 of 52 SKIP test not_null_int__rsi_wilder_rn ................................. [[33mSKIP[0m]
[0m17:20:16.949267 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:20:16.951129 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703' to be skipped because of status 'skipped'. 
[0m17:20:16.953085 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:20:16.955024 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:20:16.957007 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:20:16.960763 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95' to be skipped because of status 'skipped'. 
[0m17:20:16.959084 [info ] [Thread-3 (]: 42 of 52 SKIP test not_null_int__rsi_wilder_ticker ............................. [[33mSKIP[0m]
[0m17:20:16.963187 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:20:16.967281 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:20:16.965520 [info ] [Thread-1 (]: 43 of 52 SKIP test not_null_int__rsi_wilder_trade_date ......................... [[33mSKIP[0m]
[0m17:20:16.969648 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda' to be skipped because of status 'skipped'. 
[0m17:20:16.971678 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:20:16.973659 [info ] [Thread-2 (]: 44 of 52 SKIP test not_null_int__rsi_wilder_wilder_gain ........................ [[33mSKIP[0m]
[0m17:20:16.977770 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:20:16.975497 [info ] [Thread-4 (]: 45 of 52 SKIP test not_null_int__rsi_wilder_wilder_loss ........................ [[33mSKIP[0m]
[0m17:20:16.979807 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56' to be skipped because of status 'skipped'. 
[0m17:20:16.982787 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:20:16.985152 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:20:16.987419 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:20:16.989274 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d' to be skipped because of status 'skipped'. 
[0m17:20:16.991255 [info ] [Thread-3 (]: 46 of 52 SKIP test wilder_seed_equals_sma ...................................... [[33mSKIP[0m]
[0m17:20:16.994339 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd' to be skipped because of status 'skipped'. 
[0m17:20:16.996393 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:20:16.998456 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c' to be skipped because of status 'skipped'. 
[0m17:20:17.000628 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9' to be skipped because of status 'skipped'. 
[0m17:20:17.002316 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb' to be skipped because of status 'skipped'. 
[0m17:20:17.003975 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.wilder_seed_equals_sma' to be skipped because of status 'skipped'. 
[0m17:20:17.006442 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m17:20:17.008516 [info ] [Thread-1 (]: 47 of 52 SKIP relation analytics_dev.fct__rsi .................................. [[33mSKIP[0m]
[0m17:20:17.011105 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m17:20:17.012822 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'skipped'. 
[0m17:20:17.016107 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:20:17.018040 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:20:17.019976 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:20:17.025059 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:20:17.022063 [info ] [Thread-3 (]: 50 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............ [[33mSKIP[0m]
[0m17:20:17.028953 [info ] [Thread-2 (]: 48 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[33mSKIP[0m]
[0m17:20:17.036209 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:20:17.031866 [info ] [Thread-1 (]: 51 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ......... [[33mSKIP[0m]
[0m17:20:17.038672 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:20:17.041524 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:20:17.043175 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a' to be skipped because of status 'skipped'. 
[0m17:20:17.034283 [info ] [Thread-4 (]: 49 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[33mSKIP[0m]
[0m17:20:17.045558 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:20:17.049630 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a' to be skipped because of status 'skipped'. 
[0m17:20:17.047968 [info ] [Thread-3 (]: 52 of 52 SKIP test dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker  [[33mSKIP[0m]
[0m17:20:17.052353 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:20:17.054540 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0' to be skipped because of status 'skipped'. 
[0m17:20:17.056897 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:20:17.059346 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2' to be skipped because of status 'skipped'. 
[0m17:20:17.061444 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400' to be skipped because of status 'skipped'. 
[0m17:20:17.066998 [debug] [MainThread]: Using duckdb connection "master"
[0m17:20:17.068426 [debug] [MainThread]: On master: BEGIN
[0m17:20:17.069688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:20:17.075162 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m17:20:17.077154 [debug] [MainThread]: On master: COMMIT
[0m17:20:17.078509 [debug] [MainThread]: Using duckdb connection "master"
[0m17:20:17.079800 [debug] [MainThread]: On master: COMMIT
[0m17:20:17.082392 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:20:17.083867 [debug] [MainThread]: On master: Close
[0m17:20:17.085524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:17.086733 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:20:17.087910 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:20:17.089105 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f' was properly closed.
[0m17:20:17.090278 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5' was properly closed.
[0m17:20:17.091434 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638' was properly closed.
[0m17:20:17.092579 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a' was properly closed.
[0m17:20:17.094148 [info ] [MainThread]: 
[0m17:20:17.096017 [info ] [MainThread]: Finished running 47 data tests, 5 view models in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m17:20:17.113616 [debug] [MainThread]: Command end result
[0m17:20:17.228763 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:20:17.232577 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:20:17.243747 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:20:17.244313 [info ] [MainThread]: 
[0m17:20:17.245215 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:20:17.245962 [info ] [MainThread]: 
[0m17:20:17.246906 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9 (models\silver\silver_schema.yml)[0m
[0m17:20:17.247766 [error] [MainThread]:   Got 1265 results, configured to fail if != 0
[0m17:20:17.248540 [info ] [MainThread]: 
[0m17:20:17.249411 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\silver_schema.yml\dbt_utils_expression_is_true_i_ba38dcc47ac9f7f603717bd1fa0a1017.sql
[0m17:20:17.250266 [info ] [MainThread]: 
[0m17:20:17.251116 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=36 NO-OP=0 TOTAL=52
[0m17:20:17.252688 [debug] [MainThread]: Command `-c build` failed at 17:20:17.252472 after 8.75 seconds
[0m17:20:17.253422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF1FCE8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF3A7A030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF3A7A0D0>]}
[0m17:20:17.254069 [debug] [MainThread]: Flushing usage events
[0m17:20:18.306893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:22:34.566783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADC7A18050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADC82242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADC8863ED0>]}


============================== 17:22:34.581868 | 293edd3d-3cbb-4f5d-aff4-c5973d61da81 ==============================
[0m17:22:34.581868 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:22:34.584326 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'invocation_command': 'dbt build --select +fct__rsi', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:22:35.185150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADC7BD0180>]}
[0m17:22:35.276379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADC870B790>]}
[0m17:22:35.280056 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:22:35.688011 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:22:36.184277 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:22:36.185656 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\silver_schema.yml
[0m17:22:36.977985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA0EE550>]}
[0m17:22:37.172437 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:22:37.175556 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:22:37.293007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA2D65D0>]}
[0m17:22:37.294624 [info ] [MainThread]: Found 6 models, 47 data tests, 2 sources, 853 macros
[0m17:22:37.313376 [info ] [MainThread]: 
[0m17:22:37.315774 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:22:37.318239 [info ] [MainThread]: 
[0m17:22:37.321786 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:22:37.341517 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:22:37.659167 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:22:37.659925 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:22:37.660562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:39.897442 [debug] [ThreadPool]: SQL status: OK in 2.237 seconds
[0m17:22:39.902843 [debug] [ThreadPool]: On list_finance: Close
[0m17:22:39.905594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:22:39.907485 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:22:39.934231 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:22:39.935911 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:22:39.937278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:39.944314 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:22:39.950760 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:22:39.952120 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:22:39.956575 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:22:39.958010 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:22:39.959291 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:22:40.083619 [debug] [ThreadPool]: SQL status: OK in 0.123 seconds
[0m17:22:40.087983 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:22:40.089661 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:22:40.091143 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:22:40.153929 [debug] [ThreadPool]: SQL status: OK in 0.061 seconds
[0m17:22:40.155618 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:22:40.165650 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:22:40.198250 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:22:40.200292 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:22:40.202562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:40.209101 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:22:40.211883 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:22:40.215098 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:22:40.328285 [debug] [ThreadPool]: SQL status: OK in 0.112 seconds
[0m17:22:40.333152 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:22:40.337023 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:22:40.338326 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:22:40.343661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA3D6EB0>]}
[0m17:22:40.345652 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:40.346905 [debug] [MainThread]: On master: BEGIN
[0m17:22:40.347903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:22:40.351831 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:22:40.353036 [debug] [MainThread]: On master: COMMIT
[0m17:22:40.353920 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:40.354705 [debug] [MainThread]: On master: COMMIT
[0m17:22:40.356694 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:22:40.357568 [debug] [MainThread]: On master: Close
[0m17:22:40.368718 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m17:22:40.370279 [info ] [Thread-1 (]: 1 of 52 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m17:22:40.372670 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m17:22:40.373892 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m17:22:40.398594 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m17:22:40.401193 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m17:22:40.504147 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m17:22:40.507135 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:22:40.508424 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m17:22:40.509840 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:22:40.514923 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:22:40.516187 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:22:40.517258 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:22:40.594951 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m17:22:40.614835 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:22:40.615922 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m17:22:40.685704 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m17:22:40.698280 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:22:40.699911 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m17:22:40.772088 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m17:22:40.829290 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:22:40.831369 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:22:40.833924 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:22:40.956482 [debug] [Thread-1 (]: SQL status: OK in 0.121 seconds
[0m17:22:40.988296 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:22:40.990833 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m17:22:41.125343 [debug] [Thread-1 (]: SQL status: OK in 0.133 seconds
[0m17:22:41.135389 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m17:22:41.145238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA87B860>]}
[0m17:22:41.147417 [info ] [Thread-1 (]: 1 of 52 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.77s]
[0m17:22:41.149760 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m17:22:41.152047 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m17:22:41.153737 [info ] [Thread-2 (]: 2 of 52 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m17:22:41.155685 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m17:22:41.156988 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m17:22:41.167336 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m17:22:41.170442 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m17:22:41.183164 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m17:22:41.186988 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:22:41.189140 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m17:22:41.190390 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:22:41.195126 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:22:41.196470 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:22:41.197745 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:22:41.303667 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m17:22:41.313411 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:22:41.314662 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m17:22:41.379397 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m17:22:41.388718 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:22:41.389931 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m17:22:41.456817 [debug] [Thread-2 (]: SQL status: OK in 0.065 seconds
[0m17:22:41.462006 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:22:41.463271 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:22:41.464348 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:22:41.587101 [debug] [Thread-2 (]: SQL status: OK in 0.121 seconds
[0m17:22:41.596224 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:22:41.597596 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m17:22:41.788519 [debug] [Thread-2 (]: SQL status: OK in 0.189 seconds
[0m17:22:41.796402 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m17:22:41.798865 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA387E90>]}
[0m17:22:41.801859 [info ] [Thread-2 (]: 2 of 52 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.64s]
[0m17:22:41.805447 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m17:22:41.810211 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:22:41.813234 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:22:41.815786 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:22:41.820442 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:22:41.818426 [info ] [Thread-3 (]: 3 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m17:22:41.823014 [info ] [Thread-2 (]: 6 of 52 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .... [RUN]
[0m17:22:41.825736 [info ] [Thread-1 (]: 5 of 52 START test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [RUN]
[0m17:22:41.832845 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:22:41.829551 [info ] [Thread-4 (]: 4 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m17:22:41.835979 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m17:22:41.838328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd)
[0m17:22:41.840401 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:22:41.843307 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:22:41.845657 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:22:41.847604 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:22:41.872257 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:22:41.874079 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:22:41.897397 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:22:41.933569 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:22:41.956555 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:22:41.961302 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:22:42.010375 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:22:42.090288 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:22:42.124246 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:22:42.152035 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:22:42.153866 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:22:42.157887 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:22:42.173923 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:22:42.178717 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:22:42.181788 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: BEGIN
[0m17:22:42.184148 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:22:42.186069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:42.189355 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m17:22:42.193844 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:22:42.198142 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:22:42.201165 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:22:42.203558 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m17:22:42.205932 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m17:22:42.207927 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m17:22:42.212172 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:22:42.215388 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:22:42.218047 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:42.220241 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m17:22:42.224345 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(abs(delta) - (gain + loss)) <= 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:22:42.229036 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m17:22:42.231541 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:22:42.234678 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m17:22:42.237222 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:22:42.240204 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m17:22:42.243461 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:22:42.247397 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m17:22:42.251340 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:22:42.351758 [debug] [Thread-3 (]: SQL status: OK in 0.102 seconds
[0m17:22:42.354123 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m17:22:42.356546 [debug] [Thread-2 (]: SQL status: OK in 0.101 seconds
[0m17:22:42.359768 [debug] [Thread-4 (]: SQL status: OK in 0.105 seconds
[0m17:22:42.381501 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m17:22:42.390826 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m17:22:42.401866 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: ROLLBACK
[0m17:22:42.406347 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m17:22:42.410843 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:22:42.415647 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m17:22:42.419826 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd'
[0m17:22:42.423216 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:22:42.425207 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m17:22:42.427934 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m17:22:42.430310 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: Close
[0m17:22:42.432959 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m17:22:42.439983 [info ] [Thread-2 (]: 6 of 52 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 .......... [[32mPASS[0m in 0.60s]
[0m17:22:42.453764 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:22:42.443790 [info ] [Thread-3 (]: 3 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.61s]
[0m17:22:42.457951 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:22:42.447106 [info ] [Thread-1 (]: 5 of 52 PASS dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[32mPASS[0m in 0.61s]
[0m17:22:42.465344 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:22:42.449382 [info ] [Thread-4 (]: 4 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.61s]
[0m17:22:42.474808 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:22:42.468429 [info ] [Thread-2 (]: 7 of 52 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .... [RUN]
[0m17:22:42.480116 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:22:42.484844 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:22:42.487770 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:22:42.491724 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m17:22:42.498195 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:22:42.495499 [info ] [Thread-3 (]: 8 of 52 START test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [RUN]
[0m17:22:42.506953 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:22:42.503672 [info ] [Thread-1 (]: 9 of 52 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m17:22:42.514284 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96)
[0m17:22:42.510812 [info ] [Thread-4 (]: 10 of 52 START test not_null_int__price_changes_close .......................... [RUN]
[0m17:22:42.536693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m17:22:42.546042 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:22:42.555153 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:22:42.560220 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m17:22:42.563805 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:22:42.590801 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:22:42.594942 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:22:42.633377 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:22:42.661072 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:22:42.690157 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:22:42.695564 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:22:42.708895 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:22:42.715573 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:22:42.717410 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:22:42.722626 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:22:42.724176 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:22:42.725275 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:22:42.726261 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:22:42.730987 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:22:42.732191 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: BEGIN
[0m17:22:42.733369 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m17:22:42.734900 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:22:42.736381 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:42.737482 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:42.738539 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m17:22:42.739788 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:22:42.741503 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:22:42.742429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:42.743698 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m17:22:42.744651 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:22:42.745671 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:22:42.747598 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:42.749413 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:22:42.752960 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:22:42.751250 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:22:42.755950 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:22:42.758651 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:22:42.760264 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m17:22:42.763177 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:22:42.766090 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:22:42.769846 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:22:42.897938 [debug] [Thread-3 (]: SQL status: OK in 0.136 seconds
[0m17:22:42.899879 [debug] [Thread-2 (]: SQL status: OK in 0.138 seconds
[0m17:22:42.902604 [debug] [Thread-4 (]: SQL status: OK in 0.131 seconds
[0m17:22:42.904600 [debug] [Thread-1 (]: SQL status: OK in 0.136 seconds
[0m17:22:42.914384 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: ROLLBACK
[0m17:22:42.921147 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m17:22:42.928002 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m17:22:42.932188 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96'
[0m17:22:42.935764 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m17:22:42.942013 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m17:22:42.945022 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m17:22:42.946635 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: Close
[0m17:22:42.948384 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m17:22:42.950974 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m17:22:42.953201 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m17:22:42.956084 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m17:22:42.959468 [info ] [Thread-3 (]: 8 of 52 PASS dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[32mPASS[0m in 0.45s]
[0m17:22:42.966097 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:22:42.961948 [info ] [Thread-4 (]: 10 of 52 PASS not_null_int__price_changes_close ................................ [[32mPASS[0m in 0.40s]
[0m17:22:42.972276 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:22:42.968382 [info ] [Thread-2 (]: 7 of 52 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 .......... [[32mPASS[0m in 0.48s]
[0m17:22:42.977416 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:22:42.970279 [info ] [Thread-1 (]: 9 of 52 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.43s]
[0m17:22:42.979655 [info ] [Thread-3 (]: 11 of 52 START test not_null_int__price_changes_gain ........................... [RUN]
[0m17:22:42.983956 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:22:42.988029 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:22:42.992452 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:22:42.995642 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m17:22:42.997885 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:22:43.003469 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:22:43.000612 [info ] [Thread-4 (]: 12 of 52 START test not_null_int__price_changes_loaded_at ...................... [RUN]
[0m17:22:43.006312 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:22:43.009890 [info ] [Thread-2 (]: 13 of 52 START test not_null_int__price_changes_loss ........................... [RUN]
[0m17:22:43.015886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m17:22:43.013069 [info ] [Thread-1 (]: 14 of 52 START test not_null_int__price_changes_rn ............................. [RUN]
[0m17:22:43.044797 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m17:22:43.047195 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:22:43.049473 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:22:43.053114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m17:22:43.056331 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:22:43.082684 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:22:43.084889 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:22:43.092854 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:22:43.110574 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:22:43.129964 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:22:43.144392 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:22:43.148612 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:22:43.171948 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:22:43.184959 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:22:43.188065 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:22:43.189967 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m17:22:43.193579 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:22:43.196984 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:22:43.199026 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:43.226469 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:22:43.232229 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:22:43.235993 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m17:22:43.240328 [debug] [Thread-3 (]: SQL status: OK in 0.041 seconds
[0m17:22:43.244649 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:22:43.248254 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:43.251124 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:22:43.253600 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m17:22:43.256747 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:22:43.260039 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:22:43.263592 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:43.265858 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m17:22:43.268367 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m17:22:43.272593 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:22:43.275676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:43.278244 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m17:22:43.281506 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:22:43.285436 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:22:43.288951 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:22:43.292716 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m17:22:43.295629 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:22:43.298938 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:22:43.352704 [debug] [Thread-3 (]: SQL status: OK in 0.082 seconds
[0m17:22:43.363516 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m17:22:43.366495 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m17:22:43.368326 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m17:22:43.373118 [info ] [Thread-3 (]: 11 of 52 PASS not_null_int__price_changes_gain ................................. [[32mPASS[0m in 0.38s]
[0m17:22:43.378696 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:22:43.380973 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:22:43.383383 [info ] [Thread-3 (]: 15 of 52 START test not_null_int__price_changes_ticker ......................... [RUN]
[0m17:22:43.387415 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m17:22:43.390059 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:22:43.421734 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:22:43.424043 [debug] [Thread-2 (]: SQL status: OK in 0.136 seconds
[0m17:22:43.427029 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m17:22:43.429632 [debug] [Thread-4 (]: SQL status: OK in 0.138 seconds
[0m17:22:43.434309 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:22:43.451166 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m17:22:43.456187 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:22:43.465591 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m17:22:43.475581 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m17:22:43.479905 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m17:22:43.484173 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m17:22:43.489268 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m17:22:43.492642 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m17:22:43.496228 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:22:43.499013 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m17:22:43.501281 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m17:22:43.503920 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m17:22:43.507161 [info ] [Thread-2 (]: 13 of 52 PASS not_null_int__price_changes_loss ................................. [[32mPASS[0m in 0.46s]
[0m17:22:43.511291 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:43.519896 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:22:43.514476 [info ] [Thread-1 (]: 14 of 52 PASS not_null_int__price_changes_rn ................................... [[32mPASS[0m in 0.46s]
[0m17:22:43.517128 [info ] [Thread-4 (]: 12 of 52 PASS not_null_int__price_changes_loaded_at ............................ [[32mPASS[0m in 0.50s]
[0m17:22:43.525846 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:22:43.530373 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:22:43.532738 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m17:22:43.537839 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:22:43.542011 [info ] [Thread-2 (]: 16 of 52 START test not_null_int__price_changes_trade_date ..................... [RUN]
[0m17:22:43.546304 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:22:43.549621 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m17:22:43.552539 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:22:43.555113 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:22:43.580024 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:22:43.584758 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:22:43.596517 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:22:43.601261 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:22:43.604474 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m17:22:43.606241 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:43.613864 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:22:43.615871 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:22:43.617663 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:22:43.632345 [debug] [Thread-3 (]: SQL status: OK in 0.074 seconds
[0m17:22:43.647494 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m17:22:43.650365 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m17:22:43.652309 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m17:22:43.657556 [info ] [Thread-3 (]: 15 of 52 PASS not_null_int__price_changes_ticker ............................... [[32mPASS[0m in 0.27s]
[0m17:22:43.661843 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:22:43.702840 [debug] [Thread-2 (]: SQL status: OK in 0.083 seconds
[0m17:22:43.715319 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m17:22:43.718306 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m17:22:43.720111 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m17:22:43.724932 [info ] [Thread-2 (]: 16 of 52 PASS not_null_int__price_changes_trade_date ........................... [[32mPASS[0m in 0.18s]
[0m17:22:43.729028 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:22:43.732793 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m17:22:43.735529 [info ] [Thread-1 (]: 17 of 52 START sql view model analytics_dev.int__rsi_sma ....................... [RUN]
[0m17:22:43.738977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638, now model.portfolio_project_2.int__rsi_sma)
[0m17:22:43.742934 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m17:22:43.768540 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m17:22:43.774501 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m17:22:43.796136 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m17:22:43.801440 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:22:43.804594 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m17:22:43.808232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:43.816478 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:22:43.818912 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:22:43.821206 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    sma_gain::decimal as sma_gain,
    sma_loss::decimal as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m17:22:44.022775 [debug] [Thread-1 (]: SQL status: OK in 0.199 seconds
[0m17:22:44.034779 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:22:44.036360 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m17:22:44.102155 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m17:22:44.118373 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:22:44.120286 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m17:22:44.186072 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m17:22:44.192603 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m17:22:44.195669 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:22:44.197578 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m17:22:44.326836 [debug] [Thread-1 (]: SQL status: OK in 0.126 seconds
[0m17:22:44.340643 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:22:44.343944 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m17:22:44.481103 [debug] [Thread-1 (]: SQL status: OK in 0.135 seconds
[0m17:22:44.487260 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m17:22:44.489450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293edd3d-3cbb-4f5d-aff4-c5973d61da81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA467CD0>]}
[0m17:22:44.493490 [info ] [Thread-1 (]: 17 of 52 OK created sql view model analytics_dev.int__rsi_sma .................. [[32mOK[0m in 0.75s]
[0m17:22:44.497484 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m17:22:44.501420 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:22:44.503389 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:22:44.505315 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:22:44.510502 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:22:44.507552 [info ] [Thread-4 (]: 18 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_gain___0 ......... [RUN]
[0m17:22:44.514671 [info ] [Thread-2 (]: 20 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [RUN]
[0m17:22:44.518304 [info ] [Thread-3 (]: 19 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_loss___0 ......... [RUN]
[0m17:22:44.524187 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6)
[0m17:22:44.520989 [info ] [Thread-1 (]: 21 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ..... [RUN]
[0m17:22:44.528229 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704)
[0m17:22:44.530278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62)
[0m17:22:44.533458 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:22:44.536753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_sma, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9)
[0m17:22:44.539399 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:22:44.542365 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:22:44.569620 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:22:44.572345 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:22:44.610295 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:22:44.623556 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:22:44.647854 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:22:44.651639 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:22:44.669785 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:22:44.671918 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:22:44.684698 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:22:44.688199 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:22:44.700800 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:22:44.702854 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:22:44.716486 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:22:44.719167 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:22:44.721314 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: BEGIN
[0m17:22:44.723994 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:44.728389 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:22:44.730423 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: BEGIN
[0m17:22:44.733106 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:22:44.735573 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:44.738044 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m17:22:44.739879 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:22:44.742052 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: BEGIN
[0m17:22:44.745457 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:22:44.748245 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: BEGIN
[0m17:22:44.750491 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:44.752460 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m17:22:44.754474 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:22:44.756196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:44.759460 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:22:44.762866 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m17:22:44.766243 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:22:44.769493 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:22:44.772550 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m17:22:44.774796 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:22:44.778086 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:22:44.782014 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:22:44.933628 [debug] [Thread-2 (]: SQL status: OK in 0.153 seconds
[0m17:22:44.937728 [debug] [Thread-1 (]: SQL status: OK in 0.153 seconds
[0m17:22:44.936203 [debug] [Thread-3 (]: SQL status: OK in 0.164 seconds
[0m17:22:44.941418 [debug] [Thread-4 (]: SQL status: OK in 0.179 seconds
[0m17:22:44.952487 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: ROLLBACK
[0m17:22:44.961460 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: ROLLBACK
[0m17:22:44.968063 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: ROLLBACK
[0m17:22:44.974467 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: ROLLBACK
[0m17:22:44.978622 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704'
[0m17:22:44.981413 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9'
[0m17:22:44.984395 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62'
[0m17:22:44.987478 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6'
[0m17:22:44.989259 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: Close
[0m17:22:44.991393 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: Close
[0m17:22:44.994573 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: Close
[0m17:22:44.996471 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: Close
[0m17:22:45.001395 [info ] [Thread-1 (]: 21 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ........... [[32mPASS[0m in 0.46s]
[0m17:22:45.012426 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:22:45.004206 [info ] [Thread-2 (]: 20 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[32mPASS[0m in 0.48s]
[0m17:22:45.015775 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:22:45.006162 [info ] [Thread-4 (]: 18 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_gain___0 ............... [[32mPASS[0m in 0.48s]
[0m17:22:45.008390 [info ] [Thread-3 (]: 19 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_loss___0 ............... [[32mPASS[0m in 0.48s]
[0m17:22:45.021490 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:22:45.029085 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:22:45.025736 [info ] [Thread-1 (]: 22 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ..... [RUN]
[0m17:22:45.033453 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:22:45.035501 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:22:45.037959 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:22:45.041593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21)
[0m17:22:45.045497 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:22:45.049377 [info ] [Thread-2 (]: 23 of 52 START test dbt_utils_not_null_where_int__rsi_sma_sma_gain ............. [RUN]
[0m17:22:45.055810 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:22:45.052438 [info ] [Thread-4 (]: 24 of 52 START test dbt_utils_not_null_where_int__rsi_sma_sma_loss ............. [RUN]
[0m17:22:45.062423 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704, now test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e)
[0m17:22:45.060338 [info ] [Thread-3 (]: 25 of 52 START test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [RUN]
[0m17:22:45.091022 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:22:45.094355 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6, now test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d)
[0m17:22:45.096903 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:22:45.099887 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08)
[0m17:22:45.103892 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:22:45.126544 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:22:45.147678 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:22:45.186738 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:22:45.195752 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:22:45.200811 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:22:45.203034 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:22:45.204880 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: BEGIN
[0m17:22:45.219017 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:22:45.223347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:45.231453 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:22:45.233932 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: BEGIN
[0m17:22:45.236692 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:22:45.238793 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:45.242126 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:22:45.246232 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:22:45.249970 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m17:22:45.251866 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:22:45.253557 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_sma"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:22:45.360444 [debug] [Thread-2 (]: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:22:45.362139 [debug] [Thread-4 (]: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:22:45.363911 [error] [Thread-2 (]: 23 of 52 ERROR dbt_utils_not_null_where_int__rsi_sma_sma_gain .................. [[31mERROR[0m in 0.30s]
[0m17:22:45.367470 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m17:22:45.368370 [debug] [Thread-3 (]: SQL status: OK in 0.113 seconds
[0m17:22:45.369892 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:22:45.365792 [error] [Thread-4 (]: 24 of 52 ERROR dbt_utils_not_null_where_int__rsi_sma_sma_loss .................. [[31mERROR[0m in 0.27s]
[0m17:22:45.371766 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:22:45.373195 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:22:45.375500 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:22:45.381087 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: ROLLBACK
[0m17:22:45.387196 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: ROLLBACK
[0m17:22:45.389915 [info ] [Thread-2 (]: 26 of 52 START test not_null_int__rsi_sma_close ................................ [RUN]
[0m17:22:45.394830 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:22:45.397908 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:22:45.400644 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08'
[0m17:22:45.403215 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21'
[0m17:22:45.404918 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e, now test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b)
[0m17:22:45.406673 [info ] [Thread-4 (]: 27 of 52 START test not_null_int__rsi_sma_gain ................................. [RUN]
[0m17:22:45.410392 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: Close
[0m17:22:45.415396 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: Close
[0m17:22:45.418672 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:22:45.422133 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d, now test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953)
[0m17:22:45.451824 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:22:45.429786 [info ] [Thread-3 (]: 25 of 52 PASS dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn .. [[32mPASS[0m in 0.33s]
[0m17:22:45.453901 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:22:45.446955 [info ] [Thread-1 (]: 22 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ........... [[32mPASS[0m in 0.40s]
[0m17:22:45.458686 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:22:45.482890 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:22:45.485281 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:22:45.487131 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:22:45.489290 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:22:45.492911 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:22:45.505631 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:22:45.510492 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:22:45.507953 [info ] [Thread-3 (]: 28 of 52 START test not_null_int__rsi_sma_loaded_at ............................ [RUN]
[0m17:22:45.528847 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08, now test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0)
[0m17:22:45.531866 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:22:45.513220 [info ] [Thread-1 (]: 29 of 52 START test not_null_int__rsi_sma_loss ................................. [RUN]
[0m17:22:45.534840 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:22:45.536564 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:22:45.539386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21, now test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065)
[0m17:22:45.560460 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:22:45.562398 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: BEGIN
[0m17:22:45.564457 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:22:45.567290 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:22:45.570174 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:45.589122 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:22:45.590976 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: BEGIN
[0m17:22:45.594963 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:22:45.596917 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:45.602017 [debug] [Thread-2 (]: SQL status: OK in 0.032 seconds
[0m17:22:45.609683 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:22:45.612782 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:22:45.615018 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:22:45.618307 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__rsi_sma"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:22:45.621115 [debug] [Thread-4 (]: SQL status: OK in 0.024 seconds
[0m17:22:45.633542 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:22:45.636352 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:22:45.639032 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:22:45.642273 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_sma"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:22:45.645030 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: BEGIN
[0m17:22:45.647903 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:45.651400 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:22:45.653605 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: BEGIN
[0m17:22:45.655259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:45.657677 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:22:45.660922 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:22:45.663778 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__rsi_sma"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:22:45.666266 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:22:45.668690 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:22:45.671735 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_sma"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:22:45.816757 [debug] [Thread-2 (]: SQL status: OK in 0.181 seconds
[0m17:22:45.821806 [debug] [Thread-3 (]: SQL status: OK in 0.154 seconds
[0m17:22:45.823878 [debug] [Thread-4 (]: SQL status: OK in 0.177 seconds
[0m17:22:45.826119 [debug] [Thread-1 (]: SQL status: OK in 0.152 seconds
[0m17:22:45.831852 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: ROLLBACK
[0m17:22:45.839764 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: ROLLBACK
[0m17:22:45.845878 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: ROLLBACK
[0m17:22:45.851517 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: ROLLBACK
[0m17:22:45.853887 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b'
[0m17:22:45.856353 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0'
[0m17:22:45.859094 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953'
[0m17:22:45.861569 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065'
[0m17:22:45.863115 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: Close
[0m17:22:45.864739 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: Close
[0m17:22:45.866337 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: Close
[0m17:22:45.869045 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: Close
[0m17:22:45.873555 [info ] [Thread-3 (]: 28 of 52 PASS not_null_int__rsi_sma_loaded_at .................................. [[32mPASS[0m in 0.34s]
[0m17:22:45.876306 [info ] [Thread-2 (]: 26 of 52 PASS not_null_int__rsi_sma_close ...................................... [[32mPASS[0m in 0.47s]
[0m17:22:45.885700 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:22:45.887394 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:22:45.878170 [info ] [Thread-4 (]: 27 of 52 PASS not_null_int__rsi_sma_gain ....................................... [[32mPASS[0m in 0.46s]
[0m17:22:45.890493 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:22:45.894531 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:22:45.879983 [info ] [Thread-1 (]: 29 of 52 PASS not_null_int__rsi_sma_loss ....................................... [[32mPASS[0m in 0.34s]
[0m17:22:45.897919 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:22:45.899624 [info ] [Thread-3 (]: 30 of 52 START test not_null_int__rsi_sma_rn ................................... [RUN]
[0m17:22:45.906138 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:22:45.901295 [info ] [Thread-2 (]: 31 of 52 START test not_null_int__rsi_sma_ticker ............................... [RUN]
[0m17:22:45.909032 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:22:45.911589 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0, now test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139)
[0m17:22:45.915402 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b, now test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d)
[0m17:22:45.920883 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:22:45.918842 [info ] [Thread-4 (]: 32 of 52 START test not_null_int__rsi_sma_trade_date ........................... [RUN]
[0m17:22:45.923329 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:22:45.944102 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:22:45.946099 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953, now test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0)
[0m17:22:45.965741 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:22:45.968150 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:22:45.987196 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:22:45.990102 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:22:46.002393 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:22:46.004836 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:22:46.007933 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:22:46.017995 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:22:46.028899 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:22:46.031879 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:22:46.034889 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: BEGIN
[0m17:22:46.037451 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:46.042130 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:22:46.044891 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: BEGIN
[0m17:22:46.047666 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:22:46.050764 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:22:46.052333 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:46.053953 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:22:46.055562 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: BEGIN
[0m17:22:46.059116 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_sma"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:22:46.060998 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:46.063551 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m17:22:46.066160 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:22:46.068761 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_sma"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:22:46.071344 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m17:22:46.073891 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:22:46.076459 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_sma"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:22:46.354062 [debug] [Thread-4 (]: SQL status: OK in 0.283 seconds
[0m17:22:46.355791 [debug] [Thread-3 (]: SQL status: OK in 0.293 seconds
[0m17:22:46.358297 [debug] [Thread-2 (]: SQL status: OK in 0.280 seconds
[0m17:22:46.365549 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: ROLLBACK
[0m17:22:46.370870 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: ROLLBACK
[0m17:22:46.376871 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: ROLLBACK
[0m17:22:46.379733 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0'
[0m17:22:46.382020 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139'
[0m17:22:46.384435 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d'
[0m17:22:46.385953 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: Close
[0m17:22:46.387540 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: Close
[0m17:22:46.389114 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: Close
[0m17:22:46.395499 [info ] [Thread-4 (]: 32 of 52 PASS not_null_int__rsi_sma_trade_date ................................. [[32mPASS[0m in 0.45s]
[0m17:22:46.402278 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:22:46.394068 [info ] [Thread-3 (]: 30 of 52 PASS not_null_int__rsi_sma_rn ......................................... [[32mPASS[0m in 0.48s]
[0m17:22:46.407177 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:22:46.398980 [info ] [Thread-2 (]: 31 of 52 PASS not_null_int__rsi_sma_ticker ..................................... [[32mPASS[0m in 0.48s]
[0m17:22:46.412140 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:22:46.414917 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m17:22:46.418652 [info ] [Thread-1 (]: 33 of 52 SKIP relation analytics_dev.int__rsi_wilder ........................... [[33mSKIP[0m]
[0m17:22:46.422287 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m17:22:46.424474 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_wilder' to be skipped because of status 'skipped'. 
[0m17:22:46.427954 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:22:46.429655 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:22:46.431330 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:22:46.436551 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:22:46.434133 [info ] [Thread-4 (]: 34 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ....... [[33mSKIP[0m]
[0m17:22:46.440084 [info ] [Thread-2 (]: 36 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [[33mSKIP[0m]
[0m17:22:46.443546 [info ] [Thread-3 (]: 35 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ....... [[33mSKIP[0m]
[0m17:22:46.450225 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:22:46.452398 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:22:46.447590 [info ] [Thread-1 (]: 37 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [[33mSKIP[0m]
[0m17:22:46.455760 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:22:46.458459 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:22:46.460180 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90' to be skipped because of status 'skipped'. 
[0m17:22:46.461929 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:22:46.464401 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:22:46.467305 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:22:46.473438 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7' to be skipped because of status 'skipped'. 
[0m17:22:46.470908 [info ] [Thread-4 (]: 38 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[33mSKIP[0m]
[0m17:22:46.478323 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:22:46.476525 [info ] [Thread-2 (]: 39 of 52 SKIP test not_null_int__rsi_wilder_gain ............................... [[33mSKIP[0m]
[0m17:22:46.484652 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703' to be skipped because of status 'skipped'. 
[0m17:22:46.481951 [info ] [Thread-3 (]: 40 of 52 SKIP test not_null_int__rsi_wilder_loss ............................... [[33mSKIP[0m]
[0m17:22:46.487572 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:22:46.494300 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:22:46.491838 [info ] [Thread-1 (]: 41 of 52 SKIP test not_null_int__rsi_wilder_rn ................................. [[33mSKIP[0m]
[0m17:22:46.496669 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d' to be skipped because of status 'skipped'. 
[0m17:22:46.498414 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:22:46.500169 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:22:46.501922 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:22:46.503619 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:22:46.505220 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95' to be skipped because of status 'skipped'. 
[0m17:22:46.508005 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:22:46.510906 [info ] [Thread-4 (]: 42 of 52 SKIP test not_null_int__rsi_wilder_ticker ............................. [[33mSKIP[0m]
[0m17:22:46.517030 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:22:46.520182 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda' to be skipped because of status 'skipped'. 
[0m17:22:46.513329 [info ] [Thread-2 (]: 43 of 52 SKIP test not_null_int__rsi_wilder_trade_date ......................... [[33mSKIP[0m]
[0m17:22:46.526047 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:22:46.523003 [info ] [Thread-3 (]: 44 of 52 SKIP test not_null_int__rsi_wilder_wilder_gain ........................ [[33mSKIP[0m]
[0m17:22:46.530727 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56' to be skipped because of status 'skipped'. 
[0m17:22:46.528952 [info ] [Thread-1 (]: 45 of 52 SKIP test not_null_int__rsi_wilder_wilder_loss ........................ [[33mSKIP[0m]
[0m17:22:46.533958 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:22:46.536930 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:22:46.540006 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:22:46.543467 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d' to be skipped because of status 'skipped'. 
[0m17:22:46.545558 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:22:46.547662 [info ] [Thread-4 (]: 46 of 52 SKIP test wilder_seed_equals_sma ...................................... [[33mSKIP[0m]
[0m17:22:46.550513 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd' to be skipped because of status 'skipped'. 
[0m17:22:46.553023 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:22:46.554720 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c' to be skipped because of status 'skipped'. 
[0m17:22:46.556912 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9' to be skipped because of status 'skipped'. 
[0m17:22:46.560058 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb' to be skipped because of status 'skipped'. 
[0m17:22:46.563034 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.wilder_seed_equals_sma' to be skipped because of status 'skipped'. 
[0m17:22:46.567099 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.fct__rsi
[0m17:22:46.569291 [info ] [Thread-2 (]: 47 of 52 SKIP relation analytics_dev.fct__rsi .................................. [[33mSKIP[0m]
[0m17:22:46.572092 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m17:22:46.574315 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'skipped'. 
[0m17:22:46.577991 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:22:46.579707 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:22:46.581386 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:22:46.587300 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:22:46.584670 [info ] [Thread-1 (]: 49 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[33mSKIP[0m]
[0m17:22:46.591163 [info ] [Thread-2 (]: 51 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ......... [[33mSKIP[0m]
[0m17:22:46.593554 [info ] [Thread-4 (]: 50 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............ [[33mSKIP[0m]
[0m17:22:46.599301 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:22:46.601505 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:22:46.597014 [info ] [Thread-3 (]: 48 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[33mSKIP[0m]
[0m17:22:46.605161 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:22:46.608953 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:22:46.611787 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2' to be skipped because of status 'skipped'. 
[0m17:22:46.615632 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:22:46.621461 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0' to be skipped because of status 'skipped'. 
[0m17:22:46.619490 [info ] [Thread-1 (]: 52 of 52 SKIP test dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker  [[33mSKIP[0m]
[0m17:22:46.624441 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a' to be skipped because of status 'skipped'. 
[0m17:22:46.626351 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:22:46.627970 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a' to be skipped because of status 'skipped'. 
[0m17:22:46.629848 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400' to be skipped because of status 'skipped'. 
[0m17:22:46.636362 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:46.639036 [debug] [MainThread]: On master: BEGIN
[0m17:22:46.641705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:22:46.647749 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m17:22:46.649163 [debug] [MainThread]: On master: COMMIT
[0m17:22:46.650445 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:46.651710 [debug] [MainThread]: On master: COMMIT
[0m17:22:46.654275 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:22:46.655739 [debug] [MainThread]: On master: Close
[0m17:22:46.658615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:46.661033 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:22:46.663336 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:22:46.665375 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065' was properly closed.
[0m17:22:46.667553 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d' was properly closed.
[0m17:22:46.669532 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139' was properly closed.
[0m17:22:46.670914 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0' was properly closed.
[0m17:22:46.673367 [info ] [MainThread]: 
[0m17:22:46.676528 [info ] [MainThread]: Finished running 47 data tests, 5 view models in 0 hours 0 minutes and 9.35 seconds (9.35s).
[0m17:22:46.730097 [debug] [MainThread]: Command end result
[0m17:22:46.929597 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:22:46.935363 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:22:46.952545 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:22:46.953542 [info ] [MainThread]: 
[0m17:22:46.954746 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:22:46.955916 [info ] [MainThread]: 
[0m17:22:46.957220 [error] [MainThread]: [31mFailure in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)[0m
[0m17:22:46.958712 [error] [MainThread]:   Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:22:46.959896 [info ] [MainThread]: 
[0m17:22:46.961557 [error] [MainThread]: [31mFailure in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)[0m
[0m17:22:46.963168 [error] [MainThread]:   Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:22:46.964499 [info ] [MainThread]: 
[0m17:22:46.965867 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=2 SKIP=20 NO-OP=0 TOTAL=52
[0m17:22:46.969317 [debug] [MainThread]: Command `-c build` failed at 17:22:46.968833 after 12.86 seconds
[0m17:22:46.970581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCBD7AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA2CFEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADCA75D4D0>]}
[0m17:22:46.971897 [debug] [MainThread]: Flushing usage events
[0m17:22:49.231696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:46.775402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF94488050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF94C942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF952D7ED0>]}


============================== 17:24:46.790556 | d9fdd445-5682-40f9-8355-50f7cf338260 ==============================
[0m17:24:46.790556 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:24:46.793039 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt clean', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m17:24:47.036063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9fdd445-5682-40f9-8355-50f7cf338260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF94640180>]}
[0m17:24:47.263737 [debug] [MainThread]: Command `-c clean` succeeded at 17:24:47.263447 after 0.91 seconds
[0m17:24:47.264520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF9517A360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF9517A030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF95173C50>]}
[0m17:24:47.265096 [debug] [MainThread]: Flushing usage events
[0m17:24:48.142191 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:54.972057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024418708050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024418F142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024419557ED0>]}


============================== 17:24:54.987218 | 41a45fda-0d3a-4b1d-8f4d-0d11082f7555 ==============================
[0m17:24:54.987218 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:24:54.989741 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --select +fct__rsi', 'log_format': 'default', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:24:55.482028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41a45fda-0d3a-4b1d-8f4d-0d11082f7555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244188C0180>]}
[0m17:24:55.571797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41a45fda-0d3a-4b1d-8f4d-0d11082f7555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244193FB790>]}
[0m17:24:55.575066 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:24:55.957545 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m17:24:55.959541 [debug] [MainThread]: Command `-c build` failed at 17:24:55.959241 after 1.24 seconds
[0m17:24:55.960460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002441A695450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002441A695350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002441A870F50>]}
[0m17:24:55.961366 [debug] [MainThread]: Flushing usage events
[0m17:24:57.143924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:07.608270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD094C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD11542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD1797ED0>]}


============================== 17:25:07.617263 | b555cadd-97ae-46da-bf7c-185b2cfe92e2 ==============================
[0m17:25:07.617263 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:25:07.618649 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:25:07.842594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b555cadd-97ae-46da-bf7c-185b2cfe92e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD0B00180>]}
[0m17:25:07.892707 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-u5v29abe'
[0m17:25:07.893514 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:25:08.712765 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:25:08.716035 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:25:09.496834 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:25:09.504479 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m17:25:10.297601 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m17:25:10.311372 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m17:25:11.097911 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m17:25:11.112415 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:25:12.658617 [info ] [MainThread]: Installed from version 1.3.2
[0m17:25:12.659383 [info ] [MainThread]: Up to date!
[0m17:25:12.660155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b555cadd-97ae-46da-bf7c-185b2cfe92e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD163AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD163A580>]}
[0m17:25:12.660714 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m17:25:18.075856 [info ] [MainThread]: Installed from version 0.10.9
[0m17:25:18.076660 [info ] [MainThread]: Up to date!
[0m17:25:18.077483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b555cadd-97ae-46da-bf7c-185b2cfe92e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD2A7D050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD162B6B0>]}
[0m17:25:18.078096 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m17:25:19.295687 [info ] [MainThread]: Installed from version 0.16.1
[0m17:25:19.297646 [info ] [MainThread]: Up to date!
[0m17:25:19.299639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b555cadd-97ae-46da-bf7c-185b2cfe92e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD2A59A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD2A59470>]}
[0m17:25:19.309892 [debug] [MainThread]: Command `-c deps` succeeded at 17:25:19.309345 after 11.92 seconds
[0m17:25:19.311428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD158B1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD29FE810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD2A71E90>]}
[0m17:25:19.313071 [debug] [MainThread]: Flushing usage events
[0m17:25:20.186509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:27.932337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAE858050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAF0642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAF6A3ED0>]}


============================== 17:25:27.949260 | 7927384c-0aae-4b7a-b62a-a9d9308712bb ==============================
[0m17:25:27.949260 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:25:27.952129 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt build --select +fct__rsi', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m17:25:28.600335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAEA10180>]}
[0m17:25:28.689695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAF54B790>]}
[0m17:25:28.693274 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:25:29.174158 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:25:29.177549 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:25:29.178747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAF7C1250>]}
[0m17:25:32.777311 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:25:32.778477 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m17:25:32.779230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB0CB4320>]}
[0m17:25:33.351552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB0FFBE70>]}
[0m17:25:33.547020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:25:33.552169 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:25:33.665849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB136F6C0>]}
[0m17:25:33.667436 [info ] [MainThread]: Found 6 models, 47 data tests, 2 sources, 853 macros
[0m17:25:33.683901 [info ] [MainThread]: 
[0m17:25:33.686089 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:25:33.687729 [info ] [MainThread]: 
[0m17:25:33.690052 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:25:33.708055 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:25:33.948910 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:25:33.949867 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:25:33.950667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:35.889347 [debug] [ThreadPool]: SQL status: OK in 1.938 seconds
[0m17:25:35.894291 [debug] [ThreadPool]: On list_finance: Close
[0m17:25:35.896803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:25:35.898812 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:25:35.921821 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:35.923160 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:25:35.924350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:35.929645 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:25:35.934544 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:35.935747 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:25:35.939485 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:25:35.940720 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:35.941882 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:25:35.995281 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m17:25:35.998852 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:25:36.000226 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:36.001429 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:25:36.050582 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m17:25:36.052149 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:25:36.058427 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:25:36.079407 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:25:36.080727 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:25:36.081852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:36.085856 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:25:36.087068 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:25:36.088300 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:25:36.168451 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m17:25:36.171074 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:25:36.172835 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:25:36.173355 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:25:36.177113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB1246510>]}
[0m17:25:36.178146 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:36.178868 [debug] [MainThread]: On master: BEGIN
[0m17:25:36.179599 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:36.182187 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:25:36.183003 [debug] [MainThread]: On master: COMMIT
[0m17:25:36.183779 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:36.184544 [debug] [MainThread]: On master: COMMIT
[0m17:25:36.186036 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:25:36.186836 [debug] [MainThread]: On master: Close
[0m17:25:36.196928 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m17:25:36.198241 [info ] [Thread-1 (]: 1 of 52 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m17:25:36.199903 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m17:25:36.200863 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m17:25:36.220216 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m17:25:36.226322 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m17:25:36.326735 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m17:25:36.330298 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:25:36.331300 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m17:25:36.332180 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:25:36.335297 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:25:36.336239 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:25:36.337184 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:25:36.398740 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m17:25:36.422203 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:25:36.423801 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m17:25:36.488624 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m17:25:36.501709 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:25:36.503500 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m17:25:36.567865 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m17:25:36.617256 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:25:36.618784 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:25:36.620118 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m17:25:36.733666 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m17:25:36.755391 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m17:25:36.757097 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m17:25:36.866268 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m17:25:36.875006 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m17:25:36.882041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB1386F10>]}
[0m17:25:36.884544 [info ] [Thread-1 (]: 1 of 52 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.68s]
[0m17:25:36.887529 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m17:25:36.890041 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__price_changes
[0m17:25:36.892149 [info ] [Thread-2 (]: 2 of 52 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m17:25:36.894828 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__price_changes'
[0m17:25:36.896442 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m17:25:36.914918 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m17:25:36.920721 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m17:25:36.933044 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m17:25:36.938403 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:25:36.940155 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m17:25:36.941591 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:25:36.945909 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:25:36.947435 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:25:36.949104 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:25:37.065155 [debug] [Thread-2 (]: SQL status: OK in 0.112 seconds
[0m17:25:37.078533 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:25:37.081931 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m17:25:37.156730 [debug] [Thread-2 (]: SQL status: OK in 0.071 seconds
[0m17:25:37.179713 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:25:37.180875 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m17:25:37.232792 [debug] [Thread-2 (]: SQL status: OK in 0.051 seconds
[0m17:25:37.236436 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:25:37.237627 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:25:37.238701 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m17:25:37.363707 [debug] [Thread-2 (]: SQL status: OK in 0.124 seconds
[0m17:25:37.367485 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m17:25:37.368078 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m17:25:37.560258 [debug] [Thread-2 (]: SQL status: OK in 0.191 seconds
[0m17:25:37.565638 [debug] [Thread-2 (]: On model.portfolio_project_2.int__price_changes: Close
[0m17:25:37.567708 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB2C6A170>]}
[0m17:25:37.569881 [info ] [Thread-2 (]: 2 of 52 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.67s]
[0m17:25:37.572784 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m17:25:37.577475 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:25:37.579061 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:25:37.580886 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:25:37.584226 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:25:37.582720 [info ] [Thread-3 (]: 3 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m17:25:37.586576 [info ] [Thread-1 (]: 5 of 52 START test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [RUN]
[0m17:25:37.592548 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:25:37.588167 [info ] [Thread-2 (]: 6 of 52 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .... [RUN]
[0m17:25:37.594796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd)
[0m17:25:37.596542 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:25:37.590092 [info ] [Thread-4 (]: 4 of 52 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m17:25:37.598958 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m17:25:37.600636 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:25:37.617320 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:25:37.619385 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:25:37.621191 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:25:37.647630 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:25:37.649840 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:25:37.666799 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:25:37.685181 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:25:37.687815 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:25:37.689983 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:25:37.774399 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:25:37.786128 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:25:37.803920 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:25:37.813327 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:25:37.815295 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:25:37.824029 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:25:37.828434 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:25:37.830091 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m17:25:37.831845 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:25:37.834828 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:25:37.836628 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: BEGIN
[0m17:25:37.838156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:37.840476 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:25:37.842199 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:25:37.843979 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:25:37.845795 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m17:25:37.849728 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:25:37.848524 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:25:37.852128 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m17:25:37.853892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:37.855748 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m17:25:37.857632 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:25:37.859408 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:25:37.862777 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(abs(delta) - (gain + loss)) <= 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:25:37.866150 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m17:25:37.867792 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:25:37.869385 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m17:25:37.871115 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:25:37.872994 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:25:37.875714 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m17:25:37.969606 [debug] [Thread-3 (]: SQL status: OK in 0.108 seconds
[0m17:25:37.971323 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m17:25:37.975234 [debug] [Thread-4 (]: SQL status: OK in 0.098 seconds
[0m17:25:37.977012 [debug] [Thread-2 (]: SQL status: OK in 0.102 seconds
[0m17:25:37.989447 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m17:25:37.995031 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: ROLLBACK
[0m17:25:38.000638 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m17:25:38.004380 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:25:38.006761 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd'
[0m17:25:38.012635 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m17:25:38.015027 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:25:38.016708 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m17:25:38.018441 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: Close
[0m17:25:38.021039 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m17:25:38.022889 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m17:25:38.025233 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m17:25:38.027733 [info ] [Thread-1 (]: 5 of 52 PASS dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[32mPASS[0m in 0.43s]
[0m17:25:38.033247 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:25:38.039129 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:25:38.030149 [info ] [Thread-3 (]: 3 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.44s]
[0m17:25:38.035491 [info ] [Thread-4 (]: 4 of 52 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.42s]
[0m17:25:38.037522 [info ] [Thread-2 (]: 6 of 52 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 .......... [[32mPASS[0m in 0.44s]
[0m17:25:38.052171 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:25:38.049483 [info ] [Thread-1 (]: 7 of 52 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .... [RUN]
[0m17:25:38.055368 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:25:38.058039 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:25:38.059898 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:25:38.062078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m17:25:38.064064 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:25:38.066423 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:25:38.070674 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:25:38.068521 [info ] [Thread-3 (]: 8 of 52 START test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [RUN]
[0m17:25:38.073230 [info ] [Thread-4 (]: 9 of 52 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m17:25:38.075810 [info ] [Thread-2 (]: 10 of 52 START test not_null_int__price_changes_close .......................... [RUN]
[0m17:25:38.099155 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96)
[0m17:25:38.107403 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m17:25:38.109393 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:25:38.111165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m17:25:38.113062 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:25:38.114915 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:25:38.117209 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:25:38.151052 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:25:38.158416 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:25:38.165115 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:25:38.189284 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:25:38.199421 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:25:38.202963 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:25:38.214230 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:25:38.223717 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:25:38.213462 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:25:38.226598 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:25:38.229511 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:25:38.241391 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:25:38.248239 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:25:38.249960 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m17:25:38.251829 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:25:38.253676 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m17:25:38.256080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:38.257932 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: BEGIN
[0m17:25:38.259942 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:38.262646 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:38.264616 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:25:38.267670 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m17:25:38.269344 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:25:38.271021 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:38.272861 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m17:25:38.274504 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:25:38.276330 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m17:25:38.279365 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:25:38.281404 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:25:38.283290 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:25:38.285039 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m17:25:38.286787 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:25:38.289473 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:25:38.291351 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:25:38.294671 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:25:38.508740 [debug] [Thread-2 (]: SQL status: OK in 0.212 seconds
[0m17:25:38.510518 [debug] [Thread-3 (]: SQL status: OK in 0.217 seconds
[0m17:25:38.512431 [debug] [Thread-4 (]: SQL status: OK in 0.219 seconds
[0m17:25:38.514213 [debug] [Thread-1 (]: SQL status: OK in 0.225 seconds
[0m17:25:38.523885 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: ROLLBACK
[0m17:25:38.525405 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m17:25:38.528944 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96'
[0m17:25:38.531025 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: Close
[0m17:25:38.533263 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m17:25:38.540118 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m17:25:38.544594 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m17:25:38.546246 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m17:25:38.548497 [info ] [Thread-3 (]: 8 of 52 PASS dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[32mPASS[0m in 0.45s]
[0m17:25:38.552141 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m17:25:38.554542 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m17:25:38.557328 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:25:38.561177 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m17:25:38.559650 [info ] [Thread-2 (]: 10 of 52 PASS not_null_int__price_changes_close ................................ [[32mPASS[0m in 0.45s]
[0m17:25:38.563517 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m17:25:38.565895 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:25:38.569154 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:25:38.572009 [info ] [Thread-1 (]: 7 of 52 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 .......... [[32mPASS[0m in 0.51s]
[0m17:25:38.574607 [info ] [Thread-3 (]: 11 of 52 START test not_null_int__price_changes_gain ........................... [RUN]
[0m17:25:38.579209 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:25:38.583598 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:25:38.576821 [info ] [Thread-4 (]: 9 of 52 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.47s]
[0m17:25:38.586023 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m17:25:38.590328 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:25:38.587920 [info ] [Thread-2 (]: 12 of 52 START test not_null_int__price_changes_loaded_at ...................... [RUN]
[0m17:25:38.594049 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:25:38.595903 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:25:38.601514 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m17:25:38.598004 [info ] [Thread-1 (]: 13 of 52 START test not_null_int__price_changes_loss ........................... [RUN]
[0m17:25:38.604952 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:25:38.623582 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:25:38.625290 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:25:38.627219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m17:25:38.629132 [info ] [Thread-4 (]: 14 of 52 START test not_null_int__price_changes_rn ............................. [RUN]
[0m17:25:38.646829 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:25:38.649184 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:25:38.651309 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m17:25:38.653095 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:25:38.672418 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:25:38.674194 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:25:38.685294 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:25:38.687581 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:25:38.702999 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:25:38.726716 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:25:38.728611 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:25:38.739058 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:25:38.741445 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:25:38.743125 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m17:25:38.744680 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:38.747493 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:25:38.757651 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:25:38.759478 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:25:38.761156 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m17:25:38.763256 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:25:38.765045 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m17:25:38.766832 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:25:38.768712 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m17:25:38.771051 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:25:38.772611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:38.774312 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:25:38.776100 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:38.777867 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m17:25:38.781695 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:38.783947 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:25:38.785602 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m17:25:38.787218 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:25:38.789071 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:25:38.790801 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m17:25:38.792522 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:25:38.794773 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:25:38.796513 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:25:38.799678 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:25:38.854594 [debug] [Thread-3 (]: SQL status: OK in 0.074 seconds
[0m17:25:38.863696 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m17:25:38.866178 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m17:25:38.867704 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m17:25:38.871181 [info ] [Thread-3 (]: 11 of 52 PASS not_null_int__price_changes_gain ................................. [[32mPASS[0m in 0.29s]
[0m17:25:38.874462 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:25:38.876145 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:25:38.878023 [info ] [Thread-3 (]: 15 of 52 START test not_null_int__price_changes_ticker ......................... [RUN]
[0m17:25:38.880340 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m17:25:38.882106 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:25:38.899971 [debug] [Thread-2 (]: SQL status: OK in 0.101 seconds
[0m17:25:38.902205 [debug] [Thread-4 (]: SQL status: OK in 0.101 seconds
[0m17:25:38.905091 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m17:25:38.907665 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:25:38.913083 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:25:38.923160 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:25:38.930133 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m17:25:38.936042 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m17:25:38.941678 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m17:25:38.944806 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m17:25:38.947676 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m17:25:38.949841 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m17:25:38.952216 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m17:25:38.954185 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:25:38.956178 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m17:25:38.958123 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m17:25:38.962209 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m17:25:38.960649 [info ] [Thread-4 (]: 14 of 52 PASS not_null_int__price_changes_rn ................................... [[32mPASS[0m in 0.31s]
[0m17:25:38.965215 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:38.968029 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:25:38.970211 [info ] [Thread-1 (]: 13 of 52 PASS not_null_int__price_changes_loss ................................. [[32mPASS[0m in 0.34s]
[0m17:25:38.975339 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:25:38.972231 [info ] [Thread-2 (]: 12 of 52 PASS not_null_int__price_changes_loaded_at ............................ [[32mPASS[0m in 0.37s]
[0m17:25:38.979066 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:25:38.980924 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m17:25:38.985520 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:25:38.983017 [info ] [Thread-4 (]: 16 of 52 START test not_null_int__price_changes_trade_date ..................... [RUN]
[0m17:25:38.988282 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:25:38.990678 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m17:25:38.992614 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:25:38.994534 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:25:39.014359 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:25:39.020026 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:25:39.030849 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:25:39.035118 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:25:39.036806 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m17:25:39.038272 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:39.043061 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:25:39.044858 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:25:39.046553 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:25:39.058430 [debug] [Thread-3 (]: SQL status: OK in 0.062 seconds
[0m17:25:39.068149 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m17:25:39.070671 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m17:25:39.072255 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m17:25:39.075697 [info ] [Thread-3 (]: 15 of 52 PASS not_null_int__price_changes_ticker ............................... [[32mPASS[0m in 0.20s]
[0m17:25:39.078888 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:25:39.123833 [debug] [Thread-4 (]: SQL status: OK in 0.076 seconds
[0m17:25:39.133137 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m17:25:39.135805 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m17:25:39.137377 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m17:25:39.140868 [info ] [Thread-4 (]: 16 of 52 PASS not_null_int__price_changes_trade_date ........................... [[32mPASS[0m in 0.15s]
[0m17:25:39.144236 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:25:39.146952 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m17:25:39.149669 [info ] [Thread-1 (]: 17 of 52 START sql view model analytics_dev.int__rsi_sma ....................... [RUN]
[0m17:25:39.152221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa, now model.portfolio_project_2.int__rsi_sma)
[0m17:25:39.154091 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m17:25:39.167330 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.171850 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m17:25:39.185754 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.189746 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.191378 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m17:25:39.192827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:39.197159 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:25:39.198719 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.200412 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    sma_gain::decimal as sma_gain,
    sma_loss::decimal as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m17:25:39.295133 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m17:25:39.307201 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.308757 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m17:25:39.366556 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m17:25:39.379040 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.380594 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m17:25:39.441955 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m17:25:39.447400 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m17:25:39.449001 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.450461 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m17:25:39.557084 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m17:25:39.566542 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m17:25:39.568132 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m17:25:39.680801 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m17:25:39.685707 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m17:25:39.687848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7927384c-0aae-4b7a-b62a-a9d9308712bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB1656B50>]}
[0m17:25:39.690001 [info ] [Thread-1 (]: 17 of 52 OK created sql view model analytics_dev.int__rsi_sma .................. [[32mOK[0m in 0.54s]
[0m17:25:39.692938 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m17:25:39.696022 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:25:39.697571 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:25:39.699098 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:25:39.700631 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:25:39.702196 [info ] [Thread-2 (]: 18 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_gain___0 ......... [RUN]
[0m17:25:39.704714 [info ] [Thread-3 (]: 19 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_loss___0 ......... [RUN]
[0m17:25:39.706898 [info ] [Thread-1 (]: 21 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ..... [RUN]
[0m17:25:39.711092 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6)
[0m17:25:39.712931 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62)
[0m17:25:39.708583 [info ] [Thread-4 (]: 20 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [RUN]
[0m17:25:39.715182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_sma, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9)
[0m17:25:39.716899 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:25:39.718573 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:25:39.720584 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704)
[0m17:25:39.722315 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:25:39.739244 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:25:39.756099 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:25:39.757854 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:25:39.773458 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:25:39.791997 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:25:39.795107 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:25:39.803638 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:25:39.805465 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:25:39.807002 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:25:39.817259 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:25:39.826462 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:25:39.828949 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:25:39.830802 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:25:39.841382 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:25:39.843219 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: BEGIN
[0m17:25:39.845841 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:39.847782 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:25:39.850313 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:25:39.852137 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: BEGIN
[0m17:25:39.853896 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: BEGIN
[0m17:25:39.855867 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:39.857617 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m17:25:39.859236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:39.861062 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:25:39.863580 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:25:39.866014 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: BEGIN
[0m17:25:39.868498 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:25:39.870385 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m17:25:39.872287 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:25:39.873935 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:39.876442 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:25:39.878270 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:25:39.880842 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:25:39.882796 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:25:39.884507 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m17:25:39.887632 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:25:39.889345 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:25:39.977033 [debug] [Thread-1 (]: SQL status: OK in 0.090 seconds
[0m17:25:39.979132 [debug] [Thread-4 (]: SQL status: OK in 0.088 seconds
[0m17:25:39.981145 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m17:25:39.983010 [debug] [Thread-3 (]: SQL status: OK in 0.097 seconds
[0m17:25:39.989055 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: ROLLBACK
[0m17:25:39.994673 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: ROLLBACK
[0m17:25:39.998183 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9'
[0m17:25:40.001233 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704'
[0m17:25:40.006797 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: ROLLBACK
[0m17:25:40.012677 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: Close
[0m17:25:40.014043 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: ROLLBACK
[0m17:25:40.015853 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: Close
[0m17:25:40.018584 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6'
[0m17:25:40.021302 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62'
[0m17:25:40.025472 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: Close
[0m17:25:40.023732 [info ] [Thread-1 (]: 21 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ........... [[32mPASS[0m in 0.31s]
[0m17:25:40.029916 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: Close
[0m17:25:40.028991 [info ] [Thread-4 (]: 20 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[32mPASS[0m in 0.31s]
[0m17:25:40.033509 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:25:40.035828 [info ] [Thread-2 (]: 18 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_gain___0 ............... [[32mPASS[0m in 0.32s]
[0m17:25:40.039499 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:25:40.041916 [info ] [Thread-3 (]: 19 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_loss___0 ............... [[32mPASS[0m in 0.33s]
[0m17:25:40.043654 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:25:40.048120 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:25:40.050097 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:25:40.053025 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:25:40.056630 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:25:40.054846 [info ] [Thread-1 (]: 22 of 52 START test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ..... [RUN]
[0m17:25:40.062033 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:25:40.059542 [info ] [Thread-4 (]: 23 of 52 START test dbt_utils_not_null_where_int__rsi_sma_sma_gain ............. [RUN]
[0m17:25:40.066916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21)
[0m17:25:40.064400 [info ] [Thread-2 (]: 24 of 52 START test dbt_utils_not_null_where_int__rsi_sma_sma_loss ............. [RUN]
[0m17:25:40.071274 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704, now test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e)
[0m17:25:40.073227 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:25:40.068914 [info ] [Thread-3 (]: 25 of 52 START test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [RUN]
[0m17:25:40.075682 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6, now test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d)
[0m17:25:40.077911 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:25:40.111633 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08)
[0m17:25:40.109782 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:25:40.113525 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:25:40.130192 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:25:40.150136 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:25:40.167832 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:25:40.178122 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:25:40.183093 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:25:40.193133 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:25:40.197008 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:25:40.198751 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: BEGIN
[0m17:25:40.200344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:40.204365 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:25:40.206058 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: BEGIN
[0m17:25:40.208210 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:40.210795 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:25:40.212462 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:25:40.215134 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:25:40.217705 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m17:25:40.219330 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:25:40.220994 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_sma"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:25:40.246687 [debug] [Thread-4 (]: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:25:40.252006 [debug] [Thread-2 (]: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:25:40.249587 [error] [Thread-4 (]: 23 of 52 ERROR dbt_utils_not_null_where_int__rsi_sma_sma_gain .................. [[31mERROR[0m in 0.18s]
[0m17:25:40.256748 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e
[0m17:25:40.254562 [error] [Thread-2 (]: 24 of 52 ERROR dbt_utils_not_null_where_int__rsi_sma_sma_loss .................. [[31mERROR[0m in 0.18s]
[0m17:25:40.259870 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:25:40.261842 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:25:40.264114 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d
[0m17:25:40.269648 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:25:40.271638 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:25:40.267662 [info ] [Thread-4 (]: 26 of 52 START test not_null_int__rsi_sma_close ................................ [RUN]
[0m17:25:40.273852 [info ] [Thread-2 (]: 27 of 52 START test not_null_int__rsi_sma_gain ................................. [RUN]
[0m17:25:40.277088 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_gain.9866d1049e, now test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b)
[0m17:25:40.279073 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_not_null_where_int__rsi_sma_sma_loss.927498489d, now test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953)
[0m17:25:40.280962 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:25:40.282760 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:25:40.299811 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:25:40.318563 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:25:40.323577 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:25:40.332576 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:25:40.334898 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:25:40.345025 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:25:40.348079 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:25:40.350492 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: BEGIN
[0m17:25:40.352525 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:40.355157 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:25:40.357628 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: BEGIN
[0m17:25:40.359245 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:40.361439 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m17:25:40.363180 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:25:40.366235 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:25:40.364823 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__rsi_sma"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:25:40.368765 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:25:40.371288 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_sma"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:25:40.435133 [debug] [Thread-1 (]: SQL status: OK in 0.218 seconds
[0m17:25:40.436816 [debug] [Thread-3 (]: SQL status: OK in 0.214 seconds
[0m17:25:40.446060 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: ROLLBACK
[0m17:25:40.451800 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: ROLLBACK
[0m17:25:40.454104 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21'
[0m17:25:40.456733 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08'
[0m17:25:40.458417 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: Close
[0m17:25:40.460215 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: Close
[0m17:25:40.463799 [info ] [Thread-1 (]: 22 of 52 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ........... [[32mPASS[0m in 0.40s]
[0m17:25:40.468826 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:25:40.465976 [info ] [Thread-3 (]: 25 of 52 PASS dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn .. [[32mPASS[0m in 0.35s]
[0m17:25:40.471095 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:25:40.473913 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:25:40.477524 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:25:40.475742 [info ] [Thread-1 (]: 28 of 52 START test not_null_int__rsi_sma_loaded_at ............................ [RUN]
[0m17:25:40.482029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21, now test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0)
[0m17:25:40.480380 [info ] [Thread-3 (]: 29 of 52 START test not_null_int__rsi_sma_loss ................................. [RUN]
[0m17:25:40.484268 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:25:40.486181 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08, now test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065)
[0m17:25:40.497512 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:25:40.506602 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:25:40.508668 [debug] [Thread-4 (]: SQL status: OK in 0.138 seconds
[0m17:25:40.524396 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:25:40.526253 [debug] [Thread-2 (]: SQL status: OK in 0.153 seconds
[0m17:25:40.531185 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:25:40.548345 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:25:40.550414 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:25:40.553474 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: ROLLBACK
[0m17:25:40.558876 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: ROLLBACK
[0m17:25:40.568425 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:25:40.571671 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:25:40.573729 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b'
[0m17:25:40.576158 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953'
[0m17:25:40.578314 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: BEGIN
[0m17:25:40.580450 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: Close
[0m17:25:40.582534 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: Close
[0m17:25:40.584470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:40.586694 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:25:40.589588 [info ] [Thread-4 (]: 26 of 52 PASS not_null_int__rsi_sma_close ...................................... [[32mPASS[0m in 0.31s]
[0m17:25:40.596692 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:25:40.592367 [info ] [Thread-2 (]: 27 of 52 PASS not_null_int__rsi_sma_gain ....................................... [[32mPASS[0m in 0.31s]
[0m17:25:40.594658 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: BEGIN
[0m17:25:40.600363 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:25:40.602158 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:25:40.604742 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:25:40.606486 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:40.608499 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:25:40.611256 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__rsi_sma"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:25:40.613301 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:25:40.616141 [info ] [Thread-4 (]: 30 of 52 START test not_null_int__rsi_sma_rn ................................... [RUN]
[0m17:25:40.621135 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b, now test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139)
[0m17:25:40.622852 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:25:40.619098 [info ] [Thread-2 (]: 31 of 52 START test not_null_int__rsi_sma_ticker ............................... [RUN]
[0m17:25:40.625289 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m17:25:40.642388 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:25:40.644178 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953, now test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d)
[0m17:25:40.646103 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:25:40.648557 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:25:40.650792 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_sma"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:25:40.667499 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:25:40.671196 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:25:40.682301 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:25:40.684676 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:25:40.694389 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:25:40.697449 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:25:40.700208 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: BEGIN
[0m17:25:40.701866 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:40.704839 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:25:40.706871 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: BEGIN
[0m17:25:40.708503 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:40.710157 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:25:40.712610 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:25:40.714413 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_sma"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:25:40.716653 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:25:40.718336 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:25:40.720223 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_sma"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:25:40.730411 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m17:25:40.739788 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: ROLLBACK
[0m17:25:40.742311 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0'
[0m17:25:40.743865 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: Close
[0m17:25:40.747348 [info ] [Thread-1 (]: 28 of 52 PASS not_null_int__rsi_sma_loaded_at .................................. [[32mPASS[0m in 0.27s]
[0m17:25:40.750449 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:25:40.752538 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:25:40.754253 [info ] [Thread-1 (]: 32 of 52 START test not_null_int__rsi_sma_trade_date ........................... [RUN]
[0m17:25:40.756488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0, now test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0)
[0m17:25:40.758132 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:25:40.774949 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:25:40.776971 [debug] [Thread-3 (]: SQL status: OK in 0.108 seconds
[0m17:25:40.780288 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:25:40.791132 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:25:40.797514 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: ROLLBACK
[0m17:25:40.800162 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065'
[0m17:25:40.802073 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: Close
[0m17:25:40.804758 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:25:40.806980 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: BEGIN
[0m17:25:40.810914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:40.809273 [info ] [Thread-3 (]: 29 of 52 PASS not_null_int__rsi_sma_loss ....................................... [[32mPASS[0m in 0.32s]
[0m17:25:40.814535 [debug] [Thread-4 (]: SQL status: OK in 0.098 seconds
[0m17:25:40.816371 [debug] [Thread-2 (]: SQL status: OK in 0.094 seconds
[0m17:25:40.818887 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:25:40.821376 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:25:40.824154 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:25:40.829794 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: ROLLBACK
[0m17:25:40.831549 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_sma"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:25:40.837094 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: ROLLBACK
[0m17:25:40.840665 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139'
[0m17:25:40.844618 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d'
[0m17:25:40.846317 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: Close
[0m17:25:40.848161 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: Close
[0m17:25:40.852104 [info ] [Thread-2 (]: 31 of 52 PASS not_null_int__rsi_sma_ticker ..................................... [[32mPASS[0m in 0.21s]
[0m17:25:40.857190 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:25:40.854223 [info ] [Thread-4 (]: 30 of 52 PASS not_null_int__rsi_sma_rn ......................................... [[32mPASS[0m in 0.23s]
[0m17:25:40.861378 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:25:40.923973 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m17:25:40.933513 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: ROLLBACK
[0m17:25:40.936027 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0'
[0m17:25:40.937567 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: Close
[0m17:25:40.941169 [info ] [Thread-1 (]: 32 of 52 PASS not_null_int__rsi_sma_trade_date ................................. [[32mPASS[0m in 0.18s]
[0m17:25:40.944580 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:25:40.947125 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m17:25:40.949041 [info ] [Thread-3 (]: 33 of 52 SKIP relation analytics_dev.int__rsi_wilder ........................... [[33mSKIP[0m]
[0m17:25:40.951824 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m17:25:40.953627 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__rsi_wilder' to be skipped because of status 'skipped'. 
[0m17:25:40.957035 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:25:40.958823 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:25:40.960543 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:25:40.962255 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:25:40.964254 [info ] [Thread-2 (]: 34 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ....... [[33mSKIP[0m]
[0m17:25:40.967287 [info ] [Thread-1 (]: 36 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [[33mSKIP[0m]
[0m17:25:40.973427 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:25:40.969284 [info ] [Thread-4 (]: 35 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ....... [[33mSKIP[0m]
[0m17:25:40.976156 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:25:40.978198 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:25:40.971578 [info ] [Thread-3 (]: 37 of 52 SKIP test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [[33mSKIP[0m]
[0m17:25:40.980671 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:25:40.982336 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90' to be skipped because of status 'skipped'. 
[0m17:25:40.985480 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:25:40.989418 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:25:40.987469 [info ] [Thread-2 (]: 38 of 52 SKIP test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[33mSKIP[0m]
[0m17:25:40.992211 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:25:40.994123 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7' to be skipped because of status 'skipped'. 
[0m17:25:40.996091 [info ] [Thread-1 (]: 39 of 52 SKIP test not_null_int__rsi_wilder_gain ............................... [[33mSKIP[0m]
[0m17:25:40.997800 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:25:41.000645 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:25:41.004400 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703' to be skipped because of status 'skipped'. 
[0m17:25:41.002626 [info ] [Thread-4 (]: 40 of 52 SKIP test not_null_int__rsi_wilder_loss ............................... [[33mSKIP[0m]
[0m17:25:41.006899 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:25:41.010665 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:25:41.008893 [info ] [Thread-3 (]: 41 of 52 SKIP test not_null_int__rsi_wilder_rn ................................. [[33mSKIP[0m]
[0m17:25:41.013018 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d' to be skipped because of status 'skipped'. 
[0m17:25:41.014974 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:25:41.017626 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:25:41.021368 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:25:41.019632 [info ] [Thread-2 (]: 42 of 52 SKIP test not_null_int__rsi_wilder_ticker ............................. [[33mSKIP[0m]
[0m17:25:41.023649 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95' to be skipped because of status 'skipped'. 
[0m17:25:41.025807 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:25:41.029548 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:25:41.027834 [info ] [Thread-1 (]: 43 of 52 SKIP test not_null_int__rsi_wilder_trade_date ......................... [[33mSKIP[0m]
[0m17:25:41.032557 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:25:41.034336 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda' to be skipped because of status 'skipped'. 
[0m17:25:41.036297 [info ] [Thread-4 (]: 44 of 52 SKIP test not_null_int__rsi_wilder_wilder_gain ........................ [[33mSKIP[0m]
[0m17:25:41.040644 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:25:41.042669 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:25:41.038060 [info ] [Thread-3 (]: 45 of 52 SKIP test not_null_int__rsi_wilder_wilder_loss ........................ [[33mSKIP[0m]
[0m17:25:41.045334 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56' to be skipped because of status 'skipped'. 
[0m17:25:41.047258 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:25:41.051835 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:25:41.050092 [info ] [Thread-2 (]: 46 of 52 SKIP test wilder_seed_equals_sma ...................................... [[33mSKIP[0m]
[0m17:25:41.054148 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d' to be skipped because of status 'skipped'. 
[0m17:25:41.056783 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:25:41.058602 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd' to be skipped because of status 'skipped'. 
[0m17:25:41.060715 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c' to be skipped because of status 'skipped'. 
[0m17:25:41.062358 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9' to be skipped because of status 'skipped'. 
[0m17:25:41.063993 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb' to be skipped because of status 'skipped'. 
[0m17:25:41.065954 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.wilder_seed_equals_sma' to be skipped because of status 'skipped'. 
[0m17:25:41.068805 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.fct__rsi
[0m17:25:41.070549 [info ] [Thread-1 (]: 47 of 52 SKIP relation analytics_dev.fct__rsi .................................. [[33mSKIP[0m]
[0m17:25:41.072939 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m17:25:41.074624 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.fct__rsi' to be skipped because of status 'skipped'. 
[0m17:25:41.077474 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:25:41.079225 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:25:41.081128 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:25:41.083305 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:25:41.085340 [info ] [Thread-1 (]: 51 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ......... [[33mSKIP[0m]
[0m17:25:41.087142 [info ] [Thread-2 (]: 50 of 52 SKIP test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............ [[33mSKIP[0m]
[0m17:25:41.094697 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:25:41.096738 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:25:41.089842 [info ] [Thread-3 (]: 49 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[33mSKIP[0m]
[0m17:25:41.099435 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:25:41.101237 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0' to be skipped because of status 'skipped'. 
[0m17:25:41.092105 [info ] [Thread-4 (]: 48 of 52 SKIP test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[33mSKIP[0m]
[0m17:25:41.104029 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:25:41.108183 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a' to be skipped because of status 'skipped'. 
[0m17:25:41.106063 [info ] [Thread-1 (]: 52 of 52 SKIP test dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker  [[33mSKIP[0m]
[0m17:25:41.112036 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:25:41.114165 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2' to be skipped because of status 'skipped'. 
[0m17:25:41.116635 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:25:41.118875 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a' to be skipped because of status 'skipped'. 
[0m17:25:41.121007 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400' to be skipped because of status 'skipped'. 
[0m17:25:41.126693 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:41.128188 [debug] [MainThread]: On master: BEGIN
[0m17:25:41.129488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:25:41.133876 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:25:41.135320 [debug] [MainThread]: On master: COMMIT
[0m17:25:41.136614 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:41.137847 [debug] [MainThread]: On master: COMMIT
[0m17:25:41.140576 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:25:41.142039 [debug] [MainThread]: On master: Close
[0m17:25:41.143846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:41.145168 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:25:41.146337 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:25:41.147480 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0' was properly closed.
[0m17:25:41.148760 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d' was properly closed.
[0m17:25:41.149924 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065' was properly closed.
[0m17:25:41.151127 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139' was properly closed.
[0m17:25:41.152676 [info ] [MainThread]: 
[0m17:25:41.154585 [info ] [MainThread]: Finished running 47 data tests, 5 view models in 0 hours 0 minutes and 7.46 seconds (7.46s).
[0m17:25:41.179916 [debug] [MainThread]: Command end result
[0m17:25:41.444733 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:25:41.448293 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:25:41.459943 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:25:41.460523 [info ] [MainThread]: 
[0m17:25:41.461350 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:25:41.462166 [info ] [MainThread]: 
[0m17:25:41.463106 [error] [MainThread]: [31mFailure in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)[0m
[0m17:25:41.463983 [error] [MainThread]:   Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_gain (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:25:41.464846 [info ] [MainThread]: 
[0m17:25:41.465698 [error] [MainThread]: [31mFailure in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)[0m
[0m17:25:41.466710 [error] [MainThread]:   Compilation Error in test dbt_utils_not_null_where_int__rsi_sma_sma_loss (models\silver\silver_schema.yml)
  'dict object' has no attribute 'test_not_null_where'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:25:41.467534 [info ] [MainThread]: 
[0m17:25:41.468323 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=2 SKIP=20 NO-OP=0 TOTAL=52
[0m17:25:41.469526 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:25:41.471267 [debug] [MainThread]: Command `-c build` failed at 17:25:41.471062 after 13.83 seconds
[0m17:25:41.471877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CA8D4F150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB2D18C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAF83EB70>]}
[0m17:25:41.472565 [debug] [MainThread]: Flushing usage events
[0m17:25:42.421998 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:53.509196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3BF18050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3C7242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3CD63ED0>]}


============================== 17:27:53.524632 | 793993c1-ab1f-447b-bd69-20f436741a7c ==============================
[0m17:27:53.524632 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:27:53.527046 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m17:27:54.102662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '793993c1-ab1f-447b-bd69-20f436741a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3C0D0180>]}
[0m17:27:54.191904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '793993c1-ab1f-447b-bd69-20f436741a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3CC07790>]}
[0m17:27:54.195603 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:27:54.686913 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:27:55.069834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:27:55.071147 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\silver_schema.yml
[0m17:27:55.811372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '793993c1-ab1f-447b-bd69-20f436741a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3E5FD550>]}
[0m17:27:56.009321 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:27:56.012435 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:27:56.093209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '793993c1-ab1f-447b-bd69-20f436741a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3E89FD40>]}
[0m17:27:56.094315 [info ] [MainThread]: Found 6 models, 47 data tests, 2 sources, 853 macros
[0m17:27:56.095628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '793993c1-ab1f-447b-bd69-20f436741a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3E7E04B0>]}
[0m17:27:56.105007 [info ] [MainThread]: 
[0m17:27:56.106290 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:27:56.107218 [info ] [MainThread]: 
[0m17:27:56.108184 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:27:56.116210 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:27:56.249993 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:27:56.250517 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:27:56.250945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:58.076015 [debug] [ThreadPool]: SQL status: OK in 1.825 seconds
[0m17:27:58.077651 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:27:58.078927 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:27:58.204433 [debug] [ThreadPool]: SQL status: OK in 0.124 seconds
[0m17:27:58.206578 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:27:58.208049 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:27:58.208506 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:27:58.211462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '793993c1-ab1f-447b-bd69-20f436741a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3E9435F0>]}
[0m17:27:58.212223 [debug] [MainThread]: Using duckdb connection "master"
[0m17:27:58.212793 [debug] [MainThread]: On master: BEGIN
[0m17:27:58.213284 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:27:58.215012 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:27:58.215560 [debug] [MainThread]: On master: COMMIT
[0m17:27:58.216075 [debug] [MainThread]: Using duckdb connection "master"
[0m17:27:58.216573 [debug] [MainThread]: On master: COMMIT
[0m17:27:58.217563 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:27:58.218124 [debug] [MainThread]: On master: Close
[0m17:27:58.226824 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:27:58.228381 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:27:58.229317 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:27:58.227707 [info ] [Thread-1 (]: 1 of 47 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [RUN]
[0m17:27:58.231454 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:27:58.230582 [info ] [Thread-4 (]: 4 of 47 START test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ......... [RUN]
[0m17:27:58.233858 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a'
[0m17:27:58.232724 [info ] [Thread-3 (]: 3 of 47 START test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............ [RUN]
[0m17:27:58.236094 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0'
[0m17:27:58.235049 [info ] [Thread-2 (]: 2 of 47 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [RUN]
[0m17:27:58.237506 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:27:58.238785 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a'
[0m17:27:58.239819 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:27:58.241131 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2'
[0m17:27:58.254195 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:27:58.318687 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:27:58.340341 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:27:58.342228 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:27:58.359075 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:27:58.378534 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:27:58.382571 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:27:58.450176 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:27:58.460127 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:27:58.469707 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:27:58.471471 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:27:58.473464 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:27:58.484412 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:27:58.493266 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:27:58.498062 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:27:58.499911 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: BEGIN
[0m17:27:58.501470 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:27:58.505434 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:27:58.507698 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:27:58.509414 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: BEGIN
[0m17:27:58.511222 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:27:58.513708 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: BEGIN
[0m17:27:58.514934 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m17:27:58.516719 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:27:58.518493 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: BEGIN
[0m17:27:58.520255 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:27:58.522054 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:27:58.524575 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:27:58.527239 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and wilder_rsi >= 0 and wilder_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m17:27:58.529176 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m17:27:58.531801 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:27:58.533470 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:27:58.535951 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:27:58.537725 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m17:27:58.539452 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where sma_rs is not null) dbt_subquery

where not(sma_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m17:27:58.541461 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and sma_rsi >= 0 and sma_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m17:27:58.543415 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:27:58.547153 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where wilder_rs is not null) dbt_subquery

where not(wilder_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:00.116610 [debug] [Thread-1 (]: SQL status: OK in 1.571 seconds
[0m17:28:00.118525 [debug] [Thread-2 (]: SQL status: OK in 1.587 seconds
[0m17:28:00.120142 [debug] [Thread-3 (]: SQL status: OK in 1.575 seconds
[0m17:28:00.121868 [debug] [Thread-4 (]: SQL status: OK in 1.573 seconds
[0m17:28:00.141709 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: ROLLBACK
[0m17:28:00.146357 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: ROLLBACK
[0m17:28:00.151536 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: ROLLBACK
[0m17:28:00.155146 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2'
[0m17:28:00.157526 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a'
[0m17:28:00.160000 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a'
[0m17:28:00.165303 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: ROLLBACK
[0m17:28:00.167066 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: Close
[0m17:28:00.168881 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: Close
[0m17:28:00.170566 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: Close
[0m17:28:00.173086 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0'
[0m17:28:00.175466 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: Close
[0m17:28:00.178168 [info ] [Thread-1 (]: 1 of 47 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[32mPASS[0m in 1.94s]
[0m17:28:00.185698 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:28:00.180364 [info ] [Thread-3 (]: 3 of 47 PASS dbt_utils_expression_is_true_fct__rsi_sma_rs___0 .................. [[32mPASS[0m in 1.94s]
[0m17:28:00.190231 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:28:00.182558 [info ] [Thread-2 (]: 2 of 47 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[32mPASS[0m in 1.94s]
[0m17:28:00.193878 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:28:00.188542 [info ] [Thread-4 (]: 4 of 47 PASS dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ............... [[32mPASS[0m in 1.95s]
[0m17:28:00.199034 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:28:00.210485 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:28:00.195997 [info ] [Thread-1 (]: 5 of 47 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m17:28:00.213965 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:28:00.216071 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:28:00.220323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7)
[0m17:28:00.218443 [info ] [Thread-3 (]: 6 of 47 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m17:28:00.222839 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:28:00.226673 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:28:00.224915 [info ] [Thread-2 (]: 7 of 47 START test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [RUN]
[0m17:28:00.229325 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e)
[0m17:28:00.253411 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:28:00.231265 [info ] [Thread-4 (]: 8 of 47 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .... [RUN]
[0m17:28:00.255709 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd)
[0m17:28:00.257618 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:28:00.259928 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m17:28:00.262129 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:28:00.284312 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:28:00.286905 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:28:00.288755 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:28:00.309458 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:28:00.325710 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:28:00.336860 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:28:00.340323 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:28:00.350756 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:28:00.353550 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:28:00.362869 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:28:00.364617 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:28:00.366735 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:28:00.378031 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:28:00.379583 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:28:00.381334 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m17:28:00.383312 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m17:28:00.385863 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:28:00.387745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:00.389506 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:00.391501 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: BEGIN
[0m17:28:00.393542 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:28:00.396940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:00.398863 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m17:28:00.400684 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m17:28:00.402730 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m17:28:00.405187 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:00.407266 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:28:00.410105 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:28:00.412051 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m17:28:00.414632 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m17:28:00.416783 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m17:28:00.418660 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m17:28:00.420369 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:28:00.425687 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(abs(delta) - (gain + loss)) <= 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:28:00.423697 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:28:00.428393 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:00.518139 [debug] [Thread-3 (]: SQL status: OK in 0.096 seconds
[0m17:28:00.524438 [debug] [Thread-2 (]: SQL status: OK in 0.097 seconds
[0m17:28:00.526403 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m17:28:00.528104 [debug] [Thread-4 (]: SQL status: OK in 0.098 seconds
[0m17:28:00.533933 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m17:28:00.539748 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: ROLLBACK
[0m17:28:00.545330 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m17:28:00.548501 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:28:00.551036 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd'
[0m17:28:00.558777 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m17:28:00.553658 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:28:00.560878 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m17:28:00.562662 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: Close
[0m17:28:00.565314 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m17:28:00.567130 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m17:28:00.569407 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m17:28:00.571876 [info ] [Thread-3 (]: 6 of 47 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.34s]
[0m17:28:00.577413 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:28:00.573968 [info ] [Thread-2 (]: 7 of 47 PASS dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[32mPASS[0m in 0.32s]
[0m17:28:00.581871 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:28:00.580170 [info ] [Thread-1 (]: 5 of 47 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.36s]
[0m17:28:00.587677 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:28:00.584357 [info ] [Thread-4 (]: 8 of 47 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 .......... [[32mPASS[0m in 0.32s]
[0m17:28:00.592986 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:28:00.590122 [info ] [Thread-3 (]: 9 of 47 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .... [RUN]
[0m17:28:00.595769 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:28:00.599106 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:28:00.601214 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:28:00.603506 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m17:28:00.607571 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:28:00.605808 [info ] [Thread-2 (]: 10 of 47 START test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [RUN]
[0m17:28:00.611842 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:28:00.610209 [info ] [Thread-1 (]: 11 of 47 START test dbt_utils_expression_is_true_int__rsi_sma_gain___0 ......... [RUN]
[0m17:28:00.616662 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96)
[0m17:28:00.614262 [info ] [Thread-4 (]: 12 of 47 START test dbt_utils_expression_is_true_int__rsi_sma_loss___0 ......... [RUN]
[0m17:28:00.634939 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:28:00.636777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6)
[0m17:28:00.638689 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:28:00.640657 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62)
[0m17:28:00.643059 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:28:00.661588 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:28:00.663545 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:28:00.685934 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:28:00.698496 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:28:00.724554 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:28:00.715035 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:28:00.728478 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:28:00.738215 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:28:00.739967 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:28:00.748566 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:28:00.753060 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:28:00.754796 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m17:28:00.757432 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:00.759129 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:28:00.761081 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:28:00.771235 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:28:00.773046 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: BEGIN
[0m17:28:00.774908 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:28:00.776682 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m17:28:00.778782 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:00.780950 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: BEGIN
[0m17:28:00.782934 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:28:00.784879 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:28:00.787247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:00.789138 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:00.791092 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: BEGIN
[0m17:28:00.793825 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m17:28:00.797150 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:00.799399 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:28:00.802269 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:28:00.804185 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m17:28:00.806742 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:28:00.808376 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m17:28:00.810141 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:00.812061 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:28:00.814571 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:00.944445 [debug] [Thread-2 (]: SQL status: OK in 0.138 seconds
[0m17:28:00.946200 [debug] [Thread-3 (]: SQL status: OK in 0.150 seconds
[0m17:28:00.948376 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m17:28:00.950658 [debug] [Thread-4 (]: SQL status: OK in 0.134 seconds
[0m17:28:00.961688 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m17:28:00.956972 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: ROLLBACK
[0m17:28:00.968119 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: ROLLBACK
[0m17:28:00.973897 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: ROLLBACK
[0m17:28:00.976316 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m17:28:00.978826 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96'
[0m17:28:00.981440 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6'
[0m17:28:00.984061 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62'
[0m17:28:00.985845 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m17:28:00.987623 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: Close
[0m17:28:00.989648 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: Close
[0m17:28:00.991398 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: Close
[0m17:28:00.995159 [info ] [Thread-2 (]: 10 of 47 PASS dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[32mPASS[0m in 0.38s]
[0m17:28:00.997279 [info ] [Thread-1 (]: 11 of 47 PASS dbt_utils_expression_is_true_int__rsi_sma_gain___0 ............... [[32mPASS[0m in 0.36s]
[0m17:28:01.005128 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:28:01.007903 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:28:00.999376 [info ] [Thread-4 (]: 12 of 47 PASS dbt_utils_expression_is_true_int__rsi_sma_loss___0 ............... [[32mPASS[0m in 0.36s]
[0m17:28:01.010391 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:28:01.001420 [info ] [Thread-3 (]: 9 of 47 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 .......... [[32mPASS[0m in 0.40s]
[0m17:28:01.013517 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:28:01.016900 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:28:01.021932 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:28:01.018761 [info ] [Thread-2 (]: 13 of 47 START test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [RUN]
[0m17:28:01.026069 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:28:01.024284 [info ] [Thread-1 (]: 14 of 47 START test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ..... [RUN]
[0m17:28:01.028637 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:28:01.030721 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704)
[0m17:28:01.034481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9)
[0m17:28:01.032710 [info ] [Thread-4 (]: 15 of 47 START test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ..... [RUN]
[0m17:28:01.039154 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:28:01.037432 [info ] [Thread-3 (]: 16 of 47 START test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ...... [RUN]
[0m17:28:01.041545 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:28:01.043488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21)
[0m17:28:01.060565 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:28:01.062456 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90)
[0m17:28:01.081500 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:28:01.083300 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:28:01.085779 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:28:01.104725 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:28:01.106782 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:28:01.123815 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:28:01.133892 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:28:01.135665 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:28:01.138693 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:28:01.149175 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:28:01.160476 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:28:01.162845 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:28:01.165093 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: BEGIN
[0m17:28:01.166641 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:01.168827 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:28:01.178681 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:28:01.181057 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:28:01.183584 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m17:28:01.185804 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:28:01.187664 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: BEGIN
[0m17:28:01.189525 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:28:01.191460 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: BEGIN
[0m17:28:01.193417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:01.195347 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:28:01.197136 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:28:01.198992 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:01.201496 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: BEGIN
[0m17:28:01.204201 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:28:01.205835 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:01.208056 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:28:01.209903 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m17:28:01.212342 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:01.214256 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:28:01.216839 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m17:28:01.218584 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:01.220471 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:28:01.222987 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:01.294558 [debug] [Thread-2 (]: SQL status: OK in 0.091 seconds
[0m17:28:01.304356 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: ROLLBACK
[0m17:28:01.306288 [debug] [Thread-4 (]: SQL status: OK in 0.084 seconds
[0m17:28:01.308236 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m17:28:01.310604 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704'
[0m17:28:01.316319 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: ROLLBACK
[0m17:28:01.319922 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: Close
[0m17:28:01.323639 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: ROLLBACK
[0m17:28:01.326405 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21'
[0m17:28:01.328639 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: Close
[0m17:28:01.330929 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9'
[0m17:28:01.332798 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: Close
[0m17:28:01.336633 [info ] [Thread-4 (]: 15 of 47 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ........... [[32mPASS[0m in 0.29s]
[0m17:28:01.342612 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:28:01.335145 [info ] [Thread-2 (]: 13 of 47 PASS dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[32mPASS[0m in 0.30s]
[0m17:28:01.344942 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:28:01.348011 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:28:01.340336 [info ] [Thread-1 (]: 14 of 47 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ........... [[32mPASS[0m in 0.31s]
[0m17:28:01.352215 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:28:01.350472 [info ] [Thread-4 (]: 17 of 47 START test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ...... [RUN]
[0m17:28:01.355593 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:28:01.359654 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703)
[0m17:28:01.357431 [info ] [Thread-2 (]: 18 of 47 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [RUN]
[0m17:28:01.362248 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:28:01.364289 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:28:01.366304 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7)
[0m17:28:01.368332 [info ] [Thread-1 (]: 19 of 47 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [RUN]
[0m17:28:01.382576 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:28:01.391426 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:28:01.393451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d)
[0m17:28:01.409074 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:28:01.411424 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:28:01.432647 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:28:01.440289 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:28:01.448362 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:28:01.450454 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:28:01.460176 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:28:01.463134 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:28:01.473287 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:28:01.475732 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:28:01.477442 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: BEGIN
[0m17:28:01.479035 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:01.480814 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:28:01.483276 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: BEGIN
[0m17:28:01.484798 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:01.486884 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:28:01.488767 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:28:01.490733 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:28:01.492615 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: BEGIN
[0m17:28:01.494409 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m17:28:01.496124 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:01.497998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:01.499769 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:28:01.503010 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:01.505682 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:28:01.507346 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:28:01.509017 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:28:02.450849 [debug] [Thread-3 (]: SQL status: OK in 1.226 seconds
[0m17:28:02.459908 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: ROLLBACK
[0m17:28:02.462789 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90'
[0m17:28:02.464325 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: Close
[0m17:28:02.467509 [info ] [Thread-3 (]: 16 of 47 PASS dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ............ [[32mPASS[0m in 1.40s]
[0m17:28:02.470664 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:28:02.472402 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:28:02.474300 [info ] [Thread-3 (]: 20 of 47 START test dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker  [RUN]
[0m17:28:02.476524 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400)
[0m17:28:02.478259 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:28:02.495271 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400"
[0m17:28:02.509198 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:28:02.534151 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400"
[0m17:28:02.537912 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400"
[0m17:28:02.539588 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400: BEGIN
[0m17:28:02.541112 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:02.545550 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:28:02.547097 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400"
[0m17:28:02.548673 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        trade_date, ticker
    from "finance"."analytics_dev"."fct__rsi"
    group by trade_date, ticker
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:28:02.762763 [debug] [Thread-2 (]: SQL status: OK in 1.258 seconds
[0m17:28:02.764330 [debug] [Thread-1 (]: SQL status: OK in 1.254 seconds
[0m17:28:02.765655 [debug] [Thread-4 (]: SQL status: OK in 1.264 seconds
[0m17:28:02.769927 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: ROLLBACK
[0m17:28:02.774148 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: ROLLBACK
[0m17:28:02.777780 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: ROLLBACK
[0m17:28:02.779437 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7'
[0m17:28:02.781041 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d'
[0m17:28:02.782711 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703'
[0m17:28:02.783894 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: Close
[0m17:28:02.784998 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: Close
[0m17:28:02.786130 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: Close
[0m17:28:02.788807 [info ] [Thread-1 (]: 19 of 47 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0 ..... [[32mPASS[0m in 1.40s]
[0m17:28:02.793835 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:28:02.790351 [info ] [Thread-2 (]: 18 of 47 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0 ..... [[32mPASS[0m in 1.42s]
[0m17:28:02.795685 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:28:02.791673 [info ] [Thread-4 (]: 17 of 47 PASS dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ............ [[32mPASS[0m in 1.43s]
[0m17:28:02.798885 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:28:02.802788 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:28:02.800733 [info ] [Thread-1 (]: 21 of 47 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m17:28:02.804371 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:28:02.806121 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:28:02.807656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m17:28:02.809022 [info ] [Thread-2 (]: 22 of 47 START test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [RUN]
[0m17:28:02.811613 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:28:02.813136 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08)
[0m17:28:02.810166 [info ] [Thread-4 (]: 23 of 47 START test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [RUN]
[0m17:28:02.825359 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:28:02.826524 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:28:02.827706 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95)
[0m17:28:02.839921 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:28:02.841611 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:28:02.843057 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:28:02.859680 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:28:02.870192 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:28:02.872557 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:28:02.879544 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:28:02.881310 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:28:02.886745 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:28:02.888541 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:28:02.889776 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m17:28:02.890853 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:28:02.891868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:02.893035 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: BEGIN
[0m17:28:02.894711 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:28:02.895770 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:02.896958 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: BEGIN
[0m17:28:02.898247 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:28:02.900568 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:02.901662 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:28:02.902764 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:28:02.904296 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:28:02.905519 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:28:02.907241 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m17:28:02.908373 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_sma"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:28:02.909545 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:28:02.911205 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_wilder"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:28:03.054550 [debug] [Thread-1 (]: SQL status: OK in 0.148 seconds
[0m17:28:03.058968 [debug] [Thread-2 (]: SQL status: OK in 0.148 seconds
[0m17:28:03.064677 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m17:28:03.070596 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: ROLLBACK
[0m17:28:03.072853 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m17:28:03.076458 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m17:28:03.075481 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08'
[0m17:28:03.079129 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: Close
[0m17:28:03.081512 [info ] [Thread-1 (]: 21 of 47 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.27s]
[0m17:28:03.087127 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:28:03.085547 [info ] [Thread-2 (]: 22 of 47 PASS dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn .. [[32mPASS[0m in 0.27s]
[0m17:28:03.089686 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:28:03.092480 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:28:03.096403 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:28:03.094245 [info ] [Thread-1 (]: 24 of 47 START test not_null_int__price_changes_close .......................... [RUN]
[0m17:28:03.101119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m17:28:03.099236 [info ] [Thread-2 (]: 25 of 47 START test not_null_int__price_changes_gain ........................... [RUN]
[0m17:28:03.103785 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:28:03.105760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m17:28:03.128177 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:28:03.136407 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:28:03.154808 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:28:03.159436 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:28:03.167289 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:28:03.172002 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:28:03.183065 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:28:03.187464 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:28:03.189540 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m17:28:03.191236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:03.193004 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:28:03.195803 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m17:28:03.199120 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:03.202294 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:28:03.204371 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:28:03.206353 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:28:03.208521 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m17:28:03.210938 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:28:03.213867 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:28:03.480719 [debug] [Thread-1 (]: SQL status: OK in 0.271 seconds
[0m17:28:03.482417 [debug] [Thread-2 (]: SQL status: OK in 0.267 seconds
[0m17:28:03.491470 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m17:28:03.497341 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m17:28:03.499646 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m17:28:03.502243 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m17:28:03.503895 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m17:28:03.505638 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m17:28:03.510850 [info ] [Thread-1 (]: 24 of 47 PASS not_null_int__price_changes_close ................................ [[32mPASS[0m in 0.41s]
[0m17:28:03.514427 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:28:03.509354 [info ] [Thread-2 (]: 25 of 47 PASS not_null_int__price_changes_gain ................................. [[32mPASS[0m in 0.40s]
[0m17:28:03.516719 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:28:03.519534 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:28:03.523069 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:28:03.521344 [info ] [Thread-1 (]: 26 of 47 START test not_null_int__price_changes_loaded_at ...................... [RUN]
[0m17:28:03.528576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m17:28:03.526106 [info ] [Thread-2 (]: 27 of 47 START test not_null_int__price_changes_loss ........................... [RUN]
[0m17:28:03.530950 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:28:03.533522 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m17:28:03.549823 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:28:03.552408 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:28:03.571274 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:28:03.573859 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:28:03.584481 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:28:03.587906 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:28:03.597086 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:28:03.600261 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:28:03.602000 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m17:28:03.603843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:03.606896 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:28:03.608560 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m17:28:03.610113 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:28:03.611721 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:03.613510 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:28:03.616528 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:28:03.619355 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:28:03.621009 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:28:03.622621 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:28:03.795440 [debug] [Thread-1 (]: SQL status: OK in 0.177 seconds
[0m17:28:03.797440 [debug] [Thread-2 (]: SQL status: OK in 0.173 seconds
[0m17:28:03.807246 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m17:28:03.809776 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m17:28:03.815189 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m17:28:03.816823 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m17:28:03.819957 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m17:28:03.823776 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m17:28:03.822255 [info ] [Thread-1 (]: 26 of 47 PASS not_null_int__price_changes_loaded_at ............................ [[32mPASS[0m in 0.29s]
[0m17:28:03.827104 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:28:03.831055 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:28:03.829367 [info ] [Thread-2 (]: 27 of 47 PASS not_null_int__price_changes_loss ................................. [[32mPASS[0m in 0.30s]
[0m17:28:03.836372 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:28:03.833881 [info ] [Thread-1 (]: 28 of 47 START test not_null_int__price_changes_rn ............................. [RUN]
[0m17:28:03.838713 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:28:03.840938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m17:28:03.844543 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:28:03.842852 [info ] [Thread-2 (]: 29 of 47 START test not_null_int__price_changes_ticker ......................... [RUN]
[0m17:28:03.859739 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m17:28:03.864728 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:28:03.866511 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:28:03.882913 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:28:03.886537 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:28:03.888248 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:28:03.900074 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:28:03.910490 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:28:03.914907 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:28:03.916651 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m17:28:03.918423 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:28:03.920078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:03.921878 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m17:28:03.924476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:03.927047 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:28:03.928639 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:28:03.930248 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m17:28:03.931962 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:28:03.933970 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:28:03.936305 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:28:03.939331 [debug] [Thread-3 (]: SQL status: OK in 1.389 seconds
[0m17:28:03.949755 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400: ROLLBACK
[0m17:28:03.952437 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400'
[0m17:28:03.954009 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400: Close
[0m17:28:03.957570 [error] [Thread-3 (]: 20 of 47 FAIL 1270 dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker  [[31mFAIL 1270[0m in 1.48s]
[0m17:28:03.960758 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400
[0m17:28:03.962521 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:28:03.964416 [info ] [Thread-3 (]: 30 of 47 START test not_null_int__price_changes_trade_date ..................... [RUN]
[0m17:28:03.966746 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker.90e7f71400, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m17:28:03.968363 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:28:03.984096 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:28:03.987491 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:28:04.010983 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:28:04.014555 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:28:04.016580 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m17:28:04.018618 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:04.020898 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m17:28:04.022674 [debug] [Thread-2 (]: SQL status: OK in 0.084 seconds
[0m17:28:04.025063 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:28:04.026783 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:28:04.032857 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m17:28:04.034684 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.040254 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m17:28:04.043272 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m17:28:04.046043 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m17:28:04.048326 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m17:28:04.050092 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m17:28:04.053761 [info ] [Thread-1 (]: 28 of 47 PASS not_null_int__price_changes_rn ................................... [[32mPASS[0m in 0.21s]
[0m17:28:04.059234 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:28:04.056525 [info ] [Thread-2 (]: 29 of 47 PASS not_null_int__price_changes_ticker ............................... [[32mPASS[0m in 0.20s]
[0m17:28:04.061537 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:28:04.064742 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:28:04.068242 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:28:04.066491 [info ] [Thread-1 (]: 31 of 47 START test not_null_int__rsi_sma_close ................................ [RUN]
[0m17:28:04.070451 [info ] [Thread-2 (]: 32 of 47 START test not_null_int__rsi_sma_gain ................................. [RUN]
[0m17:28:04.072905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638, now test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b)
[0m17:28:04.074763 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a, now test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953)
[0m17:28:04.076547 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:28:04.078298 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:28:04.093548 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:28:04.112036 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:28:04.115734 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:28:04.123115 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:28:04.128137 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:28:04.138092 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:28:04.139979 [debug] [Thread-3 (]: SQL status: OK in 0.095 seconds
[0m17:28:04.143949 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:28:04.146436 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:28:04.148161 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: BEGIN
[0m17:28:04.154051 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m17:28:04.156023 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: BEGIN
[0m17:28:04.157846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:04.159983 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:04.162623 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m17:28:04.166282 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m17:28:04.168422 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:28:04.170117 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:28:04.171786 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:28:04.175671 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:28:04.174078 [info ] [Thread-3 (]: 30 of 47 PASS not_null_int__price_changes_trade_date ........................... [[32mPASS[0m in 0.21s]
[0m17:28:04.178023 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_sma"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.179951 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__rsi_sma"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.182726 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:28:04.185973 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:28:04.187886 [info ] [Thread-3 (]: 33 of 47 START test not_null_int__rsi_sma_loaded_at ............................ [RUN]
[0m17:28:04.190180 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5, now test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0)
[0m17:28:04.191905 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:28:04.210161 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:28:04.213760 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:28:04.223569 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:28:04.225655 [debug] [Thread-4 (]: SQL status: OK in 1.313 seconds
[0m17:28:04.229030 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:28:04.230701 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: BEGIN
[0m17:28:04.238203 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:04.236380 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: ROLLBACK
[0m17:28:04.241962 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95'
[0m17:28:04.243673 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: Close
[0m17:28:04.245305 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:28:04.247480 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:28:04.251776 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__rsi_sma"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.250182 [info ] [Thread-4 (]: 23 of 47 PASS dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[32mPASS[0m in 1.42s]
[0m17:28:04.255498 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:28:04.257834 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:28:04.259777 [info ] [Thread-4 (]: 34 of 47 START test not_null_int__rsi_sma_loss ................................. [RUN]
[0m17:28:04.262113 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95, now test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065)
[0m17:28:04.263801 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:28:04.282082 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:28:04.285653 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:28:04.295821 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:28:04.298332 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m17:28:04.301274 [debug] [Thread-2 (]: SQL status: OK in 0.116 seconds
[0m17:28:04.308259 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: ROLLBACK
[0m17:28:04.312623 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b'
[0m17:28:04.314470 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:28:04.316123 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: Close
[0m17:28:04.321691 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: ROLLBACK
[0m17:28:04.323663 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: BEGIN
[0m17:28:04.330529 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:04.326728 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953'
[0m17:28:04.329013 [info ] [Thread-1 (]: 31 of 47 PASS not_null_int__rsi_sma_close ...................................... [[32mPASS[0m in 0.26s]
[0m17:28:04.333917 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: Close
[0m17:28:04.336609 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:28:04.339054 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:28:04.340714 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m17:28:04.347231 [debug] [Thread-3 (]: SQL status: OK in 0.093 seconds
[0m17:28:04.343023 [info ] [Thread-2 (]: 32 of 47 PASS not_null_int__rsi_sma_gain ....................................... [[32mPASS[0m in 0.27s]
[0m17:28:04.349849 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:28:04.345334 [info ] [Thread-1 (]: 35 of 47 START test not_null_int__rsi_sma_rn ................................... [RUN]
[0m17:28:04.353904 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:28:04.355837 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_sma"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.361671 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: ROLLBACK
[0m17:28:04.363461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b, now test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139)
[0m17:28:04.365439 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:28:04.369704 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:28:04.372169 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0'
[0m17:28:04.390146 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:28:04.374347 [info ] [Thread-2 (]: 36 of 47 START test not_null_int__rsi_sma_sma_gain ............................. [RUN]
[0m17:28:04.392448 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: Close
[0m17:28:04.395100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953, now test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416)
[0m17:28:04.397601 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:28:04.410429 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:28:04.401092 [info ] [Thread-3 (]: 33 of 47 PASS not_null_int__rsi_sma_loaded_at .................................. [[32mPASS[0m in 0.21s]
[0m17:28:04.426947 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:28:04.431419 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:28:04.434102 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:28:04.437070 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:28:04.438755 [info ] [Thread-3 (]: 37 of 47 START test not_null_int__rsi_sma_sma_loss ............................. [RUN]
[0m17:28:04.441236 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0, now test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6)
[0m17:28:04.442964 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:28:04.462490 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:28:04.465469 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:28:04.469494 [debug] [Thread-4 (]: SQL status: OK in 0.102 seconds
[0m17:28:04.471201 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: BEGIN
[0m17:28:04.472821 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:28:04.475230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:04.484408 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:28:04.486868 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:28:04.492671 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: ROLLBACK
[0m17:28:04.503709 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:28:04.506266 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:28:04.508852 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065'
[0m17:28:04.511812 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:28:04.515429 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: Close
[0m17:28:04.518663 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:28:04.520633 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_sma"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.522940 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: BEGIN
[0m17:28:04.525530 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:04.530106 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:28:04.528402 [info ] [Thread-4 (]: 34 of 47 PASS not_null_int__rsi_sma_loss ....................................... [[32mPASS[0m in 0.26s]
[0m17:28:04.534105 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:28:04.532350 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: BEGIN
[0m17:28:04.537141 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:28:04.538889 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:28:04.540614 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:04.543031 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:28:04.545123 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_gain
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_gain is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.547913 [info ] [Thread-4 (]: 38 of 47 START test not_null_int__rsi_sma_ticker ............................... [RUN]
[0m17:28:04.551142 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065, now test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d)
[0m17:28:04.552851 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m17:28:04.554518 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:28:04.556302 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:28:04.573469 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:28:04.575895 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_loss
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_loss is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.581110 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:28:04.590435 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:28:04.593948 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:28:04.595669 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: BEGIN
[0m17:28:04.597133 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:04.601636 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:28:04.603430 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:28:04.605023 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_sma"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.615875 [debug] [Thread-1 (]: SQL status: OK in 0.091 seconds
[0m17:28:04.627385 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: ROLLBACK
[0m17:28:04.629949 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139'
[0m17:28:04.631485 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: Close
[0m17:28:04.634980 [info ] [Thread-1 (]: 35 of 47 PASS not_null_int__rsi_sma_rn ......................................... [[32mPASS[0m in 0.27s]
[0m17:28:04.638532 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:28:04.640342 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:28:04.641911 [debug] [Thread-2 (]: SQL status: OK in 0.092 seconds
[0m17:28:04.643623 [info ] [Thread-1 (]: 39 of 47 START test not_null_int__rsi_sma_trade_date ........................... [RUN]
[0m17:28:04.646415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139, now test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0)
[0m17:28:04.648029 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:28:04.666315 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:28:04.672518 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: ROLLBACK
[0m17:28:04.676056 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416'
[0m17:28:04.678049 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: Close
[0m17:28:04.680645 [debug] [Thread-3 (]: SQL status: OK in 0.102 seconds
[0m17:28:04.683367 [info ] [Thread-2 (]: 36 of 47 PASS not_null_int__rsi_sma_sma_gain ................................... [[32mPASS[0m in 0.29s]
[0m17:28:04.686633 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:28:04.689359 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:28:04.696745 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: ROLLBACK
[0m17:28:04.707004 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:28:04.709291 [debug] [Thread-4 (]: SQL status: OK in 0.103 seconds
[0m17:28:04.711149 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:28:04.714499 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6'
[0m17:28:04.719696 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: Close
[0m17:28:04.717265 [info ] [Thread-2 (]: 40 of 47 START test not_null_int__rsi_wilder_gain .............................. [RUN]
[0m17:28:04.727917 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: ROLLBACK
[0m17:28:04.730035 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416, now test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda)
[0m17:28:04.733404 [info ] [Thread-3 (]: 37 of 47 PASS not_null_int__rsi_sma_sma_loss ................................... [[32mPASS[0m in 0.29s]
[0m17:28:04.737372 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d'
[0m17:28:04.739424 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:28:04.741187 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:28:04.743836 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:28:04.745629 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: Close
[0m17:28:04.748394 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: BEGIN
[0m17:28:04.766722 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:28:04.768643 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:28:04.771294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:04.774123 [info ] [Thread-4 (]: 38 of 47 PASS not_null_int__rsi_sma_ticker ..................................... [[32mPASS[0m in 0.22s]
[0m17:28:04.777675 [info ] [Thread-3 (]: 41 of 47 START test not_null_int__rsi_wilder_loss .............................. [RUN]
[0m17:28:04.783102 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:28:04.785401 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:28:04.787661 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6, now test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56)
[0m17:28:04.789999 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m17:28:04.793222 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:28:04.821367 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:28:04.823153 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:28:04.825019 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:28:04.826850 [info ] [Thread-4 (]: 42 of 47 START test not_null_int__rsi_wilder_rn ................................ [RUN]
[0m17:28:04.844006 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_sma"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.846402 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:28:04.848424 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d, now test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d)
[0m17:28:04.852811 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:28:04.854137 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:28:04.855919 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: BEGIN
[0m17:28:04.873959 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:28:04.875792 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:04.877632 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:28:04.889433 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:28:04.891613 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m17:28:04.893427 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:28:04.895318 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:28:04.897165 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_wilder"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.907775 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:28:04.911066 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:28:04.912795 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: BEGIN
[0m17:28:04.914295 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:04.917215 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:28:04.919533 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: BEGIN
[0m17:28:04.921174 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:28:04.922802 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:04.924561 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:28:04.927351 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_wilder"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.931195 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:28:04.932803 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:28:04.934423 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_wilder"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:28:04.943916 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m17:28:04.957549 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: ROLLBACK
[0m17:28:04.960053 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0'
[0m17:28:04.961593 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: Close
[0m17:28:04.965465 [info ] [Thread-1 (]: 39 of 47 PASS not_null_int__rsi_sma_trade_date ................................. [[32mPASS[0m in 0.32s]
[0m17:28:04.968858 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:28:04.970563 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:28:04.972390 [info ] [Thread-1 (]: 43 of 47 START test not_null_int__rsi_wilder_ticker ............................ [RUN]
[0m17:28:04.974747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0, now test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd)
[0m17:28:04.976898 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:28:04.992942 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:28:04.996917 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:28:05.006072 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:28:05.010238 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:28:05.011965 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: BEGIN
[0m17:28:05.013453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:05.017999 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:28:05.019683 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:28:05.021281 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_wilder"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:28:06.167340 [debug] [Thread-3 (]: SQL status: OK in 1.237 seconds
[0m17:28:06.169950 [debug] [Thread-2 (]: SQL status: OK in 1.260 seconds
[0m17:28:06.172357 [debug] [Thread-4 (]: SQL status: OK in 1.236 seconds
[0m17:28:06.178747 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: ROLLBACK
[0m17:28:06.184178 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: ROLLBACK
[0m17:28:06.189895 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: ROLLBACK
[0m17:28:06.192266 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56'
[0m17:28:06.194798 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda'
[0m17:28:06.197391 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d'
[0m17:28:06.199147 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: Close
[0m17:28:06.200881 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: Close
[0m17:28:06.202634 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: Close
[0m17:28:06.206366 [info ] [Thread-3 (]: 41 of 47 PASS not_null_int__rsi_wilder_loss .................................... [[32mPASS[0m in 1.42s]
[0m17:28:06.213479 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:28:06.208465 [info ] [Thread-2 (]: 40 of 47 PASS not_null_int__rsi_wilder_gain .................................... [[32mPASS[0m in 1.48s]
[0m17:28:06.215801 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:28:06.210552 [info ] [Thread-4 (]: 42 of 47 PASS not_null_int__rsi_wilder_rn ...................................... [[32mPASS[0m in 1.36s]
[0m17:28:06.219297 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:28:06.223531 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:28:06.221069 [info ] [Thread-3 (]: 44 of 47 START test not_null_int__rsi_wilder_trade_date ........................ [RUN]
[0m17:28:06.226086 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:28:06.228092 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:28:06.230310 [debug] [Thread-1 (]: SQL status: OK in 1.207 seconds
[0m17:28:06.232163 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56, now test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c)
[0m17:28:06.234692 [info ] [Thread-2 (]: 45 of 47 START test not_null_int__rsi_wilder_wilder_gain ....................... [RUN]
[0m17:28:06.236710 [info ] [Thread-4 (]: 46 of 47 START test not_null_int__rsi_wilder_wilder_loss ....................... [RUN]
[0m17:28:06.240122 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:28:06.242077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9)
[0m17:28:06.248685 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: ROLLBACK
[0m17:28:06.250630 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb)
[0m17:28:06.269339 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:28:06.271068 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:28:06.273916 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd'
[0m17:28:06.275553 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:28:06.292493 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:28:06.295556 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: Close
[0m17:28:06.314211 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:28:06.316058 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:28:06.327588 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:28:06.330301 [info ] [Thread-1 (]: 43 of 47 PASS not_null_int__rsi_wilder_ticker .................................. [[32mPASS[0m in 1.36s]
[0m17:28:06.333811 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:28:06.335618 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:28:06.337263 [info ] [Thread-1 (]: 47 of 47 START test wilder_seed_equals_sma ..................................... [RUN]
[0m17:28:06.339680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd, now test.portfolio_project_2.wilder_seed_equals_sma)
[0m17:28:06.341723 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:28:06.351817 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:28:06.356028 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:28:06.360427 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:28:06.369030 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:28:06.372158 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:28:06.381980 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:28:06.383992 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: BEGIN
[0m17:28:06.387356 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:06.389794 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:28:06.400307 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:28:06.402103 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m17:28:06.404420 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:28:06.406319 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:28:06.407964 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:28:06.409882 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: BEGIN
[0m17:28:06.411782 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: BEGIN
[0m17:28:06.413631 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_wilder"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:28:06.415437 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:06.417290 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:06.419896 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:28:06.422962 [debug] [Thread-1 (]: On test.portfolio_project_2.wilder_seed_equals_sma: BEGIN
[0m17:28:06.424555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:06.427046 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m17:28:06.430084 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:28:06.432632 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m17:28:06.434371 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_gain
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_gain is null



  
  
      
    ) dbt_internal_test
[0m17:28:06.436075 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:28:06.437852 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:28:06.440307 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:28:06.442147 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_loss is null



  
  
      
    ) dbt_internal_test
[0m17:28:06.443814 [debug] [Thread-1 (]: On test.portfolio_project_2.wilder_seed_equals_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.wilder_seed_equals_sma"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- asserts the seed matches SMA at rn=14
with w as (
  select ticker, trade_date, wilder_gain, wilder_loss
  from "finance"."analytics_dev"."int__rsi_wilder"
  where rn = 14
),
s as (
  select ticker, trade_date, sma_gain, sma_loss
  from "finance"."analytics_dev"."int__rsi_sma"
  where rn = 14
)
select
  w.ticker,
  w.trade_date
from w
join s using (ticker, trade_date)
where abs(w.wilder_gain - s.sma_gain) > 1e-9
   or abs(w.wilder_loss - s.sma_loss) > 1e-9;
  
  
      
    ) dbt_internal_test
[0m17:28:06.462250 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.wilder_seed_equals_sma"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- asserts the seed matches SMA at rn=14
with w as (
  select ticker, trade_date, wilder_gain, wilder_loss
  from "finance"."analytics_dev"."int__rsi_wilder"
  where rn = 14
),
s as (
  select ticker, trade_date, sma_gain, sma_loss
  from "finance"."analytics_dev"."int__rsi_sma"
  where rn = 14
)
select
  w.ticker,
  w.trade_date
from w
join s using (ticker, trade_date)
where abs(w.wilder_gain - s.sma_gain) > 1e-9
   or abs(w.wilder_loss - s.sma_loss) > 1e-9;
  
  
      
    ) dbt_internal_test
[0m17:28:06.464093 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:28:06.465953 [debug] [Thread-1 (]: On test.portfolio_project_2.wilder_seed_equals_sma: ROLLBACK
[0m17:28:06.493794 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.wilder_seed_equals_sma'
[0m17:28:06.495444 [debug] [Thread-1 (]: On test.portfolio_project_2.wilder_seed_equals_sma: Close
[0m17:28:06.510253 [debug] [Thread-1 (]: Runtime Error in test wilder_seed_equals_sma (tests\wilder_seed_equals_sma.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 27:    or abs(w.wilder_loss - s.sma_loss) > 1e-9;
                                                       ^
[0m17:28:06.511642 [error] [Thread-1 (]: 47 of 47 ERROR wilder_seed_equals_sma .......................................... [[31mERROR[0m in 0.17s]
[0m17:28:06.513871 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:28:06.515667 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.wilder_seed_equals_sma' to be skipped because of status 'error'.  Reason: Runtime Error in test wilder_seed_equals_sma (tests\wilder_seed_equals_sma.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 27:    or abs(w.wilder_loss - s.sma_loss) > 1e-9;
                                                       ^.
[0m17:28:07.898170 [debug] [Thread-3 (]: SQL status: OK in 1.479 seconds
[0m17:28:07.899908 [debug] [Thread-2 (]: SQL status: OK in 1.460 seconds
[0m17:28:07.901870 [debug] [Thread-4 (]: SQL status: OK in 1.455 seconds
[0m17:28:07.910944 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: ROLLBACK
[0m17:28:07.922776 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: ROLLBACK
[0m17:28:07.925356 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c'
[0m17:28:07.928324 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: ROLLBACK
[0m17:28:07.931659 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb'
[0m17:28:07.933309 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: Close
[0m17:28:07.936530 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9'
[0m17:28:07.938243 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: Close
[0m17:28:07.940381 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: Close
[0m17:28:07.942888 [info ] [Thread-3 (]: 44 of 47 PASS not_null_int__rsi_wilder_trade_date .............................. [[32mPASS[0m in 1.71s]
[0m17:28:07.946760 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:28:07.951266 [info ] [Thread-4 (]: 46 of 47 PASS not_null_int__rsi_wilder_wilder_loss ............................. [[32mPASS[0m in 1.70s]
[0m17:28:07.955878 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:28:07.949092 [info ] [Thread-2 (]: 45 of 47 PASS not_null_int__rsi_wilder_wilder_gain ............................. [[32mPASS[0m in 1.71s]
[0m17:28:07.959951 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:28:07.966561 [debug] [MainThread]: Using duckdb connection "master"
[0m17:28:07.968477 [debug] [MainThread]: On master: BEGIN
[0m17:28:07.969758 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:28:07.974265 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:28:07.975825 [debug] [MainThread]: On master: COMMIT
[0m17:28:07.977396 [debug] [MainThread]: Using duckdb connection "master"
[0m17:28:07.979474 [debug] [MainThread]: On master: COMMIT
[0m17:28:07.984430 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:28:07.986236 [debug] [MainThread]: On master: Close
[0m17:28:07.988102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:07.989588 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:28:07.991516 [debug] [MainThread]: Connection 'test.portfolio_project_2.wilder_seed_equals_sma' was properly closed.
[0m17:28:07.992911 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb' was properly closed.
[0m17:28:07.994153 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c' was properly closed.
[0m17:28:07.995373 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9' was properly closed.
[0m17:28:07.996822 [info ] [MainThread]: 
[0m17:28:07.999016 [info ] [MainThread]: Finished running 47 data tests in 0 hours 0 minutes and 11.89 seconds (11.89s).
[0m17:28:08.047960 [debug] [MainThread]: Command end result
[0m17:28:08.279923 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:28:08.289055 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:28:08.325960 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:28:08.327076 [info ] [MainThread]: 
[0m17:28:08.328533 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:28:08.330191 [info ] [MainThread]: 
[0m17:28:08.332206 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_fct__rsi_trade_date__ticker (models\gold\gold_schema.yml)[0m
[0m17:28:08.333933 [error] [MainThread]:   Got 1270 results, configured to fail if != 0
[0m17:28:08.335395 [info ] [MainThread]: 
[0m17:28:08.337004 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\gold_schema.yml\dbt_utils_unique_combination_o_e60dcae9a0b9171ab7dfce8de5514920.sql
[0m17:28:08.338394 [info ] [MainThread]: 
[0m17:28:08.339985 [error] [MainThread]: [31mFailure in test wilder_seed_equals_sma (tests\wilder_seed_equals_sma.sql)[0m
[0m17:28:08.341715 [error] [MainThread]:   Runtime Error in test wilder_seed_equals_sma (tests\wilder_seed_equals_sma.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 27:    or abs(w.wilder_loss - s.sma_loss) > 1e-9;
                                                       ^
[0m17:28:08.343171 [info ] [MainThread]: 
[0m17:28:08.344714 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\tests\wilder_seed_equals_sma.sql
[0m17:28:08.346133 [info ] [MainThread]: 
[0m17:28:08.347543 [info ] [MainThread]: Done. PASS=45 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=47
[0m17:28:08.350376 [debug] [MainThread]: Command `-c test` failed at 17:28:08.349993 after 15.26 seconds
[0m17:28:08.351496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3CB5F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3E979A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3E97A0A0>]}
[0m17:28:08.352584 [debug] [MainThread]: Flushing usage events
[0m17:28:09.273396 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:39.815402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD0CC8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD14D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD1B13ED0>]}


============================== 17:29:39.830469 | 34028a95-276c-4a74-a9f7-810877f5473e ==============================
[0m17:29:39.830469 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:29:39.832940 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt test', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m17:29:40.312896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34028a95-276c-4a74-a9f7-810877f5473e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD0E80180>]}
[0m17:29:40.407579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34028a95-276c-4a74-a9f7-810877f5473e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD19BB790>]}
[0m17:29:40.411591 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:29:40.792975 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:29:41.205070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:29:41.206129 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\gold\gold_schema.yml
[0m17:29:41.206679 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://tests\wilder_seed_equals_sma.sql
[0m17:29:41.861259 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m17:29:41.862459 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m17:29:41.863198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '34028a95-276c-4a74-a9f7-810877f5473e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD3372550>]}
[0m17:29:42.178533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34028a95-276c-4a74-a9f7-810877f5473e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD32C3020>]}
[0m17:29:42.379923 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:29:42.382958 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:29:42.475048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34028a95-276c-4a74-a9f7-810877f5473e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD36D0AD0>]}
[0m17:29:42.476428 [info ] [MainThread]: Found 6 models, 46 data tests, 2 sources, 853 macros
[0m17:29:42.477942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34028a95-276c-4a74-a9f7-810877f5473e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD36F3EE0>]}
[0m17:29:42.490219 [info ] [MainThread]: 
[0m17:29:42.491792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:29:42.493233 [info ] [MainThread]: 
[0m17:29:42.495337 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:29:42.511488 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:29:42.704247 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:29:42.704727 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:29:42.705124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:43.959978 [debug] [ThreadPool]: SQL status: OK in 1.255 seconds
[0m17:29:43.960938 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:29:43.961780 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:29:44.067670 [debug] [ThreadPool]: SQL status: OK in 0.105 seconds
[0m17:29:44.071261 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:29:44.073783 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:29:44.074602 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:29:44.079366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34028a95-276c-4a74-a9f7-810877f5473e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD342D0D0>]}
[0m17:29:44.080525 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:44.081351 [debug] [MainThread]: On master: BEGIN
[0m17:29:44.082143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:29:44.085003 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:29:44.085882 [debug] [MainThread]: On master: COMMIT
[0m17:29:44.086725 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:44.087524 [debug] [MainThread]: On master: COMMIT
[0m17:29:44.089090 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:29:44.089972 [debug] [MainThread]: On master: Close
[0m17:29:44.101187 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:29:44.102294 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:29:44.103360 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:29:44.105382 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:29:44.104440 [info ] [Thread-1 (]: 1 of 46 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [RUN]
[0m17:29:44.106838 [info ] [Thread-3 (]: 3 of 46 START test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............ [RUN]
[0m17:29:44.107864 [info ] [Thread-2 (]: 2 of 46 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [RUN]
[0m17:29:44.111060 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a'
[0m17:29:44.112570 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a'
[0m17:29:44.109202 [info ] [Thread-4 (]: 4 of 46 START test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ......... [RUN]
[0m17:29:44.114272 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2'
[0m17:29:44.115424 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:29:44.116566 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:29:44.118012 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0'
[0m17:29:44.119126 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:29:44.150813 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:29:44.162750 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:29:44.163913 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:29:44.175677 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:29:44.188796 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:29:44.191549 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:29:44.193076 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:29:44.244494 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:29:44.238688 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:29:44.245941 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:29:44.247305 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:29:44.253641 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:29:44.259496 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:29:44.261696 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:29:44.263516 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: BEGIN
[0m17:29:44.264523 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:29:44.262874 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:29:44.267122 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: BEGIN
[0m17:29:44.268351 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:29:44.269553 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:29:44.271080 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:29:44.272400 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:29:44.273513 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: BEGIN
[0m17:29:44.274723 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m17:29:44.275823 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:29:44.276883 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: BEGIN
[0m17:29:44.277990 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:29:44.279148 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and sma_rsi >= 0 and sma_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m17:29:44.280351 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m17:29:44.281436 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:29:44.283630 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where sma_rs is not null) dbt_subquery

where not(sma_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:44.285690 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:29:44.287911 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:29:44.286858 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m17:29:44.289985 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m17:29:44.291580 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and wilder_rsi >= 0 and wilder_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m17:29:44.292858 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where wilder_rs is not null) dbt_subquery

where not(wilder_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:45.690859 [debug] [Thread-4 (]: SQL status: OK in 1.396 seconds
[0m17:29:45.694152 [debug] [Thread-2 (]: SQL status: OK in 1.400 seconds
[0m17:29:45.692600 [debug] [Thread-1 (]: SQL status: OK in 1.409 seconds
[0m17:29:45.696557 [debug] [Thread-3 (]: SQL status: OK in 1.411 seconds
[0m17:29:45.720252 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: ROLLBACK
[0m17:29:45.723730 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: ROLLBACK
[0m17:29:45.731962 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: ROLLBACK
[0m17:29:45.738227 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: ROLLBACK
[0m17:29:45.740829 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a'
[0m17:29:45.744035 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0'
[0m17:29:45.746542 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2'
[0m17:29:45.749184 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a'
[0m17:29:45.750969 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: Close
[0m17:29:45.752754 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: Close
[0m17:29:45.754502 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: Close
[0m17:29:45.756268 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: Close
[0m17:29:45.759993 [info ] [Thread-3 (]: 3 of 46 PASS dbt_utils_expression_is_true_fct__rsi_sma_rs___0 .................. [[32mPASS[0m in 1.65s]
[0m17:29:45.768935 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m17:29:45.770565 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:29:45.762131 [info ] [Thread-2 (]: 2 of 46 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[32mPASS[0m in 1.65s]
[0m17:29:45.764181 [info ] [Thread-1 (]: 1 of 46 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[32mPASS[0m in 1.65s]
[0m17:29:45.777731 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m17:29:45.780531 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m17:29:45.766201 [info ] [Thread-4 (]: 4 of 46 PASS dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ............... [[32mPASS[0m in 1.65s]
[0m17:29:45.783055 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:29:45.773906 [info ] [Thread-3 (]: 5 of 46 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m17:29:45.785959 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:29:45.788800 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m17:29:45.790646 [info ] [Thread-2 (]: 6 of 46 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m17:29:45.793053 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7)
[0m17:29:45.796761 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:29:45.794985 [info ] [Thread-1 (]: 7 of 46 START test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [RUN]
[0m17:29:45.799638 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e)
[0m17:29:45.802179 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:29:45.804322 [info ] [Thread-4 (]: 8 of 46 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .... [RUN]
[0m17:29:45.807516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd)
[0m17:29:45.809312 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:29:45.831886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m17:29:45.834169 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:29:45.835880 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:29:45.855306 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:29:45.857031 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:29:45.877957 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:29:45.894837 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:29:45.897374 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:29:45.905291 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:29:45.914459 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:29:45.932856 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:29:45.938455 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:29:45.936126 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:29:45.948285 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:29:45.954724 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:29:45.957198 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:29:45.963591 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:29:45.965390 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m17:29:45.967227 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m17:29:45.971269 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:29:45.969719 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:45.973538 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:45.975781 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: BEGIN
[0m17:29:45.979739 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:29:45.981725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:45.983665 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:29:45.987000 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m17:29:45.985354 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m17:29:45.990164 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m17:29:45.992050 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m17:29:45.993912 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:45.995667 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m17:29:45.997424 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m17:29:45.999422 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m17:29:46.002279 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m17:29:46.005500 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m17:29:46.007296 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(abs(delta) - (gain + loss)) <= 1e-9)


  
  
      
    ) dbt_internal_test
[0m17:29:46.009230 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m17:29:46.011826 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:46.097388 [debug] [Thread-3 (]: SQL status: OK in 0.093 seconds
[0m17:29:46.107511 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m17:29:46.109975 [debug] [Thread-4 (]: SQL status: OK in 0.096 seconds
[0m17:29:46.111921 [debug] [Thread-2 (]: SQL status: OK in 0.107 seconds
[0m17:29:46.109179 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m17:29:46.115413 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m17:29:46.118182 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m17:29:46.124365 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m17:29:46.130300 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: ROLLBACK
[0m17:29:46.137753 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m17:29:46.132594 [info ] [Thread-3 (]: 5 of 46 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.34s]
[0m17:29:46.141601 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m17:29:46.144234 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd'
[0m17:29:46.147221 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m17:29:46.149506 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m17:29:46.151430 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m17:29:46.153309 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: Close
[0m17:29:46.155290 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:29:46.157289 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m17:29:46.159996 [info ] [Thread-3 (]: 9 of 46 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .... [RUN]
[0m17:29:46.167808 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m17:29:46.162381 [info ] [Thread-1 (]: 7 of 46 PASS dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[32mPASS[0m in 0.36s]
[0m17:29:46.172581 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:29:46.175777 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m17:29:46.164869 [info ] [Thread-4 (]: 8 of 46 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 .......... [[32mPASS[0m in 0.33s]
[0m17:29:46.193410 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:29:46.195457 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:29:46.170342 [info ] [Thread-2 (]: 6 of 46 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.37s]
[0m17:29:46.199303 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m17:29:46.204283 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m17:29:46.201622 [info ] [Thread-1 (]: 10 of 46 START test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [RUN]
[0m17:29:46.207542 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:29:46.209399 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:29:46.211623 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:29:46.213761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96)
[0m17:29:46.228644 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:29:46.216130 [info ] [Thread-4 (]: 11 of 46 START test dbt_utils_expression_is_true_int__rsi_sma_gain___0 ......... [RUN]
[0m17:29:46.233020 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:29:46.230921 [info ] [Thread-2 (]: 12 of 46 START test dbt_utils_expression_is_true_int__rsi_sma_loss___0 ......... [RUN]
[0m17:29:46.236270 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6)
[0m17:29:46.257720 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:29:46.260791 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62)
[0m17:29:46.262725 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:29:46.264734 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:29:46.266902 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:29:46.273974 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m17:29:46.286939 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:29:46.304226 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:29:46.306536 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:29:46.308424 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:46.319189 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:29:46.323029 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:29:46.324851 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:29:46.331172 [debug] [Thread-3 (]: SQL status: OK in 0.023 seconds
[0m17:29:46.340483 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:29:46.346268 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:29:46.348362 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m17:29:46.350820 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:29:46.353280 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:46.355238 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: BEGIN
[0m17:29:46.357714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:46.360079 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:29:46.361908 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:29:46.364377 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: BEGIN
[0m17:29:46.366170 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: BEGIN
[0m17:29:46.367938 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:46.369694 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:29:46.371317 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:46.373863 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m17:29:46.376475 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:29:46.378845 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m17:29:46.380731 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m17:29:46.382689 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m17:29:46.384577 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m17:29:46.386492 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:46.388615 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:46.550581 [debug] [Thread-1 (]: SQL status: OK in 0.172 seconds
[0m17:29:46.552370 [debug] [Thread-3 (]: SQL status: OK in 0.195 seconds
[0m17:29:46.553948 [debug] [Thread-4 (]: SQL status: OK in 0.163 seconds
[0m17:29:46.556293 [debug] [Thread-2 (]: SQL status: OK in 0.166 seconds
[0m17:29:46.561577 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: ROLLBACK
[0m17:29:46.566727 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m17:29:46.572279 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: ROLLBACK
[0m17:29:46.577568 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: ROLLBACK
[0m17:29:46.579730 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96'
[0m17:29:46.582141 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m17:29:46.584425 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6'
[0m17:29:46.586800 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62'
[0m17:29:46.588575 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: Close
[0m17:29:46.590167 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m17:29:46.591771 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: Close
[0m17:29:46.593380 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: Close
[0m17:29:46.597633 [info ] [Thread-2 (]: 12 of 46 PASS dbt_utils_expression_is_true_int__rsi_sma_loss___0 ............... [[32mPASS[0m in 0.34s]
[0m17:29:46.599520 [info ] [Thread-4 (]: 11 of 46 PASS dbt_utils_expression_is_true_int__rsi_sma_gain___0 ............... [[32mPASS[0m in 0.36s]
[0m17:29:46.606905 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m17:29:46.608605 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m17:29:46.600721 [info ] [Thread-1 (]: 10 of 46 PASS dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[32mPASS[0m in 0.38s]
[0m17:29:46.610768 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:29:46.612984 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:29:46.602578 [info ] [Thread-3 (]: 9 of 46 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 .......... [[32mPASS[0m in 0.43s]
[0m17:29:46.616175 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m17:29:46.617919 [info ] [Thread-4 (]: 13 of 46 START test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [RUN]
[0m17:29:46.623302 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m17:29:46.619488 [info ] [Thread-2 (]: 14 of 46 START test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ..... [RUN]
[0m17:29:46.625657 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:29:46.627652 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704)
[0m17:29:46.629624 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:29:46.631543 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9)
[0m17:29:46.634809 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:29:46.633288 [info ] [Thread-1 (]: 15 of 46 START test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ..... [RUN]
[0m17:29:46.638697 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:29:46.636990 [info ] [Thread-3 (]: 16 of 46 START test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ...... [RUN]
[0m17:29:46.659351 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:29:46.662575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21)
[0m17:29:46.679481 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:29:46.681169 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90)
[0m17:29:46.683440 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:29:46.685820 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:29:46.688111 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:29:46.703122 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:29:46.719136 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:29:46.729174 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:29:46.728346 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:29:46.740647 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:29:46.744070 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:29:46.746385 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:29:46.755974 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:29:46.757975 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:29:46.762099 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:29:46.768179 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:29:46.770756 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: BEGIN
[0m17:29:46.772576 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: BEGIN
[0m17:29:46.774951 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:46.776883 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:29:46.778445 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:46.780994 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: BEGIN
[0m17:29:46.782842 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:29:46.785005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:46.786650 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m17:29:46.788267 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: BEGIN
[0m17:29:46.789901 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m17:29:46.792142 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m17:29:46.793780 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:46.795802 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m17:29:46.797662 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:29:46.799386 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m17:29:46.801885 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:46.803622 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m17:29:46.805870 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:46.807079 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m17:29:46.808658 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m17:29:46.809831 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:47.000248 [debug] [Thread-1 (]: SQL status: OK in 0.192 seconds
[0m17:29:47.002055 [debug] [Thread-4 (]: SQL status: OK in 0.197 seconds
[0m17:29:47.004117 [debug] [Thread-2 (]: SQL status: OK in 0.198 seconds
[0m17:29:47.011445 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: ROLLBACK
[0m17:29:47.017001 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: ROLLBACK
[0m17:29:47.020044 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704'
[0m17:29:47.025520 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: ROLLBACK
[0m17:29:47.027189 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: Close
[0m17:29:47.029463 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21'
[0m17:29:47.032092 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9'
[0m17:29:47.034088 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: Close
[0m17:29:47.036112 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: Close
[0m17:29:47.038538 [info ] [Thread-4 (]: 13 of 46 PASS dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[32mPASS[0m in 0.41s]
[0m17:29:47.042000 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m17:29:47.045916 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:29:47.044253 [info ] [Thread-1 (]: 15 of 46 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ........... [[32mPASS[0m in 0.38s]
[0m17:29:47.049503 [info ] [Thread-4 (]: 17 of 46 START test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ...... [RUN]
[0m17:29:47.053817 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m17:29:47.051340 [info ] [Thread-2 (]: 14 of 46 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ........... [[32mPASS[0m in 0.42s]
[0m17:29:47.056398 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703)
[0m17:29:47.058452 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:29:47.061268 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m17:29:47.063094 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:29:47.067382 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:29:47.065262 [info ] [Thread-1 (]: 18 of 46 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [RUN]
[0m17:29:47.085008 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:29:47.086931 [info ] [Thread-2 (]: 19 of 46 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [RUN]
[0m17:29:47.088808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7)
[0m17:29:47.092680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d)
[0m17:29:47.094628 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:29:47.096528 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:29:47.114744 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:29:47.112963 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:29:47.146889 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:29:47.156287 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:29:47.161804 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:29:47.173151 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:29:47.175197 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:29:47.176795 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:29:47.186981 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:29:47.189065 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: BEGIN
[0m17:29:47.191553 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:47.194430 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:29:47.196435 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: BEGIN
[0m17:29:47.199369 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:29:47.201063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:47.202911 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:29:47.204755 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m17:29:47.207470 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: BEGIN
[0m17:29:47.209370 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:47.211240 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:47.212960 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:29:47.216030 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m17:29:47.217760 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:47.219960 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m17:29:47.221936 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m17:29:47.223781 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m17:29:47.943857 [debug] [Thread-3 (]: SQL status: OK in 1.132 seconds
[0m17:29:47.949723 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: ROLLBACK
[0m17:29:47.951309 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90'
[0m17:29:47.952256 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: Close
[0m17:29:47.955411 [info ] [Thread-3 (]: 16 of 46 PASS dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ............ [[32mPASS[0m in 1.27s]
[0m17:29:47.957410 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m17:29:47.958499 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:29:47.959620 [info ] [Thread-3 (]: 20 of 46 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m17:29:47.960809 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m17:29:47.961588 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:29:47.983451 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:29:47.986358 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:29:47.993090 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:29:47.995341 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:29:47.996417 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m17:29:47.997382 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:48.000662 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:29:48.002121 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m17:29:48.003287 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:29:48.061027 [debug] [Thread-3 (]: SQL status: OK in 0.057 seconds
[0m17:29:48.067120 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m17:29:48.068874 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m17:29:48.069894 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m17:29:48.072213 [info ] [Thread-3 (]: 20 of 46 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.11s]
[0m17:29:48.074221 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m17:29:48.075276 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:29:48.076458 [info ] [Thread-3 (]: 21 of 46 START test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [RUN]
[0m17:29:48.078607 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08)
[0m17:29:48.079893 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:29:48.089790 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:29:48.091905 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:29:48.098434 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:29:48.100848 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:29:48.101915 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: BEGIN
[0m17:29:48.102855 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:48.105785 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:29:48.106813 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m17:29:48.107832 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_sma"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:29:48.291590 [debug] [Thread-3 (]: SQL status: OK in 0.182 seconds
[0m17:29:48.301104 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: ROLLBACK
[0m17:29:48.303477 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08'
[0m17:29:48.304891 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: Close
[0m17:29:48.308098 [info ] [Thread-3 (]: 21 of 46 PASS dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn .. [[32mPASS[0m in 0.23s]
[0m17:29:48.310917 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m17:29:48.312486 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:29:48.314496 [info ] [Thread-3 (]: 22 of 46 START test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [RUN]
[0m17:29:48.316587 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95)
[0m17:29:48.318142 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:29:48.335891 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:29:48.339975 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:29:48.346098 [debug] [Thread-2 (]: SQL status: OK in 1.121 seconds
[0m17:29:48.347958 [debug] [Thread-4 (]: SQL status: OK in 1.133 seconds
[0m17:29:48.354292 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:29:48.360011 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: ROLLBACK
[0m17:29:48.362293 [debug] [Thread-1 (]: SQL status: OK in 1.142 seconds
[0m17:29:48.365849 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d'
[0m17:29:48.372410 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: ROLLBACK
[0m17:29:48.378367 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: ROLLBACK
[0m17:29:48.380355 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: Close
[0m17:29:48.382371 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:29:48.385054 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703'
[0m17:29:48.387800 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7'
[0m17:29:48.389919 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: BEGIN
[0m17:29:48.393918 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: Close
[0m17:29:48.392351 [info ] [Thread-2 (]: 19 of 46 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0 ..... [[32mPASS[0m in 1.30s]
[0m17:29:48.396230 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: Close
[0m17:29:48.398084 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:48.401010 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m17:29:48.404251 [info ] [Thread-4 (]: 17 of 46 PASS dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ............ [[32mPASS[0m in 1.35s]
[0m17:29:48.409676 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:29:48.406541 [info ] [Thread-1 (]: 18 of 46 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0 ..... [[32mPASS[0m in 1.32s]
[0m17:29:48.413440 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m17:29:48.415191 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m17:29:48.419770 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m17:29:48.416970 [info ] [Thread-2 (]: 23 of 46 START test not_null_int__price_changes_close .......................... [RUN]
[0m17:29:48.422657 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:29:48.424710 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m17:29:48.426680 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:29:48.428963 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m17:29:48.432863 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_wilder"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m17:29:48.431019 [info ] [Thread-4 (]: 24 of 46 START test not_null_int__price_changes_gain ........................... [RUN]
[0m17:29:48.437510 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:29:48.435243 [info ] [Thread-1 (]: 25 of 46 START test not_null_int__price_changes_loaded_at ...................... [RUN]
[0m17:29:48.441210 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m17:29:48.469904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m17:29:48.478106 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:29:48.480510 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:29:48.482480 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:29:48.500719 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:29:48.517559 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:29:48.520302 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:29:48.531233 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:29:48.537772 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:29:48.543712 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:29:48.549031 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:29:48.559161 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:29:48.561712 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:29:48.564059 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m17:29:48.565682 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:48.568754 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:29:48.570579 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:29:48.572327 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m17:29:48.574067 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:29:48.576293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:48.577545 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m17:29:48.579329 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m17:29:48.581798 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:48.583656 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:29:48.586151 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:29:48.588680 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m17:29:48.590319 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:29:48.592100 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:29:48.593914 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m17:29:48.596395 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:29:48.652465 [debug] [Thread-2 (]: SQL status: OK in 0.064 seconds
[0m17:29:48.661538 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m17:29:48.663991 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m17:29:48.665491 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m17:29:48.668917 [info ] [Thread-2 (]: 23 of 46 PASS not_null_int__price_changes_close ................................ [[32mPASS[0m in 0.24s]
[0m17:29:48.674245 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m17:29:48.675946 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:29:48.679141 [debug] [Thread-4 (]: SQL status: OK in 0.081 seconds
[0m17:29:48.680763 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m17:29:48.677523 [info ] [Thread-2 (]: 26 of 46 START test not_null_int__price_changes_loss ........................... [RUN]
[0m17:29:48.683762 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m17:29:48.690748 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:29:48.707042 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m17:29:48.697227 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m17:29:48.714579 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:29:48.717676 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m17:29:48.720396 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m17:29:48.722631 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m17:29:48.724729 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m17:29:48.727716 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:29:48.730039 [info ] [Thread-1 (]: 25 of 46 PASS not_null_int__price_changes_loaded_at ............................ [[32mPASS[0m in 0.26s]
[0m17:29:48.744910 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m17:29:48.733254 [info ] [Thread-4 (]: 24 of 46 PASS not_null_int__price_changes_gain ................................. [[32mPASS[0m in 0.29s]
[0m17:29:48.752675 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:29:48.750065 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:29:48.757885 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m17:29:48.759783 [info ] [Thread-1 (]: 27 of 46 START test not_null_int__price_changes_rn ............................. [RUN]
[0m17:29:48.762856 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:29:48.765239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m17:29:48.769124 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:29:48.767384 [info ] [Thread-4 (]: 28 of 46 START test not_null_int__price_changes_ticker ......................... [RUN]
[0m17:29:48.782666 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:29:48.785543 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m17:29:48.790653 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m17:29:48.797075 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:29:48.798964 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:29:48.800795 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:48.820841 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:29:48.825040 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:29:48.849231 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m17:29:48.858857 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:29:48.860712 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m17:29:48.864703 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:29:48.867105 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:29:48.879311 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:29:48.881594 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:29:48.884503 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m17:29:48.886271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:48.889390 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:29:48.892237 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:29:48.891224 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m17:29:48.895112 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m17:29:48.897329 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:48.899311 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:29:48.904652 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m17:29:48.906440 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m17:29:48.908044 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.028373 [debug] [Thread-2 (]: SQL status: OK in 0.159 seconds
[0m17:29:49.031802 [debug] [Thread-4 (]: SQL status: OK in 0.121 seconds
[0m17:29:49.033701 [debug] [Thread-1 (]: SQL status: OK in 0.132 seconds
[0m17:29:49.040340 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m17:29:49.046107 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m17:29:49.051991 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m17:29:49.055060 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m17:29:49.057754 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m17:29:49.060387 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m17:29:49.062143 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m17:29:49.063916 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m17:29:49.065932 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m17:29:49.070247 [info ] [Thread-2 (]: 26 of 46 PASS not_null_int__price_changes_loss ................................. [[32mPASS[0m in 0.39s]
[0m17:29:49.079631 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m17:29:49.081632 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:29:49.073469 [info ] [Thread-1 (]: 27 of 46 PASS not_null_int__price_changes_rn ................................... [[32mPASS[0m in 0.31s]
[0m17:29:49.087776 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m17:29:49.076508 [info ] [Thread-4 (]: 28 of 46 PASS not_null_int__price_changes_ticker ............................... [[32mPASS[0m in 0.29s]
[0m17:29:49.090394 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:29:49.095350 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m17:29:49.084784 [info ] [Thread-2 (]: 29 of 46 START test not_null_int__price_changes_trade_date ..................... [RUN]
[0m17:29:49.100031 [info ] [Thread-1 (]: 30 of 46 START test not_null_int__rsi_sma_close ................................ [RUN]
[0m17:29:49.103197 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:29:49.106257 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m17:29:49.108254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638, now test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b)
[0m17:29:49.112871 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:29:49.110661 [info ] [Thread-4 (]: 31 of 46 START test not_null_int__rsi_sma_gain ................................. [RUN]
[0m17:29:49.116060 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:29:49.138721 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:29:49.140540 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a, now test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953)
[0m17:29:49.160074 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:29:49.163658 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:29:49.175312 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:29:49.202067 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:29:49.206409 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:29:49.210690 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:29:49.220688 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:29:49.224858 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:29:49.236369 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:29:49.237820 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:29:49.239730 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m17:29:49.241379 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:49.244562 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:29:49.246426 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:29:49.248074 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: BEGIN
[0m17:29:49.250593 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m17:29:49.252262 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: BEGIN
[0m17:29:49.254005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:49.255928 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m17:29:49.258049 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:49.260604 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.264006 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:29:49.266127 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m17:29:49.268114 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m17:29:49.270300 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__rsi_sma"
where close is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.272238 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m17:29:49.275922 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_sma"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.337661 [debug] [Thread-2 (]: SQL status: OK in 0.074 seconds
[0m17:29:49.347233 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m17:29:49.349834 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m17:29:49.351456 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m17:29:49.355159 [info ] [Thread-2 (]: 29 of 46 PASS not_null_int__price_changes_trade_date ........................... [[32mPASS[0m in 0.25s]
[0m17:29:49.358375 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m17:29:49.360130 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:29:49.362013 [info ] [Thread-2 (]: 32 of 46 START test not_null_int__rsi_sma_loaded_at ............................ [RUN]
[0m17:29:49.364230 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5, now test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0)
[0m17:29:49.366030 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:29:49.383156 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m17:29:49.387766 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:29:49.389815 [debug] [Thread-4 (]: SQL status: OK in 0.112 seconds
[0m17:29:49.397039 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: ROLLBACK
[0m17:29:49.403790 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: ROLLBACK
[0m17:29:49.406284 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b'
[0m17:29:49.409711 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953'
[0m17:29:49.411616 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: Close
[0m17:29:49.413677 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: Close
[0m17:29:49.415515 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:29:49.430145 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:29:49.424422 [info ] [Thread-1 (]: 30 of 46 PASS not_null_int__rsi_sma_close ...................................... [[32mPASS[0m in 0.32s]
[0m17:29:49.434205 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m17:29:49.426509 [info ] [Thread-4 (]: 31 of 46 PASS not_null_int__rsi_sma_gain ....................................... [[32mPASS[0m in 0.29s]
[0m17:29:49.436646 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:29:49.439975 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m17:29:49.443807 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:29:49.442029 [info ] [Thread-1 (]: 33 of 46 START test not_null_int__rsi_sma_loss ................................. [RUN]
[0m17:29:49.446293 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:29:49.448293 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: BEGIN
[0m17:29:49.450243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b, now test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065)
[0m17:29:49.453769 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:49.455627 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:29:49.452136 [info ] [Thread-4 (]: 34 of 46 START test not_null_int__rsi_sma_rn ................................... [RUN]
[0m17:29:49.474876 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:29:49.476905 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953, now test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139)
[0m17:29:49.478664 [debug] [Thread-2 (]: SQL status: OK in 0.025 seconds
[0m17:29:49.480978 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:29:49.482958 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m17:29:49.498492 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:29:49.500477 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__rsi_sma"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.503254 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:29:49.514621 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:29:49.517345 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:29:49.526971 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:29:49.529310 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:29:49.531056 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: BEGIN
[0m17:29:49.532628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:49.535576 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:29:49.537325 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: BEGIN
[0m17:29:49.538995 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:49.540591 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:29:49.542910 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m17:29:49.544569 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_sma"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.546872 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:29:49.548477 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m17:29:49.550011 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_sma"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.617028 [debug] [Thread-3 (]: SQL status: OK in 1.177 seconds
[0m17:29:49.629355 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: ROLLBACK
[0m17:29:49.631963 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95'
[0m17:29:49.633550 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: Close
[0m17:29:49.637313 [info ] [Thread-3 (]: 22 of 46 PASS dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[32mPASS[0m in 1.32s]
[0m17:29:49.641035 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m17:29:49.644372 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:29:49.649215 [info ] [Thread-3 (]: 35 of 46 START test not_null_int__rsi_sma_sma_gain ............................. [RUN]
[0m17:29:49.665804 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95, now test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416)
[0m17:29:49.669279 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:29:49.697264 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:29:49.701453 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:29:49.722852 [debug] [Thread-2 (]: SQL status: OK in 0.217 seconds
[0m17:29:49.730202 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:29:49.733510 [debug] [Thread-4 (]: SQL status: OK in 0.181 seconds
[0m17:29:49.736815 [debug] [Thread-1 (]: SQL status: OK in 0.190 seconds
[0m17:29:49.755681 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: ROLLBACK
[0m17:29:49.759431 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:29:49.769224 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: BEGIN
[0m17:29:49.773608 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0'
[0m17:29:49.777463 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: ROLLBACK
[0m17:29:49.780442 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:49.789279 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: ROLLBACK
[0m17:29:49.791685 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: Close
[0m17:29:49.794029 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065'
[0m17:29:49.796260 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139'
[0m17:29:49.798034 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: Close
[0m17:29:49.799805 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m17:29:49.803508 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: Close
[0m17:29:49.802007 [info ] [Thread-2 (]: 32 of 46 PASS not_null_int__rsi_sma_loaded_at .................................. [[32mPASS[0m in 0.44s]
[0m17:29:49.805525 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m17:29:49.807398 [info ] [Thread-1 (]: 33 of 46 PASS not_null_int__rsi_sma_loss ....................................... [[32mPASS[0m in 0.36s]
[0m17:29:49.809756 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m17:29:49.812600 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_gain
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_gain is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.811613 [info ] [Thread-4 (]: 34 of 46 PASS not_null_int__rsi_sma_rn ......................................... [[32mPASS[0m in 0.33s]
[0m17:29:49.814091 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m17:29:49.815071 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:29:49.816772 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m17:29:49.817677 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:29:49.820059 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:29:49.818960 [info ] [Thread-2 (]: 36 of 46 START test not_null_int__rsi_sma_sma_loss ............................. [RUN]
[0m17:29:49.821651 [info ] [Thread-1 (]: 37 of 46 START test not_null_int__rsi_sma_ticker ............................... [RUN]
[0m17:29:49.824044 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0, now test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6)
[0m17:29:49.825293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065, now test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d)
[0m17:29:49.822720 [info ] [Thread-4 (]: 38 of 46 START test not_null_int__rsi_sma_trade_date ........................... [RUN]
[0m17:29:49.826873 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:29:49.828045 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:29:49.829114 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139, now test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0)
[0m17:29:49.839249 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:29:49.845885 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:29:49.846630 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:29:49.859074 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:29:49.860888 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:29:49.862184 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:29:49.867934 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:29:49.878376 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:29:49.879661 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:29:49.887362 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:29:49.891757 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:29:49.893186 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:29:49.894229 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: BEGIN
[0m17:29:49.895227 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:29:49.896023 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: BEGIN
[0m17:29:49.897231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:49.898299 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: BEGIN
[0m17:29:49.899593 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:49.901023 [debug] [Thread-3 (]: SQL status: OK in 0.085 seconds
[0m17:29:49.902267 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:49.903317 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:29:49.904922 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m17:29:49.906047 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_sma"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.907114 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:29:49.908204 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m17:29:49.912370 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: ROLLBACK
[0m17:29:49.913667 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m17:29:49.914966 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m17:29:49.916887 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416'
[0m17:29:49.918122 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_sma"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.919991 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_loss
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_loss is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.921631 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: Close
[0m17:29:49.924917 [info ] [Thread-3 (]: 35 of 46 PASS not_null_int__rsi_sma_sma_gain ................................... [[32mPASS[0m in 0.26s]
[0m17:29:49.927083 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m17:29:49.928183 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:29:49.929260 [info ] [Thread-3 (]: 39 of 46 START test not_null_int__rsi_wilder_gain .............................. [RUN]
[0m17:29:49.930635 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416, now test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda)
[0m17:29:49.931876 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:29:49.944574 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:29:49.947012 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:29:49.953319 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:29:49.955313 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:29:49.956556 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: BEGIN
[0m17:29:49.957310 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:49.960103 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:29:49.961380 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m17:29:49.962681 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_wilder"
where gain is null



  
  
      
    ) dbt_internal_test
[0m17:29:49.984888 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m17:29:49.991622 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: ROLLBACK
[0m17:29:49.993784 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d'
[0m17:29:49.994687 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: Close
[0m17:29:49.996446 [info ] [Thread-1 (]: 37 of 46 PASS not_null_int__rsi_sma_ticker ..................................... [[32mPASS[0m in 0.17s]
[0m17:29:49.998207 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m17:29:49.999142 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:29:49.999908 [info ] [Thread-1 (]: 40 of 46 START test not_null_int__rsi_wilder_loss .............................. [RUN]
[0m17:29:50.000987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d, now test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56)
[0m17:29:50.001826 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:29:50.011998 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:29:50.013342 [debug] [Thread-2 (]: SQL status: OK in 0.090 seconds
[0m17:29:50.014087 [debug] [Thread-4 (]: SQL status: OK in 0.092 seconds
[0m17:29:50.015374 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:29:50.021814 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:29:50.024611 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: ROLLBACK
[0m17:29:50.028788 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: ROLLBACK
[0m17:29:50.030385 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0'
[0m17:29:50.031782 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6'
[0m17:29:50.032781 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: Close
[0m17:29:50.033662 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:29:50.034326 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: Close
[0m17:29:50.035106 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: BEGIN
[0m17:29:50.036747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:50.036081 [info ] [Thread-4 (]: 38 of 46 PASS not_null_int__rsi_sma_trade_date ................................. [[32mPASS[0m in 0.21s]
[0m17:29:50.039065 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m17:29:50.037656 [info ] [Thread-2 (]: 36 of 46 PASS not_null_int__rsi_sma_sma_loss ................................... [[32mPASS[0m in 0.21s]
[0m17:29:50.039995 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:29:50.040623 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:29:50.041684 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m17:29:50.043314 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m17:29:50.042378 [info ] [Thread-4 (]: 41 of 46 START test not_null_int__rsi_wilder_rn ................................ [RUN]
[0m17:29:50.044328 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:29:50.045142 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_wilder"
where loss is null



  
  
      
    ) dbt_internal_test
[0m17:29:50.045932 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0, now test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d)
[0m17:29:50.046667 [info ] [Thread-2 (]: 42 of 46 START test not_null_int__rsi_wilder_ticker ............................ [RUN]
[0m17:29:50.047899 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:29:50.048643 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6, now test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd)
[0m17:29:50.055210 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:29:50.055976 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:29:50.063186 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:29:50.064180 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:29:50.068025 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:29:50.069341 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:29:50.074286 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:29:50.075481 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:29:50.076309 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: BEGIN
[0m17:29:50.076980 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:50.078236 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:29:50.078868 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: BEGIN
[0m17:29:50.079439 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:50.080261 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:29:50.080884 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m17:29:50.081511 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_wilder"
where rn is null



  
  
      
    ) dbt_internal_test
[0m17:29:50.082380 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:29:50.083629 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m17:29:50.084470 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_wilder"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m17:29:51.093280 [debug] [Thread-3 (]: SQL status: OK in 1.129 seconds
[0m17:29:51.101349 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: ROLLBACK
[0m17:29:51.103647 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda'
[0m17:29:51.105034 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: Close
[0m17:29:51.108251 [info ] [Thread-3 (]: 39 of 46 PASS not_null_int__rsi_wilder_gain .................................... [[32mPASS[0m in 1.18s]
[0m17:29:51.111536 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m17:29:51.113283 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:29:51.115160 [info ] [Thread-3 (]: 43 of 46 START test not_null_int__rsi_wilder_trade_date ........................ [RUN]
[0m17:29:51.117436 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda, now test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c)
[0m17:29:51.119213 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:29:51.135305 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:29:51.137349 [debug] [Thread-1 (]: SQL status: OK in 1.090 seconds
[0m17:29:51.140562 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:29:51.154301 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:29:51.156613 [debug] [Thread-2 (]: SQL status: OK in 1.071 seconds
[0m17:29:51.163447 [debug] [Thread-4 (]: SQL status: OK in 1.079 seconds
[0m17:29:51.166009 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: ROLLBACK
[0m17:29:51.172536 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56'
[0m17:29:51.175135 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: Close
[0m17:29:51.177465 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:29:51.183361 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: ROLLBACK
[0m17:29:51.189751 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: ROLLBACK
[0m17:29:51.191491 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: BEGIN
[0m17:29:51.193799 [info ] [Thread-1 (]: 40 of 46 PASS not_null_int__rsi_wilder_loss .................................... [[32mPASS[0m in 1.19s]
[0m17:29:51.196947 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d'
[0m17:29:51.199541 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd'
[0m17:29:51.201258 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:51.204004 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m17:29:51.205697 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: Close
[0m17:29:51.207452 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: Close
[0m17:29:51.210611 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:29:51.213173 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m17:29:51.215060 [info ] [Thread-1 (]: 44 of 46 START test not_null_int__rsi_wilder_wilder_gain ....................... [RUN]
[0m17:29:51.222555 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m17:29:51.217199 [info ] [Thread-4 (]: 41 of 46 PASS not_null_int__rsi_wilder_rn ...................................... [[32mPASS[0m in 1.17s]
[0m17:29:51.224918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9)
[0m17:29:51.226834 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_wilder"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m17:29:51.220103 [info ] [Thread-2 (]: 42 of 46 PASS not_null_int__rsi_wilder_ticker .................................. [[32mPASS[0m in 1.17s]
[0m17:29:51.230093 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m17:29:51.231990 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:29:51.237126 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m17:29:51.239412 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:29:51.256692 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:29:51.258827 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:29:51.260870 [info ] [Thread-4 (]: 45 of 46 START test not_null_int__rsi_wilder_wilder_loss ....................... [RUN]
[0m17:29:51.266138 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb)
[0m17:29:51.269676 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:29:51.263639 [info ] [Thread-2 (]: 46 of 46 START test wilder_seed_equals_sma ..................................... [RUN]
[0m17:29:51.276989 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:29:51.289593 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:29:51.291430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd, now test.portfolio_project_2.wilder_seed_equals_sma)
[0m17:29:51.304031 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:29:51.306334 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:29:51.309583 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:29:51.326419 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:29:51.332293 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:29:51.335816 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:29:51.337548 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: BEGIN
[0m17:29:51.339833 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:29:51.342175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:51.344066 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: BEGIN
[0m17:29:51.346677 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:51.348310 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:29:51.358854 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:29:51.360547 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m17:29:51.362756 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m17:29:51.364403 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m17:29:51.366124 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_gain
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_gain is null



  
  
      
    ) dbt_internal_test
[0m17:29:51.368285 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m17:29:51.371017 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_loss is null



  
  
      
    ) dbt_internal_test
[0m17:29:51.373453 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:29:51.375111 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: BEGIN
[0m17:29:51.376651 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:51.381295 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:29:51.382909 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m17:29:51.385081 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.wilder_seed_equals_sma"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- asserts the seed matches SMA at rn=14
with w as (
  select ticker, trade_date, wilder_gain, wilder_loss
  from "finance"."analytics_dev"."int__rsi_wilder"
  where rn = 14
),
s as (
  select ticker, trade_date, sma_gain, sma_loss
  from "finance"."analytics_dev"."int__rsi_sma"
  where rn = 14
)
select
  w.ticker,
  w.trade_date
from w
join s using (ticker, trade_date)
where abs(w.wilder_gain - s.sma_gain) > 1e-9
   or abs(w.wilder_loss - s.sma_loss) > 1e-9
  
  
      
    ) dbt_internal_test
[0m17:29:52.446461 [debug] [Thread-3 (]: SQL status: OK in 1.212 seconds
[0m17:29:52.455685 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: ROLLBACK
[0m17:29:52.458210 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c'
[0m17:29:52.459768 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: Close
[0m17:29:52.463249 [info ] [Thread-3 (]: 43 of 46 PASS not_null_int__rsi_wilder_trade_date .............................. [[32mPASS[0m in 1.35s]
[0m17:29:52.466428 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m17:29:52.652562 [debug] [Thread-1 (]: SQL status: OK in 1.282 seconds
[0m17:29:52.654287 [debug] [Thread-2 (]: SQL status: OK in 1.267 seconds
[0m17:29:52.655906 [debug] [Thread-4 (]: SQL status: OK in 1.283 seconds
[0m17:29:52.665148 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: ROLLBACK
[0m17:29:52.675203 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: ROLLBACK
[0m17:29:52.677424 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9'
[0m17:29:52.670546 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: ROLLBACK
[0m17:29:52.681148 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.wilder_seed_equals_sma'
[0m17:29:52.682787 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: Close
[0m17:29:52.684924 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: Close
[0m17:29:52.687454 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb'
[0m17:29:52.689720 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: Close
[0m17:29:52.692014 [info ] [Thread-2 (]: 46 of 46 PASS wilder_seed_equals_sma ........................................... [[32mPASS[0m in 1.40s]
[0m17:29:52.699120 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m17:29:52.694278 [info ] [Thread-1 (]: 44 of 46 PASS not_null_int__rsi_wilder_wilder_gain ............................. [[32mPASS[0m in 1.47s]
[0m17:29:52.696842 [info ] [Thread-4 (]: 45 of 46 PASS not_null_int__rsi_wilder_wilder_loss ............................. [[32mPASS[0m in 1.43s]
[0m17:29:52.704023 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m17:29:52.706598 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m17:29:52.712729 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:52.714180 [debug] [MainThread]: On master: BEGIN
[0m17:29:52.715411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:29:52.719522 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:29:52.720905 [debug] [MainThread]: On master: COMMIT
[0m17:29:52.722196 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:52.723417 [debug] [MainThread]: On master: COMMIT
[0m17:29:52.725826 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:29:52.727139 [debug] [MainThread]: On master: Close
[0m17:29:52.728747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:52.729956 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:29:52.731132 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9' was properly closed.
[0m17:29:52.732345 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c' was properly closed.
[0m17:29:52.733966 [debug] [MainThread]: Connection 'test.portfolio_project_2.wilder_seed_equals_sma' was properly closed.
[0m17:29:52.735173 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb' was properly closed.
[0m17:29:52.736684 [info ] [MainThread]: 
[0m17:29:52.738595 [info ] [MainThread]: Finished running 46 data tests in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m17:29:52.771751 [debug] [MainThread]: Command end result
[0m17:29:52.898188 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:29:52.903921 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:29:52.924564 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:29:52.925475 [info ] [MainThread]: 
[0m17:29:52.926753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:29:52.927989 [info ] [MainThread]: 
[0m17:29:52.929226 [info ] [MainThread]: Done. PASS=46 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=46
[0m17:29:52.931011 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:29:52.933867 [debug] [MainThread]: Command `-c test` succeeded at 17:29:52.933505 after 13.52 seconds
[0m17:29:52.934845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD3702620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD5109B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD5109450>]}
[0m17:29:52.935770 [debug] [MainThread]: Flushing usage events
[0m17:29:54.122601 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:54:10.878764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020660920E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020660922C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020660922150>]}


============================== 15:54:10.883154 | 0061dec4-84c1-4012-ae72-238431da7cd2 ==============================
[0m15:54:10.883154 [info ] [MainThread]: Running with dbt=1.8.0
[0m15:54:10.883154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:54:11.155727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0061dec4-84c1-4012-ae72-238431da7cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065CA4D7C0>]}
[0m15:54:11.321393 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.2', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.2'}} is not valid under any of the given schemas
  
[0m15:54:11.322394 [debug] [MainThread]: Command `cli deps` failed at 15:54:11.322394 after 0.56 seconds
[0m15:54:11.323501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206609C5EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020660E56360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020662088E30>]}
[0m15:54:11.323501 [debug] [MainThread]: Flushing usage events
[0m16:51:25.278010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023278998050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232791A42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232797E7ED0>]}


============================== 16:51:25.285221 | 4fb368dd-6110-47e1-9401-267872d81dd7 ==============================
[0m16:51:25.285221 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:51:25.285944 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select int__regime_changes', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:51:25.564583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fb368dd-6110-47e1-9401-267872d81dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023278B50180>]}
[0m16:51:25.628748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fb368dd-6110-47e1-9401-267872d81dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002327968B790>]}
[0m16:51:25.631407 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:51:26.029022 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m16:51:26.029999 [debug] [MainThread]: Command `-c run` failed at 16:51:26.029867 after 0.92 seconds
[0m16:51:26.030347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002327A8D5450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002327A8D5350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002327AB20F50>]}
[0m16:51:26.030748 [debug] [MainThread]: Flushing usage events
[0m16:51:26.774126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:51:39.293409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC65BC8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC663D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC66A17ED0>]}


============================== 16:51:39.297855 | d9bc614a-6ad2-4efe-80f9-c739fff1a14a ==============================
[0m16:51:39.297855 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:51:39.298666 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:51:39.434886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9bc614a-6ad2-4efe-80f9-c739fff1a14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC65D80180>]}
[0m16:51:39.490561 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-mlyj4t19'
[0m16:51:39.491033 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:51:40.189086 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:51:40.192978 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:51:40.753208 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:51:40.758418 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:51:41.364754 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:51:41.380873 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m16:51:41.918619 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m16:51:41.924556 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:51:42.808003 [info ] [MainThread]: Installed from version 1.3.2
[0m16:51:42.808547 [info ] [MainThread]: Up to date!
[0m16:51:42.809015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd9bc614a-6ad2-4efe-80f9-c739fff1a14a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC668BAF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC668BA580>]}
[0m16:51:42.809412 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:51:47.021261 [info ] [MainThread]: Installed from version 0.10.9
[0m16:51:47.021787 [info ] [MainThread]: Up to date!
[0m16:51:47.022285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd9bc614a-6ad2-4efe-80f9-c739fff1a14a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC67CBD050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC668AB6B0>]}
[0m16:51:47.022674 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:51:47.921106 [info ] [MainThread]: Installed from version 0.16.1
[0m16:51:47.921691 [info ] [MainThread]: Up to date!
[0m16:51:47.922344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd9bc614a-6ad2-4efe-80f9-c739fff1a14a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC67C99A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC67C99470>]}
[0m16:51:47.925096 [debug] [MainThread]: Command `-c deps` succeeded at 16:51:47.924956 after 8.75 seconds
[0m16:51:47.925496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6680F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC67C52810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC67CB1E90>]}
[0m16:51:47.925931 [debug] [MainThread]: Flushing usage events
[0m16:51:48.623274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:51:58.957826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA2CB8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA34C42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA3B03ED0>]}


============================== 16:51:58.962191 | 31d0bad5-e8de-4fc0-a8a5-28e10718d77d ==============================
[0m16:51:58.962191 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:51:58.962920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'no_print': 'None', 'target_path': 'None', 'invocation_command': 'dbt run --select +int__regime_changes', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:51:59.209970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31d0bad5-e8de-4fc0-a8a5-28e10718d77d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA2E70180>]}
[0m16:51:59.275109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31d0bad5-e8de-4fc0-a8a5-28e10718d77d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA39AB790>]}
[0m16:51:59.277691 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:51:59.577836 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:52:02.581298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m16:52:02.581930 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m16:52:02.582286 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m16:52:02.582663 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://snapshots\int__regime_classification_snapshot.yml
[0m16:52:02.583051 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\bronze\src_vix.sql
[0m16:52:03.057859 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.portfolio_project_2.int__regime_changes' (models\silver\int\int__regime_changes.sql) depends on a node named 'int__regime_classifications' which was not found
[0m16:52:03.058909 [debug] [MainThread]: Command `-c run` failed at 16:52:03.058786 after 4.22 seconds
[0m16:52:03.059280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA4C86150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA53F2C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA55F8500>]}
[0m16:52:03.059635 [debug] [MainThread]: Flushing usage events
[0m16:52:03.949913 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:18.289999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002646FFD8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264707E42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026470E23ED0>]}


============================== 16:52:18.296096 | acbc9f78-8201-4075-b12d-4420a6b4e518 ==============================
[0m16:52:18.296096 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:52:18.296977 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select +int__regime_changes', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:52:18.544957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acbc9f78-8201-4075-b12d-4420a6b4e518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026470190180>]}
[0m16:52:18.610610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acbc9f78-8201-4075-b12d-4420a6b4e518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026470CCB790>]}
[0m16:52:18.613121 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:52:18.876680 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:52:19.079064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m16:52:19.079692 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m16:52:19.080037 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m16:52:19.080402 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://snapshots\int__regime_classification_snapshot.yml
[0m16:52:19.080780 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\bronze\src_vix.sql
[0m16:52:19.550527 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.portfolio_project_2.int__regime_classification' (models\silver\int\int__regime_classification.sql) depends on a node named 'src_vix' in package or project 'raw' which was not found
[0m16:52:19.551598 [debug] [MainThread]: Command `-c run` failed at 16:52:19.551475 after 1.38 seconds
[0m16:52:19.551980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026471FC6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647274EC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026472938050>]}
[0m16:52:19.552353 [debug] [MainThread]: Flushing usage events
[0m16:52:20.174057 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:05.878625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FEB08050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FF3142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FF957ED0>]}


============================== 16:53:05.883039 | 6c493d41-c6d4-4e7a-b34f-42bc8864784c ==============================
[0m16:53:05.883039 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:53:05.883715 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select +int__regime_changes', 'printer_width': '80', 'write_json': 'True'}
[0m16:53:06.132159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c493d41-c6d4-4e7a-b34f-42bc8864784c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FECC0180>]}
[0m16:53:06.197586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c493d41-c6d4-4e7a-b34f-42bc8864784c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FF7FB790>]}
[0m16:53:06.200231 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:53:06.456157 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:53:06.656810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m16:53:06.657399 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m16:53:06.657783 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://snapshots\int__regime_classification_snapshot.yml
[0m16:53:06.658113 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m16:53:06.658488 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\bronze\src_vix.sql
[0m16:53:06.864706 [error] [MainThread]: Encountered an error:
Compilation Error in model src_vix (models\bronze\src_vix.sql)
  source() takes exactly two arguments (1 given)
[0m16:53:06.865778 [debug] [MainThread]: Command `-c run` failed at 16:53:06.865648 after 1.12 seconds
[0m16:53:06.866139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FFA94F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FFA96150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254813F5040>]}
[0m16:53:06.866491 [debug] [MainThread]: Flushing usage events
[0m16:53:07.612951 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:33.116195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF4EE88050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF4F6942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF4FCD7ED0>]}


============================== 16:53:33.120632 | f71cc8fc-c77e-4882-8038-dd367bdaff80 ==============================
[0m16:53:33.120632 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:53:33.121353 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'target_path': 'None', 'invocation_command': 'dbt run --select srv_vix', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m16:53:33.365210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f71cc8fc-c77e-4882-8038-dd367bdaff80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF4F040180>]}
[0m16:53:33.430296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f71cc8fc-c77e-4882-8038-dd367bdaff80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF4FB7B790>]}
[0m16:53:33.432743 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:53:33.687079 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:53:33.879170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m16:53:33.879758 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m16:53:33.880141 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m16:53:33.880512 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://snapshots\int__regime_classification_snapshot.yml
[0m16:53:33.880888 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\bronze\src_vix.sql
[0m16:53:34.345801 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.portfolio_project_2.int__regime_classification' (models\silver\int\int__regime_classification.sql) depends on a node named 'src_vix' in package or project 'raw' which was not found
[0m16:53:34.347303 [debug] [MainThread]: Command `-c run` failed at 16:53:34.347055 after 1.35 seconds
[0m16:53:34.348160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF50DC6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF515FEC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF517EC050>]}
[0m16:53:34.348654 [debug] [MainThread]: Flushing usage events
[0m16:53:35.034792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:40.196660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228FFEB8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228807142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022880D57ED0>]}


============================== 16:53:40.201037 | 6bbba6fb-d6a8-4880-b8f2-2bf2298ebbd4 ==============================
[0m16:53:40.201037 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:53:40.201819 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select src_vix', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:53:40.446368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bbba6fb-d6a8-4880-b8f2-2bf2298ebbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228800C0180>]}
[0m16:53:40.511340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bbba6fb-d6a8-4880-b8f2-2bf2298ebbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022880BFB790>]}
[0m16:53:40.513841 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:53:40.772880 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:53:40.964660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m16:53:40.965241 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m16:53:40.965581 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m16:53:40.965939 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://snapshots\int__regime_classification_snapshot.yml
[0m16:53:40.966310 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\bronze\src_vix.sql
[0m16:53:41.426003 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.portfolio_project_2.int__regime_classification' (models\silver\int\int__regime_classification.sql) depends on a node named 'src_vix' in package or project 'raw' which was not found
[0m16:53:41.427029 [debug] [MainThread]: Command `-c run` failed at 16:53:41.426908 after 1.35 seconds
[0m16:53:41.427448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022881E56150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022882602C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022882808050>]}
[0m16:53:41.427826 [debug] [MainThread]: Flushing usage events
[0m16:53:42.187450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:11.285387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E15C398050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E15CBA42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E15D1E7ED0>]}


============================== 16:54:11.289751 | 80f5fafc-7dc7-4124-a772-de63af8bbfa8 ==============================
[0m16:54:11.289751 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:54:11.290641 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select src_vix', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:54:11.540078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80f5fafc-7dc7-4124-a772-de63af8bbfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E15C550180>]}
[0m16:54:11.605497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80f5fafc-7dc7-4124-a772-de63af8bbfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E15D08B790>]}
[0m16:54:11.607943 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:54:11.865507 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:54:12.063204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m16:54:12.063824 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://snapshots\int__regime_classification_snapshot.yml
[0m16:54:12.064179 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m16:54:12.064505 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m16:54:12.064874 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\bronze\src_vix.sql
[0m16:54:12.527406 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.portfolio_project_2.src_vix' (models\bronze\src_vix.sql) depends on a source named 'raw.src_vix' which was not found
[0m16:54:12.528409 [debug] [MainThread]: Command `-c run` failed at 16:54:12.528251 after 1.36 seconds
[0m16:54:12.528762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E15E2E6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E15EA52D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E15EC78410>]}
[0m16:54:12.529214 [debug] [MainThread]: Flushing usage events
[0m16:54:13.308136 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:34.407215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244F1528050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244F1D342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244F2377ED0>]}


============================== 16:54:34.411488 | d6bf983a-0b3e-4082-a436-dd31b5685c82 ==============================
[0m16:54:34.411488 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:54:34.412168 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'printer_width': '80', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select src_vix', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:54:34.658428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6bf983a-0b3e-4082-a436-dd31b5685c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244F16E0180>]}
[0m16:54:34.723394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6bf983a-0b3e-4082-a436-dd31b5685c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244F221B790>]}
[0m16:54:34.725871 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:54:34.992145 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:54:35.184689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m16:54:35.185271 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m16:54:35.185611 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m16:54:35.185975 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://snapshots\int__regime_classification_snapshot.yml
[0m16:54:35.186349 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\bronze\src_vix.sql
[0m16:54:35.668254 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.portfolio_project_2.int__regime_classification' (models\silver\int\int__regime_classification.sql) depends on a node named 'src_vix' in package or project 'raw' which was not found
[0m16:54:35.669310 [debug] [MainThread]: Command `-c run` failed at 16:54:35.669186 after 1.38 seconds
[0m16:54:35.669675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244F3446150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244F3C72C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244F3E78050>]}
[0m16:54:35.670049 [debug] [MainThread]: Flushing usage events
[0m16:54:36.352384 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:51.681842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC1E48050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC26542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC2C97ED0>]}


============================== 16:54:51.686323 | 312ed871-9a0b-473c-8eb1-839642de9127 ==============================
[0m16:54:51.686323 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:54:51.687040 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select src_vix', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:54:51.955393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '312ed871-9a0b-473c-8eb1-839642de9127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC2000180>]}
[0m16:54:52.020421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '312ed871-9a0b-473c-8eb1-839642de9127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC2B3B790>]}
[0m16:54:52.023013 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:54:52.286875 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:54:52.488952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m16:54:52.489636 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m16:54:52.490013 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://snapshots\int__regime_classification_snapshot.yml
[0m16:54:52.490343 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m16:54:52.490713 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\bronze\src_vix.sql
[0m16:54:53.053363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '312ed871-9a0b-473c-8eb1-839642de9127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC3E00350>]}
[0m16:54:53.186611 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:54:53.201445 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:54:53.230290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '312ed871-9a0b-473c-8eb1-839642de9127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC3FE0B90>]}
[0m16:54:53.230808 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m16:54:53.231273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '312ed871-9a0b-473c-8eb1-839642de9127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC3FD7D90>]}
[0m16:54:53.233318 [info ] [MainThread]: 
[0m16:54:53.233753 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:54:53.234155 [info ] [MainThread]: 
[0m16:54:53.234702 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:54:53.235659 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:54:55.843222 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:54:55.843615 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:54:55.843921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:59.397188 [debug] [ThreadPool]: SQL status: OK in 3.553 seconds
[0m16:54:59.398917 [debug] [ThreadPool]: On list_finance: Close
[0m16:54:59.399598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m16:54:59.400062 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m16:54:59.406145 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:54:59.406498 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:54:59.406790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:59.408676 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:54:59.410008 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:54:59.410357 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m16:54:59.411327 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:54:59.411621 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:54:59.411907 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m16:54:59.462712 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m16:54:59.463925 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:54:59.464336 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:54:59.464706 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:54:59.514296 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m16:54:59.515851 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m16:54:59.527132 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m16:54:59.534207 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:54:59.534744 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m16:54:59.535059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:59.535690 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m16:54:59.537668 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:54:59.537976 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m16:54:59.538249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:59.538919 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:54:59.539266 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:54:59.539567 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m16:54:59.539995 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:54:59.540309 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:54:59.540650 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m16:54:59.573511 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m16:54:59.573899 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m16:54:59.575225 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m16:54:59.576526 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m16:54:59.589256 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m16:54:59.589617 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m16:54:59.590308 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m16:54:59.590639 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m16:54:59.592629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '312ed871-9a0b-473c-8eb1-839642de9127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC4A35980>]}
[0m16:54:59.593083 [debug] [MainThread]: Using duckdb connection "master"
[0m16:54:59.593387 [debug] [MainThread]: On master: BEGIN
[0m16:54:59.593678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:54:59.594935 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:54:59.595251 [debug] [MainThread]: On master: COMMIT
[0m16:54:59.595553 [debug] [MainThread]: Using duckdb connection "master"
[0m16:54:59.595848 [debug] [MainThread]: On master: COMMIT
[0m16:54:59.596412 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:54:59.596725 [debug] [MainThread]: On master: Close
[0m16:54:59.602415 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m16:54:59.602963 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m16:54:59.603647 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m16:54:59.604014 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m16:54:59.610879 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m16:54:59.612039 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m16:54:59.644480 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m16:54:59.645990 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:54:59.646432 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m16:54:59.646773 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:54:59.648313 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:54:59.648685 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:54:59.649032 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m16:54:59.715341 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m16:54:59.725194 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:54:59.725809 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m16:54:59.796962 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m16:54:59.808870 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:54:59.810468 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m16:54:59.878689 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m16:54:59.889730 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:54:59.890144 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:54:59.890473 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:55:00.022307 [debug] [Thread-1 (]: SQL status: OK in 0.131 seconds
[0m16:55:00.028162 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:55:00.028570 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m16:55:00.138414 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m16:55:00.140882 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m16:55:00.143079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '312ed871-9a0b-473c-8eb1-839642de9127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC4AE9790>]}
[0m16:55:00.143672 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.54s]
[0m16:55:00.144519 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m16:55:00.146199 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:00.146546 [debug] [MainThread]: On master: BEGIN
[0m16:55:00.146823 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:00.148008 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:55:00.148316 [debug] [MainThread]: On master: COMMIT
[0m16:55:00.148632 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:00.148906 [debug] [MainThread]: On master: COMMIT
[0m16:55:00.149447 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:55:00.149749 [debug] [MainThread]: On master: Close
[0m16:55:00.150117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:00.150387 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m16:55:00.150643 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m16:55:00.150896 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m16:55:00.151145 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m16:55:00.151433 [info ] [MainThread]: 
[0m16:55:00.151904 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.92 seconds (6.92s).
[0m16:55:00.153026 [debug] [MainThread]: Command end result
[0m16:55:00.199477 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:55:00.201809 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:55:00.208362 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m16:55:00.208770 [info ] [MainThread]: 
[0m16:55:00.209389 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:00.209964 [info ] [MainThread]: 
[0m16:55:00.210467 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:55:00.211349 [debug] [MainThread]: Command `-c run` succeeded at 16:55:00.211238 after 8.65 seconds
[0m16:55:00.211698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC4BAE360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC4B0E850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBC4B0E530>]}
[0m16:55:00.212046 [debug] [MainThread]: Flushing usage events
[0m16:55:00.852423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:09.179185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020728758050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020728F642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207295A7ED0>]}


============================== 16:55:09.183609 | 04b306dd-a07c-48ce-99ea-6bd7992d63e4 ==============================
[0m16:55:09.183609 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:55:09.184303 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select +int__regime_classification', 'printer_width': '80', 'target_path': 'None'}
[0m16:55:09.428753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04b306dd-a07c-48ce-99ea-6bd7992d63e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020728910180>]}
[0m16:55:09.494059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04b306dd-a07c-48ce-99ea-6bd7992d63e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072944B790>]}
[0m16:55:09.496793 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:55:09.760668 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:55:10.134499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:10.134851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:10.200228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04b306dd-a07c-48ce-99ea-6bd7992d63e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072A694D50>]}
[0m16:55:10.380634 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:55:10.382961 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:55:10.412224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04b306dd-a07c-48ce-99ea-6bd7992d63e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072A8D0B90>]}
[0m16:55:10.412681 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m16:55:10.413195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04b306dd-a07c-48ce-99ea-6bd7992d63e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207294634D0>]}
[0m16:55:10.415108 [info ] [MainThread]: 
[0m16:55:10.415596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:55:10.416122 [info ] [MainThread]: 
[0m16:55:10.416765 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:55:10.421256 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:55:10.499281 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:55:10.499678 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:55:10.500027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:12.166177 [debug] [ThreadPool]: SQL status: OK in 1.666 seconds
[0m16:55:12.167864 [debug] [ThreadPool]: On list_finance: Close
[0m16:55:12.168680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m16:55:12.169211 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m16:55:12.175721 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:55:12.176109 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:55:12.176418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:12.177914 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:55:12.179182 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:55:12.179482 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m16:55:12.180374 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:55:12.180670 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:55:12.180957 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m16:55:12.231851 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m16:55:12.232934 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:55:12.233318 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:55:12.233702 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:55:12.290040 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m16:55:12.291889 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m16:55:12.300158 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m16:55:12.318384 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:55:12.319410 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m16:55:12.320109 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m16:55:12.323928 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:55:12.324596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:12.325192 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m16:55:12.326078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:12.326941 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:55:12.327432 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:55:12.327936 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m16:55:12.328672 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:55:12.329194 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:55:12.329719 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m16:55:12.354165 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m16:55:12.354606 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m16:55:12.355807 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m16:55:12.357082 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m16:55:12.358161 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m16:55:12.358464 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m16:55:12.358945 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m16:55:12.359256 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m16:55:12.361233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04b306dd-a07c-48ce-99ea-6bd7992d63e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072B013BA0>]}
[0m16:55:12.361672 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:12.361978 [debug] [MainThread]: On master: BEGIN
[0m16:55:12.362268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:12.363396 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:55:12.363698 [debug] [MainThread]: On master: COMMIT
[0m16:55:12.363988 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:12.364265 [debug] [MainThread]: On master: COMMIT
[0m16:55:12.364804 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:55:12.365107 [debug] [MainThread]: On master: Close
[0m16:55:12.369762 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m16:55:12.370286 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m16:55:12.370926 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m16:55:12.371281 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m16:55:12.377926 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m16:55:12.378907 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m16:55:12.409831 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m16:55:12.410756 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:55:12.411139 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m16:55:12.411463 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:12.412849 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:55:12.413203 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:55:12.413547 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m16:55:12.485554 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m16:55:12.492185 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:55:12.492605 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m16:55:12.565110 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m16:55:12.574934 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:55:12.576186 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m16:55:12.648435 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m16:55:12.676585 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:55:12.677225 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:55:12.677757 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:55:12.803024 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m16:55:12.818918 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:55:12.820206 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m16:55:12.945794 [debug] [Thread-1 (]: SQL status: OK in 0.125 seconds
[0m16:55:12.948173 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m16:55:12.950234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b306dd-a07c-48ce-99ea-6bd7992d63e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072B23C290>]}
[0m16:55:12.950872 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.58s]
[0m16:55:12.951693 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m16:55:12.952459 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m16:55:12.952938 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m16:55:12.953632 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m16:55:12.954001 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m16:55:12.956648 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m16:55:12.960777 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m16:55:12.964517 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m16:55:12.966240 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:55:12.966792 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m16:55:12.967215 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:55:12.968671 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:55:12.969133 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:55:12.969514 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix"
)

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then "complacent"
            when "close" <= 12 and close < 20 then "normal"
            when "close" >= 20 and "close" < 30 then "elevated"
            when "close" >= 30 then "crises"
        end) as regime, 
        loaded_at
    from base
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:55:12.980119 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix"
)

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then "complacent"
            when "close" <= 12 and close < 20 then "normal"
            when "close" >= 20 and "close" < 30 then "elevated"
            when "close" >= 30 then "crises"
        end) as regime, 
        loaded_at
    from base
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:55:12.980617 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m16:55:12.981082 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: ROLLBACK
[0m16:55:13.112450 [debug] [Thread-2 (]: Failed to rollback 'model.portfolio_project_2.int__regime_classification'
[0m16:55:13.112905 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m16:55:13.117032 [debug] [Thread-2 (]: Runtime Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  Parser Error: syntax error at or near "final"
  
  LINE 13: final as (
           ^
[0m16:55:13.117472 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b306dd-a07c-48ce-99ea-6bd7992d63e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072AFC6DB0>]}
[0m16:55:13.118051 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model analytics_dev.int__regime_classification .. [[31mERROR[0m in 0.16s]
[0m16:55:13.118827 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m16:55:13.119446 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_classification' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  Parser Error: syntax error at or near "final"
  
  LINE 13: final as (
           ^.
[0m16:55:13.121264 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:13.121596 [debug] [MainThread]: On master: BEGIN
[0m16:55:13.121892 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:13.123082 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:55:13.123411 [debug] [MainThread]: On master: COMMIT
[0m16:55:13.123734 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:13.124036 [debug] [MainThread]: On master: COMMIT
[0m16:55:13.124623 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:55:13.124950 [debug] [MainThread]: On master: Close
[0m16:55:13.125340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:13.125642 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m16:55:13.125928 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m16:55:13.126209 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m16:55:13.126490 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m16:55:13.126778 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m16:55:13.127140 [info ] [MainThread]: 
[0m16:55:13.127609 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m16:55:13.128618 [debug] [MainThread]: Command end result
[0m16:55:13.175886 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:55:13.178358 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:55:13.184139 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m16:55:13.184473 [info ] [MainThread]: 
[0m16:55:13.185019 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:55:13.185499 [info ] [MainThread]: 
[0m16:55:13.186085 [error] [MainThread]: [31mFailure in model int__regime_classification (models\silver\int\int__regime_classification.sql)[0m
[0m16:55:13.186661 [error] [MainThread]:   Runtime Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  Parser Error: syntax error at or near "final"
  
  LINE 13: final as (
           ^
[0m16:55:13.187190 [info ] [MainThread]: 
[0m16:55:13.187746 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_classification.sql
[0m16:55:13.188263 [info ] [MainThread]: 
[0m16:55:13.188812 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m16:55:13.189730 [debug] [MainThread]: Command `-c run` failed at 16:55:13.189607 after 4.13 seconds
[0m16:55:13.190120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072B276F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072AE4A060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072A8AE750>]}
[0m16:55:13.190487 [debug] [MainThread]: Flushing usage events
[0m16:55:14.253740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:22.881165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AD188050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AD9942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194ADFD7ED0>]}


============================== 16:55:22.885551 | a71f287c-d1f7-4f48-9966-53ca8753388f ==============================
[0m16:55:22.885551 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:55:22.886214 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +int__regime_classification', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m16:55:23.129712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a71f287c-d1f7-4f48-9966-53ca8753388f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AD340180>]}
[0m16:55:23.194342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a71f287c-d1f7-4f48-9966-53ca8753388f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194ADE7B790>]}
[0m16:55:23.196964 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:55:23.461185 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:55:23.678847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:55:23.679498 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m16:55:24.022857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a71f287c-d1f7-4f48-9966-53ca8753388f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AF815E50>]}
[0m16:55:24.148379 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:55:24.150773 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:55:24.176592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a71f287c-d1f7-4f48-9966-53ca8753388f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AF2C4B90>]}
[0m16:55:24.177052 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m16:55:24.177512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a71f287c-d1f7-4f48-9966-53ca8753388f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194ADE93770>]}
[0m16:55:24.179421 [info ] [MainThread]: 
[0m16:55:24.179852 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:55:24.180254 [info ] [MainThread]: 
[0m16:55:24.180811 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:55:24.185506 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:55:24.266250 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:55:24.266661 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:55:24.266983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:25.761789 [debug] [ThreadPool]: SQL status: OK in 1.495 seconds
[0m16:55:25.763135 [debug] [ThreadPool]: On list_finance: Close
[0m16:55:25.763794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m16:55:25.764301 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m16:55:25.770210 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:55:25.770529 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:55:25.770870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:25.772388 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:55:25.773626 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:55:25.773927 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m16:55:25.774832 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:55:25.775130 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:55:25.775422 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m16:55:25.828354 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m16:55:25.829923 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:55:25.830493 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:55:25.831030 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:55:25.886063 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m16:55:25.887797 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m16:55:25.895991 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m16:55:25.906332 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m16:55:25.907839 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:55:25.909814 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:55:25.910267 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m16:55:25.910639 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m16:55:25.911004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:25.911364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:25.912452 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:55:25.912754 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:55:25.913055 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m16:55:25.913470 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:55:25.913788 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:55:25.914108 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m16:55:25.937814 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m16:55:25.938331 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m16:55:25.939528 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m16:55:25.940817 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m16:55:25.942044 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m16:55:25.942353 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m16:55:25.942828 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m16:55:25.943137 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m16:55:25.945098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a71f287c-d1f7-4f48-9966-53ca8753388f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AF50B930>]}
[0m16:55:25.945543 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:25.945849 [debug] [MainThread]: On master: BEGIN
[0m16:55:25.946138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:25.947266 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:55:25.947568 [debug] [MainThread]: On master: COMMIT
[0m16:55:25.947856 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:25.948131 [debug] [MainThread]: On master: COMMIT
[0m16:55:25.948667 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:55:25.948970 [debug] [MainThread]: On master: Close
[0m16:55:25.953754 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m16:55:25.954275 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m16:55:25.954915 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m16:55:25.955272 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m16:55:25.961965 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m16:55:25.962784 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m16:55:25.994280 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m16:55:25.995208 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:55:25.995571 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m16:55:25.995899 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:25.997375 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:55:25.997737 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:55:25.998082 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m16:55:26.065247 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m16:55:26.075694 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:55:26.076414 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m16:55:26.140825 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m16:55:26.144068 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:55:26.144437 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m16:55:26.219435 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m16:55:26.231706 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:55:26.232104 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:55:26.232447 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:55:26.426114 [debug] [Thread-1 (]: SQL status: OK in 0.193 seconds
[0m16:55:26.432001 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:55:26.432623 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m16:55:26.552895 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m16:55:26.561557 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m16:55:26.566283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a71f287c-d1f7-4f48-9966-53ca8753388f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AFC710D0>]}
[0m16:55:26.567695 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.61s]
[0m16:55:26.569199 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m16:55:26.570557 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m16:55:26.571613 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m16:55:26.572886 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m16:55:26.573498 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m16:55:26.577242 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m16:55:26.578208 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m16:55:26.581509 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m16:55:26.582386 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:55:26.582758 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m16:55:26.583093 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:55:26.584372 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:55:26.584726 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:55:26.585092 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then "complacent"
            when "close" <= 12 and close < 20 then "normal"
            when "close" >= 20 and "close" < 30 then "elevated"
            when "close" >= 30 then "crises"
        end) as regime, 
        loaded_at
    from base
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:55:26.644961 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then "complacent"
            when "close" <= 12 and close < 20 then "normal"
            when "close" >= 20 and "close" < 30 then "elevated"
            when "close" >= 30 then "crises"
        end) as regime, 
        loaded_at
    from base
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:55:26.645550 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m16:55:26.646077 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: ROLLBACK
[0m16:55:26.654335 [debug] [Thread-2 (]: Failed to rollback 'model.portfolio_project_2.int__regime_classification'
[0m16:55:26.654863 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m16:55:26.660261 [debug] [Thread-2 (]: Runtime Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  Binder Error: Referenced column "complacent" not found in FROM clause!
  Candidate bindings: "close", "loaded_at", "trade_date"
  
  LINE 18:             when "close" < 12 then "complacent"
                                              ^
[0m16:55:26.660845 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a71f287c-d1f7-4f48-9966-53ca8753388f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AFD30470>]}
[0m16:55:26.661625 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model analytics_dev.int__regime_classification .. [[31mERROR[0m in 0.09s]
[0m16:55:26.662623 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m16:55:26.663286 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_classification' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  Binder Error: Referenced column "complacent" not found in FROM clause!
  Candidate bindings: "close", "loaded_at", "trade_date"
  
  LINE 18:             when "close" < 12 then "complacent"
                                              ^.
[0m16:55:26.665377 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:26.665749 [debug] [MainThread]: On master: BEGIN
[0m16:55:26.666079 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:26.667420 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:55:26.667788 [debug] [MainThread]: On master: COMMIT
[0m16:55:26.668186 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:26.668515 [debug] [MainThread]: On master: COMMIT
[0m16:55:26.669245 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:55:26.669607 [debug] [MainThread]: On master: Close
[0m16:55:26.670057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:26.670375 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m16:55:26.670681 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m16:55:26.670978 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m16:55:26.671271 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m16:55:26.671564 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m16:55:26.671953 [info ] [MainThread]: 
[0m16:55:26.672569 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m16:55:26.673908 [debug] [MainThread]: Command end result
[0m16:55:26.721410 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:55:26.724053 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:55:26.730018 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m16:55:26.730364 [info ] [MainThread]: 
[0m16:55:26.730876 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:55:26.731405 [info ] [MainThread]: 
[0m16:55:26.731980 [error] [MainThread]: [31mFailure in model int__regime_classification (models\silver\int\int__regime_classification.sql)[0m
[0m16:55:26.732571 [error] [MainThread]:   Runtime Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  Binder Error: Referenced column "complacent" not found in FROM clause!
  Candidate bindings: "close", "loaded_at", "trade_date"
  
  LINE 18:             when "close" < 12 then "complacent"
                                              ^
[0m16:55:26.733092 [info ] [MainThread]: 
[0m16:55:26.733647 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_classification.sql
[0m16:55:26.734148 [info ] [MainThread]: 
[0m16:55:26.734660 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m16:55:26.735567 [debug] [MainThread]: Command `-c run` failed at 16:55:26.735448 after 3.97 seconds
[0m16:55:26.735956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AF916530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194AFD15D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194ACBC8750>]}
[0m16:55:26.736333 [debug] [MainThread]: Flushing usage events
[0m16:55:27.382851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:57:19.438201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E03F668050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E03FE742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0404B7ED0>]}


============================== 16:57:19.442652 | 4a426e2b-ad11-4539-a751-9ea6aa54cbb1 ==============================
[0m16:57:19.442652 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:57:19.443442 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +int__regime_classification', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m16:57:19.763300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a426e2b-ad11-4539-a751-9ea6aa54cbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E03F820180>]}
[0m16:57:19.827878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a426e2b-ad11-4539-a751-9ea6aa54cbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E04035B790>]}
[0m16:57:19.842852 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:57:20.202495 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:57:21.213810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:57:21.214551 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m16:57:21.565836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a426e2b-ad11-4539-a751-9ea6aa54cbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E041D41B50>]}
[0m16:57:21.694272 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:57:21.697733 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:57:21.727720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a426e2b-ad11-4539-a751-9ea6aa54cbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E041790B90>]}
[0m16:57:21.728202 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m16:57:21.728758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a426e2b-ad11-4539-a751-9ea6aa54cbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E040373770>]}
[0m16:57:21.730714 [info ] [MainThread]: 
[0m16:57:21.731291 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:57:21.731756 [info ] [MainThread]: 
[0m16:57:21.732401 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:57:21.737252 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:57:22.543604 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:57:22.543986 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:57:22.544283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:24.432702 [debug] [ThreadPool]: SQL status: OK in 1.888 seconds
[0m16:57:24.434308 [debug] [ThreadPool]: On list_finance: Close
[0m16:57:24.435101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m16:57:24.435664 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m16:57:24.442065 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:57:24.442389 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:57:24.442685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:24.444387 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:57:24.445639 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:57:24.445942 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m16:57:24.446945 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:57:24.447244 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:57:24.447531 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m16:57:24.501923 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m16:57:24.503198 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:57:24.503643 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:57:24.504173 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:57:24.546449 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m16:57:24.547561 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m16:57:24.553071 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m16:57:24.562775 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:57:24.563125 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m16:57:24.563407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:24.564025 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m16:57:24.566077 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:57:24.566405 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m16:57:24.566685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:24.567381 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:57:24.567695 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:57:24.568000 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m16:57:24.568439 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:57:24.568751 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:57:24.569114 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m16:57:24.592629 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m16:57:24.593078 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m16:57:24.594247 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m16:57:24.595506 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m16:57:24.609108 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m16:57:24.609521 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m16:57:24.610068 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m16:57:24.610385 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m16:57:24.612420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a426e2b-ad11-4539-a751-9ea6aa54cbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0419EAA90>]}
[0m16:57:24.612867 [debug] [MainThread]: Using duckdb connection "master"
[0m16:57:24.613159 [debug] [MainThread]: On master: BEGIN
[0m16:57:24.613435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:57:24.614606 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:57:24.614913 [debug] [MainThread]: On master: COMMIT
[0m16:57:24.615205 [debug] [MainThread]: Using duckdb connection "master"
[0m16:57:24.615481 [debug] [MainThread]: On master: COMMIT
[0m16:57:24.616264 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:57:24.616576 [debug] [MainThread]: On master: Close
[0m16:57:24.621180 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m16:57:24.621692 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m16:57:24.622372 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m16:57:24.622729 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m16:57:24.629517 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m16:57:24.630474 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m16:57:24.661483 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m16:57:24.662416 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:57:24.662863 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m16:57:24.663205 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:57:24.664544 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:57:24.664921 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:57:24.665295 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m16:57:24.718642 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m16:57:24.726956 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:57:24.727391 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m16:57:24.779782 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m16:57:24.785358 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:57:24.786058 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m16:57:24.844347 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m16:57:24.855783 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:57:24.856213 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:57:24.856560 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:57:24.970392 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m16:57:24.975988 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:57:24.976640 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m16:57:25.173914 [debug] [Thread-1 (]: SQL status: OK in 0.197 seconds
[0m16:57:25.176280 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m16:57:25.178305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a426e2b-ad11-4539-a751-9ea6aa54cbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0421510D0>]}
[0m16:57:25.178956 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.55s]
[0m16:57:25.179763 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m16:57:25.180653 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m16:57:25.181117 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m16:57:25.181781 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m16:57:25.182153 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m16:57:25.184709 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m16:57:25.185519 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m16:57:25.188967 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m16:57:25.189998 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:57:25.190429 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m16:57:25.190772 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:57:25.192109 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:57:25.192482 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:57:25.192848 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when b.close < 12 then "complacent"
            when b.close <= 12 and close < 20 then "normal"
            when b.close >= 20 and "close" < 30 then "elevated"
            when b.close >= 30 then "crises"
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:57:25.236029 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when b.close < 12 then "complacent"
            when b.close <= 12 and close < 20 then "normal"
            when b.close >= 20 and "close" < 30 then "elevated"
            when b.close >= 30 then "crises"
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:57:25.236551 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m16:57:25.237008 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: ROLLBACK
[0m16:57:25.333991 [debug] [Thread-2 (]: Failed to rollback 'model.portfolio_project_2.int__regime_classification'
[0m16:57:25.334424 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m16:57:25.338742 [debug] [Thread-2 (]: Runtime Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  Binder Error: Referenced column "complacent" not found in FROM clause!
  Candidate bindings: "close", "loaded_at", "trade_date"
  
  LINE 18:             when b.close < 12 then "complacent"
                                              ^
[0m16:57:25.339200 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a426e2b-ad11-4539-a751-9ea6aa54cbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E042234470>]}
[0m16:57:25.339788 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model analytics_dev.int__regime_classification .. [[31mERROR[0m in 0.16s]
[0m16:57:25.340628 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m16:57:25.341233 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_classification' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  Binder Error: Referenced column "complacent" not found in FROM clause!
  Candidate bindings: "close", "loaded_at", "trade_date"
  
  LINE 18:             when b.close < 12 then "complacent"
                                              ^.
[0m16:57:25.343095 [debug] [MainThread]: Using duckdb connection "master"
[0m16:57:25.343432 [debug] [MainThread]: On master: BEGIN
[0m16:57:25.343736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:57:25.345008 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:57:25.345339 [debug] [MainThread]: On master: COMMIT
[0m16:57:25.345656 [debug] [MainThread]: Using duckdb connection "master"
[0m16:57:25.345959 [debug] [MainThread]: On master: COMMIT
[0m16:57:25.346549 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:57:25.346880 [debug] [MainThread]: On master: Close
[0m16:57:25.347277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:25.347572 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m16:57:25.347854 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m16:57:25.348135 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m16:57:25.348417 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m16:57:25.348703 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m16:57:25.349060 [info ] [MainThread]: 
[0m16:57:25.349559 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m16:57:25.350773 [debug] [MainThread]: Command end result
[0m16:57:25.399613 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:57:25.401936 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:57:25.408052 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m16:57:25.408404 [info ] [MainThread]: 
[0m16:57:25.408914 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:57:25.409410 [info ] [MainThread]: 
[0m16:57:25.409974 [error] [MainThread]: [31mFailure in model int__regime_classification (models\silver\int\int__regime_classification.sql)[0m
[0m16:57:25.410532 [error] [MainThread]:   Runtime Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  Binder Error: Referenced column "complacent" not found in FROM clause!
  Candidate bindings: "close", "loaded_at", "trade_date"
  
  LINE 18:             when b.close < 12 then "complacent"
                                              ^
[0m16:57:25.411056 [info ] [MainThread]: 
[0m16:57:25.411589 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_classification.sql
[0m16:57:25.412082 [info ] [MainThread]: 
[0m16:57:25.412580 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m16:57:25.413451 [debug] [MainThread]: Command `-c run` failed at 16:57:25.413341 after 6.15 seconds
[0m16:57:25.413827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E041DF4D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0421F5D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E041B26150>]}
[0m16:57:25.414192 [debug] [MainThread]: Flushing usage events
[0m16:57:26.102478 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:57:46.491465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8593A8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E859BB42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85A1F7ED0>]}


============================== 16:57:46.496345 | 8f7ce7a2-6458-42fd-bd8a-2eb2e941e8aa ==============================
[0m16:57:46.496345 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:57:46.497146 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt run --select +int__regime_classification', 'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m16:57:46.746177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f7ce7a2-6458-42fd-bd8a-2eb2e941e8aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E859560180>]}
[0m16:57:46.813409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f7ce7a2-6458-42fd-bd8a-2eb2e941e8aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85A09B790>]}
[0m16:57:46.816035 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:57:47.080634 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:57:47.463568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:57:47.464245 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m16:57:47.658617 [error] [MainThread]: Encountered an error:
Compilation Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  expected token 'end of print statement', got 'v'
    line 6
      from {{ ref("src_vix") v}}
[0m16:57:47.659769 [debug] [MainThread]: Command `-c run` failed at 16:57:47.659621 after 1.31 seconds
[0m16:57:47.660183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85B335950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85B334750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85B7288C0>]}
[0m16:57:47.660580 [debug] [MainThread]: Flushing usage events
[0m16:57:48.332507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:05.170070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DE3328050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DE3B342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DE4177ED0>]}


============================== 16:58:05.174593 | 75afa6f0-1d67-491e-ab88-27152f94f536 ==============================
[0m16:58:05.174593 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:58:05.175295 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select +int__regime_classification', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m16:58:05.420747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75afa6f0-1d67-491e-ab88-27152f94f536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DE34E0180>]}
[0m16:58:05.490321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75afa6f0-1d67-491e-ab88-27152f94f536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DE401B790>]}
[0m16:58:05.492921 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:58:05.748669 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:58:05.967322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:58:05.967977 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m16:58:06.310192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75afa6f0-1d67-491e-ab88-27152f94f536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DE5A61B50>]}
[0m16:58:06.436389 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:58:06.438867 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:58:06.464911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75afa6f0-1d67-491e-ab88-27152f94f536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DE54B0B90>]}
[0m16:58:06.465365 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m16:58:06.465830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75afa6f0-1d67-491e-ab88-27152f94f536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DE4033770>]}
[0m16:58:06.467817 [info ] [MainThread]: 
[0m16:58:06.468267 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:58:06.468718 [info ] [MainThread]: 
[0m16:58:06.469286 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:58:06.474747 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:58:06.556997 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:58:06.557390 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:58:06.557700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:08.036344 [debug] [ThreadPool]: SQL status: OK in 1.479 seconds
[0m16:58:08.037696 [debug] [ThreadPool]: On list_finance: Close
[0m16:58:08.038354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m16:58:08.038817 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m16:58:08.044826 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:58:08.045147 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:58:08.045441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:08.046959 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:58:08.048173 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:58:08.048475 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m16:58:08.049388 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:58:08.049688 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:58:08.049981 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m16:58:08.105954 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m16:58:08.107096 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:58:08.107504 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:58:08.107868 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:58:08.185599 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m16:58:08.187296 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m16:58:08.189592 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m16:58:08.195765 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:58:08.196319 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m16:58:08.196634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:08.197084 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m16:58:08.199542 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:58:08.199867 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m16:58:08.200152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:08.200714 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:58:08.201047 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:58:08.201375 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m16:58:08.201840 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:58:08.202172 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:58:08.202494 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m16:58:08.225242 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m16:58:08.225689 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m16:58:08.226861 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m16:58:08.228210 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m16:58:08.229312 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m16:58:08.229616 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m16:58:08.230101 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m16:58:08.230411 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m16:58:08.232288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75afa6f0-1d67-491e-ab88-27152f94f536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DE570BBA0>]}
[0m16:58:08.232722 [debug] [MainThread]: Using duckdb connection "master"
[0m16:58:08.233013 [debug] [MainThread]: On master: BEGIN
[0m16:58:08.233289 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:58:08.234469 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:58:08.234777 [debug] [MainThread]: On master: COMMIT
[0m16:58:08.235069 [debug] [MainThread]: Using duckdb connection "master"
[0m16:58:08.235348 [debug] [MainThread]: On master: COMMIT
[0m16:58:08.235898 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:58:08.236196 [debug] [MainThread]: On master: Close
[0m16:58:08.240857 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m16:58:08.241379 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m16:58:08.242012 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m16:58:08.242358 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m16:58:08.249199 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m16:58:08.250034 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m16:58:08.280804 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m16:58:08.281835 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:58:08.282279 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m16:58:08.282660 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:58:08.283970 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:08.284324 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:58:08.284667 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m16:58:08.368926 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m16:58:08.374834 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:58:08.375213 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m16:58:08.459182 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m16:58:08.471822 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:58:08.473401 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m16:58:08.546266 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m16:58:08.562034 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:58:08.562499 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:58:08.562880 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:58:08.696815 [debug] [Thread-1 (]: SQL status: OK in 0.133 seconds
[0m16:58:08.702693 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:58:08.703353 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m16:58:08.833424 [debug] [Thread-1 (]: SQL status: OK in 0.130 seconds
[0m16:58:08.835761 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m16:58:08.837741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75afa6f0-1d67-491e-ab88-27152f94f536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DE5E710D0>]}
[0m16:58:08.838353 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.59s]
[0m16:58:08.839154 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m16:58:08.839905 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m16:58:08.840377 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m16:58:08.841114 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m16:58:08.841482 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m16:58:08.844068 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m16:58:08.844862 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m16:58:08.848569 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m16:58:08.849634 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:58:08.850022 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m16:58:08.850355 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:58:08.851702 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:58:08.852177 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:58:08.852712 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        v.close, 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        b.close, 
        (case 
            when b.close < 12 then "complacent"
            when b.close <= 12 and close < 20 then "normal"
            when b.close >= 20 and "close" < 30 then "elevated"
            when b.close >= 30 then "crises"
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:58:08.908103 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        v.close, 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        b.close, 
        (case 
            when b.close < 12 then "complacent"
            when b.close <= 12 and close < 20 then "normal"
            when b.close >= 20 and "close" < 30 then "elevated"
            when b.close >= 30 then "crises"
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:58:08.908612 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m16:58:08.909150 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: ROLLBACK
[0m16:58:08.916401 [debug] [Thread-2 (]: Failed to rollback 'model.portfolio_project_2.int__regime_classification'
[0m16:58:08.916805 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m16:58:08.921341 [debug] [Thread-2 (]: Runtime Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  Binder Error: Referenced column "complacent" not found in FROM clause!
  Candidate bindings: "close", "loaded_at", "trade_date"
  
  LINE 18:             when b.close < 12 then "complacent"
                                              ^
[0m16:58:08.921843 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75afa6f0-1d67-491e-ab88-27152f94f536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DE5F54470>]}
[0m16:58:08.922459 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model analytics_dev.int__regime_classification .. [[31mERROR[0m in 0.08s]
[0m16:58:08.923356 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m16:58:08.924153 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_classification' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  Binder Error: Referenced column "complacent" not found in FROM clause!
  Candidate bindings: "close", "loaded_at", "trade_date"
  
  LINE 18:             when b.close < 12 then "complacent"
                                              ^.
[0m16:58:08.926761 [debug] [MainThread]: Using duckdb connection "master"
[0m16:58:08.927268 [debug] [MainThread]: On master: BEGIN
[0m16:58:08.927560 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:58:08.928813 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:58:08.929154 [debug] [MainThread]: On master: COMMIT
[0m16:58:08.929455 [debug] [MainThread]: Using duckdb connection "master"
[0m16:58:08.929739 [debug] [MainThread]: On master: COMMIT
[0m16:58:08.930394 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:58:08.930702 [debug] [MainThread]: On master: Close
[0m16:58:08.931088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:08.931388 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m16:58:08.931650 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m16:58:08.931907 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m16:58:08.932165 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m16:58:08.932418 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m16:58:08.932748 [info ] [MainThread]: 
[0m16:58:08.933342 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m16:58:08.935262 [debug] [MainThread]: Command end result
[0m16:58:08.982571 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:58:08.984890 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:58:08.990830 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m16:58:08.991186 [info ] [MainThread]: 
[0m16:58:08.991716 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:58:08.992205 [info ] [MainThread]: 
[0m16:58:08.992795 [error] [MainThread]: [31mFailure in model int__regime_classification (models\silver\int\int__regime_classification.sql)[0m
[0m16:58:08.993361 [error] [MainThread]:   Runtime Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  Binder Error: Referenced column "complacent" not found in FROM clause!
  Candidate bindings: "close", "loaded_at", "trade_date"
  
  LINE 18:             when b.close < 12 then "complacent"
                                              ^
[0m16:58:08.993902 [info ] [MainThread]: 
[0m16:58:08.994466 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_classification.sql
[0m16:58:08.994959 [info ] [MainThread]: 
[0m16:58:08.995490 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m16:58:08.996443 [debug] [MainThread]: Command `-c run` failed at 16:58:08.996293 after 3.95 seconds
[0m16:58:08.996839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DE5B14C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DE5F15D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DE52CC450>]}
[0m16:58:08.997220 [debug] [MainThread]: Flushing usage events
[0m16:58:09.841712 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:45.270215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BE858050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BF0642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BF6A3ED0>]}


============================== 16:59:45.274705 | 13f34992-0593-4ab0-b193-8345e742493d ==============================
[0m16:59:45.274705 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:59:45.275493 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select +int__regime_classification', 'write_json': 'True', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m16:59:45.525015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13f34992-0593-4ab0-b193-8345e742493d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BEA10180>]}
[0m16:59:45.591891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13f34992-0593-4ab0-b193-8345e742493d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BF54B790>]}
[0m16:59:45.594453 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:59:45.863568 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:59:46.252770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:59:46.253440 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m16:59:46.607517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13f34992-0593-4ab0-b193-8345e742493d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207C0F55B50>]}
[0m16:59:46.737669 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:59:46.740165 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:59:46.770005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13f34992-0593-4ab0-b193-8345e742493d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207C09A0B90>]}
[0m16:59:46.770506 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m16:59:46.771039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13f34992-0593-4ab0-b193-8345e742493d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BF563770>]}
[0m16:59:46.772998 [info ] [MainThread]: 
[0m16:59:46.773515 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:59:46.774093 [info ] [MainThread]: 
[0m16:59:46.774767 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:59:46.779614 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m16:59:46.855965 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m16:59:46.856354 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m16:59:46.856663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:48.190229 [debug] [ThreadPool]: SQL status: OK in 1.333 seconds
[0m16:59:48.191661 [debug] [ThreadPool]: On list_finance: Close
[0m16:59:48.192355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m16:59:48.192813 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m16:59:48.198904 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:59:48.199239 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m16:59:48.199549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:48.201059 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:59:48.202316 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:59:48.202619 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m16:59:48.203480 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:59:48.203779 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:59:48.204076 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m16:59:48.257234 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m16:59:48.259047 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:59:48.259660 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m16:59:48.260207 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m16:59:48.348401 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m16:59:48.350024 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m16:59:48.358083 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m16:59:48.366769 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m16:59:48.380671 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:59:48.385180 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:59:48.385913 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m16:59:48.386602 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m16:59:48.387272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:48.387919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:48.389722 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:59:48.390247 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m16:59:48.390771 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m16:59:48.391538 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:59:48.392060 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m16:59:48.392571 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m16:59:48.419426 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m16:59:48.419821 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m16:59:48.421071 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m16:59:48.422384 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m16:59:48.423562 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m16:59:48.423871 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m16:59:48.424393 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m16:59:48.424701 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m16:59:48.426452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13f34992-0593-4ab0-b193-8345e742493d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207C0BF6A90>]}
[0m16:59:48.426897 [debug] [MainThread]: Using duckdb connection "master"
[0m16:59:48.427206 [debug] [MainThread]: On master: BEGIN
[0m16:59:48.427495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:48.428724 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:59:48.429075 [debug] [MainThread]: On master: COMMIT
[0m16:59:48.429366 [debug] [MainThread]: Using duckdb connection "master"
[0m16:59:48.429644 [debug] [MainThread]: On master: COMMIT
[0m16:59:48.430205 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:59:48.430505 [debug] [MainThread]: On master: Close
[0m16:59:48.435084 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m16:59:48.435587 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m16:59:48.436265 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m16:59:48.436630 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m16:59:48.443351 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m16:59:48.444180 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m16:59:48.474927 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m16:59:48.476704 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:59:48.478041 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m16:59:48.478436 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:59:48.480399 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:59:48.480819 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:59:48.481168 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m16:59:48.560438 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m16:59:48.569636 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:59:48.570263 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m16:59:48.618122 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m16:59:48.621364 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:59:48.621748 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m16:59:48.682026 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m16:59:48.703785 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:59:48.704395 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:59:48.704913 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m16:59:48.837040 [debug] [Thread-1 (]: SQL status: OK in 0.132 seconds
[0m16:59:48.842287 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m16:59:48.842892 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m16:59:48.954926 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m16:59:48.957478 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m16:59:48.959727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13f34992-0593-4ab0-b193-8345e742493d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207C13610D0>]}
[0m16:59:48.960399 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.52s]
[0m16:59:48.961376 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m16:59:48.962254 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m16:59:48.963011 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m16:59:48.963926 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m16:59:48.964300 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m16:59:48.967046 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m16:59:48.967949 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m16:59:48.971188 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m16:59:48.972055 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:59:48.972416 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m16:59:48.972881 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:59:48.974444 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:59:48.974844 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:59:48.975216 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        v.close, 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        b.close, 
        (case 
            when b.close < 12 then 'complacent'
            when b.close <= 12 and close < 20 then 'normal'
            when b.close >= 20 and 'close' < 30 then 'elevated'
            when b.close >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    'close'::decimal as 'close', 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m16:59:49.056741 [debug] [Thread-2 (]: SQL status: OK in 0.081 seconds
[0m16:59:49.059822 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:59:49.060220 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m16:59:49.117943 [debug] [Thread-2 (]: SQL status: OK in 0.057 seconds
[0m16:59:49.120205 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m16:59:49.120904 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:59:49.121562 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m16:59:49.237167 [debug] [Thread-2 (]: SQL status: OK in 0.115 seconds
[0m16:59:49.239925 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m16:59:49.240335 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m16:59:49.381050 [debug] [Thread-2 (]: SQL status: OK in 0.140 seconds
[0m16:59:49.382545 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m16:59:49.383130 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13f34992-0593-4ab0-b193-8345e742493d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207C1444470>]}
[0m16:59:49.383773 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.42s]
[0m16:59:49.384640 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m16:59:49.386152 [debug] [MainThread]: Using duckdb connection "master"
[0m16:59:49.386478 [debug] [MainThread]: On master: BEGIN
[0m16:59:49.386772 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:59:49.387988 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:59:49.388325 [debug] [MainThread]: On master: COMMIT
[0m16:59:49.388651 [debug] [MainThread]: Using duckdb connection "master"
[0m16:59:49.388970 [debug] [MainThread]: On master: COMMIT
[0m16:59:49.389679 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:59:49.390017 [debug] [MainThread]: On master: Close
[0m16:59:49.390422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:49.390722 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m16:59:49.391012 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m16:59:49.391323 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m16:59:49.391596 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m16:59:49.391871 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m16:59:49.392283 [info ] [MainThread]: 
[0m16:59:49.392806 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.62 seconds (2.62s).
[0m16:59:49.393910 [debug] [MainThread]: Command end result
[0m16:59:49.444887 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m16:59:49.447425 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m16:59:49.453295 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m16:59:49.453631 [info ] [MainThread]: 
[0m16:59:49.454236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:49.454719 [info ] [MainThread]: 
[0m16:59:49.455226 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m16:59:49.456128 [debug] [MainThread]: Command `-c run` succeeded at 16:59:49.456011 after 4.36 seconds
[0m16:59:49.456508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207C13F4CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207C0F1F020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BF82C450>]}
[0m16:59:49.456885 [debug] [MainThread]: Flushing usage events
[0m16:59:50.169795 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:21.400245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150ECB88050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150ED3942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150ED9D7ED0>]}


============================== 17:00:21.404700 | 45e822b9-f428-4a79-83f2-e9e52f432ce8 ==============================
[0m17:00:21.404700 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:00:21.405411 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +int__regime_classification', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:00:21.653958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45e822b9-f428-4a79-83f2-e9e52f432ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150ECD40180>]}
[0m17:00:21.719129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45e822b9-f428-4a79-83f2-e9e52f432ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150ED87B790>]}
[0m17:00:21.721681 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:00:21.986172 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:00:22.366884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:00:22.367530 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m17:00:22.709320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45e822b9-f428-4a79-83f2-e9e52f432ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150EF265B50>]}
[0m17:00:22.837020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:00:22.839424 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:00:22.868573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45e822b9-f428-4a79-83f2-e9e52f432ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150EECC4B90>]}
[0m17:00:22.869029 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:00:22.869537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45e822b9-f428-4a79-83f2-e9e52f432ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150ED893770>]}
[0m17:00:22.871465 [info ] [MainThread]: 
[0m17:00:22.871950 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:00:22.872410 [info ] [MainThread]: 
[0m17:00:22.873018 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:00:22.878053 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:00:22.956126 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:00:22.956515 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:00:22.956825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:24.404720 [debug] [ThreadPool]: SQL status: OK in 1.448 seconds
[0m17:00:24.406102 [debug] [ThreadPool]: On list_finance: Close
[0m17:00:24.406768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:00:24.407246 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:00:24.413414 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:00:24.413776 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:00:24.414156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:24.415683 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:00:24.416995 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:00:24.417320 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:00:24.418280 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:00:24.418608 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:00:24.418909 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:00:24.482024 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m17:00:24.485989 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:00:24.486654 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:00:24.487178 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:00:24.535434 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m17:00:24.536160 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:00:24.539632 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:00:24.547858 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:00:24.548378 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:00:24.548728 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:00:24.550883 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:00:24.551255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:24.551632 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:00:24.552250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:24.553030 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:00:24.553450 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:00:24.553773 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:00:24.554361 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:00:24.554694 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:00:24.555017 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:00:24.579110 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:00:24.579509 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m17:00:24.580803 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:00:24.582116 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:00:24.583189 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:00:24.583549 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:00:24.584083 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:00:24.584412 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:00:24.586408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45e822b9-f428-4a79-83f2-e9e52f432ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150EEF0AA90>]}
[0m17:00:24.586869 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:24.587182 [debug] [MainThread]: On master: BEGIN
[0m17:00:24.587479 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:24.588674 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:00:24.589003 [debug] [MainThread]: On master: COMMIT
[0m17:00:24.589323 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:24.589634 [debug] [MainThread]: On master: COMMIT
[0m17:00:24.590369 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:00:24.590720 [debug] [MainThread]: On master: Close
[0m17:00:24.595600 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:00:24.596134 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:00:24.596818 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:00:24.597176 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:00:24.604365 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:00:24.605218 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:00:24.635558 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:00:24.636481 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:00:24.636853 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:00:24.637187 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:00:24.638483 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:24.638859 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:00:24.639237 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:00:24.703086 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m17:00:24.710327 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:00:24.710831 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:00:24.775815 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m17:00:24.779072 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:00:24.779458 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:00:24.841334 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m17:00:24.852792 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:00:24.853230 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:00:24.853576 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:00:24.972229 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m17:00:24.983828 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:00:24.984937 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:00:25.104423 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m17:00:25.106772 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:00:25.109059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45e822b9-f428-4a79-83f2-e9e52f432ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150EF671190>]}
[0m17:00:25.109778 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.51s]
[0m17:00:25.110597 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:00:25.111443 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:00:25.111935 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:00:25.112638 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:00:25.113011 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:00:25.115667 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:00:25.116502 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:00:25.119709 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:00:25.120574 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:00:25.120957 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:00:25.121297 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:00:25.122555 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:25.122939 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:00:25.123336 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" <= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:00:25.208932 [debug] [Thread-2 (]: SQL status: OK in 0.085 seconds
[0m17:00:25.213286 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:00:25.214032 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:00:25.277977 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m17:00:25.282991 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:00:25.283628 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:00:25.350701 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m17:00:25.352484 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:00:25.352881 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:00:25.353230 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:00:25.546169 [debug] [Thread-2 (]: SQL status: OK in 0.192 seconds
[0m17:00:25.549295 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:00:25.549697 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:00:25.680338 [debug] [Thread-2 (]: SQL status: OK in 0.130 seconds
[0m17:00:25.682020 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:00:25.682551 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45e822b9-f428-4a79-83f2-e9e52f432ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150EF704260>]}
[0m17:00:25.683125 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.57s]
[0m17:00:25.683930 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:00:25.685506 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:25.685843 [debug] [MainThread]: On master: BEGIN
[0m17:00:25.686149 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:00:25.687431 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:00:25.687762 [debug] [MainThread]: On master: COMMIT
[0m17:00:25.688133 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:25.688448 [debug] [MainThread]: On master: COMMIT
[0m17:00:25.689186 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:00:25.689532 [debug] [MainThread]: On master: Close
[0m17:00:25.690002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:25.690290 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:00:25.690569 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:00:25.690854 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:00:25.691136 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:00:25.691408 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:00:25.691782 [info ] [MainThread]: 
[0m17:00:25.692319 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m17:00:25.693407 [debug] [MainThread]: Command end result
[0m17:00:25.742963 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:00:25.745780 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:00:25.751703 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:00:25.752052 [info ] [MainThread]: 
[0m17:00:25.752594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:00:25.753200 [info ] [MainThread]: 
[0m17:00:25.753696 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:00:25.754587 [debug] [MainThread]: Command `-c run` succeeded at 17:00:25.754472 after 4.47 seconds
[0m17:00:25.754965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150EF730C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150EF219E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150EEC6F4D0>]}
[0m17:00:25.755347 [debug] [MainThread]: Flushing usage events
[0m17:00:26.570350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:40.099182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020459D48050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045A5542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045AB93ED0>]}


============================== 17:00:40.103881 | f907ab24-170b-4e84-9910-c1b144ecd1dc ==============================
[0m17:00:40.103881 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:00:40.104589 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select +int__regime_changes', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:00:40.354314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f907ab24-170b-4e84-9910-c1b144ecd1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020459F00180>]}
[0m17:00:40.420322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f907ab24-170b-4e84-9910-c1b144ecd1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045AA3B790>]}
[0m17:00:40.422802 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:00:40.683161 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:00:41.076067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:00:41.076446 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:00:41.144536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f907ab24-170b-4e84-9910-c1b144ecd1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045BC84D50>]}
[0m17:00:41.329872 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:00:41.332304 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:00:41.362065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f907ab24-170b-4e84-9910-c1b144ecd1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045BEB0B90>]}
[0m17:00:41.362531 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:00:41.363020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f907ab24-170b-4e84-9910-c1b144ecd1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045AA534D0>]}
[0m17:00:41.365019 [info ] [MainThread]: 
[0m17:00:41.365515 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:00:41.365969 [info ] [MainThread]: 
[0m17:00:41.366598 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:00:41.371286 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:00:41.449246 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:00:41.449635 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:00:41.449945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:43.308451 [debug] [ThreadPool]: SQL status: OK in 1.858 seconds
[0m17:00:43.310171 [debug] [ThreadPool]: On list_finance: Close
[0m17:00:43.310997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:00:43.311615 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:00:43.318015 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:00:43.318338 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:00:43.318635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:43.320178 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:00:43.321470 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:00:43.321776 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:00:43.322710 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:00:43.323008 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:00:43.323296 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:00:43.374066 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m17:00:43.375124 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:00:43.375489 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:00:43.375831 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:00:43.421718 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m17:00:43.422506 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:00:43.426587 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:00:43.435055 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:00:43.435379 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:00:43.435704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:43.436342 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:00:43.438330 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:00:43.438639 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:00:43.438914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:43.439474 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:00:43.439861 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:00:43.440166 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:00:43.440639 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:00:43.440962 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:00:43.441272 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:00:43.464253 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:00:43.464674 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:00:43.465922 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:00:43.467292 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:00:43.468240 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:00:43.468547 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:00:43.469137 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:00:43.469478 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:00:43.471451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f907ab24-170b-4e84-9910-c1b144ecd1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045C5E3BA0>]}
[0m17:00:43.471899 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:43.472205 [debug] [MainThread]: On master: BEGIN
[0m17:00:43.472499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:43.473817 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:00:43.474139 [debug] [MainThread]: On master: COMMIT
[0m17:00:43.474435 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:43.474716 [debug] [MainThread]: On master: COMMIT
[0m17:00:43.475267 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:00:43.475614 [debug] [MainThread]: On master: Close
[0m17:00:43.480410 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:00:43.480968 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:00:43.481648 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:00:43.482007 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:00:43.488982 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:00:43.490040 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:00:43.521125 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:00:43.522035 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:00:43.522392 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:00:43.522717 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:00:43.524160 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:43.524609 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:00:43.525013 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:00:43.583520 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m17:00:43.590279 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:00:43.590746 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:00:43.663115 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m17:00:43.675528 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:00:43.676672 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:00:43.746917 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m17:00:43.780062 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:00:43.780677 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:00:43.781219 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:00:43.902534 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m17:00:43.917575 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:00:43.918712 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:00:44.030628 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m17:00:44.032962 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:00:44.035445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f907ab24-170b-4e84-9910-c1b144ecd1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045C808110>]}
[0m17:00:44.036327 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.55s]
[0m17:00:44.037386 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:00:44.038143 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:00:44.038634 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:00:44.039573 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:00:44.039923 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:00:44.043314 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:00:44.044391 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:00:44.048060 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:00:44.048975 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:00:44.049392 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:00:44.049714 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:00:44.051152 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:00:44.051512 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:00:44.051870 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" <= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:00:44.131483 [debug] [Thread-2 (]: SQL status: OK in 0.079 seconds
[0m17:00:44.135181 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:00:44.135683 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:00:44.201335 [debug] [Thread-2 (]: SQL status: OK in 0.065 seconds
[0m17:00:44.220424 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:00:44.221365 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:00:44.291169 [debug] [Thread-2 (]: SQL status: OK in 0.069 seconds
[0m17:00:44.292714 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:00:44.293145 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:00:44.293592 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:00:44.478322 [debug] [Thread-2 (]: SQL status: OK in 0.184 seconds
[0m17:00:44.481882 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:00:44.482457 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:00:44.598092 [debug] [Thread-2 (]: SQL status: OK in 0.115 seconds
[0m17:00:44.599494 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:00:44.600018 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f907ab24-170b-4e84-9910-c1b144ecd1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045C595910>]}
[0m17:00:44.600632 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.56s]
[0m17:00:44.601432 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:00:44.602172 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:00:44.602626 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:00:44.603299 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:00:44.603661 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:00:44.606644 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:00:44.607594 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:00:44.611630 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:00:44.612815 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:00:44.613263 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:00:44.613743 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:00:44.614910 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:00:44.615263 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:00:44.615637 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at, asc) as prev_regime
from regime_classifications
),

changed as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime = prev_regime then 'FALSE'
            else 'TRUE'
        end) as changed
from regime_classifications
),

change_counter as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed, 
        sum(changed) over(partition by regime order by trade_date asc, loaded_at asc) as change_counter
    from changed
)

select *
from change_counter
  );

[0m17:00:44.620756 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at, asc) as prev_regime
from regime_classifications
),

changed as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime = prev_regime then 'FALSE'
            else 'TRUE'
        end) as changed
from regime_classifications
),

change_counter as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed, 
        sum(changed) over(partition by regime order by trade_date asc, loaded_at asc) as change_counter
    from changed
)

select *
from change_counter
  );

[0m17:00:44.621302 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:00:44.621924 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: ROLLBACK
[0m17:00:44.631415 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.int__regime_changes'
[0m17:00:44.631849 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:00:44.636551 [debug] [Thread-3 (]: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Parser Error: syntax error at or near "asc"
  
  LINE 19:     lag(regime) over(order by trade_date asc, loaded_at, asc) as prev_regime
                                                                    ^
[0m17:00:44.637103 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f907ab24-170b-4e84-9910-c1b144ecd1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045C6FACB0>]}
[0m17:00:44.637841 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model analytics_dev.int__regime_changes ......... [[31mERROR[0m in 0.03s]
[0m17:00:44.638682 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:00:44.639270 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_changes' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Parser Error: syntax error at or near "asc"
  
  LINE 19:     lag(regime) over(order by trade_date asc, loaded_at, asc) as prev_regime
                                                                    ^.
[0m17:00:44.641456 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:44.641957 [debug] [MainThread]: On master: BEGIN
[0m17:00:44.642319 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:00:44.644256 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:00:44.644858 [debug] [MainThread]: On master: COMMIT
[0m17:00:44.645429 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:44.645978 [debug] [MainThread]: On master: COMMIT
[0m17:00:44.647054 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:00:44.647618 [debug] [MainThread]: On master: Close
[0m17:00:44.648300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:44.648845 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:00:44.649265 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:00:44.649593 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:00:44.649986 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:00:44.650294 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:00:44.650555 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:00:44.650909 [info ] [MainThread]: 
[0m17:00:44.651405 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.28 seconds (3.28s).
[0m17:00:44.652667 [debug] [MainThread]: Command end result
[0m17:00:44.697604 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:00:44.700115 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:00:44.706082 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:00:44.706430 [info ] [MainThread]: 
[0m17:00:44.706960 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:00:44.707457 [info ] [MainThread]: 
[0m17:00:44.708211 [error] [MainThread]: [31mFailure in model int__regime_changes (models\silver\int\int__regime_changes.sql)[0m
[0m17:00:44.709129 [error] [MainThread]:   Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Parser Error: syntax error at or near "asc"
  
  LINE 19:     lag(regime) over(order by trade_date asc, loaded_at, asc) as prev_regime
                                                                    ^
[0m17:00:44.709892 [info ] [MainThread]: 
[0m17:00:44.710498 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_changes.sql
[0m17:00:44.710976 [info ] [MainThread]: 
[0m17:00:44.711468 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m17:00:44.712394 [debug] [MainThread]: Command `-c run` failed at 17:00:44.712250 after 4.74 seconds
[0m17:00:44.712828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045BEDBBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045C0925D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045AA9BB60>]}
[0m17:00:44.713212 [debug] [MainThread]: Flushing usage events
[0m17:00:45.569549 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:58.543679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB5ACC050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB62D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB6913ED0>]}


============================== 17:00:58.548190 | e715b144-e6a3-4d9b-a86d-7e413ad75208 ==============================
[0m17:00:58.548190 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:00:58.548900 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt run --select +int__regime_changes', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:00:58.806220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e715b144-e6a3-4d9b-a86d-7e413ad75208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB5C80180>]}
[0m17:00:58.874077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e715b144-e6a3-4d9b-a86d-7e413ad75208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB67BB790>]}
[0m17:00:58.876924 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:00:59.134333 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:00:59.402414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:00:59.403259 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:00:59.823063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e715b144-e6a3-4d9b-a86d-7e413ad75208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB8241E50>]}
[0m17:00:59.973107 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:00:59.976238 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:01:00.017336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e715b144-e6a3-4d9b-a86d-7e413ad75208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB7CA4B90>]}
[0m17:01:00.017851 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:01:00.018348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e715b144-e6a3-4d9b-a86d-7e413ad75208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB67D3770>]}
[0m17:01:00.020795 [info ] [MainThread]: 
[0m17:01:00.021314 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:01:00.021814 [info ] [MainThread]: 
[0m17:01:00.022407 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:01:00.028055 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:01:00.118817 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:01:00.119229 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:01:00.119552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:01.626901 [debug] [ThreadPool]: SQL status: OK in 1.507 seconds
[0m17:01:01.628491 [debug] [ThreadPool]: On list_finance: Close
[0m17:01:01.629264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:01:01.629824 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:01:01.636136 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:01:01.636453 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:01:01.636746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:01.638322 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:01:01.639762 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:01:01.640085 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:01:01.641107 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:01:01.641410 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:01:01.641698 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:01:01.692231 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m17:01:01.693480 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:01:01.693922 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:01:01.694332 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:01:01.746672 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m17:01:01.747639 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:01:01.753188 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:01:01.766727 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:01:01.776008 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:01:01.780653 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:01:01.781785 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:01:01.782617 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:01:01.783299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:01.783924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:01.785616 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:01:01.786173 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:01:01.786733 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:01:01.787309 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:01:01.788163 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:01:01.788667 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:01:01.816617 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m17:01:01.818411 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:01:01.818823 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m17:01:01.820823 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:01:01.822132 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:01:01.822474 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:01:01.823173 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:01:01.823468 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:01:01.825528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e715b144-e6a3-4d9b-a86d-7e413ad75208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB7EEB930>]}
[0m17:01:01.825976 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:01.826285 [debug] [MainThread]: On master: BEGIN
[0m17:01:01.826581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:01:01.827882 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:01:01.828199 [debug] [MainThread]: On master: COMMIT
[0m17:01:01.828497 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:01.828774 [debug] [MainThread]: On master: COMMIT
[0m17:01:01.829335 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:01:01.829641 [debug] [MainThread]: On master: Close
[0m17:01:01.834383 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:01:01.834887 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:01:01.835569 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:01:01.835928 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:01:01.842632 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:01:01.843429 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:01:01.874364 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:01:01.875417 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:01:01.875853 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:01:01.876199 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:01:01.877497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:01.877866 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:01:01.878224 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:01:01.948498 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m17:01:01.954817 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:01:01.955216 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:01:02.015727 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m17:01:02.020784 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:01:02.021393 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:01:02.087986 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m17:01:02.104042 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:01:02.104533 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:01:02.104994 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:01:02.218074 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m17:01:02.223288 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:01:02.223914 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:01:02.339137 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m17:01:02.341742 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:01:02.346928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e715b144-e6a3-4d9b-a86d-7e413ad75208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB8651190>]}
[0m17:01:02.347613 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.51s]
[0m17:01:02.348423 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:01:02.349217 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:01:02.349707 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:01:02.350393 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:01:02.350761 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:01:02.353366 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:01:02.354208 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:01:02.357624 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:01:02.358596 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:01:02.359012 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:01:02.359381 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:01:02.360783 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:01:02.361242 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:01:02.361650 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" <= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:01:02.547912 [debug] [Thread-2 (]: SQL status: OK in 0.186 seconds
[0m17:01:02.555756 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:01:02.556628 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:01:02.632272 [debug] [Thread-2 (]: SQL status: OK in 0.074 seconds
[0m17:01:02.636461 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:01:02.644606 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:01:02.715517 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m17:01:02.718559 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:01:02.719090 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:01:02.719424 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:01:02.938968 [debug] [Thread-2 (]: SQL status: OK in 0.219 seconds
[0m17:01:02.943451 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:01:02.943864 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:01:03.053306 [debug] [Thread-2 (]: SQL status: OK in 0.109 seconds
[0m17:01:03.054951 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:01:03.055491 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e715b144-e6a3-4d9b-a86d-7e413ad75208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB8734260>]}
[0m17:01:03.056085 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.71s]
[0m17:01:03.056882 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:01:03.057775 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:01:03.058504 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:01:03.059456 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:01:03.059908 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:01:03.062589 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:01:03.063506 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:01:03.066751 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:01:03.067530 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:01:03.067884 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:01:03.068213 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:01:03.069523 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:01:03.069893 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:01:03.070268 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

changed as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime = prev_regime then 'FALSE'
            else 'TRUE'
        end) as changed
from regime_classifications
),

change_counter as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed, 
        sum(changed) over(partition by regime order by trade_date asc, loaded_at asc) as change_counter
    from changed
)

select *
from change_counter
  );

[0m17:01:03.130282 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

changed as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime = prev_regime then 'FALSE'
            else 'TRUE'
        end) as changed
from regime_classifications
),

change_counter as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed, 
        sum(changed) over(partition by regime order by trade_date asc, loaded_at asc) as change_counter
    from changed
)

select *
from change_counter
  );

[0m17:01:03.130774 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:01:03.131223 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: ROLLBACK
[0m17:01:03.137963 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.int__regime_changes'
[0m17:01:03.138339 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:01:03.142728 [debug] [Thread-3 (]: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: Referenced column "prev_regime" not found in FROM clause!
  Candidate bindings: "regime", "trade_date"
  
  LINE 28:         prev_regime,
                   ^
[0m17:01:03.143212 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e715b144-e6a3-4d9b-a86d-7e413ad75208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB9BEE170>]}
[0m17:01:03.143784 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model analytics_dev.int__regime_changes ......... [[31mERROR[0m in 0.08s]
[0m17:01:03.144572 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:01:03.145147 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_changes' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: Referenced column "prev_regime" not found in FROM clause!
  Candidate bindings: "regime", "trade_date"
  
  LINE 28:         prev_regime,
                   ^.
[0m17:01:03.147088 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:03.147416 [debug] [MainThread]: On master: BEGIN
[0m17:01:03.147710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:01:03.148898 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:01:03.149208 [debug] [MainThread]: On master: COMMIT
[0m17:01:03.149499 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:03.149779 [debug] [MainThread]: On master: COMMIT
[0m17:01:03.150544 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:01:03.150876 [debug] [MainThread]: On master: Close
[0m17:01:03.151293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:03.151669 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:01:03.151930 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:01:03.152192 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:01:03.152448 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:01:03.152706 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:01:03.152962 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:01:03.153348 [info ] [MainThread]: 
[0m17:01:03.153878 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m17:01:03.155133 [debug] [MainThread]: Command end result
[0m17:01:03.202442 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:01:03.204860 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:01:03.210914 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:01:03.211273 [info ] [MainThread]: 
[0m17:01:03.211801 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:01:03.212294 [info ] [MainThread]: 
[0m17:01:03.212907 [error] [MainThread]: [31mFailure in model int__regime_changes (models\silver\int\int__regime_changes.sql)[0m
[0m17:01:03.213520 [error] [MainThread]:   Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: Referenced column "prev_regime" not found in FROM clause!
  Candidate bindings: "regime", "trade_date"
  
  LINE 28:         prev_regime,
                   ^
[0m17:01:03.214064 [info ] [MainThread]: 
[0m17:01:03.214611 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_changes.sql
[0m17:01:03.215078 [info ] [MainThread]: 
[0m17:01:03.215588 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m17:01:03.216488 [debug] [MainThread]: Command `-c run` failed at 17:01:03.216373 after 4.80 seconds
[0m17:01:03.216863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB7C4F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB5BFFDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB681BB60>]}
[0m17:01:03.217220 [debug] [MainThread]: Flushing usage events
[0m17:01:03.995609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:01:53.546508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F751418050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F751C242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F752267ED0>]}


============================== 17:01:53.550893 | b8ef6a92-a47b-45e9-9609-384a222b8f53 ==============================
[0m17:01:53.550893 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:01:53.551816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +int__regime_changes', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:01:53.797650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8ef6a92-a47b-45e9-9609-384a222b8f53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7515D0180>]}
[0m17:01:53.863131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8ef6a92-a47b-45e9-9609-384a222b8f53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75210B790>]}
[0m17:01:53.865627 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:01:54.115347 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:01:54.500316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:01:54.500999 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:01:54.845233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8ef6a92-a47b-45e9-9609-384a222b8f53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F753B69B50>]}
[0m17:01:54.969661 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:01:54.972110 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:01:54.999964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8ef6a92-a47b-45e9-9609-384a222b8f53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F753604B90>]}
[0m17:01:55.000426 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:01:55.000942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ef6a92-a47b-45e9-9609-384a222b8f53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F752123770>]}
[0m17:01:55.002911 [info ] [MainThread]: 
[0m17:01:55.003402 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:01:55.003968 [info ] [MainThread]: 
[0m17:01:55.004607 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:01:55.009478 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:01:55.089943 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:01:55.090330 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:01:55.090643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:56.497330 [debug] [ThreadPool]: SQL status: OK in 1.407 seconds
[0m17:01:56.498856 [debug] [ThreadPool]: On list_finance: Close
[0m17:01:56.499573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:01:56.500078 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:01:56.506395 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:01:56.506762 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:01:56.507066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:56.508663 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:01:56.510098 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:01:56.510428 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:01:56.511527 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:01:56.511850 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:01:56.512166 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:01:56.563151 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m17:01:56.564118 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:01:56.564446 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:01:56.564745 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:01:56.614514 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m17:01:56.615046 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:01:56.617641 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:01:56.625517 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:01:56.625103 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:01:56.628958 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:01:56.629519 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:01:56.630006 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:01:56.630474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:56.630975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:56.632346 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:01:56.632772 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:01:56.633203 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:01:56.633971 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:01:56.634402 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:01:56.634826 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:01:56.660021 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m17:01:56.660487 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m17:01:56.662219 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:01:56.663477 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:01:56.664651 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:01:56.664989 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:01:56.665514 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:01:56.665836 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:01:56.667973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ef6a92-a47b-45e9-9609-384a222b8f53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75384B930>]}
[0m17:01:56.668425 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:56.668738 [debug] [MainThread]: On master: BEGIN
[0m17:01:56.669038 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:01:56.670298 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:01:56.670625 [debug] [MainThread]: On master: COMMIT
[0m17:01:56.670974 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:56.671272 [debug] [MainThread]: On master: COMMIT
[0m17:01:56.671870 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:01:56.672190 [debug] [MainThread]: On master: Close
[0m17:01:56.677414 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:01:56.677990 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:01:56.678708 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:01:56.679078 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:01:56.686332 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:01:56.687288 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:01:56.717407 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:01:56.718486 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:01:56.718989 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:01:56.719331 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:01:56.720694 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:56.721082 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:01:56.721440 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:01:56.895651 [debug] [Thread-1 (]: SQL status: OK in 0.174 seconds
[0m17:01:56.902892 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:01:56.903397 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:01:56.962875 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m17:01:56.966729 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:01:56.967192 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:01:57.017093 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m17:01:57.030248 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:01:57.030739 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:01:57.031135 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:01:57.126404 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m17:01:57.131704 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:01:57.132317 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:01:57.221911 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m17:01:57.224296 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:01:57.226936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ef6a92-a47b-45e9-9609-384a222b8f53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F753FB4F50>]}
[0m17:01:57.227656 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.55s]
[0m17:01:57.228543 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:01:57.229642 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:01:57.230130 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:01:57.230838 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:01:57.231206 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:01:57.233940 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:01:57.234792 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:01:57.237919 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:01:57.238704 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:01:57.239061 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:01:57.239391 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:01:57.240744 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:01:57.241246 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:01:57.241643 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" <= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:01:57.328401 [debug] [Thread-2 (]: SQL status: OK in 0.086 seconds
[0m17:01:57.331760 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:01:57.332210 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:01:57.394294 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m17:01:57.397478 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:01:57.397858 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:01:57.456365 [debug] [Thread-2 (]: SQL status: OK in 0.058 seconds
[0m17:01:57.457879 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:01:57.458273 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:01:57.458629 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:01:57.654975 [debug] [Thread-2 (]: SQL status: OK in 0.196 seconds
[0m17:01:57.657448 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:01:57.657844 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:01:57.800091 [debug] [Thread-2 (]: SQL status: OK in 0.142 seconds
[0m17:01:57.801907 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:01:57.802434 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ef6a92-a47b-45e9-9609-384a222b8f53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F754094260>]}
[0m17:01:57.802996 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.57s]
[0m17:01:57.803792 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:01:57.804556 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:01:57.805016 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:01:57.805688 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:01:57.806049 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:01:57.809149 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:01:57.810426 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:01:57.813931 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:01:57.814906 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:01:57.815284 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:01:57.815619 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:01:57.817428 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:01:57.817854 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:01:57.818235 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

changed as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime = prev_regime then 'FALSE'
            else 'TRUE'
        end) as changed
from prev_regime
),

change_counter as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed, 
        sum(changed) over(partition by regime order by trade_date asc, loaded_at asc) as change_counter
    from changed
)

select *
from change_counter
  );

[0m17:01:57.872868 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

changed as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime = prev_regime then 'FALSE'
            else 'TRUE'
        end) as changed
from prev_regime
),

change_counter as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed, 
        sum(changed) over(partition by regime order by trade_date asc, loaded_at asc) as change_counter
    from changed
)

select *
from change_counter
  );

[0m17:01:57.873369 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:01:57.873835 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: ROLLBACK
[0m17:01:57.881405 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.int__regime_changes'
[0m17:01:57.881850 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:01:57.886282 [debug] [Thread-3 (]: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  	sum(BIGNUM) -> BIGNUM
  
  
  LINE 43:         sum(changed) over(partition by regime order by trade_date...
                   ^
[0m17:01:57.886754 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ef6a92-a47b-45e9-9609-384a222b8f53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75554E0D0>]}
[0m17:01:57.887348 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model analytics_dev.int__regime_changes ......... [[31mERROR[0m in 0.08s]
[0m17:01:57.888186 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:01:57.888808 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_changes' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  	sum(BIGNUM) -> BIGNUM
  
  
  LINE 43:         sum(changed) over(partition by regime order by trade_date...
                   ^.
[0m17:01:57.890687 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:57.891051 [debug] [MainThread]: On master: BEGIN
[0m17:01:57.891357 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:01:57.892556 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:01:57.892915 [debug] [MainThread]: On master: COMMIT
[0m17:01:57.893236 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:57.893544 [debug] [MainThread]: On master: COMMIT
[0m17:01:57.894273 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:01:57.894639 [debug] [MainThread]: On master: Close
[0m17:01:57.895062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:57.895357 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:01:57.895630 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:01:57.895897 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:01:57.896170 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:01:57.896434 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:01:57.896696 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:01:57.897059 [info ] [MainThread]: 
[0m17:01:57.897569 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m17:01:57.898831 [debug] [MainThread]: Command end result
[0m17:01:57.947772 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:01:57.950381 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:01:57.956360 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:01:57.956700 [info ] [MainThread]: 
[0m17:01:57.957347 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:01:57.957878 [info ] [MainThread]: 
[0m17:01:57.958483 [error] [MainThread]: [31mFailure in model int__regime_changes (models\silver\int\int__regime_changes.sql)[0m
[0m17:01:57.959100 [error] [MainThread]:   Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  	sum(BIGNUM) -> BIGNUM
  
  
  LINE 43:         sum(changed) over(partition by regime order by trade_date...
                   ^
[0m17:01:57.959816 [info ] [MainThread]: 
[0m17:01:57.960441 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_changes.sql
[0m17:01:57.960957 [info ] [MainThread]: 
[0m17:01:57.961492 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m17:01:57.962452 [debug] [MainThread]: Command `-c run` failed at 17:01:57.962319 after 4.55 seconds
[0m17:01:57.962931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7535AF9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75154FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75216FB60>]}
[0m17:01:57.963297 [debug] [MainThread]: Flushing usage events
[0m17:01:58.690699 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:57.246206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E52B8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E5AC42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E6107ED0>]}


============================== 17:09:57.250810 | 2c3f4e41-0f11-49a0-917d-f92dd5d6b2d9 ==============================
[0m17:09:57.250810 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:09:57.251515 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select +int__regime_changes', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m17:09:57.523797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c3f4e41-0f11-49a0-917d-f92dd5d6b2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E5470180>]}
[0m17:09:57.588664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c3f4e41-0f11-49a0-917d-f92dd5d6b2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E5FAB790>]}
[0m17:09:57.591250 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:09:57.854156 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:09:58.232108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:09:58.232751 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:09:58.574040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c3f4e41-0f11-49a0-917d-f92dd5d6b2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E7965B50>]}
[0m17:09:58.699974 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:09:58.702438 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:09:58.731634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c3f4e41-0f11-49a0-917d-f92dd5d6b2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E7414B90>]}
[0m17:09:58.740237 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:09:58.740962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c3f4e41-0f11-49a0-917d-f92dd5d6b2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E5FC3770>]}
[0m17:09:58.742960 [info ] [MainThread]: 
[0m17:09:58.743460 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:09:58.743923 [info ] [MainThread]: 
[0m17:09:58.744531 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:09:58.749838 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:09:58.827371 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:09:58.827878 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:09:58.828243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:00.142794 [debug] [ThreadPool]: SQL status: OK in 1.314 seconds
[0m17:10:00.144341 [debug] [ThreadPool]: On list_finance: Close
[0m17:10:00.145038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:10:00.145524 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:10:00.151664 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:10:00.151991 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:10:00.152295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:00.153838 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:10:00.155124 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:10:00.155431 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:10:00.156368 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:10:00.156668 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:10:00.156956 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:10:00.212534 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m17:10:00.213478 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:10:00.213796 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:10:00.214084 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:10:00.253056 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m17:10:00.253510 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:10:00.255580 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:10:00.262038 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:10:00.262811 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:10:00.263207 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:10:00.266722 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:10:00.267158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:00.267550 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:10:00.268199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:00.268862 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:10:00.269267 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:10:00.269724 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:10:00.270200 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:10:00.270534 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:10:00.270861 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:10:00.296224 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m17:10:00.296697 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m17:10:00.297924 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:10:00.299211 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:10:00.300536 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:10:00.300868 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:10:00.301405 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:10:00.301727 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:10:00.303846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c3f4e41-0f11-49a0-917d-f92dd5d6b2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E7657860>]}
[0m17:10:00.304347 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:00.304672 [debug] [MainThread]: On master: BEGIN
[0m17:10:00.304975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:00.306113 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:10:00.306427 [debug] [MainThread]: On master: COMMIT
[0m17:10:00.306728 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:00.307011 [debug] [MainThread]: On master: COMMIT
[0m17:10:00.307576 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:00.307915 [debug] [MainThread]: On master: Close
[0m17:10:00.312613 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:10:00.313272 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:10:00.314012 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:10:00.314399 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:10:00.321427 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:10:00.322302 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:10:00.352572 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:10:00.353513 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:10:00.353891 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:10:00.354286 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:10:00.355637 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:10:00.356015 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:10:00.356391 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:10:00.421215 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m17:10:00.427277 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:10:00.427828 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:10:00.490754 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m17:10:00.493969 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:10:00.494344 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:10:00.565820 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m17:10:00.577184 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:10:00.577618 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:10:00.577970 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:10:00.702684 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m17:10:00.708266 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:10:00.708994 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:10:00.841422 [debug] [Thread-1 (]: SQL status: OK in 0.132 seconds
[0m17:10:00.843756 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:10:00.846300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c3f4e41-0f11-49a0-917d-f92dd5d6b2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E7DC1190>]}
[0m17:10:00.847059 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.53s]
[0m17:10:00.848128 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:10:00.849316 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:10:00.850409 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:10:00.851642 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:10:00.852118 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:10:00.855402 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:10:00.856752 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:10:00.860578 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:10:00.861644 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:10:00.862366 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:10:00.862725 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:10:00.864174 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:10:00.864691 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:10:00.865164 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" <= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:10:00.942906 [debug] [Thread-2 (]: SQL status: OK in 0.077 seconds
[0m17:10:00.946895 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:10:00.947417 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:10:01.007715 [debug] [Thread-2 (]: SQL status: OK in 0.060 seconds
[0m17:10:01.011576 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:10:01.012302 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:10:01.074743 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m17:10:01.076327 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:10:01.076780 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:10:01.077200 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:10:01.265039 [debug] [Thread-2 (]: SQL status: OK in 0.187 seconds
[0m17:10:01.268394 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:10:01.268928 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:10:01.404918 [debug] [Thread-2 (]: SQL status: OK in 0.135 seconds
[0m17:10:01.408010 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:10:01.408722 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c3f4e41-0f11-49a0-917d-f92dd5d6b2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E7EA4260>]}
[0m17:10:01.409403 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.56s]
[0m17:10:01.410375 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:10:01.411391 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:10:01.412654 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:10:01.414704 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:10:01.419983 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:10:01.424948 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:10:01.425999 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:10:01.430999 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:10:01.432062 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:10:01.432507 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:10:01.432892 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:10:01.434625 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:10:01.435196 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:10:01.435610 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 'TRUE'
            else 'FALSE'
        end) as changed
from prev_regime
),

regime_row_num as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from changed
)

select *
from regime_row_num
  );

[0m17:10:01.508457 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 'TRUE'
            else 'FALSE'
        end) as changed
from prev_regime
),

regime_row_num as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from changed
)

select *
from regime_row_num
  );

[0m17:10:01.509063 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:10:01.509665 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: ROLLBACK
[0m17:10:01.518867 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.int__regime_changes'
[0m17:10:01.519331 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:10:01.524479 [debug] [Thread-3 (]: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Catalog Error: Table with name changed does not exist!
  Did you mean "pg_namespace"?
  
  LINE 44:     from changed
                    ^
[0m17:10:01.524988 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c3f4e41-0f11-49a0-917d-f92dd5d6b2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E939E170>]}
[0m17:10:01.525592 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model analytics_dev.int__regime_changes ......... [[31mERROR[0m in 0.11s]
[0m17:10:01.526375 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:10:01.526979 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_changes' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Catalog Error: Table with name changed does not exist!
  Did you mean "pg_namespace"?
  
  LINE 44:     from changed
                    ^.
[0m17:10:01.528812 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:01.529235 [debug] [MainThread]: On master: BEGIN
[0m17:10:01.529720 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:01.530980 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:10:01.531409 [debug] [MainThread]: On master: COMMIT
[0m17:10:01.531746 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:01.532051 [debug] [MainThread]: On master: COMMIT
[0m17:10:01.532869 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:01.533289 [debug] [MainThread]: On master: Close
[0m17:10:01.533771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:01.534068 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:10:01.534349 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:10:01.534615 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:10:01.535006 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:10:01.535499 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:10:01.535818 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:10:01.536230 [info ] [MainThread]: 
[0m17:10:01.536750 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m17:10:01.538076 [debug] [MainThread]: Command end result
[0m17:10:01.591501 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:10:01.594216 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:10:01.600648 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:10:01.601017 [info ] [MainThread]: 
[0m17:10:01.601530 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:10:01.601991 [info ] [MainThread]: 
[0m17:10:01.602524 [error] [MainThread]: [31mFailure in model int__regime_changes (models\silver\int\int__regime_changes.sql)[0m
[0m17:10:01.603035 [error] [MainThread]:   Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Catalog Error: Table with name changed does not exist!
  Did you mean "pg_namespace"?
  
  LINE 44:     from changed
                    ^
[0m17:10:01.603510 [info ] [MainThread]: 
[0m17:10:01.603999 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_changes.sql
[0m17:10:01.604422 [info ] [MainThread]: 
[0m17:10:01.604885 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m17:10:01.605749 [debug] [MainThread]: Command `-c run` failed at 17:10:01.605634 after 4.53 seconds
[0m17:10:01.606143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E73BF9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E53EFDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E600FB60>]}
[0m17:10:01.606518 [debug] [MainThread]: Flushing usage events
[0m17:10:02.396621 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:17.163203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FD158050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FD9642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FDFA3ED0>]}


============================== 17:10:17.167483 | 2e986aec-5758-4c8b-a802-4ae731526f2d ==============================
[0m17:10:17.167483 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:10:17.168190 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt run --select +int__regime_changes', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:10:17.456968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e986aec-5758-4c8b-a802-4ae731526f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FD310180>]}
[0m17:10:17.527425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e986aec-5758-4c8b-a802-4ae731526f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FDE4B790>]}
[0m17:10:17.530198 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:10:17.792191 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:10:18.189623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:10:18.190288 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:10:18.578406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e986aec-5758-4c8b-a802-4ae731526f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FF811B50>]}
[0m17:10:18.713037 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:10:18.715491 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:10:18.746430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e986aec-5758-4c8b-a802-4ae731526f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FF2B0B90>]}
[0m17:10:18.746922 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:10:18.747446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e986aec-5758-4c8b-a802-4ae731526f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FDE63770>]}
[0m17:10:18.749504 [info ] [MainThread]: 
[0m17:10:18.750008 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:10:18.750473 [info ] [MainThread]: 
[0m17:10:18.751095 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:10:18.756025 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:10:18.834359 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:10:18.834757 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:10:18.835067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:20.370233 [debug] [ThreadPool]: SQL status: OK in 1.535 seconds
[0m17:10:20.371887 [debug] [ThreadPool]: On list_finance: Close
[0m17:10:20.372694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:10:20.373242 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:10:20.379762 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:10:20.380127 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:10:20.380425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:20.382203 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:10:20.383556 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:10:20.383872 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:10:20.384913 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:10:20.385216 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:10:20.385559 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:10:20.439128 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m17:10:20.441993 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:10:20.443160 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:10:20.444176 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:10:20.495565 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m17:10:20.495994 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:10:20.498452 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:10:20.504873 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:10:20.505426 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:10:20.505780 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:10:20.508521 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:10:20.509025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:20.509405 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:10:20.510017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:20.510781 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:10:20.511265 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:10:20.511581 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:10:20.512155 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:10:20.512477 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:10:20.512798 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:10:20.539661 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m17:10:20.540113 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m17:10:20.541567 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:10:20.542855 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:10:20.544416 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:10:20.544943 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:10:20.545542 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:10:20.545844 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:10:20.548335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e986aec-5758-4c8b-a802-4ae731526f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FF50B860>]}
[0m17:10:20.548963 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:20.549280 [debug] [MainThread]: On master: BEGIN
[0m17:10:20.549619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:20.551150 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:10:20.551493 [debug] [MainThread]: On master: COMMIT
[0m17:10:20.551787 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:20.552077 [debug] [MainThread]: On master: COMMIT
[0m17:10:20.552740 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:20.553054 [debug] [MainThread]: On master: Close
[0m17:10:20.557740 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:10:20.558272 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:10:20.559032 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:10:20.559420 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:10:20.567581 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:10:20.568545 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:10:20.601795 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:10:20.602755 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:10:20.603132 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:10:20.603468 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:10:20.604744 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:10:20.605100 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:10:20.605449 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:10:20.784043 [debug] [Thread-1 (]: SQL status: OK in 0.178 seconds
[0m17:10:20.790160 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:10:20.790581 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:10:20.845460 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m17:10:20.848804 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:10:20.849213 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:10:20.911253 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m17:10:20.922942 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:10:20.923361 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:10:20.923737 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:10:21.031004 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m17:10:21.037893 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:10:21.039007 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:10:21.172408 [debug] [Thread-1 (]: SQL status: OK in 0.132 seconds
[0m17:10:21.179917 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:10:21.185282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e986aec-5758-4c8b-a802-4ae731526f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FFC60F50>]}
[0m17:10:21.186845 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.62s]
[0m17:10:21.188368 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:10:21.189773 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:10:21.190817 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:10:21.192119 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:10:21.192731 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:10:21.197419 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:10:21.198728 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:10:21.203352 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:10:21.204490 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:10:21.205019 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:10:21.205610 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:10:21.207623 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:10:21.208082 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:10:21.208510 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" <= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:10:21.305184 [debug] [Thread-2 (]: SQL status: OK in 0.096 seconds
[0m17:10:21.308214 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:10:21.308633 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:10:21.371626 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m17:10:21.375279 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:10:21.375732 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:10:21.440577 [debug] [Thread-2 (]: SQL status: OK in 0.064 seconds
[0m17:10:21.442087 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:10:21.442553 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:10:21.442919 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:10:21.738959 [debug] [Thread-2 (]: SQL status: OK in 0.295 seconds
[0m17:10:21.741812 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:10:21.742303 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:10:21.842891 [debug] [Thread-2 (]: SQL status: OK in 0.100 seconds
[0m17:10:21.845541 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:10:21.846521 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e986aec-5758-4c8b-a802-4ae731526f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FFD30260>]}
[0m17:10:21.847577 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.65s]
[0m17:10:21.848447 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:10:21.849226 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:10:21.849701 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:10:21.850401 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:10:21.850776 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:10:21.853445 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:10:21.854304 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:10:21.857497 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:10:21.858394 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:10:21.858829 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:10:21.859198 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:10:21.860436 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:10:21.860836 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:10:21.861247 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 'TRUE'
            else 'FALSE'
        end) as changed
from prev_regime
),

regime_row_num as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
)

select *
from regime_row_num
  );

[0m17:10:21.948835 [debug] [Thread-3 (]: SQL status: OK in 0.087 seconds
[0m17:10:21.952900 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:10:21.953360 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m17:10:22.018799 [debug] [Thread-3 (]: SQL status: OK in 0.065 seconds
[0m17:10:22.020113 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:10:22.020497 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:10:22.020844 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:10:22.140709 [debug] [Thread-3 (]: SQL status: OK in 0.119 seconds
[0m17:10:22.147280 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:10:22.147901 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m17:10:22.202836 [debug] [Thread-3 (]: SQL status: OK in 0.054 seconds
[0m17:10:22.204287 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:10:22.204784 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e986aec-5758-4c8b-a802-4ae731526f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FF84A8F0>]}
[0m17:10:22.205360 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.35s]
[0m17:10:22.206241 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:10:22.207631 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:22.208008 [debug] [MainThread]: On master: BEGIN
[0m17:10:22.208302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:22.209668 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:10:22.209990 [debug] [MainThread]: On master: COMMIT
[0m17:10:22.210415 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:22.210705 [debug] [MainThread]: On master: COMMIT
[0m17:10:22.211368 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:22.211868 [debug] [MainThread]: On master: Close
[0m17:10:22.212271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:22.212549 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:10:22.212962 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:10:22.213329 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:10:22.213797 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:10:22.214087 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:10:22.214365 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:10:22.214783 [info ] [MainThread]: 
[0m17:10:22.215384 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m17:10:22.216650 [debug] [MainThread]: Command end result
[0m17:10:22.271405 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:10:22.273987 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:10:22.280771 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:10:22.281171 [info ] [MainThread]: 
[0m17:10:22.281781 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:22.282289 [info ] [MainThread]: 
[0m17:10:22.282798 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:10:22.283721 [debug] [MainThread]: Command `-c run` succeeded at 17:10:22.283600 after 5.26 seconds
[0m17:10:22.284090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FF13C450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FF26F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FDEABB60>]}
[0m17:10:22.284458 [debug] [MainThread]: Flushing usage events
[0m17:10:23.151529 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:35.090260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F29908050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2A1142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2A757ED0>]}


============================== 17:11:35.094850 | 90281d92-a1c9-4006-9094-a5c6cb5942b8 ==============================
[0m17:11:35.094850 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:11:35.095851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select +int__regime_changes', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:11:35.347005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90281d92-a1c9-4006-9094-a5c6cb5942b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F29AC0180>]}
[0m17:11:35.411237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90281d92-a1c9-4006-9094-a5c6cb5942b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2A5FB790>]}
[0m17:11:35.413750 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:11:35.673100 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:11:36.064820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:11:36.065720 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m17:11:36.421937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90281d92-a1c9-4006-9094-a5c6cb5942b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2BFA5E50>]}
[0m17:11:36.552607 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:11:36.555055 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:11:36.586195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90281d92-a1c9-4006-9094-a5c6cb5942b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2BA30B90>]}
[0m17:11:36.586672 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:11:36.587202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90281d92-a1c9-4006-9094-a5c6cb5942b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2A613770>]}
[0m17:11:36.589204 [info ] [MainThread]: 
[0m17:11:36.589701 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:11:36.590168 [info ] [MainThread]: 
[0m17:11:36.590803 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:11:36.595943 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:11:36.672511 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:11:36.672908 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:11:36.673225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:38.302771 [debug] [ThreadPool]: SQL status: OK in 1.629 seconds
[0m17:11:38.304124 [debug] [ThreadPool]: On list_finance: Close
[0m17:11:38.304804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:11:38.305269 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:11:38.311470 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:11:38.311826 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:11:38.312124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:38.313591 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:11:38.314857 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:11:38.315162 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:11:38.316158 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:11:38.316463 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:11:38.316754 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:11:38.388614 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m17:11:38.391243 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:11:38.392347 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:11:38.393289 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:11:38.454104 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m17:11:38.454571 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:11:38.456760 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:11:38.462537 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:11:38.462863 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:11:38.463147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:38.464108 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:11:38.466007 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:11:38.466323 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:11:38.466598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:38.467416 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:11:38.467776 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:11:38.468079 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:11:38.468513 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:11:38.468839 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:11:38.469152 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:11:38.492958 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m17:11:38.493351 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:11:38.494589 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:11:38.495958 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:11:38.497042 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:11:38.497340 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:11:38.497819 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:11:38.498130 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:11:38.500478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90281d92-a1c9-4006-9094-a5c6cb5942b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2BC8BBA0>]}
[0m17:11:38.500903 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:38.501191 [debug] [MainThread]: On master: BEGIN
[0m17:11:38.501466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:38.502679 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:11:38.503023 [debug] [MainThread]: On master: COMMIT
[0m17:11:38.503370 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:38.503654 [debug] [MainThread]: On master: COMMIT
[0m17:11:38.504230 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:38.504533 [debug] [MainThread]: On master: Close
[0m17:11:38.509172 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:11:38.509696 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:11:38.510369 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:11:38.510730 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:11:38.517555 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:11:38.518516 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:11:38.550345 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:11:38.551276 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:11:38.551640 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:11:38.551966 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:11:38.553357 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:38.553768 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:11:38.554145 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:11:38.671832 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m17:11:38.684889 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:11:38.685544 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:11:38.750010 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m17:11:38.754895 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:11:38.755274 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:11:38.814177 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m17:11:38.826925 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:11:38.827326 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:11:38.827659 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:11:38.955820 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m17:11:38.961055 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:11:38.961672 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:11:39.091662 [debug] [Thread-1 (]: SQL status: OK in 0.129 seconds
[0m17:11:39.094022 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:11:39.096258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90281d92-a1c9-4006-9094-a5c6cb5942b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2C3F1250>]}
[0m17:11:39.096955 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.58s]
[0m17:11:39.097870 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:11:39.098651 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:11:39.099187 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:11:39.099924 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:11:39.100291 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:11:39.102897 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:11:39.103717 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:11:39.107230 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:11:39.108233 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:11:39.108696 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:11:39.109026 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:11:39.110235 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:39.110581 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:11:39.110939 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:11:39.200640 [debug] [Thread-2 (]: SQL status: OK in 0.089 seconds
[0m17:11:39.203758 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:11:39.204154 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:11:39.256306 [debug] [Thread-2 (]: SQL status: OK in 0.052 seconds
[0m17:11:39.259692 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:11:39.260082 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:11:39.329958 [debug] [Thread-2 (]: SQL status: OK in 0.069 seconds
[0m17:11:39.331637 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:11:39.332146 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:11:39.332523 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:11:39.513824 [debug] [Thread-2 (]: SQL status: OK in 0.181 seconds
[0m17:11:39.517520 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:11:39.518217 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:11:39.641802 [debug] [Thread-2 (]: SQL status: OK in 0.123 seconds
[0m17:11:39.643840 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:11:39.644420 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90281d92-a1c9-4006-9094-a5c6cb5942b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2C4D4260>]}
[0m17:11:39.645027 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.54s]
[0m17:11:39.645856 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:11:39.646681 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:11:39.647309 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:11:39.647988 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:11:39.648372 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:11:39.651064 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:11:39.651947 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:11:39.655400 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:11:39.656366 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:11:39.656744 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:11:39.657084 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:11:39.658361 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:39.658754 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:11:39.659157 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 'TRUE'
            else 'FALSE'
        end) as changed
from prev_regime
),

regime_row_num as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
)

select *
from regime_row_num
  );

[0m17:11:39.781028 [debug] [Thread-3 (]: SQL status: OK in 0.121 seconds
[0m17:11:39.787994 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:11:39.788479 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m17:11:39.873882 [debug] [Thread-3 (]: SQL status: OK in 0.085 seconds
[0m17:11:39.879917 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:11:39.880353 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m17:11:39.957592 [debug] [Thread-3 (]: SQL status: OK in 0.077 seconds
[0m17:11:39.958958 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:11:39.959349 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:11:39.959699 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:11:40.097198 [debug] [Thread-3 (]: SQL status: OK in 0.137 seconds
[0m17:11:40.100429 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:11:40.100846 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m17:11:40.229786 [debug] [Thread-3 (]: SQL status: OK in 0.128 seconds
[0m17:11:40.231271 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:11:40.231916 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90281d92-a1c9-4006-9094-a5c6cb5942b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2C4E3250>]}
[0m17:11:40.232641 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.58s]
[0m17:11:40.233718 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:11:40.235554 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:40.236096 [debug] [MainThread]: On master: BEGIN
[0m17:11:40.236474 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:40.238345 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:11:40.238742 [debug] [MainThread]: On master: COMMIT
[0m17:11:40.239100 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:40.239391 [debug] [MainThread]: On master: COMMIT
[0m17:11:40.240009 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:40.240323 [debug] [MainThread]: On master: Close
[0m17:11:40.240726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:40.241008 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:11:40.241273 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:11:40.241536 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:11:40.241796 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:11:40.242056 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:11:40.242415 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:11:40.242777 [info ] [MainThread]: 
[0m17:11:40.243303 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m17:11:40.244543 [debug] [MainThread]: Command end result
[0m17:11:40.294704 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:11:40.297579 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:11:40.304301 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:11:40.304759 [info ] [MainThread]: 
[0m17:11:40.305518 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:40.306162 [info ] [MainThread]: 
[0m17:11:40.306716 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:11:40.307746 [debug] [MainThread]: Command `-c run` succeeded at 17:11:40.307601 after 5.38 seconds
[0m17:11:40.308168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2B8BC450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2B9F39D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2A65FB60>]}
[0m17:11:40.308571 [debug] [MainThread]: Flushing usage events
[0m17:11:41.028358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:17:18.337808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2AB848050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2AC0542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2AC693ED0>]}


============================== 17:17:18.342207 | caa13489-119e-46f3-9db8-b7562ed6b9ce ==============================
[0m17:17:18.342207 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:17:18.342892 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt run --select +int__regime_changes', 'no_print': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m17:17:18.590423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caa13489-119e-46f3-9db8-b7562ed6b9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2ABA00180>]}
[0m17:17:18.655355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caa13489-119e-46f3-9db8-b7562ed6b9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2AC53B790>]}
[0m17:17:18.658005 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:17:18.917886 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:17:19.306639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:19.307337 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:17:19.652766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caa13489-119e-46f3-9db8-b7562ed6b9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2ADFB5E50>]}
[0m17:17:19.780185 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:17:19.782632 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:17:19.808341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caa13489-119e-46f3-9db8-b7562ed6b9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2ADA10B90>]}
[0m17:17:19.808801 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:17:19.809265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caa13489-119e-46f3-9db8-b7562ed6b9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2AC553770>]}
[0m17:17:19.811232 [info ] [MainThread]: 
[0m17:17:19.811671 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:17:19.812080 [info ] [MainThread]: 
[0m17:17:19.812636 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:17:19.817531 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:17:19.896079 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:17:19.896480 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:17:19.896797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:21.712161 [debug] [ThreadPool]: SQL status: OK in 1.815 seconds
[0m17:17:21.713706 [debug] [ThreadPool]: On list_finance: Close
[0m17:17:21.714495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:17:21.715034 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:17:21.721449 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:17:21.721799 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:17:21.722206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:21.724128 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:17:21.725447 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:17:21.725751 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:17:21.726737 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:17:21.727042 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:17:21.727334 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:17:21.780472 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m17:17:21.781975 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:17:21.782483 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:17:21.782961 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:17:21.835291 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m17:17:21.835699 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:17:21.837590 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:17:21.842965 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:17:21.843302 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:17:21.843584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:21.844589 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:17:21.846642 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:17:21.846967 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:17:21.847248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:21.847931 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:17:21.848239 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:17:21.848538 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:17:21.849002 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:17:21.849324 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:17:21.849637 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:17:21.873288 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:17:21.873692 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:17:21.875165 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:17:21.876777 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:17:21.878315 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:17:21.878632 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:17:21.879119 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:17:21.879431 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:17:21.882048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caa13489-119e-46f3-9db8-b7562ed6b9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2ADC6BBA0>]}
[0m17:17:21.882523 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:21.882836 [debug] [MainThread]: On master: BEGIN
[0m17:17:21.883131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:21.884411 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:17:21.884736 [debug] [MainThread]: On master: COMMIT
[0m17:17:21.885039 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:21.885357 [debug] [MainThread]: On master: COMMIT
[0m17:17:21.886025 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:17:21.886334 [debug] [MainThread]: On master: Close
[0m17:17:21.891438 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:17:21.892015 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:17:21.892944 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:17:21.893342 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:17:21.900531 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:17:21.901473 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:17:21.932921 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:17:21.933917 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:17:21.934352 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:17:21.934683 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:17:21.936013 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:21.936368 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:17:21.936714 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:17:21.999992 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m17:17:22.005940 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:17:22.006329 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:17:22.066042 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m17:17:22.072555 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:17:22.073363 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:17:22.138207 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m17:17:22.149252 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:17:22.149668 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:17:22.150013 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:17:22.284273 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m17:17:22.290221 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:17:22.290977 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:17:22.419791 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m17:17:22.425087 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:17:22.428778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa13489-119e-46f3-9db8-b7562ed6b9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2AE3D1250>]}
[0m17:17:22.429910 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.53s]
[0m17:17:22.431148 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:17:22.432373 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:17:22.433133 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:17:22.434185 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:17:22.434840 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:17:22.438418 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:17:22.439372 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:17:22.443847 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:17:22.444989 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:17:22.445415 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:17:22.445768 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:17:22.447089 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:17:22.447500 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:17:22.447921 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:17:22.528809 [debug] [Thread-2 (]: SQL status: OK in 0.080 seconds
[0m17:17:22.532239 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:17:22.532739 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:17:22.591424 [debug] [Thread-2 (]: SQL status: OK in 0.058 seconds
[0m17:17:22.604636 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:17:22.606085 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:17:22.667990 [debug] [Thread-2 (]: SQL status: OK in 0.061 seconds
[0m17:17:22.669887 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:17:22.670459 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:17:22.670963 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:17:22.862248 [debug] [Thread-2 (]: SQL status: OK in 0.191 seconds
[0m17:17:22.865480 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:17:22.866073 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:17:22.978026 [debug] [Thread-2 (]: SQL status: OK in 0.111 seconds
[0m17:17:22.979667 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:17:22.980196 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa13489-119e-46f3-9db8-b7562ed6b9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2AE4A0260>]}
[0m17:17:22.980778 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.55s]
[0m17:17:22.981823 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:17:22.983010 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:17:22.984066 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:17:22.985031 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:17:22.985444 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:17:22.988219 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:17:22.989141 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:17:22.993643 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:17:22.995048 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:17:22.995489 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:17:22.995860 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:17:22.997545 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:17:22.998497 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:17:22.999055 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 'TRUE'
            else 'FALSE'
        end) as changed
from prev_regime
),

regime_row_num as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
)

select *
from regime_row_num
order by trade_date asc, loaded_at asc
  );

[0m17:17:23.245863 [debug] [Thread-3 (]: SQL status: OK in 0.246 seconds
[0m17:17:23.249919 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:17:23.250411 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m17:17:23.348867 [debug] [Thread-3 (]: SQL status: OK in 0.098 seconds
[0m17:17:23.355082 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:17:23.355523 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m17:17:23.435719 [debug] [Thread-3 (]: SQL status: OK in 0.080 seconds
[0m17:17:23.437637 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:17:23.438136 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:17:23.438563 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:17:23.690206 [debug] [Thread-3 (]: SQL status: OK in 0.251 seconds
[0m17:17:23.692817 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:17:23.693223 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m17:17:23.837537 [debug] [Thread-3 (]: SQL status: OK in 0.144 seconds
[0m17:17:23.839196 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:17:23.839771 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa13489-119e-46f3-9db8-b7562ed6b9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2AE4D7250>]}
[0m17:17:23.840375 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.85s]
[0m17:17:23.841185 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:17:23.842709 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:23.843045 [debug] [MainThread]: On master: BEGIN
[0m17:17:23.843345 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:23.844617 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:17:23.845190 [debug] [MainThread]: On master: COMMIT
[0m17:17:23.845753 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:23.846309 [debug] [MainThread]: On master: COMMIT
[0m17:17:23.847358 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:17:23.848081 [debug] [MainThread]: On master: Close
[0m17:17:23.849076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:23.849744 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:17:23.850297 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:17:23.850816 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:17:23.851335 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:17:23.851852 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:17:23.852373 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:17:23.853009 [info ] [MainThread]: 
[0m17:17:23.853916 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.04 seconds (4.04s).
[0m17:17:23.855380 [debug] [MainThread]: Command end result
[0m17:17:23.904187 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:17:23.906647 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:17:23.912701 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:17:23.913105 [info ] [MainThread]: 
[0m17:17:23.913695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:23.914423 [info ] [MainThread]: 
[0m17:17:23.915386 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:17:23.916878 [debug] [MainThread]: Command `-c run` succeeded at 17:17:23.916694 after 5.75 seconds
[0m17:17:23.917383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2AD89C450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2AD9CF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2AC59BB60>]}
[0m17:17:23.917884 [debug] [MainThread]: Flushing usage events
[0m17:17:24.883532 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:35.683142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F5238050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F5A442D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F6087ED0>]}


============================== 17:24:35.687690 | b0ad5c95-6626-4d66-b876-95a7c62a49f1 ==============================
[0m17:24:35.687690 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:24:35.688427 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +int__regime_changes', 'printer_width': '80', 'target_path': 'None'}
[0m17:24:35.936856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0ad5c95-6626-4d66-b876-95a7c62a49f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F53F0180>]}
[0m17:24:36.001969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0ad5c95-6626-4d66-b876-95a7c62a49f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F5F2B790>]}
[0m17:24:36.004489 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:24:36.262276 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:24:36.665075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:24:36.665749 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:24:37.016107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0ad5c95-6626-4d66-b876-95a7c62a49f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F7941B50>]}
[0m17:24:37.147180 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:24:37.149639 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:24:37.179099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0ad5c95-6626-4d66-b876-95a7c62a49f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F7390B90>]}
[0m17:24:37.179567 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:24:37.180101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0ad5c95-6626-4d66-b876-95a7c62a49f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F5F43770>]}
[0m17:24:37.182198 [info ] [MainThread]: 
[0m17:24:37.182740 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:24:37.183227 [info ] [MainThread]: 
[0m17:24:37.183863 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:24:37.188826 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:24:37.264448 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:24:37.264833 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:24:37.265141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:38.682915 [debug] [ThreadPool]: SQL status: OK in 1.418 seconds
[0m17:24:38.684429 [debug] [ThreadPool]: On list_finance: Close
[0m17:24:38.685129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:24:38.685629 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:24:38.691778 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:24:38.692115 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:24:38.692416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:38.693913 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:24:38.695184 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:24:38.695492 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:24:38.696367 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:24:38.696675 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:24:38.696977 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:24:38.753817 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m17:24:38.755161 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:24:38.755654 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:24:38.756079 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:24:38.799715 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m17:24:38.800896 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:24:38.805382 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:24:38.814682 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:24:38.815768 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:24:38.817693 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:24:38.818151 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:24:38.818524 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:24:38.818882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:38.819243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:38.820305 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:24:38.820609 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:24:38.820911 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:24:38.821383 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:24:38.821705 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:24:38.822013 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:24:38.846008 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m17:24:38.846398 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:24:38.847653 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:24:38.848953 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:24:38.850060 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:24:38.850364 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:24:38.850825 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:24:38.851236 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:24:38.853554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0ad5c95-6626-4d66-b876-95a7c62a49f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F7673860>]}
[0m17:24:38.854000 [debug] [MainThread]: Using duckdb connection "master"
[0m17:24:38.854308 [debug] [MainThread]: On master: BEGIN
[0m17:24:38.854601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:38.855712 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:24:38.856017 [debug] [MainThread]: On master: COMMIT
[0m17:24:38.856310 [debug] [MainThread]: Using duckdb connection "master"
[0m17:24:38.856588 [debug] [MainThread]: On master: COMMIT
[0m17:24:38.857139 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:24:38.857442 [debug] [MainThread]: On master: Close
[0m17:24:38.862145 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:24:38.862666 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:24:38.863353 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:24:38.863712 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:24:38.870397 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:24:38.871355 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:24:38.903184 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:24:38.904201 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:24:38.904701 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:24:38.905037 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:24:38.906527 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:24:38.906894 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:24:38.907238 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:24:38.955782 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m17:24:38.961697 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:24:38.962076 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:24:39.029952 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m17:24:39.037785 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:24:39.038782 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:24:39.110760 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m17:24:39.122067 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:24:39.122527 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:24:39.122877 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:24:39.258594 [debug] [Thread-1 (]: SQL status: OK in 0.135 seconds
[0m17:24:39.274662 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:24:39.275592 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:24:39.401438 [debug] [Thread-1 (]: SQL status: OK in 0.125 seconds
[0m17:24:39.404599 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:24:39.407011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0ad5c95-6626-4d66-b876-95a7c62a49f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F7D51250>]}
[0m17:24:39.407678 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.54s]
[0m17:24:39.408605 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:24:39.409430 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:24:39.409940 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:24:39.410799 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:24:39.411167 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:24:39.413751 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:24:39.414623 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:24:39.418142 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:24:39.419176 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:24:39.419576 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:24:39.419916 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:24:39.421237 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:24:39.421596 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:24:39.422003 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:24:39.529782 [debug] [Thread-2 (]: SQL status: OK in 0.107 seconds
[0m17:24:39.535958 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:24:39.536782 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:24:39.612973 [debug] [Thread-2 (]: SQL status: OK in 0.075 seconds
[0m17:24:39.625679 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:24:39.626861 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:24:39.687407 [debug] [Thread-2 (]: SQL status: OK in 0.059 seconds
[0m17:24:39.688759 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:24:39.689142 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:24:39.689481 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:24:39.885126 [debug] [Thread-2 (]: SQL status: OK in 0.195 seconds
[0m17:24:39.888832 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:24:39.889205 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:24:40.004079 [debug] [Thread-2 (]: SQL status: OK in 0.114 seconds
[0m17:24:40.005951 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:24:40.006574 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0ad5c95-6626-4d66-b876-95a7c62a49f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F7E34260>]}
[0m17:24:40.007153 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.60s]
[0m17:24:40.007952 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:24:40.008680 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:24:40.009156 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:24:40.009844 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:24:40.010214 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:24:40.012905 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:24:40.013746 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:24:40.017108 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:24:40.018330 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:24:40.018860 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:24:40.019203 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:24:40.020704 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:24:40.021324 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:24:40.021767 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed, 
        (case when regime != prev_regime or prev_regime is null then trade_date end) as end_date, 
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(partition by regime, changed order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)
'''
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
'''


select *
from regime_row_num
order by trade_date asc, loaded_at asc
  );

[0m17:24:40.028343 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed, 
        (case when regime != prev_regime or prev_regime is null then trade_date end) as end_date, 
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(partition by regime, changed order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)
'''
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
'''


select *
from regime_row_num
order by trade_date asc, loaded_at asc
  );

[0m17:24:40.028789 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:24:40.029230 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: ROLLBACK
[0m17:24:40.036315 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.int__regime_changes'
[0m17:24:40.036778 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:24:40.041440 [debug] [Thread-3 (]: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Parser Error: syntax error at or near "'''
      select
          trade_date, 
          regime, 
          loaded_at, 
          prev_regime,
          changed,
          row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
      from regime_changes
  '''"
  
  LINE 47: '''
           ^
[0m17:24:40.041971 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0ad5c95-6626-4d66-b876-95a7c62a49f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F931E0D0>]}
[0m17:24:40.042566 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model analytics_dev.int__regime_changes ......... [[31mERROR[0m in 0.03s]
[0m17:24:40.043389 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:24:40.044027 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_changes' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Parser Error: syntax error at or near "'''
      select
          trade_date, 
          regime, 
          loaded_at, 
          prev_regime,
          changed,
          row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
      from regime_changes
  '''"
  
  LINE 47: '''
           ^.
[0m17:24:40.046187 [debug] [MainThread]: Using duckdb connection "master"
[0m17:24:40.046517 [debug] [MainThread]: On master: BEGIN
[0m17:24:40.046798 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:24:40.047943 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:24:40.048248 [debug] [MainThread]: On master: COMMIT
[0m17:24:40.048539 [debug] [MainThread]: Using duckdb connection "master"
[0m17:24:40.048818 [debug] [MainThread]: On master: COMMIT
[0m17:24:40.049505 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:24:40.049813 [debug] [MainThread]: On master: Close
[0m17:24:40.050190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:40.050531 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:24:40.050814 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:24:40.051096 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:24:40.051385 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:24:40.051665 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:24:40.051936 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:24:40.052300 [info ] [MainThread]: 
[0m17:24:40.052816 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m17:24:40.054054 [debug] [MainThread]: Command end result
[0m17:24:40.101468 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:24:40.104026 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:24:40.109864 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:24:40.110185 [info ] [MainThread]: 
[0m17:24:40.110710 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:24:40.111199 [info ] [MainThread]: 
[0m17:24:40.111786 [error] [MainThread]: [31mFailure in model int__regime_changes (models\silver\int\int__regime_changes.sql)[0m
[0m17:24:40.112352 [error] [MainThread]:   Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Parser Error: syntax error at or near "'''
      select
          trade_date, 
          regime, 
          loaded_at, 
          prev_regime,
          changed,
          row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
      from regime_changes
  '''"
  
  LINE 47: '''
           ^
[0m17:24:40.112971 [info ] [MainThread]: 
[0m17:24:40.113507 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_changes.sql
[0m17:24:40.113996 [info ] [MainThread]: 
[0m17:24:40.114499 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m17:24:40.115404 [debug] [MainThread]: Command `-c run` failed at 17:24:40.115286 after 4.56 seconds
[0m17:24:40.115806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F73534D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F536FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F5F8FB60>]}
[0m17:24:40.116190 [debug] [MainThread]: Flushing usage events
[0m17:24:40.833548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:04.452578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E44248050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E44A542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E45093ED0>]}


============================== 17:25:04.457081 | 5d4e1cd1-dd40-4cf0-8152-8a750914d409 ==============================
[0m17:25:04.457081 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:25:04.457765 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select +int__regime_changes', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m17:25:04.707753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d4e1cd1-dd40-4cf0-8152-8a750914d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E44400180>]}
[0m17:25:04.772914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d4e1cd1-dd40-4cf0-8152-8a750914d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E44F3B790>]}
[0m17:25:04.775390 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:25:05.034775 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:25:05.480142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:25:05.480802 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:25:05.856007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d4e1cd1-dd40-4cf0-8152-8a750914d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E46991B50>]}
[0m17:25:05.992744 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:25:05.995208 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:25:06.025880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d4e1cd1-dd40-4cf0-8152-8a750914d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E46430B90>]}
[0m17:25:06.026343 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:25:06.026879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d4e1cd1-dd40-4cf0-8152-8a750914d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E44F53770>]}
[0m17:25:06.028870 [info ] [MainThread]: 
[0m17:25:06.029356 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:25:06.029820 [info ] [MainThread]: 
[0m17:25:06.030453 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:25:06.035813 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:25:06.111577 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:25:06.111976 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:25:06.112289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:07.680338 [debug] [ThreadPool]: SQL status: OK in 1.568 seconds
[0m17:25:07.681690 [debug] [ThreadPool]: On list_finance: Close
[0m17:25:07.682365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:25:07.682828 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:25:07.689126 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:07.689473 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:25:07.689769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:07.691242 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:25:07.692477 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:07.692773 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:25:07.693622 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:25:07.693916 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:07.694209 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:25:07.753559 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m17:25:07.755441 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:25:07.756189 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:07.756839 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:25:07.803827 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m17:25:07.804288 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:25:07.806307 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:25:07.811989 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:25:07.812510 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:25:07.812826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:07.813454 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:25:07.815778 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:25:07.816104 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:25:07.816384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:07.817144 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:25:07.817653 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:25:07.817962 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:25:07.818296 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:25:07.818835 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:25:07.819157 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:25:07.843233 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m17:25:07.843681 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:25:07.844879 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:25:07.846207 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:25:07.847528 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:25:07.847835 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:25:07.848321 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:25:07.848630 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:25:07.850761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d4e1cd1-dd40-4cf0-8152-8a750914d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E4668BE10>]}
[0m17:25:07.851189 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:07.851484 [debug] [MainThread]: On master: BEGIN
[0m17:25:07.851759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:07.852868 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:25:07.853171 [debug] [MainThread]: On master: COMMIT
[0m17:25:07.853466 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:07.853741 [debug] [MainThread]: On master: COMMIT
[0m17:25:07.854282 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:25:07.854587 [debug] [MainThread]: On master: Close
[0m17:25:07.859804 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:25:07.860338 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:25:07.861033 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:25:07.861390 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:25:07.868098 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:25:07.868929 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:25:07.898862 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:25:07.899775 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:25:07.900137 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:25:07.900471 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:25:07.902205 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:25:07.902727 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:25:07.903083 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:25:07.976121 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m17:25:07.994285 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:25:07.995039 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:25:08.059257 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m17:25:08.066180 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:25:08.067029 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:25:08.141240 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m17:25:08.154384 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:25:08.154797 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:25:08.155133 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:25:08.279907 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m17:25:08.296243 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:25:08.297511 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:25:08.435964 [debug] [Thread-1 (]: SQL status: OK in 0.138 seconds
[0m17:25:08.438412 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:25:08.440451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d4e1cd1-dd40-4cf0-8152-8a750914d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E46DF1250>]}
[0m17:25:08.441084 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.58s]
[0m17:25:08.441897 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:25:08.442641 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:25:08.443113 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:25:08.443905 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:25:08.444276 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:25:08.447589 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:25:08.448472 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:25:08.451690 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:25:08.452600 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:25:08.452995 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:25:08.453342 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:25:08.454509 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:25:08.454883 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:25:08.455271 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:25:08.551448 [debug] [Thread-2 (]: SQL status: OK in 0.095 seconds
[0m17:25:08.558685 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:25:08.559705 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:25:08.636623 [debug] [Thread-2 (]: SQL status: OK in 0.076 seconds
[0m17:25:08.639871 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:25:08.640249 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:25:08.706642 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m17:25:08.709069 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:25:08.709771 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:25:08.710404 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:25:08.897926 [debug] [Thread-2 (]: SQL status: OK in 0.187 seconds
[0m17:25:08.900268 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:25:08.900776 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:25:09.014458 [debug] [Thread-2 (]: SQL status: OK in 0.113 seconds
[0m17:25:09.016089 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:25:09.016598 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d4e1cd1-dd40-4cf0-8152-8a750914d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E46E84260>]}
[0m17:25:09.017164 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.57s]
[0m17:25:09.018236 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:25:09.019331 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:25:09.019951 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:25:09.020672 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:25:09.021049 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:25:09.023735 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:25:09.024569 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:25:09.027984 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:25:09.028844 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:25:09.029211 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:25:09.029543 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:25:09.030751 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:25:09.031111 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:25:09.031499 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed, 
        (case when regime != prev_regime or prev_regime is null then trade_date end) as end_date, 
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(partition by regime, changed order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

'''
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
'''


select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:25:09.039973 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed, 
        (case when regime != prev_regime or prev_regime is null then trade_date end) as end_date, 
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(partition by regime, changed order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

'''
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
'''


select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:25:09.040537 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:25:09.041000 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: ROLLBACK
[0m17:25:09.047523 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.int__regime_changes'
[0m17:25:09.047912 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:25:09.052555 [debug] [Thread-3 (]: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Parser Error: syntax error at or near "'''
      select
          trade_date, 
          regime, 
          loaded_at, 
          prev_regime,
          changed,
          row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
      from regime_changes
  '''"
  
  LINE 48: '''
           ^
[0m17:25:09.053078 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d4e1cd1-dd40-4cf0-8152-8a750914d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E4838E0D0>]}
[0m17:25:09.053675 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model analytics_dev.int__regime_changes ......... [[31mERROR[0m in 0.03s]
[0m17:25:09.054530 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:25:09.055155 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_changes' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Parser Error: syntax error at or near "'''
      select
          trade_date, 
          regime, 
          loaded_at, 
          prev_regime,
          changed,
          row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
      from regime_changes
  '''"
  
  LINE 48: '''
           ^.
[0m17:25:09.057170 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:09.057552 [debug] [MainThread]: On master: BEGIN
[0m17:25:09.057854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:25:09.059208 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:25:09.059569 [debug] [MainThread]: On master: COMMIT
[0m17:25:09.059893 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:09.060202 [debug] [MainThread]: On master: COMMIT
[0m17:25:09.060910 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:25:09.061283 [debug] [MainThread]: On master: Close
[0m17:25:09.061716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:09.062014 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:25:09.062301 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:25:09.062586 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:25:09.062935 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:25:09.063547 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:25:09.063820 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:25:09.064345 [info ] [MainThread]: 
[0m17:25:09.064965 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m17:25:09.066246 [debug] [MainThread]: Command end result
[0m17:25:09.115622 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:25:09.118050 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:25:09.124191 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:25:09.124546 [info ] [MainThread]: 
[0m17:25:09.125066 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:25:09.125575 [info ] [MainThread]: 
[0m17:25:09.126162 [error] [MainThread]: [31mFailure in model int__regime_changes (models\silver\int\int__regime_changes.sql)[0m
[0m17:25:09.126715 [error] [MainThread]:   Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Parser Error: syntax error at or near "'''
      select
          trade_date, 
          regime, 
          loaded_at, 
          prev_regime,
          changed,
          row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
      from regime_changes
  '''"
  
  LINE 48: '''
           ^
[0m17:25:09.127333 [info ] [MainThread]: 
[0m17:25:09.127880 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_changes.sql
[0m17:25:09.128367 [info ] [MainThread]: 
[0m17:25:09.128885 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m17:25:09.129802 [debug] [MainThread]: Command `-c run` failed at 17:25:09.129686 after 4.81 seconds
[0m17:25:09.130188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E463EF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E4437FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E44F9BB60>]}
[0m17:25:09.130558 [debug] [MainThread]: Flushing usage events
[0m17:25:10.003306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:20.773639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDB5F8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDBE042D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDC447ED0>]}


============================== 17:25:20.777946 | 21efa56f-49a1-4008-958f-b5c3c127472c ==============================
[0m17:25:20.777946 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:25:20.778675 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select +int__regime_changes', 'printer_width': '80', 'write_json': 'True'}
[0m17:25:21.033718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21efa56f-49a1-4008-958f-b5c3c127472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDB7B0180>]}
[0m17:25:21.101390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21efa56f-49a1-4008-958f-b5c3c127472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDC2EB790>]}
[0m17:25:21.103991 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:25:21.362019 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:25:21.748847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:25:21.749503 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:25:22.106712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21efa56f-49a1-4008-958f-b5c3c127472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDDCD1B50>]}
[0m17:25:22.237649 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:25:22.240116 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:25:22.269811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21efa56f-49a1-4008-958f-b5c3c127472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDD724B90>]}
[0m17:25:22.270317 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:25:22.270943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21efa56f-49a1-4008-958f-b5c3c127472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDC303770>]}
[0m17:25:22.273004 [info ] [MainThread]: 
[0m17:25:22.273502 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:25:22.273973 [info ] [MainThread]: 
[0m17:25:22.274603 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:25:22.279325 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:25:22.378186 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:25:22.378572 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:25:22.378879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:23.851129 [debug] [ThreadPool]: SQL status: OK in 1.472 seconds
[0m17:25:23.852486 [debug] [ThreadPool]: On list_finance: Close
[0m17:25:23.853159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:25:23.853620 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:25:23.859543 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:23.859868 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:25:23.860165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:23.861607 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:25:23.862833 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:23.863134 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:25:23.864099 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:25:23.864397 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:23.864686 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:25:23.923608 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m17:25:23.924872 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:25:23.925363 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:25:23.925833 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:25:23.980771 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m17:25:23.982321 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:25:23.989983 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:25:24.000429 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:25:24.000994 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:25:24.001370 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:25:24.003341 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:25:24.003695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:24.004091 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:25:24.004656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:24.005386 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:25:24.005768 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:25:24.006093 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:25:24.006723 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:25:24.007039 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:25:24.007344 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:25:24.031715 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:25:24.032184 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m17:25:24.033335 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:25:24.034613 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:25:24.035820 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:25:24.036119 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:25:24.036621 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:25:24.036909 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:25:24.039213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21efa56f-49a1-4008-958f-b5c3c127472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDD9CF930>]}
[0m17:25:24.039709 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:24.039995 [debug] [MainThread]: On master: BEGIN
[0m17:25:24.040267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:24.041617 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:25:24.041986 [debug] [MainThread]: On master: COMMIT
[0m17:25:24.042278 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:24.042555 [debug] [MainThread]: On master: COMMIT
[0m17:25:24.043145 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:25:24.043446 [debug] [MainThread]: On master: Close
[0m17:25:24.048405 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:25:24.048917 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:25:24.049754 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:25:24.050098 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:25:24.057301 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:25:24.058254 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:25:24.088614 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:25:24.089543 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:25:24.089905 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:25:24.090235 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:25:24.091639 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:25:24.091993 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:25:24.092335 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:25:24.263215 [debug] [Thread-1 (]: SQL status: OK in 0.170 seconds
[0m17:25:24.268985 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:25:24.269361 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:25:24.336071 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m17:25:24.341247 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:25:24.341607 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:25:24.411175 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m17:25:24.422013 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:25:24.422419 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:25:24.422755 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:25:24.546379 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m17:25:24.555243 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:25:24.556310 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:25:24.689153 [debug] [Thread-1 (]: SQL status: OK in 0.132 seconds
[0m17:25:24.691607 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:25:24.693625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21efa56f-49a1-4008-958f-b5c3c127472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDE0E1250>]}
[0m17:25:24.694250 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.64s]
[0m17:25:24.695076 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:25:24.695811 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:25:24.696291 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:25:24.696990 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:25:24.697382 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:25:24.700069 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:25:24.700962 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:25:24.704613 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:25:24.705616 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:25:24.705994 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:25:24.706337 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:25:24.707600 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:25:24.707982 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:25:24.708378 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:25:24.787287 [debug] [Thread-2 (]: SQL status: OK in 0.078 seconds
[0m17:25:24.791333 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:25:24.791884 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:25:24.852146 [debug] [Thread-2 (]: SQL status: OK in 0.060 seconds
[0m17:25:24.857018 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:25:24.857398 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:25:24.910503 [debug] [Thread-2 (]: SQL status: OK in 0.053 seconds
[0m17:25:24.912020 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:25:24.912446 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:25:24.912840 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:25:25.093864 [debug] [Thread-2 (]: SQL status: OK in 0.180 seconds
[0m17:25:25.096735 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:25:25.097103 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:25:25.212244 [debug] [Thread-2 (]: SQL status: OK in 0.115 seconds
[0m17:25:25.213796 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:25:25.214298 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21efa56f-49a1-4008-958f-b5c3c127472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDE1C4260>]}
[0m17:25:25.214844 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.52s]
[0m17:25:25.215697 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:25:25.216464 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:25:25.216973 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:25:25.217770 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:25:25.218116 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:25:25.221201 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:25:25.222334 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:25:25.226069 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:25:25.227239 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:25:25.227725 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:25:25.228137 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:25:25.229484 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:25:25.229919 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:25:25.230342 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed, 
        (case when regime != prev_regime or prev_regime is null then trade_date end) as end_date, 
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(partition by regime, changed order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

/*
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
*/


select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:25:25.308147 [debug] [Thread-3 (]: SQL status: OK in 0.077 seconds
[0m17:25:25.313461 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:25:25.314211 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m17:25:25.378693 [debug] [Thread-3 (]: SQL status: OK in 0.064 seconds
[0m17:25:25.384236 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:25:25.384645 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m17:25:25.456046 [debug] [Thread-3 (]: SQL status: OK in 0.071 seconds
[0m17:25:25.460649 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:25:25.462121 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:25:25.463482 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:25:25.593414 [debug] [Thread-3 (]: SQL status: OK in 0.129 seconds
[0m17:25:25.595793 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:25:25.596157 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m17:25:25.709138 [debug] [Thread-3 (]: SQL status: OK in 0.113 seconds
[0m17:25:25.710476 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:25:25.710967 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21efa56f-49a1-4008-958f-b5c3c127472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDE1D3110>]}
[0m17:25:25.711519 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.49s]
[0m17:25:25.712468 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:25:25.714167 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:25.714466 [debug] [MainThread]: On master: BEGIN
[0m17:25:25.714744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:25:25.715832 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:25:25.716326 [debug] [MainThread]: On master: COMMIT
[0m17:25:25.716671 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:25.716948 [debug] [MainThread]: On master: COMMIT
[0m17:25:25.717658 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:25:25.717959 [debug] [MainThread]: On master: Close
[0m17:25:25.718336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:25.718602 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:25:25.718856 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:25:25.719106 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:25:25.719354 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:25:25.719608 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:25:25.719860 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:25:25.720191 [info ] [MainThread]: 
[0m17:25:25.720702 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m17:25:25.722039 [debug] [MainThread]: Command end result
[0m17:25:25.774798 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:25:25.777178 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:25:25.783021 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:25:25.783352 [info ] [MainThread]: 
[0m17:25:25.783894 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:25.784314 [info ] [MainThread]: 
[0m17:25:25.784850 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:25:25.785766 [debug] [MainThread]: Command `-c run` succeeded at 17:25:25.785650 after 5.14 seconds
[0m17:25:25.786140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDD5AC450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDD6E0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDC34FB60>]}
[0m17:25:25.786540 [debug] [MainThread]: Flushing usage events
[0m17:25:26.422972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:33.845264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022689EB8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268A6C42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268AD03ED0>]}


============================== 17:29:33.849818 | 4c4aa79d-f301-402b-bf20-28746e3fdf89 ==============================
[0m17:29:33.849818 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:29:33.850538 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select +int__regime_changes', 'cache_selected_only': 'False', 'log_format': 'default', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m17:29:34.104795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c4aa79d-f301-402b-bf20-28746e3fdf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268A070180>]}
[0m17:29:34.172106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c4aa79d-f301-402b-bf20-28746e3fdf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268ABAB790>]}
[0m17:29:34.174741 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:29:34.472619 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:29:34.887872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:29:34.888598 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:29:35.255188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c4aa79d-f301-402b-bf20-28746e3fdf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268C58DB50>]}
[0m17:29:35.391414 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:29:35.393882 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:29:35.423309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c4aa79d-f301-402b-bf20-28746e3fdf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268BFE0B90>]}
[0m17:29:35.423793 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:29:35.424330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c4aa79d-f301-402b-bf20-28746e3fdf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268ABC3770>]}
[0m17:29:35.426495 [info ] [MainThread]: 
[0m17:29:35.426999 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:29:35.427484 [info ] [MainThread]: 
[0m17:29:35.428117 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:29:35.432856 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:29:35.509735 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:29:35.510132 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:29:35.510443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:36.869266 [debug] [ThreadPool]: SQL status: OK in 1.359 seconds
[0m17:29:36.870663 [debug] [ThreadPool]: On list_finance: Close
[0m17:29:36.871384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:29:36.871859 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:29:36.877998 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:29:36.878347 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:29:36.878712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:29:36.880298 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:29:36.881581 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:29:36.881887 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:29:36.882814 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:29:36.883130 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:29:36.883432 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:29:36.930324 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m17:29:36.931420 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:29:36.931826 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:29:36.932177 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:29:36.979310 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m17:29:36.980871 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:29:36.983723 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:29:36.989529 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:29:36.989877 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:29:36.990170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:36.990793 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:29:36.992849 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:29:36.993180 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:29:36.993462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:36.994114 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:29:36.994443 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:29:36.994769 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:29:36.995345 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:29:36.995670 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:29:36.995992 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:29:37.019948 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:29:37.020400 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m17:29:37.021665 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:29:37.022969 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:29:37.024344 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:29:37.024653 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:29:37.025211 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:29:37.025516 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:29:37.027721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c4aa79d-f301-402b-bf20-28746e3fdf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268C297860>]}
[0m17:29:37.028170 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:37.028482 [debug] [MainThread]: On master: BEGIN
[0m17:29:37.028778 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:29:37.029981 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:29:37.030312 [debug] [MainThread]: On master: COMMIT
[0m17:29:37.030634 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:37.030936 [debug] [MainThread]: On master: COMMIT
[0m17:29:37.031530 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:29:37.031854 [debug] [MainThread]: On master: Close
[0m17:29:37.036529 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:29:37.037068 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:29:37.037744 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:29:37.038105 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:29:37.045053 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:29:37.045895 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:29:37.078612 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:29:37.079717 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:29:37.080084 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:29:37.080415 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:29:37.082415 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:29:37.082803 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:29:37.083151 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:29:37.144042 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m17:29:37.149903 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:29:37.150272 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:29:37.221312 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m17:29:37.231497 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:29:37.232838 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:29:37.302833 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m17:29:37.319098 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:29:37.319629 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:29:37.320055 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:29:37.462902 [debug] [Thread-1 (]: SQL status: OK in 0.142 seconds
[0m17:29:37.468835 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:29:37.469558 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:29:37.593948 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m17:29:37.596433 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:29:37.598815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c4aa79d-f301-402b-bf20-28746e3fdf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268C99D250>]}
[0m17:29:37.599672 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.56s]
[0m17:29:37.600674 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:29:37.601558 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:29:37.602654 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:29:37.605227 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:29:37.606421 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:29:37.613995 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:29:37.615991 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:29:37.621974 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:29:37.623180 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:29:37.623639 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:29:37.623999 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:29:37.625361 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:29:37.625862 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:29:37.626339 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:29:37.715078 [debug] [Thread-2 (]: SQL status: OK in 0.088 seconds
[0m17:29:37.718167 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:29:37.718678 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:29:37.778569 [debug] [Thread-2 (]: SQL status: OK in 0.059 seconds
[0m17:29:37.781819 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:29:37.782247 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:29:37.841760 [debug] [Thread-2 (]: SQL status: OK in 0.059 seconds
[0m17:29:37.843157 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:29:37.843580 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:29:37.843930 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:29:38.028807 [debug] [Thread-2 (]: SQL status: OK in 0.184 seconds
[0m17:29:38.033051 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:29:38.033980 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:29:38.146525 [debug] [Thread-2 (]: SQL status: OK in 0.112 seconds
[0m17:29:38.148422 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:29:38.149007 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c4aa79d-f301-402b-bf20-28746e3fdf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268CA84260>]}
[0m17:29:38.149665 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.54s]
[0m17:29:38.150482 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:29:38.151240 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:29:38.151757 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:29:38.152486 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:29:38.152928 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:29:38.156220 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:29:38.157304 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:29:38.161253 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:29:38.162361 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:29:38.163092 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:29:38.163770 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:29:38.165166 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:29:38.165557 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:29:38.165962 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed, 
        (case when regime != prev_regime or prev_regime is null then trade_date end) as end_date, 
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        rank(regime) over(partition by changed order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

/*
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
*/


select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:29:38.224823 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed, 
        (case when regime != prev_regime or prev_regime is null then trade_date end) as end_date, 
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        rank(regime) over(partition by changed order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

/*
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
*/


select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:29:38.225335 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:29:38.225808 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: ROLLBACK
[0m17:29:38.232677 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.int__regime_changes'
[0m17:29:38.233114 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:29:38.238150 [debug] [Thread-3 (]: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: RANK needs 0 parameters, got 1
[0m17:29:38.239121 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c4aa79d-f301-402b-bf20-28746e3fdf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268DF9E210>]}
[0m17:29:38.239967 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model analytics_dev.int__regime_changes ......... [[31mERROR[0m in 0.09s]
[0m17:29:38.240805 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:29:38.241414 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_changes' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: RANK needs 0 parameters, got 1.
[0m17:29:38.243249 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:38.243607 [debug] [MainThread]: On master: BEGIN
[0m17:29:38.243906 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:29:38.245089 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:29:38.245429 [debug] [MainThread]: On master: COMMIT
[0m17:29:38.245742 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:38.246036 [debug] [MainThread]: On master: COMMIT
[0m17:29:38.246688 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:29:38.247008 [debug] [MainThread]: On master: Close
[0m17:29:38.247408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:38.247689 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:29:38.247952 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:29:38.248213 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:29:38.248480 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:29:38.248743 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:29:38.249006 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:29:38.249366 [info ] [MainThread]: 
[0m17:29:38.249924 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m17:29:38.251453 [debug] [MainThread]: Command end result
[0m17:29:38.300650 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:29:38.303424 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:29:38.309902 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:29:38.310275 [info ] [MainThread]: 
[0m17:29:38.310823 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:29:38.311411 [info ] [MainThread]: 
[0m17:29:38.312036 [error] [MainThread]: [31mFailure in model int__regime_changes (models\silver\int\int__regime_changes.sql)[0m
[0m17:29:38.312640 [error] [MainThread]:   Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: RANK needs 0 parameters, got 1
[0m17:29:38.313136 [info ] [MainThread]: 
[0m17:29:38.313700 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_changes.sql
[0m17:29:38.314206 [info ] [MainThread]: 
[0m17:29:38.314717 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m17:29:38.315688 [debug] [MainThread]: Command `-c run` failed at 17:29:38.315563 after 4.65 seconds
[0m17:29:38.316091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268BF9F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022689FEFDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268AC0BB60>]}
[0m17:29:38.316483 [debug] [MainThread]: Flushing usage events
[0m17:29:39.041136 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:42.650798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235DAE18050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235DB6242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235DBC67ED0>]}


============================== 17:29:42.655270 | 66205156-1379-4b8c-be39-bcf7c454094c ==============================
[0m17:29:42.655270 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:29:42.655958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'log_format': 'default', 'invocation_command': 'dbt run --select +int__regime_changes', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:29:42.902779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66205156-1379-4b8c-be39-bcf7c454094c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235DAFD0180>]}
[0m17:29:42.967577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66205156-1379-4b8c-be39-bcf7c454094c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235DBB0B790>]}
[0m17:29:42.970340 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:29:43.240592 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:29:43.641812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:29:43.642459 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:29:43.989311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66205156-1379-4b8c-be39-bcf7c454094c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235DD4F9B50>]}
[0m17:29:44.113346 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:29:44.115797 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:29:44.145323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66205156-1379-4b8c-be39-bcf7c454094c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235DCF90B90>]}
[0m17:29:44.145794 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:29:44.146342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66205156-1379-4b8c-be39-bcf7c454094c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235DBB23770>]}
[0m17:29:44.148363 [info ] [MainThread]: 
[0m17:29:44.148925 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:29:44.149478 [info ] [MainThread]: 
[0m17:29:44.150267 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:29:44.155186 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:29:44.232934 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:29:44.233307 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:29:44.233608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:45.865972 [debug] [ThreadPool]: SQL status: OK in 1.632 seconds
[0m17:29:45.867330 [debug] [ThreadPool]: On list_finance: Close
[0m17:29:45.868091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:29:45.868546 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:29:45.874438 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:29:45.874760 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:29:45.875053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:29:45.876563 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:29:45.877786 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:29:45.878084 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:29:45.879017 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:29:45.879315 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:29:45.879605 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:29:45.936970 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m17:29:45.938360 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:29:45.938856 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:29:45.939316 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:29:45.995571 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m17:29:45.997149 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:29:45.999482 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:29:46.005010 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:29:46.005323 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:29:46.005600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:46.006506 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:29:46.008555 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:29:46.008879 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:29:46.009158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:46.009865 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:29:46.010306 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:29:46.010613 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:29:46.011138 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:29:46.011459 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:29:46.011768 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:29:46.035326 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:29:46.035714 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m17:29:46.036985 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:29:46.038373 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:29:46.039622 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:29:46.039926 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:29:46.040371 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:29:46.040778 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:29:46.042911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66205156-1379-4b8c-be39-bcf7c454094c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235DD247AD0>]}
[0m17:29:46.043379 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:46.043684 [debug] [MainThread]: On master: BEGIN
[0m17:29:46.043973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:29:46.045268 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:29:46.045601 [debug] [MainThread]: On master: COMMIT
[0m17:29:46.045895 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:46.046174 [debug] [MainThread]: On master: COMMIT
[0m17:29:46.046727 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:29:46.047031 [debug] [MainThread]: On master: Close
[0m17:29:46.051678 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:29:46.052222 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:29:46.052946 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:29:46.053316 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:29:46.060126 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:29:46.061076 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:29:46.091845 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:29:46.092901 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:29:46.093338 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:29:46.093668 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:29:46.095080 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:29:46.095428 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:29:46.095769 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:29:46.160787 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m17:29:46.172337 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:29:46.173123 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:29:46.243129 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m17:29:46.255610 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:29:46.257334 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:29:46.348735 [debug] [Thread-1 (]: SQL status: OK in 0.090 seconds
[0m17:29:46.360497 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:29:46.360924 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:29:46.361281 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:29:46.472004 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m17:29:46.477854 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:29:46.478595 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:29:46.608718 [debug] [Thread-1 (]: SQL status: OK in 0.129 seconds
[0m17:29:46.617811 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:29:46.622952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66205156-1379-4b8c-be39-bcf7c454094c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235DD951250>]}
[0m17:29:46.624380 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.57s]
[0m17:29:46.626164 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:29:46.627638 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:29:46.628777 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:29:46.630055 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:29:46.630779 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:29:46.634294 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:29:46.635200 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:29:46.638711 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:29:46.639665 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:29:46.640075 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:29:46.640414 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:29:46.641839 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:29:46.642209 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:29:46.642580 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:29:46.732758 [debug] [Thread-2 (]: SQL status: OK in 0.090 seconds
[0m17:29:46.735752 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:29:46.736179 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:29:46.798485 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m17:29:46.801823 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:29:46.802235 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:29:46.863933 [debug] [Thread-2 (]: SQL status: OK in 0.061 seconds
[0m17:29:46.865249 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:29:46.865611 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:29:46.865947 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:29:47.247324 [debug] [Thread-2 (]: SQL status: OK in 0.381 seconds
[0m17:29:47.250011 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:29:47.250508 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:29:47.358400 [debug] [Thread-2 (]: SQL status: OK in 0.107 seconds
[0m17:29:47.360157 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:29:47.361279 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66205156-1379-4b8c-be39-bcf7c454094c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235DDA34260>]}
[0m17:29:47.362124 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.73s]
[0m17:29:47.363053 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:29:47.363919 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:29:47.364437 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:29:47.365292 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:29:47.365674 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:29:47.368658 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:29:47.369739 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:29:47.373318 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:29:47.374320 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:29:47.374944 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:29:47.375464 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:29:47.377107 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:29:47.377624 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:29:47.378103 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed, 
        (case when regime != prev_regime or prev_regime is null then trade_date end) as end_date, 
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        SUM(regime) over(partition by changed order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

/*
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
*/


select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:29:47.440747 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed, 
        (case when regime != prev_regime or prev_regime is null then trade_date end) as end_date, 
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        SUM(regime) over(partition by changed order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

/*
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
*/


select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:29:47.441330 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:29:47.441797 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: ROLLBACK
[0m17:29:47.448460 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.int__regime_changes'
[0m17:29:47.448894 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:29:47.454359 [debug] [Thread-3 (]: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  	sum(BIGNUM) -> BIGNUM
  
  
  LINE 44:         SUM(regime) over(partition by changed order by trade_date...
                   ^
[0m17:29:47.454958 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66205156-1379-4b8c-be39-bcf7c454094c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235DEEFE0D0>]}
[0m17:29:47.455596 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model analytics_dev.int__regime_changes ......... [[31mERROR[0m in 0.09s]
[0m17:29:47.456438 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:29:47.457069 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_changes' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  	sum(BIGNUM) -> BIGNUM
  
  
  LINE 44:         SUM(regime) over(partition by changed order by trade_date...
                   ^.
[0m17:29:47.459214 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:47.459628 [debug] [MainThread]: On master: BEGIN
[0m17:29:47.459926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:29:47.461134 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:29:47.461504 [debug] [MainThread]: On master: COMMIT
[0m17:29:47.461813 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:47.462106 [debug] [MainThread]: On master: COMMIT
[0m17:29:47.462743 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:29:47.463073 [debug] [MainThread]: On master: Close
[0m17:29:47.463537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:47.463930 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:29:47.464230 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:29:47.464501 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:29:47.464772 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:29:47.465041 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:29:47.465307 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:29:47.465695 [info ] [MainThread]: 
[0m17:29:47.466204 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m17:29:47.467471 [debug] [MainThread]: Command end result
[0m17:29:47.521587 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:29:47.524217 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:29:47.530376 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:29:47.530766 [info ] [MainThread]: 
[0m17:29:47.531317 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:29:47.531960 [info ] [MainThread]: 
[0m17:29:47.532753 [error] [MainThread]: [31mFailure in model int__regime_changes (models\silver\int\int__regime_changes.sql)[0m
[0m17:29:47.533361 [error] [MainThread]:   Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  	sum(BIGNUM) -> BIGNUM
  
  
  LINE 44:         SUM(regime) over(partition by changed order by trade_date...
                   ^
[0m17:29:47.534028 [info ] [MainThread]: 
[0m17:29:47.534620 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_changes.sql
[0m17:29:47.535114 [info ] [MainThread]: 
[0m17:29:47.535628 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m17:29:47.536541 [debug] [MainThread]: Command `-c run` failed at 17:29:47.536406 after 5.01 seconds
[0m17:29:47.536945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235DCF539D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235DAF4FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235DBB6FB60>]}
[0m17:29:47.537345 [debug] [MainThread]: Flushing usage events
[0m17:29:48.406026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:59.961551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FBC268050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FBCA742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FBD0B7ED0>]}


============================== 17:29:59.966005 | 4d816589-a6d2-4fa1-ac45-ff87b53ea0be ==============================
[0m17:29:59.966005 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:29:59.966709 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select +int__regime_changes', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:30:00.217563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d816589-a6d2-4fa1-ac45-ff87b53ea0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FBC420180>]}
[0m17:30:00.282596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d816589-a6d2-4fa1-ac45-ff87b53ea0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FBCF5B790>]}
[0m17:30:00.285126 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:30:00.542890 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:30:00.931535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:30:00.932215 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:30:01.275586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d816589-a6d2-4fa1-ac45-ff87b53ea0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FBE909B50>]}
[0m17:30:01.402217 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:30:01.404839 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:30:01.434720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d816589-a6d2-4fa1-ac45-ff87b53ea0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FBE3A4B90>]}
[0m17:30:01.435160 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:30:01.435719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d816589-a6d2-4fa1-ac45-ff87b53ea0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FBCF73770>]}
[0m17:30:01.437637 [info ] [MainThread]: 
[0m17:30:01.438132 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:30:01.438697 [info ] [MainThread]: 
[0m17:30:01.439529 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:30:01.444230 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:30:01.523243 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:30:01.523628 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:30:01.523930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:03.027900 [debug] [ThreadPool]: SQL status: OK in 1.504 seconds
[0m17:30:03.029552 [debug] [ThreadPool]: On list_finance: Close
[0m17:30:03.030343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:30:03.030982 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:30:03.036828 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:30:03.037145 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:30:03.037486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:03.039073 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:30:03.040495 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:30:03.040801 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:30:03.041820 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:30:03.042114 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:30:03.042396 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:30:03.101713 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m17:30:03.102901 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:30:03.103315 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:30:03.103707 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:30:03.155023 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m17:30:03.156683 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:30:03.164354 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:30:03.171635 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:30:03.193730 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:30:03.194227 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:30:03.194593 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:30:03.194936 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:30:03.195288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:03.195661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:03.196789 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:30:03.197137 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:30:03.197432 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:30:03.197844 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:30:03.198238 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:30:03.198600 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:30:03.222727 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m17:30:03.223161 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:30:03.224329 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:30:03.225612 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:30:03.227023 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:30:03.227319 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:30:03.227820 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:30:03.228108 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:30:03.230456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d816589-a6d2-4fa1-ac45-ff87b53ea0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FBE5E7930>]}
[0m17:30:03.230894 [debug] [MainThread]: Using duckdb connection "master"
[0m17:30:03.231175 [debug] [MainThread]: On master: BEGIN
[0m17:30:03.231439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:03.233137 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:30:03.233480 [debug] [MainThread]: On master: COMMIT
[0m17:30:03.233791 [debug] [MainThread]: Using duckdb connection "master"
[0m17:30:03.234066 [debug] [MainThread]: On master: COMMIT
[0m17:30:03.234678 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:30:03.234978 [debug] [MainThread]: On master: Close
[0m17:30:03.240591 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:30:03.241140 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:30:03.241980 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:30:03.242390 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:30:03.250218 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:30:03.251364 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:30:03.283141 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:30:03.284079 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:30:03.284443 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:30:03.284769 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:30:03.286190 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:30:03.286612 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:30:03.286961 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:30:03.459862 [debug] [Thread-1 (]: SQL status: OK in 0.172 seconds
[0m17:30:03.465729 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:30:03.466109 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:30:03.533219 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m17:30:03.538449 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:30:03.538815 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:30:03.613518 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m17:30:03.626854 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:30:03.627435 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:30:03.627839 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:30:03.780429 [debug] [Thread-1 (]: SQL status: OK in 0.152 seconds
[0m17:30:03.785823 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:30:03.786472 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:30:03.903222 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m17:30:03.906199 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:30:03.908891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d816589-a6d2-4fa1-ac45-ff87b53ea0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FBED51310>]}
[0m17:30:03.909661 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.66s]
[0m17:30:03.910620 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:30:03.911404 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:30:03.911920 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:30:03.912646 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:30:03.913025 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:30:03.915716 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:30:03.916570 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:30:03.920041 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:30:03.921293 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:30:03.921736 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:30:03.922077 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:30:03.923403 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:30:03.923770 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:30:03.924137 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:30:04.013299 [debug] [Thread-2 (]: SQL status: OK in 0.089 seconds
[0m17:30:04.016563 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:30:04.017018 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:30:04.072581 [debug] [Thread-2 (]: SQL status: OK in 0.055 seconds
[0m17:30:04.075763 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:30:04.076158 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:30:04.133876 [debug] [Thread-2 (]: SQL status: OK in 0.057 seconds
[0m17:30:04.135263 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:30:04.135676 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:30:04.136030 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:30:04.525371 [debug] [Thread-2 (]: SQL status: OK in 0.389 seconds
[0m17:30:04.528403 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:30:04.528884 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:30:04.664403 [debug] [Thread-2 (]: SQL status: OK in 0.135 seconds
[0m17:30:04.666338 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:30:04.666923 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d816589-a6d2-4fa1-ac45-ff87b53ea0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FBEE04470>]}
[0m17:30:04.667543 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.75s]
[0m17:30:04.668522 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:30:04.669336 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:30:04.669839 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:30:04.670559 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:30:04.670930 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:30:04.673893 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:30:04.676615 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:30:04.684047 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:30:04.686664 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:30:04.687635 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:30:04.688250 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:30:04.690794 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:30:04.691528 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:30:04.692149 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed, 
        (case when regime != prev_regime or prev_regime is null then trade_date end) as end_date, 
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        SUM(changed) over(partition by regime order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

/*
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
*/


select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:30:04.838445 [debug] [Thread-3 (]: SQL status: OK in 0.146 seconds
[0m17:30:04.841444 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:30:04.841850 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m17:30:04.894803 [debug] [Thread-3 (]: SQL status: OK in 0.052 seconds
[0m17:30:04.900893 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:30:04.901326 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m17:30:04.959955 [debug] [Thread-3 (]: SQL status: OK in 0.058 seconds
[0m17:30:04.961858 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:30:04.962426 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:30:04.962957 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:30:05.084915 [debug] [Thread-3 (]: SQL status: OK in 0.121 seconds
[0m17:30:05.087495 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:30:05.087901 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m17:30:05.185441 [debug] [Thread-3 (]: SQL status: OK in 0.097 seconds
[0m17:30:05.187042 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:30:05.187635 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d816589-a6d2-4fa1-ac45-ff87b53ea0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FBEEAC230>]}
[0m17:30:05.188263 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.52s]
[0m17:30:05.189232 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:30:05.190883 [debug] [MainThread]: Using duckdb connection "master"
[0m17:30:05.191214 [debug] [MainThread]: On master: BEGIN
[0m17:30:05.191495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:30:05.192917 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:30:05.193248 [debug] [MainThread]: On master: COMMIT
[0m17:30:05.193542 [debug] [MainThread]: Using duckdb connection "master"
[0m17:30:05.193819 [debug] [MainThread]: On master: COMMIT
[0m17:30:05.194432 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:30:05.194737 [debug] [MainThread]: On master: Close
[0m17:30:05.195143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:05.195416 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:30:05.195679 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:30:05.195931 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:30:05.196181 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:30:05.196436 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:30:05.196688 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:30:05.197042 [info ] [MainThread]: 
[0m17:30:05.197584 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m17:30:05.198903 [debug] [MainThread]: Command end result
[0m17:30:05.249809 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:30:05.252503 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:30:05.259743 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:30:05.260168 [info ] [MainThread]: 
[0m17:30:05.260744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:05.261262 [info ] [MainThread]: 
[0m17:30:05.261783 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:30:05.262737 [debug] [MainThread]: Command `-c run` succeeded at 17:30:05.262608 after 5.43 seconds
[0m17:30:05.263135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FBE208450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FBE34F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FBCFBFB60>]}
[0m17:30:05.263503 [debug] [MainThread]: Flushing usage events
[0m17:30:05.937334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:54.378016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A57A8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A5FB42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A65F7ED0>]}


============================== 17:35:54.382559 | f4c9835c-c0ec-4945-a190-4b59f065fbab ==============================
[0m17:35:54.382559 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:35:54.383288 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select +int__regime_changes', 'printer_width': '80', 'write_json': 'True'}
[0m17:35:54.632916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4c9835c-c0ec-4945-a190-4b59f065fbab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A5960180>]}
[0m17:35:54.697948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4c9835c-c0ec-4945-a190-4b59f065fbab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A649B790>]}
[0m17:35:54.700477 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:35:54.968476 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:35:55.470684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:35:55.471368 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:35:55.862593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4c9835c-c0ec-4945-a190-4b59f065fbab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A7F61B50>]}
[0m17:35:56.001630 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:35:56.004357 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:35:56.040737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4c9835c-c0ec-4945-a190-4b59f065fbab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A79C4B90>]}
[0m17:35:56.041282 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:35:56.041969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c9835c-c0ec-4945-a190-4b59f065fbab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A64B3770>]}
[0m17:35:56.044708 [info ] [MainThread]: 
[0m17:35:56.045385 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:35:56.045890 [info ] [MainThread]: 
[0m17:35:56.046551 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:35:56.052115 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:35:56.130020 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:35:56.130401 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:35:56.130705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:57.316125 [debug] [ThreadPool]: SQL status: OK in 1.185 seconds
[0m17:35:57.317576 [debug] [ThreadPool]: On list_finance: Close
[0m17:35:57.318260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:35:57.318786 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:35:57.325107 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:35:57.325502 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:35:57.325808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:57.327378 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:35:57.328705 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:35:57.329015 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:35:57.329910 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:35:57.330215 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:35:57.330512 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:35:57.390949 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m17:35:57.392273 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:35:57.392750 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:35:57.393177 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:35:57.445891 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m17:35:57.446312 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:35:57.448269 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:35:57.453812 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:35:57.454158 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:35:57.454446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:57.455374 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:35:57.457350 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:35:57.457674 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:35:57.457960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:57.458616 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:35:57.458971 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:35:57.459286 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:35:57.459735 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:35:57.460060 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:35:57.460381 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:35:57.484436 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m17:35:57.484914 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:35:57.486174 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:35:57.487579 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:35:57.488885 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:35:57.489259 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:35:57.489813 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:35:57.490129 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:35:57.492641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c9835c-c0ec-4945-a190-4b59f065fbab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A7C53BA0>]}
[0m17:35:57.493146 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:57.493468 [debug] [MainThread]: On master: BEGIN
[0m17:35:57.493770 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:57.495063 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:35:57.495393 [debug] [MainThread]: On master: COMMIT
[0m17:35:57.495712 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:57.496014 [debug] [MainThread]: On master: COMMIT
[0m17:35:57.496608 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:57.496933 [debug] [MainThread]: On master: Close
[0m17:35:57.501559 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:35:57.502075 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:35:57.502815 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:35:57.503198 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:35:57.510135 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:35:57.511003 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:35:57.540687 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:35:57.541638 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:35:57.542011 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:35:57.542352 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:35:57.543830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:35:57.544300 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:35:57.544656 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:35:57.621423 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m17:35:57.632600 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:35:57.633358 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:35:57.719961 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m17:35:57.725788 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:35:57.726172 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:35:57.793241 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m17:35:57.805374 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:35:57.805856 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:35:57.806232 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:35:57.952541 [debug] [Thread-1 (]: SQL status: OK in 0.145 seconds
[0m17:35:57.968230 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:35:57.969434 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:35:58.083444 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m17:35:58.086023 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:35:58.088028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c9835c-c0ec-4945-a190-4b59f065fbab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A836D250>]}
[0m17:35:58.088661 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.58s]
[0m17:35:58.089575 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:35:58.090478 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:35:58.091035 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:35:58.091970 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:35:58.092348 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:35:58.094958 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:35:58.095827 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:35:58.099234 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:35:58.100126 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:35:58.100616 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:35:58.100947 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:35:58.102176 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:35:58.102525 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:35:58.102890 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:35:58.205337 [debug] [Thread-2 (]: SQL status: OK in 0.102 seconds
[0m17:35:58.211334 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:35:58.212177 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:35:58.328788 [debug] [Thread-2 (]: SQL status: OK in 0.116 seconds
[0m17:35:58.332276 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:35:58.332700 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:35:58.403385 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m17:35:58.406234 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:35:58.407095 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:35:58.407889 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:35:58.626359 [debug] [Thread-2 (]: SQL status: OK in 0.218 seconds
[0m17:35:58.628652 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:35:58.629007 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:35:58.758276 [debug] [Thread-2 (]: SQL status: OK in 0.129 seconds
[0m17:35:58.759908 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:35:58.760449 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c9835c-c0ec-4945-a190-4b59f065fbab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A8454260>]}
[0m17:35:58.761026 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.67s]
[0m17:35:58.761851 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:35:58.762547 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:35:58.763044 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:35:58.763789 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:35:58.764177 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:35:58.766989 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:35:58.767940 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:35:58.771231 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:35:58.772186 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:35:58.772591 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:35:58.772962 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:35:58.774249 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:35:58.774669 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:35:58.775141 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then "TRUE"
            else "FALSE"
        end) as changed, 
        (case when regime != prev_regime or prev_regime is null then trade_date end) as end_date, 
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        rank() over(partition by regime order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

/*
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
*/


select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:35:58.832521 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then "TRUE"
            else "FALSE"
        end) as changed, 
        (case when regime != prev_regime or prev_regime is null then trade_date end) as end_date, 
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        rank() over(partition by regime order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

/*
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
*/


select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:35:58.833028 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:58.833480 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: ROLLBACK
[0m17:35:58.840050 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.int__regime_changes'
[0m17:35:58.840446 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:35:58.844749 [debug] [Thread-3 (]: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: Referenced column "TRUE" not found in FROM clause!
  Candidate bindings: "regime"
  
  LINE 30: ...        when regime != prev_regime or prev_regime is null then "TRUE"
                                                                             ^
[0m17:35:58.845192 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c9835c-c0ec-4945-a190-4b59f065fbab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A990E170>]}
[0m17:35:58.845770 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model analytics_dev.int__regime_changes ......... [[31mERROR[0m in 0.08s]
[0m17:35:58.846590 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:35:58.847198 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_changes' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: Referenced column "TRUE" not found in FROM clause!
  Candidate bindings: "regime"
  
  LINE 30: ...        when regime != prev_regime or prev_regime is null then "TRUE"
                                                                             ^.
[0m17:35:58.849135 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:58.849456 [debug] [MainThread]: On master: BEGIN
[0m17:35:58.849742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:58.851051 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:35:58.851386 [debug] [MainThread]: On master: COMMIT
[0m17:35:58.851704 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:58.852014 [debug] [MainThread]: On master: COMMIT
[0m17:35:58.852681 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:58.853014 [debug] [MainThread]: On master: Close
[0m17:35:58.853395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:58.853670 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:35:58.853935 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:35:58.854198 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:35:58.854460 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:35:58.854720 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:35:58.854980 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:35:58.855326 [info ] [MainThread]: 
[0m17:35:58.855834 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m17:35:58.857164 [debug] [MainThread]: Command end result
[0m17:35:58.904455 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:35:58.906868 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:35:58.912674 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:35:58.912992 [info ] [MainThread]: 
[0m17:35:58.913512 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:35:58.914007 [info ] [MainThread]: 
[0m17:35:58.914566 [error] [MainThread]: [31mFailure in model int__regime_changes (models\silver\int\int__regime_changes.sql)[0m
[0m17:35:58.915129 [error] [MainThread]:   Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: Referenced column "TRUE" not found in FROM clause!
  Candidate bindings: "regime"
  
  LINE 30: ...        when regime != prev_regime or prev_regime is null then "TRUE"
                                                                             ^
[0m17:35:58.915666 [info ] [MainThread]: 
[0m17:35:58.916207 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_changes.sql
[0m17:35:58.916675 [info ] [MainThread]: 
[0m17:35:58.917184 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m17:35:58.918069 [debug] [MainThread]: Command `-c run` failed at 17:35:58.917951 after 4.71 seconds
[0m17:35:58.918482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A796F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A58DFDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A64FFB60>]}
[0m17:35:58.918853 [debug] [MainThread]: Flushing usage events
[0m17:35:59.689850 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:37:08.270557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132019C8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132021D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013202817ED0>]}


============================== 17:37:08.275005 | b4c1a940-c46b-40f0-a110-ad77bec6bca0 ==============================
[0m17:37:08.275005 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:37:08.275674 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select +int__regime_changes', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m17:37:08.521448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4c1a940-c46b-40f0-a110-ad77bec6bca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013201B80180>]}
[0m17:37:08.585979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4c1a940-c46b-40f0-a110-ad77bec6bca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132026BB790>]}
[0m17:37:08.588785 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:37:08.846585 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:37:09.229668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:37:09.230321 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:37:09.573685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4c1a940-c46b-40f0-a110-ad77bec6bca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013204161B50>]}
[0m17:37:09.699437 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:37:09.701892 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:37:09.731009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4c1a940-c46b-40f0-a110-ad77bec6bca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013203BB0B90>]}
[0m17:37:09.731472 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:37:09.731989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4c1a940-c46b-40f0-a110-ad77bec6bca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132026D3770>]}
[0m17:37:09.733927 [info ] [MainThread]: 
[0m17:37:09.734401 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:37:09.734862 [info ] [MainThread]: 
[0m17:37:09.735481 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:37:09.740665 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:37:09.820924 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:37:09.821306 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:37:09.821607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:11.235291 [debug] [ThreadPool]: SQL status: OK in 1.414 seconds
[0m17:37:11.236925 [debug] [ThreadPool]: On list_finance: Close
[0m17:37:11.237703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:37:11.238260 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:37:11.244836 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:37:11.245181 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:37:11.245480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:11.246957 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:37:11.248203 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:37:11.248501 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:37:11.249536 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:37:11.249840 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:37:11.250130 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:37:11.297640 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m17:37:11.298650 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:37:11.299002 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:37:11.299357 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:37:11.345684 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m17:37:11.346607 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:37:11.351964 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:37:11.358243 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:37:11.363343 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:37:11.363680 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:37:11.363959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:11.365284 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:37:11.365593 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:37:11.365875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:11.366557 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:37:11.366893 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:37:11.367197 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:37:11.367635 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:37:11.367947 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:37:11.368244 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:37:11.391083 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m17:37:11.392571 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:37:11.393018 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m17:37:11.394130 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:37:11.395196 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:37:11.395658 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:37:11.395998 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:37:11.396358 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:37:11.398837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4c1a940-c46b-40f0-a110-ad77bec6bca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013203E07860>]}
[0m17:37:11.399297 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:11.399602 [debug] [MainThread]: On master: BEGIN
[0m17:37:11.399895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:11.401036 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:37:11.401335 [debug] [MainThread]: On master: COMMIT
[0m17:37:11.401620 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:11.401896 [debug] [MainThread]: On master: COMMIT
[0m17:37:11.402441 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:37:11.402745 [debug] [MainThread]: On master: Close
[0m17:37:11.407431 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:37:11.407944 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:37:11.408630 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:37:11.408999 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:37:11.416094 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:37:11.416925 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:37:11.449171 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:37:11.450133 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:37:11.450527 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:37:11.450932 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:37:11.452225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:37:11.452586 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:37:11.452938 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:37:11.516318 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m17:37:11.525648 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:37:11.526270 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:37:11.591838 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m17:37:11.598920 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:37:11.599712 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:37:11.660086 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m17:37:11.680684 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:37:11.681261 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:37:11.681699 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:37:11.915249 [debug] [Thread-1 (]: SQL status: OK in 0.233 seconds
[0m17:37:11.920518 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:37:11.921138 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:37:12.041544 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m17:37:12.043989 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:37:12.046292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4c1a940-c46b-40f0-a110-ad77bec6bca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013204571250>]}
[0m17:37:12.046924 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.64s]
[0m17:37:12.047727 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:37:12.048478 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:37:12.048950 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:37:12.049637 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:37:12.050012 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:37:12.052620 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:37:12.053430 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:37:12.056662 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:37:12.057511 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:37:12.057871 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:37:12.058198 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:37:12.059409 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:37:12.060206 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:37:12.060673 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:37:12.240553 [debug] [Thread-2 (]: SQL status: OK in 0.179 seconds
[0m17:37:12.243708 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:37:12.244117 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:37:12.315085 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m17:37:12.327420 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:37:12.328384 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:37:12.405545 [debug] [Thread-2 (]: SQL status: OK in 0.076 seconds
[0m17:37:12.407896 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:37:12.408294 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:37:12.408627 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:37:12.713224 [debug] [Thread-2 (]: SQL status: OK in 0.304 seconds
[0m17:37:12.715775 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:37:12.716214 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:37:12.827044 [debug] [Thread-2 (]: SQL status: OK in 0.110 seconds
[0m17:37:12.828772 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:37:12.829325 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4c1a940-c46b-40f0-a110-ad77bec6bca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001320463C3C0>]}
[0m17:37:12.829929 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.78s]
[0m17:37:12.830781 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:37:12.831492 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:37:12.831973 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:37:12.832659 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:37:12.833026 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:37:12.835710 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:37:12.836551 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:37:12.839813 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:37:12.840785 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:37:12.841188 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:37:12.841532 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:37:12.842667 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:37:12.843042 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:37:12.843443 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 'TRUE'
            else 'FALSE'
        end) as changed, 
        (case when regime != prev_regime or prev_regime is null then trade_date end) as end_date 
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        rank() over(partition by regime order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

/*
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        row_number() over(partition by regime, changed order by trade_date asc, loaded_at asc) 
    from regime_changes
*/


select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:37:12.939956 [debug] [Thread-3 (]: SQL status: OK in 0.096 seconds
[0m17:37:12.943335 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:37:12.943785 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m17:37:13.007518 [debug] [Thread-3 (]: SQL status: OK in 0.063 seconds
[0m17:37:13.014798 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:37:13.015214 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m17:37:13.081959 [debug] [Thread-3 (]: SQL status: OK in 0.066 seconds
[0m17:37:13.084659 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:37:13.085122 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:37:13.085456 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:37:13.212226 [debug] [Thread-3 (]: SQL status: OK in 0.126 seconds
[0m17:37:13.214609 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:37:13.215165 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m17:37:13.333373 [debug] [Thread-3 (]: SQL status: OK in 0.118 seconds
[0m17:37:13.334791 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:37:13.335290 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4c1a940-c46b-40f0-a110-ad77bec6bca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132046C80F0>]}
[0m17:37:13.335852 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.50s]
[0m17:37:13.336642 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:37:13.338170 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:13.338490 [debug] [MainThread]: On master: BEGIN
[0m17:37:13.338781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:37:13.340056 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:37:13.340376 [debug] [MainThread]: On master: COMMIT
[0m17:37:13.340685 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:13.340983 [debug] [MainThread]: On master: COMMIT
[0m17:37:13.341527 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:37:13.341827 [debug] [MainThread]: On master: Close
[0m17:37:13.342202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:13.342474 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:37:13.342733 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:37:13.342990 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:37:13.343243 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:37:13.343495 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:37:13.343751 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:37:13.344093 [info ] [MainThread]: 
[0m17:37:13.344580 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.61 seconds (3.61s).
[0m17:37:13.346005 [debug] [MainThread]: Command end result
[0m17:37:13.391754 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:37:13.394169 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:37:13.399983 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:37:13.400370 [info ] [MainThread]: 
[0m17:37:13.400880 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:37:13.401531 [info ] [MainThread]: 
[0m17:37:13.402112 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:37:13.402997 [debug] [MainThread]: Command `-c run` succeeded at 17:37:13.402884 after 5.26 seconds
[0m17:37:13.403362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013203A3C450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013203B6F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001320271FB60>]}
[0m17:37:13.403724 [debug] [MainThread]: Flushing usage events
[0m17:37:14.071408 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:46:54.161506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022773CC8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227744D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022774B17ED0>]}


============================== 17:46:54.165937 | f062141c-f63a-4d06-9147-cc5a09db10e3 ==============================
[0m17:46:54.165937 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:46:54.166627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select +int__regime_changes', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m17:46:54.414579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f062141c-f63a-4d06-9147-cc5a09db10e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022773E80180>]}
[0m17:46:54.479333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f062141c-f63a-4d06-9147-cc5a09db10e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227749BB790>]}
[0m17:46:54.481853 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:46:54.736054 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:46:55.122685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:46:55.123374 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:46:55.478917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f062141c-f63a-4d06-9147-cc5a09db10e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227763C5B50>]}
[0m17:46:55.609098 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:46:55.611999 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:46:55.641400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f062141c-f63a-4d06-9147-cc5a09db10e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022775E24B90>]}
[0m17:46:55.641877 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:46:55.642401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f062141c-f63a-4d06-9147-cc5a09db10e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227749D3770>]}
[0m17:46:55.644605 [info ] [MainThread]: 
[0m17:46:55.645220 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:46:55.645698 [info ] [MainThread]: 
[0m17:46:55.646353 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:46:55.651416 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:46:55.727820 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:46:55.728233 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:46:55.728545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:57.300748 [debug] [ThreadPool]: SQL status: OK in 1.572 seconds
[0m17:46:57.302139 [debug] [ThreadPool]: On list_finance: Close
[0m17:46:57.302809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:46:57.303284 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:46:57.309380 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:46:57.309815 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:46:57.310464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:57.312536 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:46:57.313966 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:46:57.314297 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:46:57.315318 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:46:57.315646 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:46:57.316092 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:46:57.369623 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m17:46:57.370705 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:46:57.371054 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:46:57.371373 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:46:57.428107 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m17:46:57.429083 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:46:57.432193 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:46:57.437943 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:46:57.438465 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:46:57.438786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:57.439432 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:46:57.441462 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:46:57.441785 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:46:57.442064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:57.442703 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:46:57.443031 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:46:57.443359 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:46:57.443888 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:46:57.444463 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:46:57.444786 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:46:57.469722 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m17:46:57.470182 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m17:46:57.471541 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:46:57.472679 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:46:57.473702 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:46:57.474000 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:46:57.474475 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:46:57.474787 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:46:57.477305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f062141c-f63a-4d06-9147-cc5a09db10e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227760BFBA0>]}
[0m17:46:57.477819 [debug] [MainThread]: Using duckdb connection "master"
[0m17:46:57.478119 [debug] [MainThread]: On master: BEGIN
[0m17:46:57.478394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:57.479644 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:46:57.479973 [debug] [MainThread]: On master: COMMIT
[0m17:46:57.480271 [debug] [MainThread]: Using duckdb connection "master"
[0m17:46:57.480605 [debug] [MainThread]: On master: COMMIT
[0m17:46:57.481556 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:46:57.481905 [debug] [MainThread]: On master: Close
[0m17:46:57.487462 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:46:57.488004 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:46:57.488702 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:46:57.489061 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:46:57.496379 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:46:57.497847 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:46:57.532133 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:46:57.533621 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:46:57.534133 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:46:57.534463 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:46:57.535783 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:46:57.536145 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:46:57.536494 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:46:57.595830 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m17:46:57.601964 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:46:57.602393 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:46:57.659804 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m17:46:57.664205 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:46:57.664727 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:46:57.737630 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m17:46:57.767692 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:46:57.768326 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:46:57.768853 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:46:57.892607 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m17:46:57.899369 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:46:57.900156 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:46:58.004537 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m17:46:58.007013 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:46:58.009398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f062141c-f63a-4d06-9147-cc5a09db10e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227767C1010>]}
[0m17:46:58.010188 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.52s]
[0m17:46:58.011770 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:46:58.012746 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:46:58.013431 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:46:58.014778 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:46:58.015545 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:46:58.019206 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:46:58.020374 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:46:58.024462 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:46:58.025577 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:46:58.026020 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:46:58.026380 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:46:58.027985 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:46:58.028448 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:46:58.028852 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:46:58.099994 [debug] [Thread-2 (]: SQL status: OK in 0.071 seconds
[0m17:46:58.103413 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:46:58.103864 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:46:58.165482 [debug] [Thread-2 (]: SQL status: OK in 0.061 seconds
[0m17:46:58.169616 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:46:58.170058 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:46:58.232627 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m17:46:58.234354 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:46:58.234820 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:46:58.235173 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:46:58.407674 [debug] [Thread-2 (]: SQL status: OK in 0.171 seconds
[0m17:46:58.410229 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:46:58.410913 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:46:58.508775 [debug] [Thread-2 (]: SQL status: OK in 0.097 seconds
[0m17:46:58.511075 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:46:58.511853 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f062141c-f63a-4d06-9147-cc5a09db10e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227768B0260>]}
[0m17:46:58.512675 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.50s]
[0m17:46:58.513845 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:46:58.514881 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:46:58.515542 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:46:58.516422 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:46:58.517080 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:46:58.520170 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:46:58.521115 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:46:58.525079 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:46:58.526020 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:46:58.526401 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:46:58.526765 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:46:58.528956 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:46:58.529619 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:46:58.530291 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 'TRUE'
            else 'FALSE'
        end) as changed ,
        (case
            when regime != prev_regime or prev_regime is null then trade_date
            else null
        end) as end_date
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        rank() over(partition by regime order by trade_date asc, loaded_at asc) as change_counter, 
        end_date
    from regime_changes
)

/*
test as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        change_counter, 

from regime_changes
group by change_counter, regime
*/

select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:46:58.624601 [debug] [Thread-3 (]: SQL status: OK in 0.094 seconds
[0m17:46:58.628805 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:46:58.629326 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m17:46:58.691860 [debug] [Thread-3 (]: SQL status: OK in 0.062 seconds
[0m17:46:58.703670 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:46:58.704534 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m17:46:58.778356 [debug] [Thread-3 (]: SQL status: OK in 0.073 seconds
[0m17:46:58.779800 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:46:58.780177 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:46:58.780517 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:46:58.898502 [debug] [Thread-3 (]: SQL status: OK in 0.118 seconds
[0m17:46:58.901424 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:46:58.901928 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m17:46:59.025352 [debug] [Thread-3 (]: SQL status: OK in 0.123 seconds
[0m17:46:59.026816 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:46:59.027361 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f062141c-f63a-4d06-9147-cc5a09db10e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227768C3110>]}
[0m17:46:59.027949 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.51s]
[0m17:46:59.028749 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:46:59.030103 [debug] [MainThread]: Using duckdb connection "master"
[0m17:46:59.030426 [debug] [MainThread]: On master: BEGIN
[0m17:46:59.030724 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:46:59.031990 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:46:59.032309 [debug] [MainThread]: On master: COMMIT
[0m17:46:59.032620 [debug] [MainThread]: Using duckdb connection "master"
[0m17:46:59.032917 [debug] [MainThread]: On master: COMMIT
[0m17:46:59.033521 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:46:59.033847 [debug] [MainThread]: On master: Close
[0m17:46:59.034243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:59.034539 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:46:59.034823 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:46:59.035101 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:46:59.035378 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:46:59.035660 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:46:59.035939 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:46:59.036302 [info ] [MainThread]: 
[0m17:46:59.036791 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m17:46:59.038010 [debug] [MainThread]: Command end result
[0m17:46:59.081766 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:46:59.084108 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:46:59.089890 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:46:59.090223 [info ] [MainThread]: 
[0m17:46:59.090741 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:46:59.091205 [info ] [MainThread]: 
[0m17:46:59.091711 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:46:59.092594 [debug] [MainThread]: Command `-c run` succeeded at 17:46:59.092481 after 5.10 seconds
[0m17:46:59.092971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022775C9C450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022775DD34D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022774A1FB60>]}
[0m17:46:59.093349 [debug] [MainThread]: Flushing usage events
[0m17:46:59.864358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:54:09.592011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024746708050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024746F142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024747557ED0>]}


============================== 17:54:09.596548 | 02a9ab99-7b26-4066-b563-16d105703d40 ==============================
[0m17:54:09.596548 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:54:09.597255 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --select +int__regime_changes', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m17:54:09.846511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02a9ab99-7b26-4066-b563-16d105703d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247468C0180>]}
[0m17:54:09.912616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02a9ab99-7b26-4066-b563-16d105703d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247473FB790>]}
[0m17:54:09.915233 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:54:10.170293 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:54:10.565671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:10.566357 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:54:10.922634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02a9ab99-7b26-4066-b563-16d105703d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024748E15B50>]}
[0m17:54:11.053927 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:54:11.056461 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:54:11.087788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02a9ab99-7b26-4066-b563-16d105703d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024748874B90>]}
[0m17:54:11.088288 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:54:11.088800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02a9ab99-7b26-4066-b563-16d105703d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024747413770>]}
[0m17:54:11.090870 [info ] [MainThread]: 
[0m17:54:11.091368 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:54:11.091838 [info ] [MainThread]: 
[0m17:54:11.092478 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:54:11.097752 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:54:11.178396 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:54:11.178814 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:54:11.179231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:12.441028 [debug] [ThreadPool]: SQL status: OK in 1.262 seconds
[0m17:54:12.442499 [debug] [ThreadPool]: On list_finance: Close
[0m17:54:12.443238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:54:12.443731 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:54:12.450727 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:54:12.451118 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:54:12.451425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:12.453066 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:54:12.454394 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:54:12.454702 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:54:12.455597 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:54:12.455955 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:54:12.456265 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:54:12.504914 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m17:54:12.506089 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:54:12.506504 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:54:12.506889 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:54:12.548045 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m17:54:12.548777 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:54:12.552188 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:54:12.562685 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:54:12.562033 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:54:12.566376 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:54:12.567212 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:54:12.567788 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:54:12.568314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:12.568825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:12.570387 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:54:12.570848 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:54:12.571310 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:54:12.571990 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:54:12.572457 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:54:12.572911 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:54:12.598963 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m17:54:12.599365 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m17:54:12.600617 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:54:12.601924 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:54:12.602980 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:54:12.603289 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:54:12.603775 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:54:12.604096 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:54:12.606309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02a9ab99-7b26-4066-b563-16d105703d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024748AB7860>]}
[0m17:54:12.606816 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:12.607135 [debug] [MainThread]: On master: BEGIN
[0m17:54:12.607437 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:12.608535 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:54:12.608846 [debug] [MainThread]: On master: COMMIT
[0m17:54:12.609142 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:12.609426 [debug] [MainThread]: On master: COMMIT
[0m17:54:12.610006 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:12.610316 [debug] [MainThread]: On master: Close
[0m17:54:12.614898 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:54:12.615450 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:54:12.616123 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:54:12.616493 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:54:12.623328 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:54:12.624151 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:54:12.654588 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:54:12.655554 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:12.655923 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:54:12.656258 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:54:12.657660 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:54:12.658049 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:12.658424 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:54:12.722621 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m17:54:12.729603 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:12.730018 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:54:12.782652 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m17:54:12.787684 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:12.788280 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:54:12.851605 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m17:54:12.878265 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:54:12.878836 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:12.879314 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:54:13.012081 [debug] [Thread-1 (]: SQL status: OK in 0.132 seconds
[0m17:54:13.017344 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:13.017991 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:54:13.138971 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m17:54:13.141286 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:54:13.143350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02a9ab99-7b26-4066-b563-16d105703d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002474921D250>]}
[0m17:54:13.144016 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.53s]
[0m17:54:13.144847 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:54:13.145570 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:54:13.146061 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:54:13.146941 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:54:13.147451 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:54:13.150605 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:54:13.151615 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:54:13.154846 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:54:13.155698 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:13.156062 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:54:13.156398 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:54:13.157729 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:54:13.158115 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:13.158486 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:54:13.247066 [debug] [Thread-2 (]: SQL status: OK in 0.088 seconds
[0m17:54:13.251238 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:13.251804 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:54:13.329586 [debug] [Thread-2 (]: SQL status: OK in 0.077 seconds
[0m17:54:13.341908 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:13.343090 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:54:13.413694 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m17:54:13.415102 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:54:13.415781 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:13.416129 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:54:13.607360 [debug] [Thread-2 (]: SQL status: OK in 0.191 seconds
[0m17:54:13.609978 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:13.610368 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:54:13.707466 [debug] [Thread-2 (]: SQL status: OK in 0.097 seconds
[0m17:54:13.709145 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:54:13.709672 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02a9ab99-7b26-4066-b563-16d105703d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024749304260>]}
[0m17:54:13.710309 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.56s]
[0m17:54:13.711242 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:54:13.712042 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:54:13.712529 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:54:13.713384 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:54:13.713751 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:54:13.717157 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:54:13.718057 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:54:13.721496 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:54:13.722388 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:54:13.722752 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:54:13.723090 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:54:13.724341 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:54:13.724690 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:54:13.725069 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 'TRUE'
            else 'FALSE'
        end) as changed ,
        (case
            when nxt_regime != regime or regime is null then trade_date
            else null
        end) as end_date
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        rank() over(partition by regime order by trade_date asc, loaded_at asc) as change_counter, 
        end_date
    from regime_changes
)

...


select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:54:13.732548 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 'TRUE'
            else 'FALSE'
        end) as changed ,
        (case
            when nxt_regime != regime or regime is null then trade_date
            else null
        end) as end_date
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        rank() over(partition by regime order by trade_date asc, loaded_at asc) as change_counter, 
        end_date
    from regime_changes
)

...


select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:54:13.733051 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:54:13.733490 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: ROLLBACK
[0m17:54:13.740327 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.int__regime_changes'
[0m17:54:13.740726 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:54:13.745142 [debug] [Thread-3 (]: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Parser Error: syntax error at or near "lead"
  
  LINE 20:     lead(regime) over(order by trade_date asc, loaded_at asc...
               ^
[0m17:54:13.745616 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02a9ab99-7b26-4066-b563-16d105703d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002474A7EE170>]}
[0m17:54:13.746222 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model analytics_dev.int__regime_changes ......... [[31mERROR[0m in 0.03s]
[0m17:54:13.747335 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:54:13.748196 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_changes' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Parser Error: syntax error at or near "lead"
  
  LINE 20:     lead(regime) over(order by trade_date asc, loaded_at asc...
               ^.
[0m17:54:13.750282 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:13.750659 [debug] [MainThread]: On master: BEGIN
[0m17:54:13.750964 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:13.752227 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:54:13.752607 [debug] [MainThread]: On master: COMMIT
[0m17:54:13.752919 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:13.753207 [debug] [MainThread]: On master: COMMIT
[0m17:54:13.753914 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:13.754257 [debug] [MainThread]: On master: Close
[0m17:54:13.754686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:13.754987 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:54:13.755274 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:54:13.755554 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:54:13.755820 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:54:13.756083 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:54:13.756346 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:54:13.756701 [info ] [MainThread]: 
[0m17:54:13.757238 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m17:54:13.758495 [debug] [MainThread]: Command end result
[0m17:54:13.806483 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:54:13.808943 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:54:13.815449 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:54:13.815814 [info ] [MainThread]: 
[0m17:54:13.816331 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:54:13.816860 [info ] [MainThread]: 
[0m17:54:13.817434 [error] [MainThread]: [31mFailure in model int__regime_changes (models\silver\int\int__regime_changes.sql)[0m
[0m17:54:13.818016 [error] [MainThread]:   Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Parser Error: syntax error at or near "lead"
  
  LINE 20:     lead(regime) over(order by trade_date asc, loaded_at asc...
               ^
[0m17:54:13.818552 [info ] [MainThread]: 
[0m17:54:13.819117 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_changes.sql
[0m17:54:13.819595 [info ] [MainThread]: 
[0m17:54:13.820111 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m17:54:13.821025 [debug] [MainThread]: Command `-c run` failed at 17:54:13.820908 after 4.40 seconds
[0m17:54:13.821416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002474881F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024746837DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002474745FB60>]}
[0m17:54:13.821791 [debug] [MainThread]: Flushing usage events
[0m17:54:14.526737 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:54:26.294026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BCD78050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BD5842D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BDBC7ED0>]}


============================== 17:54:26.298702 | 193cf431-2ed9-4171-a5d9-97ce7899ebe1 ==============================
[0m17:54:26.298702 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:54:26.299499 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select +int__regime_changes', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m17:54:26.548769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '193cf431-2ed9-4171-a5d9-97ce7899ebe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BCF30180>]}
[0m17:54:26.614018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '193cf431-2ed9-4171-a5d9-97ce7899ebe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BDA6B790>]}
[0m17:54:26.616454 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:54:26.869414 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:54:27.258887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:27.259553 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:54:27.612608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '193cf431-2ed9-4171-a5d9-97ce7899ebe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BF465B50>]}
[0m17:54:27.744943 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:54:27.747658 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:54:27.778169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '193cf431-2ed9-4171-a5d9-97ce7899ebe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BEEF0B90>]}
[0m17:54:27.778631 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:54:27.779158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '193cf431-2ed9-4171-a5d9-97ce7899ebe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BDA83770>]}
[0m17:54:27.781442 [info ] [MainThread]: 
[0m17:54:27.782035 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:54:27.782517 [info ] [MainThread]: 
[0m17:54:27.783155 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:54:27.788262 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:54:27.864746 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:54:27.865153 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:54:27.865520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:29.219159 [debug] [ThreadPool]: SQL status: OK in 1.354 seconds
[0m17:54:29.220758 [debug] [ThreadPool]: On list_finance: Close
[0m17:54:29.221556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:54:29.222114 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:54:29.228846 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:54:29.229247 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:54:29.229555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:29.231122 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:54:29.232432 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:54:29.232745 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:54:29.233630 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:54:29.233935 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:54:29.234234 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:54:29.286838 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m17:54:29.287906 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:54:29.288278 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:54:29.288618 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:54:29.328318 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m17:54:29.328747 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:54:29.330803 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:54:29.336244 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:54:29.336586 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:54:29.336868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:29.337881 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:54:29.339869 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:54:29.340192 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:54:29.340474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:29.341142 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:54:29.341500 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:54:29.341802 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:54:29.342270 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:54:29.342601 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:54:29.342918 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:54:29.365861 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:54:29.366300 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:54:29.367599 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:54:29.368973 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:54:29.370237 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:54:29.370539 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:54:29.371022 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:54:29.371335 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:54:29.373594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '193cf431-2ed9-4171-a5d9-97ce7899ebe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BF14BAD0>]}
[0m17:54:29.374022 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:29.374311 [debug] [MainThread]: On master: BEGIN
[0m17:54:29.374584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:29.375669 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:54:29.375969 [debug] [MainThread]: On master: COMMIT
[0m17:54:29.376256 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:29.376532 [debug] [MainThread]: On master: COMMIT
[0m17:54:29.377102 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:29.377403 [debug] [MainThread]: On master: Close
[0m17:54:29.382172 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:54:29.382683 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:54:29.383329 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:54:29.383691 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:54:29.390486 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:54:29.391324 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:54:29.424092 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:54:29.425240 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:29.425677 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:54:29.426129 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:54:29.428415 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:54:29.428981 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:29.429596 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:54:29.490083 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m17:54:29.498781 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:29.499228 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:54:29.570856 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m17:54:29.582598 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:29.583727 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:54:29.649518 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m17:54:29.663985 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:54:29.664452 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:29.664852 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:54:29.804879 [debug] [Thread-1 (]: SQL status: OK in 0.139 seconds
[0m17:54:29.820374 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:29.821535 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:54:29.947032 [debug] [Thread-1 (]: SQL status: OK in 0.125 seconds
[0m17:54:29.949841 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:54:29.952050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '193cf431-2ed9-4171-a5d9-97ce7899ebe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BF8B1250>]}
[0m17:54:29.952709 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.57s]
[0m17:54:29.953523 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:54:29.954262 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:54:29.954749 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:54:29.955455 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:54:29.955829 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:54:29.958491 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:54:29.959317 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:54:29.962767 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:54:29.963744 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:29.964136 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:54:29.964479 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:54:29.965723 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:54:29.966131 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:29.966536 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:54:30.046348 [debug] [Thread-2 (]: SQL status: OK in 0.079 seconds
[0m17:54:30.050502 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:30.050943 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:54:30.115363 [debug] [Thread-2 (]: SQL status: OK in 0.064 seconds
[0m17:54:30.123178 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:30.124161 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:54:30.193081 [debug] [Thread-2 (]: SQL status: OK in 0.068 seconds
[0m17:54:30.198394 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:54:30.198903 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:30.199285 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:54:30.338230 [debug] [Thread-2 (]: SQL status: OK in 0.139 seconds
[0m17:54:30.340849 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:30.341259 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:54:30.547216 [debug] [Thread-2 (]: SQL status: OK in 0.205 seconds
[0m17:54:30.549142 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:54:30.549721 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '193cf431-2ed9-4171-a5d9-97ce7899ebe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BF994260>]}
[0m17:54:30.550321 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.59s]
[0m17:54:30.551117 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:54:30.551825 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:54:30.552297 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:54:30.553058 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:54:30.553435 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:54:30.556142 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:54:30.557002 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:54:30.560194 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:54:30.561013 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:54:30.561378 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:54:30.561718 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:54:30.562970 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:54:30.563376 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:54:30.563809 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime,
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 'TRUE'
            else 'FALSE'
        end) as changed ,
        (case
            when nxt_regime != regime or regime is null then trade_date
            else null
        end) as end_date
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        rank() over(partition by regime order by trade_date asc, loaded_at asc) as change_counter, 
        end_date
    from regime_changes
)

...


select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:54:30.570174 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime,
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 'TRUE'
            else 'FALSE'
        end) as changed ,
        (case
            when nxt_regime != regime or regime is null then trade_date
            else null
        end) as end_date
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        rank() over(partition by regime order by trade_date asc, loaded_at asc) as change_counter, 
        end_date
    from regime_changes
)

...


select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:54:30.570644 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:54:30.571102 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: ROLLBACK
[0m17:54:30.578142 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.int__regime_changes'
[0m17:54:30.578548 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:54:30.582617 [debug] [Thread-3 (]: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Parser Error: syntax error at or near ".."
  
  LINE 53: ...
           ^
[0m17:54:30.583111 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '193cf431-2ed9-4171-a5d9-97ce7899ebe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C0E5E170>]}
[0m17:54:30.583707 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model analytics_dev.int__regime_changes ......... [[31mERROR[0m in 0.03s]
[0m17:54:30.584516 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:54:30.585118 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_changes' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Parser Error: syntax error at or near ".."
  
  LINE 53: ...
           ^.
[0m17:54:30.587120 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:30.587579 [debug] [MainThread]: On master: BEGIN
[0m17:54:30.587869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:30.589014 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:54:30.589359 [debug] [MainThread]: On master: COMMIT
[0m17:54:30.589680 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:30.589989 [debug] [MainThread]: On master: COMMIT
[0m17:54:30.590702 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:30.591042 [debug] [MainThread]: On master: Close
[0m17:54:30.591465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:30.591757 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:54:30.592044 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:54:30.592322 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:54:30.592601 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:54:30.592882 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:54:30.593160 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:54:30.593526 [info ] [MainThread]: 
[0m17:54:30.594045 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m17:54:30.595186 [debug] [MainThread]: Command end result
[0m17:54:30.642316 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:54:30.644677 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:54:30.657811 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:54:30.658192 [info ] [MainThread]: 
[0m17:54:30.658758 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:54:30.659306 [info ] [MainThread]: 
[0m17:54:30.659862 [error] [MainThread]: [31mFailure in model int__regime_changes (models\silver\int\int__regime_changes.sql)[0m
[0m17:54:30.660417 [error] [MainThread]:   Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Parser Error: syntax error at or near ".."
  
  LINE 53: ...
           ^
[0m17:54:30.660955 [info ] [MainThread]: 
[0m17:54:30.661469 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_changes.sql
[0m17:54:30.661917 [info ] [MainThread]: 
[0m17:54:30.662399 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m17:54:30.663291 [debug] [MainThread]: Command `-c run` failed at 17:54:30.663166 after 4.50 seconds
[0m17:54:30.663684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BEEAF9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BCEAFDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BDACFB60>]}
[0m17:54:30.664056 [debug] [MainThread]: Flushing usage events
[0m17:54:31.470149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:54:46.044548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241B7768050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241B7F742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241B85B7ED0>]}


============================== 17:54:46.049906 | 7c928fc7-63e1-433d-aa1f-00bdff1ed41b ==============================
[0m17:54:46.049906 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:54:46.050868 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select +int__regime_changes', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'write_json': 'True', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:54:46.321053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c928fc7-63e1-433d-aa1f-00bdff1ed41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241B7920180>]}
[0m17:54:46.391719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c928fc7-63e1-433d-aa1f-00bdff1ed41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241B845B790>]}
[0m17:54:46.394343 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:54:46.674592 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:54:47.170538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:47.171221 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:54:47.556448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c928fc7-63e1-433d-aa1f-00bdff1ed41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241B9EA5B50>]}
[0m17:54:47.696963 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:54:47.699833 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:54:47.732121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c928fc7-63e1-433d-aa1f-00bdff1ed41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241B9904B90>]}
[0m17:54:47.732667 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:54:47.733243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c928fc7-63e1-433d-aa1f-00bdff1ed41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241B8473770>]}
[0m17:54:47.735382 [info ] [MainThread]: 
[0m17:54:47.735934 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:54:47.736421 [info ] [MainThread]: 
[0m17:54:47.737106 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:54:47.741905 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:54:47.827372 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:54:47.827784 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:54:47.828095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:49.372290 [debug] [ThreadPool]: SQL status: OK in 1.544 seconds
[0m17:54:49.373691 [debug] [ThreadPool]: On list_finance: Close
[0m17:54:49.374368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:54:49.374832 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:54:49.380929 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:54:49.381307 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:54:49.381611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:49.383134 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:54:49.384395 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:54:49.384697 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:54:49.385632 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:54:49.385930 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:54:49.386311 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:54:49.445339 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m17:54:49.449124 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:54:49.450403 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:54:49.451601 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:54:49.502541 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m17:54:49.504096 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:54:49.511932 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:54:49.530969 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:54:49.532017 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:54:49.532979 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:54:49.536991 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:54:49.537735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:49.538419 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:54:49.539318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:49.540446 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:54:49.540981 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:54:49.541506 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:54:49.542058 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:54:49.542873 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:54:49.543415 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:54:49.569907 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m17:54:49.570415 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m17:54:49.571616 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:54:49.572901 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:54:49.574073 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:54:49.574382 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:54:49.574898 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:54:49.575200 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:54:49.577349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c928fc7-63e1-433d-aa1f-00bdff1ed41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241B9B47930>]}
[0m17:54:49.577797 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:49.578110 [debug] [MainThread]: On master: BEGIN
[0m17:54:49.578405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:49.579730 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:54:49.580054 [debug] [MainThread]: On master: COMMIT
[0m17:54:49.580351 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:49.580633 [debug] [MainThread]: On master: COMMIT
[0m17:54:49.581184 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:49.581491 [debug] [MainThread]: On master: Close
[0m17:54:49.586168 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:54:49.586672 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:54:49.587345 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:54:49.587709 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:54:49.594616 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:54:49.595950 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:54:49.625933 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:54:49.626851 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:49.627209 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:54:49.627536 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:54:49.628883 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:54:49.629242 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:49.629588 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:54:49.808233 [debug] [Thread-1 (]: SQL status: OK in 0.178 seconds
[0m17:54:49.821066 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:49.821487 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:54:49.874435 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m17:54:49.879126 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:49.879669 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:54:49.945295 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m17:54:49.957214 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:54:49.957645 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:49.957986 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:54:50.072114 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m17:54:50.078445 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:54:50.079076 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:54:50.203909 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m17:54:50.206209 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:54:50.208209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c928fc7-63e1-433d-aa1f-00bdff1ed41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241BA2A1250>]}
[0m17:54:50.208820 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.62s]
[0m17:54:50.209633 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:54:50.210372 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:54:50.210847 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:54:50.211471 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:54:50.211871 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:54:50.214749 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:54:50.215785 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:54:50.219566 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:54:50.220471 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:50.220834 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:54:50.221167 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:54:50.222491 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:54:50.222845 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:50.223213 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:54:50.408426 [debug] [Thread-2 (]: SQL status: OK in 0.185 seconds
[0m17:54:50.412427 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:50.412928 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:54:50.476623 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m17:54:50.483639 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:50.484538 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:54:50.553541 [debug] [Thread-2 (]: SQL status: OK in 0.068 seconds
[0m17:54:50.554959 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:54:50.555351 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:50.555713 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:54:50.756645 [debug] [Thread-2 (]: SQL status: OK in 0.201 seconds
[0m17:54:50.759195 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:54:50.759623 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:54:50.882937 [debug] [Thread-2 (]: SQL status: OK in 0.123 seconds
[0m17:54:50.884665 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:54:50.885271 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c928fc7-63e1-433d-aa1f-00bdff1ed41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241BA394260>]}
[0m17:54:50.885896 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.67s]
[0m17:54:50.886748 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:54:50.887442 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:54:50.887937 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:54:50.888623 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:54:50.889000 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:54:50.891694 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:54:50.892628 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:54:50.895818 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:54:50.896675 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:54:50.897126 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:54:50.897496 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:54:50.898799 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:54:50.899201 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:54:50.899603 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime,
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 'TRUE'
            else 'FALSE'
        end) as changed ,
        (case
            when nxt_regime != regime or regime is null then trade_date
            else null
        end) as end_date
from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        rank() over(partition by regime order by trade_date asc, loaded_at asc) as change_counter, 
        end_date
    from regime_changes
)

select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:54:51.094014 [debug] [Thread-3 (]: SQL status: OK in 0.194 seconds
[0m17:54:51.098901 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:54:51.099553 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m17:54:51.171651 [debug] [Thread-3 (]: SQL status: OK in 0.071 seconds
[0m17:54:51.185538 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:54:51.186512 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m17:54:51.267317 [debug] [Thread-3 (]: SQL status: OK in 0.080 seconds
[0m17:54:51.272616 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:54:51.274275 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:54:51.276027 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m17:54:51.408458 [debug] [Thread-3 (]: SQL status: OK in 0.131 seconds
[0m17:54:51.410702 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:54:51.411059 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m17:54:51.533185 [debug] [Thread-3 (]: SQL status: OK in 0.122 seconds
[0m17:54:51.534536 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:54:51.535032 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c928fc7-63e1-433d-aa1f-00bdff1ed41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241BA3A31B0>]}
[0m17:54:51.535594 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.65s]
[0m17:54:51.536425 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:54:51.537910 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:51.538232 [debug] [MainThread]: On master: BEGIN
[0m17:54:51.538514 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:51.539690 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:54:51.539996 [debug] [MainThread]: On master: COMMIT
[0m17:54:51.540286 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:51.540564 [debug] [MainThread]: On master: COMMIT
[0m17:54:51.541168 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:51.541476 [debug] [MainThread]: On master: Close
[0m17:54:51.541843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:51.542186 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:54:51.542539 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:54:51.542822 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:54:51.543295 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:54:51.543841 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:54:51.544365 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:54:51.544995 [info ] [MainThread]: 
[0m17:54:51.545662 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m17:54:51.547403 [debug] [MainThread]: Command end result
[0m17:54:51.604762 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:54:51.607220 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:54:51.613406 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:54:51.613767 [info ] [MainThread]: 
[0m17:54:51.614350 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:51.614839 [info ] [MainThread]: 
[0m17:54:51.615359 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:54:51.616233 [debug] [MainThread]: Command `-c run` succeeded at 17:54:51.616119 after 5.74 seconds
[0m17:54:51.616590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241B9708450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241B98AF9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241B84BFB60>]}
[0m17:54:51.616948 [debug] [MainThread]: Flushing usage events
[0m17:54:52.274075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:46.795989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017090688050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017090E942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170914D3ED0>]}


============================== 17:59:46.800575 | 021dc710-b8ab-4b1a-845a-d1a58f849936 ==============================
[0m17:59:46.800575 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:59:46.801274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select +int__regime_changes', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:59:47.045464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '021dc710-b8ab-4b1a-845a-d1a58f849936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017090840180>]}
[0m17:59:47.110348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '021dc710-b8ab-4b1a-845a-d1a58f849936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001709137B790>]}
[0m17:59:47.112799 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:59:47.374654 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:59:47.780410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:59:47.781056 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m17:59:48.119976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '021dc710-b8ab-4b1a-845a-d1a58f849936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017092E31B50>]}
[0m17:59:48.245009 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:59:48.247390 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:59:48.276598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '021dc710-b8ab-4b1a-845a-d1a58f849936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017092880B90>]}
[0m17:59:48.277051 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m17:59:48.277563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '021dc710-b8ab-4b1a-845a-d1a58f849936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017091393770>]}
[0m17:59:48.279499 [info ] [MainThread]: 
[0m17:59:48.279985 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:59:48.280445 [info ] [MainThread]: 
[0m17:59:48.281068 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:59:48.285894 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m17:59:48.363378 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m17:59:48.363766 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m17:59:48.364074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:49.496814 [debug] [ThreadPool]: SQL status: OK in 1.133 seconds
[0m17:59:49.498314 [debug] [ThreadPool]: On list_finance: Close
[0m17:59:49.499288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m17:59:49.499881 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m17:59:49.506677 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:59:49.507060 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m17:59:49.507361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:49.508830 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:59:49.510157 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:59:49.510473 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m17:59:49.511418 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:59:49.511728 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:59:49.512027 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m17:59:49.564023 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m17:59:49.568108 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:59:49.569511 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m17:59:49.570796 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m17:59:49.613414 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m17:59:49.615022 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m17:59:49.622894 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m17:59:49.631448 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m17:59:49.643969 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:59:49.648284 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:59:49.648985 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m17:59:49.649659 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m17:59:49.650330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:49.651095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:49.652706 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:59:49.653196 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m17:59:49.653685 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m17:59:49.654418 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:59:49.654951 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m17:59:49.655465 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m17:59:49.681131 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m17:59:49.681604 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m17:59:49.682851 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m17:59:49.684125 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m17:59:49.685323 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m17:59:49.685623 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m17:59:49.686097 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m17:59:49.686409 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m17:59:49.688619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '021dc710-b8ab-4b1a-845a-d1a58f849936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017092AD7930>]}
[0m17:59:49.689041 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:49.689388 [debug] [MainThread]: On master: BEGIN
[0m17:59:49.689710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:49.690986 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:59:49.691298 [debug] [MainThread]: On master: COMMIT
[0m17:59:49.691653 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:49.691988 [debug] [MainThread]: On master: COMMIT
[0m17:59:49.692598 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:49.692906 [debug] [MainThread]: On master: Close
[0m17:59:49.697652 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m17:59:49.698167 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m17:59:49.698858 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m17:59:49.699226 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m17:59:49.706026 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m17:59:49.706828 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m17:59:49.746171 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m17:59:49.747101 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:59:49.747461 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m17:59:49.747787 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:49.749145 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:59:49.749538 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:59:49.749915 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m17:59:49.805710 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m17:59:49.812623 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:59:49.813070 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m17:59:49.874266 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m17:59:49.880833 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:59:49.881657 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m17:59:49.936232 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m17:59:49.947774 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:59:49.948153 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:59:49.948483 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m17:59:50.069507 [debug] [Thread-1 (]: SQL status: OK in 0.121 seconds
[0m17:59:50.075262 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m17:59:50.075875 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m17:59:50.208971 [debug] [Thread-1 (]: SQL status: OK in 0.133 seconds
[0m17:59:50.211273 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m17:59:50.213247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '021dc710-b8ab-4b1a-845a-d1a58f849936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017093241250>]}
[0m17:59:50.213830 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.51s]
[0m17:59:50.214623 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m17:59:50.215437 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m17:59:50.215914 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m17:59:50.216681 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m17:59:50.217048 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m17:59:50.219900 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m17:59:50.221033 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m17:59:50.224403 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m17:59:50.225537 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:59:50.226111 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m17:59:50.226557 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:59:50.227867 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:59:50.228281 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:59:50.228711 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m17:59:50.317009 [debug] [Thread-2 (]: SQL status: OK in 0.088 seconds
[0m17:59:50.323160 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:59:50.323978 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m17:59:50.418265 [debug] [Thread-2 (]: SQL status: OK in 0.093 seconds
[0m17:59:50.431142 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:59:50.432817 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m17:59:50.505791 [debug] [Thread-2 (]: SQL status: OK in 0.072 seconds
[0m17:59:50.511152 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:59:50.513128 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:59:50.514890 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m17:59:50.711284 [debug] [Thread-2 (]: SQL status: OK in 0.195 seconds
[0m17:59:50.713858 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m17:59:50.714244 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m17:59:50.823643 [debug] [Thread-2 (]: SQL status: OK in 0.109 seconds
[0m17:59:50.825259 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m17:59:50.825766 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '021dc710-b8ab-4b1a-845a-d1a58f849936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170932FC260>]}
[0m17:59:50.826332 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.61s]
[0m17:59:50.827278 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m17:59:50.827969 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m17:59:50.828443 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m17:59:50.829106 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m17:59:50.829458 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m17:59:50.832029 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m17:59:50.832865 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m17:59:50.836133 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m17:59:50.836930 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:59:50.837290 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m17:59:50.837627 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:59:50.838873 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:59:50.839242 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m17:59:50.839624 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime,
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(case when changed = 1 then changed else 0 end) over(order by trade_date asc, loaded_at asc) as change_counter, 
        end_date
    from regime_changes
)

select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:59:50.895747 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime,
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(case when changed = 1 then changed else 0 end) over(order by trade_date asc, loaded_at asc) as change_counter, 
        end_date
    from regime_changes
)

select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m17:59:50.896248 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:50.896702 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: ROLLBACK
[0m17:59:50.903737 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.int__regime_changes'
[0m17:59:50.904143 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m17:59:50.908493 [debug] [Thread-3 (]: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: Referenced column "end_date" not found in FROM clause!
  Candidate bindings: "trade_date", "loaded_at", "prev_regime", "regime", "changed"
  
  LINE 45:         end_date
                   ^
[0m17:59:50.908942 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '021dc710-b8ab-4b1a-845a-d1a58f849936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170947DE170>]}
[0m17:59:50.909764 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model analytics_dev.int__regime_changes ......... [[31mERROR[0m in 0.08s]
[0m17:59:50.910589 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m17:59:50.911176 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_changes' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: Referenced column "end_date" not found in FROM clause!
  Candidate bindings: "trade_date", "loaded_at", "prev_regime", "regime", "changed"
  
  LINE 45:         end_date
                   ^.
[0m17:59:50.913201 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:50.913524 [debug] [MainThread]: On master: BEGIN
[0m17:59:50.913818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:50.915083 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:59:50.915501 [debug] [MainThread]: On master: COMMIT
[0m17:59:50.915798 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:50.916082 [debug] [MainThread]: On master: COMMIT
[0m17:59:50.916645 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:50.916949 [debug] [MainThread]: On master: Close
[0m17:59:50.917325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:50.917600 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m17:59:50.917863 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m17:59:50.918129 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m17:59:50.918393 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m17:59:50.918654 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m17:59:50.918912 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m17:59:50.919250 [info ] [MainThread]: 
[0m17:59:50.919730 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.64 seconds (2.64s).
[0m17:59:50.921529 [debug] [MainThread]: Command end result
[0m17:59:50.969664 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m17:59:50.972057 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m17:59:50.977844 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m17:59:50.978177 [info ] [MainThread]: 
[0m17:59:50.978805 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:59:50.979312 [info ] [MainThread]: 
[0m17:59:50.979880 [error] [MainThread]: [31mFailure in model int__regime_changes (models\silver\int\int__regime_changes.sql)[0m
[0m17:59:50.980443 [error] [MainThread]:   Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: Referenced column "end_date" not found in FROM clause!
  Candidate bindings: "trade_date", "loaded_at", "prev_regime", "regime", "changed"
  
  LINE 45:         end_date
                   ^
[0m17:59:50.980977 [info ] [MainThread]: 
[0m17:59:50.981588 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_changes.sql
[0m17:59:50.982101 [info ] [MainThread]: 
[0m17:59:50.982620 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m17:59:50.983529 [debug] [MainThread]: Command `-c run` failed at 17:59:50.983415 after 4.36 seconds
[0m17:59:50.983898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001709283F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170907BFDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170913DBB60>]}
[0m17:59:50.984255 [debug] [MainThread]: Flushing usage events
[0m17:59:51.778489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:02.000765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACC9C68050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACCA4742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACCAAB3ED0>]}


============================== 18:00:02.005404 | 421ad71e-6b84-4a3b-810e-0c5ff895bd7a ==============================
[0m18:00:02.005404 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:00:02.006126 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select +int__regime_changes', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m18:00:02.265169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '421ad71e-6b84-4a3b-810e-0c5ff895bd7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACC9E20180>]}
[0m18:00:02.332854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '421ad71e-6b84-4a3b-810e-0c5ff895bd7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACCA95B790>]}
[0m18:00:02.335575 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:00:02.600828 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:00:02.998265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:02.999096 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m18:00:03.343713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '421ad71e-6b84-4a3b-810e-0c5ff895bd7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACCC33DB50>]}
[0m18:00:03.470267 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:00:03.472768 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:00:03.501848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '421ad71e-6b84-4a3b-810e-0c5ff895bd7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACCBD90B90>]}
[0m18:00:03.502308 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m18:00:03.502818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421ad71e-6b84-4a3b-810e-0c5ff895bd7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACCA973770>]}
[0m18:00:03.504844 [info ] [MainThread]: 
[0m18:00:03.505344 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:00:03.505803 [info ] [MainThread]: 
[0m18:00:03.506468 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:00:03.511379 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m18:00:03.586642 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m18:00:03.587035 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m18:00:03.587352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:05.351846 [debug] [ThreadPool]: SQL status: OK in 1.764 seconds
[0m18:00:05.353150 [debug] [ThreadPool]: On list_finance: Close
[0m18:00:05.353828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m18:00:05.354284 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m18:00:05.360440 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:00:05.360782 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m18:00:05.361132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:05.362763 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:00:05.363976 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:00:05.364265 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m18:00:05.365314 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:00:05.365599 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:00:05.365884 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m18:00:05.422348 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m18:00:05.424085 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:00:05.424811 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:00:05.425401 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:00:05.479383 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m18:00:05.480907 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m18:00:05.488805 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m18:00:05.498075 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m18:00:05.500429 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:00:05.502385 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:00:05.502847 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m18:00:05.503212 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m18:00:05.503568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:05.503925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:05.505142 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:00:05.505444 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:00:05.505743 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m18:00:05.506206 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:00:05.506529 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:00:05.506841 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m18:00:05.530412 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m18:00:05.530805 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m18:00:05.532051 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m18:00:05.533325 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m18:00:05.534408 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m18:00:05.534712 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m18:00:05.535188 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m18:00:05.535495 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m18:00:05.537754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421ad71e-6b84-4a3b-810e-0c5ff895bd7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACCBFE7860>]}
[0m18:00:05.538192 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:05.538497 [debug] [MainThread]: On master: BEGIN
[0m18:00:05.538795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:05.540048 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:00:05.540350 [debug] [MainThread]: On master: COMMIT
[0m18:00:05.540639 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:05.540914 [debug] [MainThread]: On master: COMMIT
[0m18:00:05.541454 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:05.541755 [debug] [MainThread]: On master: Close
[0m18:00:05.546341 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m18:00:05.546844 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m18:00:05.547515 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m18:00:05.547871 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m18:00:05.554574 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m18:00:05.555406 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m18:00:05.586427 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m18:00:05.587352 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:00:05.587712 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m18:00:05.588045 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:00:05.589457 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:05.589807 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:00:05.590150 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m18:00:05.760784 [debug] [Thread-1 (]: SQL status: OK in 0.170 seconds
[0m18:00:05.766828 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:00:05.767210 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m18:00:05.824077 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m18:00:05.827425 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:00:05.827803 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m18:00:05.883378 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m18:00:05.896167 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:00:05.896573 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:00:05.896907 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:00:06.036654 [debug] [Thread-1 (]: SQL status: OK in 0.139 seconds
[0m18:00:06.042710 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:00:06.043349 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m18:00:06.178557 [debug] [Thread-1 (]: SQL status: OK in 0.135 seconds
[0m18:00:06.182496 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m18:00:06.186090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421ad71e-6b84-4a3b-810e-0c5ff895bd7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACCC74D250>]}
[0m18:00:06.187192 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.64s]
[0m18:00:06.188551 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m18:00:06.189731 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m18:00:06.190582 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m18:00:06.191849 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m18:00:06.192513 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m18:00:06.196072 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m18:00:06.196881 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m18:00:06.201087 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m18:00:06.202129 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:00:06.202545 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m18:00:06.202893 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:00:06.204724 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:00:06.205181 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:00:06.205579 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m18:00:06.359245 [debug] [Thread-2 (]: SQL status: OK in 0.153 seconds
[0m18:00:06.365813 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:00:06.366604 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m18:00:06.434803 [debug] [Thread-2 (]: SQL status: OK in 0.067 seconds
[0m18:00:06.439536 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:00:06.439909 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m18:00:06.495986 [debug] [Thread-2 (]: SQL status: OK in 0.056 seconds
[0m18:00:06.498872 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m18:00:06.499241 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:00:06.499578 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m18:00:06.714305 [debug] [Thread-2 (]: SQL status: OK in 0.214 seconds
[0m18:00:06.716848 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:00:06.717235 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m18:00:06.840096 [debug] [Thread-2 (]: SQL status: OK in 0.122 seconds
[0m18:00:06.841695 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m18:00:06.842193 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421ad71e-6b84-4a3b-810e-0c5ff895bd7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACCC834260>]}
[0m18:00:06.842754 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.65s]
[0m18:00:06.843584 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m18:00:06.844342 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m18:00:06.844847 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m18:00:06.845681 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m18:00:06.846025 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m18:00:06.848857 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m18:00:06.850039 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m18:00:06.853935 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m18:00:06.855563 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:00:06.856004 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m18:00:06.856346 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:00:06.857691 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:00:06.858124 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:00:06.858503 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime,
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(case when changed = 1 then changed else 0 end) over(order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

select *
from regime_change_count
order by trade_date asc, loaded_at asc
  );

[0m18:00:06.970407 [debug] [Thread-3 (]: SQL status: OK in 0.111 seconds
[0m18:00:06.973348 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:00:06.973730 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m18:00:07.034750 [debug] [Thread-3 (]: SQL status: OK in 0.061 seconds
[0m18:00:07.040139 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:00:07.040532 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m18:00:07.100614 [debug] [Thread-3 (]: SQL status: OK in 0.060 seconds
[0m18:00:07.102281 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m18:00:07.102734 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:00:07.103142 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m18:00:07.233214 [debug] [Thread-3 (]: SQL status: OK in 0.129 seconds
[0m18:00:07.235891 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:00:07.236407 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m18:00:07.351038 [debug] [Thread-3 (]: SQL status: OK in 0.114 seconds
[0m18:00:07.352430 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m18:00:07.352937 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421ad71e-6b84-4a3b-810e-0c5ff895bd7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACCC843070>]}
[0m18:00:07.353503 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.51s]
[0m18:00:07.354306 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m18:00:07.355820 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:07.356143 [debug] [MainThread]: On master: BEGIN
[0m18:00:07.356435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:07.357633 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:00:07.357934 [debug] [MainThread]: On master: COMMIT
[0m18:00:07.358220 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:07.358493 [debug] [MainThread]: On master: COMMIT
[0m18:00:07.359031 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:07.359328 [debug] [MainThread]: On master: Close
[0m18:00:07.359686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:07.359955 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m18:00:07.360212 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m18:00:07.360677 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m18:00:07.361019 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m18:00:07.361379 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m18:00:07.361632 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m18:00:07.361976 [info ] [MainThread]: 
[0m18:00:07.362473 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m18:00:07.363668 [debug] [MainThread]: Command end result
[0m18:00:07.410100 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:00:07.412379 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:00:07.418577 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m18:00:07.418932 [info ] [MainThread]: 
[0m18:00:07.419479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:07.419939 [info ] [MainThread]: 
[0m18:00:07.420445 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m18:00:07.421397 [debug] [MainThread]: Command `-c run` succeeded at 18:00:07.421282 after 5.55 seconds
[0m18:00:07.421758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACCBC1C450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACCBD52FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACCA9BBB60>]}
[0m18:00:07.422109 [debug] [MainThread]: Flushing usage events
[0m18:00:08.276195 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:08.503212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B009E38050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B00A6442D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B00AC87ED0>]}


============================== 18:07:08.507591 | c524fe98-f270-4d0b-b2a0-1c25a61d2ffd ==============================
[0m18:07:08.507591 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:07:08.508296 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'invocation_command': 'dbt run --select +int__regime_changes', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m18:07:08.754292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c524fe98-f270-4d0b-b2a0-1c25a61d2ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B009FF0180>]}
[0m18:07:08.818920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c524fe98-f270-4d0b-b2a0-1c25a61d2ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B00AB2B790>]}
[0m18:07:08.821442 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:07:09.077930 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:07:09.460548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:07:09.461221 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m18:07:09.807979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c524fe98-f270-4d0b-b2a0-1c25a61d2ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B00C531B50>]}
[0m18:07:09.934146 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:07:09.936605 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:07:09.966012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c524fe98-f270-4d0b-b2a0-1c25a61d2ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B00BF80B90>]}
[0m18:07:09.966477 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m18:07:09.967000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c524fe98-f270-4d0b-b2a0-1c25a61d2ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B00AB43770>]}
[0m18:07:09.969092 [info ] [MainThread]: 
[0m18:07:09.969612 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:07:09.970095 [info ] [MainThread]: 
[0m18:07:09.970863 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:07:09.975456 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m18:07:10.059645 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m18:07:10.060029 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m18:07:10.060343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:11.236200 [debug] [ThreadPool]: SQL status: OK in 1.176 seconds
[0m18:07:11.237813 [debug] [ThreadPool]: On list_finance: Close
[0m18:07:11.238605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m18:07:11.239166 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m18:07:11.245641 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:07:11.245974 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m18:07:11.246324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:11.247853 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:07:11.249094 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:07:11.249396 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m18:07:11.250336 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:11.250636 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:07:11.250927 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m18:07:11.295677 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m18:07:11.296754 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:07:11.297103 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:07:11.297418 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:07:11.347139 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m18:07:11.348083 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m18:07:11.353114 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m18:07:11.360104 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m18:07:11.362645 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:07:11.364552 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:07:11.364998 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m18:07:11.365357 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m18:07:11.365710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:11.366066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:11.367231 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:11.367611 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:07:11.367937 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m18:07:11.368502 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:07:11.368848 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:07:11.369169 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m18:07:11.393520 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m18:07:11.393977 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m18:07:11.395137 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m18:07:11.396404 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m18:07:11.397779 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m18:07:11.398077 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m18:07:11.398583 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m18:07:11.398878 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m18:07:11.401422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c524fe98-f270-4d0b-b2a0-1c25a61d2ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B00C1DB930>]}
[0m18:07:11.401838 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:11.402121 [debug] [MainThread]: On master: BEGIN
[0m18:07:11.402785 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:11.404133 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:07:11.404522 [debug] [MainThread]: On master: COMMIT
[0m18:07:11.404930 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:11.405480 [debug] [MainThread]: On master: COMMIT
[0m18:07:11.406219 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:11.406511 [debug] [MainThread]: On master: Close
[0m18:07:11.411263 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m18:07:11.411755 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m18:07:11.412604 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m18:07:11.412941 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m18:07:11.419533 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m18:07:11.420378 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m18:07:11.453403 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m18:07:11.454326 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:07:11.454693 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m18:07:11.455028 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:07:11.456374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:07:11.456771 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:07:11.457151 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m18:07:11.514599 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m18:07:11.520989 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:07:11.521398 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m18:07:11.574944 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m18:07:11.581083 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:07:11.581812 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m18:07:11.637460 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m18:07:11.648378 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:07:11.648766 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:07:11.649101 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:07:11.759563 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m18:07:11.765501 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:07:11.766280 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m18:07:11.884022 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m18:07:11.886479 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m18:07:11.888610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c524fe98-f270-4d0b-b2a0-1c25a61d2ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B00C931250>]}
[0m18:07:11.889244 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.47s]
[0m18:07:11.890055 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m18:07:11.890829 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m18:07:11.891306 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m18:07:11.892050 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m18:07:11.892416 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m18:07:11.894973 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m18:07:11.895809 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m18:07:11.898917 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m18:07:11.899712 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:07:11.900070 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m18:07:11.900404 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:07:11.901823 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:07:11.902202 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:07:11.902594 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m18:07:11.988384 [debug] [Thread-2 (]: SQL status: OK in 0.085 seconds
[0m18:07:11.991401 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:07:11.991900 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m18:07:12.046361 [debug] [Thread-2 (]: SQL status: OK in 0.054 seconds
[0m18:07:12.049744 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:07:12.050169 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m18:07:12.102465 [debug] [Thread-2 (]: SQL status: OK in 0.052 seconds
[0m18:07:12.103916 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m18:07:12.104334 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:07:12.104706 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m18:07:12.283385 [debug] [Thread-2 (]: SQL status: OK in 0.178 seconds
[0m18:07:12.286167 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:07:12.286612 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m18:07:12.400594 [debug] [Thread-2 (]: SQL status: OK in 0.114 seconds
[0m18:07:12.402383 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m18:07:12.402958 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c524fe98-f270-4d0b-b2a0-1c25a61d2ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B00CA00260>]}
[0m18:07:12.403588 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.51s]
[0m18:07:12.404418 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m18:07:12.405145 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m18:07:12.405642 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m18:07:12.406375 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m18:07:12.406769 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m18:07:12.409591 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m18:07:12.410568 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m18:07:12.414058 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m18:07:12.415146 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:07:12.415675 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m18:07:12.416057 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:07:12.417412 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:07:12.417933 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:07:12.418379 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime,
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(case when changed = 1 then changed else 0 end) over(order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        change_counter,
        count(*), 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    group by change_counter, regime
  );

[0m18:07:12.492039 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime,
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(case when changed = 1 then changed else 0 end) over(order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        change_counter,
        count(*), 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    group by change_counter, regime
  );

[0m18:07:12.492588 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m18:07:12.493086 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: ROLLBACK
[0m18:07:12.500626 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.int__regime_changes'
[0m18:07:12.501114 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m18:07:12.505876 [debug] [Thread-3 (]: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: column "trade_date" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(trade_date)" if the exact value of "trade_date" is not important.
  
  LINE 49:         trade_date, 
                   ^
[0m18:07:12.506457 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c524fe98-f270-4d0b-b2a0-1c25a61d2ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B00DF1DBD0>]}
[0m18:07:12.507094 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model analytics_dev.int__regime_changes ......... [[31mERROR[0m in 0.10s]
[0m18:07:12.507947 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m18:07:12.508552 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_changes' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: column "trade_date" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(trade_date)" if the exact value of "trade_date" is not important.
  
  LINE 49:         trade_date, 
                   ^.
[0m18:07:12.510551 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:12.510918 [debug] [MainThread]: On master: BEGIN
[0m18:07:12.511222 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:12.512349 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:07:12.512681 [debug] [MainThread]: On master: COMMIT
[0m18:07:12.513000 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:12.513307 [debug] [MainThread]: On master: COMMIT
[0m18:07:12.513917 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:12.514246 [debug] [MainThread]: On master: Close
[0m18:07:12.514655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:12.514949 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m18:07:12.515234 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m18:07:12.515514 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m18:07:12.515797 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m18:07:12.516082 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m18:07:12.516367 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m18:07:12.516746 [info ] [MainThread]: 
[0m18:07:12.517275 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.55 seconds (2.55s).
[0m18:07:12.518573 [debug] [MainThread]: Command end result
[0m18:07:12.568167 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:07:12.571103 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:07:12.577346 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m18:07:12.577721 [info ] [MainThread]: 
[0m18:07:12.578356 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:07:12.578885 [info ] [MainThread]: 
[0m18:07:12.579490 [error] [MainThread]: [31mFailure in model int__regime_changes (models\silver\int\int__regime_changes.sql)[0m
[0m18:07:12.580070 [error] [MainThread]:   Runtime Error in model int__regime_changes (models\silver\int\int__regime_changes.sql)
  Binder Error: column "trade_date" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(trade_date)" if the exact value of "trade_date" is not important.
  
  LINE 49:         trade_date, 
                   ^
[0m18:07:12.580624 [info ] [MainThread]: 
[0m18:07:12.581195 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_changes.sql
[0m18:07:12.581680 [info ] [MainThread]: 
[0m18:07:12.582209 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m18:07:12.583229 [debug] [MainThread]: Command `-c run` failed at 18:07:12.583087 after 4.25 seconds
[0m18:07:12.583644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B00BF3F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B009F6FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B00AB8FB60>]}
[0m18:07:12.584023 [debug] [MainThread]: Flushing usage events
[0m18:07:13.314870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:59.013809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020056668050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020056E742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200574B7ED0>]}


============================== 18:07:59.018148 | 83ecd527-a827-481c-8aaa-4bbdef846428 ==============================
[0m18:07:59.018148 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:07:59.019192 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select +int__regime_changes', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m18:07:59.269523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83ecd527-a827-481c-8aaa-4bbdef846428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020056820180>]}
[0m18:07:59.335309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83ecd527-a827-481c-8aaa-4bbdef846428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005735B790>]}
[0m18:07:59.337909 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:07:59.598833 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:08:00.011268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:08:00.011961 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m18:08:00.363422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83ecd527-a827-481c-8aaa-4bbdef846428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020058CF1B50>]}
[0m18:08:00.490232 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:08:00.492675 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:08:00.523029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83ecd527-a827-481c-8aaa-4bbdef846428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020058790B90>]}
[0m18:08:00.523491 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m18:08:00.524007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83ecd527-a827-481c-8aaa-4bbdef846428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020057373770>]}
[0m18:08:00.525962 [info ] [MainThread]: 
[0m18:08:00.526451 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:08:00.526907 [info ] [MainThread]: 
[0m18:08:00.527521 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:08:00.532200 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m18:08:00.608514 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m18:08:00.608897 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m18:08:00.609205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:01.880325 [debug] [ThreadPool]: SQL status: OK in 1.271 seconds
[0m18:08:01.881753 [debug] [ThreadPool]: On list_finance: Close
[0m18:08:01.882443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m18:08:01.882924 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m18:08:01.889116 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:08:01.889550 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m18:08:01.889993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:01.891701 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:08:01.893164 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:08:01.893503 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m18:08:01.894602 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:08:01.895013 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:08:01.895314 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m18:08:01.945266 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m18:08:01.946210 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:08:01.946530 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:08:01.946824 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:08:01.993825 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m18:08:01.994265 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m18:08:01.996350 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m18:08:02.001898 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:08:02.002244 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m18:08:02.002531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:02.003331 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m18:08:02.005377 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:08:02.005702 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m18:08:02.005986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:02.006636 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:08:02.006995 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:08:02.007325 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m18:08:02.007921 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:08:02.008249 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:08:02.008569 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m18:08:02.032900 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m18:08:02.034259 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m18:08:02.034717 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m18:08:02.036096 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m18:08:02.037232 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m18:08:02.037589 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m18:08:02.038089 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m18:08:02.038407 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m18:08:02.040956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83ecd527-a827-481c-8aaa-4bbdef846428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200589EBBA0>]}
[0m18:08:02.041464 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:02.041783 [debug] [MainThread]: On master: BEGIN
[0m18:08:02.042087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:02.043271 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:08:02.043623 [debug] [MainThread]: On master: COMMIT
[0m18:08:02.043939 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:02.044243 [debug] [MainThread]: On master: COMMIT
[0m18:08:02.044928 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:02.045250 [debug] [MainThread]: On master: Close
[0m18:08:02.049943 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m18:08:02.050552 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m18:08:02.051319 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m18:08:02.051696 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m18:08:02.058874 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m18:08:02.059910 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m18:08:02.090387 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m18:08:02.091336 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:08:02.091707 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m18:08:02.092043 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:08:02.093494 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.093909 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:08:02.094280 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m18:08:02.151806 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m18:08:02.157919 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:08:02.158335 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m18:08:02.214454 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m18:08:02.217643 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:08:02.218024 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m18:08:02.276147 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m18:08:02.288312 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:08:02.288752 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:08:02.289093 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:08:02.422234 [debug] [Thread-1 (]: SQL status: OK in 0.133 seconds
[0m18:08:02.427720 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:08:02.428376 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m18:08:02.565274 [debug] [Thread-1 (]: SQL status: OK in 0.136 seconds
[0m18:08:02.567865 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m18:08:02.570189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ecd527-a827-481c-8aaa-4bbdef846428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020059141250>]}
[0m18:08:02.570912 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.52s]
[0m18:08:02.571752 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m18:08:02.572532 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m18:08:02.573028 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m18:08:02.573825 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m18:08:02.574205 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m18:08:02.577251 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m18:08:02.578197 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m18:08:02.581779 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m18:08:02.583078 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:08:02.583598 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m18:08:02.583948 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:08:02.585522 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.586040 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:08:02.586432 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m18:08:02.700784 [debug] [Thread-2 (]: SQL status: OK in 0.114 seconds
[0m18:08:02.703960 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:08:02.704378 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m18:08:02.769344 [debug] [Thread-2 (]: SQL status: OK in 0.065 seconds
[0m18:08:02.772521 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:08:02.772917 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m18:08:02.834318 [debug] [Thread-2 (]: SQL status: OK in 0.061 seconds
[0m18:08:02.835920 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m18:08:02.836336 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:08:02.836676 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m18:08:03.025776 [debug] [Thread-2 (]: SQL status: OK in 0.189 seconds
[0m18:08:03.028175 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:08:03.028537 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m18:08:03.144812 [debug] [Thread-2 (]: SQL status: OK in 0.116 seconds
[0m18:08:03.146507 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m18:08:03.147115 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ecd527-a827-481c-8aaa-4bbdef846428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020059234260>]}
[0m18:08:03.147712 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.57s]
[0m18:08:03.148525 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m18:08:03.149221 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m18:08:03.149692 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m18:08:03.150351 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m18:08:03.150719 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m18:08:03.153391 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m18:08:03.154259 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m18:08:03.157446 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m18:08:03.158253 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:08:03.158623 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m18:08:03.158966 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:08:03.160201 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:08:03.160588 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:08:03.160989 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime,
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(case when changed = 1 then changed else 0 end) over(order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

    select
        regime, 
        change_counter,
        count(*), 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    group by change_counter, regime
  );

[0m18:08:03.253027 [debug] [Thread-3 (]: SQL status: OK in 0.092 seconds
[0m18:08:03.256165 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:08:03.256541 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m18:08:03.325789 [debug] [Thread-3 (]: SQL status: OK in 0.069 seconds
[0m18:08:03.331559 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:08:03.331990 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m18:08:03.388826 [debug] [Thread-3 (]: SQL status: OK in 0.056 seconds
[0m18:08:03.390144 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m18:08:03.390514 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:08:03.390857 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m18:08:03.493934 [debug] [Thread-3 (]: SQL status: OK in 0.103 seconds
[0m18:08:03.496700 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:08:03.497133 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m18:08:03.609739 [debug] [Thread-3 (]: SQL status: OK in 0.112 seconds
[0m18:08:03.611134 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m18:08:03.611641 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ecd527-a827-481c-8aaa-4bbdef846428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020059247250>]}
[0m18:08:03.612231 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.46s]
[0m18:08:03.613037 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m18:08:03.614489 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:03.614815 [debug] [MainThread]: On master: BEGIN
[0m18:08:03.615115 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:03.616288 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:08:03.616616 [debug] [MainThread]: On master: COMMIT
[0m18:08:03.616932 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:03.617233 [debug] [MainThread]: On master: COMMIT
[0m18:08:03.617824 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:03.618143 [debug] [MainThread]: On master: Close
[0m18:08:03.618537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:03.618830 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m18:08:03.619113 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m18:08:03.619392 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m18:08:03.619673 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m18:08:03.619952 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m18:08:03.620233 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m18:08:03.620593 [info ] [MainThread]: 
[0m18:08:03.621078 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m18:08:03.622299 [debug] [MainThread]: Command end result
[0m18:08:03.669532 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:08:03.672615 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:08:03.678690 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m18:08:03.679055 [info ] [MainThread]: 
[0m18:08:03.679592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:03.680052 [info ] [MainThread]: 
[0m18:08:03.680574 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m18:08:03.681479 [debug] [MainThread]: Command `-c run` succeeded at 18:08:03.681362 after 4.79 seconds
[0m18:08:03.681856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020058618450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005874F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200573BFB60>]}
[0m18:08:03.682231 [debug] [MainThread]: Flushing usage events
[0m18:08:04.681322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:38.560641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D7DBD8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D7E3E42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D7EA23ED0>]}


============================== 18:09:38.564976 | a03b2a24-7fd6-40a9-b2f1-df8b5e5c9f2e ==============================
[0m18:09:38.564976 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:09:38.565698 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select +int__regime_changes', 'printer_width': '80', 'write_json': 'True'}
[0m18:09:38.811533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a03b2a24-7fd6-40a9-b2f1-df8b5e5c9f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D7DD90180>]}
[0m18:09:38.876451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a03b2a24-7fd6-40a9-b2f1-df8b5e5c9f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D7E8CB790>]}
[0m18:09:38.879059 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:09:39.136018 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:09:39.520371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:09:39.521016 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m18:09:39.866291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a03b2a24-7fd6-40a9-b2f1-df8b5e5c9f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D0039DB50>]}
[0m18:09:39.992278 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:09:39.994725 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:09:40.023922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a03b2a24-7fd6-40a9-b2f1-df8b5e5c9f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D7FD84B90>]}
[0m18:09:40.024380 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 2 sources, 853 macros
[0m18:09:40.024894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a03b2a24-7fd6-40a9-b2f1-df8b5e5c9f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D7E8E3770>]}
[0m18:09:40.026844 [info ] [MainThread]: 
[0m18:09:40.027332 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:09:40.027793 [info ] [MainThread]: 
[0m18:09:40.028407 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:09:40.033312 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m18:09:40.112183 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m18:09:40.112620 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m18:09:40.112929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:41.406913 [debug] [ThreadPool]: SQL status: OK in 1.294 seconds
[0m18:09:41.408556 [debug] [ThreadPool]: On list_finance: Close
[0m18:09:41.409300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m18:09:41.409823 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m18:09:41.416469 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:09:41.416847 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m18:09:41.417186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:41.418886 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:09:41.420387 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:09:41.420738 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m18:09:41.421747 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:09:41.422087 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:09:41.422416 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m18:09:41.488413 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m18:09:41.489359 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:09:41.489693 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:09:41.489985 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:09:41.539404 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m18:09:41.539830 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m18:09:41.541922 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m18:09:41.547617 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:09:41.547954 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m18:09:41.548246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:41.548859 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m18:09:41.550800 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:09:41.551125 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m18:09:41.551410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:41.552055 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:09:41.552383 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:09:41.552714 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m18:09:41.553177 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:09:41.553503 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:09:41.553823 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m18:09:41.577868 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m18:09:41.578270 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m18:09:41.579516 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m18:09:41.580833 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m18:09:41.581988 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m18:09:41.582303 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m18:09:41.582794 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m18:09:41.583112 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m18:09:41.585244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a03b2a24-7fd6-40a9-b2f1-df8b5e5c9f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D0005B930>]}
[0m18:09:41.585707 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:41.586026 [debug] [MainThread]: On master: BEGIN
[0m18:09:41.586327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:41.587620 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:09:41.587949 [debug] [MainThread]: On master: COMMIT
[0m18:09:41.588312 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:41.588606 [debug] [MainThread]: On master: COMMIT
[0m18:09:41.589207 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:09:41.589522 [debug] [MainThread]: On master: Close
[0m18:09:41.594409 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m18:09:41.594956 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m18:09:41.595639 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m18:09:41.596000 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m18:09:41.602790 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m18:09:41.603621 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m18:09:41.632731 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m18:09:41.633652 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:09:41.634018 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m18:09:41.634349 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:09:41.635725 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:09:41.636106 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:09:41.636462 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m18:09:41.705184 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m18:09:41.714623 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:09:41.715236 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m18:09:41.781672 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m18:09:41.784845 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:09:41.785210 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m18:09:41.840311 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m18:09:41.852697 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:09:41.853073 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:09:41.853492 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:09:41.984304 [debug] [Thread-1 (]: SQL status: OK in 0.130 seconds
[0m18:09:41.989774 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:09:41.990449 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m18:09:42.097832 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m18:09:42.100221 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m18:09:42.102258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03b2a24-7fd6-40a9-b2f1-df8b5e5c9f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D007B1250>]}
[0m18:09:42.102873 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.51s]
[0m18:09:42.103671 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m18:09:42.104442 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m18:09:42.104912 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m18:09:42.105988 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m18:09:42.106680 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m18:09:42.109663 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m18:09:42.110576 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m18:09:42.113788 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m18:09:42.114725 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:09:42.115160 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m18:09:42.115503 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:09:42.116839 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:09:42.117212 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:09:42.117579 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date, 
        "close", 
        loaded_at
    from "finance"."analytics_dev"."src_vix" v
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < 12 then 'complacent'
            when "close" >= 12 and close < 20 then 'normal'
            when "close" >= 20 and "close" < 30 then 'elevated'
            when "close" >= 30 then 'crises'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m18:09:42.222882 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m18:09:42.226012 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:09:42.226467 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m18:09:42.297353 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m18:09:42.305482 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:09:42.305936 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m18:09:42.368428 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m18:09:42.370406 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m18:09:42.370932 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:09:42.371374 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m18:09:42.567902 [debug] [Thread-2 (]: SQL status: OK in 0.196 seconds
[0m18:09:42.570521 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:09:42.570950 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m18:09:42.751292 [debug] [Thread-2 (]: SQL status: OK in 0.180 seconds
[0m18:09:42.753085 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m18:09:42.753662 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03b2a24-7fd6-40a9-b2f1-df8b5e5c9f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D008A4260>]}
[0m18:09:42.754289 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.65s]
[0m18:09:42.755349 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m18:09:42.756085 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m18:09:42.756600 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m18:09:42.757384 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m18:09:42.757821 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m18:09:42.760665 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m18:09:42.761578 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m18:09:42.764851 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m18:09:42.765781 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:09:42.766193 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m18:09:42.766532 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:09:42.767776 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:09:42.768149 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:09:42.768536 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime,
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(case when changed = 1 then changed else 0 end) over(order by trade_date asc, loaded_at asc) as change_counter
    from regime_changes
)

    select
        regime, 
        change_counter,
        count(*), 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by change_counter, regime
    order by min(trade_date) asc
  );

[0m18:09:42.896119 [debug] [Thread-3 (]: SQL status: OK in 0.127 seconds
[0m18:09:42.899251 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:09:42.899694 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m18:09:42.968341 [debug] [Thread-3 (]: SQL status: OK in 0.068 seconds
[0m18:09:42.976906 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:09:42.977341 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m18:09:43.047342 [debug] [Thread-3 (]: SQL status: OK in 0.070 seconds
[0m18:09:43.048930 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m18:09:43.049757 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:09:43.050495 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m18:09:43.203331 [debug] [Thread-3 (]: SQL status: OK in 0.152 seconds
[0m18:09:43.205839 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:09:43.206208 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m18:09:43.338046 [debug] [Thread-3 (]: SQL status: OK in 0.131 seconds
[0m18:09:43.344510 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m18:09:43.345481 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03b2a24-7fd6-40a9-b2f1-df8b5e5c9f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D008B3110>]}
[0m18:09:43.346228 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.59s]
[0m18:09:43.347145 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m18:09:43.348608 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:43.348982 [debug] [MainThread]: On master: BEGIN
[0m18:09:43.349297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:43.350522 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:09:43.350866 [debug] [MainThread]: On master: COMMIT
[0m18:09:43.351170 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:43.351459 [debug] [MainThread]: On master: COMMIT
[0m18:09:43.352178 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:09:43.352537 [debug] [MainThread]: On master: Close
[0m18:09:43.352987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:43.353289 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m18:09:43.353573 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m18:09:43.353858 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m18:09:43.354138 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m18:09:43.354421 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m18:09:43.354716 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m18:09:43.355140 [info ] [MainThread]: 
[0m18:09:43.355704 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m18:09:43.357168 [debug] [MainThread]: Command end result
[0m18:09:43.415581 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:09:43.418318 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:09:43.426377 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m18:09:43.426811 [info ] [MainThread]: 
[0m18:09:43.427445 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:43.427970 [info ] [MainThread]: 
[0m18:09:43.428510 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m18:09:43.429434 [debug] [MainThread]: Command `-c run` succeeded at 18:09:43.429321 after 5.03 seconds
[0m18:09:43.429795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D7FB78450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D7FD2F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D7E92BB60>]}
[0m18:09:43.430153 [debug] [MainThread]: Flushing usage events
[0m18:09:44.443448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:32:37.160448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFDD48050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFE5542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFEB97ED0>]}


============================== 18:32:37.165267 | 3d43c678-b58b-4ce9-91bf-b634bcaf9f4f ==============================
[0m18:32:37.165267 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:32:37.166035 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt seed', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m18:32:37.413984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d43c678-b58b-4ce9-91bf-b634bcaf9f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFDF00180>]}
[0m18:32:37.478703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d43c678-b58b-4ce9-91bf-b634bcaf9f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFEA3B790>]}
[0m18:32:37.481258 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:32:37.741391 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:32:38.127166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:32:38.127812 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://seeds\regime_thresholds.csv
[0m18:32:38.128207 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m18:32:38.633727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d43c678-b58b-4ce9-91bf-b634bcaf9f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F805AE150>]}
[0m18:32:38.776401 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:32:38.778930 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:32:38.808006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d43c678-b58b-4ce9-91bf-b634bcaf9f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F8048D400>]}
[0m18:32:38.808459 [info ] [MainThread]: Found 8 models, 46 data tests, 1 snapshot, 1 seed, 2 sources, 853 macros
[0m18:32:38.808988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d43c678-b58b-4ce9-91bf-b634bcaf9f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFFD7BE70>]}
[0m18:32:38.811701 [info ] [MainThread]: 
[0m18:32:38.812508 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:32:38.813076 [info ] [MainThread]: 
[0m18:32:38.813778 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:32:38.814740 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m18:32:38.893240 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m18:32:38.893621 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m18:32:38.893929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:40.118927 [debug] [ThreadPool]: SQL status: OK in 1.225 seconds
[0m18:32:40.120364 [debug] [ThreadPool]: On list_finance: Close
[0m18:32:40.121050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m18:32:40.121526 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m18:32:40.127604 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:32:40.127946 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m18:32:40.128254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:40.129777 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:32:40.131313 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:32:40.131924 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m18:32:40.133399 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:32:40.133808 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:32:40.134108 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m18:32:40.181988 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m18:32:40.183050 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:32:40.183401 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:32:40.183718 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:32:40.226456 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m18:32:40.226995 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m18:32:40.234946 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m18:32:40.243610 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:32:40.244286 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m18:32:40.244778 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m18:32:40.247819 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:32:40.248344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:40.248880 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m18:32:40.249701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:40.250586 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:32:40.251060 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:32:40.251516 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m18:32:40.252211 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:32:40.252690 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:32:40.253169 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m18:32:40.280255 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m18:32:40.280644 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m18:32:40.282058 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m18:32:40.283655 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m18:32:40.285513 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m18:32:40.285971 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m18:32:40.286836 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m18:32:40.287584 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m18:32:40.290073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d43c678-b58b-4ce9-91bf-b634bcaf9f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F809F8940>]}
[0m18:32:40.290539 [debug] [MainThread]: Using duckdb connection "master"
[0m18:32:40.290864 [debug] [MainThread]: On master: BEGIN
[0m18:32:40.291136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:32:40.292315 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:32:40.292620 [debug] [MainThread]: On master: COMMIT
[0m18:32:40.292913 [debug] [MainThread]: Using duckdb connection "master"
[0m18:32:40.293188 [debug] [MainThread]: On master: COMMIT
[0m18:32:40.293724 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:32:40.294022 [debug] [MainThread]: On master: Close
[0m18:32:40.298843 [debug] [Thread-1 (]: Began running node seed.portfolio_project_2.regime_thresholds
[0m18:32:40.299358 [info ] [Thread-1 (]: 1 of 1 START seed file analytics_dev.regime_thresholds ......................... [RUN]
[0m18:32:40.300045 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.portfolio_project_2.regime_thresholds'
[0m18:32:40.300403 [debug] [Thread-1 (]: Began compiling node seed.portfolio_project_2.regime_thresholds
[0m18:32:40.300746 [debug] [Thread-1 (]: Began executing node seed.portfolio_project_2.regime_thresholds
[0m18:32:40.325544 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m18:32:40.325957 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: BEGIN
[0m18:32:40.326286 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:32:40.327625 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:32:40.327972 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m18:32:40.328316 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "seed.portfolio_project_2.regime_thresholds"} */

    create table "finance"."analytics_dev"."regime_thresholds" ("version_id" integer,"version_name" text,"complacent_max" integer,"normal_max" integer,"elevated_max" integer,"effective_date" date,"notes" text)
  
[0m18:32:40.394696 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m18:32:40.406772 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m18:32:40.407208 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: 
          COPY "finance"."analytics_dev"."regime_thresholds" FROM 'C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\seeds\regime_thresholds.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:32:40.563886 [debug] [Thread-1 (]: SQL status: OK in 0.156 seconds
[0m18:32:40.572991 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.portfolio_project_2.regime_thresholds"
[0m18:32:40.586960 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m18:32:40.587530 [debug] [Thread-1 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m18:32:40.587988 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m18:32:40.717365 [debug] [Thread-1 (]: SQL status: OK in 0.129 seconds
[0m18:32:40.724626 [debug] [Thread-1 (]: On seed.portfolio_project_2.regime_thresholds: Close
[0m18:32:40.730762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d43c678-b58b-4ce9-91bf-b634bcaf9f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F809C1CD0>]}
[0m18:32:40.732186 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics_dev.regime_thresholds ..................... [[32mINSERT 1[0m in 0.43s]
[0m18:32:40.733936 [debug] [Thread-1 (]: Finished running node seed.portfolio_project_2.regime_thresholds
[0m18:32:40.736788 [debug] [MainThread]: Using duckdb connection "master"
[0m18:32:40.737372 [debug] [MainThread]: On master: BEGIN
[0m18:32:40.737912 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:32:40.740147 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m18:32:40.740843 [debug] [MainThread]: On master: COMMIT
[0m18:32:40.741471 [debug] [MainThread]: Using duckdb connection "master"
[0m18:32:40.741861 [debug] [MainThread]: On master: COMMIT
[0m18:32:40.742653 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:32:40.743080 [debug] [MainThread]: On master: Close
[0m18:32:40.743540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:40.743841 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m18:32:40.744132 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m18:32:40.744405 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m18:32:40.744670 [debug] [MainThread]: Connection 'seed.portfolio_project_2.regime_thresholds' was properly closed.
[0m18:32:40.744993 [info ] [MainThread]: 
[0m18:32:40.745664 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m18:32:40.747005 [debug] [MainThread]: Command end result
[0m18:32:40.798293 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:32:40.800936 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:32:40.806939 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m18:32:40.807280 [info ] [MainThread]: 
[0m18:32:40.807843 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:32:40.808327 [info ] [MainThread]: 
[0m18:32:40.808829 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:32:40.809710 [debug] [MainThread]: Command `-c seed` succeeded at 18:32:40.809597 after 3.82 seconds
[0m18:32:40.810075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F807DF540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F80A77F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F80A77E30>]}
[0m18:32:40.810444 [debug] [MainThread]: Flushing usage events
[0m18:32:41.493517 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:20.807647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3FD588050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3FDD942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3FE3D3ED0>]}


============================== 18:41:20.812035 | b39af8dd-0511-4cce-8ba0-073835b62b89 ==============================
[0m18:41:20.812035 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:41:20.813033 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg__vix_with_version', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m18:41:21.071974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b39af8dd-0511-4cce-8ba0-073835b62b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3FD740180>]}
[0m18:41:21.137170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b39af8dd-0511-4cce-8ba0-073835b62b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3FE27B790>]}
[0m18:41:21.139946 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:41:21.395283 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:41:21.789868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:41:21.790473 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\stg\stg__vix_with_vesion.sql
[0m18:41:21.790872 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://seeds\regime_thresholds.csv
[0m18:41:22.268094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b39af8dd-0511-4cce-8ba0-073835b62b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3FFC62250>]}
[0m18:41:22.404802 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:41:22.407196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:41:22.435635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b39af8dd-0511-4cce-8ba0-073835b62b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3FF6B0B90>]}
[0m18:41:22.436156 [info ] [MainThread]: Found 9 models, 46 data tests, 1 snapshot, 1 seed, 2 sources, 853 macros
[0m18:41:22.436841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b39af8dd-0511-4cce-8ba0-073835b62b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3FF4E75B0>]}
[0m18:41:22.438633 [warn ] [MainThread]: The selection criterion 'stg__vix_with_version' does not match any enabled nodes
[0m18:41:22.440586 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:41:22.441417 [debug] [MainThread]: Command end result
[0m18:41:22.488333 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:41:22.490709 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:41:22.493945 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m18:41:22.494680 [debug] [MainThread]: Command `-c run` succeeded at 18:41:22.494556 after 1.87 seconds
[0m18:41:22.495061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3FFE23AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3FE1CB1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3FFE67290>]}
[0m18:41:22.495424 [debug] [MainThread]: Flushing usage events
[0m18:41:23.261519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:42:38.271150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFE4D8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFECE42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFF327ED0>]}


============================== 18:42:38.275590 | 53d15f56-a389-421e-bef5-c2f6ebc848b5 ==============================
[0m18:42:38.275590 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:42:38.276327 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg__vix_with_version', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m18:42:38.524170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53d15f56-a389-421e-bef5-c2f6ebc848b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFE690180>]}
[0m18:42:38.588747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53d15f56-a389-421e-bef5-c2f6ebc848b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFF1CB790>]}
[0m18:42:38.591329 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:42:38.853488 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:42:39.246707 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m18:42:39.247306 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\stg\stg__vix_with_version.sql
[0m18:42:39.247608 [debug] [MainThread]: Partial parsing: deleted file: portfolio_project_2://models\silver\stg\stg__vix_with_vesion.sql
[0m18:42:39.603431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53d15f56-a389-421e-bef5-c2f6ebc848b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFFBA5D50>]}
[0m18:42:39.739103 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:42:39.741532 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:42:39.768379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53d15f56-a389-421e-bef5-c2f6ebc848b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFF630B90>]}
[0m18:42:39.768845 [info ] [MainThread]: Found 9 models, 46 data tests, 1 snapshot, 1 seed, 2 sources, 853 macros
[0m18:42:39.769366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53d15f56-a389-421e-bef5-c2f6ebc848b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFF1E3150>]}
[0m18:42:39.771179 [info ] [MainThread]: 
[0m18:42:39.771665 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:42:39.772139 [info ] [MainThread]: 
[0m18:42:39.772880 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:42:39.773923 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m18:42:39.864345 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m18:42:39.864730 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m18:42:39.865095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:41.015610 [debug] [ThreadPool]: SQL status: OK in 1.150 seconds
[0m18:42:41.017037 [debug] [ThreadPool]: On list_finance: Close
[0m18:42:41.017793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m18:42:41.018353 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m18:42:41.024926 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:42:41.025313 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m18:42:41.025623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:42:41.027223 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:42:41.028550 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:42:41.028865 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m18:42:41.029766 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:42:41.030075 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:42:41.030380 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m18:42:41.083758 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m18:42:41.087489 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:42:41.088868 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:42:41.090159 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:42:41.138641 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m18:42:41.140312 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m18:42:41.163141 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m18:42:41.171149 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m18:42:41.175756 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:42:41.178802 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:42:41.179448 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m18:42:41.179911 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m18:42:41.180394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:41.180879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:41.182181 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:42:41.182603 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:42:41.183025 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m18:42:41.183791 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:42:41.184220 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:42:41.184587 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m18:42:41.209612 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m18:42:41.210927 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m18:42:41.211412 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m18:42:41.212919 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m18:42:41.214167 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m18:42:41.214546 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m18:42:41.215433 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m18:42:41.215894 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m18:42:41.218863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53d15f56-a389-421e-bef5-c2f6ebc848b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFFCF7040>]}
[0m18:42:41.219362 [debug] [MainThread]: Using duckdb connection "master"
[0m18:42:41.219666 [debug] [MainThread]: On master: BEGIN
[0m18:42:41.219939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:42:41.221172 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:42:41.221505 [debug] [MainThread]: On master: COMMIT
[0m18:42:41.221803 [debug] [MainThread]: Using duckdb connection "master"
[0m18:42:41.222084 [debug] [MainThread]: On master: COMMIT
[0m18:42:41.222648 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:42:41.222959 [debug] [MainThread]: On master: Close
[0m18:42:41.227616 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__vix_with_version
[0m18:42:41.228128 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.stg__vix_with_version ................ [RUN]
[0m18:42:41.228807 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_version'
[0m18:42:41.229179 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__vix_with_version
[0m18:42:41.237119 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_version"
[0m18:42:41.238649 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__vix_with_version
[0m18:42:41.268031 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_version"
[0m18:42:41.269331 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_version"
[0m18:42:41.269765 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_version: BEGIN
[0m18:42:41.270112 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:42:41.271459 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:42:41.271845 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_version"
[0m18:42:41.272245 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_version: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_version"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_version__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_version as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date
    from src_vix v
    left join thresholds t on v.trade_date >= MAX(t.effective_date)
)

select * 
from vix_with_version
  );

[0m18:42:41.322450 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_version"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_version__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_version as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date
    from src_vix v
    left join thresholds t on v.trade_date >= MAX(t.effective_date)
)

select * 
from vix_with_version
  );

[0m18:42:41.322938 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:42:41.323399 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_version: ROLLBACK
[0m18:42:41.330372 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.stg__vix_with_version'
[0m18:42:41.330788 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_version: Close
[0m18:42:41.335072 [debug] [Thread-1 (]: Runtime Error in model stg__vix_with_version (models\silver\stg\stg__vix_with_version.sql)
  Binder Error: WHERE clause cannot contain aggregates!
  
  LINE 30:     left join thresholds t on v.trade_date >= MAX(t.effective_date)
                                                         ^
[0m18:42:41.337063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53d15f56-a389-421e-bef5-c2f6ebc848b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD810A5CD0>]}
[0m18:42:41.337698 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.stg__vix_with_version ....... [[31mERROR[0m in 0.11s]
[0m18:42:41.338523 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__vix_with_version
[0m18:42:41.339152 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.stg__vix_with_version' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__vix_with_version (models\silver\stg\stg__vix_with_version.sql)
  Binder Error: WHERE clause cannot contain aggregates!
  
  LINE 30:     left join thresholds t on v.trade_date >= MAX(t.effective_date)
                                                         ^.
[0m18:42:41.341217 [debug] [MainThread]: Using duckdb connection "master"
[0m18:42:41.341604 [debug] [MainThread]: On master: BEGIN
[0m18:42:41.341896 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:42:41.343004 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:42:41.343327 [debug] [MainThread]: On master: COMMIT
[0m18:42:41.343630 [debug] [MainThread]: Using duckdb connection "master"
[0m18:42:41.343912 [debug] [MainThread]: On master: COMMIT
[0m18:42:41.344472 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:42:41.344786 [debug] [MainThread]: On master: Close
[0m18:42:41.345177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:42:41.345456 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m18:42:41.345717 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m18:42:41.345972 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m18:42:41.346235 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__vix_with_version' was properly closed.
[0m18:42:41.346535 [info ] [MainThread]: 
[0m18:42:41.347039 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m18:42:41.347936 [debug] [MainThread]: Command end result
[0m18:42:41.392518 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:42:41.394838 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:42:41.400762 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m18:42:41.401166 [info ] [MainThread]: 
[0m18:42:41.401683 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:42:41.402153 [info ] [MainThread]: 
[0m18:42:41.402708 [error] [MainThread]: [31mFailure in model stg__vix_with_version (models\silver\stg\stg__vix_with_version.sql)[0m
[0m18:42:41.403364 [error] [MainThread]:   Runtime Error in model stg__vix_with_version (models\silver\stg\stg__vix_with_version.sql)
  Binder Error: WHERE clause cannot contain aggregates!
  
  LINE 30:     left join thresholds t on v.trade_date >= MAX(t.effective_date)
                                                         ^
[0m18:42:41.403953 [info ] [MainThread]: 
[0m18:42:41.404507 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\stg\stg__vix_with_version.sql
[0m18:42:41.404979 [info ] [MainThread]: 
[0m18:42:41.405479 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:42:41.406387 [debug] [MainThread]: Command `-c run` failed at 18:42:41.406267 after 3.27 seconds
[0m18:42:41.406793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFFF12570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFF8CFCF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFF8CDB30>]}
[0m18:42:41.407171 [debug] [MainThread]: Flushing usage events
[0m18:42:42.106190 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:14.236330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2D498050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2DCA42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2E2E3ED0>]}


============================== 18:43:14.240623 | a2159780-fa5a-4a69-9b1c-24f5c0b3fefb ==============================
[0m18:43:14.240623 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:43:14.241382 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt run --select stg__vix_with_version', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m18:43:14.493726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2159780-fa5a-4a69-9b1c-24f5c0b3fefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2D650180>]}
[0m18:43:14.560375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2159780-fa5a-4a69-9b1c-24f5c0b3fefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2E18B790>]}
[0m18:43:14.562913 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:43:14.819848 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:43:15.222987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:43:15.223647 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\stg\stg__vix_with_version.sql
[0m18:43:15.612284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2159780-fa5a-4a69-9b1c-24f5c0b3fefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2FBAA050>]}
[0m18:43:15.753764 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:43:15.756448 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:43:15.787801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2159780-fa5a-4a69-9b1c-24f5c0b3fefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2F640B90>]}
[0m18:43:15.788279 [info ] [MainThread]: Found 9 models, 46 data tests, 1 snapshot, 1 seed, 2 sources, 853 macros
[0m18:43:15.788803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2159780-fa5a-4a69-9b1c-24f5c0b3fefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2E1A3150>]}
[0m18:43:15.790698 [info ] [MainThread]: 
[0m18:43:15.791181 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:43:15.791650 [info ] [MainThread]: 
[0m18:43:15.792299 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:43:15.793308 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m18:43:15.897215 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m18:43:15.897630 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m18:43:15.897944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:17.315172 [debug] [ThreadPool]: SQL status: OK in 1.417 seconds
[0m18:43:17.316775 [debug] [ThreadPool]: On list_finance: Close
[0m18:43:17.317477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m18:43:17.317960 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m18:43:17.324149 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:43:17.324475 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m18:43:17.324766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:17.326230 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:43:17.327514 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:43:17.327818 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m18:43:17.328754 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:43:17.329050 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:43:17.329341 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m18:43:17.381886 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m18:43:17.383041 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:43:17.383445 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:43:17.383810 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:43:17.434191 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m18:43:17.435309 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m18:43:17.446064 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m18:43:17.451506 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:43:17.451847 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m18:43:17.452126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:17.453077 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m18:43:17.455101 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:43:17.455419 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m18:43:17.455692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:17.456348 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:43:17.456704 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:43:17.457006 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m18:43:17.457559 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:43:17.457876 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:43:17.458190 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m18:43:17.481748 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m18:43:17.482238 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m18:43:17.483424 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m18:43:17.484677 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m18:43:17.485910 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m18:43:17.486213 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m18:43:17.486744 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m18:43:17.487057 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m18:43:17.489453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2159780-fa5a-4a69-9b1c-24f5c0b3fefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB3009C050>]}
[0m18:43:17.489891 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:17.490181 [debug] [MainThread]: On master: BEGIN
[0m18:43:17.490451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:17.491626 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:43:17.491935 [debug] [MainThread]: On master: COMMIT
[0m18:43:17.492229 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:17.492506 [debug] [MainThread]: On master: COMMIT
[0m18:43:17.493051 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:43:17.493354 [debug] [MainThread]: On master: Close
[0m18:43:17.497998 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__vix_with_version
[0m18:43:17.498505 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.stg__vix_with_version ................ [RUN]
[0m18:43:17.499177 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_version'
[0m18:43:17.499536 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__vix_with_version
[0m18:43:17.506766 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_version"
[0m18:43:17.507728 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__vix_with_version
[0m18:43:17.538293 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_version"
[0m18:43:17.539222 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_version"
[0m18:43:17.539584 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_version: BEGIN
[0m18:43:17.539915 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:43:17.541382 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:43:17.541769 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_version"
[0m18:43:17.542133 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_version: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_version"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_version__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_version as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date
    from src_vix v
    left join thresholds t on v.trade_date >= t.effective_date
)

select * 
from vix_with_version
  );

[0m18:43:17.630619 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m18:43:17.636625 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_version"
[0m18:43:17.637052 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_version: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_version"} */
alter view "finance"."analytics_dev"."stg__vix_with_version__dbt_tmp" rename to "stg__vix_with_version"
[0m18:43:17.696783 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m18:43:17.706076 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_version: COMMIT
[0m18:43:17.706483 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_version"
[0m18:43:17.706827 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_version: COMMIT
[0m18:43:17.835444 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m18:43:17.841078 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_version"
[0m18:43:17.841482 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_version: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_version"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_version__dbt_backup" cascade
    
[0m18:43:17.900564 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m18:43:17.903428 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_version: Close
[0m18:43:17.905827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2159780-fa5a-4a69-9b1c-24f5c0b3fefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB30035B50>]}
[0m18:43:17.906603 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics_dev.stg__vix_with_version ........... [[32mOK[0m in 0.40s]
[0m18:43:17.907612 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__vix_with_version
[0m18:43:17.909336 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:17.909744 [debug] [MainThread]: On master: BEGIN
[0m18:43:17.910120 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:17.911487 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:43:17.911893 [debug] [MainThread]: On master: COMMIT
[0m18:43:17.912287 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:17.912676 [debug] [MainThread]: On master: COMMIT
[0m18:43:17.913432 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:43:17.913842 [debug] [MainThread]: On master: Close
[0m18:43:17.914308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:17.914873 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m18:43:17.915215 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m18:43:17.915594 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m18:43:17.915851 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__vix_with_version' was properly closed.
[0m18:43:17.916155 [info ] [MainThread]: 
[0m18:43:17.916796 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m18:43:17.917679 [debug] [MainThread]: Command end result
[0m18:43:17.966995 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:43:17.969628 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:43:17.975542 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m18:43:17.975878 [info ] [MainThread]: 
[0m18:43:17.976422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:43:17.976908 [info ] [MainThread]: 
[0m18:43:17.977459 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:43:17.978359 [debug] [MainThread]: Command `-c run` succeeded at 18:43:17.978244 after 3.88 seconds
[0m18:43:17.978729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2FF12570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2FCB1C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2FCB1F90>]}
[0m18:43:17.979152 [debug] [MainThread]: Flushing usage events
[0m18:43:18.669151 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:57.235741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD1768050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD1F742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD25B3ED0>]}


============================== 18:57:57.240269 | fde493e6-de0b-4661-81bd-9de61a6aa681 ==============================
[0m18:57:57.240269 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:57:57.240963 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +int__regime_changes', 'printer_width': '80', 'target_path': 'None'}
[0m18:57:57.493488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fde493e6-de0b-4661-81bd-9de61a6aa681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD1920180>]}
[0m18:57:57.559828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fde493e6-de0b-4661-81bd-9de61a6aa681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD245B790>]}
[0m18:57:57.562434 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:57:57.826543 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:57:58.241787 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m18:57:58.242429 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\silver\stg\stg__vix_with_versions.sql
[0m18:57:58.242750 [debug] [MainThread]: Partial parsing: deleted file: portfolio_project_2://models\silver\stg\stg__vix_with_version.sql
[0m18:57:58.243185 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m18:57:58.609617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fde493e6-de0b-4661-81bd-9de61a6aa681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD3E52050>]}
[0m18:57:58.748340 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:57:58.750814 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:57:58.778195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fde493e6-de0b-4661-81bd-9de61a6aa681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD38A0B90>]}
[0m18:57:58.778672 [info ] [MainThread]: Found 9 models, 46 data tests, 1 snapshot, 1 seed, 2 sources, 853 macros
[0m18:57:58.779209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fde493e6-de0b-4661-81bd-9de61a6aa681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD2473150>]}
[0m18:57:58.781312 [info ] [MainThread]: 
[0m18:57:58.781812 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:57:58.782277 [info ] [MainThread]: 
[0m18:57:58.782901 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:57:58.787710 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m18:57:58.866322 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m18:57:58.866721 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m18:57:58.867031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:00.474996 [debug] [ThreadPool]: SQL status: OK in 1.608 seconds
[0m18:58:00.476386 [debug] [ThreadPool]: On list_finance: Close
[0m18:58:00.477066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m18:58:00.477539 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m18:58:00.483546 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:58:00.483890 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m18:58:00.484190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:00.485731 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:58:00.486980 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:58:00.487288 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m18:58:00.488203 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:58:00.488503 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:58:00.488793 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m18:58:00.539005 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m18:58:00.540460 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:58:00.540960 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:58:00.541415 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:58:00.590358 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m18:58:00.591873 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m18:58:00.599786 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m18:58:00.605176 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:58:00.605509 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m18:58:00.605789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:00.607177 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m18:58:00.609325 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:58:00.609657 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m18:58:00.609940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:00.610624 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:58:00.611080 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:58:00.611387 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m18:58:00.611713 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:58:00.612020 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:58:00.612332 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m18:58:00.637232 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m18:58:00.637632 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m18:58:00.639082 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m18:58:00.640233 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m18:58:00.641279 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m18:58:00.641586 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m18:58:00.642107 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m18:58:00.642417 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m18:58:00.644879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fde493e6-de0b-4661-81bd-9de61a6aa681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD3F57520>]}
[0m18:58:00.645311 [debug] [MainThread]: Using duckdb connection "master"
[0m18:58:00.645608 [debug] [MainThread]: On master: BEGIN
[0m18:58:00.645886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:00.646971 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:58:00.647278 [debug] [MainThread]: On master: COMMIT
[0m18:58:00.647575 [debug] [MainThread]: Using duckdb connection "master"
[0m18:58:00.647858 [debug] [MainThread]: On master: COMMIT
[0m18:58:00.648398 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:58:00.648704 [debug] [MainThread]: On master: Close
[0m18:58:00.653404 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m18:58:00.653909 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m18:58:00.654591 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m18:58:00.654945 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m18:58:00.661591 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m18:58:00.662593 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m18:58:00.694285 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m18:58:00.695234 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:58:00.695594 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m18:58:00.695916 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:58:00.697373 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:58:00.697733 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:58:00.698080 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m18:58:00.759082 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m18:58:00.766593 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:58:00.767092 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m18:58:00.822349 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m18:58:00.826196 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:58:00.826655 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m18:58:00.889946 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m18:58:00.917483 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:58:00.918118 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:58:00.918649 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:58:01.049821 [debug] [Thread-1 (]: SQL status: OK in 0.130 seconds
[0m18:58:01.065714 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:58:01.066878 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m18:58:01.184335 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m18:58:01.186650 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m18:58:01.188713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fde493e6-de0b-4661-81bd-9de61a6aa681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD4169A90>]}
[0m18:58:01.189348 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.53s]
[0m18:58:01.190144 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m18:58:01.190936 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m18:58:01.191397 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_dev.stg__vix_with_versions ............... [RUN]
[0m18:58:01.192065 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m18:58:01.192427 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m18:58:01.195438 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m18:58:01.196655 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m18:58:01.200285 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m18:58:01.201622 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m18:58:01.202088 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m18:58:01.202425 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:58:01.203661 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:58:01.204096 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m18:58:01.204479 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date. 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    left join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
  );

[0m18:58:01.271407 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date. 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    left join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
  );

[0m18:58:01.272044 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m18:58:01.272596 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: ROLLBACK
[0m18:58:01.279495 [debug] [Thread-2 (]: Failed to rollback 'model.portfolio_project_2.stg__vix_with_versions'
[0m18:58:01.279892 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m18:58:01.284155 [debug] [Thread-2 (]: Runtime Error in model stg__vix_with_versions (models\silver\stg\stg__vix_with_versions.sql)
  Binder Error: Column "effective_date" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m18:58:01.284601 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fde493e6-de0b-4661-81bd-9de61a6aa681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD4164940>]}
[0m18:58:01.285218 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model analytics_dev.stg__vix_with_versions ...... [[31mERROR[0m in 0.09s]
[0m18:58:01.286036 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m18:58:01.286640 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.stg__vix_with_versions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__vix_with_versions (models\silver\stg\stg__vix_with_versions.sql)
  Binder Error: Column "effective_date" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m18:58:01.287793 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m18:58:01.288251 [info ] [Thread-3 (]: 3 of 4 SKIP relation analytics_dev.int__regime_classification .................. [[33mSKIP[0m]
[0m18:58:01.288894 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m18:58:01.289576 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m18:58:01.289991 [info ] [Thread-4 (]: 4 of 4 SKIP relation analytics_dev.int__regime_changes ......................... [[33mSKIP[0m]
[0m18:58:01.290615 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m18:58:01.292070 [debug] [MainThread]: Using duckdb connection "master"
[0m18:58:01.292409 [debug] [MainThread]: On master: BEGIN
[0m18:58:01.292717 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:01.293931 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:58:01.294275 [debug] [MainThread]: On master: COMMIT
[0m18:58:01.294605 [debug] [MainThread]: Using duckdb connection "master"
[0m18:58:01.294917 [debug] [MainThread]: On master: COMMIT
[0m18:58:01.295541 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:58:01.295875 [debug] [MainThread]: On master: Close
[0m18:58:01.296291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:01.296592 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m18:58:01.296881 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m18:58:01.297167 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m18:58:01.297457 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m18:58:01.297742 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__vix_with_versions' was properly closed.
[0m18:58:01.298110 [info ] [MainThread]: 
[0m18:58:01.298632 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m18:58:01.299838 [debug] [MainThread]: Command end result
[0m18:58:01.350605 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:58:01.354184 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:58:01.363349 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m18:58:01.363854 [info ] [MainThread]: 
[0m18:58:01.364506 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:58:01.365037 [info ] [MainThread]: 
[0m18:58:01.365623 [error] [MainThread]: [31mFailure in model stg__vix_with_versions (models\silver\stg\stg__vix_with_versions.sql)[0m
[0m18:58:01.366215 [error] [MainThread]:   Runtime Error in model stg__vix_with_versions (models\silver\stg\stg__vix_with_versions.sql)
  Binder Error: Column "effective_date" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m18:58:01.366719 [info ] [MainThread]: 
[0m18:58:01.367306 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\stg\stg__vix_with_versions.sql
[0m18:58:01.367807 [info ] [MainThread]: 
[0m18:58:01.368322 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=4
[0m18:58:01.369237 [debug] [MainThread]: Command `-c run` failed at 18:58:01.369120 after 4.31 seconds
[0m18:58:01.369624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD2602030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD3B6BE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD180FAD0>]}
[0m18:58:01.370007 [debug] [MainThread]: Flushing usage events
[0m18:58:02.053864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:58:36.865222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF26B68050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF273742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF279B7ED0>]}


============================== 18:58:36.869583 | 9c177eb5-f237-4bb1-a72e-8a10ee825cc8 ==============================
[0m18:58:36.869583 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:58:36.870474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select +int__regime_changes', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m18:58:37.134575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c177eb5-f237-4bb1-a72e-8a10ee825cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF26D20180>]}
[0m18:58:37.206636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c177eb5-f237-4bb1-a72e-8a10ee825cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2785B790>]}
[0m18:58:37.209219 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:58:37.463421 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:58:37.867512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:58:37.868174 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\stg\stg__vix_with_versions.sql
[0m18:58:38.231857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c177eb5-f237-4bb1-a72e-8a10ee825cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF292A1D50>]}
[0m18:58:38.373178 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:58:38.376012 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:58:38.407287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c177eb5-f237-4bb1-a72e-8a10ee825cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF28CF0B90>]}
[0m18:58:38.407887 [info ] [MainThread]: Found 9 models, 46 data tests, 1 snapshot, 1 seed, 2 sources, 853 macros
[0m18:58:38.408592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c177eb5-f237-4bb1-a72e-8a10ee825cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF27873150>]}
[0m18:58:38.410928 [info ] [MainThread]: 
[0m18:58:38.411427 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:58:38.411896 [info ] [MainThread]: 
[0m18:58:38.412508 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:58:38.417165 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m18:58:38.493171 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m18:58:38.493561 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m18:58:38.493872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:39.886053 [debug] [ThreadPool]: SQL status: OK in 1.392 seconds
[0m18:58:39.887717 [debug] [ThreadPool]: On list_finance: Close
[0m18:58:39.888474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m18:58:39.889008 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m18:58:39.895565 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:58:39.895934 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m18:58:39.896251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:39.897830 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:58:39.899068 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:58:39.899364 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m18:58:39.900286 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:58:39.900577 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:58:39.900867 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m18:58:39.963856 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m18:58:39.965267 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:58:39.965758 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:58:39.966215 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:58:40.023729 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m18:58:40.024139 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m18:58:40.026420 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m18:58:40.032170 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:58:40.032664 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m18:58:40.032975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:40.033591 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m18:58:40.035634 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:58:40.035957 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m18:58:40.036233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:40.036908 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:58:40.037231 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:58:40.037533 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m18:58:40.037968 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:58:40.038288 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:58:40.038598 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m18:58:40.062374 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m18:58:40.062812 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m18:58:40.063978 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m18:58:40.065280 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m18:58:40.066347 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m18:58:40.066650 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m18:58:40.067132 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m18:58:40.067440 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m18:58:40.069922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c177eb5-f237-4bb1-a72e-8a10ee825cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF293A72B0>]}
[0m18:58:40.070358 [debug] [MainThread]: Using duckdb connection "master"
[0m18:58:40.070649 [debug] [MainThread]: On master: BEGIN
[0m18:58:40.070922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:40.072189 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:58:40.072573 [debug] [MainThread]: On master: COMMIT
[0m18:58:40.072872 [debug] [MainThread]: Using duckdb connection "master"
[0m18:58:40.073150 [debug] [MainThread]: On master: COMMIT
[0m18:58:40.073728 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:58:40.074027 [debug] [MainThread]: On master: Close
[0m18:58:40.078694 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m18:58:40.079193 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m18:58:40.079878 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m18:58:40.080250 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m18:58:40.087605 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m18:58:40.088729 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m18:58:40.119125 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m18:58:40.120133 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:58:40.120495 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m18:58:40.120818 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:58:40.122380 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:58:40.122814 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:58:40.123260 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m18:58:40.195931 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m18:58:40.203256 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:58:40.203653 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m18:58:40.267669 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m18:58:40.273490 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:58:40.274199 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m18:58:40.350586 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m18:58:40.374294 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:58:40.374886 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:58:40.375343 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:58:40.512213 [debug] [Thread-1 (]: SQL status: OK in 0.136 seconds
[0m18:58:40.529099 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:58:40.530400 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m18:58:40.646545 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m18:58:40.648869 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m18:58:40.650859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c177eb5-f237-4bb1-a72e-8a10ee825cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF295D59D0>]}
[0m18:58:40.651524 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.57s]
[0m18:58:40.652335 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m18:58:40.653128 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m18:58:40.653618 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_dev.stg__vix_with_versions ............... [RUN]
[0m18:58:40.654366 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m18:58:40.654740 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m18:58:40.657912 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m18:58:40.658839 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m18:58:40.662479 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m18:58:40.663398 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m18:58:40.663773 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m18:58:40.664106 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:58:40.665443 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:58:40.665820 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m18:58:40.666229 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    left join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
  );

[0m18:58:40.766837 [debug] [Thread-2 (]: SQL status: OK in 0.100 seconds
[0m18:58:40.773911 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m18:58:40.774920 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m18:58:40.845297 [debug] [Thread-2 (]: SQL status: OK in 0.069 seconds
[0m18:58:40.850223 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m18:58:40.851809 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m18:58:40.853303 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m18:58:40.982272 [debug] [Thread-2 (]: SQL status: OK in 0.128 seconds
[0m18:58:40.985167 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m18:58:40.985578 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m18:58:41.132798 [debug] [Thread-2 (]: SQL status: OK in 0.146 seconds
[0m18:58:41.138059 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m18:58:41.140262 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c177eb5-f237-4bb1-a72e-8a10ee825cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF295B8890>]}
[0m18:58:41.142638 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_dev.stg__vix_with_versions .......... [[32mOK[0m in 0.49s]
[0m18:58:41.145762 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m18:58:41.148065 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m18:58:41.149538 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m18:58:41.151540 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m18:58:41.152916 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m18:58:41.159036 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m18:58:41.160213 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m18:58:41.163923 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m18:58:41.164880 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:58:41.165248 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m18:58:41.165582 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:58:41.166851 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:58:41.167200 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:58:41.167569 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
select
    trade_date,
    "close",
    loaded_at,
    version_id,
    version_name,
    complacent_max,
    normal_max,
    elevated_max,
    effective_date, 
    version_rank
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < complacent_max then 'complacent'
            when "close" >= complacent_max and close < normal_max then 'normal'
            when "close" >= normal_max and "close" < elevated_max then 'elevated'
            when "close" >= elevated_max then 'crises'
        end) as regime, 
        loaded_at
    from base b
    where version_rank = 1
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m18:58:41.172811 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
select
    trade_date,
    "close",
    loaded_at,
    version_id,
    version_name,
    complacent_max,
    normal_max,
    elevated_max,
    effective_date, 
    version_rank
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < complacent_max then 'complacent'
            when "close" >= complacent_max and close < normal_max then 'normal'
            when "close" >= normal_max and "close" < elevated_max then 'elevated'
            when "close" >= elevated_max then 'crises'
        end) as regime, 
        loaded_at
    from base b
    where version_rank = 1
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m18:58:41.173401 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m18:58:41.174051 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: ROLLBACK
[0m18:58:41.181983 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.int__regime_classification'
[0m18:58:41.182407 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m18:58:41.186348 [debug] [Thread-3 (]: Runtime Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  Parser Error: syntax error at or near "select"
  
  LINE 7: select
          ^
[0m18:58:41.186767 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c177eb5-f237-4bb1-a72e-8a10ee825cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2AC3D770>]}
[0m18:58:41.187320 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model analytics_dev.int__regime_classification .. [[31mERROR[0m in 0.04s]
[0m18:58:41.188120 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m18:58:41.188694 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.int__regime_classification' to be skipped because of status 'error'.  Reason: Runtime Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  Parser Error: syntax error at or near "select"
  
  LINE 7: select
          ^.
[0m18:58:41.190039 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m18:58:41.190662 [info ] [Thread-4 (]: 4 of 4 SKIP relation analytics_dev.int__regime_changes ......................... [[33mSKIP[0m]
[0m18:58:41.191372 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m18:58:41.193032 [debug] [MainThread]: Using duckdb connection "master"
[0m18:58:41.193392 [debug] [MainThread]: On master: BEGIN
[0m18:58:41.193689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:41.194798 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:58:41.195103 [debug] [MainThread]: On master: COMMIT
[0m18:58:41.195392 [debug] [MainThread]: Using duckdb connection "master"
[0m18:58:41.195672 [debug] [MainThread]: On master: COMMIT
[0m18:58:41.196215 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:58:41.196519 [debug] [MainThread]: On master: Close
[0m18:58:41.196964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:41.197237 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m18:58:41.197499 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m18:58:41.197756 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m18:58:41.198009 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m18:58:41.198262 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__vix_with_versions' was properly closed.
[0m18:58:41.198518 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m18:58:41.198858 [info ] [MainThread]: 
[0m18:58:41.199361 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m18:58:41.200622 [debug] [MainThread]: Command end result
[0m18:58:41.249968 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:58:41.252345 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:58:41.258250 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m18:58:41.258624 [info ] [MainThread]: 
[0m18:58:41.259181 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:58:41.259695 [info ] [MainThread]: 
[0m18:58:41.260292 [error] [MainThread]: [31mFailure in model int__regime_classification (models\silver\int\int__regime_classification.sql)[0m
[0m18:58:41.260876 [error] [MainThread]:   Runtime Error in model int__regime_classification (models\silver\int\int__regime_classification.sql)
  Parser Error: syntax error at or near "select"
  
  LINE 7: select
          ^
[0m18:58:41.261407 [info ] [MainThread]: 
[0m18:58:41.261958 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\silver\int\int__regime_classification.sql
[0m18:58:41.262451 [info ] [MainThread]: 
[0m18:58:41.262948 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=4
[0m18:58:41.263855 [debug] [MainThread]: Command `-c run` failed at 18:58:41.263742 after 4.52 seconds
[0m18:58:41.264227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF28CB39D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF26C9FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF278BFB60>]}
[0m18:58:41.264585 [debug] [MainThread]: Flushing usage events
[0m18:58:41.912844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:59:01.080542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BEAF8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BF3042D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BF947ED0>]}


============================== 18:59:01.085342 | 8e620f07-c84d-4185-9195-6ddef1075b9f ==============================
[0m18:59:01.085342 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:59:01.086549 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +int__regime_changes', 'printer_width': '80', 'write_json': 'True'}
[0m18:59:01.432861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e620f07-c84d-4185-9195-6ddef1075b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BECB0180>]}
[0m18:59:01.502537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e620f07-c84d-4185-9195-6ddef1075b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BF7EB790>]}
[0m18:59:01.505237 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:59:01.771740 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:59:02.194913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:59:02.195576 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_classification.sql
[0m18:59:02.557907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e620f07-c84d-4185-9195-6ddef1075b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C127DD50>]}
[0m18:59:02.692149 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:59:02.694565 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:59:02.724162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e620f07-c84d-4185-9195-6ddef1075b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C0CC0B90>]}
[0m18:59:02.724614 [info ] [MainThread]: Found 9 models, 46 data tests, 1 snapshot, 1 seed, 2 sources, 853 macros
[0m18:59:02.725139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e620f07-c84d-4185-9195-6ddef1075b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BF803150>]}
[0m18:59:02.727216 [info ] [MainThread]: 
[0m18:59:02.727717 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:59:02.728227 [info ] [MainThread]: 
[0m18:59:02.728841 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:59:02.733872 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m18:59:02.813501 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m18:59:02.813886 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m18:59:02.814186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:04.144460 [debug] [ThreadPool]: SQL status: OK in 1.330 seconds
[0m18:59:04.146078 [debug] [ThreadPool]: On list_finance: Close
[0m18:59:04.146873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m18:59:04.147367 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m18:59:04.153652 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:59:04.153983 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m18:59:04.154290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:59:04.155767 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:59:04.157047 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:59:04.157362 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m18:59:04.158293 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:59:04.158608 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:59:04.158906 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m18:59:04.212079 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m18:59:04.213173 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:59:04.213554 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m18:59:04.213945 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m18:59:04.261202 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m18:59:04.262061 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m18:59:04.266541 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m18:59:04.272908 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:59:04.273308 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m18:59:04.273755 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m18:59:04.274096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:04.276421 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:59:04.277097 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m18:59:04.277409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:04.278003 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:59:04.278337 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m18:59:04.278665 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m18:59:04.279124 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:59:04.279446 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m18:59:04.279750 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m18:59:04.304474 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m18:59:04.304943 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m18:59:04.306322 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m18:59:04.307473 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m18:59:04.308547 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m18:59:04.308858 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m18:59:04.309349 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m18:59:04.309666 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m18:59:04.312295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e620f07-c84d-4185-9195-6ddef1075b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C1387E10>]}
[0m18:59:04.312747 [debug] [MainThread]: Using duckdb connection "master"
[0m18:59:04.313058 [debug] [MainThread]: On master: BEGIN
[0m18:59:04.313357 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:59:04.314589 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:59:04.314927 [debug] [MainThread]: On master: COMMIT
[0m18:59:04.315270 [debug] [MainThread]: Using duckdb connection "master"
[0m18:59:04.315578 [debug] [MainThread]: On master: COMMIT
[0m18:59:04.316169 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:59:04.316497 [debug] [MainThread]: On master: Close
[0m18:59:04.321236 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m18:59:04.321752 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m18:59:04.322449 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m18:59:04.322824 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m18:59:04.329779 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m18:59:04.330673 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m18:59:04.360833 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m18:59:04.361788 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:59:04.362164 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m18:59:04.362502 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:59:04.363865 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:59:04.364242 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:59:04.364617 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m18:59:04.530779 [debug] [Thread-1 (]: SQL status: OK in 0.166 seconds
[0m18:59:04.537600 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:59:04.538055 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m18:59:04.613946 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m18:59:04.617893 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:59:04.618377 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m18:59:04.701370 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m18:59:04.712818 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:59:04.713248 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:59:04.713590 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m18:59:04.951368 [debug] [Thread-1 (]: SQL status: OK in 0.237 seconds
[0m18:59:04.960203 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m18:59:04.961245 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m18:59:05.085538 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m18:59:05.087875 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m18:59:05.089825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e620f07-c84d-4185-9195-6ddef1075b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C15B9850>]}
[0m18:59:05.090427 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.77s]
[0m18:59:05.091227 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m18:59:05.091984 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m18:59:05.092449 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_dev.stg__vix_with_versions ............... [RUN]
[0m18:59:05.093202 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m18:59:05.093566 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m18:59:05.096622 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m18:59:05.097475 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m18:59:05.100852 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m18:59:05.101645 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m18:59:05.101997 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m18:59:05.102329 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:59:05.103518 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:59:05.103864 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m18:59:05.104243 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    left join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
  );

[0m18:59:05.210146 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m18:59:05.213382 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m18:59:05.213755 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m18:59:05.283197 [debug] [Thread-2 (]: SQL status: OK in 0.069 seconds
[0m18:59:05.292114 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m18:59:05.293315 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m18:59:05.365826 [debug] [Thread-2 (]: SQL status: OK in 0.072 seconds
[0m18:59:05.367311 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m18:59:05.367745 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m18:59:05.368151 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m18:59:05.560899 [debug] [Thread-2 (]: SQL status: OK in 0.192 seconds
[0m18:59:05.563416 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m18:59:05.563815 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m18:59:05.682781 [debug] [Thread-2 (]: SQL status: OK in 0.119 seconds
[0m18:59:05.684445 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m18:59:05.684956 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e620f07-c84d-4185-9195-6ddef1075b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C1598EC0>]}
[0m18:59:05.685514 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_dev.stg__vix_with_versions .......... [[32mOK[0m in 0.59s]
[0m18:59:05.686315 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m18:59:05.687001 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m18:59:05.687463 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m18:59:05.688145 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m18:59:05.688510 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m18:59:05.691083 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m18:59:05.691935 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m18:59:05.695300 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m18:59:05.696138 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:59:05.696498 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m18:59:05.696834 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:59:05.698450 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:59:05.698928 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:59:05.699319 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date, 
        version_rank
    from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < complacent_max then 'complacent'
            when "close" >= complacent_max and close < normal_max then 'normal'
            when "close" >= normal_max and "close" < elevated_max then 'elevated'
            when "close" >= elevated_max then 'crises'
        end) as regime, 
        loaded_at
    from base b
    where version_rank = 1
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m18:59:05.828688 [debug] [Thread-3 (]: SQL status: OK in 0.128 seconds
[0m18:59:05.839685 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:59:05.840157 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m18:59:05.902755 [debug] [Thread-3 (]: SQL status: OK in 0.062 seconds
[0m18:59:05.912130 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:59:05.912846 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m18:59:05.974414 [debug] [Thread-3 (]: SQL status: OK in 0.061 seconds
[0m18:59:05.976757 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m18:59:05.977459 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:59:05.977930 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m18:59:06.167249 [debug] [Thread-3 (]: SQL status: OK in 0.189 seconds
[0m18:59:06.170627 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m18:59:06.171159 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m18:59:06.340744 [debug] [Thread-3 (]: SQL status: OK in 0.169 seconds
[0m18:59:06.342324 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m18:59:06.342914 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e620f07-c84d-4185-9195-6ddef1075b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C17EC190>]}
[0m18:59:06.343578 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.65s]
[0m18:59:06.344613 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m18:59:06.345440 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m18:59:06.346040 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m18:59:06.346935 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m18:59:06.347448 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m18:59:06.350872 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m18:59:06.351968 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m18:59:06.356176 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m18:59:06.357356 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:59:06.357863 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m18:59:06.358207 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:59:06.360000 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:59:06.360595 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:59:06.361099 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime,
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(order by trade_date asc, loaded_at asc) as regime_period_id
    from regime_changes
)

    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
    order by min(trade_date) asc
  );

[0m18:59:06.474043 [debug] [Thread-4 (]: SQL status: OK in 0.112 seconds
[0m18:59:06.477969 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:59:06.478413 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m18:59:06.553399 [debug] [Thread-4 (]: SQL status: OK in 0.075 seconds
[0m18:59:06.556821 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:59:06.557212 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m18:59:06.640480 [debug] [Thread-4 (]: SQL status: OK in 0.082 seconds
[0m18:59:06.645666 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m18:59:06.647631 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:59:06.649219 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m18:59:06.761640 [debug] [Thread-4 (]: SQL status: OK in 0.111 seconds
[0m18:59:06.764017 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m18:59:06.764389 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m18:59:06.928841 [debug] [Thread-4 (]: SQL status: OK in 0.164 seconds
[0m18:59:06.930466 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m18:59:06.930996 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e620f07-c84d-4185-9195-6ddef1075b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C1669350>]}
[0m18:59:06.931597 [info ] [Thread-4 (]: 4 of 4 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.58s]
[0m18:59:06.932444 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m18:59:06.933784 [debug] [MainThread]: Using duckdb connection "master"
[0m18:59:06.934099 [debug] [MainThread]: On master: BEGIN
[0m18:59:06.934387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:59:06.935648 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:59:06.935959 [debug] [MainThread]: On master: COMMIT
[0m18:59:06.936253 [debug] [MainThread]: Using duckdb connection "master"
[0m18:59:06.936538 [debug] [MainThread]: On master: COMMIT
[0m18:59:06.937137 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:59:06.937449 [debug] [MainThread]: On master: Close
[0m18:59:06.937820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:06.938093 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m18:59:06.938355 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m18:59:06.938615 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m18:59:06.938876 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m18:59:06.939137 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__vix_with_versions' was properly closed.
[0m18:59:06.939403 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m18:59:06.939658 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m18:59:06.940003 [info ] [MainThread]: 
[0m18:59:06.940485 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.21 seconds (4.21s).
[0m18:59:06.942062 [debug] [MainThread]: Command end result
[0m18:59:06.992075 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m18:59:06.994716 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m18:59:07.001055 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m18:59:07.001446 [info ] [MainThread]: 
[0m18:59:07.001981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:59:07.002558 [info ] [MainThread]: 
[0m18:59:07.003242 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m18:59:07.004240 [debug] [MainThread]: Command `-c run` succeeded at 18:59:07.004123 after 6.09 seconds
[0m18:59:07.004605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BF84FB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239B8FDF150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BEB3F170>]}
[0m18:59:07.004970 [debug] [MainThread]: Flushing usage events
[0m18:59:07.781345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:02:50.640918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC1378050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC1B842D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC21C7ED0>]}


============================== 19:02:50.646761 | 67ca9c54-fef5-4676-9485-182adc0f5112 ==============================
[0m19:02:50.646761 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:02:50.647539 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select +int__regime_changes', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m19:02:50.919875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67ca9c54-fef5-4676-9485-182adc0f5112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC1530180>]}
[0m19:02:50.988474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67ca9c54-fef5-4676-9485-182adc0f5112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC206B790>]}
[0m19:02:50.991033 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:02:51.257153 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:02:51.726804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:02:51.727476 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m19:02:52.120557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67ca9c54-fef5-4676-9485-182adc0f5112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC3AEE050>]}
[0m19:02:52.268876 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:02:52.271377 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:02:52.306533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67ca9c54-fef5-4676-9485-182adc0f5112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC3540B90>]}
[0m19:02:52.307159 [info ] [MainThread]: Found 9 models, 46 data tests, 1 snapshot, 1 seed, 2 sources, 853 macros
[0m19:02:52.308019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67ca9c54-fef5-4676-9485-182adc0f5112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC2083150>]}
[0m19:02:52.312726 [info ] [MainThread]: 
[0m19:02:52.313776 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:02:52.314731 [info ] [MainThread]: 
[0m19:02:52.315543 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:02:52.322196 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m19:02:52.418739 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m19:02:52.419135 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m19:02:52.419454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:53.880335 [debug] [ThreadPool]: SQL status: OK in 1.461 seconds
[0m19:02:53.881795 [debug] [ThreadPool]: On list_finance: Close
[0m19:02:53.882517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m19:02:53.883025 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m19:02:53.889109 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:02:53.889432 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:02:53.889730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:02:53.891717 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:02:53.893465 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:02:53.893812 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m19:02:53.894877 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:02:53.895269 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:02:53.895595 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m19:02:53.952251 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m19:02:53.953466 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:02:53.953877 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:02:53.954258 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:02:54.009332 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m19:02:54.010507 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m19:02:54.012734 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m19:02:54.018608 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:02:54.019142 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m19:02:54.019468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:54.020124 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m19:02:54.022191 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:02:54.022516 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m19:02:54.022803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:54.023447 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:02:54.023781 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:02:54.024113 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m19:02:54.024680 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:02:54.025015 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:02:54.025348 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m19:02:54.049369 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m19:02:54.049763 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m19:02:54.051007 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m19:02:54.052407 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m19:02:54.053343 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m19:02:54.053660 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m19:02:54.054280 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m19:02:54.054581 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m19:02:54.057385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67ca9c54-fef5-4676-9485-182adc0f5112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC3EE81F0>]}
[0m19:02:54.057834 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:54.058144 [debug] [MainThread]: On master: BEGIN
[0m19:02:54.058441 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:02:54.059524 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:02:54.059830 [debug] [MainThread]: On master: COMMIT
[0m19:02:54.060126 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:54.060405 [debug] [MainThread]: On master: COMMIT
[0m19:02:54.060945 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:02:54.061251 [debug] [MainThread]: On master: Close
[0m19:02:54.066016 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m19:02:54.066527 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m19:02:54.067212 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m19:02:54.067580 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m19:02:54.074344 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m19:02:54.075267 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m19:02:54.105827 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m19:02:54.106804 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:02:54.107173 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m19:02:54.107508 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:02:54.108911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:54.109265 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:02:54.109616 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m19:02:54.181795 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m19:02:54.189240 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:02:54.189640 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m19:02:54.274433 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m19:02:54.284294 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:02:54.285193 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m19:02:54.371285 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m19:02:54.396471 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m19:02:54.396898 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:02:54.397236 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m19:02:54.537390 [debug] [Thread-1 (]: SQL status: OK in 0.140 seconds
[0m19:02:54.542743 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:02:54.543386 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m19:02:54.674310 [debug] [Thread-1 (]: SQL status: OK in 0.130 seconds
[0m19:02:54.676918 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m19:02:54.679181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ca9c54-fef5-4676-9485-182adc0f5112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC3E21A90>]}
[0m19:02:54.679861 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.61s]
[0m19:02:54.680723 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m19:02:54.681552 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m19:02:54.682072 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_dev.stg__vix_with_versions ............... [RUN]
[0m19:02:54.682844 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m19:02:54.683253 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m19:02:54.686346 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m19:02:54.687239 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m19:02:54.690541 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m19:02:54.691399 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:02:54.691778 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m19:02:54.692161 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:02:54.693383 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:02:54.693773 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:02:54.694193 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    left join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
  );

[0m19:02:54.790165 [debug] [Thread-2 (]: SQL status: OK in 0.095 seconds
[0m19:02:54.793263 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:02:54.793703 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m19:02:54.855483 [debug] [Thread-2 (]: SQL status: OK in 0.061 seconds
[0m19:02:54.858704 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:02:54.859097 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m19:02:55.091465 [debug] [Thread-2 (]: SQL status: OK in 0.232 seconds
[0m19:02:55.092790 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m19:02:55.093166 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:02:55.093511 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m19:02:55.216400 [debug] [Thread-2 (]: SQL status: OK in 0.122 seconds
[0m19:02:55.219089 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:02:55.219481 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m19:02:55.340449 [debug] [Thread-2 (]: SQL status: OK in 0.120 seconds
[0m19:02:55.342387 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m19:02:55.343004 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ca9c54-fef5-4676-9485-182adc0f5112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC3E04EC0>]}
[0m19:02:55.343668 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_dev.stg__vix_with_versions .......... [[32mOK[0m in 0.66s]
[0m19:02:55.344525 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m19:02:55.345308 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m19:02:55.345828 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m19:02:55.346590 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m19:02:55.347001 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m19:02:55.349907 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m19:02:55.350925 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m19:02:55.354520 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m19:02:55.355509 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:02:55.355904 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m19:02:55.356267 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:02:55.357682 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:02:55.358179 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:02:55.358668 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date, 
        version_rank
    from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < complacent_max then 'complacent'
            when "close" >= complacent_max and close < normal_max then 'normal'
            when "close" >= normal_max and "close" < elevated_max then 'elevated'
            when "close" >= elevated_max then 'crises'
        end) as regime, 
        loaded_at
    from base b
    where version_rank = 1
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m19:02:55.463486 [debug] [Thread-3 (]: SQL status: OK in 0.104 seconds
[0m19:02:55.466657 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:02:55.467085 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m19:02:55.579153 [debug] [Thread-3 (]: SQL status: OK in 0.112 seconds
[0m19:02:55.586313 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:02:55.586769 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m19:02:55.656950 [debug] [Thread-3 (]: SQL status: OK in 0.070 seconds
[0m19:02:55.658515 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m19:02:55.658953 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:02:55.659311 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m19:02:55.794698 [debug] [Thread-3 (]: SQL status: OK in 0.135 seconds
[0m19:02:55.797606 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:02:55.798241 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m19:02:55.921454 [debug] [Thread-3 (]: SQL status: OK in 0.122 seconds
[0m19:02:55.923072 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m19:02:55.923601 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ca9c54-fef5-4676-9485-182adc0f5112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC405C230>]}
[0m19:02:55.924187 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.58s]
[0m19:02:55.925050 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m19:02:55.926129 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m19:02:55.927021 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m19:02:55.927971 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_changes'
[0m19:02:55.928366 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m19:02:55.931418 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m19:02:55.932358 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m19:02:55.935643 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m19:02:55.936755 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:02:55.937565 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m19:02:55.938644 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:02:55.941260 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:02:55.942618 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:02:55.943645 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime,
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(order by trade_date asc, loaded_at asc) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m19:02:56.097347 [debug] [Thread-4 (]: SQL status: OK in 0.153 seconds
[0m19:02:56.100626 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:02:56.101052 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m19:02:56.177105 [debug] [Thread-4 (]: SQL status: OK in 0.075 seconds
[0m19:02:56.189082 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:02:56.190290 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m19:02:56.415139 [debug] [Thread-4 (]: SQL status: OK in 0.224 seconds
[0m19:02:56.418844 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m19:02:56.419855 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:02:56.420670 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m19:02:56.568225 [debug] [Thread-4 (]: SQL status: OK in 0.147 seconds
[0m19:02:56.570791 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:02:56.571189 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m19:02:56.686188 [debug] [Thread-4 (]: SQL status: OK in 0.114 seconds
[0m19:02:56.687776 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m19:02:56.688455 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ca9c54-fef5-4676-9485-182adc0f5112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC3F45750>]}
[0m19:02:56.689072 [info ] [Thread-4 (]: 4 of 4 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.76s]
[0m19:02:56.689911 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m19:02:56.691663 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:56.692300 [debug] [MainThread]: On master: BEGIN
[0m19:02:56.692777 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:02:56.694072 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:02:56.694478 [debug] [MainThread]: On master: COMMIT
[0m19:02:56.694791 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:56.695075 [debug] [MainThread]: On master: COMMIT
[0m19:02:56.695715 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:02:56.696028 [debug] [MainThread]: On master: Close
[0m19:02:56.696425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:56.696700 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m19:02:56.696961 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m19:02:56.697220 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m19:02:56.697478 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m19:02:56.697742 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__vix_with_versions' was properly closed.
[0m19:02:56.698001 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m19:02:56.698257 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m19:02:56.698629 [info ] [MainThread]: 
[0m19:02:56.699193 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.38 seconds (4.38s).
[0m19:02:56.701158 [debug] [MainThread]: Command end result
[0m19:02:56.766724 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:02:56.770659 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:02:56.781107 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m19:02:56.781508 [info ] [MainThread]: 
[0m19:02:56.782068 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:02:56.782636 [info ] [MainThread]: 
[0m19:02:56.783202 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m19:02:56.784145 [debug] [MainThread]: Command `-c run` succeeded at 19:02:56.784026 after 6.39 seconds
[0m19:02:56.784513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC20CFB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBB86F150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC0D849B0>]}
[0m19:02:56.784876 [debug] [MainThread]: Flushing usage events
[0m19:02:57.679961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:11:47.587064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9C528050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9CD342D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9D373ED0>]}


============================== 19:11:47.591458 | cfba6c61-d9c1-4b06-b2c1-bf3e76583320 ==============================
[0m19:11:47.591458 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:11:47.592204 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt run --select +mrt__stocks_with_regimes', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m19:11:47.844278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfba6c61-d9c1-4b06-b2c1-bf3e76583320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9C6E0180>]}
[0m19:11:47.909801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfba6c61-d9c1-4b06-b2c1-bf3e76583320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9D21B790>]}
[0m19:11:47.912507 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:11:48.175387 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:11:48.579334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:11:48.579939 [debug] [MainThread]: Partial parsing: added file: portfolio_project_2://models\gold\mrt__stocks_with_regimes.sql
[0m19:11:48.937484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfba6c61-d9c1-4b06-b2c1-bf3e76583320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9EBC2050>]}
[0m19:11:49.082221 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:11:49.084921 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:11:49.115076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfba6c61-d9c1-4b06-b2c1-bf3e76583320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9E664B90>]}
[0m19:11:49.115553 [info ] [MainThread]: Found 10 models, 46 data tests, 1 snapshot, 1 seed, 2 sources, 853 macros
[0m19:11:49.116072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfba6c61-d9c1-4b06-b2c1-bf3e76583320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9D233310>]}
[0m19:11:49.117971 [info ] [MainThread]: 
[0m19:11:49.118483 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:11:49.118957 [info ] [MainThread]: 
[0m19:11:49.119592 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:11:49.120566 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m19:11:49.198534 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m19:11:49.198929 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m19:11:49.199250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:50.722547 [debug] [ThreadPool]: SQL status: OK in 1.523 seconds
[0m19:11:50.723906 [debug] [ThreadPool]: On list_finance: Close
[0m19:11:50.724575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m19:11:50.725049 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m19:11:50.731133 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:11:50.731486 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:11:50.731844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:50.733532 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:11:50.734844 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:11:50.735151 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m19:11:50.736105 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:11:50.736410 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:11:50.736704 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m19:11:50.788990 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m19:11:50.790654 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:11:50.791230 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:11:50.791809 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:11:50.852841 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m19:11:50.853365 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m19:11:50.861101 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m19:11:50.867221 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:11:50.867750 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m19:11:50.868086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:50.868757 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m19:11:50.870822 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:11:50.871153 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m19:11:50.871446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:50.872101 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:11:50.872442 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:11:50.872781 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m19:11:50.873259 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:11:50.873597 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:11:50.873930 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m19:11:50.898943 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m19:11:50.899329 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m19:11:50.900549 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m19:11:50.901931 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m19:11:50.902928 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m19:11:50.903278 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m19:11:50.904204 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m19:11:50.904509 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m19:11:50.907343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfba6c61-d9c1-4b06-b2c1-bf3e76583320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9F0B02C0>]}
[0m19:11:50.907855 [debug] [MainThread]: Using duckdb connection "master"
[0m19:11:50.908140 [debug] [MainThread]: On master: BEGIN
[0m19:11:50.908416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:50.909621 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:11:50.910017 [debug] [MainThread]: On master: COMMIT
[0m19:11:50.910335 [debug] [MainThread]: Using duckdb connection "master"
[0m19:11:50.910606 [debug] [MainThread]: On master: COMMIT
[0m19:11:50.911404 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:11:50.911947 [debug] [MainThread]: On master: Close
[0m19:11:50.916735 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:11:50.917233 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.mrt__stocks_with_regimes ............. [RUN]
[0m19:11:50.918082 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.mrt__stocks_with_regimes'
[0m19:11:50.918428 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:11:50.924451 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:11:50.925511 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:11:50.956133 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:11:50.957172 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:11:50.957556 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m19:11:50.957898 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:11:50.959230 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:11:50.959622 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:11:50.960022 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
  create view "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_tmp" as (
    with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from final
), 

src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume, 
        loaded_at
    from src
)

select
    s.trade_date, 
    s.ticker, 
    s."open", 
    s.high, 
    s.low, 
    s."close", 
    s.volume, 
    s.loaded_at, 
    r.regime
from src_stocks s
join regimes r on s.trade_date BETWEEN r."start_date" and r.end_date
  );

[0m19:11:51.019949 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
  create view "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_tmp" as (
    with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from final
), 

src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume, 
        loaded_at
    from src
)

select
    s.trade_date, 
    s.ticker, 
    s."open", 
    s.high, 
    s.low, 
    s."close", 
    s.volume, 
    s.loaded_at, 
    r.regime
from src_stocks s
join regimes r on s.trade_date BETWEEN r."start_date" and r.end_date
  );

[0m19:11:51.020637 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:11:51.021257 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: ROLLBACK
[0m19:11:51.028855 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.mrt__stocks_with_regimes'
[0m19:11:51.029257 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m19:11:51.033730 [debug] [Thread-1 (]: Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  Catalog Error: Table with name final does not exist!
  Did you mean "int__regime_classification"?
  
  LINE 12: from final
                ^
[0m19:11:51.035765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfba6c61-d9c1-4b06-b2c1-bf3e76583320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9F041FD0>]}
[0m19:11:51.036423 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_dev.mrt__stocks_with_regimes .... [[31mERROR[0m in 0.12s]
[0m19:11:51.037271 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:11:51.037892 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.mrt__stocks_with_regimes' to be skipped because of status 'error'.  Reason: Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  Catalog Error: Table with name final does not exist!
  Did you mean "int__regime_classification"?
  
  LINE 12: from final
                ^.
[0m19:11:51.039803 [debug] [MainThread]: Using duckdb connection "master"
[0m19:11:51.040135 [debug] [MainThread]: On master: BEGIN
[0m19:11:51.040439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:11:51.041737 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:11:51.042079 [debug] [MainThread]: On master: COMMIT
[0m19:11:51.042407 [debug] [MainThread]: Using duckdb connection "master"
[0m19:11:51.042720 [debug] [MainThread]: On master: COMMIT
[0m19:11:51.043330 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:11:51.043670 [debug] [MainThread]: On master: Close
[0m19:11:51.044080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:51.044378 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m19:11:51.044693 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m19:11:51.045018 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m19:11:51.045291 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m19:11:51.045606 [info ] [MainThread]: 
[0m19:11:51.046128 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m19:11:51.047047 [debug] [MainThread]: Command end result
[0m19:11:51.097726 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:11:51.100361 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:11:51.106134 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m19:11:51.106454 [info ] [MainThread]: 
[0m19:11:51.107077 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:11:51.107644 [info ] [MainThread]: 
[0m19:11:51.108309 [error] [MainThread]: [31mFailure in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)[0m
[0m19:11:51.108878 [error] [MainThread]:   Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  Catalog Error: Table with name final does not exist!
  Did you mean "int__regime_classification"?
  
  LINE 12: from final
                ^
[0m19:11:51.109416 [info ] [MainThread]: 
[0m19:11:51.109972 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\mrt__stocks_with_regimes.sql
[0m19:11:51.110432 [info ] [MainThread]: 
[0m19:11:51.110935 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:11:51.112249 [debug] [MainThread]: Command `-c run` failed at 19:11:51.112084 after 3.69 seconds
[0m19:11:51.112671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9EF1E620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9ECC1770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9ECC1810>]}
[0m19:11:51.113035 [debug] [MainThread]: Flushing usage events
[0m19:11:51.938441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:12:35.492062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F07068050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F078742D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F07EB7ED0>]}


============================== 19:12:35.496438 | 41853857-dab5-4e4f-9e64-bb44199f3799 ==============================
[0m19:12:35.496438 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:12:35.497172 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select +mrt__stocks_with_regimes', 'printer_width': '80', 'write_json': 'True'}
[0m19:12:35.746849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41853857-dab5-4e4f-9e64-bb44199f3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F07220180>]}
[0m19:12:35.812623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41853857-dab5-4e4f-9e64-bb44199f3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F07D5B790>]}
[0m19:12:35.815101 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:12:36.071904 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:12:36.469580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:12:36.470251 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\gold\mrt__stocks_with_regimes.sql
[0m19:12:36.827028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41853857-dab5-4e4f-9e64-bb44199f3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F0974A050>]}
[0m19:12:36.963031 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:12:36.965568 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:12:36.991557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41853857-dab5-4e4f-9e64-bb44199f3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F09190B90>]}
[0m19:12:36.992016 [info ] [MainThread]: Found 10 models, 46 data tests, 1 snapshot, 1 seed, 2 sources, 853 macros
[0m19:12:36.992502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41853857-dab5-4e4f-9e64-bb44199f3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F07D73150>]}
[0m19:12:36.994598 [info ] [MainThread]: 
[0m19:12:36.995040 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:12:36.995440 [info ] [MainThread]: 
[0m19:12:36.996153 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:12:37.000981 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m19:12:37.077737 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m19:12:37.078145 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m19:12:37.078467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:38.751464 [debug] [ThreadPool]: SQL status: OK in 1.673 seconds
[0m19:12:38.752824 [debug] [ThreadPool]: On list_finance: Close
[0m19:12:38.753506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m19:12:38.753968 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m19:12:38.759932 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:12:38.760263 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:12:38.760565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:12:38.762385 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:12:38.763740 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:12:38.764058 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m19:12:38.765068 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:12:38.765368 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:12:38.765662 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m19:12:38.817900 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m19:12:38.819557 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:12:38.820253 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:12:38.820986 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:12:38.869467 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m19:12:38.871199 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m19:12:38.874404 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m19:12:38.880628 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:12:38.881004 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m19:12:38.881327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:38.882317 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m19:12:38.884524 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:12:38.884889 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m19:12:38.885214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:38.885946 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m19:12:38.886316 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:12:38.886672 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m19:12:38.887340 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:12:38.887715 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:12:38.888084 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m19:12:38.911768 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m19:12:38.912163 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m19:12:38.913399 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m19:12:38.914825 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m19:12:38.915906 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m19:12:38.916504 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m19:12:38.916835 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m19:12:38.917201 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m19:12:38.920136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41853857-dab5-4e4f-9e64-bb44199f3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F09B381F0>]}
[0m19:12:38.920594 [debug] [MainThread]: Using duckdb connection "master"
[0m19:12:38.920907 [debug] [MainThread]: On master: BEGIN
[0m19:12:38.921204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:12:38.922403 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:12:38.922735 [debug] [MainThread]: On master: COMMIT
[0m19:12:38.923039 [debug] [MainThread]: Using duckdb connection "master"
[0m19:12:38.923325 [debug] [MainThread]: On master: COMMIT
[0m19:12:38.923944 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:12:38.924257 [debug] [MainThread]: On master: Close
[0m19:12:38.928846 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m19:12:38.929789 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m19:12:38.929353 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m19:12:38.930927 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m19:12:38.931294 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m19:12:38.938447 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m19:12:38.930452 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m19:12:38.939256 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m19:12:38.939923 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m19:12:38.942643 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m19:12:38.943426 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m19:12:38.949309 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m19:12:38.988411 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m19:12:38.989203 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m19:12:38.990707 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:12:38.991117 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m19:12:38.991458 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:12:38.992313 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:12:38.992889 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m19:12:38.993240 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:12:38.993984 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:12:38.994345 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:12:38.994703 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m19:12:38.995188 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:12:38.995651 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:12:38.996090 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m19:12:39.212874 [debug] [Thread-2 (]: SQL status: OK in 0.216 seconds
[0m19:12:39.219696 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:12:39.220093 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m19:12:39.220637 [debug] [Thread-1 (]: SQL status: OK in 0.225 seconds
[0m19:12:39.223873 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:12:39.224258 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m19:12:39.281635 [debug] [Thread-2 (]: SQL status: OK in 0.061 seconds
[0m19:12:39.288809 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:12:39.289614 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m19:12:39.291310 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m19:12:39.296326 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:12:39.296977 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m19:12:39.365110 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m19:12:39.376462 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m19:12:39.376909 [debug] [Thread-2 (]: SQL status: OK in 0.087 seconds
[0m19:12:39.377333 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:12:39.378636 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m19:12:39.379068 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m19:12:39.379502 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:12:39.380100 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m19:12:39.520710 [debug] [Thread-2 (]: SQL status: OK in 0.140 seconds
[0m19:12:39.526381 [debug] [Thread-1 (]: SQL status: OK in 0.146 seconds
[0m19:12:39.526944 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:12:39.529385 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:12:39.529815 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m19:12:39.530259 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m19:12:39.736468 [debug] [Thread-2 (]: SQL status: OK in 0.206 seconds
[0m19:12:39.737064 [debug] [Thread-1 (]: SQL status: OK in 0.206 seconds
[0m19:12:39.740178 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m19:12:39.741965 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m19:12:39.744637 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41853857-dab5-4e4f-9e64-bb44199f3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F09A7E8D0>]}
[0m19:12:39.745679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41853857-dab5-4e4f-9e64-bb44199f3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F09A550D0>]}
[0m19:12:39.745329 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.81s]
[0m19:12:39.747014 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m19:12:39.746301 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.80s]
[0m19:12:39.748304 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m19:12:39.749276 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m19:12:39.749775 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics_dev.stg__vix_with_versions ............... [RUN]
[0m19:12:39.750633 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m19:12:39.751087 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m19:12:39.754329 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m19:12:39.755365 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m19:12:39.759464 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m19:12:39.760548 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:12:39.760982 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m19:12:39.761374 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:12:39.762972 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:12:39.763541 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:12:39.763961 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    left join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
  );

[0m19:12:39.847850 [debug] [Thread-3 (]: SQL status: OK in 0.083 seconds
[0m19:12:39.854506 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:12:39.855245 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m19:12:39.916341 [debug] [Thread-3 (]: SQL status: OK in 0.060 seconds
[0m19:12:39.930160 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:12:39.931089 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m19:12:40.022216 [debug] [Thread-3 (]: SQL status: OK in 0.090 seconds
[0m19:12:40.027605 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m19:12:40.029645 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:12:40.031200 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m19:12:40.186767 [debug] [Thread-3 (]: SQL status: OK in 0.154 seconds
[0m19:12:40.189355 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:12:40.189775 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m19:12:40.351504 [debug] [Thread-3 (]: SQL status: OK in 0.161 seconds
[0m19:12:40.352888 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m19:12:40.353402 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41853857-dab5-4e4f-9e64-bb44199f3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F0B1707D0>]}
[0m19:12:40.353968 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics_dev.stg__vix_with_versions .......... [[32mOK[0m in 0.60s]
[0m19:12:40.354779 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m19:12:40.355438 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m19:12:40.355911 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m19:12:40.356580 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m19:12:40.356957 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m19:12:40.359983 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m19:12:40.360925 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m19:12:40.364664 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m19:12:40.365713 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:12:40.366129 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m19:12:40.366473 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:12:40.367668 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:12:40.368033 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:12:40.368418 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date, 
        version_rank
    from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < complacent_max then 'complacent'
            when "close" >= complacent_max and close < normal_max then 'normal'
            when "close" >= normal_max and "close" < elevated_max then 'elevated'
            when "close" >= elevated_max then 'crises'
        end) as regime, 
        loaded_at
    from base b
    where version_rank = 1
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m19:12:40.438797 [debug] [Thread-4 (]: SQL status: OK in 0.070 seconds
[0m19:12:40.442177 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:12:40.442632 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m19:12:40.512670 [debug] [Thread-4 (]: SQL status: OK in 0.070 seconds
[0m19:12:40.515881 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:12:40.516278 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m19:12:40.579854 [debug] [Thread-4 (]: SQL status: OK in 0.063 seconds
[0m19:12:40.581307 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m19:12:40.581705 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:12:40.582182 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m19:12:40.705413 [debug] [Thread-4 (]: SQL status: OK in 0.122 seconds
[0m19:12:40.712980 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:12:40.713382 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m19:12:40.842916 [debug] [Thread-4 (]: SQL status: OK in 0.129 seconds
[0m19:12:40.844335 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m19:12:40.844995 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41853857-dab5-4e4f-9e64-bb44199f3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F09B197D0>]}
[0m19:12:40.845675 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.49s]
[0m19:12:40.846590 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m19:12:40.847250 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m19:12:40.847745 [info ] [Thread-2 (]: 5 of 6 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m19:12:40.848375 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_changes)
[0m19:12:40.848759 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m19:12:40.851801 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m19:12:40.852636 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m19:12:40.855620 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m19:12:40.856434 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:12:40.856796 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m19:12:40.857133 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:12:40.858350 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:12:40.858705 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:12:40.859099 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime,
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(order by trade_date asc, loaded_at asc) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m19:12:40.960889 [debug] [Thread-2 (]: SQL status: OK in 0.101 seconds
[0m19:12:40.963993 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:12:40.964374 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m19:12:41.060443 [debug] [Thread-2 (]: SQL status: OK in 0.095 seconds
[0m19:12:41.071292 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:12:41.072248 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m19:12:41.149203 [debug] [Thread-2 (]: SQL status: OK in 0.076 seconds
[0m19:12:41.151688 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m19:12:41.152431 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:12:41.153123 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m19:12:41.290160 [debug] [Thread-2 (]: SQL status: OK in 0.136 seconds
[0m19:12:41.292818 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:12:41.293189 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m19:12:41.397403 [debug] [Thread-2 (]: SQL status: OK in 0.104 seconds
[0m19:12:41.398763 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m19:12:41.399264 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41853857-dab5-4e4f-9e64-bb44199f3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F09659BE0>]}
[0m19:12:41.399823 [info ] [Thread-2 (]: 5 of 6 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.55s]
[0m19:12:41.400611 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m19:12:41.401272 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:12:41.401725 [info ] [Thread-1 (]: 6 of 6 START sql view model analytics_dev.mrt__stocks_with_regimes ............. [RUN]
[0m19:12:41.402326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m19:12:41.402868 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:12:41.405946 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:12:41.406804 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:12:41.409779 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:12:41.410722 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:12:41.411158 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m19:12:41.411571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:41.413029 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:12:41.413392 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:12:41.413760 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
  create view "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_tmp" as (
    with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 

src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume, 
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
)

select
    s.trade_date, 
    s.ticker, 
    s."open", 
    s.high, 
    s.low, 
    s."close", 
    s.volume, 
    s.loaded_at, 
    r.regime
from src_stocks s
join regimes r on s.trade_date BETWEEN r."start_date" and r.end_date
  );

[0m19:12:41.500671 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m19:12:41.505541 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:12:41.506221 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
alter view "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_tmp" rename to "mrt__stocks_with_regimes"
[0m19:12:41.591492 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m19:12:41.596584 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:12:41.598237 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:12:41.599798 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:12:41.751061 [debug] [Thread-1 (]: SQL status: OK in 0.150 seconds
[0m19:12:41.755373 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:12:41.756021 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop view if exists "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_backup" cascade
    
[0m19:12:41.817725 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m19:12:41.823175 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m19:12:41.825252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41853857-dab5-4e4f-9e64-bb44199f3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F09C178F0>]}
[0m19:12:41.827988 [info ] [Thread-1 (]: 6 of 6 OK created sql view model analytics_dev.mrt__stocks_with_regimes ........ [[32mOK[0m in 0.42s]
[0m19:12:41.830778 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:12:41.834568 [debug] [MainThread]: Using duckdb connection "master"
[0m19:12:41.835313 [debug] [MainThread]: On master: BEGIN
[0m19:12:41.836004 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:12:41.838327 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:12:41.839068 [debug] [MainThread]: On master: COMMIT
[0m19:12:41.839781 [debug] [MainThread]: Using duckdb connection "master"
[0m19:12:41.840461 [debug] [MainThread]: On master: COMMIT
[0m19:12:41.841771 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:12:41.842499 [debug] [MainThread]: On master: Close
[0m19:12:41.843520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:41.844196 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m19:12:41.844840 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m19:12:41.845468 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m19:12:41.846129 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m19:12:41.846757 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m19:12:41.847375 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__vix_with_versions' was properly closed.
[0m19:12:41.848008 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m19:12:41.848834 [info ] [MainThread]: 
[0m19:12:41.849852 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 4.85 seconds (4.85s).
[0m19:12:41.853093 [debug] [MainThread]: Command end result
[0m19:12:41.907466 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:12:41.909929 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:12:41.915897 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m19:12:41.916229 [info ] [MainThread]: 
[0m19:12:41.916758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:12:41.917246 [info ] [MainThread]: 
[0m19:12:41.917748 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m19:12:41.918633 [debug] [MainThread]: Command `-c run` succeeded at 19:12:41.918520 after 6.55 seconds
[0m19:12:41.918988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F07102150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F09858950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F09C17E90>]}
[0m19:12:41.919336 [debug] [MainThread]: Flushing usage events
[0m19:12:42.614044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:41.184158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002337B098050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002337B8A42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002337BEE3ED0>]}


============================== 19:27:41.188567 | f59e6aec-8304-4091-a179-f885e55ee38f ==============================
[0m19:27:41.188567 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:27:41.189308 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select +mrt__stocks_with_regimes', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m19:27:41.438836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f59e6aec-8304-4091-a179-f885e55ee38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002337B250180>]}
[0m19:27:41.505130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f59e6aec-8304-4091-a179-f885e55ee38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002337BD8B790>]}
[0m19:27:41.507658 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:27:41.767042 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:27:42.164847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:27:42.165512 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\gold\mrt__stocks_with_regimes.sql
[0m19:27:42.354186 [error] [MainThread]: Encountered an error:
Compilation Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  expected token ',', got 'on_schema_change'
    line 5
      on_schema_change = 'fail',
[0m19:27:42.355213 [debug] [MainThread]: Command `-c run` failed at 19:27:42.355093 after 1.34 seconds
[0m19:27:42.355581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002337CFD4D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002337CFD6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002337D40C9B0>]}
[0m19:27:42.355984 [debug] [MainThread]: Flushing usage events
[0m19:27:43.266217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:55.368975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022334848050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223350542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022335697ED0>]}


============================== 19:27:55.373540 | 2e4bef34-d216-40e9-b2c4-963f76499bcb ==============================
[0m19:27:55.373540 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:27:55.374250 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +mrt__stocks_with_regimes', 'printer_width': '80', 'write_json': 'True'}
[0m19:27:55.623233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e4bef34-d216-40e9-b2c4-963f76499bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022334A00180>]}
[0m19:27:55.688789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e4bef34-d216-40e9-b2c4-963f76499bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233553B790>]}
[0m19:27:55.691327 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:27:55.958007 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:27:56.189963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:27:56.190618 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\gold\mrt__stocks_with_regimes.sql
[0m19:27:56.379123 [error] [MainThread]: Encountered an error:
Compilation Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  expected token ',', got 'on_schema_change'
    line 5
      on_schema_change = 'fail'
[0m19:27:56.380185 [debug] [MainThread]: Command `-c run` failed at 19:27:56.380064 after 1.13 seconds
[0m19:27:56.380568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223367E4D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223367E6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022336BDC9B0>]}
[0m19:27:56.380938 [debug] [MainThread]: Flushing usage events
[0m19:27:57.074475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:28.255064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5FFA98050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5803142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F580953ED0>]}


============================== 19:28:28.259545 | 94205876-c0c9-4c4f-a038-2ac796373cb7 ==============================
[0m19:28:28.259545 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:28:28.260242 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +mrt__stocks_with_regimes', 'printer_width': '80', 'target_path': 'None'}
[0m19:28:28.508487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94205876-c0c9-4c4f-a038-2ac796373cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5FFC50180>]}
[0m19:28:28.574130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94205876-c0c9-4c4f-a038-2ac796373cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5807FB790>]}
[0m19:28:28.576552 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:28:28.833788 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:28:29.066878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:28:29.067538 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\gold\mrt__stocks_with_regimes.sql
[0m19:28:29.426039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94205876-c0c9-4c4f-a038-2ac796373cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5821F8C50>]}
[0m19:28:29.561085 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:28:29.563494 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:28:29.590645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94205876-c0c9-4c4f-a038-2ac796373cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F581C40B90>]}
[0m19:28:29.591114 [info ] [MainThread]: Found 10 models, 46 data tests, 1 snapshot, 1 seed, 2 sources, 853 macros
[0m19:28:29.591581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94205876-c0c9-4c4f-a038-2ac796373cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F580812C10>]}
[0m19:28:29.593670 [info ] [MainThread]: 
[0m19:28:29.594106 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:28:29.594510 [info ] [MainThread]: 
[0m19:28:29.595072 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:28:29.599945 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m19:28:29.678440 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m19:28:29.678897 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m19:28:29.679294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:31.353158 [debug] [ThreadPool]: SQL status: OK in 1.674 seconds
[0m19:28:31.354828 [debug] [ThreadPool]: On list_finance: Close
[0m19:28:31.355637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m19:28:31.356206 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m19:28:31.362566 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:28:31.362906 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:28:31.363209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:31.364640 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:28:31.365899 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:28:31.366202 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m19:28:31.367050 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:28:31.367428 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:28:31.367749 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m19:28:31.420983 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m19:28:31.422203 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:28:31.422632 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:28:31.423037 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:28:31.481019 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m19:28:31.482596 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m19:28:31.490737 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m19:28:31.499395 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:28:31.499722 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m19:28:31.500004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:31.500645 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m19:28:31.502838 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:28:31.503186 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m19:28:31.503482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:31.503945 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:28:31.504335 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:28:31.504674 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m19:28:31.505269 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:28:31.505633 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:28:31.505955 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m19:28:31.530743 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m19:28:31.531138 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m19:28:31.532681 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m19:28:31.533793 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m19:28:31.535037 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m19:28:31.535339 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m19:28:31.535884 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m19:28:31.536177 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m19:28:31.539280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94205876-c0c9-4c4f-a038-2ac796373cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5822EF860>]}
[0m19:28:31.540053 [debug] [MainThread]: Using duckdb connection "master"
[0m19:28:31.540355 [debug] [MainThread]: On master: BEGIN
[0m19:28:31.540633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:31.541744 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:28:31.542049 [debug] [MainThread]: On master: COMMIT
[0m19:28:31.542342 [debug] [MainThread]: Using duckdb connection "master"
[0m19:28:31.542623 [debug] [MainThread]: On master: COMMIT
[0m19:28:31.543167 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:28:31.543470 [debug] [MainThread]: On master: Close
[0m19:28:31.548145 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m19:28:31.549062 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m19:28:31.548663 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m19:28:31.550122 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m19:28:31.550497 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m19:28:31.558579 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m19:28:31.549536 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m19:28:31.559821 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m19:28:31.560208 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m19:28:31.563883 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m19:28:31.564832 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m19:28:31.570752 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m19:28:31.599771 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m19:28:31.602132 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m19:28:31.603288 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:28:31.603756 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m19:28:31.604151 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:28:31.605239 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:28:31.605652 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m19:28:31.606006 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:28:31.606583 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:28:31.607016 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:28:31.607428 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m19:28:31.608175 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:28:31.608724 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:28:31.609311 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m19:28:31.895292 [debug] [Thread-2 (]: SQL status: OK in 0.287 seconds
[0m19:28:31.895765 [debug] [Thread-1 (]: SQL status: OK in 0.286 seconds
[0m19:28:31.902100 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:28:31.905546 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:28:31.906025 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m19:28:31.906500 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m19:28:31.978437 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m19:28:31.979030 [debug] [Thread-2 (]: SQL status: OK in 0.072 seconds
[0m19:28:31.982118 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:28:31.985102 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:28:31.985544 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m19:28:31.985990 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m19:28:32.056921 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m19:28:32.057943 [debug] [Thread-2 (]: SQL status: OK in 0.071 seconds
[0m19:28:32.069476 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m19:28:32.070821 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m19:28:32.071272 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:28:32.072087 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:28:32.072526 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m19:28:32.073077 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m19:28:32.209217 [debug] [Thread-1 (]: SQL status: OK in 0.135 seconds
[0m19:28:32.224877 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:28:32.225643 [debug] [Thread-2 (]: SQL status: OK in 0.152 seconds
[0m19:28:32.226466 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m19:28:32.230538 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:28:32.231485 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m19:28:32.351920 [debug] [Thread-2 (]: SQL status: OK in 0.120 seconds
[0m19:28:32.352405 [debug] [Thread-1 (]: SQL status: OK in 0.121 seconds
[0m19:28:32.354713 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m19:28:32.355910 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m19:28:32.358443 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94205876-c0c9-4c4f-a038-2ac796373cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58252EB10>]}
[0m19:28:32.359456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94205876-c0c9-4c4f-a038-2ac796373cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F582504EC0>]}
[0m19:28:32.359023 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.80s]
[0m19:28:32.360840 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m19:28:32.361690 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m19:28:32.360154 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.81s]
[0m19:28:32.362944 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m19:28:32.362278 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics_dev.stg__vix_with_versions ............... [RUN]
[0m19:28:32.364082 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m19:28:32.364493 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m19:28:32.368521 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m19:28:32.375405 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m19:28:32.382220 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m19:28:32.383330 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:28:32.383875 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m19:28:32.384239 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:28:32.386288 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:28:32.387292 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:28:32.387952 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    left join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
  );

[0m19:28:32.514944 [debug] [Thread-3 (]: SQL status: OK in 0.126 seconds
[0m19:28:32.518064 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:28:32.518450 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m19:28:32.572169 [debug] [Thread-3 (]: SQL status: OK in 0.053 seconds
[0m19:28:32.577139 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:28:32.577766 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m19:28:32.660677 [debug] [Thread-3 (]: SQL status: OK in 0.082 seconds
[0m19:28:32.663888 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m19:28:32.664826 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:28:32.665717 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m19:28:32.897729 [debug] [Thread-3 (]: SQL status: OK in 0.231 seconds
[0m19:28:32.900234 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:28:32.900635 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m19:28:33.025978 [debug] [Thread-3 (]: SQL status: OK in 0.125 seconds
[0m19:28:33.027385 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m19:28:33.027912 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94205876-c0c9-4c4f-a038-2ac796373cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F583BD2D50>]}
[0m19:28:33.028574 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics_dev.stg__vix_with_versions .......... [[32mOK[0m in 0.66s]
[0m19:28:33.029389 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m19:28:33.030069 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m19:28:33.030547 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m19:28:33.031233 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m19:28:33.031604 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m19:28:33.034840 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m19:28:33.035815 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m19:28:33.039004 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m19:28:33.039962 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:28:33.040522 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m19:28:33.040868 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:28:33.042535 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:28:33.042993 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:28:33.043439 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date, 
        version_rank
    from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < complacent_max then 'complacent'
            when "close" >= complacent_max and close < normal_max then 'normal'
            when "close" >= normal_max and "close" < elevated_max then 'elevated'
            when "close" >= elevated_max then 'crises'
        end) as regime, 
        loaded_at
    from base b
    where version_rank = 1
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m19:28:33.140414 [debug] [Thread-4 (]: SQL status: OK in 0.096 seconds
[0m19:28:33.151095 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:28:33.152043 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m19:28:33.226703 [debug] [Thread-4 (]: SQL status: OK in 0.074 seconds
[0m19:28:33.230044 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:28:33.230424 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m19:28:33.300289 [debug] [Thread-4 (]: SQL status: OK in 0.069 seconds
[0m19:28:33.303853 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m19:28:33.304858 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:28:33.305804 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m19:28:33.453748 [debug] [Thread-4 (]: SQL status: OK in 0.147 seconds
[0m19:28:33.461702 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:28:33.462786 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m19:28:33.583282 [debug] [Thread-4 (]: SQL status: OK in 0.120 seconds
[0m19:28:33.584843 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m19:28:33.585375 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94205876-c0c9-4c4f-a038-2ac796373cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5825C9950>]}
[0m19:28:33.585972 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.55s]
[0m19:28:33.586801 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m19:28:33.587479 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m19:28:33.587970 [info ] [Thread-2 (]: 5 of 6 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m19:28:33.588596 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_changes)
[0m19:28:33.588988 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m19:28:33.592076 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m19:28:33.592933 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m19:28:33.596092 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m19:28:33.597084 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:28:33.597625 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m19:28:33.598096 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:28:33.599467 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:28:33.599863 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:28:33.600275 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime,
    lead(regime) over(order by trade_date asc, loaded_at asc) as nxt_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(order by trade_date asc, loaded_at asc) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m19:28:33.704054 [debug] [Thread-2 (]: SQL status: OK in 0.103 seconds
[0m19:28:33.709717 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:28:33.710437 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m19:28:33.813613 [debug] [Thread-2 (]: SQL status: OK in 0.102 seconds
[0m19:28:33.826236 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:28:33.827927 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m19:28:33.898830 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m19:28:33.900333 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m19:28:33.900763 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:28:33.901186 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m19:28:34.021245 [debug] [Thread-2 (]: SQL status: OK in 0.119 seconds
[0m19:28:34.025893 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:28:34.026655 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m19:28:34.149189 [debug] [Thread-2 (]: SQL status: OK in 0.122 seconds
[0m19:28:34.150596 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m19:28:34.151124 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94205876-c0c9-4c4f-a038-2ac796373cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F583C4DBE0>]}
[0m19:28:34.151724 [info ] [Thread-2 (]: 5 of 6 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.56s]
[0m19:28:34.152543 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m19:28:34.153288 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:28:34.153772 [info ] [Thread-1 (]: 6 of 6 START sql incremental model analytics_dev.mrt__stocks_with_regimes ...... [RUN]
[0m19:28:34.154367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m19:28:34.154755 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:28:34.159019 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:34.159842 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:28:34.163780 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:34.164419 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__700e3a10947f" cascade
    
[0m19:28:34.164794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:34.222549 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m19:28:34.257885 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:34.258323 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:28:34.259869 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:28:34.261213 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:34.261577 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m19:28:34.262515 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:28:34.262872 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:34.263228 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m19:28:34.316349 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m19:28:34.317744 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:34.318222 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m19:28:34.318799 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:28:34.320174 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:28:34.320652 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:34.321161 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:28:34.386145 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m19:28:34.412402 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:34.414044 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:34.414734 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m19:28:34.416804 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:28:34.417435 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:34.418024 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_tmp"
  
    as (
      


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume, 
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
    

)

select
    s.trade_date, 
    s.ticker, 
    s."open", 
    s.high, 
    s.low, 
    s."close", 
    s.volume, 
    r.regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    );
  
  
  
[0m19:28:34.563140 [debug] [Thread-1 (]: SQL status: OK in 0.145 seconds
[0m19:28:34.568346 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:34.568722 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'analytics_dev'
      AND table_name = 'mrt__stocks_with_regimes'
  
[0m19:28:34.569894 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:28:34.571253 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:34.571617 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'analytics_dev'
      AND table_name = 'mrt__stocks_with_regimes'
  
[0m19:28:34.580284 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m19:28:34.584116 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:34.584519 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
alter view "finance"."analytics_dev"."mrt__stocks_with_regimes" rename to "mrt__stocks_with_regimes__dbt_backup"
[0m19:28:34.668154 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m19:28:34.671701 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:34.672123 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
alter table "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_tmp" rename to "mrt__stocks_with_regimes"
[0m19:28:34.846321 [debug] [Thread-1 (]: SQL status: OK in 0.174 seconds
[0m19:28:34.851023 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:28:34.851480 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:34.851850 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:28:35.002314 [debug] [Thread-1 (]: SQL status: OK in 0.150 seconds
[0m19:28:35.006407 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:35.007062 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__700e3a10947f" cascade
    
[0m19:28:35.066800 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m19:28:35.076074 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:35.076711 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop view if exists "finance"."analytics_dev"."mrt__stocks_with_regimes__dbt_backup" cascade
    
[0m19:28:35.207554 [debug] [Thread-1 (]: SQL status: OK in 0.130 seconds
[0m19:28:35.210612 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:28:35.211008 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__700e3a10947f" cascade
    
[0m19:28:35.264137 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m19:28:35.265427 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m19:28:35.265952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94205876-c0c9-4c4f-a038-2ac796373cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5826C7AD0>]}
[0m19:28:35.266526 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes . [[32mOK[0m in 1.11s]
[0m19:28:35.267353 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:28:35.268989 [debug] [MainThread]: Using duckdb connection "master"
[0m19:28:35.269340 [debug] [MainThread]: On master: BEGIN
[0m19:28:35.269642 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:35.270818 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:28:35.271128 [debug] [MainThread]: On master: COMMIT
[0m19:28:35.271418 [debug] [MainThread]: Using duckdb connection "master"
[0m19:28:35.271700 [debug] [MainThread]: On master: COMMIT
[0m19:28:35.272239 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:28:35.272546 [debug] [MainThread]: On master: Close
[0m19:28:35.272919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:35.273194 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m19:28:35.273615 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m19:28:35.273875 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m19:28:35.274135 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m19:28:35.274395 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m19:28:35.274655 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__vix_with_versions' was properly closed.
[0m19:28:35.274911 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m19:28:35.275265 [info ] [MainThread]: 
[0m19:28:35.275807 [info ] [MainThread]: Finished running 1 incremental model, 5 view models in 0 hours 0 minutes and 5.68 seconds (5.68s).
[0m19:28:35.277559 [debug] [MainThread]: Command end result
[0m19:28:35.326681 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:28:35.329096 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:28:35.335773 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m19:28:35.336179 [info ] [MainThread]: 
[0m19:28:35.336733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:35.337221 [info ] [MainThread]: 
[0m19:28:35.337737 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m19:28:35.338667 [debug] [MainThread]: Command `-c run` succeeded at 19:28:35.338551 after 7.20 seconds
[0m19:28:35.339045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5FD596030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58229B6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F583BD7AD0>]}
[0m19:28:35.339488 [debug] [MainThread]: Flushing usage events
[0m19:28:36.097879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:47:29.490727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E4CE8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E54F42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E5B37ED0>]}


============================== 19:47:29.495236 | d388ee1b-98bd-4551-9533-95bfee9eed34 ==============================
[0m19:47:29.495236 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:47:29.495927 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select +mrt__stocks_with_regimes', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m19:47:29.827878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd388ee1b-98bd-4551-9533-95bfee9eed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E4EA0180>]}
[0m19:47:29.895568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd388ee1b-98bd-4551-9533-95bfee9eed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E59DB790>]}
[0m19:47:29.911445 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:47:30.306900 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:47:33.103342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:47:33.104019 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\gold\mrt__stocks_with_regimes.sql
[0m19:47:33.104417 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\int\int__regime_changes.sql
[0m19:47:33.465879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd388ee1b-98bd-4551-9533-95bfee9eed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E7478C50>]}
[0m19:47:33.602374 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:47:33.616028 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:47:33.647474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd388ee1b-98bd-4551-9533-95bfee9eed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E6EC06E0>]}
[0m19:47:33.647955 [info ] [MainThread]: Found 10 models, 46 data tests, 1 snapshot, 1 seed, 2 sources, 853 macros
[0m19:47:33.648476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd388ee1b-98bd-4551-9533-95bfee9eed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E59F2C10>]}
[0m19:47:33.650750 [info ] [MainThread]: 
[0m19:47:33.651288 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:47:33.651764 [info ] [MainThread]: 
[0m19:47:33.652388 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:47:33.657550 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m19:47:36.117097 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m19:47:36.117495 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m19:47:36.117801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:37.553526 [debug] [ThreadPool]: SQL status: OK in 1.436 seconds
[0m19:47:37.554890 [debug] [ThreadPool]: On list_finance: Close
[0m19:47:37.555556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m19:47:37.556036 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m19:47:37.561964 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:47:37.562296 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:47:37.562594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:37.564095 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:47:37.565351 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:47:37.565653 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m19:47:37.566555 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:47:37.566854 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:47:37.567145 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m19:47:37.615441 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m19:47:37.616964 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:47:37.617576 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:47:37.618134 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:47:37.661258 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m19:47:37.662696 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m19:47:37.670540 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m19:47:37.681047 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:47:37.681546 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m19:47:37.681891 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m19:47:37.684004 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:47:37.684370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:37.684750 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m19:47:37.685343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:37.686095 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:47:37.686422 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:47:37.686728 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m19:47:37.687224 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:47:37.687540 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:47:37.687861 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m19:47:37.713186 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m19:47:37.713637 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m19:47:37.714847 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m19:47:37.716217 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m19:47:37.728386 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m19:47:37.728750 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m19:47:37.729272 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m19:47:37.729587 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m19:47:37.732325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd388ee1b-98bd-4551-9533-95bfee9eed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E7573790>]}
[0m19:47:37.732927 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:37.733229 [debug] [MainThread]: On master: BEGIN
[0m19:47:37.733507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:37.734626 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:47:37.734932 [debug] [MainThread]: On master: COMMIT
[0m19:47:37.735221 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:37.735498 [debug] [MainThread]: On master: COMMIT
[0m19:47:37.736038 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:47:37.736341 [debug] [MainThread]: On master: Close
[0m19:47:37.741030 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m19:47:37.741965 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m19:47:37.741569 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m19:47:37.743023 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m19:47:37.743384 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m19:47:37.751064 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m19:47:37.742436 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m19:47:37.751962 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m19:47:37.752373 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m19:47:37.755239 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m19:47:37.756503 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m19:47:37.779463 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m19:47:37.787770 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m19:47:37.791085 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m19:47:37.792199 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:47:37.792736 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m19:47:37.793276 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:47:37.794092 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:47:37.794942 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m19:47:37.795374 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:47:37.796063 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:47:37.796537 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:47:37.796895 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m19:47:37.797516 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:47:37.798011 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:47:37.798495 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m19:47:37.859690 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m19:47:37.868875 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:47:37.869475 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m19:47:37.882420 [debug] [Thread-2 (]: SQL status: OK in 0.083 seconds
[0m19:47:37.888193 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:47:37.888916 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m19:47:37.933445 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m19:47:37.940213 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:47:37.941137 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m19:47:37.957716 [debug] [Thread-2 (]: SQL status: OK in 0.068 seconds
[0m19:47:37.962563 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:47:37.962952 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m19:47:38.005321 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m19:47:38.016544 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m19:47:38.016966 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:47:38.017297 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m19:47:38.025448 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m19:47:38.026888 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m19:47:38.027263 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:47:38.027600 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m19:47:38.132783 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m19:47:38.139425 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:47:38.139891 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m19:47:38.140319 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m19:47:38.142854 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:47:38.143220 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m19:47:38.387286 [debug] [Thread-1 (]: SQL status: OK in 0.244 seconds
[0m19:47:38.387740 [debug] [Thread-2 (]: SQL status: OK in 0.247 seconds
[0m19:47:38.390035 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m19:47:38.391439 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m19:47:38.394472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd388ee1b-98bd-4551-9533-95bfee9eed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E77AEB10>]}
[0m19:47:38.395586 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd388ee1b-98bd-4551-9533-95bfee9eed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E77850D0>]}
[0m19:47:38.395187 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.65s]
[0m19:47:38.396438 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.64s]
[0m19:47:38.397256 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m19:47:38.397922 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m19:47:38.398747 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m19:47:38.399231 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics_dev.stg__vix_with_versions ............... [RUN]
[0m19:47:38.400126 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m19:47:38.400505 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m19:47:38.403711 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m19:47:38.404645 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m19:47:38.411039 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m19:47:38.412031 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:47:38.412456 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m19:47:38.412794 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:47:38.414039 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:47:38.414446 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:47:38.414831 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    left join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
  );

[0m19:47:38.502228 [debug] [Thread-3 (]: SQL status: OK in 0.087 seconds
[0m19:47:38.505272 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:47:38.505675 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m19:47:38.573851 [debug] [Thread-3 (]: SQL status: OK in 0.068 seconds
[0m19:47:38.577094 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:47:38.577506 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m19:47:38.632361 [debug] [Thread-3 (]: SQL status: OK in 0.054 seconds
[0m19:47:38.633842 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m19:47:38.634280 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:47:38.634751 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m19:47:38.748348 [debug] [Thread-3 (]: SQL status: OK in 0.113 seconds
[0m19:47:38.751198 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:47:38.751592 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m19:47:38.856436 [debug] [Thread-3 (]: SQL status: OK in 0.104 seconds
[0m19:47:38.859544 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m19:47:38.860574 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd388ee1b-98bd-4551-9533-95bfee9eed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E8DF6DF0>]}
[0m19:47:38.861615 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics_dev.stg__vix_with_versions .......... [[32mOK[0m in 0.46s]
[0m19:47:38.863122 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m19:47:38.864498 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m19:47:38.865402 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m19:47:38.866862 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m19:47:38.867472 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m19:47:38.873567 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m19:47:38.875847 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m19:47:38.881473 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m19:47:38.883828 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:47:38.884755 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m19:47:38.885320 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:47:38.888202 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m19:47:38.889103 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:47:38.890016 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date, 
        version_rank
    from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < complacent_max then 'complacent'
            when "close" >= complacent_max and close < normal_max then 'normal'
            when "close" >= normal_max and "close" < elevated_max then 'elevated'
            when "close" >= elevated_max then 'crises'
        end) as regime, 
        loaded_at
    from base b
    where version_rank = 1
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m19:47:38.978926 [debug] [Thread-4 (]: SQL status: OK in 0.088 seconds
[0m19:47:38.982252 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:47:38.982708 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m19:47:39.047548 [debug] [Thread-4 (]: SQL status: OK in 0.064 seconds
[0m19:47:39.050744 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:47:39.051168 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m19:47:39.107017 [debug] [Thread-4 (]: SQL status: OK in 0.055 seconds
[0m19:47:39.108376 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m19:47:39.108767 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:47:39.109226 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m19:47:39.227052 [debug] [Thread-4 (]: SQL status: OK in 0.117 seconds
[0m19:47:39.229420 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:47:39.229820 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m19:47:39.338815 [debug] [Thread-4 (]: SQL status: OK in 0.109 seconds
[0m19:47:39.340253 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m19:47:39.340785 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd388ee1b-98bd-4551-9533-95bfee9eed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E7798B50>]}
[0m19:47:39.341362 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.47s]
[0m19:47:39.342284 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m19:47:39.342965 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m19:47:39.343450 [info ] [Thread-1 (]: 5 of 6 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m19:47:39.344371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__regime_changes)
[0m19:47:39.344800 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m19:47:39.348200 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m19:47:39.349189 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m19:47:39.352230 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m19:47:39.353164 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:47:39.353578 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m19:47:39.353919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:39.355291 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:47:39.355662 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:47:39.356055 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(order by trade_date asc, loaded_at asc) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m19:47:39.463419 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m19:47:39.466843 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:47:39.467281 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m19:47:39.537284 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m19:47:39.540275 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:47:39.540896 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m19:47:39.607060 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m19:47:39.609158 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m19:47:39.609776 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:47:39.610351 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m19:47:39.718314 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m19:47:39.721099 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:47:39.721606 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m19:47:39.828514 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m19:47:39.830441 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m19:47:39.831040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd388ee1b-98bd-4551-9533-95bfee9eed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E8E67150>]}
[0m19:47:39.831657 [info ] [Thread-1 (]: 5 of 6 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.49s]
[0m19:47:39.832607 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m19:47:39.833347 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:47:39.833829 [info ] [Thread-2 (]: 6 of 6 START sql incremental model analytics_dev.mrt__stocks_with_regimes ...... [RUN]
[0m19:47:39.834689 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m19:47:39.835086 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:47:39.841791 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:39.842960 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:47:39.855532 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:39.857254 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__303b8945590c" cascade
    
[0m19:47:39.858572 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:47:39.917581 [debug] [Thread-2 (]: SQL status: OK in 0.059 seconds
[0m19:47:39.949089 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:39.949535 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:47:39.951045 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:47:39.952411 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:39.952793 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m19:47:39.953884 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:47:39.954264 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:39.954622 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m19:47:40.009989 [debug] [Thread-2 (]: SQL status: OK in 0.055 seconds
[0m19:47:40.011139 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:40.011574 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m19:47:40.012133 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:47:40.013313 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:47:40.013716 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:40.014069 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:47:40.058784 [debug] [Thread-2 (]: SQL status: OK in 0.044 seconds
[0m19:47:40.067179 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:40.067753 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
  
    
    

    create  table
      "finance"."dbt_temp"."mrt__stocks_with_regimes__303b8945590c"
  
    as (
      


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume, 
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
        and trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
        
)

select
    s.trade_date, 
    s.ticker, 
    s."open", 
    s.high, 
    s.low, 
    s."close", 
    s.volume, 
    r.regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    );
  
  
  
[0m19:47:40.254315 [debug] [Thread-2 (]: SQL status: OK in 0.186 seconds
[0m19:47:40.261683 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:40.262118 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m19:47:40.263438 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:47:40.263819 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:40.264181 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__303b8945590c'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:47:40.273865 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m19:47:40.279559 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:40.280019 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:47:40.284870 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m19:47:40.297600 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:40.298052 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__303b8945590c'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:47:40.302676 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m19:47:40.308561 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:40.308987 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:47:40.313691 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m19:47:40.322485 [debug] [Thread-2 (]: 
    In "finance"."analytics_dev"."mrt__stocks_with_regimes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:47:40.323021 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:40.323391 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
SELECT version()
[0m19:47:40.324634 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:47:40.389233 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:40.390218 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:40.390625 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */


    MERGE INTO "finance"."analytics_dev"."mrt__stocks_with_regimes" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."mrt__stocks_with_regimes__303b8945590c" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m19:47:40.441518 [debug] [Thread-2 (]: SQL status: OK in 0.050 seconds
[0m19:47:40.443722 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:47:40.444095 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:40.444496 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:47:40.488886 [debug] [Thread-2 (]: SQL status: OK in 0.044 seconds
[0m19:47:40.492472 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:40.493188 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__303b8945590c" cascade
    
[0m19:47:40.599031 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m19:47:40.602240 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:47:40.602659 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__303b8945590c" cascade
    
[0m19:47:40.657946 [debug] [Thread-2 (]: SQL status: OK in 0.055 seconds
[0m19:47:40.660782 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m19:47:40.661948 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd388ee1b-98bd-4551-9533-95bfee9eed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E7947890>]}
[0m19:47:40.663150 [info ] [Thread-2 (]: 6 of 6 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes . [[32mOK[0m in 0.83s]
[0m19:47:40.664623 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:47:40.667472 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:40.668031 [debug] [MainThread]: On master: BEGIN
[0m19:47:40.668494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:47:40.670193 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:47:40.670734 [debug] [MainThread]: On master: COMMIT
[0m19:47:40.671239 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:40.671716 [debug] [MainThread]: On master: COMMIT
[0m19:47:40.672713 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:47:40.673154 [debug] [MainThread]: On master: Close
[0m19:47:40.673689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:40.674069 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m19:47:40.674429 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m19:47:40.674790 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m19:47:40.675144 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m19:47:40.675497 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m19:47:40.675851 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__vix_with_versions' was properly closed.
[0m19:47:40.676202 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m19:47:40.676703 [info ] [MainThread]: 
[0m19:47:40.677402 [info ] [MainThread]: Finished running 1 incremental model, 5 view models in 0 hours 0 minutes and 7.02 seconds (7.02s).
[0m19:47:40.679481 [debug] [MainThread]: Command end result
[0m19:47:40.729223 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:47:40.732007 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:47:40.738479 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m19:47:40.738868 [info ] [MainThread]: 
[0m19:47:40.739458 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:47:40.740020 [info ] [MainThread]: 
[0m19:47:40.740620 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m19:47:40.741615 [debug] [MainThread]: Command `-c run` succeeded at 19:47:40.741481 after 11.44 seconds
[0m19:47:40.742025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E7946990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E4D81670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3E78B3B90>]}
[0m19:47:40.742425 [debug] [MainThread]: Flushing usage events
[0m19:47:41.442288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:50:13.814895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C6258050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C6A642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C70A7ED0>]}


============================== 19:50:13.819439 | 60f8d803-ec25-4227-bc55-75fbcc646cd0 ==============================
[0m19:50:13.819439 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:50:13.820120 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt build', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m19:50:14.071007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C6410180>]}
[0m19:50:14.136566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C6F4B790>]}
[0m19:50:14.139258 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:50:14.402087 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:50:14.788041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:50:14.788403 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:50:14.863984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C821A350>]}
[0m19:50:15.056722 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:50:15.059265 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:50:15.117862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C8AEFB60>]}
[0m19:50:15.118345 [info ] [MainThread]: Found 10 models, 46 data tests, 1 snapshot, 1 seed, 2 sources, 853 macros
[0m19:50:15.123714 [info ] [MainThread]: 
[0m19:50:15.124232 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:50:15.124881 [info ] [MainThread]: 
[0m19:50:15.125732 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:50:15.131383 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m19:50:15.144822 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m19:50:15.214666 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m19:50:15.215061 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m19:50:15.215374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:15.216071 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m19:50:15.216410 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m19:50:15.216730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:16.762844 [debug] [ThreadPool]: SQL status: OK in 1.546 seconds
[0m19:50:16.763257 [debug] [ThreadPool]: SQL status: OK in 1.548 seconds
[0m19:50:16.764571 [debug] [ThreadPool]: On list_finance: Close
[0m19:50:16.765651 [debug] [ThreadPool]: On list_finance: Close
[0m19:50:16.766549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev_snapshots)
[0m19:50:16.767017 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev_snapshots"
"
[0m19:50:16.773439 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m19:50:16.773780 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev_snapshots"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:50:16.774082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:16.774672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m19:50:16.775155 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m19:50:16.777345 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:50:16.777670 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:50:16.777969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:16.778510 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:50:16.779821 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m19:50:16.780197 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: BEGIN
[0m19:50:16.780616 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:50:16.781895 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:50:16.782205 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m19:50:16.782613 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:50:16.782979 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m19:50:16.783282 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev_snapshots"} */

    
    
        create schema if not exists "finance"."analytics_dev_snapshots"
    
[0m19:50:16.783700 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:50:16.784067 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:50:16.784372 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m19:50:16.834705 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m19:50:16.835151 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m19:50:16.836225 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: COMMIT
[0m19:50:16.837360 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:50:16.837827 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m19:50:16.838277 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m19:50:16.838726 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: COMMIT
[0m19:50:16.839166 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m19:50:16.887054 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m19:50:16.888119 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m19:50:16.889203 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m19:50:16.890355 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: Close
[0m19:50:16.898347 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m19:50:16.904548 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:50:16.905104 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m19:50:16.905433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:16.906087 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m19:50:16.908035 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:50:16.908366 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m19:50:16.908645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:16.909266 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:50:16.909624 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m19:50:16.909927 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m19:50:16.910451 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:50:16.910805 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m19:50:16.911105 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m19:50:16.934600 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m19:50:16.935048 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m19:50:16.936307 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m19:50:16.937624 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m19:50:16.938724 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m19:50:16.939058 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m19:50:16.939538 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m19:50:16.939850 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m19:50:16.942843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C822EDD0>]}
[0m19:50:16.943290 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:16.943733 [debug] [MainThread]: On master: BEGIN
[0m19:50:16.944020 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:50:16.945231 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:50:16.945549 [debug] [MainThread]: On master: COMMIT
[0m19:50:16.945849 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:16.946132 [debug] [MainThread]: On master: COMMIT
[0m19:50:16.946682 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:50:16.946991 [debug] [MainThread]: On master: Close
[0m19:50:16.951738 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m19:50:16.952675 [debug] [Thread-3 (]: Began running node seed.portfolio_project_2.regime_thresholds
[0m19:50:16.953502 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m19:50:16.952263 [info ] [Thread-1 (]: 1 of 58 START sql view model analytics_dev.src_stocks .......................... [RUN]
[0m19:50:16.954553 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m19:50:16.954924 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m19:50:16.962821 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m19:50:16.953148 [info ] [Thread-3 (]: 3 of 58 START seed file analytics_dev.regime_thresholds ........................ [RUN]
[0m19:50:16.963890 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.portfolio_project_2.regime_thresholds'
[0m19:50:16.953960 [info ] [Thread-2 (]: 2 of 58 START sql view model analytics_dev.src_vix ............................. [RUN]
[0m19:50:16.964493 [debug] [Thread-3 (]: Began compiling node seed.portfolio_project_2.regime_thresholds
[0m19:50:16.965297 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m19:50:16.965768 [debug] [Thread-3 (]: Began executing node seed.portfolio_project_2.regime_thresholds
[0m19:50:16.966178 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m19:50:16.966613 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m19:50:17.008616 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m19:50:17.018608 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m19:50:17.029391 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m19:50:17.029809 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: BEGIN
[0m19:50:17.030158 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:50:17.031102 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m19:50:17.034671 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m19:50:17.035232 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:50:17.035627 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m19:50:17.035990 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:50:17.036574 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m19:50:17.037008 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m19:50:17.037366 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "seed.portfolio_project_2.regime_thresholds"} */
truncate table "finance"."analytics_dev"."regime_thresholds"
[0m19:50:17.038035 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:50:17.038434 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:50:17.038829 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::double as "open", 
    high::double as high, 
    low::double as low, 
    "close"::double as "close", 
    volume::double as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m19:50:17.039574 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:50:17.039979 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m19:50:17.040350 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:50:17.041480 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:50:17.041848 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:50:17.042213 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m19:50:17.172471 [debug] [Thread-3 (]: SQL status: OK in 0.134 seconds
[0m19:50:17.202723 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m19:50:17.203401 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: 
          COPY "finance"."analytics_dev"."regime_thresholds" FROM 'C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\seeds\regime_thresholds.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:50:17.205535 [debug] [Thread-1 (]: SQL status: OK in 0.166 seconds
[0m19:50:17.206193 [debug] [Thread-2 (]: SQL status: OK in 0.164 seconds
[0m19:50:17.214747 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:50:17.218540 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:50:17.219067 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m19:50:17.219602 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m19:50:17.306434 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m19:50:17.306903 [debug] [Thread-2 (]: SQL status: OK in 0.087 seconds
[0m19:50:17.309913 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:50:17.312838 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:50:17.313277 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m19:50:17.313735 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m19:50:17.354208 [debug] [Thread-3 (]: SQL status: OK in 0.150 seconds
[0m19:50:17.361774 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.portfolio_project_2.regime_thresholds"
[0m19:50:17.375068 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m19:50:17.375556 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m19:50:17.375949 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m19:50:17.440786 [debug] [Thread-1 (]: SQL status: OK in 0.126 seconds
[0m19:50:17.445934 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m19:50:17.446372 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:50:17.446755 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m19:50:17.447281 [debug] [Thread-2 (]: SQL status: OK in 0.133 seconds
[0m19:50:17.448571 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m19:50:17.448972 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:50:17.449314 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m19:50:17.449694 [debug] [Thread-3 (]: SQL status: OK in 0.073 seconds
[0m19:50:17.451773 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: Close
[0m19:50:17.453956 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CE090940>]}
[0m19:50:17.454516 [info ] [Thread-3 (]: 3 of 58 OK loaded seed file analytics_dev.regime_thresholds .................... [[32mINSERT 1[0m in 0.49s]
[0m19:50:17.455365 [debug] [Thread-3 (]: Finished running node seed.portfolio_project_2.regime_thresholds
[0m19:50:17.566745 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m19:50:17.572703 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m19:50:17.573179 [debug] [Thread-2 (]: SQL status: OK in 0.123 seconds
[0m19:50:17.573617 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m19:50:17.576382 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m19:50:17.577133 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m19:50:17.693236 [debug] [Thread-2 (]: SQL status: OK in 0.116 seconds
[0m19:50:17.693756 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m19:50:17.695290 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m19:50:17.696625 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m19:50:17.697273 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C8B13950>]}
[0m19:50:17.697829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C8ADFE30>]}
[0m19:50:17.698530 [info ] [Thread-2 (]: 2 of 58 OK created sql view model analytics_dev.src_vix ........................ [[32mOK[0m in 0.73s]
[0m19:50:17.699851 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m19:50:17.700591 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m19:50:17.699131 [info ] [Thread-1 (]: 1 of 58 OK created sql view model analytics_dev.src_stocks ..................... [[32mOK[0m in 0.74s]
[0m19:50:17.701778 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m19:50:17.702447 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__price_changes
[0m19:50:17.701093 [info ] [Thread-4 (]: 4 of 58 START sql view model analytics_dev.stg__vix_with_versions .............. [RUN]
[0m19:50:17.703595 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m19:50:17.704007 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m19:50:17.707492 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m19:50:17.702937 [info ] [Thread-3 (]: 5 of 58 START sql view model analytics_dev.int__price_changes .................. [RUN]
[0m19:50:17.708284 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.portfolio_project_2.regime_thresholds, now model.portfolio_project_2.int__price_changes)
[0m19:50:17.708717 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m19:50:17.712561 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m19:50:17.713917 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m19:50:17.714528 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m19:50:17.718539 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m19:50:17.722274 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m19:50:17.723430 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:50:17.723824 [debug] [Thread-3 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m19:50:17.724181 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:50:17.724802 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:50:17.725196 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m19:50:17.725565 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:50:17.726231 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:50:17.726613 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:50:17.727180 [debug] [Thread-3 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m19:50:17.727993 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:50:17.728519 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:50:17.728946 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    left join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
  );

[0m19:50:17.828980 [debug] [Thread-3 (]: SQL status: OK in 0.101 seconds
[0m19:50:17.832215 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:50:17.832636 [debug] [Thread-3 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes" rename to "int__price_changes__dbt_backup"
[0m19:50:17.833190 [debug] [Thread-4 (]: SQL status: OK in 0.104 seconds
[0m19:50:17.836322 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:50:17.836761 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m19:50:17.891425 [debug] [Thread-3 (]: SQL status: OK in 0.058 seconds
[0m19:50:17.899404 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:50:17.900721 [debug] [Thread-3 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m19:50:17.905292 [debug] [Thread-4 (]: SQL status: OK in 0.068 seconds
[0m19:50:17.910800 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:50:17.911960 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m19:50:17.972006 [debug] [Thread-3 (]: SQL status: OK in 0.070 seconds
[0m19:50:17.977752 [debug] [Thread-3 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m19:50:17.978215 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:50:17.978598 [debug] [Thread-3 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m19:50:17.985469 [debug] [Thread-4 (]: SQL status: OK in 0.073 seconds
[0m19:50:17.987428 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m19:50:17.987822 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:50:17.988174 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m19:50:18.095059 [debug] [Thread-4 (]: SQL status: OK in 0.106 seconds
[0m19:50:18.097915 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m19:50:18.098328 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m19:50:18.098882 [debug] [Thread-3 (]: SQL status: OK in 0.120 seconds
[0m19:50:18.105449 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m19:50:18.105920 [debug] [Thread-3 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m19:50:18.213982 [debug] [Thread-4 (]: SQL status: OK in 0.115 seconds
[0m19:50:18.215755 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m19:50:18.216579 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CE0E5E50>]}
[0m19:50:18.217355 [info ] [Thread-4 (]: 4 of 58 OK created sql view model analytics_dev.stg__vix_with_versions ......... [[32mOK[0m in 0.51s]
[0m19:50:18.218851 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m19:50:18.219719 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m19:50:18.220253 [info ] [Thread-2 (]: 6 of 58 START sql view model analytics_dev.int__regime_classification .......... [RUN]
[0m19:50:18.220949 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_classification)
[0m19:50:18.221341 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m19:50:18.224241 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m19:50:18.225218 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m19:50:18.228989 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m19:50:18.230069 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:50:18.230486 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m19:50:18.230841 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:18.232943 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:50:18.233873 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:50:18.234927 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date, 
        version_rank
    from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" < complacent_max then 'complacent'
            when "close" >= complacent_max and close < normal_max then 'normal'
            when "close" >= normal_max and "close" < elevated_max then 'elevated'
            when "close" >= elevated_max then 'crises'
        end) as regime, 
        loaded_at
    from base b
    where version_rank = 1
)

select
    trade_date::date as trade_date,
    "close"::decimal as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m19:50:18.387645 [debug] [Thread-3 (]: SQL status: OK in 0.281 seconds
[0m19:50:18.389244 [debug] [Thread-3 (]: On model.portfolio_project_2.int__price_changes: Close
[0m19:50:18.389886 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CE132BD0>]}
[0m19:50:18.390534 [info ] [Thread-3 (]: 5 of 58 OK created sql view model analytics_dev.int__price_changes ............. [[32mOK[0m in 0.68s]
[0m19:50:18.391446 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m19:50:18.392356 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m19:50:18.393201 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m19:50:18.392809 [info ] [Thread-1 (]: 7 of 58 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m19:50:18.394214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7)
[0m19:50:18.394639 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m19:50:18.402242 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m19:50:18.409410 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m19:50:18.393643 [info ] [Thread-4 (]: 8 of 58 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m19:50:18.409924 [info ] [Thread-3 (]: 9 of 58 START test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [RUN]
[0m19:50:18.411140 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e)
[0m19:50:18.411772 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd)
[0m19:50:18.412345 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m19:50:18.412869 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m19:50:18.418059 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m19:50:18.418597 [debug] [Thread-2 (]: SQL status: OK in 0.183 seconds
[0m19:50:18.424214 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m19:50:18.428277 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:50:18.429193 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m19:50:18.429856 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m19:50:18.447876 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m19:50:18.448610 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m19:50:18.449420 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m19:50:18.452493 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m19:50:18.454756 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m19:50:18.455616 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m19:50:18.456045 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m19:50:18.456410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:18.457466 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m19:50:18.457927 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m19:50:18.458327 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:50:18.458987 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m19:50:18.459433 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: BEGIN
[0m19:50:18.459792 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:50:18.460356 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:50:18.460862 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m19:50:18.461336 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m19:50:18.461910 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m19:50:18.462444 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m19:50:18.462847 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m19:50:18.463629 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m19:50:18.464092 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m19:50:18.464487 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(abs(delta) - (gain + loss)) <= 1e-9)


  
  
      
    ) dbt_internal_test
[0m19:50:18.519413 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m19:50:18.523415 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:50:18.523913 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m19:50:18.533336 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m19:50:18.534029 [debug] [Thread-3 (]: SQL status: OK in 0.069 seconds
[0m19:50:18.534720 [debug] [Thread-4 (]: SQL status: OK in 0.071 seconds
[0m19:50:18.538969 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m19:50:18.539841 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m19:50:18.540447 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m19:50:18.542309 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: ROLLBACK
[0m19:50:18.543984 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m19:50:18.545569 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd'
[0m19:50:18.546371 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m19:50:18.546953 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: Close
[0m19:50:18.544853 [info ] [Thread-1 (]: 7 of 58 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.15s]
[0m19:50:18.547698 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m19:50:18.548665 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m19:50:18.550112 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m19:50:18.549549 [info ] [Thread-3 (]: 9 of 58 PASS dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[32mPASS[0m in 0.14s]
[0m19:50:18.552469 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m19:50:18.553018 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m19:50:18.551147 [info ] [Thread-4 (]: 8 of 58 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.14s]
[0m19:50:18.554402 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m19:50:18.555164 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m19:50:18.551670 [info ] [Thread-1 (]: 10 of 58 START test dbt_utils_expression_is_true_int__price_changes_gain___0 ... [RUN]
[0m19:50:18.556754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m19:50:18.557300 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m19:50:18.562993 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m19:50:18.553503 [info ] [Thread-3 (]: 11 of 58 START test dbt_utils_expression_is_true_int__price_changes_loss___0 ... [RUN]
[0m19:50:18.564268 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m19:50:18.555852 [info ] [Thread-4 (]: 12 of 58 START test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [RUN]
[0m19:50:18.565365 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m19:50:18.566089 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96)
[0m19:50:18.572072 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m19:50:18.572903 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m19:50:18.574038 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m19:50:18.580671 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m19:50:18.583140 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m19:50:18.584160 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m19:50:18.586719 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m19:50:18.587493 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m19:50:18.588887 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m19:50:18.589314 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:50:18.589680 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m19:50:18.590307 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m19:50:18.592627 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m19:50:18.593413 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m19:50:18.593840 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m19:50:18.594231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:18.594882 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m19:50:18.595326 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m19:50:18.595950 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:50:18.596448 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:50:18.596964 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m19:50:18.597702 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m19:50:18.598222 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: BEGIN
[0m19:50:18.598746 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m19:50:18.599295 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m19:50:18.599875 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:50:18.600594 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m19:50:18.601345 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m19:50:18.602038 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:50:18.602589 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m19:50:18.603411 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m19:50:18.695408 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m19:50:18.698362 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m19:50:18.698782 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m19:50:18.728949 [debug] [Thread-1 (]: SQL status: OK in 0.129 seconds
[0m19:50:18.731222 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m19:50:18.731854 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m19:50:18.732219 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m19:50:18.733284 [info ] [Thread-1 (]: 10 of 58 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 ......... [[32mPASS[0m in 0.18s]
[0m19:50:18.734119 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m19:50:18.734550 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m19:50:18.734962 [info ] [Thread-1 (]: 13 of 58 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m19:50:18.735575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m19:50:18.735958 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m19:50:18.745915 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m19:50:18.755365 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m19:50:18.757899 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m19:50:18.758931 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m19:50:18.759333 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m19:50:18.759683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:18.761113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:50:18.761568 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m19:50:18.761972 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m19:50:18.769704 [debug] [Thread-3 (]: SQL status: OK in 0.168 seconds
[0m19:50:18.770217 [debug] [Thread-4 (]: SQL status: OK in 0.166 seconds
[0m19:50:18.772655 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m19:50:18.773362 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m19:50:18.773817 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m19:50:18.775268 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: ROLLBACK
[0m19:50:18.776604 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96'
[0m19:50:18.777029 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: Close
[0m19:50:18.776005 [info ] [Thread-3 (]: 11 of 58 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 ......... [[32mPASS[0m in 0.21s]
[0m19:50:18.777843 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m19:50:18.778354 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m19:50:18.779123 [info ] [Thread-4 (]: 12 of 58 PASS dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[32mPASS[0m in 0.21s]
[0m19:50:18.780512 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m19:50:18.780969 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m19:50:18.779684 [info ] [Thread-3 (]: 14 of 58 START test not_null_int__price_changes_close .......................... [RUN]
[0m19:50:18.782198 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m19:50:18.782633 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m19:50:18.793270 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m19:50:18.781374 [info ] [Thread-4 (]: 15 of 58 START test not_null_int__price_changes_gain ........................... [RUN]
[0m19:50:18.794214 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m19:50:18.794644 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m19:50:18.799273 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m19:50:18.800225 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m19:50:18.803085 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m19:50:18.803711 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m19:50:18.806923 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m19:50:18.807923 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m19:50:18.808419 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m19:50:18.808796 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:50:18.809819 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m19:50:18.810335 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m19:50:18.810723 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:50:18.811443 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m19:50:18.811912 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m19:50:18.812307 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m19:50:18.812998 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:50:18.813667 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m19:50:18.814149 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m19:50:18.839416 [debug] [Thread-2 (]: SQL status: OK in 0.140 seconds
[0m19:50:18.840887 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m19:50:18.841428 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CE0CC050>]}
[0m19:50:18.842046 [info ] [Thread-2 (]: 6 of 58 OK created sql view model analytics_dev.int__regime_classification ..... [[32mOK[0m in 0.62s]
[0m19:50:18.842881 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m19:50:18.843311 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m19:50:18.843713 [info ] [Thread-2 (]: 16 of 58 START test not_null_int__price_changes_loaded_at ...................... [RUN]
[0m19:50:18.844455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_classification, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m19:50:18.844860 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m19:50:18.848590 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m19:50:18.849711 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m19:50:18.853075 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m19:50:18.854311 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m19:50:18.854775 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m19:50:18.855176 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:18.856732 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:50:18.857284 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m19:50:18.857692 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m19:50:18.912857 [debug] [Thread-1 (]: SQL status: OK in 0.150 seconds
[0m19:50:18.917194 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m19:50:18.918549 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m19:50:18.919136 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m19:50:18.920714 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m19:50:18.921381 [info ] [Thread-1 (]: 13 of 58 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.19s]
[0m19:50:18.922271 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m19:50:18.922709 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m19:50:18.924516 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m19:50:18.923112 [info ] [Thread-1 (]: 17 of 58 START test not_null_int__price_changes_loss ........................... [RUN]
[0m19:50:18.925281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m19:50:18.925772 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m19:50:18.932186 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m19:50:18.933217 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m19:50:18.934000 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m19:50:18.935264 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m19:50:18.936851 [info ] [Thread-2 (]: 16 of 58 PASS not_null_int__price_changes_loaded_at ............................ [[32mPASS[0m in 0.09s]
[0m19:50:18.942812 [debug] [Thread-3 (]: SQL status: OK in 0.130 seconds
[0m19:50:18.944361 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m19:50:18.947061 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m19:50:18.947837 [debug] [Thread-4 (]: SQL status: OK in 0.133 seconds
[0m19:50:18.949420 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m19:50:18.952363 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m19:50:18.954298 [info ] [Thread-2 (]: 18 of 58 START test not_null_int__price_changes_rn ............................. [RUN]
[0m19:50:18.955707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m19:50:18.957321 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m19:50:18.960214 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m19:50:18.961134 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m19:50:18.962054 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m19:50:18.962975 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m19:50:18.964281 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m19:50:18.972047 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m19:50:18.972727 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m19:50:18.973217 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m19:50:18.974245 [info ] [Thread-3 (]: 14 of 58 PASS not_null_int__price_changes_close ................................ [[32mPASS[0m in 0.19s]
[0m19:50:18.975472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:18.976690 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m19:50:18.977824 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m19:50:18.979456 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m19:50:18.978836 [info ] [Thread-4 (]: 15 of 58 PASS not_null_int__price_changes_gain ................................. [[32mPASS[0m in 0.18s]
[0m19:50:18.980318 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:50:18.983699 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m19:50:18.985087 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m19:50:18.984425 [info ] [Thread-3 (]: 19 of 58 START test not_null_int__price_changes_ticker ......................... [RUN]
[0m19:50:18.985760 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m19:50:18.986485 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m19:50:18.987038 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m19:50:18.987545 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m19:50:18.988551 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m19:50:18.988124 [info ] [Thread-4 (]: 20 of 58 START test not_null_int__price_changes_trade_date ..................... [RUN]
[0m19:50:18.994241 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m19:50:18.994870 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m19:50:18.995579 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m19:50:19.000115 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m19:50:19.000844 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m19:50:19.001298 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m19:50:19.001686 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:19.002418 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m19:50:19.005255 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m19:50:19.005881 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m19:50:19.008542 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m19:50:19.009043 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m19:50:19.009686 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m19:50:19.010122 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m19:50:19.010970 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m19:50:19.011394 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m19:50:19.011760 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:50:19.012681 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m19:50:19.013537 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m19:50:19.014034 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:50:19.014655 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m19:50:19.015399 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m19:50:19.016058 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m19:50:19.016725 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m19:50:19.017169 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m19:50:19.017583 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m19:50:19.062190 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m19:50:19.064558 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m19:50:19.065230 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m19:50:19.065599 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m19:50:19.066642 [info ] [Thread-1 (]: 17 of 58 PASS not_null_int__price_changes_loss ................................. [[32mPASS[0m in 0.14s]
[0m19:50:19.067829 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m19:50:19.068360 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m19:50:19.068852 [info ] [Thread-1 (]: 21 of 58 START sql view model analytics_dev.int__regime_changes ................ [RUN]
[0m19:50:19.069542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa, now model.portfolio_project_2.int__regime_changes)
[0m19:50:19.069965 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m19:50:19.070463 [debug] [Thread-3 (]: SQL status: OK in 0.054 seconds
[0m19:50:19.070984 [debug] [Thread-4 (]: SQL status: OK in 0.053 seconds
[0m19:50:19.074005 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m19:50:19.074442 [debug] [Thread-2 (]: SQL status: OK in 0.064 seconds
[0m19:50:19.075578 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m19:50:19.078986 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m19:50:19.080472 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m19:50:19.081989 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m19:50:19.083472 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m19:50:19.084427 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m19:50:19.085162 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m19:50:19.085866 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m19:50:19.086407 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m19:50:19.086946 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m19:50:19.087460 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m19:50:19.088173 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:50:19.088918 [info ] [Thread-4 (]: 20 of 58 PASS not_null_int__price_changes_trade_date ........................... [[32mPASS[0m in 0.09s]
[0m19:50:19.089853 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m19:50:19.092020 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m19:50:19.090805 [info ] [Thread-2 (]: 18 of 58 PASS not_null_int__price_changes_rn ................................... [[32mPASS[0m in 0.14s]
[0m19:50:19.092715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:19.093279 [debug] [Thread-4 (]: Began running node snapshot.portfolio_project_2.regime_classification_snapshot
[0m19:50:19.091380 [info ] [Thread-3 (]: 19 of 58 PASS not_null_int__price_changes_ticker ............................... [[32mPASS[0m in 0.10s]
[0m19:50:19.094366 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m19:50:19.096587 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m19:50:19.095649 [info ] [Thread-4 (]: 22 of 58 START snapshot analytics_dev_snapshots.regime_classification_snapshot . [RUN]
[0m19:50:19.097705 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:50:19.098837 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m19:50:19.099458 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5, now snapshot.portfolio_project_2.regime_classification_snapshot)
[0m19:50:19.099956 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:50:19.100963 [debug] [Thread-4 (]: Began compiling node snapshot.portfolio_project_2.regime_classification_snapshot
[0m19:50:19.101514 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(order by trade_date asc, loaded_at asc) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m19:50:19.100548 [info ] [Thread-2 (]: 23 of 58 START sql view model analytics_dev.int__rsi_sma ....................... [RUN]
[0m19:50:19.104634 [debug] [Thread-4 (]: Began executing node snapshot.portfolio_project_2.regime_classification_snapshot
[0m19:50:19.105738 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638, now model.portfolio_project_2.int__rsi_sma)
[0m19:50:19.128837 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m19:50:19.150908 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m19:50:19.157870 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m19:50:19.158447 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: BEGIN
[0m19:50:19.158840 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:50:19.159673 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m19:50:19.166631 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m19:50:19.167276 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m19:50:19.167681 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m19:50:19.168081 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:50:19.170806 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:50:19.171259 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m19:50:19.171637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:19.172879 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:50:19.173254 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:50:19.173658 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal as "close",
    delta::decimal as delta,
    gain::decimal as gain,
    loss::decimal as loss,
    sma_gain::decimal as sma_gain,
    sma_loss::decimal as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m19:50:19.174385 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m19:50:19.207176 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m19:50:19.224536 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:50:19.228494 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m19:50:19.228928 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m19:50:19.229435 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

        
  
    
    

    create  table
      "regime_classification_snapshot__dbt_tmp20251109195019217235"
  
    as (
      
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."int__regime_classification"

    ),

    snapshotted_data as (

        select *, 
    
        trade_date as dbt_unique_key
    

        from "finance"."analytics_dev_snapshots"."regime_classification_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
  
    
[0m19:50:19.262600 [debug] [Thread-2 (]: SQL status: OK in 0.088 seconds
[0m19:50:19.269701 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:50:19.270674 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma" rename to "int__rsi_sma__dbt_backup"
[0m19:50:19.310933 [debug] [Thread-1 (]: SQL status: OK in 0.080 seconds
[0m19:50:19.323395 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:50:19.324578 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m19:50:19.339748 [debug] [Thread-2 (]: SQL status: OK in 0.068 seconds
[0m19:50:19.345286 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:50:19.346058 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m19:50:19.357950 [debug] [Thread-4 (]: SQL status: OK in 0.128 seconds
[0m19:50:19.362068 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m19:50:19.362692 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251109195019217235'
      
      
      order by ordinal_position

  
[0m19:50:19.369593 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m19:50:19.373396 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m19:50:19.373867 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:50:19.379144 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m19:50:19.382493 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m19:50:19.382919 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251109195019217235'
      
      
      order by ordinal_position

  
[0m19:50:19.387408 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m19:50:19.390410 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m19:50:19.390807 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:50:19.395598 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m19:50:19.402141 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m19:50:19.402573 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251109195019217235'
      
      
      order by ordinal_position

  
[0m19:50:19.407211 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m19:50:19.423800 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m19:50:19.424306 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */
DESCRIBE (select * from (
        
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."int__regime_classification"

    ),

    snapshotted_data as (

        select *, 
    
        trade_date as dbt_unique_key
    

        from "finance"."analytics_dev_snapshots"."regime_classification_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:50:19.427766 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m19:50:19.436924 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m19:50:19.437383 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:50:19.438438 [debug] [Thread-2 (]: SQL status: OK in 0.092 seconds
[0m19:50:19.439959 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m19:50:19.440345 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:50:19.440697 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m19:50:19.441211 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m19:50:19.442441 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m19:50:19.442835 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:50:19.443205 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m19:50:19.443608 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m19:50:19.444325 [debug] [Thread-4 (]: Writing runtime sql for node "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m19:50:19.446298 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m19:50:19.446779 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      update "finance"."analytics_dev_snapshots"."regime_classification_snapshot" as DBT_INTERNAL_TARGET
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "regime_classification_snapshot__dbt_tmp20251109195019217235" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = DBT_INTERNAL_TARGET.dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and DBT_INTERNAL_TARGET.dbt_valid_to is null;
      

    insert into "finance"."analytics_dev_snapshots"."regime_classification_snapshot" ("trade_date", "close", "regime", "loaded_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."trade_date",DBT_INTERNAL_SOURCE."close",DBT_INTERNAL_SOURCE."regime",DBT_INTERNAL_SOURCE."loaded_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "regime_classification_snapshot__dbt_tmp20251109195019217235" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;


  
[0m19:50:19.565895 [debug] [Thread-1 (]: SQL status: OK in 0.122 seconds
[0m19:50:19.568990 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m19:50:19.569536 [debug] [Thread-2 (]: SQL status: OK in 0.128 seconds
[0m19:50:19.570011 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m19:50:19.573437 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m19:50:19.574128 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m19:50:19.577114 [debug] [Thread-4 (]: SQL status: OK in 0.130 seconds
[0m19:50:19.578464 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: COMMIT
[0m19:50:19.578898 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m19:50:19.579263 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: COMMIT
[0m19:50:19.683138 [debug] [Thread-4 (]: SQL status: OK in 0.103 seconds
[0m19:50:19.683611 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m19:50:19.686609 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m19:50:19.688152 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m19:50:19.688640 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      drop table if exists "regime_classification_snapshot__dbt_tmp20251109195019217235" cascade
    
[0m19:50:19.689299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C8F05B50>]}
[0m19:50:19.690182 [info ] [Thread-1 (]: 21 of 58 OK created sql view model analytics_dev.int__regime_changes ........... [[32mOK[0m in 0.62s]
[0m19:50:19.691092 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m19:50:19.691862 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:50:19.692414 [info ] [Thread-3 (]: 24 of 58 START sql incremental model analytics_dev.mrt__stocks_with_regimes .... [RUN]
[0m19:50:19.693059 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m19:50:19.693478 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:50:19.700564 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:19.701881 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:50:19.708994 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:19.709497 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__b93ecd47db3a" cascade
    
[0m19:50:19.709938 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:50:19.785934 [debug] [Thread-2 (]: SQL status: OK in 0.211 seconds
[0m19:50:19.787354 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m19:50:19.787886 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CE06B410>]}
[0m19:50:19.788477 [info ] [Thread-2 (]: 23 of 58 OK created sql view model analytics_dev.int__rsi_sma .................. [[32mOK[0m in 0.68s]
[0m19:50:19.789305 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m19:50:19.790473 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m19:50:19.791311 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m19:50:19.790918 [info ] [Thread-1 (]: 25 of 58 START test dbt_utils_expression_is_true_int__rsi_sma_gain___0 ......... [RUN]
[0m19:50:19.792358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6)
[0m19:50:19.792782 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m19:50:19.796830 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m19:50:19.791884 [info ] [Thread-2 (]: 26 of 58 START test dbt_utils_expression_is_true_int__rsi_sma_loss___0 ......... [RUN]
[0m19:50:19.797605 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_sma, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62)
[0m19:50:19.798022 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m19:50:19.802238 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m19:50:19.806337 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m19:50:19.809128 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m19:50:19.810222 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m19:50:19.817381 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m19:50:19.818706 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m19:50:19.819176 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: BEGIN
[0m19:50:19.819579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:19.820401 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m19:50:19.820883 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: BEGIN
[0m19:50:19.821255 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:19.821938 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:50:19.822338 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m19:50:19.822719 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m19:50:19.823386 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:50:19.823788 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m19:50:19.824195 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m19:50:19.881445 [debug] [Thread-3 (]: SQL status: OK in 0.171 seconds
[0m19:50:19.881925 [debug] [Thread-4 (]: SQL status: OK in 0.192 seconds
[0m19:50:19.889427 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: Close
[0m19:50:19.890008 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CE06A750>]}
[0m19:50:19.890762 [info ] [Thread-4 (]: 22 of 58 OK snapshotted analytics_dev_snapshots.regime_classification_snapshot . [[32mOK[0m in 0.79s]
[0m19:50:19.921538 [debug] [Thread-4 (]: Finished running node snapshot.portfolio_project_2.regime_classification_snapshot
[0m19:50:19.929215 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:19.929960 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m19:50:19.930790 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m19:50:19.931480 [info ] [Thread-4 (]: 27 of 58 START test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [RUN]
[0m19:50:19.932373 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.portfolio_project_2.regime_classification_snapshot, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704)
[0m19:50:19.932837 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m19:50:19.938485 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m19:50:19.939176 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m19:50:19.940836 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:19.941271 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m19:50:19.941985 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m19:50:19.944575 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m19:50:19.945274 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m19:50:19.945711 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:19.946115 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m19:50:19.949019 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m19:50:19.949562 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: BEGIN
[0m19:50:19.950047 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:50:19.951575 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:50:19.952048 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m19:50:19.952440 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m19:50:20.007779 [debug] [Thread-2 (]: SQL status: OK in 0.183 seconds
[0m19:50:20.008261 [debug] [Thread-1 (]: SQL status: OK in 0.185 seconds
[0m19:50:20.010740 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: ROLLBACK
[0m19:50:20.011401 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6'
[0m19:50:20.011787 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: Close
[0m19:50:20.013170 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: ROLLBACK
[0m19:50:20.014004 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62'
[0m19:50:20.014425 [debug] [Thread-3 (]: SQL status: OK in 0.068 seconds
[0m19:50:20.014856 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: Close
[0m19:50:20.016076 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:20.017268 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m19:50:20.016823 [info ] [Thread-1 (]: 25 of 58 PASS dbt_utils_expression_is_true_int__rsi_sma_gain___0 ............... [[32mPASS[0m in 0.22s]
[0m19:50:20.018162 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m19:50:20.018620 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m19:50:20.019537 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:50:20.020822 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:50:20.019036 [info ] [Thread-1 (]: 28 of 58 START test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ..... [RUN]
[0m19:50:20.021992 [debug] [Thread-4 (]: SQL status: OK in 0.069 seconds
[0m19:50:20.022447 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:20.021624 [info ] [Thread-2 (]: 26 of 58 PASS dbt_utils_expression_is_true_int__rsi_sma_loss___0 ............... [[32mPASS[0m in 0.22s]
[0m19:50:20.023147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9)
[0m19:50:20.023731 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:50:20.024411 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m19:50:20.025893 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: ROLLBACK
[0m19:50:20.026355 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m19:50:20.027144 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m19:50:20.028004 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704'
[0m19:50:20.032868 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m19:50:20.034023 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: Close
[0m19:50:20.033553 [info ] [Thread-2 (]: 29 of 58 START test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ..... [RUN]
[0m19:50:20.035088 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21)
[0m19:50:20.035583 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m19:50:20.040269 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m19:50:20.041147 [info ] [Thread-4 (]: 27 of 58 PASS dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[32mPASS[0m in 0.11s]
[0m19:50:20.042378 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m19:50:20.042978 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m19:50:20.043458 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m19:50:20.046042 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m19:50:20.046739 [info ] [Thread-4 (]: 30 of 58 START test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [RUN]
[0m19:50:20.047701 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08)
[0m19:50:20.048157 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m19:50:20.052175 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m19:50:20.052650 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m19:50:20.055291 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m19:50:20.056120 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m19:50:20.058786 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m19:50:20.059493 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m19:50:20.060031 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: BEGIN
[0m19:50:20.060416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:20.061094 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m19:50:20.061523 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: BEGIN
[0m19:50:20.061922 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:20.062737 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:50:20.063220 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m19:50:20.063627 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m19:50:20.064347 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m19:50:20.064759 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: BEGIN
[0m19:50:20.065138 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:50:20.065710 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m19:50:20.066113 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m19:50:20.066519 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m19:50:20.066931 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:50:20.067576 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m19:50:20.067992 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_sma"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m19:50:20.078975 [debug] [Thread-3 (]: SQL status: OK in 0.052 seconds
[0m19:50:20.079876 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:20.080331 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
  
    
    

    create  table
      "finance"."dbt_temp"."mrt__stocks_with_regimes__b93ecd47db3a"
  
    as (
      


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume, 
        loaded_at
    from "finance"."analytics_dev"."src_stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
        and trade_date > (select max(trade_date) from "finance"."analytics_dev"."mrt__stocks_with_regimes")
        
)

select
    s.trade_date, 
    s.ticker, 
    s."open", 
    s.high, 
    s.low, 
    s."close", 
    s.volume, 
    r.regime
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    );
  
  
  
[0m19:50:20.137796 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m19:50:20.139534 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m19:50:20.149615 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: ROLLBACK
[0m19:50:20.155132 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: ROLLBACK
[0m19:50:20.157062 [debug] [Thread-4 (]: SQL status: OK in 0.088 seconds
[0m19:50:20.159563 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9'
[0m19:50:20.162406 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21'
[0m19:50:20.164604 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: Close
[0m19:50:20.166465 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: Close
[0m19:50:20.173818 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: ROLLBACK
[0m19:50:20.178076 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08'
[0m19:50:20.175588 [info ] [Thread-1 (]: 28 of 58 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 ........... [[32mPASS[0m in 0.15s]
[0m19:50:20.179076 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: Close
[0m19:50:20.180366 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m19:50:20.176973 [info ] [Thread-2 (]: 29 of 58 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 ........... [[32mPASS[0m in 0.14s]
[0m19:50:20.181598 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m19:50:20.182897 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m19:50:20.185237 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m19:50:20.183839 [info ] [Thread-4 (]: 30 of 58 PASS dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn .. [[32mPASS[0m in 0.14s]
[0m19:50:20.187280 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m19:50:20.187900 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m19:50:20.184529 [info ] [Thread-1 (]: 31 of 58 START test not_null_int__rsi_sma_close ................................ [RUN]
[0m19:50:20.189405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9, now test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b)
[0m19:50:20.186088 [info ] [Thread-2 (]: 32 of 58 START test not_null_int__rsi_sma_gain ................................. [RUN]
[0m19:50:20.190347 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m19:50:20.191382 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21, now test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953)
[0m19:50:20.188404 [info ] [Thread-4 (]: 33 of 58 START test not_null_int__rsi_sma_loaded_at ............................ [RUN]
[0m19:50:20.197583 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m19:50:20.198205 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m19:50:20.198805 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08, now test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0)
[0m19:50:20.203836 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m19:50:20.204463 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m19:50:20.209027 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m19:50:20.209916 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m19:50:20.212473 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m19:50:20.213479 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m19:50:20.217389 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m19:50:20.218006 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m19:50:20.220257 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m19:50:20.221570 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m19:50:20.222245 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: BEGIN
[0m19:50:20.223569 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m19:50:20.224208 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m19:50:20.224675 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:20.225129 [debug] [Thread-3 (]: SQL status: OK in 0.144 seconds
[0m19:50:20.225623 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: BEGIN
[0m19:50:20.226081 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: BEGIN
[0m19:50:20.227062 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:50:20.233013 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:20.233516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:20.233993 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m19:50:20.234859 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m19:50:20.235617 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m19:50:20.236233 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m19:50:20.236665 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:50:20.237150 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_sma"
where gain is null



  
  
      
    ) dbt_internal_test
[0m19:50:20.237625 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m19:50:20.238043 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:50:20.238497 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m19:50:20.239202 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__rsi_sma"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m19:50:20.239683 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:20.240156 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__rsi_sma"
where close is null



  
  
      
    ) dbt_internal_test
[0m19:50:20.240863 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__b93ecd47db3a'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:50:20.247901 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m19:50:20.251703 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:20.252219 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:50:20.258048 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m19:50:20.270341 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:20.270789 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes__b93ecd47db3a'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:50:20.275954 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m19:50:20.279342 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:20.279762 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'mrt__stocks_with_regimes'
      
      and lower(table_schema) = 'analytics_dev'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m19:50:20.284526 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m19:50:20.294370 [debug] [Thread-3 (]: 
    In "finance"."analytics_dev"."mrt__stocks_with_regimes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:50:20.294927 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:20.295299 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
SELECT version()
[0m19:50:20.296158 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m19:50:20.352547 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m19:50:20.367243 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:20.367768 [debug] [Thread-2 (]: SQL status: OK in 0.129 seconds
[0m19:50:20.368289 [debug] [Thread-4 (]: SQL status: OK in 0.128 seconds
[0m19:50:20.369351 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:20.369785 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */


    MERGE INTO "finance"."analytics_dev"."mrt__stocks_with_regimes" AS DBT_INTERNAL_DEST
        USING "finance"."dbt_temp"."mrt__stocks_with_regimes__b93ecd47db3a" AS DBT_INTERNAL_SOURCE
        
            
                
                    
                
                    
                
            
        
        ON (DBT_INTERNAL_SOURCE.trade_date = DBT_INTERNAL_DEST.trade_date) AND (DBT_INTERNAL_SOURCE.ticker = DBT_INTERNAL_DEST.ticker)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m19:50:20.371283 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: ROLLBACK
[0m19:50:20.372581 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: ROLLBACK
[0m19:50:20.373896 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: ROLLBACK
[0m19:50:20.374827 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0'
[0m19:50:20.375500 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b'
[0m19:50:20.376077 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953'
[0m19:50:20.376463 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: Close
[0m19:50:20.376907 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: Close
[0m19:50:20.377350 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: Close
[0m19:50:20.378312 [info ] [Thread-1 (]: 31 of 58 PASS not_null_int__rsi_sma_close ...................................... [[32mPASS[0m in 0.19s]
[0m19:50:20.380091 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m19:50:20.378834 [info ] [Thread-4 (]: 33 of 58 PASS not_null_int__rsi_sma_loaded_at .................................. [[32mPASS[0m in 0.18s]
[0m19:50:20.380664 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m19:50:20.381325 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m19:50:20.379366 [info ] [Thread-2 (]: 32 of 58 PASS not_null_int__rsi_sma_gain ....................................... [[32mPASS[0m in 0.19s]
[0m19:50:20.382380 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m19:50:20.381880 [info ] [Thread-1 (]: 34 of 58 START test not_null_int__rsi_sma_loss ................................. [RUN]
[0m19:50:20.383242 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m19:50:20.384160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b, now test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065)
[0m19:50:20.383659 [info ] [Thread-4 (]: 35 of 58 START test not_null_int__rsi_sma_rn ................................... [RUN]
[0m19:50:20.384809 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m19:50:20.385273 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m19:50:20.385787 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0, now test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139)
[0m19:50:20.390792 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m19:50:20.386264 [info ] [Thread-2 (]: 36 of 58 START test not_null_int__rsi_sma_sma_gain ............................. [RUN]
[0m19:50:20.391464 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m19:50:20.392157 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953, now test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416)
[0m19:50:20.396664 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m19:50:20.397242 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m19:50:20.402260 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m19:50:20.403068 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m19:50:20.405533 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m19:50:20.406070 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m19:50:20.408679 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m19:50:20.409533 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m19:50:20.411987 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m19:50:20.413121 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m19:50:20.413806 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m19:50:20.414301 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: BEGIN
[0m19:50:20.415039 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m19:50:20.415698 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: BEGIN
[0m19:50:20.416179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:20.416624 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: BEGIN
[0m19:50:20.417049 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:50:20.417722 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:20.418615 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:50:20.418994 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m19:50:20.419391 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_sma"
where loss is null



  
  
      
    ) dbt_internal_test
[0m19:50:20.420019 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m19:50:20.420413 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m19:50:20.420803 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_sma"
where rn is null



  
  
      
    ) dbt_internal_test
[0m19:50:20.421349 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m19:50:20.421737 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m19:50:20.422126 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_gain
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_gain is null



  
  
      
    ) dbt_internal_test
[0m19:50:20.453538 [debug] [Thread-3 (]: SQL status: OK in 0.083 seconds
[0m19:50:20.454885 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:50:20.455276 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:20.455630 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m19:50:20.501756 [debug] [Thread-2 (]: SQL status: OK in 0.079 seconds
[0m19:50:20.503521 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m19:50:20.505113 [debug] [Thread-4 (]: SQL status: OK in 0.084 seconds
[0m19:50:20.507402 [debug] [Thread-3 (]: SQL status: OK in 0.051 seconds
[0m19:50:20.519137 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:20.520349 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__b93ecd47db3a" cascade
    
[0m19:50:20.523903 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: ROLLBACK
[0m19:50:20.526914 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: ROLLBACK
[0m19:50:20.529845 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: ROLLBACK
[0m19:50:20.531678 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416'
[0m19:50:20.533080 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139'
[0m19:50:20.534618 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065'
[0m19:50:20.535536 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: Close
[0m19:50:20.536507 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: Close
[0m19:50:20.537474 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: Close
[0m19:50:20.539589 [info ] [Thread-4 (]: 35 of 58 PASS not_null_int__rsi_sma_rn ......................................... [[32mPASS[0m in 0.15s]
[0m19:50:20.543588 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m19:50:20.540801 [info ] [Thread-1 (]: 34 of 58 PASS not_null_int__rsi_sma_loss ....................................... [[32mPASS[0m in 0.16s]
[0m19:50:20.544889 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m19:50:20.546602 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m19:50:20.541935 [info ] [Thread-2 (]: 36 of 58 PASS not_null_int__rsi_sma_sma_gain ................................... [[32mPASS[0m in 0.15s]
[0m19:50:20.548902 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m19:50:20.547904 [info ] [Thread-4 (]: 37 of 58 START test not_null_int__rsi_sma_sma_loss ............................. [RUN]
[0m19:50:20.550680 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m19:50:20.552887 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139, now test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6)
[0m19:50:20.551871 [info ] [Thread-1 (]: 38 of 58 START test not_null_int__rsi_sma_ticker ............................... [RUN]
[0m19:50:20.554436 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m19:50:20.555657 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m19:50:20.556929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065, now test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d)
[0m19:50:20.566774 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m19:50:20.558097 [info ] [Thread-2 (]: 39 of 58 START test not_null_int__rsi_sma_trade_date ........................... [RUN]
[0m19:50:20.567788 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m19:50:20.568858 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416, now test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0)
[0m19:50:20.574695 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m19:50:20.575351 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m19:50:20.580793 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m19:50:20.581361 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m19:50:20.584100 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m19:50:20.584866 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m19:50:20.587543 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m19:50:20.588223 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m19:50:20.590690 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m19:50:20.591253 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m19:50:20.591673 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: BEGIN
[0m19:50:20.592051 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:50:20.592994 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m19:50:20.593404 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: BEGIN
[0m19:50:20.593763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:20.594339 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:50:20.594736 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m19:50:20.595113 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_loss
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_loss is null



  
  
      
    ) dbt_internal_test
[0m19:50:20.595755 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m19:50:20.596243 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:50:20.596781 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: BEGIN
[0m19:50:20.597358 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m19:50:20.597805 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:20.598239 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_sma"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m19:50:20.599533 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:50:20.599974 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m19:50:20.600378 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_sma"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m19:50:20.685959 [debug] [Thread-3 (]: SQL status: OK in 0.155 seconds
[0m19:50:20.689058 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m19:50:20.689478 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__b93ecd47db3a" cascade
    
[0m19:50:20.752634 [debug] [Thread-3 (]: SQL status: OK in 0.063 seconds
[0m19:50:20.753985 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m19:50:20.754560 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C8F04A10>]}
[0m19:50:20.755187 [info ] [Thread-3 (]: 24 of 58 OK created sql incremental model analytics_dev.mrt__stocks_with_regimes  [[32mOK[0m in 1.06s]
[0m19:50:20.756413 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m19:50:20.759065 [debug] [Thread-4 (]: SQL status: OK in 0.163 seconds
[0m19:50:20.761649 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: ROLLBACK
[0m19:50:20.762478 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6'
[0m19:50:20.762864 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: Close
[0m19:50:20.763349 [debug] [Thread-2 (]: SQL status: OK in 0.163 seconds
[0m19:50:20.763862 [debug] [Thread-1 (]: SQL status: OK in 0.165 seconds
[0m19:50:20.766104 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: ROLLBACK
[0m19:50:20.764587 [info ] [Thread-4 (]: 37 of 58 PASS not_null_int__rsi_sma_sma_loss ................................... [[32mPASS[0m in 0.21s]
[0m19:50:20.767015 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0'
[0m19:50:20.768707 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: ROLLBACK
[0m19:50:20.769813 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m19:50:20.770461 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: Close
[0m19:50:20.771349 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d'
[0m19:50:20.772110 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: Close
[0m19:50:20.773441 [info ] [Thread-2 (]: 39 of 58 PASS not_null_int__rsi_sma_trade_date ................................. [[32mPASS[0m in 0.20s]
[0m19:50:20.774446 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m19:50:20.775329 [info ] [Thread-1 (]: 38 of 58 PASS not_null_int__rsi_sma_ticker ..................................... [[32mPASS[0m in 0.22s]
[0m19:50:20.776244 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m19:50:20.777127 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m19:50:20.777892 [info ] [Thread-3 (]: 40 of 58 START sql view model analytics_dev.int__rsi_wilder .................... [RUN]
[0m19:50:20.778929 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.mrt__stocks_with_regimes, now model.portfolio_project_2.int__rsi_wilder)
[0m19:50:20.779436 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m19:50:20.783374 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m19:50:20.784426 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m19:50:20.787875 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m19:50:20.789270 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:50:20.790037 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m19:50:20.790688 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:50:20.792421 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:50:20.792886 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:50:20.793300 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal as gain,
    loss::decimal as loss,
    wilder_gain::decimal as wilder_gain,
    wilder_loss::decimal as wilder_loss
from wilder
  );

[0m19:50:20.873509 [debug] [Thread-3 (]: SQL status: OK in 0.080 seconds
[0m19:50:20.876781 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:50:20.877196 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder" rename to "int__rsi_wilder__dbt_backup"
[0m19:50:20.942857 [debug] [Thread-3 (]: SQL status: OK in 0.065 seconds
[0m19:50:20.946065 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:50:20.946490 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m19:50:21.009174 [debug] [Thread-3 (]: SQL status: OK in 0.062 seconds
[0m19:50:21.010634 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m19:50:21.011035 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:50:21.011396 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m19:50:21.122096 [debug] [Thread-3 (]: SQL status: OK in 0.110 seconds
[0m19:50:21.125430 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m19:50:21.125901 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m19:50:21.274185 [debug] [Thread-3 (]: SQL status: OK in 0.148 seconds
[0m19:50:21.275561 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m19:50:21.276076 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C8ECFE90>]}
[0m19:50:21.276645 [info ] [Thread-3 (]: 40 of 58 OK created sql view model analytics_dev.int__rsi_wilder ............... [[32mOK[0m in 0.50s]
[0m19:50:21.277479 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m19:50:21.278455 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m19:50:21.279302 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m19:50:21.279796 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m19:50:21.278933 [info ] [Thread-3 (]: 44 of 58 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [RUN]
[0m19:50:21.280802 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m19:50:21.281822 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_wilder, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d)
[0m19:50:21.280355 [info ] [Thread-1 (]: 43 of 58 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [RUN]
[0m19:50:21.282836 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m19:50:21.283481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7)
[0m19:50:21.281292 [info ] [Thread-4 (]: 41 of 58 START test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ...... [RUN]
[0m19:50:21.294652 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m19:50:21.282295 [info ] [Thread-2 (]: 42 of 58 START test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ...... [RUN]
[0m19:50:21.295943 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m19:50:21.296722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90)
[0m19:50:21.297476 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703)
[0m19:50:21.301926 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m19:50:21.302524 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m19:50:21.303142 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m19:50:21.308052 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m19:50:21.314177 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m19:50:21.314663 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m19:50:21.318768 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m19:50:21.319477 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m19:50:21.322063 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m19:50:21.323042 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m19:50:21.323718 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m19:50:21.324330 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m19:50:21.327166 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m19:50:21.330584 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m19:50:21.331264 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: BEGIN
[0m19:50:21.331858 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m19:50:21.332764 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:50:21.333296 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: BEGIN
[0m19:50:21.334485 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m19:50:21.335393 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m19:50:21.335880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:21.336317 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: BEGIN
[0m19:50:21.336730 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m19:50:21.337164 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: BEGIN
[0m19:50:21.337790 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:50:21.338329 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m19:50:21.338811 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:21.339223 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:50:21.339883 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m19:50:21.340562 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m19:50:21.341159 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:50:21.341575 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m19:50:21.342046 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m19:50:21.342513 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m19:50:21.342961 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m19:50:21.343699 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m19:50:21.344537 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m19:50:22.577817 [debug] [Thread-4 (]: SQL status: OK in 1.232 seconds
[0m19:50:22.578411 [debug] [Thread-1 (]: SQL status: OK in 1.235 seconds
[0m19:50:22.579035 [debug] [Thread-2 (]: SQL status: OK in 1.234 seconds
[0m19:50:22.579463 [debug] [Thread-3 (]: SQL status: OK in 1.238 seconds
[0m19:50:22.583110 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: ROLLBACK
[0m19:50:22.584338 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90'
[0m19:50:22.584737 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: Close
[0m19:50:22.586120 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: ROLLBACK
[0m19:50:22.588247 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: ROLLBACK
[0m19:50:22.588924 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d'
[0m19:50:22.589330 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: Close
[0m19:50:22.586781 [info ] [Thread-4 (]: 41 of 58 PASS dbt_utils_expression_is_true_int__rsi_wilder_gain___0 ............ [[32mPASS[0m in 1.29s]
[0m19:50:22.590971 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: ROLLBACK
[0m19:50:22.591596 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7'
[0m19:50:22.592230 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m19:50:22.592874 [info ] [Thread-3 (]: 44 of 58 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0 ..... [[32mPASS[0m in 1.31s]
[0m19:50:22.593744 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703'
[0m19:50:22.594215 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: Close
[0m19:50:22.594894 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m19:50:22.595907 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m19:50:22.596357 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: Close
[0m19:50:22.598894 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m19:50:22.597221 [info ] [Thread-4 (]: 45 of 58 START test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [RUN]
[0m19:50:22.598278 [info ] [Thread-1 (]: 43 of 58 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0 ..... [[32mPASS[0m in 1.31s]
[0m19:50:22.600489 [info ] [Thread-3 (]: 46 of 58 START test not_null_int__rsi_wilder_gain .............................. [RUN]
[0m19:50:22.602557 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95)
[0m19:50:22.601597 [info ] [Thread-2 (]: 42 of 58 PASS dbt_utils_expression_is_true_int__rsi_wilder_loss___0 ............ [[32mPASS[0m in 1.30s]
[0m19:50:22.603474 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m19:50:22.603977 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d, now test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda)
[0m19:50:22.604450 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m19:50:22.605112 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m19:50:22.605598 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m19:50:22.606043 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m19:50:22.610260 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m19:50:22.610754 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m19:50:22.611225 [info ] [Thread-1 (]: 47 of 58 START test not_null_int__rsi_wilder_loss .............................. [RUN]
[0m19:50:22.616995 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m19:50:22.618160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7, now test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56)
[0m19:50:22.617682 [info ] [Thread-2 (]: 48 of 58 START test not_null_int__rsi_wilder_rn ................................ [RUN]
[0m19:50:22.618890 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m19:50:22.619403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703, now test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d)
[0m19:50:22.619889 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m19:50:22.624006 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m19:50:22.624491 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m19:50:22.624908 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m19:50:22.627300 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m19:50:22.632321 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m19:50:22.634747 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m19:50:22.635668 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m19:50:22.638020 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m19:50:22.638884 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m19:50:22.641171 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m19:50:22.641777 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m19:50:22.642179 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: BEGIN
[0m19:50:22.642550 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:50:22.643249 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m19:50:22.643811 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: BEGIN
[0m19:50:22.644210 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:50:22.644896 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m19:50:22.645305 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: BEGIN
[0m19:50:22.645680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:22.646244 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m19:50:22.646661 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m19:50:22.647212 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_wilder"
where gain is null



  
  
      
    ) dbt_internal_test
[0m19:50:22.647804 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:50:22.648261 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m19:50:22.648736 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m19:50:22.649502 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m19:50:22.649972 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m19:50:22.650455 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: BEGIN
[0m19:50:22.650928 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_wilder"
where loss is null



  
  
      
    ) dbt_internal_test
[0m19:50:22.651422 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_wilder"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m19:50:22.651882 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:22.653561 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:50:22.653973 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m19:50:22.654375 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_wilder"
where rn is null



  
  
      
    ) dbt_internal_test
[0m19:50:23.735825 [debug] [Thread-3 (]: SQL status: OK in 1.086 seconds
[0m19:50:23.739661 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: ROLLBACK
[0m19:50:23.740600 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda'
[0m19:50:23.740953 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: Close
[0m19:50:23.741805 [info ] [Thread-3 (]: 46 of 58 PASS not_null_int__rsi_wilder_gain .................................... [[32mPASS[0m in 1.14s]
[0m19:50:23.742606 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m19:50:23.743023 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m19:50:23.743432 [info ] [Thread-3 (]: 49 of 58 START test not_null_int__rsi_wilder_ticker ............................ [RUN]
[0m19:50:23.744075 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda, now test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd)
[0m19:50:23.744440 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m19:50:23.748191 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m19:50:23.749072 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m19:50:23.751683 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m19:50:23.752739 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m19:50:23.753166 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: BEGIN
[0m19:50:23.753531 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:50:23.754762 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:50:23.755229 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m19:50:23.755665 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_wilder"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m19:50:23.765265 [debug] [Thread-2 (]: SQL status: OK in 1.110 seconds
[0m19:50:23.765781 [debug] [Thread-4 (]: SQL status: OK in 1.113 seconds
[0m19:50:23.766261 [debug] [Thread-1 (]: SQL status: OK in 1.114 seconds
[0m19:50:23.768766 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: ROLLBACK
[0m19:50:23.770179 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: ROLLBACK
[0m19:50:23.770899 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d'
[0m19:50:23.771523 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95'
[0m19:50:23.771951 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: Close
[0m19:50:23.773291 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: ROLLBACK
[0m19:50:23.773719 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: Close
[0m19:50:23.774452 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56'
[0m19:50:23.775470 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: Close
[0m19:50:23.775100 [info ] [Thread-2 (]: 48 of 58 PASS not_null_int__rsi_wilder_rn ...................................... [[32mPASS[0m in 1.16s]
[0m19:50:23.777200 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m19:50:23.777710 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m19:50:23.776189 [info ] [Thread-4 (]: 45 of 58 PASS dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[32mPASS[0m in 1.17s]
[0m19:50:23.779916 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m19:50:23.778130 [info ] [Thread-2 (]: 50 of 58 START test not_null_int__rsi_wilder_trade_date ........................ [RUN]
[0m19:50:23.780781 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m19:50:23.779019 [info ] [Thread-1 (]: 47 of 58 PASS not_null_int__rsi_wilder_loss .................................... [[32mPASS[0m in 1.16s]
[0m19:50:23.781612 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d, now test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c)
[0m19:50:23.782779 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m19:50:23.783282 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m19:50:23.782090 [info ] [Thread-4 (]: 51 of 58 START test not_null_int__rsi_wilder_wilder_gain ....................... [RUN]
[0m19:50:23.784137 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m19:50:23.787837 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m19:50:23.788390 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9)
[0m19:50:23.788857 [info ] [Thread-1 (]: 52 of 58 START test not_null_int__rsi_wilder_wilder_loss ....................... [RUN]
[0m19:50:23.789517 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m19:50:23.790289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb)
[0m19:50:23.794387 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m19:50:23.794992 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m19:50:23.795682 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m19:50:23.800738 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m19:50:23.806672 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m19:50:23.807639 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m19:50:23.810264 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m19:50:23.811209 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m19:50:23.815315 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m19:50:23.815841 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m19:50:23.816606 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: BEGIN
[0m19:50:23.816974 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:23.817736 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m19:50:23.818221 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: BEGIN
[0m19:50:23.818557 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:50:23.819219 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m19:50:23.819755 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: BEGIN
[0m19:50:23.820095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:23.820622 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m19:50:23.821042 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m19:50:23.821410 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_wilder"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m19:50:23.822050 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m19:50:23.822438 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m19:50:23.822822 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_gain
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_gain is null



  
  
      
    ) dbt_internal_test
[0m19:50:23.823361 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:50:23.823740 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m19:50:23.824117 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_loss is null



  
  
      
    ) dbt_internal_test
[0m19:50:24.852801 [debug] [Thread-3 (]: SQL status: OK in 1.096 seconds
[0m19:50:24.858397 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: ROLLBACK
[0m19:50:24.859072 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd'
[0m19:50:24.859454 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: Close
[0m19:50:24.860798 [info ] [Thread-3 (]: 49 of 58 PASS not_null_int__rsi_wilder_ticker .................................. [[32mPASS[0m in 1.12s]
[0m19:50:24.861648 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m19:50:24.862087 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m19:50:24.862490 [info ] [Thread-3 (]: 53 of 58 START test wilder_seed_equals_sma ..................................... [RUN]
[0m19:50:24.863118 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd, now test.portfolio_project_2.wilder_seed_equals_sma)
[0m19:50:24.863487 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.wilder_seed_equals_sma
[0m19:50:24.866581 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m19:50:24.867456 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.wilder_seed_equals_sma
[0m19:50:24.869714 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m19:50:24.871539 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m19:50:24.872039 [debug] [Thread-3 (]: On test.portfolio_project_2.wilder_seed_equals_sma: BEGIN
[0m19:50:24.872389 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:50:24.873579 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:50:24.873935 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m19:50:24.874302 [debug] [Thread-3 (]: On test.portfolio_project_2.wilder_seed_equals_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.wilder_seed_equals_sma"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- asserts the seed matches SMA at rn=14
with w as (
  select ticker, trade_date, wilder_gain, wilder_loss
  from "finance"."analytics_dev"."int__rsi_wilder"
  where rn = 14
),
s as (
  select ticker, trade_date, sma_gain, sma_loss
  from "finance"."analytics_dev"."int__rsi_sma"
  where rn = 14
)
select
  w.ticker,
  w.trade_date
from w
join s using (ticker, trade_date)
where abs(w.wilder_gain - s.sma_gain) > 1e-9
   or abs(w.wilder_loss - s.sma_loss) > 1e-9
  
  
      
    ) dbt_internal_test
[0m19:50:24.894238 [debug] [Thread-2 (]: SQL status: OK in 1.072 seconds
[0m19:50:24.897081 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: ROLLBACK
[0m19:50:24.897781 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c'
[0m19:50:24.898145 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: Close
[0m19:50:24.899249 [info ] [Thread-2 (]: 50 of 58 PASS not_null_int__rsi_wilder_trade_date .............................. [[32mPASS[0m in 1.12s]
[0m19:50:24.900181 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m19:50:24.913739 [debug] [Thread-4 (]: SQL status: OK in 1.090 seconds
[0m19:50:24.914336 [debug] [Thread-1 (]: SQL status: OK in 1.090 seconds
[0m19:50:24.917014 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: ROLLBACK
[0m19:50:24.918325 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: ROLLBACK
[0m19:50:24.918979 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb'
[0m19:50:24.919481 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: Close
[0m19:50:24.920021 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9'
[0m19:50:24.920395 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: Close
[0m19:50:24.921245 [info ] [Thread-4 (]: 51 of 58 PASS not_null_int__rsi_wilder_wilder_gain ............................. [[32mPASS[0m in 1.13s]
[0m19:50:24.922424 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m19:50:24.921763 [info ] [Thread-1 (]: 52 of 58 PASS not_null_int__rsi_wilder_wilder_loss ............................. [[32mPASS[0m in 1.13s]
[0m19:50:24.923370 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m19:50:25.970642 [debug] [Thread-3 (]: SQL status: OK in 1.096 seconds
[0m19:50:25.976929 [debug] [Thread-3 (]: On test.portfolio_project_2.wilder_seed_equals_sma: ROLLBACK
[0m19:50:25.978296 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.wilder_seed_equals_sma'
[0m19:50:25.979108 [debug] [Thread-3 (]: On test.portfolio_project_2.wilder_seed_equals_sma: Close
[0m19:50:25.980995 [info ] [Thread-3 (]: 53 of 58 PASS wilder_seed_equals_sma ........................................... [[32mPASS[0m in 1.12s]
[0m19:50:25.982737 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m19:50:25.984220 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.fct__rsi
[0m19:50:25.985473 [info ] [Thread-2 (]: 54 of 58 START sql view model analytics_dev.fct__rsi ........................... [RUN]
[0m19:50:25.986783 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c, now model.portfolio_project_2.fct__rsi)
[0m19:50:25.987828 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m19:50:25.991872 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m19:50:25.993055 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m19:50:26.006575 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:50:26.007140 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:50:26.007603 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:26.024842 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m19:50:26.039243 [warn ] [Thread-2 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['sma_rs', 'sma_rsi', 'wilder_rs', 'wilder_rsi']`
[0m19:50:26.040188 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:50:26.040568 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal)
 as sma_rs, 
      
    cast(null as decimal)
 as sma_rsi, 
      
    cast(null as decimal)
 as wilder_rs, 
      
    cast(null as decimal)
 as wilder_rsi
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:50:26.042124 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:50:26.048890 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m19:50:26.050158 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:50:26.050616 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m19:50:26.051747 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:50:26.052116 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:50:26.052535 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
    
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal as sma_rs, 
    sma_rsi::decimal as sma_rsi, 
    wilder_rs::decimal as wilder_rs, 
    wilder_rsi::decimal as wilder_rsi
from final
  );

[0m19:50:26.310024 [debug] [Thread-2 (]: SQL status: OK in 0.257 seconds
[0m19:50:26.313413 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:50:26.313823 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
alter view "finance"."analytics_dev"."fct__rsi" rename to "fct__rsi__dbt_backup"
[0m19:50:26.374192 [debug] [Thread-2 (]: SQL status: OK in 0.060 seconds
[0m19:50:26.377504 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:50:26.377929 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
alter view "finance"."analytics_dev"."fct__rsi__dbt_tmp" rename to "fct__rsi"
[0m19:50:26.440666 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m19:50:26.442954 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m19:50:26.443620 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:50:26.444228 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m19:50:26.550519 [debug] [Thread-2 (]: SQL status: OK in 0.106 seconds
[0m19:50:26.553435 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m19:50:26.553862 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop view if exists "finance"."analytics_dev"."fct__rsi__dbt_backup" cascade
    
[0m19:50:26.674941 [debug] [Thread-2 (]: SQL status: OK in 0.121 seconds
[0m19:50:26.676313 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: Close
[0m19:50:26.676830 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f8d803-ec25-4227-bc55-75fbcc646cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C8F044D0>]}
[0m19:50:26.677410 [info ] [Thread-2 (]: 54 of 58 OK created sql view model analytics_dev.fct__rsi ...................... [[32mOK[0m in 0.69s]
[0m19:50:26.678385 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m19:50:26.679477 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m19:50:26.679964 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m19:50:26.681094 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m19:50:26.681546 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m19:50:26.680605 [info ] [Thread-4 (]: 55 of 58 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [RUN]
[0m19:50:26.682209 [info ] [Thread-2 (]: 58 of 58 START test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ........ [RUN]
[0m19:50:26.683795 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9, now test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a)
[0m19:50:26.684299 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.fct__rsi, now test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0)
[0m19:50:26.684870 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m19:50:26.682657 [info ] [Thread-1 (]: 56 of 58 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [RUN]
[0m19:50:26.685627 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m19:50:26.683156 [info ] [Thread-3 (]: 57 of 58 START test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ........... [RUN]
[0m19:50:26.705392 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m19:50:26.706035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb, now test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2)
[0m19:50:26.711444 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m19:50:26.712307 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.wilder_seed_equals_sma, now test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a)
[0m19:50:26.713315 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m19:50:26.714298 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m19:50:26.719938 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m19:50:26.724202 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m19:50:26.725500 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m19:50:26.728809 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m19:50:26.729348 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m19:50:26.732235 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m19:50:26.732698 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m19:50:26.733320 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m19:50:26.736371 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m19:50:26.738919 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m19:50:26.739453 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m19:50:26.740386 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: BEGIN
[0m19:50:26.740869 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:50:26.741544 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m19:50:26.741956 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: BEGIN
[0m19:50:26.742329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:26.743025 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:50:26.743540 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m19:50:26.743980 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and sma_rsi >= 0 and sma_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m19:50:26.744757 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m19:50:26.745248 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: BEGIN
[0m19:50:26.745605 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:26.746174 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:50:26.746679 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m19:50:26.747125 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m19:50:26.747693 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: BEGIN
[0m19:50:26.748227 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and wilder_rsi >= 0 and wilder_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m19:50:26.748732 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m19:50:26.749199 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:50:26.750013 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m19:50:26.750802 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where wilder_rs is not null) dbt_subquery

where not(wilder_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m19:50:26.751478 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:50:26.751923 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m19:50:26.752334 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where sma_rs is not null) dbt_subquery

where not(sma_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m19:50:28.051925 [debug] [Thread-4 (]: SQL status: OK in 1.307 seconds
[0m19:50:28.053889 [debug] [Thread-1 (]: SQL status: OK in 1.304 seconds
[0m19:50:28.055946 [debug] [Thread-3 (]: SQL status: OK in 1.303 seconds
[0m19:50:28.057699 [debug] [Thread-2 (]: SQL status: OK in 1.306 seconds
[0m19:50:28.059670 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: ROLLBACK
[0m19:50:28.060308 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a'
[0m19:50:28.060673 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: Close
[0m19:50:28.062013 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: ROLLBACK
[0m19:50:28.062597 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2'
[0m19:50:28.062962 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: Close
[0m19:50:28.064765 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: ROLLBACK
[0m19:50:28.065349 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a'
[0m19:50:28.065708 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: Close
[0m19:50:28.063526 [info ] [Thread-4 (]: 55 of 58 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[32mPASS[0m in 1.38s]
[0m19:50:28.066604 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m19:50:28.068054 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: ROLLBACK
[0m19:50:28.068677 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0'
[0m19:50:28.069062 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: Close
[0m19:50:28.069636 [info ] [Thread-3 (]: 57 of 58 PASS dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ................. [[32mPASS[0m in 1.36s]
[0m19:50:28.071430 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m19:50:28.070156 [info ] [Thread-1 (]: 56 of 58 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[32mPASS[0m in 1.36s]
[0m19:50:28.072565 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m19:50:28.070743 [info ] [Thread-2 (]: 58 of 58 PASS dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 .............. [[32mPASS[0m in 1.39s]
[0m19:50:28.073493 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m19:50:28.075358 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:28.075732 [debug] [MainThread]: On master: BEGIN
[0m19:50:28.076041 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:50:28.078018 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:50:28.078793 [debug] [MainThread]: On master: COMMIT
[0m19:50:28.079385 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:28.079756 [debug] [MainThread]: On master: COMMIT
[0m19:50:28.080537 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:50:28.080867 [debug] [MainThread]: On master: Close
[0m19:50:28.081280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:28.081563 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m19:50:28.081830 [debug] [MainThread]: Connection 'create_finance_analytics_dev_snapshots' was properly closed.
[0m19:50:28.082092 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m19:50:28.082353 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m19:50:28.082613 [debug] [MainThread]: Connection 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2' was properly closed.
[0m19:50:28.082880 [debug] [MainThread]: Connection 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a' was properly closed.
[0m19:50:28.083143 [debug] [MainThread]: Connection 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0' was properly closed.
[0m19:50:28.083405 [debug] [MainThread]: Connection 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a' was properly closed.
[0m19:50:28.083814 [info ] [MainThread]: 
[0m19:50:28.084325 [info ] [MainThread]: Finished running 1 incremental model, 1 seed, 1 snapshot, 46 data tests, 9 view models in 0 hours 0 minutes and 12.96 seconds (12.96s).
[0m19:50:28.095184 [debug] [MainThread]: Command end result
[0m19:50:28.144908 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m19:50:28.147432 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m19:50:28.155472 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m19:50:28.155855 [info ] [MainThread]: 
[0m19:50:28.156395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:50:28.156937 [info ] [MainThread]: 
[0m19:50:28.157465 [info ] [MainThread]: Done. PASS=58 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=58
[0m19:50:28.158438 [debug] [MainThread]: Command `-c build` succeeded at 19:50:28.158320 after 14.51 seconds
[0m19:50:28.158824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C69D6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C8ECF590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CE124410>]}
[0m19:50:28.159203 [debug] [MainThread]: Flushing usage events
[0m19:50:28.902283 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:43:02.844335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001650EBB8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001650F3C42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001650FA07ED0>]}


============================== 20:43:02.850915 | 97f7560b-086a-4c1e-9c3c-65df03059256 ==============================
[0m20:43:02.850915 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:43:02.851642 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m20:43:03.314832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97f7560b-086a-4c1e-9c3c-65df03059256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001650ED70180>]}
[0m20:43:03.382230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97f7560b-086a-4c1e-9c3c-65df03059256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001650F8AB790>]}
[0m20:43:03.399886 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:43:03.891296 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:43:06.937312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:43:06.938334 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\silver_schema.yml
[0m20:43:06.938743 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\silver\stg\stg__vix_with_versions.sql
[0m20:43:07.546363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97f7560b-086a-4c1e-9c3c-65df03059256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001651129EB50>]}
[0m20:43:07.550767 [info ] [MainThread]: Performance info: C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\perf_info.json
[0m20:43:07.701243 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m20:43:07.720566 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m20:43:07.721376 [debug] [MainThread]: Command `-c parse` succeeded at 20:43:07.721260 after 5.06 seconds
[0m20:43:07.721733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016510CF49B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016510CF4B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001650F8C3E70>]}
[0m20:43:07.722086 [debug] [MainThread]: Flushing usage events
[0m20:43:08.548022 [debug] [MainThread]: An error was encountered while trying to flush usage events
