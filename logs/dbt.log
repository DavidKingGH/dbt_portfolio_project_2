[0m10:49:17.732801 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,2) not null,
    regime text not null,
    regime_period_id int unique not null
    
    )
 ;
    insert into "finance"."analytics_dev"."mrt__stocks_with_regimes" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime ,
    
      
      regime_period_id 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime, regime_period_id
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,2) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m10:49:18.056398 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,2) not null,
    regime text not null,
    regime_period_id int unique not null
    
    )
 ;
    insert into "finance"."analytics_dev"."mrt__stocks_with_regimes" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime ,
    
      
      regime_period_id 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime, regime_period_id
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,2) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m10:49:18.057261 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m10:49:18.060401 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:49:18.060876 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__27c35e0bff91" cascade
    
[0m10:49:18.063249 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__27c35e0bff91" cascade
    
[0m10:49:18.063808 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m10:49:18.064432 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: ROLLBACK
[0m10:49:18.077121 [debug] [Thread-2 (]: Failed to rollback 'model.portfolio_project_2.mrt__stocks_with_regimes'
[0m10:49:18.077569 [debug] [Thread-2 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m10:49:18.087609 [debug] [Thread-2 (]: Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK)
[0m10:49:18.088196 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb1a57e5-d04f-4eb4-b130-7d194d98c5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020591354350>]}
[0m10:49:18.088976 [error] [Thread-2 (]: 65 of 71 ERROR creating sql incremental model analytics_dev.mrt__stocks_with_regimes  [[31mERROR[0m in 0.69s]
[0m10:49:18.089913 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:49:18.090502 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.mrt__stocks_with_regimes' to be skipped because of status 'error'.  Reason: Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK).
[0m10:49:18.091617 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m10:49:18.092163 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m10:49:18.092575 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m10:49:18.092992 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m10:49:18.093444 [info ] [Thread-3 (]: 67 of 71 SKIP test dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0  [[33mSKIP[0m]
[0m10:49:18.096072 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m10:49:18.093950 [info ] [Thread-2 (]: 69 of 71 SKIP test dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0  [[33mSKIP[0m]
[0m10:49:18.096734 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m10:49:18.097232 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b' to be skipped because of status 'skipped'. 
[0m10:49:18.098919 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m10:49:18.094914 [info ] [Thread-1 (]: 66 of 71 SKIP test accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis  [[33mSKIP[0m]
[0m10:49:18.095470 [info ] [Thread-4 (]: 68 of 71 SKIP test dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date  [[33mSKIP[0m]
[0m10:49:18.100912 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_src_stocks_.8614ae4764
[0m10:49:18.101666 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m10:49:18.099931 [info ] [Thread-3 (]: 70 of 71 SKIP test dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker  [[33mSKIP[0m]
[0m10:49:18.102271 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m10:49:18.102744 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe' to be skipped because of status 'skipped'. 
[0m10:49:18.103303 [info ] [Thread-2 (]: 71 of 71 SKIP test relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_src_stocks_  [[33mSKIP[0m]
[0m10:49:18.104207 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m10:49:18.104733 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8' to be skipped because of status 'skipped'. 
[0m10:49:18.105227 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_src_stocks_.8614ae4764
[0m10:49:18.105707 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf' to be skipped because of status 'skipped'. 
[0m10:49:18.106193 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de' to be skipped because of status 'skipped'. 
[0m10:49:18.106552 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_src_stocks_.8614ae4764' to be skipped because of status 'skipped'. 
[0m10:49:18.108440 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:18.108910 [debug] [MainThread]: On master: BEGIN
[0m10:49:18.109204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:49:18.110475 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:49:18.110802 [debug] [MainThread]: On master: COMMIT
[0m10:49:18.111313 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:18.111746 [debug] [MainThread]: On master: COMMIT
[0m10:49:18.112465 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:49:18.112790 [debug] [MainThread]: On master: Close
[0m10:49:18.113213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:18.113488 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m10:49:18.113751 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m10:49:18.114011 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m10:49:18.114275 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m10:49:18.114599 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7' was properly closed.
[0m10:49:18.114860 [debug] [MainThread]: Connection 'test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755' was properly closed.
[0m10:49:18.115119 [debug] [MainThread]: Connection 'test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1' was properly closed.
[0m10:49:18.115527 [info ] [MainThread]: 
[0m10:49:18.116046 [info ] [MainThread]: Finished running 1 incremental model, 1 seed, 63 data tests, 6 view models in 0 hours 0 minutes and 7.69 seconds (7.69s).
[0m10:49:18.126715 [debug] [MainThread]: Command end result
[0m10:49:18.192993 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m10:49:18.195591 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m10:49:18.204500 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m10:49:18.204889 [info ] [MainThread]: 
[0m10:49:18.205420 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:49:18.205922 [info ] [MainThread]: 
[0m10:49:18.206496 [error] [MainThread]: [31mFailure in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)[0m
[0m10:49:18.207057 [error] [MainThread]:   Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK)
[0m10:49:18.207554 [info ] [MainThread]: 
[0m10:49:18.208143 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\mrt__stocks_with_regimes.sql
[0m10:49:18.208672 [info ] [MainThread]: 
[0m10:49:18.209187 [info ] [MainThread]: Done. PASS=64 WARN=0 ERROR=1 SKIP=6 NO-OP=0 TOTAL=71
[0m10:49:18.209955 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:49:18.210972 [debug] [MainThread]: Command `-c build` failed at 10:49:18.210856 after 11.92 seconds
[0m10:49:18.211410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020590D3C530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205913187D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059106FA70>]}
[0m10:49:18.211774 [debug] [MainThread]: Flushing usage events
[0m10:49:19.283095 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:50:09.406501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2288050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2A942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A30D7ED0>]}


============================== 10:50:09.411437 | f099cd69-cad1-47b5-a00d-bcee9e5891bf ==============================
[0m10:50:09.411437 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:50:09.412715 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -select +mrt__stocks_with_regimes --full-refresh', 'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m10:50:09.666684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f099cd69-cad1-47b5-a00d-bcee9e5891bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2440180>]}
[0m10:50:09.734606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f099cd69-cad1-47b5-a00d-bcee9e5891bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2F7B790>]}
[0m10:50:09.737291 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:50:10.002992 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:50:10.244677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:50:10.245045 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:50:10.323349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f099cd69-cad1-47b5-a00d-bcee9e5891bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A41C5E50>]}
[0m10:50:10.529261 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m10:50:10.531776 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m10:50:10.565127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f099cd69-cad1-47b5-a00d-bcee9e5891bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A4450B90>]}
[0m10:50:10.565646 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 1 snapshot, 2 sources, 853 macros
[0m10:50:10.566198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f099cd69-cad1-47b5-a00d-bcee9e5891bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A425FD90>]}
[0m10:50:10.567424 [warn ] [MainThread]: The selection criterion 'elect' does not match any enabled nodes
[0m10:50:10.570210 [info ] [MainThread]: 
[0m10:50:10.570726 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:50:10.571192 [info ] [MainThread]: 
[0m10:50:10.571980 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:50:10.578248 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m10:50:10.655794 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m10:50:10.656184 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m10:50:10.656493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:12.277933 [debug] [ThreadPool]: SQL status: OK in 1.621 seconds
[0m10:50:12.279318 [debug] [ThreadPool]: On list_finance: Close
[0m10:50:12.280008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m10:50:12.280547 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m10:50:12.286619 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:50:12.286947 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m10:50:12.287244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:12.288682 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:50:12.289960 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:50:12.290266 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m10:50:12.291147 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:50:12.291451 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:50:12.291749 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m10:50:12.346727 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m10:50:12.348180 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m10:50:12.348709 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:50:12.349192 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m10:50:12.405460 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m10:50:12.407073 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m10:50:12.409751 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m10:50:12.415153 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m10:50:12.415469 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m10:50:12.415750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:12.416660 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m10:50:12.418592 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m10:50:12.419177 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m10:50:12.419464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:12.420349 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m10:50:12.420991 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m10:50:12.421663 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m10:50:12.422855 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:50:12.423501 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m10:50:12.423840 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m10:50:12.448064 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m10:50:12.448642 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m10:50:12.450153 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m10:50:12.451318 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m10:50:12.452343 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m10:50:12.452644 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m10:50:12.453147 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m10:50:12.453456 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m10:50:12.456085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f099cd69-cad1-47b5-a00d-bcee9e5891bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A4C921A0>]}
[0m10:50:12.456522 [debug] [MainThread]: Using duckdb connection "master"
[0m10:50:12.456811 [debug] [MainThread]: On master: BEGIN
[0m10:50:12.457085 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:12.458312 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:50:12.458699 [debug] [MainThread]: On master: COMMIT
[0m10:50:12.459027 [debug] [MainThread]: Using duckdb connection "master"
[0m10:50:12.459328 [debug] [MainThread]: On master: COMMIT
[0m10:50:12.459997 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:50:12.460384 [debug] [MainThread]: On master: Close
[0m10:50:12.465298 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m10:50:12.466186 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m10:50:12.465828 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m10:50:12.467233 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m10:50:12.467590 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m10:50:12.476375 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m10:50:12.466645 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m10:50:12.477303 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m10:50:12.477782 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m10:50:12.481068 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m10:50:12.481981 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m10:50:12.511410 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m10:50:12.514990 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m10:50:12.519100 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m10:50:12.520174 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:50:12.520581 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m10:50:12.520930 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:50:12.521894 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:50:12.522276 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m10:50:12.522614 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:50:12.523240 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:50:12.523629 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:50:12.524018 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m10:50:12.524607 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:50:12.524989 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:50:12.525371 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m10:50:12.715807 [debug] [Thread-1 (]: SQL status: OK in 0.191 seconds
[0m10:50:12.716272 [debug] [Thread-2 (]: SQL status: OK in 0.190 seconds
[0m10:50:12.722284 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:50:12.725497 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:50:12.725933 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m10:50:12.726364 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m10:50:12.798781 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m10:50:12.802891 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:50:12.803272 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m10:50:12.804634 [debug] [Thread-2 (]: SQL status: OK in 0.078 seconds
[0m10:50:12.807658 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:50:12.808032 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m10:50:12.874071 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m10:50:12.874519 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m10:50:12.885625 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m10:50:12.886876 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m10:50:12.887301 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:50:12.887735 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:50:12.888155 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m10:50:12.888629 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m10:50:13.001007 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m10:50:13.007204 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:50:13.007694 [debug] [Thread-2 (]: SQL status: OK in 0.118 seconds
[0m10:50:13.008121 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m10:50:13.011034 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:50:13.011914 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m10:50:13.131687 [debug] [Thread-2 (]: SQL status: OK in 0.119 seconds
[0m10:50:13.132188 [debug] [Thread-1 (]: SQL status: OK in 0.121 seconds
[0m10:50:13.134877 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m10:50:13.136251 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m10:50:13.138876 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f099cd69-cad1-47b5-a00d-bcee9e5891bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A4D8DD90>]}
[0m10:50:13.139876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f099cd69-cad1-47b5-a00d-bcee9e5891bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A46F6990>]}
[0m10:50:13.139534 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.66s]
[0m10:50:13.141295 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m10:50:13.140673 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.67s]
[0m10:50:13.142259 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m10:50:13.142906 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m10:50:13.143984 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__stocks
[0m10:50:13.143412 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_dev.stg__vix_with_versions ............... [RUN]
[0m10:50:13.145515 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m10:50:13.145900 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m10:50:13.149351 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m10:50:13.144830 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics_dev.stg__stocks .......................... [RUN]
[0m10:50:13.150409 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m10:50:13.150922 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m10:50:13.153761 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m10:50:13.154727 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m10:50:13.159376 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m10:50:13.159917 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m10:50:13.164104 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m10:50:13.165014 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:50:13.165571 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m10:50:13.166033 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:50:13.166955 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:50:13.167475 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m10:50:13.167857 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:50:13.168448 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:50:13.168984 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:50:13.169533 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m10:50:13.170338 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m10:50:13.170795 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:50:13.171215 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m10:50:13.291370 [debug] [Thread-3 (]: SQL status: OK in 0.121 seconds
[0m10:50:13.294504 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:50:13.294942 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m10:50:13.363766 [debug] [Thread-3 (]: SQL status: OK in 0.068 seconds
[0m10:50:13.364240 [debug] [Thread-4 (]: SQL status: OK in 0.193 seconds
[0m10:50:13.367457 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:50:13.370391 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:50:13.370842 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m10:50:13.371292 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m10:50:13.458685 [debug] [Thread-3 (]: SQL status: OK in 0.087 seconds
[0m10:50:13.460836 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m10:50:13.461429 [debug] [Thread-4 (]: SQL status: OK in 0.089 seconds
[0m10:50:13.462033 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:50:13.466190 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:50:13.466804 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m10:50:13.467431 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m10:50:13.533300 [debug] [Thread-4 (]: SQL status: OK in 0.065 seconds
[0m10:50:13.534743 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m10:50:13.535130 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:50:13.535483 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m10:50:13.617194 [debug] [Thread-4 (]: SQL status: OK in 0.081 seconds
[0m10:50:13.620045 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:50:13.620430 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m10:50:13.620838 [debug] [Thread-3 (]: SQL status: OK in 0.153 seconds
[0m10:50:13.623065 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:50:13.623442 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m10:50:13.782952 [debug] [Thread-3 (]: SQL status: OK in 0.159 seconds
[0m10:50:13.783530 [debug] [Thread-4 (]: SQL status: OK in 0.163 seconds
[0m10:50:13.785089 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m10:50:13.786619 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: Close
[0m10:50:13.787330 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f099cd69-cad1-47b5-a00d-bcee9e5891bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A6348E10>]}
[0m10:50:13.788778 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f099cd69-cad1-47b5-a00d-bcee9e5891bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A6344ED0>]}
[0m10:50:13.788144 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_dev.stg__vix_with_versions .......... [[32mOK[0m in 0.64s]
[0m10:50:13.790346 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m10:50:13.789684 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics_dev.stg__stocks ..................... [[32mOK[0m in 0.64s]
[0m10:50:13.791390 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m10:50:13.792136 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m10:50:13.792683 [info ] [Thread-2 (]: 5 of 7 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m10:50:13.793420 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_classification)
[0m10:50:13.793914 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m10:50:13.802485 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m10:50:13.803825 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m10:50:13.807824 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m10:50:13.809083 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:50:13.809597 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m10:50:13.810007 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:50:13.811498 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:50:13.811999 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:50:13.812613 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m10:50:13.921160 [debug] [Thread-2 (]: SQL status: OK in 0.108 seconds
[0m10:50:13.926540 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:50:13.927437 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m10:50:14.022303 [debug] [Thread-2 (]: SQL status: OK in 0.094 seconds
[0m10:50:14.028488 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:50:14.029248 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m10:50:14.084823 [debug] [Thread-2 (]: SQL status: OK in 0.055 seconds
[0m10:50:14.086169 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m10:50:14.086542 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:50:14.086888 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m10:50:14.199122 [debug] [Thread-2 (]: SQL status: OK in 0.112 seconds
[0m10:50:14.202058 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:50:14.202478 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m10:50:14.321718 [debug] [Thread-2 (]: SQL status: OK in 0.119 seconds
[0m10:50:14.323248 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m10:50:14.323815 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f099cd69-cad1-47b5-a00d-bcee9e5891bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A6306E40>]}
[0m10:50:14.324414 [info ] [Thread-2 (]: 5 of 7 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.53s]
[0m10:50:14.325230 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m10:50:14.326042 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m10:50:14.326807 [info ] [Thread-1 (]: 6 of 7 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m10:50:14.327466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__regime_changes)
[0m10:50:14.327903 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m10:50:14.331411 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m10:50:14.332467 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m10:50:14.335868 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m10:50:14.336791 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:50:14.337151 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m10:50:14.337481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:14.338770 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:50:14.339128 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:50:14.339518 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m10:50:14.451884 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m10:50:14.455014 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:50:14.455458 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m10:50:14.525552 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m10:50:14.529106 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:50:14.529558 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m10:50:14.589002 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m10:50:14.590403 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m10:50:14.590803 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:50:14.591156 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m10:50:14.716908 [debug] [Thread-1 (]: SQL status: OK in 0.125 seconds
[0m10:50:14.719638 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:50:14.720044 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m10:50:14.836379 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m10:50:14.837820 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m10:50:14.838364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f099cd69-cad1-47b5-a00d-bcee9e5891bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A4E1BEF0>]}
[0m10:50:14.838949 [info ] [Thread-1 (]: 6 of 7 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.51s]
[0m10:50:14.839757 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m10:50:14.840518 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:50:14.841023 [info ] [Thread-3 (]: 7 of 7 START sql incremental model analytics_dev.mrt__stocks_with_regimes ...... [RUN]
[0m10:50:14.841713 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m10:50:14.842154 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:50:14.850422 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:50:14.851542 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:50:14.856370 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:50:14.856894 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__dafabf517308" cascade
    
[0m10:50:14.857347 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:50:14.913032 [debug] [Thread-3 (]: SQL status: OK in 0.056 seconds
[0m10:50:14.948140 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:50:14.948839 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m10:50:14.950340 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:50:14.951725 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:50:14.952102 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m10:50:14.953175 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:50:14.953589 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:50:14.953963 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m10:50:15.010022 [debug] [Thread-3 (]: SQL status: OK in 0.055 seconds
[0m10:50:15.012339 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:50:15.013054 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m10:50:15.013815 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m10:50:15.015625 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m10:50:15.016249 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:50:15.016709 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m10:50:15.080746 [debug] [Thread-3 (]: SQL status: OK in 0.064 seconds
[0m10:50:15.101461 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:50:15.101943 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,2) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:50:15.106195 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m10:50:15.121568 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:50:15.122025 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,2))
 as volume, 
      
    cast(null as text)
 as regime, 
      
    cast(null as int)
 as regime_period_id
    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:50:15.123577 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:50:15.148030 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:50:15.149004 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:50:15.149408 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m10:50:15.150700 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:50:15.151082 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:50:15.151512 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,2) not null,
    regime text not null,
    regime_period_id int unique not null
    
    )
 ;
    insert into "finance"."analytics_dev"."mrt__stocks_with_regimes" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime ,
    
      
      regime_period_id 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime, regime_period_id
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,2) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m10:50:15.521761 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,2) not null,
    regime text not null,
    regime_period_id int unique not null
    
    )
 ;
    insert into "finance"."analytics_dev"."mrt__stocks_with_regimes" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime ,
    
      
      regime_period_id 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime, regime_period_id
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,2) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m10:50:15.523952 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m10:50:15.533727 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:50:15.535391 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__dafabf517308" cascade
    
[0m10:50:15.540893 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__dafabf517308" cascade
    
[0m10:50:15.542100 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m10:50:15.543254 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: ROLLBACK
[0m10:50:15.562602 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.mrt__stocks_with_regimes'
[0m10:50:15.563131 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m10:50:15.573069 [debug] [Thread-3 (]: Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK)
[0m10:50:15.573528 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f099cd69-cad1-47b5-a00d-bcee9e5891bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A63D8E90>]}
[0m10:50:15.574102 [error] [Thread-3 (]: 7 of 7 ERROR creating sql incremental model analytics_dev.mrt__stocks_with_regimes  [[31mERROR[0m in 0.73s]
[0m10:50:15.574905 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:50:15.575493 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.mrt__stocks_with_regimes' to be skipped because of status 'error'.  Reason: Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK).
[0m10:50:15.577652 [debug] [MainThread]: Using duckdb connection "master"
[0m10:50:15.578002 [debug] [MainThread]: On master: BEGIN
[0m10:50:15.578298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:50:15.579693 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:50:15.580064 [debug] [MainThread]: On master: COMMIT
[0m10:50:15.580448 [debug] [MainThread]: Using duckdb connection "master"
[0m10:50:15.580731 [debug] [MainThread]: On master: COMMIT
[0m10:50:15.581430 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:50:15.581739 [debug] [MainThread]: On master: Close
[0m10:50:15.582125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:50:15.582395 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m10:50:15.582651 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m10:50:15.582905 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m10:50:15.583165 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m10:50:15.583419 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m10:50:15.583671 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m10:50:15.583921 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__stocks' was properly closed.
[0m10:50:15.584275 [info ] [MainThread]: 
[0m10:50:15.584782 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m10:50:15.586907 [debug] [MainThread]: Command end result
[0m10:50:15.654012 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m10:50:15.656600 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m10:50:15.662851 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m10:50:15.663203 [info ] [MainThread]: 
[0m10:50:15.663730 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:50:15.664243 [info ] [MainThread]: 
[0m10:50:15.664855 [error] [MainThread]: [31mFailure in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)[0m
[0m10:50:15.665460 [error] [MainThread]:   Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK)
[0m10:50:15.665951 [info ] [MainThread]: 
[0m10:50:15.666529 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\mrt__stocks_with_regimes.sql
[0m10:50:15.667042 [info ] [MainThread]: 
[0m10:50:15.667575 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m10:50:15.668586 [debug] [MainThread]: Command `-c run` failed at 10:50:15.668441 after 6.40 seconds
[0m10:50:15.669012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2F61EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A4E18E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A4E194F0>]}
[0m10:50:15.669388 [debug] [MainThread]: Flushing usage events
[0m10:50:16.378298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:05.713049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D2818050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D30242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D3663ED0>]}


============================== 10:51:05.718770 | 0d913a03-e597-4d9b-b9e8-4867b5b5cd94 ==============================
[0m10:51:05.718770 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:51:05.719588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'invocation_command': 'dbt run --select +mrt__stocks_with_regimes --full-refresh', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m10:51:06.061859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d913a03-e597-4d9b-b9e8-4867b5b5cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D29D0180>]}
[0m10:51:06.135464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d913a03-e597-4d9b-b9e8-4867b5b5cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D350B790>]}
[0m10:51:06.138107 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:51:06.418388 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:51:06.655686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:51:06.656059 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:51:06.739956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d913a03-e597-4d9b-b9e8-4867b5b5cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D3785E50>]}
[0m10:51:06.957515 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m10:51:06.960742 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m10:51:07.001398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d913a03-e597-4d9b-b9e8-4867b5b5cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D4970B90>]}
[0m10:51:07.001865 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 1 snapshot, 2 sources, 853 macros
[0m10:51:07.002379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d913a03-e597-4d9b-b9e8-4867b5b5cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D381FD90>]}
[0m10:51:07.005120 [info ] [MainThread]: 
[0m10:51:07.005779 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:51:07.006355 [info ] [MainThread]: 
[0m10:51:07.007197 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:51:07.012343 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m10:51:07.090817 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m10:51:07.091211 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m10:51:07.091522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:08.497304 [debug] [ThreadPool]: SQL status: OK in 1.406 seconds
[0m10:51:08.498947 [debug] [ThreadPool]: On list_finance: Close
[0m10:51:08.499774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m10:51:08.500322 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m10:51:08.506778 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:51:08.507181 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m10:51:08.507507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:08.509071 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:51:08.510452 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:51:08.510786 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m10:51:08.511814 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:51:08.512159 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:51:08.512479 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m10:51:08.567066 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m10:51:08.568017 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m10:51:08.568344 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:51:08.568639 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m10:51:08.625922 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m10:51:08.626358 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m10:51:08.628868 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m10:51:08.634766 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m10:51:08.635267 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m10:51:08.635620 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m10:51:08.637904 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m10:51:08.638310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:08.638703 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m10:51:08.639332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:08.639991 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:51:08.640415 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m10:51:08.640784 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m10:51:08.641285 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:51:08.641660 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m10:51:08.641980 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m10:51:08.673928 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m10:51:08.675376 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m10:51:08.675893 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m10:51:08.677719 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m10:51:08.678847 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m10:51:08.679305 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m10:51:08.680339 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m10:51:08.681057 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m10:51:08.684267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d913a03-e597-4d9b-b9e8-4867b5b5cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D51B1F30>]}
[0m10:51:08.684804 [debug] [MainThread]: Using duckdb connection "master"
[0m10:51:08.685123 [debug] [MainThread]: On master: BEGIN
[0m10:51:08.685420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:08.686618 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:51:08.686947 [debug] [MainThread]: On master: COMMIT
[0m10:51:08.687261 [debug] [MainThread]: Using duckdb connection "master"
[0m10:51:08.687620 [debug] [MainThread]: On master: COMMIT
[0m10:51:08.688192 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:51:08.688502 [debug] [MainThread]: On master: Close
[0m10:51:08.693611 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m10:51:08.694072 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m10:51:08.694744 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m10:51:08.696339 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m10:51:08.696840 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m10:51:08.706867 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m10:51:08.695460 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m10:51:08.707805 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m10:51:08.708239 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m10:51:08.711356 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m10:51:08.712126 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m10:51:08.745905 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m10:51:08.746674 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m10:51:08.751122 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m10:51:08.751915 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:51:08.752360 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m10:51:08.752735 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:51:08.753776 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:51:08.754194 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m10:51:08.754539 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:51:08.755191 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:51:08.755560 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:51:08.755925 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m10:51:08.756611 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:51:08.757001 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:51:08.757383 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m10:51:08.860326 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m10:51:08.866595 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:51:08.867036 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m10:51:08.868194 [debug] [Thread-2 (]: SQL status: OK in 0.110 seconds
[0m10:51:08.871786 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:51:08.872279 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m10:51:08.934398 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m10:51:08.941507 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:51:08.942512 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m10:51:08.950808 [debug] [Thread-2 (]: SQL status: OK in 0.078 seconds
[0m10:51:08.954244 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:51:08.954648 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m10:51:09.010577 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m10:51:09.023821 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m10:51:09.024272 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:51:09.024623 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m10:51:09.033368 [debug] [Thread-2 (]: SQL status: OK in 0.078 seconds
[0m10:51:09.035046 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m10:51:09.035535 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:51:09.035939 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m10:51:09.161078 [debug] [Thread-1 (]: SQL status: OK in 0.136 seconds
[0m10:51:09.167208 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:51:09.167703 [debug] [Thread-2 (]: SQL status: OK in 0.131 seconds
[0m10:51:09.168105 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m10:51:09.170853 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:51:09.171567 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m10:51:09.342775 [debug] [Thread-1 (]: SQL status: OK in 0.171 seconds
[0m10:51:09.345555 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m10:51:09.348044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d913a03-e597-4d9b-b9e8-4867b5b5cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D52AE090>]}
[0m10:51:09.348772 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.65s]
[0m10:51:09.349627 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m10:51:09.350485 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__stocks
[0m10:51:09.351134 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_dev.stg__stocks .......................... [RUN]
[0m10:51:09.352009 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m10:51:09.352440 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m10:51:09.356356 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m10:51:09.357624 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m10:51:09.361253 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m10:51:09.362254 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:51:09.362672 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m10:51:09.363026 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:51:09.364292 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:51:09.364709 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:51:09.365104 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m10:51:09.465529 [debug] [Thread-2 (]: SQL status: OK in 0.293 seconds
[0m10:51:09.467024 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m10:51:09.467614 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d913a03-e597-4d9b-b9e8-4867b5b5cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D4C16990>]}
[0m10:51:09.468286 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.76s]
[0m10:51:09.469456 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m10:51:09.470457 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m10:51:09.471156 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics_dev.stg__vix_with_versions ............... [RUN]
[0m10:51:09.472318 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m10:51:09.474015 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m10:51:09.481233 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m10:51:09.482215 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m10:51:09.485767 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m10:51:09.487137 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:51:09.488163 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m10:51:09.489084 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:51:09.492342 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m10:51:09.493487 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:51:09.494729 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m10:51:09.498575 [debug] [Thread-3 (]: SQL status: OK in 0.133 seconds
[0m10:51:09.501853 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:51:09.502292 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m10:51:09.588189 [debug] [Thread-3 (]: SQL status: OK in 0.085 seconds
[0m10:51:09.593394 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:51:09.593868 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m10:51:09.602104 [debug] [Thread-4 (]: SQL status: OK in 0.106 seconds
[0m10:51:09.605491 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:51:09.605946 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m10:51:09.663058 [debug] [Thread-3 (]: SQL status: OK in 0.069 seconds
[0m10:51:09.664731 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m10:51:09.665208 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:51:09.665568 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m10:51:09.676961 [debug] [Thread-4 (]: SQL status: OK in 0.070 seconds
[0m10:51:09.681110 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:51:09.681677 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m10:51:09.741739 [debug] [Thread-4 (]: SQL status: OK in 0.060 seconds
[0m10:51:09.744249 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m10:51:09.744918 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:51:09.745617 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m10:51:09.774180 [debug] [Thread-3 (]: SQL status: OK in 0.108 seconds
[0m10:51:09.779751 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:51:09.780563 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m10:51:09.856700 [debug] [Thread-4 (]: SQL status: OK in 0.110 seconds
[0m10:51:09.860811 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:51:09.861400 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m10:51:09.954454 [debug] [Thread-3 (]: SQL status: OK in 0.173 seconds
[0m10:51:09.959802 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: Close
[0m10:51:09.960371 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d913a03-e597-4d9b-b9e8-4867b5b5cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D68B7750>]}
[0m10:51:09.960965 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_dev.stg__stocks ..................... [[32mOK[0m in 0.61s]
[0m10:51:09.961763 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m10:51:10.048206 [debug] [Thread-4 (]: SQL status: OK in 0.186 seconds
[0m10:51:10.051547 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m10:51:10.052844 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d913a03-e597-4d9b-b9e8-4867b5b5cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D687A550>]}
[0m10:51:10.054082 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics_dev.stg__vix_with_versions .......... [[32mOK[0m in 0.58s]
[0m10:51:10.055815 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m10:51:10.057522 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m10:51:10.058613 [info ] [Thread-1 (]: 5 of 7 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m10:51:10.059923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__regime_classification)
[0m10:51:10.061257 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m10:51:10.069708 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m10:51:10.072663 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m10:51:10.081466 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m10:51:10.083411 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:51:10.084374 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m10:51:10.085312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:10.087408 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:51:10.088302 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:51:10.089039 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m10:51:10.276464 [debug] [Thread-1 (]: SQL status: OK in 0.187 seconds
[0m10:51:10.279431 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:51:10.279832 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m10:51:10.339124 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m10:51:10.342352 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:51:10.342774 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m10:51:10.414036 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m10:51:10.415404 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m10:51:10.415794 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:51:10.416140 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m10:51:10.526788 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m10:51:10.529764 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:51:10.530337 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m10:51:10.660219 [debug] [Thread-1 (]: SQL status: OK in 0.129 seconds
[0m10:51:10.661747 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m10:51:10.662305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d913a03-e597-4d9b-b9e8-4867b5b5cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D68A3150>]}
[0m10:51:10.662918 [info ] [Thread-1 (]: 5 of 7 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.60s]
[0m10:51:10.663754 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m10:51:10.664537 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m10:51:10.665053 [info ] [Thread-2 (]: 6 of 7 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m10:51:10.665707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_changes)
[0m10:51:10.666097 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m10:51:10.669250 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m10:51:10.670134 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m10:51:10.673471 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m10:51:10.674471 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:51:10.674891 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m10:51:10.675253 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:51:10.676495 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:51:10.676939 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:51:10.677363 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m10:51:10.782235 [debug] [Thread-2 (]: SQL status: OK in 0.104 seconds
[0m10:51:10.785404 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:51:10.785828 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m10:51:10.862635 [debug] [Thread-2 (]: SQL status: OK in 0.076 seconds
[0m10:51:10.866088 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:51:10.866522 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m10:51:10.924835 [debug] [Thread-2 (]: SQL status: OK in 0.058 seconds
[0m10:51:10.926160 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m10:51:10.926545 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:51:10.926888 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m10:51:11.141772 [debug] [Thread-2 (]: SQL status: OK in 0.214 seconds
[0m10:51:11.144522 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:51:11.144959 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m10:51:11.269287 [debug] [Thread-2 (]: SQL status: OK in 0.124 seconds
[0m10:51:11.271312 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m10:51:11.272035 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d913a03-e597-4d9b-b9e8-4867b5b5cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D4C06ED0>]}
[0m10:51:11.272891 [info ] [Thread-2 (]: 6 of 7 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.61s]
[0m10:51:11.274010 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m10:51:11.274805 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:51:11.275335 [info ] [Thread-3 (]: 7 of 7 START sql incremental model analytics_dev.mrt__stocks_with_regimes ...... [RUN]
[0m10:51:11.276329 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m10:51:11.276745 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:51:11.288003 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:51:11.289280 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:51:11.295235 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:51:11.295849 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__a0500a153d75" cascade
    
[0m10:51:11.296313 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:51:11.352589 [debug] [Thread-3 (]: SQL status: OK in 0.056 seconds
[0m10:51:11.388227 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:51:11.388697 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m10:51:11.390383 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:51:11.391890 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:51:11.392393 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m10:51:11.393676 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:51:11.394105 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:51:11.394466 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m10:51:11.455177 [debug] [Thread-3 (]: SQL status: OK in 0.060 seconds
[0m10:51:11.456366 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:51:11.456750 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m10:51:11.457194 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m10:51:11.458291 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m10:51:11.458664 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:51:11.459172 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m10:51:11.520249 [debug] [Thread-3 (]: SQL status: OK in 0.061 seconds
[0m10:51:11.541533 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:51:11.542613 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,2) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:51:11.547951 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m10:51:11.564987 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:51:11.565451 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,2))
 as volume, 
      
    cast(null as text)
 as regime, 
      
    cast(null as int)
 as regime_period_id
    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:51:11.566992 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:51:11.594232 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:51:11.595806 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:51:11.596312 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m10:51:11.597535 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:51:11.597936 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:51:11.598352 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,2) not null,
    regime text not null,
    regime_period_id int unique not null
    
    )
 ;
    insert into "finance"."analytics_dev"."mrt__stocks_with_regimes" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime ,
    
      
      regime_period_id 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime, regime_period_id
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,2) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m10:51:11.875830 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,2) not null,
    regime text not null,
    regime_period_id int unique not null
    
    )
 ;
    insert into "finance"."analytics_dev"."mrt__stocks_with_regimes" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime ,
    
      
      regime_period_id 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime, regime_period_id
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,2) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m10:51:11.876369 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m10:51:11.879044 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:51:11.879419 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__a0500a153d75" cascade
    
[0m10:51:11.881047 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__a0500a153d75" cascade
    
[0m10:51:11.881416 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m10:51:11.881832 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: ROLLBACK
[0m10:51:11.892850 [debug] [Thread-3 (]: Failed to rollback 'model.portfolio_project_2.mrt__stocks_with_regimes'
[0m10:51:11.893301 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m10:51:11.904210 [debug] [Thread-3 (]: Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK)
[0m10:51:11.904826 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d913a03-e597-4d9b-b9e8-4867b5b5cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D687DE50>]}
[0m10:51:11.905416 [error] [Thread-3 (]: 7 of 7 ERROR creating sql incremental model analytics_dev.mrt__stocks_with_regimes  [[31mERROR[0m in 0.63s]
[0m10:51:11.906229 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:51:11.906829 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.mrt__stocks_with_regimes' to be skipped because of status 'error'.  Reason: Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK).
[0m10:51:11.909026 [debug] [MainThread]: Using duckdb connection "master"
[0m10:51:11.909362 [debug] [MainThread]: On master: BEGIN
[0m10:51:11.909661 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:11.910834 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:51:11.911138 [debug] [MainThread]: On master: COMMIT
[0m10:51:11.911467 [debug] [MainThread]: Using duckdb connection "master"
[0m10:51:11.911748 [debug] [MainThread]: On master: COMMIT
[0m10:51:11.912292 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:51:11.912593 [debug] [MainThread]: On master: Close
[0m10:51:11.912962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:11.913235 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m10:51:11.913492 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m10:51:11.913746 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m10:51:11.914001 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m10:51:11.914256 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m10:51:11.914508 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m10:51:11.914760 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__vix_with_versions' was properly closed.
[0m10:51:11.915106 [info ] [MainThread]: 
[0m10:51:11.915588 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m10:51:11.917975 [debug] [MainThread]: Command end result
[0m10:51:11.991389 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m10:51:12.000783 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m10:51:12.011139 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m10:51:12.011516 [info ] [MainThread]: 
[0m10:51:12.012070 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:51:12.012584 [info ] [MainThread]: 
[0m10:51:12.013188 [error] [MainThread]: [31mFailure in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)[0m
[0m10:51:12.013764 [error] [MainThread]:   Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK)
[0m10:51:12.014237 [info ] [MainThread]: 
[0m10:51:12.014778 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\mrt__stocks_with_regimes.sql
[0m10:51:12.015252 [info ] [MainThread]: 
[0m10:51:12.015719 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m10:51:12.016780 [debug] [MainThread]: Command `-c run` failed at 10:51:12.016666 after 6.47 seconds
[0m10:51:12.017178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D0E4EC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D4975790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263D368FDD0>]}
[0m10:51:12.017543 [debug] [MainThread]: Flushing usage events
[0m10:51:12.801984 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:50.804128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002152CAA4E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002152BE7F9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002152A45AF30>]}


============================== 10:52:50.808690 | cd37fe9f-08e7-4f6a-85ae-11beaf1fd50a ==============================
[0m10:52:50.808690 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:52:50.809808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'log_path': 'c:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:52:51.133713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd37fe9f-08e7-4f6a-85ae-11beaf1fd50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002152CF45D90>]}
[0m10:52:51.327260 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.2', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.2'}} is not valid under any of the given schemas
  
[0m10:52:51.328266 [debug] [MainThread]: Command `cli deps` failed at 10:52:51.328266 after 0.67 seconds
[0m10:52:51.329993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002152CB430E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002152AABD8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002152CAA7650>]}
[0m10:52:51.329993 [debug] [MainThread]: Flushing usage events
[0m10:52:51.823145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F9519C8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F9521D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F952817ED0>]}


============================== 10:52:51.828033 | 24458f2c-dea2-4985-8cf6-2f13dbe564c7 ==============================
[0m10:52:51.828033 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:52:51.829058 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt build --full-refresh', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m10:52:52.131940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24458f2c-dea2-4985-8cf6-2f13dbe564c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F951B80180>]}
[0m10:52:52.229837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24458f2c-dea2-4985-8cf6-2f13dbe564c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F9526BB790>]}
[0m10:52:52.233562 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:52:52.510769 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m10:52:52.512163 [debug] [MainThread]: Command `-c build` failed at 10:52:52.511967 after 0.83 seconds
[0m10:52:52.512665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F9539B1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F9539B1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F953B90F50>]}
[0m10:52:52.513052 [debug] [MainThread]: Flushing usage events
[0m10:52:53.223835 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:53:02.031393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F95898050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F960A42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F966E7ED0>]}


============================== 10:53:02.035721 | d78eb7b7-5a3a-4671-a292-a140b4453638 ==============================
[0m10:53:02.035721 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:53:02.036378 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'printer_width': '80', 'write_json': 'True'}
[0m10:53:02.182046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd78eb7b7-5a3a-4671-a292-a140b4453638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F95A50180>]}
[0m10:53:02.248522 [debug] [MainThread]: Command `-c clean` succeeded at 10:53:02.248229 after 0.35 seconds
[0m10:53:02.249426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9658A9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9658A030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F96583C50>]}
[0m10:53:02.250261 [debug] [MainThread]: Flushing usage events
[0m10:53:03.020696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:53:08.010761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AC8A8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AD0B42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AD6F7ED0>]}


============================== 10:53:08.018044 | a3f5ce67-886b-4695-bb07-d72fdef5186e ==============================
[0m10:53:08.018044 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:53:08.018967 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m10:53:08.178260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3f5ce67-886b-4695-bb07-d72fdef5186e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247ACA60180>]}
[0m10:53:08.212190 [debug] [MainThread]: Set downloads directory='C:\Users\David\AppData\Local\Temp\dbt-downloads-gn2latrp'
[0m10:53:08.212678 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:53:08.890407 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:53:08.894100 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:53:09.903394 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:53:09.909019 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m10:53:10.932307 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m10:53:10.937232 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m10:53:11.551315 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m10:53:11.556154 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:53:12.620365 [info ] [MainThread]: Installed from version 1.3.2
[0m10:53:12.620892 [info ] [MainThread]: Up to date!
[0m10:53:12.621404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a3f5ce67-886b-4695-bb07-d72fdef5186e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AD59AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AD59A580>]}
[0m10:53:12.621805 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m10:53:41.206760 [info ] [MainThread]: Installed from version 0.10.9
[0m10:53:41.207316 [info ] [MainThread]: Up to date!
[0m10:53:41.207898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a3f5ce67-886b-4695-bb07-d72fdef5186e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AE98D050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AD58B6B0>]}
[0m10:53:41.208296 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m10:53:43.458747 [info ] [MainThread]: Installed from version 0.16.1
[0m10:53:43.459266 [info ] [MainThread]: Up to date!
[0m10:53:43.459788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a3f5ce67-886b-4695-bb07-d72fdef5186e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AE965A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AE965470>]}
[0m10:53:43.462636 [debug] [MainThread]: Command `-c deps` succeeded at 10:53:43.462437 after 35.60 seconds
[0m10:53:43.463050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AD4EB1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AE90E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AE981E90>]}
[0m10:53:43.463470 [debug] [MainThread]: Flushing usage events
[0m10:53:44.112580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:54:00.469676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B37EBC8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B37F3D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B37FA17ED0>]}


============================== 10:54:00.474216 | efad334e-9ef2-4ac6-bf70-7f4be64c3f99 ==============================
[0m10:54:00.474216 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:54:00.474941 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt build --full-refresh', 'printer_width': '80', 'write_json': 'True'}
[0m10:54:00.744272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efad334e-9ef2-4ac6-bf70-7f4be64c3f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B37ED80180>]}
[0m10:54:00.813233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efad334e-9ef2-4ac6-bf70-7f4be64c3f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B37F8BB790>]}
[0m10:54:00.816049 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:54:01.134811 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:54:01.136213 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:54:01.136759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'efad334e-9ef2-4ac6-bf70-7f4be64c3f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B37FB45250>]}
[0m10:54:03.500891 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m10:54:03.506456 [error] [MainThread]: Encountered an error:
Invalid value for on_schema_change: sync_all_columns. Models materialized as incremental with contracts enabled must set on_schema_change to 'append_new_columns' or 'fail'
[0m10:54:03.571874 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\cli\requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\cli\requires.py", line 373, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\cli\requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\cli\requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\cli\requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ~~~~~~~~~~~~~~^
        runtime_config,
        ^^^^^^^^^^^^^^^
    ...<3 lines>...
        active_integrations,
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\parser\manifest.py", line 2123, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
        runtime_config,
        write_perf_info=write_perf_info,
    )
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\parser\manifest.py", line 320, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\parser\manifest.py", line 442, in load
    self.parse_project(
    ~~~~~~~~~~~~~~~~~~^
        project, project_parser_files[project.project_name], parser_types
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\parser\manifest.py", line 744, in parse_project
    parser.parse_file(block, dct=dct)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\parser\schemas.py", line 228, in parse_file
    model_parse_result = ModelPatchParser(self, yaml_block, "models").parse()
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\parser\schemas.py", line 627, in parse
    self.parse_patch(node_block, refs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\parser\schemas.py", line 941, in parse_patch
    super().parse_patch(block, refs)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\parser\schemas.py", line 882, in parse_patch
    self.patch_node_config(node, patch)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\parser\schemas.py", line 750, in patch_node_config
    self.schema_parser.update_parsed_node_config(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        node,
        ^^^^^
    ...<2 lines>...
        patch_file_id=patch.file_id,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\parser\base.py", line 339, in update_parsed_node_config
    config_dict = config.build_config_dict(patch_config_dict=patch_config_dict)
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\context\context_config.py", line 340, in build_config_dict
    return src.calculate_node_config_dict(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        config_call_dict=config_call_dict,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        patch_config_dict=patch_config_dict,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\context\context_config.py", line 238, in calculate_node_config_dict
    config = self.calculate_node_config(
        config_call_dict=config_call_dict,
    ...<4 lines>...
        patch_config_dict=patch_config_dict,
    )
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\context\context_config.py", line 171, in calculate_node_config
    result = self._update_from_config(result, config_call_dict)
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\context\context_config.py", line 216, in _update_from_config
    updated = result.update_from(translated, adapter_config_cls, validate=validate)
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt_common\contracts\config\base.py", line 175, in update_from
    return self.from_dict(dct)
           ~~~~~~~~~~~~~~^^^^^
  File "<string>", line 151, in __mashumaro_from_dict__
  File "<string>", line 33, in __init__
  File "C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\dbt_venv\Lib\site-packages\dbt\artifacts\resources\v1\config.py", line 146, in __post_init__
    raise ValidationError(
    ...<3 lines>...
    )
dbt_common.dataclass_schema.ValidationError: Invalid value for on_schema_change: sync_all_columns. Models materialized as incremental with contracts enabled must set on_schema_change to 'append_new_columns' or 'fail'

[0m10:54:03.574181 [debug] [MainThread]: Command `-c build` failed at 10:54:03.574054 after 3.23 seconds
[0m10:54:03.574556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3016258B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3016259A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B37F8D3E70>]}
[0m10:54:03.574916 [debug] [MainThread]: Flushing usage events
[0m10:54:04.294515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:54:36.767739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157237D8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015723FE42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015724627ED0>]}


============================== 10:54:36.772313 | eb070591-76e5-43ef-8801-2d9b6e84cfe0 ==============================
[0m10:54:36.772313 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:54:36.773006 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt build --full-refresh', 'printer_width': '80', 'target_path': 'None', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m10:54:37.025298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015723990180>]}
[0m10:54:37.093598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157244CB790>]}
[0m10:54:37.096171 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:54:37.352743 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:54:37.354110 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:54:37.354654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015725755250>]}
[0m10:54:39.852994 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m10:54:39.859450 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m10:54:39.860080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157263C4C80>]}
[0m10:54:40.376168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572644D010>]}
[0m10:54:40.537356 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m10:54:40.540501 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m10:54:40.594342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157265F2D00>]}
[0m10:54:40.594818 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 1 snapshot, 2 sources, 853 macros
[0m10:54:40.605467 [info ] [MainThread]: 
[0m10:54:40.606060 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:54:40.606613 [info ] [MainThread]: 
[0m10:54:40.607513 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:54:40.614156 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m10:54:40.626978 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m10:54:40.695667 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m10:54:40.696089 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m10:54:40.696417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:40.697246 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m10:54:40.697597 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m10:54:40.697967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:42.016463 [debug] [ThreadPool]: SQL status: OK in 1.318 seconds
[0m10:54:42.016891 [debug] [ThreadPool]: SQL status: OK in 1.320 seconds
[0m10:54:42.018301 [debug] [ThreadPool]: On list_finance: Close
[0m10:54:42.019461 [debug] [ThreadPool]: On list_finance: Close
[0m10:54:42.020346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev_snapshots)
[0m10:54:42.020848 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev_snapshots"
"
[0m10:54:42.027097 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m10:54:42.027443 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev_snapshots"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m10:54:42.027761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:54:42.028367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m10:54:42.028835 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m10:54:42.031232 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:54:42.031577 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m10:54:42.031877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:54:42.032444 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:54:42.033766 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m10:54:42.034082 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: BEGIN
[0m10:54:42.034537 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:54:42.035774 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:54:42.036097 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m10:54:42.036525 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:54:42.036858 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m10:54:42.037177 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev_snapshots"} */

    
    
        create schema if not exists "finance"."analytics_dev_snapshots"
    
[0m10:54:42.037724 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:54:42.038057 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:54:42.038372 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m10:54:42.089374 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m10:54:42.090497 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: COMMIT
[0m10:54:42.090874 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m10:54:42.091226 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: COMMIT
[0m10:54:42.098075 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m10:54:42.099187 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m10:54:42.099607 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:54:42.099950 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m10:54:42.128957 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m10:54:42.129525 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: Close
[0m10:54:42.200878 [debug] [ThreadPool]: SQL status: OK in 0.101 seconds
[0m10:54:42.201373 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m10:54:42.204205 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m10:54:42.210082 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m10:54:42.210837 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m10:54:42.211195 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m10:54:42.213607 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m10:54:42.213981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:42.214353 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m10:54:42.214994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:42.215904 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:54:42.216207 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m10:54:42.216506 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m10:54:42.216965 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:54:42.217293 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m10:54:42.217618 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m10:54:42.241831 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m10:54:42.242243 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m10:54:42.243566 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m10:54:42.244724 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m10:54:42.246151 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m10:54:42.246471 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m10:54:42.246963 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m10:54:42.247280 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m10:54:42.248448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572643FDD0>]}
[0m10:54:42.248977 [debug] [MainThread]: Using duckdb connection "master"
[0m10:54:42.249298 [debug] [MainThread]: On master: BEGIN
[0m10:54:42.249600 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:54:42.250867 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:54:42.251202 [debug] [MainThread]: On master: COMMIT
[0m10:54:42.251524 [debug] [MainThread]: Using duckdb connection "master"
[0m10:54:42.251829 [debug] [MainThread]: On master: COMMIT
[0m10:54:42.252417 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:54:42.252749 [debug] [MainThread]: On master: Close
[0m10:54:42.257505 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m10:54:42.258424 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m10:54:42.258851 [debug] [Thread-3 (]: Began running node seed.portfolio_project_2.regime_thresholds
[0m10:54:42.258047 [info ] [Thread-1 (]: 1 of 124 START sql view model analytics_dev.src_stocks ......................... [RUN]
[0m10:54:42.260719 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m10:54:42.261094 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m10:54:42.268512 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m10:54:42.259382 [info ] [Thread-2 (]: 2 of 124 START sql view model analytics_dev.src_vix ............................ [RUN]
[0m10:54:42.269260 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m10:54:42.269637 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m10:54:42.272083 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m10:54:42.260002 [info ] [Thread-3 (]: 3 of 124 START seed file analytics_dev.regime_thresholds ....................... [RUN]
[0m10:54:42.273024 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.portfolio_project_2.regime_thresholds'
[0m10:54:42.273435 [debug] [Thread-3 (]: Began compiling node seed.portfolio_project_2.regime_thresholds
[0m10:54:42.273817 [debug] [Thread-3 (]: Began executing node seed.portfolio_project_2.regime_thresholds
[0m10:54:42.316354 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m10:54:42.316872 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: BEGIN
[0m10:54:42.317331 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:54:42.319247 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m10:54:42.320175 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m10:54:42.339678 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m10:54:42.350397 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m10:54:42.353472 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m10:54:42.354033 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m10:54:42.354990 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "seed.portfolio_project_2.regime_thresholds"} */

    create table "finance"."analytics_dev"."regime_thresholds" ("version_id" integer,"version_name" text,"complacent_max" integer,"normal_max" integer,"elevated_max" integer,"effective_date" date,"notes" text)
  
[0m10:54:42.358690 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:54:42.359514 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:54:42.360252 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m10:54:42.360802 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m10:54:42.361276 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:54:42.361716 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:54:42.362873 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:54:42.363291 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:54:42.363678 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m10:54:42.364368 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:54:42.364760 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:54:42.365143 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m10:54:42.424768 [debug] [Thread-3 (]: SQL status: OK in 0.069 seconds
[0m10:54:42.438154 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m10:54:42.438600 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: 
          COPY "finance"."analytics_dev"."regime_thresholds" FROM 'C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\seeds\regime_thresholds.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m10:54:42.461256 [debug] [Thread-2 (]: SQL status: OK in 0.097 seconds
[0m10:54:42.461724 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m10:54:42.467765 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:54:42.471041 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:54:42.471498 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m10:54:42.471953 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m10:54:42.532509 [debug] [Thread-2 (]: SQL status: OK in 0.060 seconds
[0m10:54:42.533002 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m10:54:42.542772 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m10:54:42.544047 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m10:54:42.544542 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:54:42.544972 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:54:42.545396 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m10:54:42.545813 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m10:54:42.604597 [debug] [Thread-3 (]: SQL status: OK in 0.165 seconds
[0m10:54:42.614000 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.portfolio_project_2.regime_thresholds"
[0m10:54:42.631228 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m10:54:42.631877 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m10:54:42.632394 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m10:54:42.658943 [debug] [Thread-2 (]: SQL status: OK in 0.113 seconds
[0m10:54:42.664687 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:54:42.665115 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m10:54:42.665618 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m10:54:42.668468 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:54:42.669403 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m10:54:42.855257 [debug] [Thread-3 (]: SQL status: OK in 0.222 seconds
[0m10:54:42.857264 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: Close
[0m10:54:42.859497 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015726587E30>]}
[0m10:54:42.860272 [info ] [Thread-3 (]: 3 of 124 OK loaded seed file analytics_dev.regime_thresholds ................... [[32mCREATE 1[0m in 0.58s]
[0m10:54:42.861293 [debug] [Thread-3 (]: Finished running node seed.portfolio_project_2.regime_thresholds
[0m10:54:42.862109 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.assert_regime_threshold_ordering
[0m10:54:42.862983 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m10:54:42.862544 [info ] [Thread-4 (]: 4 of 124 START test assert_regime_threshold_ordering ........................... [RUN]
[0m10:54:42.864317 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.assert_regime_threshold_ordering'
[0m10:54:42.864765 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.assert_regime_threshold_ordering
[0m10:54:42.868228 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m10:54:42.863691 [info ] [Thread-3 (]: 5 of 124 START test not_null_regime_thresholds_effective_date .................. [RUN]
[0m10:54:42.869476 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.portfolio_project_2.regime_thresholds, now test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5)
[0m10:54:42.870113 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m10:54:42.878838 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m10:54:42.881166 [debug] [Thread-1 (]: SQL status: OK in 0.211 seconds
[0m10:54:42.882882 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m10:54:42.883516 [debug] [Thread-2 (]: SQL status: OK in 0.214 seconds
[0m10:54:42.885410 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m10:54:42.886185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015728FCA030>]}
[0m10:54:42.887816 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.assert_regime_threshold_ordering
[0m10:54:42.888630 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m10:54:42.887189 [info ] [Thread-1 (]: 1 of 124 OK created sql view model analytics_dev.src_stocks .................... [[32mOK[0m in 0.63s]
[0m10:54:42.899657 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157290640D0>]}
[0m10:54:42.917676 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m10:54:42.918135 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m10:54:42.918953 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m10:54:42.919679 [info ] [Thread-2 (]: 2 of 124 OK created sql view model analytics_dev.src_vix ....................... [[32mOK[0m in 0.63s]
[0m10:54:42.920656 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m10:54:42.921319 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m10:54:42.922569 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m10:54:42.923406 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m10:54:42.923802 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: BEGIN
[0m10:54:42.924176 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:54:42.922126 [info ] [Thread-1 (]: 6 of 124 START test not_null_regime_thresholds_version_id ...................... [RUN]
[0m10:54:42.925058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c)
[0m10:54:42.925461 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m10:54:42.929448 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m10:54:42.922979 [info ] [Thread-2 (]: 7 of 124 START test unique_regime_thresholds_effective_date .................... [RUN]
[0m10:54:42.930722 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c)
[0m10:54:42.931170 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m10:54:42.941425 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m10:54:42.941934 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m10:54:42.942544 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: BEGIN
[0m10:54:42.942956 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m10:54:42.943384 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m10:54:42.943773 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:42.944317 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m10:54:43.037158 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m10:54:43.038979 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m10:54:43.039790 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.assert_regime_threshold_ordering"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select
    version_id,
    complacent_max,
    normal_max,
    elevated_max
from "finance"."analytics_dev"."regime_thresholds"
where not (complacent_max < normal_max and normal_max < elevated_max)
  
  
      
    ) dbt_internal_test
[0m10:54:43.042419 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m10:54:43.043085 [debug] [Thread-3 (]: SQL status: OK in 0.099 seconds
[0m10:54:43.044004 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m10:54:43.044501 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_date
from "finance"."analytics_dev"."regime_thresholds"
where effective_date is null



  
  
      
    ) dbt_internal_test
[0m10:54:43.048735 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m10:54:43.049205 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: BEGIN
[0m10:54:43.049605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:43.050264 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m10:54:43.050693 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: BEGIN
[0m10:54:43.051091 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:43.051773 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:54:43.052158 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m10:54:43.052536 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_id
from "finance"."analytics_dev"."regime_thresholds"
where version_id is null



  
  
      
    ) dbt_internal_test
[0m10:54:43.053069 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:54:43.053475 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m10:54:43.053876 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    effective_date as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."regime_thresholds"
where effective_date is not null
group by effective_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:54:43.108355 [debug] [Thread-3 (]: SQL status: OK in 0.063 seconds
[0m10:54:43.108895 [debug] [Thread-4 (]: SQL status: OK in 0.065 seconds
[0m10:54:43.113569 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: ROLLBACK
[0m10:54:43.115208 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: ROLLBACK
[0m10:54:43.115964 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.assert_regime_threshold_ordering'
[0m10:54:43.116410 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: Close
[0m10:54:43.117056 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5'
[0m10:54:43.117527 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: Close
[0m10:54:43.118223 [info ] [Thread-4 (]: 4 of 124 PASS assert_regime_threshold_ordering ................................. [[32mPASS[0m in 0.25s]
[0m10:54:43.119606 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.assert_regime_threshold_ordering
[0m10:54:43.120191 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m10:54:43.118823 [info ] [Thread-3 (]: 5 of 124 PASS not_null_regime_thresholds_effective_date ........................ [[32mPASS[0m in 0.25s]
[0m10:54:43.121678 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m10:54:43.122177 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__stocks
[0m10:54:43.120751 [info ] [Thread-4 (]: 8 of 124 START test unique_regime_thresholds_version_id ........................ [RUN]
[0m10:54:43.123707 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.assert_regime_threshold_ordering, now test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f)
[0m10:54:43.124195 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m10:54:43.129188 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m10:54:43.122772 [info ] [Thread-3 (]: 9 of 124 START sql view model analytics_dev.stg__stocks ........................ [RUN]
[0m10:54:43.130071 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m10:54:43.130626 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5, now model.portfolio_project_2.stg__stocks)
[0m10:54:43.131496 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m10:54:43.135386 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m10:54:43.136040 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m10:54:43.137709 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: ROLLBACK
[0m10:54:43.138322 [debug] [Thread-2 (]: SQL status: OK in 0.084 seconds
[0m10:54:43.140958 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m10:54:43.141754 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c'
[0m10:54:43.142520 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: Close
[0m10:54:43.144256 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: ROLLBACK
[0m10:54:43.145585 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c'
[0m10:54:43.144892 [info ] [Thread-1 (]: 6 of 124 PASS not_null_regime_thresholds_version_id ............................ [[32mPASS[0m in 0.22s]
[0m10:54:43.146362 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: Close
[0m10:54:43.147871 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m10:54:43.149193 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m10:54:43.150551 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: BEGIN
[0m10:54:43.150937 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:43.150170 [info ] [Thread-2 (]: 7 of 124 PASS unique_regime_thresholds_effective_date .......................... [[32mPASS[0m in 0.22s]
[0m10:54:43.151838 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m10:54:43.152501 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m10:54:43.155946 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m10:54:43.156361 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m10:54:43.157057 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m10:54:43.157458 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    version_id as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."regime_thresholds"
where version_id is not null
group by version_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:54:43.159191 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:54:43.159618 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m10:54:43.160021 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:43.161549 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:54:43.162068 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:54:43.162614 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m10:54:43.223366 [debug] [Thread-4 (]: SQL status: OK in 0.065 seconds
[0m10:54:43.226161 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: ROLLBACK
[0m10:54:43.226944 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f'
[0m10:54:43.227432 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: Close
[0m10:54:43.228833 [info ] [Thread-4 (]: 8 of 124 PASS unique_regime_thresholds_version_id .............................. [[32mPASS[0m in 0.11s]
[0m10:54:43.229853 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m10:54:43.230635 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m10:54:43.231233 [info ] [Thread-1 (]: 10 of 124 START sql view model analytics_dev.stg__vix_with_versions ............ [RUN]
[0m10:54:43.231931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c, now model.portfolio_project_2.stg__vix_with_versions)
[0m10:54:43.232364 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m10:54:43.235793 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m10:54:43.236825 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m10:54:43.240577 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m10:54:43.244686 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:54:43.245252 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m10:54:43.245760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:43.247291 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:43.247950 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:54:43.248448 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m10:54:43.250102 [debug] [Thread-3 (]: SQL status: OK in 0.087 seconds
[0m10:54:43.253805 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:54:43.254227 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m10:54:43.329077 [debug] [Thread-3 (]: SQL status: OK in 0.074 seconds
[0m10:54:43.331330 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m10:54:43.332001 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:54:43.332623 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m10:54:43.337847 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m10:54:43.340781 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:54:43.341173 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m10:54:43.403082 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m10:54:43.404499 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m10:54:43.404902 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:54:43.405260 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m10:54:43.447649 [debug] [Thread-3 (]: SQL status: OK in 0.114 seconds
[0m10:54:43.450534 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:54:43.450926 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m10:54:43.522572 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m10:54:43.525710 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:54:43.526149 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m10:54:43.550203 [debug] [Thread-3 (]: SQL status: OK in 0.099 seconds
[0m10:54:43.551993 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: Close
[0m10:54:43.552788 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015726091CC0>]}
[0m10:54:43.553546 [info ] [Thread-3 (]: 9 of 124 OK created sql view model analytics_dev.stg__stocks ................... [[32mOK[0m in 0.42s]
[0m10:54:43.554574 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m10:54:43.555703 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m10:54:43.556784 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m10:54:43.557782 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m10:54:43.556299 [info ] [Thread-2 (]: 11 of 124 START test dbt_utils_expression_is_true_stg__stocks_close___0 ........ [RUN]
[0m10:54:43.558966 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c)
[0m10:54:43.559448 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m10:54:43.564477 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m10:54:43.557318 [info ] [Thread-3 (]: 13 of 124 START test dbt_utils_expression_is_true_stg__stocks_high___0 ......... [RUN]
[0m10:54:43.565633 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c)
[0m10:54:43.566267 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m10:54:43.572435 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m10:54:43.558297 [info ] [Thread-4 (]: 12 of 124 START test dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high  [RUN]
[0m10:54:43.573747 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338)
[0m10:54:43.574343 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m10:54:43.578257 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m10:54:43.582203 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m10:54:43.585242 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m10:54:43.586010 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m10:54:43.588426 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m10:54:43.588968 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m10:54:43.591185 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m10:54:43.592183 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m10:54:43.592572 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: BEGIN
[0m10:54:43.592925 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:43.593732 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m10:54:43.594443 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m10:54:43.595235 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: BEGIN
[0m10:54:43.595901 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m10:54:43.596468 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: BEGIN
[0m10:54:43.597080 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:43.597596 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m10:54:43.598544 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m10:54:43.599072 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:43.599834 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(close >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:43.601363 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m10:54:43.601955 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m10:54:43.602934 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m10:54:43.603370 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(high >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:43.603968 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m10:54:43.604383 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m10:54:43.604795 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(close >= low and close <= high)


  
  
      
    ) dbt_internal_test
[0m10:54:43.605629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015725F40590>]}
[0m10:54:43.606335 [info ] [Thread-1 (]: 10 of 124 OK created sql view model analytics_dev.stg__vix_with_versions ....... [[32mOK[0m in 0.37s]
[0m10:54:43.607391 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m10:54:43.608015 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m10:54:43.608548 [info ] [Thread-1 (]: 14 of 124 START test dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp  [RUN]
[0m10:54:43.609700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa)
[0m10:54:43.610294 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m10:54:43.616554 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m10:54:43.617756 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m10:54:43.623948 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m10:54:43.625045 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m10:54:43.625465 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: BEGIN
[0m10:54:43.625825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:43.627039 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:43.627447 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m10:54:43.627922 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m10:54:43.703844 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m10:54:43.704381 [debug] [Thread-2 (]: SQL status: OK in 0.102 seconds
[0m10:54:43.704915 [debug] [Thread-3 (]: SQL status: OK in 0.101 seconds
[0m10:54:43.705538 [debug] [Thread-4 (]: SQL status: OK in 0.100 seconds
[0m10:54:43.707041 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: ROLLBACK
[0m10:54:43.707693 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c'
[0m10:54:43.708080 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: Close
[0m10:54:43.709416 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: ROLLBACK
[0m10:54:43.710023 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338'
[0m10:54:43.710415 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: Close
[0m10:54:43.711732 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: ROLLBACK
[0m10:54:43.712312 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c'
[0m10:54:43.712671 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: Close
[0m10:54:43.715098 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: ROLLBACK
[0m10:54:43.715713 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa'
[0m10:54:43.716096 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: Close
[0m10:54:43.713250 [info ] [Thread-4 (]: 12 of 124 PASS dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high  [[32mPASS[0m in 0.14s]
[0m10:54:43.716840 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m10:54:43.717256 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m10:54:43.713804 [info ] [Thread-2 (]: 11 of 124 PASS dbt_utils_expression_is_true_stg__stocks_close___0 .............. [[32mPASS[0m in 0.15s]
[0m10:54:43.719524 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m10:54:43.719947 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m10:54:43.717643 [info ] [Thread-4 (]: 15 of 124 START test dbt_utils_expression_is_true_stg__stocks_low___0 .......... [RUN]
[0m10:54:43.721014 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99)
[0m10:54:43.721472 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m10:54:43.725439 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m10:54:43.718158 [info ] [Thread-1 (]: 14 of 124 PASS dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp  [[32mPASS[0m in 0.11s]
[0m10:54:43.726308 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m10:54:43.726736 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m10:54:43.718699 [info ] [Thread-3 (]: 13 of 124 PASS dbt_utils_expression_is_true_stg__stocks_high___0 ............... [[32mPASS[0m in 0.15s]
[0m10:54:43.728001 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m10:54:43.728879 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m10:54:43.732080 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m10:54:43.720334 [info ] [Thread-2 (]: 16 of 124 START test dbt_utils_expression_is_true_stg__stocks_open___0 ......... [RUN]
[0m10:54:43.732789 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m10:54:43.727135 [info ] [Thread-1 (]: 17 of 124 START test dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high  [RUN]
[0m10:54:43.733710 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec)
[0m10:54:43.734809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8)
[0m10:54:43.734200 [info ] [Thread-3 (]: 18 of 124 START test dbt_utils_expression_is_true_stg__stocks_trade_date___current_date  [RUN]
[0m10:54:43.735489 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m10:54:43.736003 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m10:54:43.736612 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4)
[0m10:54:43.740746 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m10:54:43.744972 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m10:54:43.745536 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m10:54:43.746166 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m10:54:43.750795 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m10:54:43.751324 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: BEGIN
[0m10:54:43.751850 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m10:54:43.752572 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:43.753304 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m10:54:43.755996 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m10:54:43.758854 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m10:54:43.759546 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m10:54:43.760395 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m10:54:43.760984 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m10:54:43.764070 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m10:54:43.764817 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m10:54:43.765276 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(low >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:43.765954 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m10:54:43.766422 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: BEGIN
[0m10:54:43.767153 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: BEGIN
[0m10:54:43.767731 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:43.768407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:43.768897 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m10:54:43.769765 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: BEGIN
[0m10:54:43.770136 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:43.770762 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:54:43.771166 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m10:54:43.771568 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(open >= low and open <= high)


  
  
      
    ) dbt_internal_test
[0m10:54:43.772152 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m10:54:43.772549 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m10:54:43.772944 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(open >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:43.773367 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m10:54:43.773756 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m10:54:43.774152 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m10:54:43.827307 [debug] [Thread-4 (]: SQL status: OK in 0.060 seconds
[0m10:54:43.830264 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: ROLLBACK
[0m10:54:43.831081 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99'
[0m10:54:43.831541 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: Close
[0m10:54:43.832689 [info ] [Thread-4 (]: 15 of 124 PASS dbt_utils_expression_is_true_stg__stocks_low___0 ................ [[32mPASS[0m in 0.11s]
[0m10:54:43.833668 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m10:54:43.834208 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m10:54:43.834721 [info ] [Thread-4 (]: 19 of 124 START test dbt_utils_expression_is_true_stg__stocks_volume___0 ....... [RUN]
[0m10:54:43.835470 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e)
[0m10:54:43.835989 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m10:54:43.841264 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m10:54:43.842397 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m10:54:43.845507 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m10:54:43.846623 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m10:54:43.847668 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m10:54:43.848163 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: BEGIN
[0m10:54:43.848562 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:43.849223 [debug] [Thread-3 (]: SQL status: OK in 0.075 seconds
[0m10:54:43.851036 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: ROLLBACK
[0m10:54:43.851837 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8'
[0m10:54:43.852402 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: Close
[0m10:54:43.852894 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m10:54:43.853295 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m10:54:43.853690 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(volume >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:43.855917 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: ROLLBACK
[0m10:54:43.854323 [info ] [Thread-1 (]: 17 of 124 PASS dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high . [[32mPASS[0m in 0.12s]
[0m10:54:43.856787 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m10:54:43.857201 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m10:54:43.858223 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4'
[0m10:54:43.858614 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: Close
[0m10:54:43.859027 [debug] [Thread-2 (]: SQL status: OK in 0.086 seconds
[0m10:54:43.857596 [info ] [Thread-1 (]: 20 of 124 START test dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker  [RUN]
[0m10:54:43.860286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91)
[0m10:54:43.860746 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m10:54:43.865073 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m10:54:43.866791 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: ROLLBACK
[0m10:54:43.859830 [info ] [Thread-3 (]: 18 of 124 PASS dbt_utils_expression_is_true_stg__stocks_trade_date___current_date  [[32mPASS[0m in 0.12s]
[0m10:54:43.867641 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec'
[0m10:54:43.868306 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m10:54:43.868850 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: Close
[0m10:54:43.869412 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m10:54:43.869834 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m10:54:43.873830 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m10:54:43.870468 [info ] [Thread-3 (]: 21 of 124 START test not_null_stg__stocks_close ................................ [RUN]
[0m10:54:43.874623 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4, now test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f)
[0m10:54:43.875028 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m10:54:43.878985 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m10:54:43.871052 [info ] [Thread-2 (]: 16 of 124 PASS dbt_utils_expression_is_true_stg__stocks_open___0 ............... [[32mPASS[0m in 0.14s]
[0m10:54:43.880217 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m10:54:43.880730 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m10:54:43.881211 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m10:54:43.881874 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: BEGIN
[0m10:54:43.882296 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m10:54:43.883187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:43.886083 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m10:54:43.882784 [info ] [Thread-2 (]: 22 of 124 START test not_null_stg__stocks_high ................................. [RUN]
[0m10:54:43.887378 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec, now test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4)
[0m10:54:43.887859 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m10:54:43.891726 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m10:54:43.892612 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:54:43.893062 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m10:54:43.893476 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        trade_date, ticker
    from "finance"."analytics_dev"."stg__stocks"
    group by trade_date, ticker
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:54:43.894358 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m10:54:43.894846 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m10:54:43.895282 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: BEGIN
[0m10:54:43.899151 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m10:54:43.899972 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:43.901092 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m10:54:43.901504 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: BEGIN
[0m10:54:43.901849 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:43.902484 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m10:54:43.902873 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m10:54:43.903257 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."stg__stocks"
where close is null



  
  
      
    ) dbt_internal_test
[0m10:54:43.903761 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:54:43.904146 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m10:54:43.904536 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select high
from "finance"."analytics_dev"."stg__stocks"
where high is null



  
  
      
    ) dbt_internal_test
[0m10:54:43.937528 [debug] [Thread-4 (]: SQL status: OK in 0.083 seconds
[0m10:54:43.939969 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: ROLLBACK
[0m10:54:43.940627 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e'
[0m10:54:43.940992 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: Close
[0m10:54:43.941854 [info ] [Thread-4 (]: 19 of 124 PASS dbt_utils_expression_is_true_stg__stocks_volume___0 ............. [[32mPASS[0m in 0.11s]
[0m10:54:43.942675 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m10:54:43.943086 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m10:54:43.943494 [info ] [Thread-4 (]: 23 of 124 START test not_null_stg__stocks_loaded_at ............................ [RUN]
[0m10:54:43.944081 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e, now test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf)
[0m10:54:43.944485 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m10:54:43.948634 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m10:54:43.949644 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m10:54:43.951948 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m10:54:43.952885 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m10:54:43.953264 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: BEGIN
[0m10:54:43.953598 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:43.955260 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:54:43.956012 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m10:54:43.956772 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."stg__stocks"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m10:54:43.959243 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m10:54:43.961685 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: ROLLBACK
[0m10:54:43.962327 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91'
[0m10:54:43.962687 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: Close
[0m10:54:43.963575 [info ] [Thread-1 (]: 20 of 124 PASS dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker  [[32mPASS[0m in 0.10s]
[0m10:54:43.964526 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m10:54:43.965003 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m10:54:43.965384 [info ] [Thread-1 (]: 24 of 124 START test not_null_stg__stocks_low .................................. [RUN]
[0m10:54:43.966096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91, now test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52)
[0m10:54:43.966468 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m10:54:43.970587 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m10:54:43.974811 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m10:54:43.980380 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m10:54:43.983697 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m10:54:43.984770 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: BEGIN
[0m10:54:43.985434 [debug] [Thread-3 (]: SQL status: OK in 0.082 seconds
[0m10:54:43.986105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:43.987453 [debug] [Thread-2 (]: SQL status: OK in 0.082 seconds
[0m10:54:43.990614 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: ROLLBACK
[0m10:54:43.992951 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: ROLLBACK
[0m10:54:43.994109 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:54:43.995183 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f'
[0m10:54:43.996281 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4'
[0m10:54:43.997078 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m10:54:43.997891 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: Close
[0m10:54:43.998660 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: Close
[0m10:54:43.999535 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select low
from "finance"."analytics_dev"."stg__stocks"
where low is null



  
  
      
    ) dbt_internal_test
[0m10:54:44.002224 [info ] [Thread-3 (]: 21 of 124 PASS not_null_stg__stocks_close ...................................... [[32mPASS[0m in 0.13s]
[0m10:54:44.004199 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m10:54:44.003152 [info ] [Thread-2 (]: 22 of 124 PASS not_null_stg__stocks_high ....................................... [[32mPASS[0m in 0.12s]
[0m10:54:44.004879 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m10:54:44.005533 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m10:54:44.006605 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m10:54:44.006150 [info ] [Thread-3 (]: 25 of 124 START test not_null_stg__stocks_open ................................. [RUN]
[0m10:54:44.007168 [info ] [Thread-2 (]: 26 of 124 START test not_null_stg__stocks_ticker ............................... [RUN]
[0m10:54:44.007874 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f, now test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7)
[0m10:54:44.008362 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4, now test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71)
[0m10:54:44.008815 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m10:54:44.009249 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m10:54:44.018412 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m10:54:44.022647 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m10:54:44.023209 [debug] [Thread-4 (]: SQL status: OK in 0.066 seconds
[0m10:54:44.024361 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m10:54:44.026631 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m10:54:44.027103 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m10:54:44.029967 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m10:54:44.031635 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: ROLLBACK
[0m10:54:44.032705 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf'
[0m10:54:44.033117 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: Close
[0m10:54:44.033755 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m10:54:44.034169 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: BEGIN
[0m10:54:44.034541 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:44.035796 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m10:54:44.036182 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: BEGIN
[0m10:54:44.036519 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:44.035326 [info ] [Thread-4 (]: 23 of 124 PASS not_null_stg__stocks_loaded_at .................................. [[32mPASS[0m in 0.09s]
[0m10:54:44.037421 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m10:54:44.037951 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m10:54:44.038948 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m10:54:44.038448 [info ] [Thread-4 (]: 27 of 124 START test not_null_stg__stocks_trade_date ........................... [RUN]
[0m10:54:44.039541 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m10:54:44.039953 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m10:54:44.040454 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf, now test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182)
[0m10:54:44.040918 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."stg__stocks"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m10:54:44.041380 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m10:54:44.041844 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m10:54:44.042539 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "finance"."analytics_dev"."stg__stocks"
where open is null



  
  
      
    ) dbt_internal_test
[0m10:54:44.046784 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m10:54:44.048366 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m10:54:44.052567 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m10:54:44.053615 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m10:54:44.054025 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: BEGIN
[0m10:54:44.054365 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:44.055471 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:54:44.055830 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m10:54:44.056188 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."stg__stocks"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m10:54:44.083418 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m10:54:44.085695 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: ROLLBACK
[0m10:54:44.086305 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52'
[0m10:54:44.086652 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: Close
[0m10:54:44.087504 [info ] [Thread-1 (]: 24 of 124 PASS not_null_stg__stocks_low ........................................ [[32mPASS[0m in 0.12s]
[0m10:54:44.088307 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m10:54:44.088720 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m10:54:44.089107 [info ] [Thread-1 (]: 28 of 124 START test not_null_stg__stocks_volume ............................... [RUN]
[0m10:54:44.089722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52, now test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0)
[0m10:54:44.090082 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m10:54:44.093913 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m10:54:44.098288 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m10:54:44.101040 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m10:54:44.101969 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m10:54:44.102356 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: BEGIN
[0m10:54:44.102692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:44.103950 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m10:54:44.104467 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:54:44.104856 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m10:54:44.106263 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: ROLLBACK
[0m10:54:44.106689 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select volume
from "finance"."analytics_dev"."stg__stocks"
where volume is null



  
  
      
    ) dbt_internal_test
[0m10:54:44.107386 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71'
[0m10:54:44.107988 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: Close
[0m10:54:44.108940 [info ] [Thread-2 (]: 26 of 124 PASS not_null_stg__stocks_ticker ..................................... [[32mPASS[0m in 0.10s]
[0m10:54:44.109812 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m10:54:44.110238 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m10:54:44.110626 [info ] [Thread-2 (]: 29 of 124 START test dbt_utils_expression_is_true_stg__vix_with_versions_close___0  [RUN]
[0m10:54:44.111341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd)
[0m10:54:44.111770 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m10:54:44.116087 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m10:54:44.117068 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m10:54:44.119271 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m10:54:44.120208 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m10:54:44.120613 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: BEGIN
[0m10:54:44.120988 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:44.121748 [debug] [Thread-3 (]: SQL status: OK in 0.074 seconds
[0m10:54:44.122201 [debug] [Thread-4 (]: SQL status: OK in 0.066 seconds
[0m10:54:44.122771 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:54:44.123165 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m10:54:44.123563 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(close > 0)


  
  
      
    ) dbt_internal_test
[0m10:54:44.125105 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: ROLLBACK
[0m10:54:44.126937 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: ROLLBACK
[0m10:54:44.127746 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182'
[0m10:54:44.128535 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7'
[0m10:54:44.128980 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: Close
[0m10:54:44.129470 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: Close
[0m10:54:44.130609 [info ] [Thread-3 (]: 25 of 124 PASS not_null_stg__stocks_open ....................................... [[32mPASS[0m in 0.12s]
[0m10:54:44.131943 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m10:54:44.132903 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m10:54:44.131186 [info ] [Thread-4 (]: 27 of 124 PASS not_null_stg__stocks_trade_date ................................. [[32mPASS[0m in 0.09s]
[0m10:54:44.134202 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m10:54:44.134597 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m10:54:44.133331 [info ] [Thread-3 (]: 30 of 124 START test dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max  [RUN]
[0m10:54:44.135477 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929)
[0m10:54:44.135861 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m10:54:44.140156 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m10:54:44.134962 [info ] [Thread-4 (]: 31 of 124 START test dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp  [RUN]
[0m10:54:44.141171 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17)
[0m10:54:44.141633 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m10:54:44.145815 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m10:54:44.146817 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m10:54:44.152969 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m10:54:44.153550 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m10:54:44.156211 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m10:54:44.157455 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m10:54:44.158011 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: BEGIN
[0m10:54:44.158383 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:44.159103 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m10:54:44.159509 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: BEGIN
[0m10:54:44.159860 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:44.160391 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m10:54:44.161011 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m10:54:44.161579 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m10:54:44.161991 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(complacent_max < normal_max AND  normal_max < elevated_max)


  
  
      
    ) dbt_internal_test
[0m10:54:44.163700 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: ROLLBACK
[0m10:54:44.164162 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m10:54:44.164667 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m10:54:44.165081 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m10:54:44.165860 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0'
[0m10:54:44.166282 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: Close
[0m10:54:44.167272 [info ] [Thread-1 (]: 28 of 124 PASS not_null_stg__stocks_volume ..................................... [[32mPASS[0m in 0.08s]
[0m10:54:44.168108 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m10:54:44.168574 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m10:54:44.169197 [info ] [Thread-1 (]: 32 of 124 START test dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date  [RUN]
[0m10:54:44.169856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00)
[0m10:54:44.170261 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m10:54:44.174676 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m10:54:44.175838 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m10:54:44.178940 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m10:54:44.180047 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m10:54:44.180481 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: BEGIN
[0m10:54:44.180839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:44.182114 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:44.182573 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m10:54:44.182980 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m10:54:44.208622 [debug] [Thread-2 (]: SQL status: OK in 0.085 seconds
[0m10:54:44.211165 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: ROLLBACK
[0m10:54:44.211850 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd'
[0m10:54:44.212227 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: Close
[0m10:54:44.213274 [info ] [Thread-2 (]: 29 of 124 PASS dbt_utils_expression_is_true_stg__vix_with_versions_close___0 ... [[32mPASS[0m in 0.10s]
[0m10:54:44.214168 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m10:54:44.214607 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m10:54:44.214985 [info ] [Thread-2 (]: 33 of 124 START test dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1  [RUN]
[0m10:54:44.215614 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93)
[0m10:54:44.216012 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m10:54:44.220025 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m10:54:44.220981 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m10:54:44.223492 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m10:54:44.224414 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m10:54:44.224814 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: BEGIN
[0m10:54:44.225183 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:44.226528 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:54:44.226913 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m10:54:44.227307 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(version_rank >= 1)


  
  
      
    ) dbt_internal_test
[0m10:54:44.245539 [debug] [Thread-4 (]: SQL status: OK in 0.080 seconds
[0m10:54:44.248015 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: ROLLBACK
[0m10:54:44.248772 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17'
[0m10:54:44.249168 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: Close
[0m10:54:44.250880 [debug] [Thread-3 (]: SQL status: OK in 0.088 seconds
[0m10:54:44.250265 [info ] [Thread-4 (]: 31 of 124 PASS dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp  [[32mPASS[0m in 0.11s]
[0m10:54:44.251838 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m10:54:44.252265 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m10:54:44.254147 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: ROLLBACK
[0m10:54:44.252663 [info ] [Thread-4 (]: 34 of 124 START test dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id  [RUN]
[0m10:54:44.254979 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929'
[0m10:54:44.255462 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e)
[0m10:54:44.255919 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: Close
[0m10:54:44.256414 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m10:54:44.260589 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m10:54:44.261810 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m10:54:44.261344 [info ] [Thread-3 (]: 30 of 124 PASS dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max  [[32mPASS[0m in 0.13s]
[0m10:54:44.262668 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m10:54:44.263086 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m10:54:44.263498 [info ] [Thread-3 (]: 35 of 124 START test not_null_stg__vix_with_versions_close ..................... [RUN]
[0m10:54:44.266013 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: ROLLBACK
[0m10:54:44.266501 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929, now test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7)
[0m10:54:44.267247 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00'
[0m10:54:44.267752 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m10:54:44.268300 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: Close
[0m10:54:44.272402 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m10:54:44.272852 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m10:54:44.279299 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m10:54:44.279745 [info ] [Thread-1 (]: 32 of 124 PASS dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date  [[32mPASS[0m in 0.11s]
[0m10:54:44.281134 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m10:54:44.281586 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m10:54:44.282429 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m10:54:44.284973 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m10:54:44.281981 [info ] [Thread-1 (]: 36 of 124 START test not_null_stg__vix_with_versions_complacent_max ............ [RUN]
[0m10:54:44.285675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00, now test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a)
[0m10:54:44.286093 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m10:54:44.290670 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m10:54:44.291555 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m10:54:44.291978 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: BEGIN
[0m10:54:44.292336 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:44.292984 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m10:54:44.295685 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m10:54:44.296398 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m10:54:44.296911 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: BEGIN
[0m10:54:44.297352 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:44.298022 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m10:54:44.298514 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m10:54:44.298907 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        trade_date, version_id
    from "finance"."analytics_dev"."stg__vix_with_versions"
    group by trade_date, version_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:54:44.299633 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:54:44.300065 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m10:54:44.300474 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."stg__vix_with_versions"
where close is null



  
  
      
    ) dbt_internal_test
[0m10:54:44.301084 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m10:54:44.301482 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: BEGIN
[0m10:54:44.301848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:44.303012 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:44.303438 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m10:54:44.303844 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select complacent_max
from "finance"."analytics_dev"."stg__vix_with_versions"
where complacent_max is null



  
  
      
    ) dbt_internal_test
[0m10:54:44.377320 [debug] [Thread-2 (]: SQL status: OK in 0.150 seconds
[0m10:54:44.379775 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: ROLLBACK
[0m10:54:44.380427 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93'
[0m10:54:44.380791 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: Close
[0m10:54:44.381793 [info ] [Thread-2 (]: 33 of 124 PASS dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1  [[32mPASS[0m in 0.17s]
[0m10:54:44.382612 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m10:54:44.383033 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m10:54:44.383424 [info ] [Thread-2 (]: 37 of 124 START test not_null_stg__vix_with_versions_effective_date ............ [RUN]
[0m10:54:44.384029 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93, now test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991)
[0m10:54:44.384418 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m10:54:44.388566 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m10:54:44.389651 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m10:54:44.392215 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m10:54:44.393139 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m10:54:44.393689 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: BEGIN
[0m10:54:44.394068 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:44.395284 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:54:44.395745 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m10:54:44.396214 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
where effective_date is null



  
  
      
    ) dbt_internal_test
[0m10:54:44.396868 [debug] [Thread-3 (]: SQL status: OK in 0.096 seconds
[0m10:54:44.397351 [debug] [Thread-4 (]: SQL status: OK in 0.098 seconds
[0m10:54:44.398455 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:54:44.401153 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: ROLLBACK
[0m10:54:44.402896 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: ROLLBACK
[0m10:54:44.404263 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: ROLLBACK
[0m10:54:44.404947 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e'
[0m10:54:44.405612 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7'
[0m10:54:44.406227 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991'
[0m10:54:44.406645 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: Close
[0m10:54:44.407078 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: Close
[0m10:54:44.407523 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: Close
[0m10:54:44.408483 [info ] [Thread-2 (]: 37 of 124 PASS not_null_stg__vix_with_versions_effective_date .................. [[32mPASS[0m in 0.02s]
[0m10:54:44.410328 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m10:54:44.410781 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m10:54:44.409015 [info ] [Thread-4 (]: 34 of 124 PASS dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id  [[32mPASS[0m in 0.15s]
[0m10:54:44.412203 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m10:54:44.412957 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m10:54:44.414299 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m10:54:44.409555 [info ] [Thread-3 (]: 35 of 124 PASS not_null_stg__vix_with_versions_close ........................... [[32mPASS[0m in 0.14s]
[0m10:54:44.415444 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m10:54:44.417041 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: ROLLBACK
[0m10:54:44.411176 [info ] [Thread-2 (]: 38 of 124 START test not_null_stg__vix_with_versions_elevated_max .............. [RUN]
[0m10:54:44.417686 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m10:54:44.413672 [info ] [Thread-4 (]: 39 of 124 START test not_null_stg__vix_with_versions_loaded_at ................. [RUN]
[0m10:54:44.418553 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991, now test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6)
[0m10:54:44.420174 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a'
[0m10:54:44.420676 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e, now test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c)
[0m10:54:44.419456 [info ] [Thread-3 (]: 40 of 124 START test not_null_stg__vix_with_versions_normal_max ................ [RUN]
[0m10:54:44.421268 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m10:54:44.421710 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: Close
[0m10:54:44.422146 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m10:54:44.422624 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7, now test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21)
[0m10:54:44.426441 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m10:54:44.430762 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m10:54:44.431802 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m10:54:44.431421 [info ] [Thread-1 (]: 36 of 124 PASS not_null_stg__vix_with_versions_complacent_max .................. [[32mPASS[0m in 0.15s]
[0m10:54:44.436767 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m10:54:44.437503 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m10:54:44.438350 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m10:54:44.439250 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m10:54:44.438852 [info ] [Thread-1 (]: 41 of 124 START test not_null_stg__vix_with_versions_trade_date ................ [RUN]
[0m10:54:44.442400 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m10:54:44.442927 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m10:54:44.443399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a, now test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1)
[0m10:54:44.443883 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m10:54:44.446768 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m10:54:44.447321 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m10:54:44.449754 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m10:54:44.454147 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m10:54:44.454711 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m10:54:44.455521 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: BEGIN
[0m10:54:44.456119 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:44.456948 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m10:54:44.457350 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: BEGIN
[0m10:54:44.457721 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:44.458350 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m10:54:44.458766 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m10:54:44.459168 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."stg__vix_with_versions"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m10:54:44.459755 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m10:54:44.462263 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m10:54:44.462922 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m10:54:44.463337 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: BEGIN
[0m10:54:44.463698 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:44.464282 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m10:54:44.464703 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m10:54:44.465384 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select normal_max
from "finance"."analytics_dev"."stg__vix_with_versions"
where normal_max is null



  
  
      
    ) dbt_internal_test
[0m10:54:44.466229 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:54:44.466873 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m10:54:44.467271 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select elevated_max
from "finance"."analytics_dev"."stg__vix_with_versions"
where elevated_max is null



  
  
      
    ) dbt_internal_test
[0m10:54:44.467889 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m10:54:44.468283 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: BEGIN
[0m10:54:44.468652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:44.469734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:44.470104 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m10:54:44.470470 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."stg__vix_with_versions"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m10:54:44.518381 [debug] [Thread-4 (]: SQL status: OK in 0.059 seconds
[0m10:54:44.521031 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: ROLLBACK
[0m10:54:44.521736 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c'
[0m10:54:44.522150 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: Close
[0m10:54:44.523186 [info ] [Thread-4 (]: 39 of 124 PASS not_null_stg__vix_with_versions_loaded_at ....................... [[32mPASS[0m in 0.10s]
[0m10:54:44.524113 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m10:54:44.524601 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m10:54:44.525060 [info ] [Thread-4 (]: 42 of 124 START test not_null_stg__vix_with_versions_version_id ................ [RUN]
[0m10:54:44.525760 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c, now test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c)
[0m10:54:44.526217 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m10:54:44.531328 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m10:54:44.532404 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m10:54:44.534875 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m10:54:44.536012 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m10:54:44.536849 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: BEGIN
[0m10:54:44.537267 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:44.538727 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:54:44.539144 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m10:54:44.539553 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_id
from "finance"."analytics_dev"."stg__vix_with_versions"
where version_id is null



  
  
      
    ) dbt_internal_test
[0m10:54:44.549824 [debug] [Thread-3 (]: SQL status: OK in 0.084 seconds
[0m10:54:44.550316 [debug] [Thread-2 (]: SQL status: OK in 0.083 seconds
[0m10:54:44.552702 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: ROLLBACK
[0m10:54:44.553363 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6'
[0m10:54:44.553731 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: Close
[0m10:54:44.555018 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: ROLLBACK
[0m10:54:44.555721 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21'
[0m10:54:44.556181 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: Close
[0m10:54:44.556784 [info ] [Thread-2 (]: 38 of 124 PASS not_null_stg__vix_with_versions_elevated_max .................... [[32mPASS[0m in 0.14s]
[0m10:54:44.558135 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m10:54:44.557304 [info ] [Thread-3 (]: 40 of 124 PASS not_null_stg__vix_with_versions_normal_max ...................... [[32mPASS[0m in 0.13s]
[0m10:54:44.558900 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m10:54:44.559765 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m10:54:44.560914 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m10:54:44.560459 [info ] [Thread-2 (]: 43 of 124 START test not_null_stg__vix_with_versions_version_name .............. [RUN]
[0m10:54:44.562148 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6, now test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb)
[0m10:54:44.562598 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m10:54:44.561634 [info ] [Thread-3 (]: 44 of 124 START test not_null_stg__vix_with_versions_version_rank .............. [RUN]
[0m10:54:44.563164 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m10:54:44.563740 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21, now test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578)
[0m10:54:44.567969 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m10:54:44.568487 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m10:54:44.570123 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: ROLLBACK
[0m10:54:44.575270 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m10:54:44.576003 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1'
[0m10:54:44.576618 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: Close
[0m10:54:44.577168 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m10:54:44.579485 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m10:54:44.580769 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m10:54:44.580238 [info ] [Thread-1 (]: 41 of 124 PASS not_null_stg__vix_with_versions_trade_date ...................... [[32mPASS[0m in 0.14s]
[0m10:54:44.583945 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m10:54:44.584765 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m10:54:44.585753 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m10:54:44.586288 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__price_changes
[0m10:54:44.586897 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: BEGIN
[0m10:54:44.587956 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m10:54:44.588585 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:44.587523 [info ] [Thread-1 (]: 45 of 124 START sql view model analytics_dev.int__price_changes ................ [RUN]
[0m10:54:44.589267 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: BEGIN
[0m10:54:44.590041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1, now model.portfolio_project_2.int__price_changes)
[0m10:54:44.590488 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:44.590978 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m10:54:44.591389 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m10:54:44.594579 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m10:54:44.595040 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m10:54:44.595589 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m10:54:44.596050 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_name
from "finance"."analytics_dev"."stg__vix_with_versions"
where version_name is null



  
  
      
    ) dbt_internal_test
[0m10:54:44.596582 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m10:54:44.597363 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_rank
from "finance"."analytics_dev"."stg__vix_with_versions"
where version_rank is null



  
  
      
    ) dbt_internal_test
[0m10:54:44.598228 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m10:54:44.605953 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m10:54:44.607397 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m10:54:44.607834 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m10:54:44.608176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:44.608786 [debug] [Thread-4 (]: SQL status: OK in 0.069 seconds
[0m10:54:44.609323 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:44.609690 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m10:54:44.611084 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: ROLLBACK
[0m10:54:44.611556 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."stg__stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m10:54:44.612309 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c'
[0m10:54:44.613228 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: Close
[0m10:54:44.614416 [info ] [Thread-4 (]: 42 of 124 PASS not_null_stg__vix_with_versions_version_id ...................... [[32mPASS[0m in 0.09s]
[0m10:54:44.615364 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m10:54:44.675086 [debug] [Thread-2 (]: SQL status: OK in 0.078 seconds
[0m10:54:44.677349 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: ROLLBACK
[0m10:54:44.677958 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb'
[0m10:54:44.678322 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: Close
[0m10:54:44.679250 [info ] [Thread-2 (]: 43 of 124 PASS not_null_stg__vix_with_versions_version_name .................... [[32mPASS[0m in 0.12s]
[0m10:54:44.680058 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m10:54:44.692502 [debug] [Thread-3 (]: SQL status: OK in 0.095 seconds
[0m10:54:44.694910 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: ROLLBACK
[0m10:54:44.695511 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578'
[0m10:54:44.695875 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: Close
[0m10:54:44.697017 [info ] [Thread-3 (]: 44 of 124 PASS not_null_stg__vix_with_versions_version_rank .................... [[32mPASS[0m in 0.13s]
[0m10:54:44.698505 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m10:54:44.699347 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m10:54:44.699878 [info ] [Thread-4 (]: 46 of 124 START sql view model analytics_dev.int__regime_classification ........ [RUN]
[0m10:54:44.700747 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c, now model.portfolio_project_2.int__regime_classification)
[0m10:54:44.701291 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m10:54:44.704414 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m10:54:44.704979 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m10:54:44.708067 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m10:54:44.708448 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m10:54:44.709207 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m10:54:44.712895 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m10:54:44.713956 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:54:44.714361 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m10:54:44.714713 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:44.715845 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:54:44.716205 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:54:44.716592 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m10:54:44.766473 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m10:54:44.767833 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m10:54:44.768214 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m10:54:44.768562 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m10:54:44.787028 [debug] [Thread-4 (]: SQL status: OK in 0.070 seconds
[0m10:54:44.790708 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:54:44.791115 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m10:54:44.862775 [debug] [Thread-4 (]: SQL status: OK in 0.071 seconds
[0m10:54:44.864270 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m10:54:44.864755 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:54:44.865134 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m10:54:44.867325 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m10:54:44.869965 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m10:54:44.870419 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m10:54:44.979562 [debug] [Thread-4 (]: SQL status: OK in 0.114 seconds
[0m10:54:44.982789 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:54:44.983251 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m10:54:44.998264 [debug] [Thread-1 (]: SQL status: OK in 0.127 seconds
[0m10:54:44.999690 [debug] [Thread-1 (]: On model.portfolio_project_2.int__price_changes: Close
[0m10:54:45.000218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015725934650>]}
[0m10:54:45.000799 [info ] [Thread-1 (]: 45 of 124 OK created sql view model analytics_dev.int__price_changes ........... [[32mOK[0m in 0.41s]
[0m10:54:45.001597 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m10:54:45.002409 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m10:54:45.003208 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m10:54:45.003987 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m10:54:45.002829 [info ] [Thread-3 (]: 48 of 124 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m10:54:45.004878 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e)
[0m10:54:45.005280 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m10:54:45.010214 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m10:54:45.003622 [info ] [Thread-2 (]: 47 of 124 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m10:54:45.011228 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7)
[0m10:54:45.011694 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m10:54:45.016483 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m10:54:45.004381 [info ] [Thread-1 (]: 49 of 124 START test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [RUN]
[0m10:54:45.017325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd)
[0m10:54:45.017766 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m10:54:45.022339 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m10:54:45.023437 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m10:54:45.026394 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m10:54:45.027176 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m10:54:45.027789 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m10:54:45.031114 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m10:54:45.033981 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m10:54:45.034928 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m10:54:45.035435 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m10:54:45.035828 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:45.036448 [debug] [Thread-4 (]: SQL status: OK in 0.053 seconds
[0m10:54:45.037994 [debug] [Thread-4 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m10:54:45.038643 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015725D15D30>]}
[0m10:54:45.039299 [info ] [Thread-4 (]: 46 of 124 OK created sql view model analytics_dev.int__regime_classification ... [[32mOK[0m in 0.34s]
[0m10:54:45.039919 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m10:54:45.040633 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m10:54:45.041171 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m10:54:45.041644 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m10:54:45.042191 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m10:54:45.042653 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m10:54:45.043135 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: BEGIN
[0m10:54:45.043886 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m10:54:45.044905 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m10:54:45.044428 [info ] [Thread-4 (]: 50 of 124 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .. [RUN]
[0m10:54:45.045504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:45.046263 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:45.047017 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_classification, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m10:54:45.048169 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m10:54:45.052614 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m10:54:45.053229 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:54:45.053718 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m10:54:45.054121 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(abs(delta) - (gain + loss)) <= 1e-9)


  
  
      
    ) dbt_internal_test
[0m10:54:45.054728 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m10:54:45.055131 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m10:54:45.055532 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m10:54:45.056314 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m10:54:45.059069 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m10:54:45.060112 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m10:54:45.060601 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m10:54:45.061018 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:45.062413 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:54:45.062860 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m10:54:45.063293 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:45.130470 [debug] [Thread-3 (]: SQL status: OK in 0.084 seconds
[0m10:54:45.132921 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m10:54:45.133643 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m10:54:45.134058 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m10:54:45.135144 [info ] [Thread-3 (]: 48 of 124 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.13s]
[0m10:54:45.136304 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m10:54:45.137065 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m10:54:45.137838 [info ] [Thread-3 (]: 51 of 124 START test dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp  [RUN]
[0m10:54:45.138853 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a)
[0m10:54:45.139669 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m10:54:45.147591 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m10:54:45.148150 [debug] [Thread-2 (]: SQL status: OK in 0.092 seconds
[0m10:54:45.148733 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m10:54:45.151025 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m10:54:45.153735 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: ROLLBACK
[0m10:54:45.155048 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd'
[0m10:54:45.155461 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: Close
[0m10:54:45.156369 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m10:54:45.157727 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m10:54:45.157307 [info ] [Thread-1 (]: 49 of 124 PASS dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[32mPASS[0m in 0.14s]
[0m10:54:45.158349 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m10:54:45.159160 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m10:54:45.162566 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m10:54:45.159745 [info ] [Thread-2 (]: 47 of 124 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.15s]
[0m10:54:45.163281 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m10:54:45.164254 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m10:54:45.165473 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m10:54:45.164886 [info ] [Thread-1 (]: 52 of 124 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .. [RUN]
[0m10:54:45.166644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m10:54:45.167073 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m10:54:45.170810 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m10:54:45.171585 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m10:54:45.172011 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: BEGIN
[0m10:54:45.166085 [info ] [Thread-2 (]: 53 of 124 START test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [RUN]
[0m10:54:45.172657 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:45.173213 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96)
[0m10:54:45.173956 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m10:54:45.178326 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m10:54:45.178798 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m10:54:45.187615 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m10:54:45.188199 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m10:54:45.188720 [debug] [Thread-4 (]: SQL status: OK in 0.125 seconds
[0m10:54:45.189361 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m10:54:45.189873 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m10:54:45.190506 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m10:54:45.190939 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m10:54:45.193427 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m10:54:45.194891 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m10:54:45.195375 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m10:54:45.196913 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m10:54:45.197520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:45.198059 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m10:54:45.199003 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m10:54:45.200063 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: BEGIN
[0m10:54:45.200476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:45.199675 [info ] [Thread-4 (]: 50 of 124 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 ........ [[32mPASS[0m in 0.15s]
[0m10:54:45.201400 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m10:54:45.201835 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m10:54:45.202232 [info ] [Thread-4 (]: 54 of 124 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m10:54:45.202865 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:54:45.203326 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m10:54:45.203795 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m10:54:45.204201 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:54:45.204650 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m10:54:45.205115 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m10:54:45.205578 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m10:54:45.210722 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m10:54:45.211603 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:45.212900 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m10:54:45.215679 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m10:54:45.216726 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m10:54:45.217134 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m10:54:45.217482 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:45.218769 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:54:45.219161 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m10:54:45.219570 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:54:45.289655 [debug] [Thread-2 (]: SQL status: OK in 0.078 seconds
[0m10:54:45.290493 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m10:54:45.291307 [debug] [Thread-3 (]: SQL status: OK in 0.095 seconds
[0m10:54:45.292089 [debug] [Thread-4 (]: SQL status: OK in 0.072 seconds
[0m10:54:45.294679 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: ROLLBACK
[0m10:54:45.296830 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m10:54:45.298993 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m10:54:45.301243 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: ROLLBACK
[0m10:54:45.302356 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96'
[0m10:54:45.303346 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m10:54:45.304347 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m10:54:45.305307 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a'
[0m10:54:45.305968 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: Close
[0m10:54:45.306668 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m10:54:45.307362 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m10:54:45.308064 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: Close
[0m10:54:45.309578 [info ] [Thread-1 (]: 52 of 124 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 ........ [[32mPASS[0m in 0.14s]
[0m10:54:45.313175 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m10:54:45.310398 [info ] [Thread-4 (]: 54 of 124 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.11s]
[0m10:54:45.314091 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m10:54:45.315252 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m10:54:45.311196 [info ] [Thread-3 (]: 51 of 124 PASS dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp  [[32mPASS[0m in 0.17s]
[0m10:54:45.311988 [info ] [Thread-2 (]: 53 of 124 PASS dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[32mPASS[0m in 0.14s]
[0m10:54:45.317280 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m10:54:45.318501 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m10:54:45.316304 [info ] [Thread-1 (]: 55 of 124 START test not_null_int__price_changes_close ......................... [RUN]
[0m10:54:45.319783 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m10:54:45.321307 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m10:54:45.320493 [info ] [Thread-4 (]: 56 of 124 START test not_null_int__price_changes_gain .......................... [RUN]
[0m10:54:45.322485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m10:54:45.323297 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m10:54:45.324968 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m10:54:45.324250 [info ] [Thread-3 (]: 57 of 124 START test not_null_int__price_changes_loaded_at ..................... [RUN]
[0m10:54:45.326057 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m10:54:45.327454 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m10:54:45.326825 [info ] [Thread-2 (]: 58 of 124 START test not_null_int__price_changes_loss .......................... [RUN]
[0m10:54:45.328596 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m10:54:45.334511 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m10:54:45.339863 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m10:54:45.340440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m10:54:45.340935 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m10:54:45.341630 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m10:54:45.346335 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m10:54:45.351150 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m10:54:45.351976 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m10:54:45.354608 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m10:54:45.356111 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m10:54:45.359958 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m10:54:45.360776 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m10:54:45.361304 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m10:54:45.362016 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m10:54:45.362504 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m10:54:45.364965 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m10:54:45.365528 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m10:54:45.369048 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m10:54:45.369628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:45.370235 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m10:54:45.371212 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m10:54:45.371812 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:45.372313 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m10:54:45.372742 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:54:45.373229 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m10:54:45.373831 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:45.374261 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m10:54:45.374735 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m10:54:45.375137 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m10:54:45.375773 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m10:54:45.376229 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:45.376719 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m10:54:45.377143 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m10:54:45.378142 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m10:54:45.378889 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m10:54:45.379988 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m10:54:45.380471 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m10:54:45.380935 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m10:54:45.381613 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m10:54:45.457470 [debug] [Thread-4 (]: SQL status: OK in 0.077 seconds
[0m10:54:45.458404 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m10:54:45.459647 [debug] [Thread-3 (]: SQL status: OK in 0.077 seconds
[0m10:54:45.462278 [debug] [Thread-2 (]: SQL status: OK in 0.081 seconds
[0m10:54:45.465765 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m10:54:45.468049 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m10:54:45.472025 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m10:54:45.473096 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m10:54:45.476617 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m10:54:45.480381 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m10:54:45.482180 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m10:54:45.485196 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m10:54:45.483869 [info ] [Thread-4 (]: 56 of 124 PASS not_null_int__price_changes_gain ................................ [[32mPASS[0m in 0.16s]
[0m10:54:45.487217 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m10:54:45.488251 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m10:54:45.489343 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m10:54:45.491108 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m10:54:45.492246 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m10:54:45.493935 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m10:54:45.495700 [info ] [Thread-3 (]: 57 of 124 PASS not_null_int__price_changes_loaded_at ........................... [[32mPASS[0m in 0.17s]
[0m10:54:45.501701 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m10:54:45.497415 [info ] [Thread-1 (]: 55 of 124 PASS not_null_int__price_changes_close ............................... [[32mPASS[0m in 0.17s]
[0m10:54:45.503010 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m10:54:45.498903 [info ] [Thread-4 (]: 59 of 124 START test not_null_int__price_changes_rn ............................ [RUN]
[0m10:54:45.504654 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m10:54:45.500270 [info ] [Thread-2 (]: 58 of 124 PASS not_null_int__price_changes_loss ................................ [[32mPASS[0m in 0.16s]
[0m10:54:45.506407 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m10:54:45.507254 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m10:54:45.508459 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m10:54:45.505446 [info ] [Thread-3 (]: 60 of 124 START test not_null_int__price_changes_ticker ........................ [RUN]
[0m10:54:45.509406 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m10:54:45.510653 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m10:54:45.511475 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m10:54:45.510038 [info ] [Thread-1 (]: 61 of 124 START test not_null_int__price_changes_trade_date .................... [RUN]
[0m10:54:45.518050 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m10:54:45.519186 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m10:54:45.519756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m10:54:45.518698 [info ] [Thread-2 (]: 62 of 124 START test accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis  [RUN]
[0m10:54:45.524435 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m10:54:45.524906 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m10:54:45.525440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa, now test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b)
[0m10:54:45.530081 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m10:54:45.530715 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m10:54:45.531402 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m10:54:45.535460 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m10:54:45.538307 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m10:54:45.538850 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m10:54:45.539572 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m10:54:45.542011 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m10:54:45.544783 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m10:54:45.545364 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m10:54:45.545996 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m10:54:45.546631 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m10:54:45.549535 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m10:54:45.550145 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:45.550604 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m10:54:45.551471 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m10:54:45.551852 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:45.552477 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m10:54:45.552848 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m10:54:45.553184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:45.553743 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m10:54:45.554141 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m10:54:45.554525 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m10:54:45.555115 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m10:54:45.555518 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m10:54:45.555908 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m10:54:45.556450 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:54:45.556839 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m10:54:45.557222 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m10:54:45.557701 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m10:54:45.558095 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: BEGIN
[0m10:54:45.558478 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:45.559703 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:54:45.560123 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m10:54:45.560515 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regime as value_field,
        count(*) as n_records

    from "finance"."analytics_dev"."int__regime_classification"
    group by regime

)

select *
from all_values
where value_field not in (
    'complacent','normal','elevated','crisis'
)



  
  
      
    ) dbt_internal_test
[0m10:54:45.562190 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:54:45.564464 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m10:54:45.565129 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m10:54:45.565509 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m10:54:45.566246 [info ] [Thread-1 (]: 61 of 124 PASS not_null_int__price_changes_trade_date .......................... [[32mPASS[0m in 0.05s]
[0m10:54:45.567050 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m10:54:45.567447 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m10:54:45.567826 [info ] [Thread-1 (]: 63 of 124 START test dbt_utils_expression_is_true_int__regime_classification_close___0  [RUN]
[0m10:54:45.568386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6)
[0m10:54:45.568784 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m10:54:45.572737 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m10:54:45.573748 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m10:54:45.579826 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m10:54:45.581205 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m10:54:45.581621 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: BEGIN
[0m10:54:45.581981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:45.583324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:45.583719 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m10:54:45.584106 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_classification"

where not(close > 0)


  
  
      
    ) dbt_internal_test
[0m10:54:45.631703 [debug] [Thread-3 (]: SQL status: OK in 0.075 seconds
[0m10:54:45.634292 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m10:54:45.634996 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m10:54:45.635368 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m10:54:45.636302 [info ] [Thread-3 (]: 60 of 124 PASS not_null_int__price_changes_ticker .............................. [[32mPASS[0m in 0.12s]
[0m10:54:45.637181 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m10:54:45.637660 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m10:54:45.638469 [debug] [Thread-4 (]: SQL status: OK in 0.084 seconds
[0m10:54:45.638032 [info ] [Thread-3 (]: 64 of 124 START test dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp  [RUN]
[0m10:54:45.639107 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed)
[0m10:54:45.639539 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m10:54:45.643928 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m10:54:45.645585 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m10:54:45.646266 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m10:54:45.646643 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m10:54:45.647277 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m10:54:45.650213 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m10:54:45.651023 [info ] [Thread-4 (]: 59 of 124 PASS not_null_int__price_changes_rn .................................. [[32mPASS[0m in 0.14s]
[0m10:54:45.651975 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m10:54:45.653701 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m10:54:45.654667 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: BEGIN
[0m10:54:45.655745 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m10:54:45.656583 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:45.657052 [info ] [Thread-4 (]: 65 of 124 START test dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date  [RUN]
[0m10:54:45.657818 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f)
[0m10:54:45.658224 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m10:54:45.662771 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m10:54:45.663568 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m10:54:45.664072 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m10:54:45.664541 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_classification"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m10:54:45.665354 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m10:54:45.668024 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m10:54:45.668736 [debug] [Thread-2 (]: SQL status: OK in 0.108 seconds
[0m10:54:45.669274 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m10:54:45.670009 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m10:54:45.670399 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: BEGIN
[0m10:54:45.670755 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:45.672363 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: ROLLBACK
[0m10:54:45.673038 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b'
[0m10:54:45.673425 [debug] [Thread-2 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: Close
[0m10:54:45.674719 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: ROLLBACK
[0m10:54:45.675313 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6'
[0m10:54:45.675697 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: Close
[0m10:54:45.676216 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m10:54:45.676613 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m10:54:45.678346 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_classification"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m10:54:45.677363 [info ] [Thread-2 (]: 62 of 124 PASS accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis  [[32mPASS[0m in 0.15s]
[0m10:54:45.677940 [info ] [Thread-1 (]: 63 of 124 PASS dbt_utils_expression_is_true_int__regime_classification_close___0  [[32mPASS[0m in 0.11s]
[0m10:54:45.679588 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m10:54:45.680294 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m10:54:45.680824 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m10:54:45.681388 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m10:54:45.681915 [info ] [Thread-2 (]: 66 of 124 START test not_null_int__regime_classification_loaded_at ............. [RUN]
[0m10:54:45.683115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b, now test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b)
[0m10:54:45.682364 [info ] [Thread-1 (]: 67 of 124 START test not_null_int__regime_classification_regime ................ [RUN]
[0m10:54:45.683957 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m10:54:45.684455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6, now test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6)
[0m10:54:45.688578 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m10:54:45.689039 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m10:54:45.693089 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m10:54:45.693905 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m10:54:45.696634 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m10:54:45.697299 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m10:54:45.699993 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m10:54:45.701542 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m10:54:45.701954 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: BEGIN
[0m10:54:45.702309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:45.702989 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m10:54:45.703385 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: BEGIN
[0m10:54:45.703744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:45.704375 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:54:45.704769 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m10:54:45.705160 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__regime_classification"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m10:54:45.705667 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:54:45.706046 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m10:54:45.706433 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select regime
from "finance"."analytics_dev"."int__regime_classification"
where regime is null



  
  
      
    ) dbt_internal_test
[0m10:54:45.728786 [debug] [Thread-3 (]: SQL status: OK in 0.064 seconds
[0m10:54:45.731239 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: ROLLBACK
[0m10:54:45.731899 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed'
[0m10:54:45.732263 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: Close
[0m10:54:45.733188 [info ] [Thread-3 (]: 64 of 124 PASS dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp  [[32mPASS[0m in 0.09s]
[0m10:54:45.734008 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m10:54:45.734427 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m10:54:45.734819 [info ] [Thread-3 (]: 68 of 124 START test not_null_int__regime_classification_trade_date ............ [RUN]
[0m10:54:45.735440 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed, now test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade)
[0m10:54:45.735835 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m10:54:45.739704 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m10:54:45.740681 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m10:54:45.743398 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m10:54:45.744497 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m10:54:45.744876 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: BEGIN
[0m10:54:45.745234 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:45.746588 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:54:45.747028 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m10:54:45.747392 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__regime_classification"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m10:54:45.747994 [debug] [Thread-4 (]: SQL status: OK in 0.069 seconds
[0m10:54:45.750249 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: ROLLBACK
[0m10:54:45.750869 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f'
[0m10:54:45.751233 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: Close
[0m10:54:45.752070 [info ] [Thread-4 (]: 65 of 124 PASS dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date  [[32mPASS[0m in 0.09s]
[0m10:54:45.752867 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m10:54:45.753290 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m10:54:45.753744 [info ] [Thread-4 (]: 69 of 124 START test relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_  [RUN]
[0m10:54:45.754398 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f, now test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5)
[0m10:54:45.754808 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m10:54:45.759836 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m10:54:45.761053 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m10:54:45.764061 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m10:54:45.765100 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m10:54:45.765490 [debug] [Thread-4 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: BEGIN
[0m10:54:45.765833 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:45.767048 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:54:45.767439 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m10:54:45.767850 [debug] [Thread-4 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select trade_date as from_field
    from "finance"."analytics_dev"."int__regime_classification"
    where trade_date is not null
),

parent as (
    select trade_date as to_field
    from "finance"."analytics_dev"."stg__vix_with_versions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m10:54:45.787517 [debug] [Thread-2 (]: SQL status: OK in 0.082 seconds
[0m10:54:45.789786 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: ROLLBACK
[0m10:54:45.790401 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b'
[0m10:54:45.790755 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: Close
[0m10:54:45.791648 [info ] [Thread-2 (]: 66 of 124 PASS not_null_int__regime_classification_loaded_at ................... [[32mPASS[0m in 0.11s]
[0m10:54:45.792458 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m10:54:45.792885 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m10:54:45.793276 [info ] [Thread-2 (]: 70 of 124 START test unique_int__regime_classification_trade_date .............. [RUN]
[0m10:54:45.794045 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b, now test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4)
[0m10:54:45.794452 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m10:54:45.798507 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m10:54:45.799146 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m10:54:45.799893 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m10:54:45.802583 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m10:54:45.804118 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: ROLLBACK
[0m10:54:45.804733 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6'
[0m10:54:45.805089 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: Close
[0m10:54:45.805722 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m10:54:45.806134 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: BEGIN
[0m10:54:45.806496 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:45.807750 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:54:45.807253 [info ] [Thread-1 (]: 67 of 124 PASS not_null_int__regime_classification_regime ...................... [[32mPASS[0m in 0.12s]
[0m10:54:45.808306 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m10:54:45.808959 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m10:54:45.809423 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."int__regime_classification"
where trade_date is not null
group by trade_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:54:45.809939 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m10:54:45.810881 [info ] [Thread-1 (]: 71 of 124 START sql view model analytics_dev.int__rsi_sma ...................... [RUN]
[0m10:54:45.811671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6, now model.portfolio_project_2.int__rsi_sma)
[0m10:54:45.812101 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m10:54:45.815692 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m10:54:45.816223 [debug] [Thread-3 (]: SQL status: OK in 0.068 seconds
[0m10:54:45.817470 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m10:54:45.820505 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m10:54:45.821979 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: ROLLBACK
[0m10:54:45.822611 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade'
[0m10:54:45.822970 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: Close
[0m10:54:45.823629 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m10:54:45.824035 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m10:54:45.824397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:45.825134 [info ] [Thread-3 (]: 68 of 124 PASS not_null_int__regime_classification_trade_date .................. [[32mPASS[0m in 0.09s]
[0m10:54:45.826009 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m10:54:45.826566 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:54:45.826960 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m10:54:45.827396 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    sma_gain::decimal(18,2) as sma_gain,
    sma_loss::decimal(18,2) as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m10:54:45.851162 [debug] [Thread-4 (]: SQL status: OK in 0.083 seconds
[0m10:54:45.853862 [debug] [Thread-4 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: ROLLBACK
[0m10:54:45.854476 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5'
[0m10:54:45.854843 [debug] [Thread-4 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: Close
[0m10:54:45.855824 [info ] [Thread-4 (]: 69 of 124 PASS relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_  [[32mPASS[0m in 0.10s]
[0m10:54:45.856697 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m10:54:45.869338 [debug] [Thread-2 (]: SQL status: OK in 0.059 seconds
[0m10:54:45.871709 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: ROLLBACK
[0m10:54:45.872321 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4'
[0m10:54:45.872677 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: Close
[0m10:54:45.873528 [info ] [Thread-2 (]: 70 of 124 PASS unique_int__regime_classification_trade_date .................... [[32mPASS[0m in 0.08s]
[0m10:54:45.874319 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m10:54:45.875017 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m10:54:45.876026 [debug] [Thread-4 (]: Began running node snapshot.portfolio_project_2.regime_classification_snapshot
[0m10:54:45.875602 [info ] [Thread-3 (]: 72 of 124 START sql view model analytics_dev.int__regime_changes ............... [RUN]
[0m10:54:45.877255 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade, now model.portfolio_project_2.int__regime_changes)
[0m10:54:45.877711 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m10:54:45.881607 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m10:54:45.876558 [info ] [Thread-4 (]: 73 of 124 START snapshot analytics_dev_snapshots.regime_classification_snapshot  [RUN]
[0m10:54:45.882412 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5, now snapshot.portfolio_project_2.regime_classification_snapshot)
[0m10:54:45.882821 [debug] [Thread-4 (]: Began compiling node snapshot.portfolio_project_2.regime_classification_snapshot
[0m10:54:45.885497 [debug] [Thread-4 (]: Began executing node snapshot.portfolio_project_2.regime_classification_snapshot
[0m10:54:45.933552 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:54:45.934001 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: BEGIN
[0m10:54:45.934353 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:45.934950 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m10:54:45.938078 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m10:54:45.938520 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m10:54:45.938972 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m10:54:45.942587 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m10:54:45.943112 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m10:54:45.943486 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:54:45.943861 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m10:54:45.946725 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:54:45.947147 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m10:54:45.947486 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:45.948577 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:54:45.948933 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:54:45.949338 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m10:54:45.950162 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m10:54:46.005140 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:54:46.005657 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

        
  
    
    

    create  table
      "regime_classification_snapshot__dbt_tmp20251111105445996870"
  
    as (
      
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."int__regime_classification"

    ),

    snapshotted_data as (

        select *, 
    
        trade_date as dbt_unique_key
    

        from "finance"."analytics_dev_snapshots"."regime_classification_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
  
    
[0m10:54:46.006626 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m10:54:46.007906 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m10:54:46.008299 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m10:54:46.008668 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m10:54:46.050529 [debug] [Thread-3 (]: SQL status: OK in 0.100 seconds
[0m10:54:46.057913 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:54:46.058862 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m10:54:46.139788 [debug] [Thread-3 (]: SQL status: OK in 0.080 seconds
[0m10:54:46.141545 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m10:54:46.141949 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:54:46.142291 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m10:54:46.142673 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m10:54:46.144865 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m10:54:46.145339 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m10:54:46.252068 [debug] [Thread-4 (]: SQL status: OK in 0.246 seconds
[0m10:54:46.255302 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:54:46.255747 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251111105445996870'
      
      
      order by ordinal_position

  
[0m10:54:46.260767 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m10:54:46.264241 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:54:46.264694 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m10:54:46.266267 [debug] [Thread-3 (]: SQL status: OK in 0.124 seconds
[0m10:54:46.266752 [debug] [Thread-1 (]: SQL status: OK in 0.121 seconds
[0m10:54:46.269596 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:54:46.271033 [debug] [Thread-1 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m10:54:46.271448 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m10:54:46.271897 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m10:54:46.272546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015725CC8C50>]}
[0m10:54:46.275783 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:54:46.276887 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251111105445996870'
      
      
      order by ordinal_position

  
[0m10:54:46.276444 [info ] [Thread-1 (]: 71 of 124 OK created sql view model analytics_dev.int__rsi_sma ................. [[32mOK[0m in 0.46s]
[0m10:54:46.278001 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m10:54:46.278897 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m10:54:46.279705 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m10:54:46.279323 [info ] [Thread-2 (]: 74 of 124 START test dbt_utils_expression_is_true_int__rsi_sma_gain___0 ........ [RUN]
[0m10:54:46.280699 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6)
[0m10:54:46.281076 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m10:54:46.285183 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m10:54:46.285813 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m10:54:46.280125 [info ] [Thread-1 (]: 75 of 124 START test dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp  [RUN]
[0m10:54:46.286729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_sma, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772)
[0m10:54:46.287175 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m10:54:46.292397 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m10:54:46.296773 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:54:46.297567 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m10:54:46.298521 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m10:54:46.301991 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m10:54:46.302475 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m10:54:46.305040 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m10:54:46.305669 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m10:54:46.313706 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:54:46.314270 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m10:54:46.314817 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251111105445996870'
      
      
      order by ordinal_position

  
[0m10:54:46.315462 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m10:54:46.316009 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: BEGIN
[0m10:54:46.316750 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: BEGIN
[0m10:54:46.317256 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:46.317714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:46.318998 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:46.319460 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m10:54:46.319860 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m10:54:46.320623 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m10:54:46.321109 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m10:54:46.321513 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:46.322171 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m10:54:46.339798 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:54:46.340317 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */
DESCRIBE (select * from (
        
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."int__regime_classification"

    ),

    snapshotted_data as (

        select *, 
    
        trade_date as dbt_unique_key
    

        from "finance"."analytics_dev_snapshots"."regime_classification_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:54:46.345698 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m10:54:46.349327 [debug] [Thread-3 (]: SQL status: OK in 0.076 seconds
[0m10:54:46.350833 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m10:54:46.356473 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:54:46.357117 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:54:46.357903 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015725D61790>]}
[0m10:54:46.359444 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m10:54:46.358817 [info ] [Thread-3 (]: 72 of 124 OK created sql view model analytics_dev.int__regime_changes .......... [[32mOK[0m in 0.48s]
[0m10:54:46.360798 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m10:54:46.361509 [debug] [Thread-4 (]: Writing runtime sql for node "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:54:46.361959 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m10:54:46.362766 [info ] [Thread-3 (]: 76 of 124 START test dbt_utils_expression_is_true_int__rsi_sma_loss___0 ........ [RUN]
[0m10:54:46.363487 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62)
[0m10:54:46.363934 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m10:54:46.368090 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m10:54:46.377764 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:54:46.378252 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      update "finance"."analytics_dev_snapshots"."regime_classification_snapshot" as DBT_INTERNAL_TARGET
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "regime_classification_snapshot__dbt_tmp20251111105445996870" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = DBT_INTERNAL_TARGET.dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and DBT_INTERNAL_TARGET.dbt_valid_to is null;
      

    insert into "finance"."analytics_dev_snapshots"."regime_classification_snapshot" ("trade_date", "close", "regime", "loaded_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."trade_date",DBT_INTERNAL_SOURCE."close",DBT_INTERNAL_SOURCE."regime",DBT_INTERNAL_SOURCE."loaded_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "regime_classification_snapshot__dbt_tmp20251111105445996870" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;


  
[0m10:54:46.378700 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m10:54:46.381902 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m10:54:46.383128 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m10:54:46.383579 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: BEGIN
[0m10:54:46.383947 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:46.385172 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:54:46.385559 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m10:54:46.385943 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:46.408971 [debug] [Thread-2 (]: SQL status: OK in 0.087 seconds
[0m10:54:46.409857 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m10:54:46.414049 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: ROLLBACK
[0m10:54:46.416079 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: ROLLBACK
[0m10:54:46.416977 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772'
[0m10:54:46.417720 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6'
[0m10:54:46.418287 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: Close
[0m10:54:46.418780 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: Close
[0m10:54:46.419930 [info ] [Thread-2 (]: 74 of 124 PASS dbt_utils_expression_is_true_int__rsi_sma_gain___0 .............. [[32mPASS[0m in 0.14s]
[0m10:54:46.421374 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m10:54:46.421882 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m10:54:46.420542 [info ] [Thread-1 (]: 75 of 124 PASS dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp  [[32mPASS[0m in 0.13s]
[0m10:54:46.423331 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m10:54:46.423743 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m10:54:46.422363 [info ] [Thread-2 (]: 77 of 124 START test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [RUN]
[0m10:54:46.424802 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704)
[0m10:54:46.425231 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m10:54:46.429483 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m10:54:46.424131 [info ] [Thread-1 (]: 78 of 124 START test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 .... [RUN]
[0m10:54:46.430291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9)
[0m10:54:46.430751 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m10:54:46.441096 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m10:54:46.441968 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m10:54:46.444558 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m10:54:46.445321 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m10:54:46.448031 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m10:54:46.448893 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m10:54:46.449310 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: BEGIN
[0m10:54:46.449659 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:46.450550 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m10:54:46.451002 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: BEGIN
[0m10:54:46.451354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:46.452005 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:54:46.452409 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m10:54:46.452808 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m10:54:46.453334 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:54:46.453717 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m10:54:46.454083 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:46.468930 [debug] [Thread-3 (]: SQL status: OK in 0.083 seconds
[0m10:54:46.471287 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: ROLLBACK
[0m10:54:46.471926 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62'
[0m10:54:46.472320 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: Close
[0m10:54:46.473238 [info ] [Thread-3 (]: 76 of 124 PASS dbt_utils_expression_is_true_int__rsi_sma_loss___0 .............. [[32mPASS[0m in 0.11s]
[0m10:54:46.474063 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m10:54:46.474475 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m10:54:46.474863 [info ] [Thread-3 (]: 79 of 124 START test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 .... [RUN]
[0m10:54:46.475472 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21)
[0m10:54:46.475882 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m10:54:46.480644 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m10:54:46.481984 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m10:54:46.484377 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m10:54:46.485424 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m10:54:46.485830 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: BEGIN
[0m10:54:46.486179 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:46.487482 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:54:46.487937 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m10:54:46.488320 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:46.504594 [debug] [Thread-4 (]: SQL status: OK in 0.125 seconds
[0m10:54:46.505945 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: COMMIT
[0m10:54:46.506347 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:54:46.506711 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: COMMIT
[0m10:54:46.536917 [debug] [Thread-2 (]: SQL status: OK in 0.084 seconds
[0m10:54:46.539276 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: ROLLBACK
[0m10:54:46.539940 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704'
[0m10:54:46.540305 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: Close
[0m10:54:46.541239 [info ] [Thread-2 (]: 77 of 124 PASS dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[32mPASS[0m in 0.12s]
[0m10:54:46.542108 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m10:54:46.542594 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m10:54:46.542969 [info ] [Thread-2 (]: 80 of 124 START test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [RUN]
[0m10:54:46.543597 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08)
[0m10:54:46.544047 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m10:54:46.548243 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m10:54:46.548812 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m10:54:46.551081 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: ROLLBACK
[0m10:54:46.551670 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9'
[0m10:54:46.552117 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: Close
[0m10:54:46.552615 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m10:54:46.555009 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m10:54:46.555694 [info ] [Thread-1 (]: 78 of 124 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 .......... [[32mPASS[0m in 0.13s]
[0m10:54:46.556574 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m10:54:46.556987 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m10:54:46.557358 [info ] [Thread-1 (]: 81 of 124 START test not_null_int__rsi_sma_close ............................... [RUN]
[0m10:54:46.557975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9, now test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b)
[0m10:54:46.558343 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m10:54:46.562491 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m10:54:46.563365 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m10:54:46.563841 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: BEGIN
[0m10:54:46.564229 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:46.565048 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m10:54:46.567662 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m10:54:46.568237 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m10:54:46.568654 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m10:54:46.569059 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_sma"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:54:46.569878 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m10:54:46.570276 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: BEGIN
[0m10:54:46.570635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:46.571714 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:46.572082 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m10:54:46.572442 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__rsi_sma"
where close is null



  
  
      
    ) dbt_internal_test
[0m10:54:46.593293 [debug] [Thread-3 (]: SQL status: OK in 0.104 seconds
[0m10:54:46.596213 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: ROLLBACK
[0m10:54:46.597109 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21'
[0m10:54:46.597504 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: Close
[0m10:54:46.599084 [info ] [Thread-3 (]: 79 of 124 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 .......... [[32mPASS[0m in 0.12s]
[0m10:54:46.599989 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m10:54:46.600421 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m10:54:46.600798 [info ] [Thread-3 (]: 82 of 124 START test not_null_int__rsi_sma_gain ................................ [RUN]
[0m10:54:46.601458 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21, now test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953)
[0m10:54:46.601844 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m10:54:46.605827 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m10:54:46.607233 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m10:54:46.610553 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m10:54:46.611803 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m10:54:46.612207 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: BEGIN
[0m10:54:46.612582 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:46.614174 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:54:46.614722 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m10:54:46.615095 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_sma"
where gain is null



  
  
      
    ) dbt_internal_test
[0m10:54:46.662782 [debug] [Thread-4 (]: SQL status: OK in 0.156 seconds
[0m10:54:46.666347 [debug] [Thread-4 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:54:46.667062 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      drop table if exists "regime_classification_snapshot__dbt_tmp20251111105445996870" cascade
    
[0m10:54:46.759430 [debug] [Thread-1 (]: SQL status: OK in 0.186 seconds
[0m10:54:46.760538 [debug] [Thread-2 (]: SQL status: OK in 0.191 seconds
[0m10:54:46.764479 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: ROLLBACK
[0m10:54:46.766909 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: ROLLBACK
[0m10:54:46.768089 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b'
[0m10:54:46.769206 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08'
[0m10:54:46.769944 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: Close
[0m10:54:46.770730 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: Close
[0m10:54:46.772735 [info ] [Thread-1 (]: 81 of 124 PASS not_null_int__rsi_sma_close ..................................... [[32mPASS[0m in 0.21s]
[0m10:54:46.774982 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m10:54:46.775773 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m10:54:46.773687 [info ] [Thread-2 (]: 80 of 124 PASS dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn . [[32mPASS[0m in 0.23s]
[0m10:54:46.776975 [info ] [Thread-1 (]: 83 of 124 START test not_null_int__rsi_sma_loaded_at ........................... [RUN]
[0m10:54:46.778414 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m10:54:46.779163 [debug] [Thread-3 (]: SQL status: OK in 0.164 seconds
[0m10:54:46.780019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b, now test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0)
[0m10:54:46.780886 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m10:54:46.781951 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m10:54:46.785292 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: ROLLBACK
[0m10:54:46.782763 [info ] [Thread-2 (]: 84 of 124 START test not_null_int__rsi_sma_loss ................................ [RUN]
[0m10:54:46.793123 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m10:54:46.794299 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953'
[0m10:54:46.795725 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08, now test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065)
[0m10:54:46.796823 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: Close
[0m10:54:46.797520 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m10:54:46.804141 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m10:54:46.805291 [info ] [Thread-3 (]: 82 of 124 PASS not_null_int__rsi_sma_gain ...................................... [[32mPASS[0m in 0.20s]
[0m10:54:46.806416 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m10:54:46.807125 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m10:54:46.807769 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m10:54:46.808899 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m10:54:46.808366 [info ] [Thread-3 (]: 85 of 124 START test not_null_int__rsi_sma_rn .................................. [RUN]
[0m10:54:46.812700 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m10:54:46.815576 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m10:54:46.816241 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953, now test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139)
[0m10:54:46.817121 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m10:54:46.821563 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m10:54:46.822743 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m10:54:46.823598 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m10:54:46.824064 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: BEGIN
[0m10:54:46.824576 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: BEGIN
[0m10:54:46.825071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:46.825541 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:46.826023 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m10:54:46.830292 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m10:54:46.830944 [debug] [Thread-4 (]: SQL status: OK in 0.163 seconds
[0m10:54:46.831792 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:54:46.833545 [debug] [Thread-4 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: Close
[0m10:54:46.834020 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m10:54:46.834473 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m10:54:46.835027 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m10:54:46.835599 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157257D3B90>]}
[0m10:54:46.836038 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m10:54:46.836497 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__rsi_sma"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m10:54:46.836961 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: BEGIN
[0m10:54:46.838354 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_sma"
where loss is null



  
  
      
    ) dbt_internal_test
[0m10:54:46.837881 [info ] [Thread-4 (]: 73 of 124 OK snapshotted analytics_dev_snapshots.regime_classification_snapshot  [[32mOK[0m in 0.95s]
[0m10:54:46.839237 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:46.840114 [debug] [Thread-4 (]: Finished running node snapshot.portfolio_project_2.regime_classification_snapshot
[0m10:54:46.840799 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m10:54:46.841209 [info ] [Thread-4 (]: 86 of 124 START test not_null_int__rsi_sma_sma_gain ............................ [RUN]
[0m10:54:46.841876 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m10:54:46.842430 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.portfolio_project_2.regime_classification_snapshot, now test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416)
[0m10:54:46.842886 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m10:54:46.843335 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m10:54:46.843870 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_sma"
where rn is null



  
  
      
    ) dbt_internal_test
[0m10:54:46.849124 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m10:54:46.850635 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m10:54:46.853523 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m10:54:46.855189 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m10:54:46.855958 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: BEGIN
[0m10:54:46.856428 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:46.857825 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:54:46.858356 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m10:54:46.858745 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_gain
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_gain is null



  
  
      
    ) dbt_internal_test
[0m10:54:46.921271 [debug] [Thread-2 (]: SQL status: OK in 0.081 seconds
[0m10:54:46.921865 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m10:54:46.923655 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: ROLLBACK
[0m10:54:46.925102 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: ROLLBACK
[0m10:54:46.925771 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0'
[0m10:54:46.926134 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: Close
[0m10:54:46.926687 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065'
[0m10:54:46.927092 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: Close
[0m10:54:46.927768 [info ] [Thread-1 (]: 83 of 124 PASS not_null_int__rsi_sma_loaded_at ................................. [[32mPASS[0m in 0.15s]
[0m10:54:46.929115 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m10:54:46.929539 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m10:54:46.928361 [info ] [Thread-2 (]: 84 of 124 PASS not_null_int__rsi_sma_loss ...................................... [[32mPASS[0m in 0.13s]
[0m10:54:46.930589 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m10:54:46.930994 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m10:54:46.929924 [info ] [Thread-1 (]: 87 of 124 START test not_null_int__rsi_sma_sma_loss ............................ [RUN]
[0m10:54:46.932235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0, now test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6)
[0m10:54:46.932621 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m10:54:46.936656 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m10:54:46.931461 [info ] [Thread-2 (]: 88 of 124 START test not_null_int__rsi_sma_ticker .............................. [RUN]
[0m10:54:46.937477 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065, now test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d)
[0m10:54:46.938072 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m10:54:46.949533 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m10:54:46.950171 [debug] [Thread-4 (]: SQL status: OK in 0.091 seconds
[0m10:54:46.950601 [debug] [Thread-3 (]: SQL status: OK in 0.101 seconds
[0m10:54:46.951479 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m10:54:46.951971 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m10:54:46.953547 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: ROLLBACK
[0m10:54:46.955886 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m10:54:46.957174 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: ROLLBACK
[0m10:54:46.959618 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m10:54:46.960473 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139'
[0m10:54:46.961355 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416'
[0m10:54:46.962067 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: Close
[0m10:54:46.962784 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: Close
[0m10:54:46.963477 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m10:54:46.964711 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: BEGIN
[0m10:54:46.965133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:46.964193 [info ] [Thread-3 (]: 85 of 124 PASS not_null_int__rsi_sma_rn ........................................ [[32mPASS[0m in 0.15s]
[0m10:54:46.966124 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m10:54:46.966563 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m10:54:46.968085 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m10:54:46.968511 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:54:46.966956 [info ] [Thread-3 (]: 89 of 124 START test not_null_int__rsi_sma_trade_date .......................... [RUN]
[0m10:54:46.969088 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: BEGIN
[0m10:54:46.969578 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m10:54:46.970065 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139, now test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0)
[0m10:54:46.967487 [info ] [Thread-4 (]: 86 of 124 PASS not_null_int__rsi_sma_sma_gain .................................. [[32mPASS[0m in 0.13s]
[0m10:54:46.970644 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:46.971093 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_loss
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_loss is null



  
  
      
    ) dbt_internal_test
[0m10:54:46.971555 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m10:54:46.972196 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m10:54:46.979895 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m10:54:46.981081 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m10:54:46.981976 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m10:54:46.983188 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m10:54:46.984928 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_sma"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m10:54:46.984105 [info ] [Thread-4 (]: 90 of 124 START test accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis  [RUN]
[0m10:54:46.987072 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416, now test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47)
[0m10:54:46.988089 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m10:54:46.988718 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m10:54:46.994224 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m10:54:47.006066 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m10:54:47.008643 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m10:54:47.010080 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m10:54:47.015114 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m10:54:47.016296 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: BEGIN
[0m10:54:47.017558 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:47.019565 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m10:54:47.020377 [debug] [Thread-4 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: BEGIN
[0m10:54:47.021322 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m10:54:47.022006 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:47.022622 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m10:54:47.023778 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_sma"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m10:54:47.025165 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m10:54:47.025678 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m10:54:47.026096 [debug] [Thread-4 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regime as value_field,
        count(*) as n_records

    from "finance"."analytics_dev"."int__regime_changes"
    group by regime

)

select *
from all_values
where value_field not in (
    'complacent','normal','elevated','crisis'
)



  
  
      
    ) dbt_internal_test
[0m10:54:47.029526 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m10:54:47.031940 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: ROLLBACK
[0m10:54:47.032641 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0'
[0m10:54:47.033088 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: Close
[0m10:54:47.033802 [info ] [Thread-3 (]: 89 of 124 PASS not_null_int__rsi_sma_trade_date ................................ [[32mPASS[0m in 0.06s]
[0m10:54:47.034637 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m10:54:47.035084 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m10:54:47.035465 [info ] [Thread-3 (]: 91 of 124 START test dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0  [RUN]
[0m10:54:47.036088 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4)
[0m10:54:47.036483 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m10:54:47.040983 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m10:54:47.042241 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m10:54:47.044674 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m10:54:47.045710 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m10:54:47.046132 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: BEGIN
[0m10:54:47.046485 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:47.047729 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:54:47.048141 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m10:54:47.048521 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_changes"

where not(days_in_regime >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:47.076643 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m10:54:47.077439 [debug] [Thread-2 (]: SQL status: OK in 0.091 seconds
[0m10:54:47.079391 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: ROLLBACK
[0m10:54:47.080151 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6'
[0m10:54:47.080574 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: Close
[0m10:54:47.082215 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: ROLLBACK
[0m10:54:47.083601 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d'
[0m10:54:47.084015 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: Close
[0m10:54:47.082905 [info ] [Thread-1 (]: 87 of 124 PASS not_null_int__rsi_sma_sma_loss .................................. [[32mPASS[0m in 0.15s]
[0m10:54:47.084742 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m10:54:47.085213 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m10:54:47.085591 [info ] [Thread-1 (]: 92 of 124 START test dbt_utils_expression_is_true_int__regime_changes_start_date___end_date  [RUN]
[0m10:54:47.086220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974)
[0m10:54:47.086621 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m10:54:47.091001 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m10:54:47.091661 [info ] [Thread-2 (]: 88 of 124 PASS not_null_int__rsi_sma_ticker .................................... [[32mPASS[0m in 0.15s]
[0m10:54:47.092511 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m10:54:47.092972 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m10:54:47.093708 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m10:54:47.093351 [info ] [Thread-2 (]: 93 of 124 START test not_null_int__regime_changes_days_in_regime ............... [RUN]
[0m10:54:47.096971 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m10:54:47.097526 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d, now test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0)
[0m10:54:47.098139 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m10:54:47.102253 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m10:54:47.103114 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m10:54:47.103553 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: BEGIN
[0m10:54:47.103932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:47.104765 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m10:54:47.107467 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m10:54:47.108119 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:54:47.108583 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m10:54:47.109009 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_changes"

where not(start_date <= end_date)


  
  
      
    ) dbt_internal_test
[0m10:54:47.109949 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m10:54:47.110498 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: BEGIN
[0m10:54:47.111220 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:47.112710 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:54:47.113160 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m10:54:47.113552 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select days_in_regime
from "finance"."analytics_dev"."int__regime_changes"
where days_in_regime is null



  
  
      
    ) dbt_internal_test
[0m10:54:47.122656 [debug] [Thread-4 (]: SQL status: OK in 0.096 seconds
[0m10:54:47.123124 [debug] [Thread-3 (]: SQL status: OK in 0.074 seconds
[0m10:54:47.125481 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: ROLLBACK
[0m10:54:47.126126 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4'
[0m10:54:47.126507 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: Close
[0m10:54:47.127947 [debug] [Thread-4 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: ROLLBACK
[0m10:54:47.129343 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47'
[0m10:54:47.129782 [debug] [Thread-4 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: Close
[0m10:54:47.128593 [info ] [Thread-3 (]: 91 of 124 PASS dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0  [[32mPASS[0m in 0.09s]
[0m10:54:47.130564 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m10:54:47.131088 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m10:54:47.131458 [info ] [Thread-3 (]: 94 of 124 START test not_null_int__regime_changes_end_date ..................... [RUN]
[0m10:54:47.132664 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4, now test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755)
[0m10:54:47.133060 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m10:54:47.137046 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m10:54:47.131999 [info ] [Thread-4 (]: 90 of 124 PASS accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis  [[32mPASS[0m in 0.15s]
[0m10:54:47.138079 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m10:54:47.138502 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m10:54:47.138883 [info ] [Thread-4 (]: 95 of 124 START test not_null_int__regime_changes_regime ....................... [RUN]
[0m10:54:47.139518 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47, now test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006)
[0m10:54:47.139895 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m10:54:47.143875 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m10:54:47.144981 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m10:54:47.148358 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m10:54:47.148944 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m10:54:47.151409 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m10:54:47.152237 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m10:54:47.152695 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: BEGIN
[0m10:54:47.153078 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:47.153737 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m10:54:47.154138 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: BEGIN
[0m10:54:47.154478 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:47.155100 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:54:47.155500 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m10:54:47.156294 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select end_date
from "finance"."analytics_dev"."int__regime_changes"
where end_date is null



  
  
      
    ) dbt_internal_test
[0m10:54:47.157461 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m10:54:47.158173 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m10:54:47.158866 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select regime
from "finance"."analytics_dev"."int__regime_changes"
where regime is null



  
  
      
    ) dbt_internal_test
[0m10:54:47.184412 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m10:54:47.186990 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: ROLLBACK
[0m10:54:47.187638 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974'
[0m10:54:47.188044 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: Close
[0m10:54:47.188988 [info ] [Thread-1 (]: 92 of 124 PASS dbt_utils_expression_is_true_int__regime_changes_start_date___end_date  [[32mPASS[0m in 0.10s]
[0m10:54:47.189944 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m10:54:47.190376 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m10:54:47.190741 [info ] [Thread-1 (]: 96 of 124 START test not_null_int__regime_changes_regime_period_id ............. [RUN]
[0m10:54:47.191369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974, now test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257)
[0m10:54:47.191756 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m10:54:47.196062 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m10:54:47.196522 [debug] [Thread-2 (]: SQL status: OK in 0.083 seconds
[0m10:54:47.197478 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m10:54:47.199823 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m10:54:47.201310 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: ROLLBACK
[0m10:54:47.201957 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0'
[0m10:54:47.202319 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: Close
[0m10:54:47.202936 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m10:54:47.203338 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: BEGIN
[0m10:54:47.203709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:47.204934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:47.205298 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m10:54:47.205670 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select regime_period_id
from "finance"."analytics_dev"."int__regime_changes"
where regime_period_id is null



  
  
      
    ) dbt_internal_test
[0m10:54:47.204460 [info ] [Thread-2 (]: 93 of 124 PASS not_null_int__regime_changes_days_in_regime ..................... [[32mPASS[0m in 0.11s]
[0m10:54:47.206555 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m10:54:47.206981 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m10:54:47.207378 [info ] [Thread-2 (]: 97 of 124 START test not_null_int__regime_changes_start_date ................... [RUN]
[0m10:54:47.208040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0, now test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7)
[0m10:54:47.208432 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m10:54:47.212579 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m10:54:47.213955 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m10:54:47.216360 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m10:54:47.217487 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m10:54:47.217879 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: BEGIN
[0m10:54:47.218217 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:47.219417 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:54:47.219791 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m10:54:47.220150 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select start_date
from "finance"."analytics_dev"."int__regime_changes"
where start_date is null



  
  
      
    ) dbt_internal_test
[0m10:54:47.258644 [debug] [Thread-3 (]: SQL status: OK in 0.101 seconds
[0m10:54:47.259186 [debug] [Thread-4 (]: SQL status: OK in 0.100 seconds
[0m10:54:47.266585 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: ROLLBACK
[0m10:54:47.267240 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755'
[0m10:54:47.267603 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: Close
[0m10:54:47.268958 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: ROLLBACK
[0m10:54:47.269628 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006'
[0m10:54:47.269989 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: Close
[0m10:54:47.270571 [info ] [Thread-3 (]: 94 of 124 PASS not_null_int__regime_changes_end_date ........................... [[32mPASS[0m in 0.14s]
[0m10:54:47.271802 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m10:54:47.272223 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m10:54:47.271110 [info ] [Thread-4 (]: 95 of 124 PASS not_null_int__regime_changes_regime ............................. [[32mPASS[0m in 0.13s]
[0m10:54:47.273449 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m10:54:47.273868 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m10:54:47.272617 [info ] [Thread-3 (]: 98 of 124 START test unique_int__regime_changes_regime_period_id ............... [RUN]
[0m10:54:47.275043 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755, now test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1)
[0m10:54:47.275437 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m10:54:47.279364 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m10:54:47.274366 [info ] [Thread-4 (]: 99 of 124 START sql view model analytics_dev.int__rsi_wilder ................... [RUN]
[0m10:54:47.280254 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006, now model.portfolio_project_2.int__rsi_wilder)
[0m10:54:47.280676 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m10:54:47.284232 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m10:54:47.284905 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m10:54:47.287518 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m10:54:47.288263 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m10:54:47.291498 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m10:54:47.292215 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m10:54:47.292630 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: BEGIN
[0m10:54:47.293000 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:47.293958 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m10:54:47.294797 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m10:54:47.295348 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:47.296106 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m10:54:47.296680 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m10:54:47.297097 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    regime_period_id as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."int__regime_changes"
where regime_period_id is not null
group by regime_period_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:54:47.297695 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m10:54:47.298089 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m10:54:47.298498 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    wilder_gain::decimal(18,2) as wilder_gain,
    wilder_loss::decimal(18,2) as wilder_loss
from wilder
  );

[0m10:54:47.301160 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m10:54:47.303573 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: ROLLBACK
[0m10:54:47.304247 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257'
[0m10:54:47.304624 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: Close
[0m10:54:47.305480 [info ] [Thread-1 (]: 96 of 124 PASS not_null_int__regime_changes_regime_period_id ................... [[32mPASS[0m in 0.11s]
[0m10:54:47.306289 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m10:54:47.324260 [debug] [Thread-2 (]: SQL status: OK in 0.104 seconds
[0m10:54:47.326541 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: ROLLBACK
[0m10:54:47.327146 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7'
[0m10:54:47.327524 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: Close
[0m10:54:47.328508 [info ] [Thread-2 (]: 97 of 124 PASS not_null_int__regime_changes_start_date ......................... [[32mPASS[0m in 0.12s]
[0m10:54:47.329346 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m10:54:47.380712 [debug] [Thread-3 (]: SQL status: OK in 0.083 seconds
[0m10:54:47.383423 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: ROLLBACK
[0m10:54:47.383860 [debug] [Thread-4 (]: SQL status: OK in 0.085 seconds
[0m10:54:47.386995 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m10:54:47.387373 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m10:54:47.387951 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1'
[0m10:54:47.388345 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: Close
[0m10:54:47.389367 [info ] [Thread-3 (]: 98 of 124 PASS unique_int__regime_changes_regime_period_id ..................... [[32mPASS[0m in 0.11s]
[0m10:54:47.390185 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m10:54:47.390871 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:54:47.391366 [info ] [Thread-1 (]: 100 of 124 START sql incremental model analytics_dev.mrt__stocks_with_regimes .. [RUN]
[0m10:54:47.391952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m10:54:47.392468 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:54:47.396816 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:54:47.398088 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:54:47.402132 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:54:47.402526 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__4f50fc80511a" cascade
    
[0m10:54:47.402877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:47.444579 [debug] [Thread-4 (]: SQL status: OK in 0.057 seconds
[0m10:54:47.445960 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m10:54:47.446356 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m10:54:47.446700 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m10:54:47.463729 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m10:54:47.490020 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:54:47.490455 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m10:54:47.492050 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:47.493381 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:54:47.493735 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m10:54:47.494692 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:47.495047 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:54:47.495393 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m10:54:47.580939 [debug] [Thread-4 (]: SQL status: OK in 0.134 seconds
[0m10:54:47.583592 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m10:54:47.583972 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m10:54:47.618538 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m10:54:47.619646 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:54:47.620005 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m10:54:47.620428 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:54:47.621496 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m10:54:47.621854 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:54:47.622192 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m10:54:47.626318 [debug] [Thread-4 (]: SQL status: OK in 0.042 seconds
[0m10:54:47.627729 [debug] [Thread-4 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m10:54:47.628231 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015726246090>]}
[0m10:54:47.628801 [info ] [Thread-4 (]: 99 of 124 OK created sql view model analytics_dev.int__rsi_wilder .............. [[32mOK[0m in 0.35s]
[0m10:54:47.629593 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m10:54:47.630408 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m10:54:47.631193 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m10:54:47.630822 [info ] [Thread-2 (]: 101 of 124 START test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 .... [RUN]
[0m10:54:47.632126 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m10:54:47.632619 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90)
[0m10:54:47.631745 [info ] [Thread-4 (]: 103 of 124 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [RUN]
[0m10:54:47.633614 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m10:54:47.634122 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_wilder, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7)
[0m10:54:47.633083 [info ] [Thread-3 (]: 102 of 124 START test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 .... [RUN]
[0m10:54:47.638760 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m10:54:47.639364 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m10:54:47.639916 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703)
[0m10:54:47.644476 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m10:54:47.645262 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m10:54:47.649830 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m10:54:47.650661 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m10:54:47.653514 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m10:54:47.653970 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m10:54:47.656560 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m10:54:47.657651 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m10:54:47.661837 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m10:54:47.664125 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m10:54:47.664578 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: BEGIN
[0m10:54:47.664947 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:47.666073 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m10:54:47.666753 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m10:54:47.667253 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: BEGIN
[0m10:54:47.667737 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m10:54:47.668211 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m10:54:47.677020 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:54:47.677522 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:47.678027 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: BEGIN
[0m10:54:47.678480 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m10:54:47.678996 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,2) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:54:47.679785 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:47.680254 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:47.681206 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m10:54:47.681806 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m10:54:47.682211 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:47.682704 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m10:54:47.683319 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m10:54:47.683728 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:47.684662 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:54:47.701025 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:54:47.701489 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,2))
 as volume, 
      
    cast(null as text)
 as regime, 
      
    cast(null as int)
 as regime_period_id
    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:54:47.703094 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:47.729313 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:54:47.730592 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:54:47.731010 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m10:54:47.732205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:47.732589 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:54:47.733010 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,2) not null,
    regime text not null,
    regime_period_id int unique not null
    
    )
 ;
    insert into "finance"."analytics_dev"."mrt__stocks_with_regimes" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime ,
    
      
      regime_period_id 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime, regime_period_id
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,2) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m10:54:48.016365 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,2) not null,
    regime text not null,
    regime_period_id int unique not null
    
    )
 ;
    insert into "finance"."analytics_dev"."mrt__stocks_with_regimes" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime ,
    
      
      regime_period_id 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime, regime_period_id
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,2) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m10:54:48.017074 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:54:48.020427 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:54:48.020884 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__4f50fc80511a" cascade
    
[0m10:54:48.022990 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__4f50fc80511a" cascade
    
[0m10:54:48.023505 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:54:48.023973 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: ROLLBACK
[0m10:54:48.036390 [debug] [Thread-1 (]: Failed to rollback 'model.portfolio_project_2.mrt__stocks_with_regimes'
[0m10:54:48.036854 [debug] [Thread-1 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m10:54:48.045682 [debug] [Thread-1 (]: Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK)
[0m10:54:48.046158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572468DD90>]}
[0m10:54:48.046733 [error] [Thread-1 (]: 100 of 124 ERROR creating sql incremental model analytics_dev.mrt__stocks_with_regimes  [[31mERROR[0m in 0.65s]
[0m10:54:48.047527 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:54:48.047937 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m10:54:48.048882 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.mrt__stocks_with_regimes' to be skipped because of status 'error'.  Reason: Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK).
[0m10:54:48.048321 [info ] [Thread-1 (]: 104 of 124 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [RUN]
[0m10:54:48.049856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.mrt__stocks_with_regimes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d)
[0m10:54:48.050237 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m10:54:48.053914 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m10:54:48.063297 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m10:54:48.069200 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m10:54:48.070209 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m10:54:48.070627 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: BEGIN
[0m10:54:48.070960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:48.072212 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:48.072588 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m10:54:48.072966 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:48.857585 [debug] [Thread-2 (]: SQL status: OK in 1.176 seconds
[0m10:54:48.860697 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: ROLLBACK
[0m10:54:48.861487 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90'
[0m10:54:48.861948 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: Close
[0m10:54:48.862933 [info ] [Thread-2 (]: 101 of 124 PASS dbt_utils_expression_is_true_int__rsi_wilder_gain___0 .......... [[32mPASS[0m in 1.23s]
[0m10:54:48.863743 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m10:54:48.864148 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m10:54:48.864528 [info ] [Thread-2 (]: 105 of 124 START test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [RUN]
[0m10:54:48.865111 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95)
[0m10:54:48.865469 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m10:54:48.869290 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m10:54:48.870466 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m10:54:48.948181 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m10:54:48.949016 [debug] [Thread-4 (]: SQL status: OK in 1.265 seconds
[0m10:54:48.949953 [debug] [Thread-3 (]: SQL status: OK in 1.267 seconds
[0m10:54:48.951390 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m10:54:48.953218 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: ROLLBACK
[0m10:54:48.953748 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: BEGIN
[0m10:54:48.955371 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: ROLLBACK
[0m10:54:48.956230 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703'
[0m10:54:48.956720 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:48.957480 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7'
[0m10:54:48.957941 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: Close
[0m10:54:48.958717 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: Close
[0m10:54:48.959423 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m10:54:48.959864 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m10:54:48.960324 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_wilder"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:54:48.961001 [info ] [Thread-4 (]: 103 of 124 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0 ... [[32mPASS[0m in 1.33s]
[0m10:54:48.962604 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m10:54:48.963076 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m10:54:48.961593 [info ] [Thread-3 (]: 102 of 124 PASS dbt_utils_expression_is_true_int__rsi_wilder_loss___0 .......... [[32mPASS[0m in 1.32s]
[0m10:54:48.964544 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m10:54:48.965011 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m10:54:48.963528 [info ] [Thread-4 (]: 106 of 124 START test not_null_int__rsi_wilder_gain ............................ [RUN]
[0m10:54:48.966167 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7, now test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda)
[0m10:54:48.966602 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m10:54:48.970972 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m10:54:48.965429 [info ] [Thread-3 (]: 107 of 124 START test not_null_int__rsi_wilder_loss ............................ [RUN]
[0m10:54:48.972005 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703, now test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56)
[0m10:54:48.972764 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m10:54:48.977300 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m10:54:48.978231 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m10:54:48.981234 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m10:54:48.981993 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m10:54:48.984207 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m10:54:48.985005 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m10:54:48.985405 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: BEGIN
[0m10:54:48.985769 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:48.986475 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m10:54:48.986866 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: BEGIN
[0m10:54:48.987226 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:48.987803 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m10:54:48.988188 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m10:54:48.988567 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_wilder"
where gain is null



  
  
      
    ) dbt_internal_test
[0m10:54:48.989118 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:54:48.989538 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m10:54:48.989989 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_wilder"
where loss is null



  
  
      
    ) dbt_internal_test
[0m10:54:49.275277 [debug] [Thread-1 (]: SQL status: OK in 1.201 seconds
[0m10:54:49.287626 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: ROLLBACK
[0m10:54:49.290441 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d'
[0m10:54:49.292189 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: Close
[0m10:54:49.296188 [info ] [Thread-1 (]: 104 of 124 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0 ... [[32mPASS[0m in 1.25s]
[0m10:54:49.299160 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m10:54:49.300440 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m10:54:49.301869 [info ] [Thread-1 (]: 108 of 124 START test not_null_int__rsi_wilder_rn .............................. [RUN]
[0m10:54:49.303564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d, now test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d)
[0m10:54:49.304477 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m10:54:49.312800 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m10:54:49.314408 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m10:54:49.318454 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m10:54:49.319692 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m10:54:49.320200 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: BEGIN
[0m10:54:49.320667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:49.322190 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:49.322682 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m10:54:49.323176 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_wilder"
where rn is null



  
  
      
    ) dbt_internal_test
[0m10:54:50.172217 [debug] [Thread-2 (]: SQL status: OK in 1.210 seconds
[0m10:54:50.173191 [debug] [Thread-4 (]: SQL status: OK in 1.184 seconds
[0m10:54:50.177923 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: ROLLBACK
[0m10:54:50.179321 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: ROLLBACK
[0m10:54:50.179986 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95'
[0m10:54:50.180341 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: Close
[0m10:54:50.180852 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda'
[0m10:54:50.181224 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: Close
[0m10:54:50.182132 [info ] [Thread-2 (]: 105 of 124 PASS dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[32mPASS[0m in 1.32s]
[0m10:54:50.183313 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m10:54:50.184161 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m10:54:50.182643 [info ] [Thread-4 (]: 106 of 124 PASS not_null_int__rsi_wilder_gain .................................. [[32mPASS[0m in 1.22s]
[0m10:54:50.185558 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m10:54:50.185973 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m10:54:50.184539 [info ] [Thread-2 (]: 109 of 124 START test not_null_int__rsi_wilder_ticker .......................... [RUN]
[0m10:54:50.187028 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95, now test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd)
[0m10:54:50.187423 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m10:54:50.191227 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m10:54:50.186358 [info ] [Thread-4 (]: 110 of 124 START test not_null_int__rsi_wilder_trade_date ...................... [RUN]
[0m10:54:50.192019 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda, now test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c)
[0m10:54:50.192424 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m10:54:50.196960 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m10:54:50.197591 [debug] [Thread-3 (]: SQL status: OK in 1.207 seconds
[0m10:54:50.198205 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m10:54:50.200601 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m10:54:50.202409 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: ROLLBACK
[0m10:54:50.203259 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56'
[0m10:54:50.203648 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: Close
[0m10:54:50.204062 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m10:54:50.206305 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m10:54:50.207067 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m10:54:50.207488 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: BEGIN
[0m10:54:50.207862 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:50.209211 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m10:54:50.209679 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: BEGIN
[0m10:54:50.210067 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:50.208719 [info ] [Thread-3 (]: 107 of 124 PASS not_null_int__rsi_wilder_loss .................................. [[32mPASS[0m in 1.24s]
[0m10:54:50.210971 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m10:54:50.211360 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m10:54:50.212151 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m10:54:50.212742 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m10:54:50.213284 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_wilder"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m10:54:50.211715 [info ] [Thread-3 (]: 111 of 124 START test not_null_int__rsi_wilder_wilder_gain ..................... [RUN]
[0m10:54:50.214545 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9)
[0m10:54:50.215180 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m10:54:50.215843 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m10:54:50.216582 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m10:54:50.221346 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m10:54:50.221863 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_wilder"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m10:54:50.222913 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m10:54:50.225127 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m10:54:50.226048 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m10:54:50.226451 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: BEGIN
[0m10:54:50.226797 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:50.228426 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:54:50.229064 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m10:54:50.229507 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_gain
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_gain is null



  
  
      
    ) dbt_internal_test
[0m10:54:50.503832 [debug] [Thread-1 (]: SQL status: OK in 1.180 seconds
[0m10:54:50.507426 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: ROLLBACK
[0m10:54:50.508337 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d'
[0m10:54:50.508681 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: Close
[0m10:54:50.509569 [info ] [Thread-1 (]: 108 of 124 PASS not_null_int__rsi_wilder_rn .................................... [[32mPASS[0m in 1.21s]
[0m10:54:50.510350 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m10:54:50.510754 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m10:54:50.511132 [info ] [Thread-1 (]: 112 of 124 START test not_null_int__rsi_wilder_wilder_loss ..................... [RUN]
[0m10:54:50.511722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb)
[0m10:54:50.512076 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m10:54:50.516910 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m10:54:50.517837 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m10:54:50.520202 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m10:54:50.521082 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m10:54:50.521447 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: BEGIN
[0m10:54:50.521781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:50.523010 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:54:50.523386 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m10:54:50.523769 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_loss is null



  
  
      
    ) dbt_internal_test
[0m10:54:51.425706 [debug] [Thread-3 (]: SQL status: OK in 1.196 seconds
[0m10:54:51.426876 [debug] [Thread-2 (]: SQL status: OK in 1.213 seconds
[0m10:54:51.428155 [debug] [Thread-4 (]: SQL status: OK in 1.205 seconds
[0m10:54:51.433095 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: ROLLBACK
[0m10:54:51.434525 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: ROLLBACK
[0m10:54:51.435141 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd'
[0m10:54:51.435520 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: Close
[0m10:54:51.436799 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: ROLLBACK
[0m10:54:51.437357 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c'
[0m10:54:51.437705 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: Close
[0m10:54:51.439415 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9'
[0m10:54:51.439831 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: Close
[0m10:54:51.438264 [info ] [Thread-2 (]: 109 of 124 PASS not_null_int__rsi_wilder_ticker ................................ [[32mPASS[0m in 1.25s]
[0m10:54:51.440563 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m10:54:51.440982 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m10:54:51.438914 [info ] [Thread-4 (]: 110 of 124 PASS not_null_int__rsi_wilder_trade_date ............................ [[32mPASS[0m in 1.25s]
[0m10:54:51.442732 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m10:54:51.443135 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m10:54:51.441367 [info ] [Thread-2 (]: 113 of 124 START test wilder_seed_equals_sma ................................... [RUN]
[0m10:54:51.444237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd, now test.portfolio_project_2.wilder_seed_equals_sma)
[0m10:54:51.444815 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.wilder_seed_equals_sma
[0m10:54:51.449401 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m10:54:51.442011 [info ] [Thread-3 (]: 111 of 124 PASS not_null_int__rsi_wilder_wilder_gain ........................... [[32mPASS[0m in 1.23s]
[0m10:54:51.451096 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m10:54:51.451908 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m10:54:51.443549 [info ] [Thread-4 (]: 114 of 124 SKIP test accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis  [[33mSKIP[0m]
[0m10:54:51.453278 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m10:54:51.453783 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m10:54:51.454185 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8' to be skipped because of status 'skipped'. 
[0m10:54:51.455338 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.wilder_seed_equals_sma
[0m10:54:51.452458 [info ] [Thread-3 (]: 115 of 124 SKIP test dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0  [[33mSKIP[0m]
[0m10:54:51.458142 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m10:54:51.458712 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m10:54:51.454717 [info ] [Thread-4 (]: 116 of 124 SKIP test dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date  [[33mSKIP[0m]
[0m10:54:51.459626 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m10:54:51.460136 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m10:54:51.460526 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b' to be skipped because of status 'skipped'. 
[0m10:54:51.461531 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m10:54:51.461051 [info ] [Thread-3 (]: 117 of 124 SKIP test dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0  [[33mSKIP[0m]
[0m10:54:51.462219 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf' to be skipped because of status 'skipped'. 
[0m10:54:51.462901 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m10:54:51.464011 [info ] [Thread-4 (]: 118 of 124 SKIP test dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker  [[33mSKIP[0m]
[0m10:54:51.464974 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m10:54:51.465999 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: BEGIN
[0m10:54:51.466511 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m10:54:51.467018 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_src_stocks_.8614ae4764
[0m10:54:51.467467 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:51.467853 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe' to be skipped because of status 'skipped'. 
[0m10:54:51.468404 [info ] [Thread-3 (]: 119 of 124 SKIP test relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_src_stocks_  [[33mSKIP[0m]
[0m10:54:51.469218 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de' to be skipped because of status 'skipped'. 
[0m10:54:51.469962 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_src_stocks_.8614ae4764
[0m10:54:51.470743 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m10:54:51.471327 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m10:54:51.471707 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_src_stocks_.8614ae4764' to be skipped because of status 'skipped'. 
[0m10:54:51.472179 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.wilder_seed_equals_sma"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- asserts the seed matches SMA at rn=14
with w as (
  select ticker, trade_date, wilder_gain, wilder_loss
  from "finance"."analytics_dev"."int__rsi_wilder"
  where rn = 14
),
s as (
  select ticker, trade_date, sma_gain, sma_loss
  from "finance"."analytics_dev"."int__rsi_sma"
  where rn = 14
)
select
  w.ticker,
  w.trade_date
from w
join s using (ticker, trade_date)
where abs(w.wilder_gain - s.sma_gain) > 1e-9
   or abs(w.wilder_loss - s.sma_loss) > 1e-9
  
  
      
    ) dbt_internal_test
[0m10:54:51.862141 [debug] [Thread-1 (]: SQL status: OK in 1.338 seconds
[0m10:54:51.867587 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: ROLLBACK
[0m10:54:51.868237 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb'
[0m10:54:51.868708 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: Close
[0m10:54:51.869696 [info ] [Thread-1 (]: 112 of 124 PASS not_null_int__rsi_wilder_wilder_loss ........................... [[32mPASS[0m in 1.36s]
[0m10:54:51.870524 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m10:54:52.756031 [debug] [Thread-2 (]: SQL status: OK in 1.283 seconds
[0m10:54:52.768794 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: ROLLBACK
[0m10:54:52.771368 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.wilder_seed_equals_sma'
[0m10:54:52.772820 [debug] [Thread-2 (]: On test.portfolio_project_2.wilder_seed_equals_sma: Close
[0m10:54:52.775410 [info ] [Thread-2 (]: 113 of 124 PASS wilder_seed_equals_sma ......................................... [[32mPASS[0m in 1.33s]
[0m10:54:52.777789 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m10:54:52.779268 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.fct__rsi
[0m10:54:52.780448 [info ] [Thread-4 (]: 120 of 124 START sql view model analytics_dev.fct__rsi ......................... [RUN]
[0m10:54:52.781780 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c, now model.portfolio_project_2.fct__rsi)
[0m10:54:52.782850 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m10:54:52.788635 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m10:54:52.790444 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m10:54:52.796195 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m10:54:52.796892 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:54:52.797468 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:52.807128 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m10:54:52.811870 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m10:54:52.812348 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as sma_rs, 
      
    cast(null as decimal(18,2))
 as sma_rsi, 
      
    cast(null as decimal(18,2))
 as wilder_rs, 
      
    cast(null as decimal(18,2))
 as wilder_rsi
    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:54:52.813924 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:54:52.816930 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m10:54:52.818032 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m10:54:52.818446 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m10:54:52.819644 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:54:52.820020 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m10:54:52.820431 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
    
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
  );

[0m10:54:53.094962 [debug] [Thread-4 (]: SQL status: OK in 0.274 seconds
[0m10:54:53.102792 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m10:54:53.103300 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
alter view "finance"."analytics_dev"."fct__rsi__dbt_tmp" rename to "fct__rsi"
[0m10:54:53.169860 [debug] [Thread-4 (]: SQL status: OK in 0.066 seconds
[0m10:54:53.172635 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m10:54:53.173423 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m10:54:53.174102 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m10:54:53.295825 [debug] [Thread-4 (]: SQL status: OK in 0.121 seconds
[0m10:54:53.298771 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m10:54:53.299359 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop view if exists "finance"."analytics_dev"."fct__rsi__dbt_backup" cascade
    
[0m10:54:53.343527 [debug] [Thread-4 (]: SQL status: OK in 0.044 seconds
[0m10:54:53.344940 [debug] [Thread-4 (]: On model.portfolio_project_2.fct__rsi: Close
[0m10:54:53.345479 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb070591-76e5-43ef-8801-2d9b6e84cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015727AA99D0>]}
[0m10:54:53.346064 [info ] [Thread-4 (]: 120 of 124 OK created sql view model analytics_dev.fct__rsi .................... [[32mOK[0m in 0.56s]
[0m10:54:53.346920 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m10:54:53.347643 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m10:54:53.348048 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m10:54:53.348474 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m10:54:53.348984 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m10:54:53.349396 [info ] [Thread-2 (]: 123 of 124 START test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ......... [RUN]
[0m10:54:53.350042 [info ] [Thread-1 (]: 122 of 124 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [RUN]
[0m10:54:53.350446 [info ] [Thread-4 (]: 124 of 124 START test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ...... [RUN]
[0m10:54:53.351606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.wilder_seed_equals_sma, now test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a)
[0m10:54:53.352286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb, now test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2)
[0m10:54:53.351020 [info ] [Thread-3 (]: 121 of 124 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [RUN]
[0m10:54:53.353014 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.fct__rsi, now test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0)
[0m10:54:53.353543 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m10:54:53.354042 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m10:54:53.354558 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9, now test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a)
[0m10:54:53.355039 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m10:54:53.360793 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m10:54:53.365911 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m10:54:53.366451 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m10:54:53.371052 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m10:54:53.376547 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m10:54:53.380348 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m10:54:53.385645 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m10:54:53.386676 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m10:54:53.387279 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m10:54:53.387758 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m10:54:53.390436 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m10:54:53.392788 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m10:54:53.395246 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m10:54:53.395972 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m10:54:53.396668 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: BEGIN
[0m10:54:53.397055 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:54:53.398381 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m10:54:53.398833 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: BEGIN
[0m10:54:53.399212 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:53.399812 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m10:54:53.400228 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m10:54:53.400664 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m10:54:53.401108 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where sma_rs is not null) dbt_subquery

where not(sma_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:53.401577 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m10:54:53.401980 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: BEGIN
[0m10:54:53.402388 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m10:54:53.403070 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: BEGIN
[0m10:54:53.403461 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:53.403900 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m10:54:53.404322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:53.404928 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and sma_rsi >= 0 and sma_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m10:54:53.405522 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m10:54:53.406158 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m10:54:53.406558 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where wilder_rs is not null) dbt_subquery

where not(wilder_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m10:54:53.407112 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:54:53.407503 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m10:54:53.407925 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and wilder_rsi >= 0 and wilder_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m10:54:54.741033 [debug] [Thread-2 (]: SQL status: OK in 1.338 seconds
[0m10:54:54.743780 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: ROLLBACK
[0m10:54:54.744498 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a'
[0m10:54:54.744931 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: Close
[0m10:54:54.746015 [info ] [Thread-2 (]: 123 of 124 PASS dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............... [[32mPASS[0m in 1.39s]
[0m10:54:54.746965 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m10:54:54.764046 [debug] [Thread-3 (]: SQL status: OK in 1.358 seconds
[0m10:54:54.764550 [debug] [Thread-4 (]: SQL status: OK in 1.358 seconds
[0m10:54:54.767415 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: ROLLBACK
[0m10:54:54.769194 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: ROLLBACK
[0m10:54:54.769940 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0'
[0m10:54:54.770663 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a'
[0m10:54:54.771095 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: Close
[0m10:54:54.771587 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: Close
[0m10:54:54.772679 [info ] [Thread-3 (]: 121 of 124 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[32mPASS[0m in 1.42s]
[0m10:54:54.774079 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m10:54:54.773305 [info ] [Thread-4 (]: 124 of 124 PASS dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ............ [[32mPASS[0m in 1.42s]
[0m10:54:54.775170 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m10:54:54.782369 [debug] [Thread-1 (]: SQL status: OK in 1.374 seconds
[0m10:54:54.785537 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: ROLLBACK
[0m10:54:54.786361 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2'
[0m10:54:54.786830 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: Close
[0m10:54:54.787845 [info ] [Thread-1 (]: 122 of 124 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[32mPASS[0m in 1.44s]
[0m10:54:54.788683 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m10:54:54.790293 [debug] [MainThread]: Using duckdb connection "master"
[0m10:54:54.790650 [debug] [MainThread]: On master: BEGIN
[0m10:54:54.790952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:54:54.792134 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:54:54.792484 [debug] [MainThread]: On master: COMMIT
[0m10:54:54.792793 [debug] [MainThread]: Using duckdb connection "master"
[0m10:54:54.793084 [debug] [MainThread]: On master: COMMIT
[0m10:54:54.793822 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:54:54.794144 [debug] [MainThread]: On master: Close
[0m10:54:54.794628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:54.794931 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m10:54:54.795204 [debug] [MainThread]: Connection 'create_finance_analytics_dev_snapshots' was properly closed.
[0m10:54:54.795474 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m10:54:54.795747 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m10:54:54.796018 [debug] [MainThread]: Connection 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2' was properly closed.
[0m10:54:54.796356 [debug] [MainThread]: Connection 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a' was properly closed.
[0m10:54:54.796626 [debug] [MainThread]: Connection 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a' was properly closed.
[0m10:54:54.796899 [debug] [MainThread]: Connection 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0' was properly closed.
[0m10:54:54.797375 [info ] [MainThread]: 
[0m10:54:54.797877 [info ] [MainThread]: Finished running 1 incremental model, 1 seed, 1 snapshot, 111 data tests, 10 view models in 0 hours 0 minutes and 14.19 seconds (14.19s).
[0m10:54:54.816423 [debug] [MainThread]: Command end result
[0m10:54:54.883325 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m10:54:54.886036 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m10:54:54.896652 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m10:54:54.897083 [info ] [MainThread]: 
[0m10:54:54.897628 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:54:54.898122 [info ] [MainThread]: 
[0m10:54:54.898936 [error] [MainThread]: [31mFailure in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)[0m
[0m10:54:54.899591 [error] [MainThread]:   Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK)
[0m10:54:54.900041 [info ] [MainThread]: 
[0m10:54:54.900549 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\mrt__stocks_with_regimes.sql
[0m10:54:54.901111 [info ] [MainThread]: 
[0m10:54:54.901618 [info ] [MainThread]: Done. PASS=117 WARN=0 ERROR=1 SKIP=6 NO-OP=0 TOTAL=124
[0m10:54:54.902451 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:54:54.903448 [debug] [MainThread]: Command `-c build` failed at 10:54:54.903319 after 18.26 seconds
[0m10:54:54.903858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015723F544D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015729243CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157292439B0>]}
[0m10:54:54.904250 [debug] [MainThread]: Flushing usage events
[0m10:54:55.668576 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:57:46.891751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136D9698050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136D9EA42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DA4E3ED0>]}


============================== 10:57:46.896571 | 9ce9b30b-92b4-4867-8fb8-04e186689e4b ==============================
[0m10:57:46.896571 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:57:46.897351 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'invocation_command': 'dbt build --full-refresh', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m10:57:47.196487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136D9850180>]}
[0m10:57:47.274870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DA38B790>]}
[0m10:57:47.277819 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:57:47.559072 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:57:47.817945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:57:47.818371 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:57:47.898426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DB6A1D50>]}
[0m10:57:48.114395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m10:57:48.116932 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m10:57:48.171679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DBAE3C50>]}
[0m10:57:48.172159 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 1 snapshot, 2 sources, 853 macros
[0m10:57:48.185589 [info ] [MainThread]: 
[0m10:57:48.186210 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:57:48.186721 [info ] [MainThread]: 
[0m10:57:48.187417 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:57:48.193048 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m10:57:48.204456 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m10:57:48.274930 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m10:57:48.275338 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m10:57:48.275655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:48.276382 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m10:57:48.276717 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m10:57:48.277032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:49.649206 [debug] [ThreadPool]: SQL status: OK in 1.372 seconds
[0m10:57:49.649922 [debug] [ThreadPool]: SQL status: OK in 1.374 seconds
[0m10:57:49.652457 [debug] [ThreadPool]: On list_finance: Close
[0m10:57:49.654601 [debug] [ThreadPool]: On list_finance: Close
[0m10:57:49.655994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m10:57:49.656533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev_snapshots)
[0m10:57:49.657356 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m10:57:49.658268 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev_snapshots"
"
[0m10:57:49.671327 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:57:49.675243 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m10:57:49.675706 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m10:57:49.676156 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev_snapshots"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m10:57:49.676580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:49.677059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:49.679271 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:57:49.680004 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:57:49.682092 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m10:57:49.684838 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:57:49.686033 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: BEGIN
[0m10:57:49.686813 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m10:57:49.688148 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:57:49.688865 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:57:49.689277 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:57:49.689671 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m10:57:49.690125 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m10:57:49.690752 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev_snapshots"} */

    
    
        create schema if not exists "finance"."analytics_dev_snapshots"
    
[0m10:57:49.757087 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m10:57:49.758633 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: COMMIT
[0m10:57:49.759030 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev_snapshots"
[0m10:57:49.759329 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: COMMIT
[0m10:57:49.759833 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m10:57:49.760718 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m10:57:49.761050 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m10:57:49.761481 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m10:57:49.802178 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m10:57:49.802604 [debug] [ThreadPool]: On create_finance_analytics_dev_snapshots: Close
[0m10:57:49.865458 [debug] [ThreadPool]: SQL status: OK in 0.104 seconds
[0m10:57:49.865963 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m10:57:49.869073 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m10:57:49.876857 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m10:57:49.877561 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m10:57:49.877972 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m10:57:49.881208 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m10:57:49.881811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:49.882537 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m10:57:49.883998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:49.885358 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:57:49.886408 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m10:57:49.887107 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:57:49.887991 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m10:57:49.888868 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m10:57:49.889731 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m10:57:49.931403 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m10:57:49.932369 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m10:57:49.935863 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m10:57:49.938493 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m10:57:49.940328 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m10:57:49.940888 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m10:57:49.941665 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m10:57:49.942308 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m10:57:49.943753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DBA9A6D0>]}
[0m10:57:49.944295 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:49.944633 [debug] [MainThread]: On master: BEGIN
[0m10:57:49.944998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:49.946455 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:57:49.947211 [debug] [MainThread]: On master: COMMIT
[0m10:57:49.947550 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:49.947855 [debug] [MainThread]: On master: COMMIT
[0m10:57:49.948691 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:57:49.949145 [debug] [MainThread]: On master: Close
[0m10:57:49.959579 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m10:57:49.960179 [debug] [Thread-3 (]: Began running node seed.portfolio_project_2.regime_thresholds
[0m10:57:49.960683 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m10:57:49.961288 [info ] [Thread-1 (]: 1 of 124 START sql view model analytics_dev.src_stocks ......................... [RUN]
[0m10:57:49.962133 [info ] [Thread-3 (]: 3 of 124 START seed file analytics_dev.regime_thresholds ....................... [RUN]
[0m10:57:49.963309 [info ] [Thread-2 (]: 2 of 124 START sql view model analytics_dev.src_vix ............................ [RUN]
[0m10:57:49.964192 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m10:57:49.965337 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.portfolio_project_2.regime_thresholds'
[0m10:57:49.966406 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m10:57:49.967233 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m10:57:49.967902 [debug] [Thread-3 (]: Began compiling node seed.portfolio_project_2.regime_thresholds
[0m10:57:49.968489 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m10:57:49.980741 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m10:57:49.981994 [debug] [Thread-3 (]: Began executing node seed.portfolio_project_2.regime_thresholds
[0m10:57:49.994400 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m10:57:50.020926 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m10:57:50.034172 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m10:57:50.034856 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m10:57:50.063162 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m10:57:50.063628 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: BEGIN
[0m10:57:50.066886 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m10:57:50.067460 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:57:50.068605 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:57:50.069116 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m10:57:50.069552 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:57:50.069939 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:57:50.070406 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m10:57:50.071014 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:57:50.071767 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "seed.portfolio_project_2.regime_thresholds"} */

    create table "finance"."analytics_dev"."regime_thresholds" ("version_id" integer,"version_name" text,"complacent_max" integer,"normal_max" integer,"elevated_max" integer,"effective_date" date,"notes" text)
  
[0m10:57:50.072225 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m10:57:50.072772 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:57:50.073177 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:57:50.073589 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:57:50.074189 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m10:57:50.074863 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:57:50.075255 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:57:50.075641 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m10:57:50.147687 [debug] [Thread-3 (]: SQL status: OK in 0.075 seconds
[0m10:57:50.163231 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m10:57:50.163837 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: 
          COPY "finance"."analytics_dev"."regime_thresholds" FROM 'C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\seeds\regime_thresholds.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m10:57:50.179993 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m10:57:50.190509 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:57:50.191032 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m10:57:50.375280 [debug] [Thread-2 (]: SQL status: OK in 0.299 seconds
[0m10:57:50.379470 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:57:50.380063 [debug] [Thread-1 (]: SQL status: OK in 0.189 seconds
[0m10:57:50.381105 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m10:57:50.401793 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m10:57:50.403258 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:57:50.404051 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m10:57:50.470879 [debug] [Thread-2 (]: SQL status: OK in 0.068 seconds
[0m10:57:50.472475 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m10:57:50.472909 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:57:50.473256 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m10:57:50.479694 [debug] [Thread-3 (]: SQL status: OK in 0.315 seconds
[0m10:57:50.486593 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.portfolio_project_2.regime_thresholds"
[0m10:57:50.494408 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m10:57:50.494932 [debug] [Thread-3 (]: Using duckdb connection "seed.portfolio_project_2.regime_thresholds"
[0m10:57:50.495319 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: COMMIT
[0m10:57:50.557221 [debug] [Thread-2 (]: SQL status: OK in 0.084 seconds
[0m10:57:50.564622 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m10:57:50.565246 [debug] [Thread-1 (]: SQL status: OK in 0.160 seconds
[0m10:57:50.565756 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m10:57:50.568847 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m10:57:50.569656 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m10:57:50.639300 [debug] [Thread-3 (]: SQL status: OK in 0.143 seconds
[0m10:57:50.641206 [debug] [Thread-3 (]: On seed.portfolio_project_2.regime_thresholds: Close
[0m10:57:50.643244 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD8BE000>]}
[0m10:57:50.643804 [info ] [Thread-3 (]: 3 of 124 OK loaded seed file analytics_dev.regime_thresholds ................... [[32mCREATE 1[0m in 0.68s]
[0m10:57:50.644637 [debug] [Thread-3 (]: Finished running node seed.portfolio_project_2.regime_thresholds
[0m10:57:50.645579 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m10:57:50.646436 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.assert_regime_threshold_ordering
[0m10:57:50.646952 [info ] [Thread-3 (]: 5 of 124 START test not_null_regime_thresholds_effective_date .................. [RUN]
[0m10:57:50.647934 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.portfolio_project_2.regime_thresholds, now test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5)
[0m10:57:50.647335 [info ] [Thread-4 (]: 4 of 124 START test assert_regime_threshold_ordering ........................... [RUN]
[0m10:57:50.648628 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m10:57:50.649370 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.portfolio_project_2.assert_regime_threshold_ordering'
[0m10:57:50.663808 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m10:57:50.664377 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.assert_regime_threshold_ordering
[0m10:57:50.669950 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m10:57:50.671335 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m10:57:50.672140 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.assert_regime_threshold_ordering
[0m10:57:50.705605 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m10:57:50.712240 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m10:57:50.714571 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m10:57:50.715397 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m10:57:50.715968 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: BEGIN
[0m10:57:50.716704 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: BEGIN
[0m10:57:50.717288 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:50.717812 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:57:50.720015 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m10:57:50.720776 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m10:57:50.721473 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.assert_regime_threshold_ordering"
[0m10:57:50.722043 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"
[0m10:57:50.722600 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.assert_regime_threshold_ordering"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select
    version_id,
    complacent_max,
    normal_max,
    elevated_max
from "finance"."analytics_dev"."regime_thresholds"
where not (complacent_max < normal_max and normal_max < elevated_max)
  
  
      
    ) dbt_internal_test
[0m10:57:50.723099 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_date
from "finance"."analytics_dev"."regime_thresholds"
where effective_date is null



  
  
      
    ) dbt_internal_test
[0m10:57:50.887796 [debug] [Thread-3 (]: SQL status: OK in 0.164 seconds
[0m10:57:50.888788 [debug] [Thread-4 (]: SQL status: OK in 0.165 seconds
[0m10:57:50.897220 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: ROLLBACK
[0m10:57:50.899971 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: ROLLBACK
[0m10:57:50.901362 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5'
[0m10:57:50.902590 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.assert_regime_threshold_ordering'
[0m10:57:50.903387 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5: Close
[0m10:57:50.904079 [debug] [Thread-4 (]: On test.portfolio_project_2.assert_regime_threshold_ordering: Close
[0m10:57:50.905662 [info ] [Thread-4 (]: 4 of 124 PASS assert_regime_threshold_ordering ................................. [[32mPASS[0m in 0.26s]
[0m10:57:50.907835 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.assert_regime_threshold_ordering
[0m10:57:50.908526 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m10:57:50.906557 [info ] [Thread-3 (]: 5 of 124 PASS not_null_regime_thresholds_effective_date ........................ [[32mPASS[0m in 0.26s]
[0m10:57:50.910397 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5
[0m10:57:50.909160 [info ] [Thread-4 (]: 6 of 124 START test not_null_regime_thresholds_version_id ...................... [RUN]
[0m10:57:50.911266 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m10:57:50.912427 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.assert_regime_threshold_ordering, now test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c)
[0m10:57:50.913800 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m10:57:50.913176 [info ] [Thread-3 (]: 7 of 124 START test unique_regime_thresholds_effective_date .................... [RUN]
[0m10:57:50.919755 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m10:57:50.920297 [debug] [Thread-1 (]: SQL status: OK in 0.350 seconds
[0m10:57:50.920821 [debug] [Thread-2 (]: SQL status: OK in 0.351 seconds
[0m10:57:50.921385 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_regime_thresholds_effective_date.e064ca0cd5, now test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c)
[0m10:57:50.923757 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m10:57:50.925381 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m10:57:50.925981 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m10:57:50.926803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DBAC3A10>]}
[0m10:57:50.927335 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DBB6A990>]}
[0m10:57:50.935093 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m10:57:50.935552 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m10:57:50.936262 [info ] [Thread-1 (]: 1 of 124 OK created sql view model analytics_dev.src_stocks .................... [[32mOK[0m in 0.96s]
[0m10:57:50.939925 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m10:57:50.936850 [info ] [Thread-2 (]: 2 of 124 OK created sql view model analytics_dev.src_vix ....................... [[32mOK[0m in 0.96s]
[0m10:57:50.940800 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m10:57:50.941703 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m10:57:50.942341 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m10:57:50.942953 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m10:57:50.943662 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.stg__stocks
[0m10:57:50.944728 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m10:57:50.944274 [info ] [Thread-1 (]: 8 of 124 START test unique_regime_thresholds_version_id ........................ [RUN]
[0m10:57:50.947745 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m10:57:50.948826 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: BEGIN
[0m10:57:50.948395 [info ] [Thread-2 (]: 9 of 124 START sql view model analytics_dev.stg__stocks ........................ [RUN]
[0m10:57:50.949465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f)
[0m10:57:50.950087 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:50.950681 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.stg__stocks)
[0m10:57:50.951257 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m10:57:50.952099 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m10:57:50.957229 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m10:57:50.964446 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m10:57:50.965073 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m10:57:50.965760 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m10:57:50.966365 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: BEGIN
[0m10:57:50.966889 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"
[0m10:57:50.967300 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m10:57:50.967858 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:50.968931 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_id
from "finance"."analytics_dev"."regime_thresholds"
where version_id is null



  
  
      
    ) dbt_internal_test
[0m10:57:50.969848 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m10:57:50.974553 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m10:57:50.984219 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m10:57:50.985196 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m10:57:50.986408 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"
[0m10:57:50.987155 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    effective_date as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."regime_thresholds"
where effective_date is not null
group by effective_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:57:50.988982 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:57:50.990535 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m10:57:50.992126 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m10:57:50.993420 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: BEGIN
[0m10:57:50.994532 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:50.995762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:50.998689 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:57:50.999945 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"
[0m10:57:51.000628 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m10:57:51.001219 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    version_id as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."regime_thresholds"
where version_id is not null
group by version_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:57:51.001819 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:57:51.002857 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m10:57:51.034724 [debug] [Thread-4 (]: SQL status: OK in 0.058 seconds
[0m10:57:51.037040 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: ROLLBACK
[0m10:57:51.037712 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c'
[0m10:57:51.038095 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c: Close
[0m10:57:51.039059 [info ] [Thread-4 (]: 6 of 124 PASS not_null_regime_thresholds_version_id ............................ [[32mPASS[0m in 0.13s]
[0m10:57:51.039906 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c
[0m10:57:51.050159 [debug] [Thread-3 (]: SQL status: OK in 0.062 seconds
[0m10:57:51.052762 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: ROLLBACK
[0m10:57:51.053493 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c'
[0m10:57:51.053882 [debug] [Thread-3 (]: On test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c: Close
[0m10:57:51.054877 [info ] [Thread-3 (]: 7 of 124 PASS unique_regime_thresholds_effective_date .......................... [[32mPASS[0m in 0.13s]
[0m10:57:51.055680 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c
[0m10:57:51.086515 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m10:57:51.101554 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: ROLLBACK
[0m10:57:51.104489 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f'
[0m10:57:51.105989 [debug] [Thread-1 (]: On test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f: Close
[0m10:57:51.108403 [info ] [Thread-1 (]: 8 of 124 PASS unique_regime_thresholds_version_id .............................. [[32mPASS[0m in 0.16s]
[0m10:57:51.110274 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f
[0m10:57:51.111191 [debug] [Thread-2 (]: SQL status: OK in 0.108 seconds
[0m10:57:51.117648 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:57:51.118360 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m10:57:51.119056 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m10:57:51.119973 [info ] [Thread-4 (]: 10 of 124 START sql view model analytics_dev.stg__vix_with_versions ............ [RUN]
[0m10:57:51.121487 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_regime_thresholds_version_id.72b885197c, now model.portfolio_project_2.stg__vix_with_versions)
[0m10:57:51.122506 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m10:57:51.126492 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m10:57:51.127431 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m10:57:51.131007 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m10:57:51.131970 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:57:51.132345 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m10:57:51.132685 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:51.134084 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:57:51.134695 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:57:51.135232 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m10:57:51.196941 [debug] [Thread-2 (]: SQL status: OK in 0.076 seconds
[0m10:57:51.198585 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m10:57:51.199048 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:57:51.199405 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m10:57:51.220549 [debug] [Thread-4 (]: SQL status: OK in 0.085 seconds
[0m10:57:51.223659 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:57:51.224057 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m10:57:51.287252 [debug] [Thread-4 (]: SQL status: OK in 0.063 seconds
[0m10:57:51.289032 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m10:57:51.289538 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:57:51.289958 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m10:57:51.326134 [debug] [Thread-2 (]: SQL status: OK in 0.126 seconds
[0m10:57:51.329082 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m10:57:51.329634 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m10:57:51.422577 [debug] [Thread-4 (]: SQL status: OK in 0.132 seconds
[0m10:57:51.425152 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m10:57:51.425538 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m10:57:51.446479 [debug] [Thread-2 (]: SQL status: OK in 0.116 seconds
[0m10:57:51.448069 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__stocks: Close
[0m10:57:51.448912 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD96B070>]}
[0m10:57:51.449719 [info ] [Thread-2 (]: 9 of 124 OK created sql view model analytics_dev.stg__stocks ................... [[32mOK[0m in 0.50s]
[0m10:57:51.450657 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m10:57:51.451588 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m10:57:51.452001 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m10:57:51.453203 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m10:57:51.452442 [info ] [Thread-2 (]: 13 of 124 START test dbt_utils_expression_is_true_stg__stocks_high___0 ......... [RUN]
[0m10:57:51.454130 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c)
[0m10:57:51.454498 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m10:57:51.452828 [info ] [Thread-3 (]: 11 of 124 START test dbt_utils_expression_is_true_stg__stocks_close___0 ........ [RUN]
[0m10:57:51.467012 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m10:57:51.467848 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.unique_regime_thresholds_effective_date.9ff5ad183c, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c)
[0m10:57:51.453606 [info ] [Thread-1 (]: 12 of 124 START test dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high  [RUN]
[0m10:57:51.468912 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m10:57:51.469584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.unique_regime_thresholds_version_id.5aab3e9c1f, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338)
[0m10:57:51.473881 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m10:57:51.474508 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m10:57:51.475274 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m10:57:51.475714 [debug] [Thread-4 (]: SQL status: OK in 0.050 seconds
[0m10:57:51.481767 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m10:57:51.484650 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m10:57:51.487183 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m10:57:51.488169 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m10:57:51.489055 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD90BA50>]}
[0m10:57:51.496971 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m10:57:51.498816 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m10:57:51.498266 [info ] [Thread-4 (]: 10 of 124 OK created sql view model analytics_dev.stg__vix_with_versions ....... [[32mOK[0m in 0.37s]
[0m10:57:51.499627 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: BEGIN
[0m10:57:51.500176 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m10:57:51.500821 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m10:57:51.501297 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:51.501768 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m10:57:51.504552 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m10:57:51.505066 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m10:57:51.506512 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: BEGIN
[0m10:57:51.507299 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m10:57:51.508242 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:51.508712 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"
[0m10:57:51.507819 [info ] [Thread-4 (]: 14 of 124 START test dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp  [RUN]
[0m10:57:51.509675 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(high >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:51.510241 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m10:57:51.510718 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__vix_with_versions, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa)
[0m10:57:51.511393 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: BEGIN
[0m10:57:51.511997 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m10:57:51.512909 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m10:57:51.514183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:51.521548 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m10:57:51.522347 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"
[0m10:57:51.523438 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(close >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:51.524424 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m10:57:51.524959 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:57:51.528220 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m10:57:51.529100 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"
[0m10:57:51.530506 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(close >= low and close <= high)


  
  
      
    ) dbt_internal_test
[0m10:57:51.532302 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m10:57:51.533159 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: BEGIN
[0m10:57:51.533761 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:51.535498 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m10:57:51.536656 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"
[0m10:57:51.537426 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m10:57:51.571830 [debug] [Thread-2 (]: SQL status: OK in 0.061 seconds
[0m10:57:51.574062 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: ROLLBACK
[0m10:57:51.574738 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c'
[0m10:57:51.575102 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c: Close
[0m10:57:51.576030 [info ] [Thread-2 (]: 13 of 124 PASS dbt_utils_expression_is_true_stg__stocks_high___0 ............... [[32mPASS[0m in 0.12s]
[0m10:57:51.576842 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c
[0m10:57:51.577269 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m10:57:51.577663 [info ] [Thread-2 (]: 15 of 124 START test dbt_utils_expression_is_true_stg__stocks_low___0 .......... [RUN]
[0m10:57:51.578338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_high___0.31b92ab64c, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99)
[0m10:57:51.578882 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m10:57:51.583551 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m10:57:51.584548 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m10:57:51.587270 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m10:57:51.588248 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m10:57:51.588645 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: BEGIN
[0m10:57:51.588991 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:51.590207 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:57:51.590655 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"
[0m10:57:51.591029 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(low >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:51.615433 [debug] [Thread-3 (]: SQL status: OK in 0.091 seconds
[0m10:57:51.617642 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: ROLLBACK
[0m10:57:51.618251 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c'
[0m10:57:51.618623 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c: Close
[0m10:57:51.619557 [info ] [Thread-3 (]: 11 of 124 PASS dbt_utils_expression_is_true_stg__stocks_close___0 .............. [[32mPASS[0m in 0.15s]
[0m10:57:51.620393 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c
[0m10:57:51.620818 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m10:57:51.621199 [info ] [Thread-3 (]: 16 of 124 START test dbt_utils_expression_is_true_stg__stocks_open___0 ......... [RUN]
[0m10:57:51.621812 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close___0.82a906179c, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec)
[0m10:57:51.622216 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m10:57:51.626496 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m10:57:51.627127 [debug] [Thread-4 (]: SQL status: OK in 0.089 seconds
[0m10:57:51.627606 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m10:57:51.628491 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m10:57:51.630394 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: ROLLBACK
[0m10:57:51.633467 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m10:57:51.635007 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: ROLLBACK
[0m10:57:51.635728 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa'
[0m10:57:51.636590 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338'
[0m10:57:51.636992 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa: Close
[0m10:57:51.637479 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338: Close
[0m10:57:51.638322 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m10:57:51.639740 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: BEGIN
[0m10:57:51.639348 [info ] [Thread-1 (]: 12 of 124 PASS dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high  [[32mPASS[0m in 0.17s]
[0m10:57:51.640861 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:51.640454 [info ] [Thread-4 (]: 14 of 124 PASS dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp  [[32mPASS[0m in 0.13s]
[0m10:57:51.641713 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338
[0m10:57:51.642578 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa
[0m10:57:51.643094 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m10:57:51.643651 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m10:57:51.644235 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m10:57:51.644681 [info ] [Thread-1 (]: 17 of 124 START test dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high  [RUN]
[0m10:57:51.646125 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"
[0m10:57:51.645243 [info ] [Thread-4 (]: 18 of 124 START test dbt_utils_expression_is_true_stg__stocks_trade_date___current_date  [RUN]
[0m10:57:51.647393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_close_low_and_close_high.53122ec338, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8)
[0m10:57:51.648286 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(open >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:51.649149 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_loaded_at___current_timestamp.a2737b21fa, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4)
[0m10:57:51.649640 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m10:57:51.650292 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m10:57:51.657667 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m10:57:51.666765 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m10:57:51.667681 [debug] [Thread-2 (]: SQL status: OK in 0.076 seconds
[0m10:57:51.668926 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m10:57:51.672286 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m10:57:51.673987 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: ROLLBACK
[0m10:57:51.674510 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m10:57:51.677525 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m10:57:51.678308 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99'
[0m10:57:51.678897 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99: Close
[0m10:57:51.679722 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m10:57:51.680224 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: BEGIN
[0m10:57:51.680876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:51.681753 [info ] [Thread-2 (]: 15 of 124 PASS dbt_utils_expression_is_true_stg__stocks_low___0 ................ [[32mPASS[0m in 0.10s]
[0m10:57:51.683219 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m10:57:51.684334 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99
[0m10:57:51.685080 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: BEGIN
[0m10:57:51.685835 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:57:51.686889 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m10:57:51.687488 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:51.687953 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"
[0m10:57:51.689105 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(open >= low and open <= high)


  
  
      
    ) dbt_internal_test
[0m10:57:51.688410 [info ] [Thread-2 (]: 19 of 124 START test dbt_utils_expression_is_true_stg__stocks_volume___0 ....... [RUN]
[0m10:57:51.690033 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_low___0.7d0063bf99, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e)
[0m10:57:51.690435 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m10:57:51.694324 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m10:57:51.694781 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m10:57:51.695354 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"
[0m10:57:51.695794 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m10:57:51.696656 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m10:57:51.700681 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m10:57:51.702032 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m10:57:51.702619 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: BEGIN
[0m10:57:51.702985 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:51.704438 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:57:51.704846 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"
[0m10:57:51.705209 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__stocks"

where not(volume >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:51.708705 [debug] [Thread-3 (]: SQL status: OK in 0.059 seconds
[0m10:57:51.711098 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: ROLLBACK
[0m10:57:51.711820 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec'
[0m10:57:51.712240 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec: Close
[0m10:57:51.713252 [info ] [Thread-3 (]: 16 of 124 PASS dbt_utils_expression_is_true_stg__stocks_open___0 ............... [[32mPASS[0m in 0.09s]
[0m10:57:51.714323 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec
[0m10:57:51.714919 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m10:57:51.715363 [info ] [Thread-3 (]: 20 of 124 START test dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker  [RUN]
[0m10:57:51.716018 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open___0.045a04c4ec, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91)
[0m10:57:51.716412 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m10:57:51.726117 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m10:57:51.727008 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m10:57:51.731216 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m10:57:51.732578 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m10:57:51.733020 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: BEGIN
[0m10:57:51.733380 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:51.734717 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:57:51.735107 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"
[0m10:57:51.735502 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        trade_date, ticker
    from "finance"."analytics_dev"."stg__stocks"
    group by trade_date, ticker
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:57:51.754427 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m10:57:51.756672 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: ROLLBACK
[0m10:57:51.757290 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8'
[0m10:57:51.757649 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8: Close
[0m10:57:51.758564 [info ] [Thread-1 (]: 17 of 124 PASS dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high . [[32mPASS[0m in 0.11s]
[0m10:57:51.759402 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8
[0m10:57:51.759824 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m10:57:51.760206 [info ] [Thread-1 (]: 21 of 124 START test not_null_stg__stocks_close ................................ [RUN]
[0m10:57:51.760833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_open_low_and_open_high.e1bf16a9b8, now test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f)
[0m10:57:51.761216 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m10:57:51.767067 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m10:57:51.769894 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m10:57:51.773944 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m10:57:51.775192 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m10:57:51.775658 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: BEGIN
[0m10:57:51.776015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:51.777315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:57:51.777700 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"
[0m10:57:51.778059 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."stg__stocks"
where close is null



  
  
      
    ) dbt_internal_test
[0m10:57:51.791453 [debug] [Thread-4 (]: SQL status: OK in 0.095 seconds
[0m10:57:51.791950 [debug] [Thread-2 (]: SQL status: OK in 0.086 seconds
[0m10:57:51.796795 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: ROLLBACK
[0m10:57:51.799775 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: ROLLBACK
[0m10:57:51.800728 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e'
[0m10:57:51.801443 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4'
[0m10:57:51.801984 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e: Close
[0m10:57:51.802465 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4: Close
[0m10:57:51.803577 [info ] [Thread-4 (]: 18 of 124 PASS dbt_utils_expression_is_true_stg__stocks_trade_date___current_date  [[32mPASS[0m in 0.15s]
[0m10:57:51.805614 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4
[0m10:57:51.804312 [info ] [Thread-2 (]: 19 of 124 PASS dbt_utils_expression_is_true_stg__stocks_volume___0 ............. [[32mPASS[0m in 0.11s]
[0m10:57:51.806554 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m10:57:51.807007 [debug] [Thread-3 (]: SQL status: OK in 0.071 seconds
[0m10:57:51.808024 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e
[0m10:57:51.808901 [info ] [Thread-4 (]: 22 of 124 START test not_null_stg__stocks_high ................................. [RUN]
[0m10:57:51.810419 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m10:57:51.811428 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_trade_date___current_date.50535c21c4, now test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4)
[0m10:57:51.812198 [info ] [Thread-2 (]: 23 of 124 START test not_null_stg__stocks_loaded_at ............................ [RUN]
[0m10:57:51.815442 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: ROLLBACK
[0m10:57:51.816418 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m10:57:51.817347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__stocks_volume___0.255ae0f62e, now test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf)
[0m10:57:51.818759 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91'
[0m10:57:51.824314 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m10:57:51.824849 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m10:57:51.825330 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91: Close
[0m10:57:51.831020 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m10:57:51.832205 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m10:57:51.841553 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m10:57:51.833169 [info ] [Thread-3 (]: 20 of 124 PASS dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker  [[32mPASS[0m in 0.12s]
[0m10:57:51.842593 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91
[0m10:57:51.843016 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m10:57:51.843397 [info ] [Thread-3 (]: 24 of 124 START test not_null_stg__stocks_low .................................. [RUN]
[0m10:57:51.844590 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__stocks_trade_date__ticker.b7e3a0cf91, now test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52)
[0m10:57:51.845450 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m10:57:51.846328 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m10:57:51.847232 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m10:57:51.848268 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m10:57:51.853848 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m10:57:51.861849 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m10:57:51.862979 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: BEGIN
[0m10:57:51.864412 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:51.867431 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: ROLLBACK
[0m10:57:51.868534 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f'
[0m10:57:51.869390 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m10:57:51.870120 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f: Close
[0m10:57:51.871062 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"
[0m10:57:51.872074 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m10:57:51.873130 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m10:57:51.874307 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select high
from "finance"."analytics_dev"."stg__stocks"
where high is null



  
  
      
    ) dbt_internal_test
[0m10:57:51.878813 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m10:57:51.880881 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: BEGIN
[0m10:57:51.879969 [info ] [Thread-1 (]: 21 of 124 PASS not_null_stg__stocks_close ...................................... [[32mPASS[0m in 0.12s]
[0m10:57:51.882365 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:51.883863 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f
[0m10:57:51.884895 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m10:57:51.886558 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m10:57:51.887373 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m10:57:51.885763 [info ] [Thread-1 (]: 25 of 124 START test not_null_stg__stocks_open ................................. [RUN]
[0m10:57:51.887973 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"
[0m10:57:51.888459 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: BEGIN
[0m10:57:51.889031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_close.fffbf4932f, now test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7)
[0m10:57:51.889536 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."stg__stocks"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m10:57:51.890231 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:51.890868 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m10:57:51.898555 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m10:57:51.899909 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m10:57:51.900790 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"
[0m10:57:51.901251 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select low
from "finance"."analytics_dev"."stg__stocks"
where low is null



  
  
      
    ) dbt_internal_test
[0m10:57:51.901749 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m10:57:51.906934 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m10:57:51.908375 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m10:57:51.908990 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: BEGIN
[0m10:57:51.909348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:51.910747 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:57:51.911192 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"
[0m10:57:51.911668 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select open
from "finance"."analytics_dev"."stg__stocks"
where open is null



  
  
      
    ) dbt_internal_test
[0m10:57:51.985865 [debug] [Thread-2 (]: SQL status: OK in 0.093 seconds
[0m10:57:51.989172 [debug] [Thread-4 (]: SQL status: OK in 0.107 seconds
[0m10:57:51.991166 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m10:57:51.992956 [debug] [Thread-3 (]: SQL status: OK in 0.090 seconds
[0m10:57:51.997144 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: ROLLBACK
[0m10:57:52.000392 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf'
[0m10:57:52.004053 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: ROLLBACK
[0m10:57:52.005008 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf: Close
[0m10:57:52.008163 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: ROLLBACK
[0m10:57:52.010717 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: ROLLBACK
[0m10:57:52.012011 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4'
[0m10:57:52.013429 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52'
[0m10:57:52.016774 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7'
[0m10:57:52.017551 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4: Close
[0m10:57:52.015226 [info ] [Thread-2 (]: 23 of 124 PASS not_null_stg__stocks_loaded_at .................................. [[32mPASS[0m in 0.20s]
[0m10:57:52.018555 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52: Close
[0m10:57:52.019208 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7: Close
[0m10:57:52.020290 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf
[0m10:57:52.026080 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m10:57:52.021775 [info ] [Thread-4 (]: 22 of 124 PASS not_null_stg__stocks_high ....................................... [[32mPASS[0m in 0.21s]
[0m10:57:52.030428 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4
[0m10:57:52.024600 [info ] [Thread-3 (]: 24 of 124 PASS not_null_stg__stocks_low ........................................ [[32mPASS[0m in 0.18s]
[0m10:57:52.031752 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m10:57:52.027812 [info ] [Thread-1 (]: 25 of 124 PASS not_null_stg__stocks_open ....................................... [[32mPASS[0m in 0.14s]
[0m10:57:52.033314 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52
[0m10:57:52.028769 [info ] [Thread-2 (]: 26 of 124 START test not_null_stg__stocks_ticker ............................... [RUN]
[0m10:57:52.035653 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7
[0m10:57:52.036544 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m10:57:52.034318 [info ] [Thread-4 (]: 27 of 124 START test not_null_stg__stocks_trade_date ........................... [RUN]
[0m10:57:52.037585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_loaded_at.9e65a74ecf, now test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71)
[0m10:57:52.038423 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m10:57:52.039905 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_high.d9cb8afef4, now test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182)
[0m10:57:52.039218 [info ] [Thread-3 (]: 28 of 124 START test not_null_stg__stocks_volume ............................... [RUN]
[0m10:57:52.040953 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m10:57:52.041946 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m10:57:52.041435 [info ] [Thread-1 (]: 29 of 124 START test dbt_utils_expression_is_true_stg__vix_with_versions_close___0  [RUN]
[0m10:57:52.042732 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_low.9e08b21b52, now test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0)
[0m10:57:52.048872 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m10:57:52.057147 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m10:57:52.057803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_open.fa850d9ad7, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd)
[0m10:57:52.058267 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m10:57:52.058964 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m10:57:52.066074 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m10:57:52.073885 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m10:57:52.074652 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m10:57:52.077298 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m10:57:52.077727 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m10:57:52.080818 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m10:57:52.081629 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m10:57:52.084575 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m10:57:52.085160 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m10:57:52.087644 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m10:57:52.088278 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m10:57:52.088689 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: BEGIN
[0m10:57:52.089060 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:52.089495 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m10:57:52.090187 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: BEGIN
[0m10:57:52.090562 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:52.091191 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m10:57:52.092114 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m10:57:52.092901 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m10:57:52.093384 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"
[0m10:57:52.093840 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m10:57:52.094301 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: BEGIN
[0m10:57:52.094728 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: BEGIN
[0m10:57:52.095189 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."stg__stocks"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m10:57:52.095663 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"
[0m10:57:52.096114 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:52.096622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:52.097525 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."stg__stocks"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m10:57:52.098590 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:57:52.098991 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"
[0m10:57:52.099370 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(close > 0)


  
  
      
    ) dbt_internal_test
[0m10:57:52.099890 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m10:57:52.100288 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"
[0m10:57:52.100694 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select volume
from "finance"."analytics_dev"."stg__stocks"
where volume is null



  
  
      
    ) dbt_internal_test
[0m10:57:52.192954 [debug] [Thread-4 (]: SQL status: OK in 0.095 seconds
[0m10:57:52.194699 [debug] [Thread-2 (]: SQL status: OK in 0.096 seconds
[0m10:57:52.197515 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m10:57:52.205455 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: ROLLBACK
[0m10:57:52.211205 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: ROLLBACK
[0m10:57:52.217074 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: ROLLBACK
[0m10:57:52.220702 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182'
[0m10:57:52.223154 [debug] [Thread-3 (]: SQL status: OK in 0.121 seconds
[0m10:57:52.225915 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71'
[0m10:57:52.229532 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd'
[0m10:57:52.232793 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182: Close
[0m10:57:52.234907 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71: Close
[0m10:57:52.235918 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd: Close
[0m10:57:52.239129 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: ROLLBACK
[0m10:57:52.240705 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0'
[0m10:57:52.243409 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0: Close
[0m10:57:52.241785 [info ] [Thread-4 (]: 27 of 124 PASS not_null_stg__stocks_trade_date ................................. [[32mPASS[0m in 0.20s]
[0m10:57:52.246007 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182
[0m10:57:52.242752 [info ] [Thread-1 (]: 29 of 124 PASS dbt_utils_expression_is_true_stg__vix_with_versions_close___0 ... [[32mPASS[0m in 0.18s]
[0m10:57:52.247969 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m10:57:52.244607 [info ] [Thread-2 (]: 26 of 124 PASS not_null_stg__stocks_ticker ..................................... [[32mPASS[0m in 0.21s]
[0m10:57:52.249610 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd
[0m10:57:52.247024 [info ] [Thread-3 (]: 28 of 124 PASS not_null_stg__stocks_volume ..................................... [[32mPASS[0m in 0.20s]
[0m10:57:52.251738 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71
[0m10:57:52.250622 [info ] [Thread-4 (]: 30 of 124 START test dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max  [RUN]
[0m10:57:52.252825 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m10:57:52.254165 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0
[0m10:57:52.255174 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m10:57:52.256257 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_trade_date.0e89ac0182, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929)
[0m10:57:52.257935 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m10:57:52.257125 [info ] [Thread-1 (]: 31 of 124 START test dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp  [RUN]
[0m10:57:52.259969 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m10:57:52.258792 [info ] [Thread-2 (]: 32 of 124 START test dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date  [RUN]
[0m10:57:52.262027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_close___0.d25a2ab9fd, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17)
[0m10:57:52.270331 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m10:57:52.271226 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_ticker.3c0d324b71, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00)
[0m10:57:52.260951 [info ] [Thread-3 (]: 33 of 124 START test dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1  [RUN]
[0m10:57:52.272202 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m10:57:52.273122 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m10:57:52.273816 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__stocks_volume.d1fcbd1bf0, now test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93)
[0m10:57:52.281165 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m10:57:52.287326 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m10:57:52.288066 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m10:57:52.288598 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m10:57:52.295379 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m10:57:52.298448 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m10:57:52.299466 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m10:57:52.300459 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m10:57:52.304048 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m10:57:52.304544 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m10:57:52.311189 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m10:57:52.314849 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m10:57:52.315374 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m10:57:52.316355 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m10:57:52.316787 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: BEGIN
[0m10:57:52.317245 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m10:57:52.317778 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: BEGIN
[0m10:57:52.318223 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m10:57:52.318686 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:52.319134 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: BEGIN
[0m10:57:52.319570 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:52.320012 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: BEGIN
[0m10:57:52.320681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:52.321304 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:52.321938 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:57:52.322522 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m10:57:52.322987 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"
[0m10:57:52.323486 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:57:52.323901 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"
[0m10:57:52.324308 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:57:52.324767 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m10:57:52.325339 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"
[0m10:57:52.325795 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(complacent_max < normal_max AND  normal_max < elevated_max)


  
  
      
    ) dbt_internal_test
[0m10:57:52.326226 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"
[0m10:57:52.326924 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(version_rank >= 1)


  
  
      
    ) dbt_internal_test
[0m10:57:52.327580 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."stg__vix_with_versions"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m10:57:52.404415 [debug] [Thread-2 (]: SQL status: OK in 0.077 seconds
[0m10:57:52.422004 [debug] [Thread-4 (]: SQL status: OK in 0.094 seconds
[0m10:57:52.425472 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: ROLLBACK
[0m10:57:52.426563 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m10:57:52.427416 [debug] [Thread-3 (]: SQL status: OK in 0.099 seconds
[0m10:57:52.430640 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: ROLLBACK
[0m10:57:52.431710 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00'
[0m10:57:52.433087 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929'
[0m10:57:52.433781 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00: Close
[0m10:57:52.434467 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929: Close
[0m10:57:52.436500 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: ROLLBACK
[0m10:57:52.438516 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: ROLLBACK
[0m10:57:52.439727 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17'
[0m10:57:52.440675 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93'
[0m10:57:52.443002 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17: Close
[0m10:57:52.441587 [info ] [Thread-2 (]: 32 of 124 PASS dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date  [[32mPASS[0m in 0.17s]
[0m10:57:52.443866 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93: Close
[0m10:57:52.442418 [info ] [Thread-4 (]: 30 of 124 PASS dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max  [[32mPASS[0m in 0.19s]
[0m10:57:52.445236 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00
[0m10:57:52.447148 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929
[0m10:57:52.446127 [info ] [Thread-1 (]: 31 of 124 PASS dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp  [[32mPASS[0m in 0.18s]
[0m10:57:52.449237 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m10:57:52.448494 [info ] [Thread-3 (]: 33 of 124 PASS dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1  [[32mPASS[0m in 0.17s]
[0m10:57:52.450335 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m10:57:52.451332 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17
[0m10:57:52.452836 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93
[0m10:57:52.452114 [info ] [Thread-2 (]: 34 of 124 START test dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id  [RUN]
[0m10:57:52.453810 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m10:57:52.453247 [info ] [Thread-4 (]: 35 of 124 START test not_null_stg__vix_with_versions_close ..................... [RUN]
[0m10:57:52.454456 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m10:57:52.455235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_trade_date___current_date.489f816a00, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e)
[0m10:57:52.456405 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_complacent_max___normal_max_AND_normal_max_elevated_max.3a3653f929, now test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7)
[0m10:57:52.455886 [info ] [Thread-1 (]: 36 of 124 START test not_null_stg__vix_with_versions_complacent_max ............ [RUN]
[0m10:57:52.457435 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m10:57:52.457024 [info ] [Thread-3 (]: 37 of 124 START test not_null_stg__vix_with_versions_effective_date ............ [RUN]
[0m10:57:52.457978 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m10:57:52.458439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_loaded_at___current_timestamp.3f0d909a17, now test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a)
[0m10:57:52.464122 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m10:57:52.466961 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_stg__vix_with_versions_version_rank___1.a77eecdd93, now test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991)
[0m10:57:52.472290 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m10:57:52.472793 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m10:57:52.473383 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m10:57:52.477563 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m10:57:52.483053 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m10:57:52.483531 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m10:57:52.483997 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m10:57:52.486597 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m10:57:52.489141 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m10:57:52.490000 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m10:57:52.492242 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m10:57:52.492891 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m10:57:52.495730 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m10:57:52.496541 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m10:57:52.497115 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m10:57:52.497756 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: BEGIN
[0m10:57:52.498623 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: BEGIN
[0m10:57:52.499223 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:52.499718 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m10:57:52.500162 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:52.500615 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m10:57:52.501315 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: BEGIN
[0m10:57:52.501982 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: BEGIN
[0m10:57:52.502463 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:52.502932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:52.503331 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m10:57:52.503738 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m10:57:52.504562 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"
[0m10:57:52.504993 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"
[0m10:57:52.505519 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:57:52.505938 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."stg__vix_with_versions"
where close is null



  
  
      
    ) dbt_internal_test
[0m10:57:52.506364 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m10:57:52.506817 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        trade_date, version_id
    from "finance"."analytics_dev"."stg__vix_with_versions"
    group by trade_date, version_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:57:52.507274 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"
[0m10:57:52.507919 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"
[0m10:57:52.508625 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select complacent_max
from "finance"."analytics_dev"."stg__vix_with_versions"
where complacent_max is null



  
  
      
    ) dbt_internal_test
[0m10:57:52.509093 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
where effective_date is null



  
  
      
    ) dbt_internal_test
[0m10:57:52.511767 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:57:52.514571 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: ROLLBACK
[0m10:57:52.515255 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991'
[0m10:57:52.515613 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991: Close
[0m10:57:52.516315 [info ] [Thread-3 (]: 37 of 124 PASS not_null_stg__vix_with_versions_effective_date .................. [[32mPASS[0m in 0.05s]
[0m10:57:52.517143 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991
[0m10:57:52.517561 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m10:57:52.517953 [info ] [Thread-3 (]: 38 of 124 START test not_null_stg__vix_with_versions_elevated_max .............. [RUN]
[0m10:57:52.518592 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_effective_date.42b2a32991, now test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6)
[0m10:57:52.518975 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m10:57:52.522847 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m10:57:52.523718 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m10:57:52.525889 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m10:57:52.526953 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m10:57:52.527371 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: BEGIN
[0m10:57:52.527733 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:52.529363 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:57:52.530066 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"
[0m10:57:52.530471 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select elevated_max
from "finance"."analytics_dev"."stg__vix_with_versions"
where elevated_max is null



  
  
      
    ) dbt_internal_test
[0m10:57:52.586866 [debug] [Thread-4 (]: SQL status: OK in 0.079 seconds
[0m10:57:52.589413 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: ROLLBACK
[0m10:57:52.590049 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7'
[0m10:57:52.590402 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7: Close
[0m10:57:52.591296 [info ] [Thread-4 (]: 35 of 124 PASS not_null_stg__vix_with_versions_close ........................... [[32mPASS[0m in 0.13s]
[0m10:57:52.592098 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7
[0m10:57:52.592514 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m10:57:52.592897 [info ] [Thread-4 (]: 39 of 124 START test not_null_stg__vix_with_versions_loaded_at ................. [RUN]
[0m10:57:52.593499 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_close.4e1f1a3bf7, now test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c)
[0m10:57:52.593884 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m10:57:52.598067 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m10:57:52.598984 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m10:57:52.601060 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m10:57:52.601988 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m10:57:52.602380 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: BEGIN
[0m10:57:52.602721 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:52.603339 [debug] [Thread-2 (]: SQL status: OK in 0.095 seconds
[0m10:57:52.604016 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:57:52.604398 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"
[0m10:57:52.604764 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."stg__vix_with_versions"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m10:57:52.606273 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: ROLLBACK
[0m10:57:52.606909 [debug] [Thread-3 (]: SQL status: OK in 0.076 seconds
[0m10:57:52.607409 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m10:57:52.608175 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e'
[0m10:57:52.608571 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e: Close
[0m10:57:52.610004 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: ROLLBACK
[0m10:57:52.611321 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: ROLLBACK
[0m10:57:52.612786 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a'
[0m10:57:52.612153 [info ] [Thread-2 (]: 34 of 124 PASS dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id  [[32mPASS[0m in 0.16s]
[0m10:57:52.613450 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a: Close
[0m10:57:52.614073 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6'
[0m10:57:52.614829 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e
[0m10:57:52.615407 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6: Close
[0m10:57:52.615914 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m10:57:52.616501 [info ] [Thread-1 (]: 36 of 124 PASS not_null_stg__vix_with_versions_complacent_max .................. [[32mPASS[0m in 0.16s]
[0m10:57:52.618396 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a
[0m10:57:52.618804 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m10:57:52.617075 [info ] [Thread-2 (]: 40 of 124 START test not_null_stg__vix_with_versions_normal_max ................ [RUN]
[0m10:57:52.619854 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_stg__vix_with_versions_trade_date__version_id.8545b2b10e, now test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21)
[0m10:57:52.620284 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m10:57:52.624412 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m10:57:52.617727 [info ] [Thread-3 (]: 38 of 124 PASS not_null_stg__vix_with_versions_elevated_max .................... [[32mPASS[0m in 0.10s]
[0m10:57:52.625355 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6
[0m10:57:52.619166 [info ] [Thread-1 (]: 41 of 124 START test not_null_stg__vix_with_versions_trade_date ................ [RUN]
[0m10:57:52.625981 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m10:57:52.626492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_complacent_max.7ddf66e27a, now test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1)
[0m10:57:52.627487 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m10:57:52.631912 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m10:57:52.632376 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m10:57:52.627059 [info ] [Thread-3 (]: 42 of 124 START test not_null_stg__vix_with_versions_version_id ................ [RUN]
[0m10:57:52.635227 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m10:57:52.635796 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_elevated_max.d54ccf13b6, now test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c)
[0m10:57:52.636473 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m10:57:52.640337 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m10:57:52.641236 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m10:57:52.641747 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: BEGIN
[0m10:57:52.642089 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:52.642698 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m10:57:52.644925 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m10:57:52.645587 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m10:57:52.646000 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"
[0m10:57:52.646406 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select normal_max
from "finance"."analytics_dev"."stg__vix_with_versions"
where normal_max is null



  
  
      
    ) dbt_internal_test
[0m10:57:52.647226 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m10:57:52.647952 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m10:57:52.650956 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m10:57:52.651451 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: BEGIN
[0m10:57:52.652028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:52.652841 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m10:57:52.653241 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: BEGIN
[0m10:57:52.653603 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:52.654239 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:57:52.654634 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"
[0m10:57:52.655026 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."stg__vix_with_versions"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m10:57:52.655686 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:57:52.656148 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"
[0m10:57:52.656539 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_id
from "finance"."analytics_dev"."stg__vix_with_versions"
where version_id is null



  
  
      
    ) dbt_internal_test
[0m10:57:52.665963 [debug] [Thread-4 (]: SQL status: OK in 0.059 seconds
[0m10:57:52.668307 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: ROLLBACK
[0m10:57:52.668953 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c'
[0m10:57:52.669309 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c: Close
[0m10:57:52.670313 [info ] [Thread-4 (]: 39 of 124 PASS not_null_stg__vix_with_versions_loaded_at ....................... [[32mPASS[0m in 0.08s]
[0m10:57:52.671120 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c
[0m10:57:52.671510 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m10:57:52.671871 [info ] [Thread-4 (]: 43 of 124 START test not_null_stg__vix_with_versions_version_name .............. [RUN]
[0m10:57:52.672482 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_loaded_at.0a060c475c, now test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb)
[0m10:57:52.672867 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m10:57:52.681911 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m10:57:52.682828 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m10:57:52.684892 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m10:57:52.685671 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m10:57:52.686035 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: BEGIN
[0m10:57:52.686373 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:52.687587 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:57:52.687990 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"
[0m10:57:52.688377 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_name
from "finance"."analytics_dev"."stg__vix_with_versions"
where version_name is null



  
  
      
    ) dbt_internal_test
[0m10:57:52.731467 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m10:57:52.733718 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: ROLLBACK
[0m10:57:52.734320 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1'
[0m10:57:52.734669 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1: Close
[0m10:57:52.735566 [info ] [Thread-1 (]: 41 of 124 PASS not_null_stg__vix_with_versions_trade_date ...................... [[32mPASS[0m in 0.11s]
[0m10:57:52.736605 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1
[0m10:57:52.737001 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m10:57:52.737810 [debug] [Thread-3 (]: SQL status: OK in 0.081 seconds
[0m10:57:52.738287 [debug] [Thread-2 (]: SQL status: OK in 0.091 seconds
[0m10:57:52.737355 [info ] [Thread-1 (]: 44 of 124 START test not_null_stg__vix_with_versions_version_rank .............. [RUN]
[0m10:57:52.738921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_trade_date.8092e730f1, now test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578)
[0m10:57:52.739308 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m10:57:52.743650 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m10:57:52.745309 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: ROLLBACK
[0m10:57:52.746912 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: ROLLBACK
[0m10:57:52.747554 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c'
[0m10:57:52.748170 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c: Close
[0m10:57:52.748911 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21'
[0m10:57:52.749960 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21: Close
[0m10:57:52.750386 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m10:57:52.749571 [info ] [Thread-3 (]: 42 of 124 PASS not_null_stg__vix_with_versions_version_id ...................... [[32mPASS[0m in 0.11s]
[0m10:57:52.752871 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m10:57:52.753510 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c
[0m10:57:52.754593 [debug] [Thread-4 (]: SQL status: OK in 0.066 seconds
[0m10:57:52.754055 [info ] [Thread-2 (]: 40 of 124 PASS not_null_stg__vix_with_versions_normal_max ...................... [[32mPASS[0m in 0.13s]
[0m10:57:52.755223 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__price_changes
[0m10:57:52.756043 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21
[0m10:57:52.757064 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m10:57:52.758744 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: ROLLBACK
[0m10:57:52.756632 [info ] [Thread-3 (]: 45 of 124 START sql view model analytics_dev.int__price_changes ................ [RUN]
[0m10:57:52.759554 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: BEGIN
[0m10:57:52.760129 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_version_id.c2e4bf2a1c, now model.portfolio_project_2.int__price_changes)
[0m10:57:52.760725 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb'
[0m10:57:52.761132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:52.761690 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__price_changes
[0m10:57:52.762138 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb: Close
[0m10:57:52.765974 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__price_changes"
[0m10:57:52.766634 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:57:52.767039 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"
[0m10:57:52.767430 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select version_rank
from "finance"."analytics_dev"."stg__vix_with_versions"
where version_rank is null



  
  
      
    ) dbt_internal_test
[0m10:57:52.768238 [info ] [Thread-4 (]: 43 of 124 PASS not_null_stg__vix_with_versions_version_name .................... [[32mPASS[0m in 0.10s]
[0m10:57:52.768998 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__price_changes
[0m10:57:52.769705 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb
[0m10:57:52.773376 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__price_changes"
[0m10:57:52.774592 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m10:57:52.774970 [debug] [Thread-3 (]: On model.portfolio_project_2.int__price_changes: BEGIN
[0m10:57:52.775308 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:52.776579 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:57:52.776959 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m10:57:52.777377 [debug] [Thread-3 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

  
  create view "finance"."analytics_dev"."int__price_changes__dbt_tmp" as (
    with base as (
    select 
        trade_date,
        ticker,
        "close",
        loaded_at
    from "finance"."analytics_dev"."stg__stocks"
),

delta as (

    select
        trade_date,
        ticker,
        "close",
        "close" - lag("close", 1) over(partition by ticker order by trade_date asc, loaded_at asc) as delta,
        count(*) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as period_check,
        loaded_at
    from base 
),

final as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        (case when delta > 0 then delta else 0 end) as gain,
        (case when delta < 0 then abs(delta) else 0 end) as loss,
        row_number() over(partition by ticker order by trade_date asc, loaded_at asc) as rn,
        period_check,
        loaded_at
    from delta
)

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    rn::int as rn,
    period_check::int as period_check,
    loaded_at::timestamp as loaded_at
from final
  );

[0m10:57:52.862255 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m10:57:52.865324 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: ROLLBACK
[0m10:57:52.866130 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578'
[0m10:57:52.867123 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578: Close
[0m10:57:52.868583 [info ] [Thread-1 (]: 44 of 124 PASS not_null_stg__vix_with_versions_version_rank .................... [[32mPASS[0m in 0.13s]
[0m10:57:52.869457 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578
[0m10:57:52.870114 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m10:57:52.870630 [info ] [Thread-2 (]: 46 of 124 START sql view model analytics_dev.int__regime_classification ........ [RUN]
[0m10:57:52.871243 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_normal_max.754d496a21, now model.portfolio_project_2.int__regime_classification)
[0m10:57:52.871621 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m10:57:52.874314 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m10:57:52.875198 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m10:57:52.878684 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m10:57:52.879884 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:57:52.880313 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m10:57:52.880653 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:52.881925 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:57:52.882331 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:57:52.882770 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m10:57:52.891988 [debug] [Thread-3 (]: SQL status: OK in 0.114 seconds
[0m10:57:52.894838 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m10:57:52.895252 [debug] [Thread-3 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */
alter view "finance"."analytics_dev"."int__price_changes__dbt_tmp" rename to "int__price_changes"
[0m10:57:52.959300 [debug] [Thread-2 (]: SQL status: OK in 0.076 seconds
[0m10:57:52.963499 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:57:52.963997 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m10:57:52.965125 [debug] [Thread-3 (]: SQL status: OK in 0.069 seconds
[0m10:57:52.966645 [debug] [Thread-3 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m10:57:52.967399 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m10:57:52.968180 [debug] [Thread-3 (]: On model.portfolio_project_2.int__price_changes: COMMIT
[0m10:57:53.027940 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m10:57:53.029420 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m10:57:53.029839 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:57:53.030196 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m10:57:53.076928 [debug] [Thread-3 (]: SQL status: OK in 0.108 seconds
[0m10:57:53.080198 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__price_changes"
[0m10:57:53.080621 [debug] [Thread-3 (]: On model.portfolio_project_2.int__price_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__price_changes"} */

      drop view if exists "finance"."analytics_dev"."int__price_changes__dbt_backup" cascade
    
[0m10:57:53.154609 [debug] [Thread-2 (]: SQL status: OK in 0.124 seconds
[0m10:57:53.157607 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m10:57:53.158094 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m10:57:53.178688 [debug] [Thread-3 (]: SQL status: OK in 0.098 seconds
[0m10:57:53.180713 [debug] [Thread-3 (]: On model.portfolio_project_2.int__price_changes: Close
[0m10:57:53.181391 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DC3BDE10>]}
[0m10:57:53.182128 [info ] [Thread-3 (]: 45 of 124 OK created sql view model analytics_dev.int__price_changes ........... [[32mOK[0m in 0.42s]
[0m10:57:53.183187 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__price_changes
[0m10:57:53.184248 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m10:57:53.185258 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m10:57:53.186306 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m10:57:53.184779 [info ] [Thread-4 (]: 47 of 124 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [RUN]
[0m10:57:53.187468 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_version_name.284bc397cb, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7)
[0m10:57:53.187976 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m10:57:53.194590 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m10:57:53.185779 [info ] [Thread-3 (]: 49 of 124 START test dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [RUN]
[0m10:57:53.196159 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__price_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd)
[0m10:57:53.186827 [info ] [Thread-1 (]: 48 of 124 START test dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [RUN]
[0m10:57:53.197496 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m10:57:53.198329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_stg__vix_with_versions_version_rank.8b902ea578, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e)
[0m10:57:53.204100 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m10:57:53.204764 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m10:57:53.205302 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m10:57:53.212160 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m10:57:53.215804 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m10:57:53.216393 [debug] [Thread-2 (]: SQL status: OK in 0.058 seconds
[0m10:57:53.217171 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m10:57:53.219933 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m10:57:53.223459 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m10:57:53.224381 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD7EBB30>]}
[0m10:57:53.224872 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m10:57:53.225518 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m10:57:53.229274 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m10:57:53.226261 [info ] [Thread-2 (]: 46 of 124 OK created sql view model analytics_dev.int__regime_classification ... [[32mOK[0m in 0.35s]
[0m10:57:53.230281 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m10:57:53.230837 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: BEGIN
[0m10:57:53.231798 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m10:57:53.232355 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: BEGIN
[0m10:57:53.232874 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:53.233448 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m10:57:53.233950 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m10:57:53.234529 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:53.235853 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: BEGIN
[0m10:57:53.235424 [info ] [Thread-2 (]: 50 of 124 START test dbt_utils_expression_is_true_int__price_changes_gain___0 .. [RUN]
[0m10:57:53.236736 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m10:57:53.237199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:53.237770 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_classification, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724)
[0m10:57:53.238276 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"
[0m10:57:53.238683 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m10:57:53.239356 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m10:57:53.239920 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta > 0 and gain = delta) or (delta <= 0 and gain = 0))


  
  
      
    ) dbt_internal_test
[0m10:57:53.240385 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"
[0m10:57:53.244312 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m10:57:53.244762 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:57:53.245636 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(abs(abs(delta) - (gain + loss)) <= 1e-9)


  
  
      
    ) dbt_internal_test
[0m10:57:53.247043 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"
[0m10:57:53.248348 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not((delta < 0 and loss = -delta) or (delta >= 0 and loss = 0))


  
  
      
    ) dbt_internal_test
[0m10:57:53.249030 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m10:57:53.251586 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m10:57:53.252520 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m10:57:53.252916 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: BEGIN
[0m10:57:53.253265 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:53.254675 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:57:53.255112 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"
[0m10:57:53.255480 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:53.335562 [debug] [Thread-4 (]: SQL status: OK in 0.090 seconds
[0m10:57:53.336091 [debug] [Thread-3 (]: SQL status: OK in 0.088 seconds
[0m10:57:53.337871 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: ROLLBACK
[0m10:57:53.338484 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7'
[0m10:57:53.338847 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7: Close
[0m10:57:53.340143 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: ROLLBACK
[0m10:57:53.340747 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd'
[0m10:57:53.341131 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd: Close
[0m10:57:53.341729 [info ] [Thread-4 (]: 47 of 124 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_  [[32mPASS[0m in 0.15s]
[0m10:57:53.342969 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7
[0m10:57:53.343389 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m10:57:53.342261 [info ] [Thread-3 (]: 49 of 124 PASS dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9  [[32mPASS[0m in 0.15s]
[0m10:57:53.344619 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd
[0m10:57:53.345137 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m10:57:53.343783 [info ] [Thread-4 (]: 51 of 124 START test dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp  [RUN]
[0m10:57:53.346321 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_gain_delta_or_delta_0_and_gain_0_.da506a4fb7, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a)
[0m10:57:53.346718 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m10:57:53.355093 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m10:57:53.355731 [debug] [Thread-2 (]: SQL status: OK in 0.100 seconds
[0m10:57:53.356349 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m10:57:53.345578 [info ] [Thread-3 (]: 52 of 124 START test dbt_utils_expression_is_true_int__price_changes_loss___0 .. [RUN]
[0m10:57:53.357185 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_abs_abs_delta_gain_loss_1e_9.680f7279dd, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5)
[0m10:57:53.357653 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m10:57:53.362279 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m10:57:53.364108 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: ROLLBACK
[0m10:57:53.365460 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: ROLLBACK
[0m10:57:53.366122 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724'
[0m10:57:53.366622 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m10:57:53.367251 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e'
[0m10:57:53.367710 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724: Close
[0m10:57:53.370446 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m10:57:53.370954 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e: Close
[0m10:57:53.371377 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m10:57:53.373964 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m10:57:53.374642 [info ] [Thread-1 (]: 48 of 124 PASS dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_  [[32mPASS[0m in 0.18s]
[0m10:57:53.375990 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e
[0m10:57:53.376655 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m10:57:53.377495 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m10:57:53.377890 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: BEGIN
[0m10:57:53.378403 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:53.375160 [info ] [Thread-2 (]: 50 of 124 PASS dbt_utils_expression_is_true_int__price_changes_gain___0 ........ [[32mPASS[0m in 0.14s]
[0m10:57:53.379518 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724
[0m10:57:53.379962 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m10:57:53.377075 [info ] [Thread-1 (]: 53 of 124 START test dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [RUN]
[0m10:57:53.381240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes__delta_0_and_loss_delta_or_delta_0_and_loss_0_.2447bb934e, now test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96)
[0m10:57:53.382091 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m10:57:53.386980 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m10:57:53.387457 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m10:57:53.388048 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m10:57:53.380345 [info ] [Thread-2 (]: 54 of 124 START test dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [RUN]
[0m10:57:53.388665 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"
[0m10:57:53.389235 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: BEGIN
[0m10:57:53.389662 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m10:57:53.390165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_gain___0.136224f724, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97)
[0m10:57:53.390617 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:53.391066 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:53.393851 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m10:57:53.394362 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m10:57:53.400123 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m10:57:53.400811 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m10:57:53.401249 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"
[0m10:57:53.401668 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m10:57:53.402361 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m10:57:53.402761 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: BEGIN
[0m10:57:53.403130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:53.403788 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m10:57:53.406320 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m10:57:53.406967 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:57:53.407390 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"
[0m10:57:53.407886 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__price_changes"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m10:57:53.408861 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m10:57:53.409286 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: BEGIN
[0m10:57:53.409637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:53.410730 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:57:53.411096 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"
[0m10:57:53.411468 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__price_changes"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:57:53.480163 [debug] [Thread-3 (]: SQL status: OK in 0.085 seconds
[0m10:57:53.482491 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: ROLLBACK
[0m10:57:53.483151 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5'
[0m10:57:53.483510 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5: Close
[0m10:57:53.484464 [info ] [Thread-3 (]: 52 of 124 PASS dbt_utils_expression_is_true_int__price_changes_loss___0 ........ [[32mPASS[0m in 0.13s]
[0m10:57:53.485298 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5
[0m10:57:53.485714 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m10:57:53.486095 [info ] [Thread-3 (]: 55 of 124 START test not_null_int__price_changes_close ......................... [RUN]
[0m10:57:53.486716 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loss___0.5dac5ae3b5, now test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5)
[0m10:57:53.487099 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m10:57:53.490881 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m10:57:53.491715 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m10:57:53.494152 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m10:57:53.494976 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m10:57:53.495348 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: BEGIN
[0m10:57:53.495687 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:53.497030 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:57:53.497438 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"
[0m10:57:53.497818 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__price_changes"
where close is null



  
  
      
    ) dbt_internal_test
[0m10:57:53.557180 [debug] [Thread-4 (]: SQL status: OK in 0.155 seconds
[0m10:57:53.557639 [debug] [Thread-1 (]: SQL status: OK in 0.149 seconds
[0m10:57:53.560048 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: ROLLBACK
[0m10:57:53.560720 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96'
[0m10:57:53.561133 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96: Close
[0m10:57:53.562846 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: ROLLBACK
[0m10:57:53.563389 [debug] [Thread-2 (]: SQL status: OK in 0.152 seconds
[0m10:57:53.564622 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a'
[0m10:57:53.565003 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a: Close
[0m10:57:53.564074 [info ] [Thread-1 (]: 53 of 124 PASS dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14  [[32mPASS[0m in 0.18s]
[0m10:57:53.565730 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96
[0m10:57:53.566151 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m10:57:53.567966 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: ROLLBACK
[0m10:57:53.568595 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97'
[0m10:57:53.568960 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97: Close
[0m10:57:53.566538 [info ] [Thread-1 (]: 56 of 124 START test not_null_int__price_changes_gain .......................... [RUN]
[0m10:57:53.570246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_period_check__between_1_and_14.8e44fdab96, now test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13)
[0m10:57:53.571225 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m10:57:53.575232 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m10:57:53.569794 [info ] [Thread-4 (]: 51 of 124 PASS dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp  [[32mPASS[0m in 0.22s]
[0m10:57:53.576224 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a
[0m10:57:53.576639 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m10:57:53.570843 [info ] [Thread-2 (]: 54 of 124 PASS dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn  [[32mPASS[0m in 0.18s]
[0m10:57:53.578015 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97
[0m10:57:53.578511 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m10:57:53.579919 [debug] [Thread-3 (]: SQL status: OK in 0.082 seconds
[0m10:57:53.577005 [info ] [Thread-4 (]: 57 of 124 START test not_null_int__price_changes_loaded_at ..................... [RUN]
[0m10:57:53.580678 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m10:57:53.581211 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__price_changes_loaded_at___current_timestamp.b0b3ec9f4a, now test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f)
[0m10:57:53.579015 [info ] [Thread-2 (]: 58 of 124 START test not_null_int__price_changes_loss .......................... [RUN]
[0m10:57:53.584104 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m10:57:53.585474 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: ROLLBACK
[0m10:57:53.585922 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m10:57:53.586387 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__price_changes_ticker__rn.fe0289ab97, now test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa)
[0m10:57:53.587199 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5'
[0m10:57:53.591042 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m10:57:53.591566 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m10:57:53.592045 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5: Close
[0m10:57:53.592498 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m10:57:53.596648 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m10:57:53.597387 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: BEGIN
[0m10:57:53.598099 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m10:57:53.598564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:53.601417 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m10:57:53.601987 [info ] [Thread-3 (]: 55 of 124 PASS not_null_int__price_changes_close ............................... [[32mPASS[0m in 0.12s]
[0m10:57:53.603238 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5
[0m10:57:53.603681 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m10:57:53.604407 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m10:57:53.606786 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m10:57:53.607448 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:57:53.604056 [info ] [Thread-3 (]: 59 of 124 START test not_null_int__price_changes_rn ............................ [RUN]
[0m10:57:53.608055 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"
[0m10:57:53.608620 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_close.ed2dc646a5, now test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638)
[0m10:57:53.609085 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m10:57:53.609630 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m10:57:53.610225 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__price_changes"
where gain is null



  
  
      
    ) dbt_internal_test
[0m10:57:53.610711 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m10:57:53.611154 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: BEGIN
[0m10:57:53.611592 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: BEGIN
[0m10:57:53.616307 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m10:57:53.616828 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:53.617265 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:53.618345 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m10:57:53.620802 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m10:57:53.621428 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m10:57:53.621820 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"
[0m10:57:53.622205 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__price_changes"
where loss is null



  
  
      
    ) dbt_internal_test
[0m10:57:53.622619 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m10:57:53.622994 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"
[0m10:57:53.623374 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__price_changes"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m10:57:53.624289 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m10:57:53.624682 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: BEGIN
[0m10:57:53.625110 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:53.626264 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:57:53.626664 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"
[0m10:57:53.627026 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__price_changes"
where rn is null



  
  
      
    ) dbt_internal_test
[0m10:57:53.686546 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m10:57:53.689475 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: ROLLBACK
[0m10:57:53.690348 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13'
[0m10:57:53.690853 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13: Close
[0m10:57:53.692090 [info ] [Thread-1 (]: 56 of 124 PASS not_null_int__price_changes_gain ................................ [[32mPASS[0m in 0.12s]
[0m10:57:53.693230 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13
[0m10:57:53.693812 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m10:57:53.694366 [info ] [Thread-1 (]: 60 of 124 START test not_null_int__price_changes_ticker ........................ [RUN]
[0m10:57:53.695308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_gain.5228f22e13, now test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a)
[0m10:57:53.695869 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m10:57:53.701135 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m10:57:53.702305 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m10:57:53.705769 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m10:57:53.706904 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m10:57:53.707455 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: BEGIN
[0m10:57:53.708084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:53.708937 [debug] [Thread-2 (]: SQL status: OK in 0.086 seconds
[0m10:57:53.709754 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:57:53.710185 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"
[0m10:57:53.710603 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__price_changes"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m10:57:53.712381 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: ROLLBACK
[0m10:57:53.713164 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa'
[0m10:57:53.713603 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa: Close
[0m10:57:53.714651 [info ] [Thread-2 (]: 58 of 124 PASS not_null_int__price_changes_loss ................................ [[32mPASS[0m in 0.13s]
[0m10:57:53.715513 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa
[0m10:57:53.715937 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m10:57:53.716316 [info ] [Thread-2 (]: 61 of 124 START test not_null_int__price_changes_trade_date .................... [RUN]
[0m10:57:53.717004 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loss.43ebc15afa, now test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5)
[0m10:57:53.717384 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m10:57:53.723136 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m10:57:53.723676 [debug] [Thread-4 (]: SQL status: OK in 0.100 seconds
[0m10:57:53.724212 [debug] [Thread-3 (]: SQL status: OK in 0.097 seconds
[0m10:57:53.724925 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m10:57:53.730743 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m10:57:53.732390 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: ROLLBACK
[0m10:57:53.733046 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638'
[0m10:57:53.733417 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638: Close
[0m10:57:53.734733 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: ROLLBACK
[0m10:57:53.735580 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f'
[0m10:57:53.736749 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f: Close
[0m10:57:53.736373 [info ] [Thread-3 (]: 59 of 124 PASS not_null_int__price_changes_rn .................................. [[32mPASS[0m in 0.13s]
[0m10:57:53.737610 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638
[0m10:57:53.738048 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m10:57:53.738443 [info ] [Thread-3 (]: 62 of 124 START test accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis  [RUN]
[0m10:57:53.739632 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m10:57:53.740097 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_rn.1f1b072638, now test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b)
[0m10:57:53.740549 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: BEGIN
[0m10:57:53.740974 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m10:57:53.739075 [info ] [Thread-4 (]: 57 of 124 PASS not_null_int__price_changes_loaded_at ........................... [[32mPASS[0m in 0.16s]
[0m10:57:53.741575 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:53.752897 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m10:57:53.753575 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f
[0m10:57:53.754476 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m10:57:53.754885 [info ] [Thread-4 (]: 63 of 124 START test dbt_utils_expression_is_true_int__regime_classification_close___0  [RUN]
[0m10:57:53.755542 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_loaded_at.6c86c5b88f, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6)
[0m10:57:53.755914 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m10:57:53.759901 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m10:57:53.760678 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m10:57:53.761091 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"
[0m10:57:53.761482 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__price_changes"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m10:57:53.762164 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m10:57:53.764974 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m10:57:53.765557 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m10:57:53.768587 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m10:57:53.769330 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m10:57:53.770030 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m10:57:53.770422 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: BEGIN
[0m10:57:53.770808 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:53.772712 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: ROLLBACK
[0m10:57:53.773363 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5'
[0m10:57:53.773729 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5: Close
[0m10:57:53.774172 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m10:57:53.774773 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: BEGIN
[0m10:57:53.775161 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:53.776295 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m10:57:53.776741 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m10:57:53.777134 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"
[0m10:57:53.777527 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_classification"

where not(close > 0)


  
  
      
    ) dbt_internal_test
[0m10:57:53.775909 [info ] [Thread-2 (]: 61 of 124 PASS not_null_int__price_changes_trade_date .......................... [[32mPASS[0m in 0.06s]
[0m10:57:53.778281 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5
[0m10:57:53.778811 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m10:57:53.779591 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m10:57:53.780138 [info ] [Thread-2 (]: 64 of 124 START test dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp  [RUN]
[0m10:57:53.782155 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: ROLLBACK
[0m10:57:53.782683 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"
[0m10:57:53.783216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_trade_date.34fb17c6c5, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed)
[0m10:57:53.783926 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a'
[0m10:57:53.784370 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regime as value_field,
        count(*) as n_records

    from "finance"."analytics_dev"."int__regime_classification"
    group by regime

)

select *
from all_values
where value_field not in (
    'complacent','normal','elevated','crisis'
)



  
  
      
    ) dbt_internal_test
[0m10:57:53.784851 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m10:57:53.785288 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a: Close
[0m10:57:53.790472 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m10:57:53.793741 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m10:57:53.799428 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m10:57:53.792266 [info ] [Thread-1 (]: 60 of 124 PASS not_null_int__price_changes_ticker .............................. [[32mPASS[0m in 0.10s]
[0m10:57:53.801013 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a
[0m10:57:53.801853 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m10:57:53.802732 [info ] [Thread-1 (]: 65 of 124 START test dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date  [RUN]
[0m10:57:53.803852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__price_changes_ticker.ffa0a2963a, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f)
[0m10:57:53.804683 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m10:57:53.805224 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m10:57:53.805871 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: BEGIN
[0m10:57:53.811406 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m10:57:53.812347 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:53.813953 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m10:57:53.819237 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m10:57:53.819724 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m10:57:53.820371 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"
[0m10:57:53.820795 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_classification"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m10:57:53.821779 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m10:57:53.822343 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: BEGIN
[0m10:57:53.822708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:53.824162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:57:53.824952 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"
[0m10:57:53.825471 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_classification"

where not(trade_date <= current_date)


  
  
      
    ) dbt_internal_test
[0m10:57:53.846946 [debug] [Thread-4 (]: SQL status: OK in 0.069 seconds
[0m10:57:53.851956 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: ROLLBACK
[0m10:57:53.852741 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6'
[0m10:57:53.853106 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6: Close
[0m10:57:53.854048 [info ] [Thread-4 (]: 63 of 124 PASS dbt_utils_expression_is_true_int__regime_classification_close___0  [[32mPASS[0m in 0.10s]
[0m10:57:53.854849 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6
[0m10:57:53.855262 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m10:57:53.855646 [info ] [Thread-4 (]: 66 of 124 START test not_null_int__regime_classification_loaded_at ............. [RUN]
[0m10:57:53.856249 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_close___0.1d998ddbb6, now test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b)
[0m10:57:53.856622 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m10:57:53.860223 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m10:57:53.861104 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m10:57:53.863822 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m10:57:53.864748 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m10:57:53.865112 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: BEGIN
[0m10:57:53.865444 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:53.866578 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:57:53.867080 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"
[0m10:57:53.867448 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__regime_classification"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m10:57:53.867995 [debug] [Thread-3 (]: SQL status: OK in 0.082 seconds
[0m10:57:53.870569 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: ROLLBACK
[0m10:57:53.871245 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b'
[0m10:57:53.871648 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b: Close
[0m10:57:53.872573 [info ] [Thread-3 (]: 62 of 124 PASS accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis  [[32mPASS[0m in 0.13s]
[0m10:57:53.873395 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b
[0m10:57:53.873932 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m10:57:53.874301 [info ] [Thread-3 (]: 67 of 124 START test not_null_int__regime_classification_regime ................ [RUN]
[0m10:57:53.874930 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.accepted_values_int__regime_classification_regime__complacent__normal__elevated__crisis.1db534a31b, now test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6)
[0m10:57:53.875318 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m10:57:53.879713 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m10:57:53.880666 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m10:57:53.883143 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m10:57:53.883950 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m10:57:53.884314 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: BEGIN
[0m10:57:53.884648 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:53.885742 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:57:53.886104 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"
[0m10:57:53.886622 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select regime
from "finance"."analytics_dev"."int__regime_classification"
where regime is null



  
  
      
    ) dbt_internal_test
[0m10:57:53.887240 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m10:57:53.887652 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m10:57:53.890161 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: ROLLBACK
[0m10:57:53.890977 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f'
[0m10:57:53.891480 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f: Close
[0m10:57:53.892911 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: ROLLBACK
[0m10:57:53.893524 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed'
[0m10:57:53.893893 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed: Close
[0m10:57:53.894889 [info ] [Thread-2 (]: 64 of 124 PASS dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp  [[32mPASS[0m in 0.11s]
[0m10:57:53.896853 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed
[0m10:57:53.897288 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m10:57:53.896059 [info ] [Thread-1 (]: 65 of 124 PASS dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date  [[32mPASS[0m in 0.09s]
[0m10:57:53.898929 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f
[0m10:57:53.899469 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m10:57:53.897959 [info ] [Thread-2 (]: 68 of 124 START test not_null_int__regime_classification_trade_date ............ [RUN]
[0m10:57:53.900513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_loaded_at___current_timestamp.ec6fae86ed, now test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade)
[0m10:57:53.900987 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m10:57:53.899846 [info ] [Thread-1 (]: 69 of 124 START test relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_  [RUN]
[0m10:57:53.905655 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m10:57:53.906243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_classification_trade_date___current_date.58f478c84f, now test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5)
[0m10:57:53.906874 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m10:57:53.914721 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m10:57:53.915505 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m10:57:53.918146 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m10:57:53.918981 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m10:57:53.921122 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m10:57:53.921928 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m10:57:53.922355 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: BEGIN
[0m10:57:53.922702 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:53.923500 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m10:57:53.923891 [debug] [Thread-1 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: BEGIN
[0m10:57:53.924234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:53.924869 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:57:53.925249 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"
[0m10:57:53.925636 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__regime_classification"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m10:57:53.926284 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:57:53.926657 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"
[0m10:57:53.927038 [debug] [Thread-1 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select trade_date as from_field
    from "finance"."analytics_dev"."int__regime_classification"
    where trade_date is not null
),

parent as (
    select trade_date as to_field
    from "finance"."analytics_dev"."stg__vix_with_versions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m10:57:53.950075 [debug] [Thread-4 (]: SQL status: OK in 0.082 seconds
[0m10:57:53.956684 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: ROLLBACK
[0m10:57:53.958149 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b'
[0m10:57:53.959020 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b: Close
[0m10:57:53.960917 [info ] [Thread-4 (]: 66 of 124 PASS not_null_int__regime_classification_loaded_at ................... [[32mPASS[0m in 0.10s]
[0m10:57:53.962519 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b
[0m10:57:53.963330 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m10:57:53.964208 [info ] [Thread-4 (]: 70 of 124 START test unique_int__regime_classification_trade_date .............. [RUN]
[0m10:57:53.965313 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_classification_loaded_at.b58a45c29b, now test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4)
[0m10:57:53.965902 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m10:57:53.976112 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m10:57:53.979351 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m10:57:53.985733 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m10:57:53.988378 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m10:57:53.989257 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: BEGIN
[0m10:57:53.989732 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:53.991678 [debug] [Thread-2 (]: SQL status: OK in 0.065 seconds
[0m10:57:53.992774 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m10:57:53.993382 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"
[0m10:57:53.993777 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."int__regime_classification"
where trade_date is not null
group by trade_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:57:53.995577 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: ROLLBACK
[0m10:57:53.996504 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade'
[0m10:57:53.996877 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade: Close
[0m10:57:53.997822 [info ] [Thread-2 (]: 68 of 124 PASS not_null_int__regime_classification_trade_date .................. [[32mPASS[0m in 0.10s]
[0m10:57:53.998742 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade
[0m10:57:53.999653 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__rsi_sma
[0m10:57:54.000586 [debug] [Thread-3 (]: SQL status: OK in 0.114 seconds
[0m10:57:54.000203 [info ] [Thread-2 (]: 71 of 124 START sql view model analytics_dev.int__rsi_sma ...................... [RUN]
[0m10:57:54.001367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_classification_trade_date.9a7a782ade, now model.portfolio_project_2.int__rsi_sma)
[0m10:57:54.001799 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__rsi_sma
[0m10:57:54.003413 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: ROLLBACK
[0m10:57:54.006314 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_sma"
[0m10:57:54.006823 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m10:57:54.007580 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6'
[0m10:57:54.008088 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6: Close
[0m10:57:54.008702 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__rsi_sma
[0m10:57:54.016208 [debug] [Thread-1 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: ROLLBACK
[0m10:57:54.009315 [info ] [Thread-3 (]: 67 of 124 PASS not_null_int__regime_classification_regime ...................... [[32mPASS[0m in 0.13s]
[0m10:57:54.018980 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_sma"
[0m10:57:54.019641 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6
[0m10:57:54.020201 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5'
[0m10:57:54.020932 [debug] [Thread-1 (]: On test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5: Close
[0m10:57:54.021589 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m10:57:54.021995 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_sma: BEGIN
[0m10:57:54.022362 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:54.023700 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:57:54.024105 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m10:57:54.024508 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

  
  create view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" as (
    with base as (
select
    trade_date,
    ticker,
    "close",
    delta,
    gain,
    loss,
    rn,
    period_check,
    loaded_at
from "finance"."analytics_dev"."int__price_changes"
),

rsi_sma as (
    select
        trade_date,
        ticker,
        "close",
        delta,
        gain,
        loss,
        avg(gain) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc 
            rows between 13 preceding and current row) as sma_gain,
        avg(loss) over(
            partition by ticker 
            order by trade_date asc, loaded_at asc
            rows between 13 preceding and current row) as sma_loss,
        rn,
        loaded_at,
        period_check
    from base
)


select
    trade_date::date as trade_date,
    ticker::text as ticker,
    "close"::decimal(18,2) as "close",
    delta::decimal(18,2) as delta,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    sma_gain::decimal(18,2) as sma_gain,
    sma_loss::decimal(18,2) as sma_loss,
    rn::int as rn,
    loaded_at::timestamp as loaded_at,
    period_check::int as period_check
from rsi_sma
  );

[0m10:57:54.023211 [info ] [Thread-1 (]: 69 of 124 PASS relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_  [[32mPASS[0m in 0.12s]
[0m10:57:54.025538 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5
[0m10:57:54.070335 [debug] [Thread-4 (]: SQL status: OK in 0.076 seconds
[0m10:57:54.072725 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: ROLLBACK
[0m10:57:54.073329 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4'
[0m10:57:54.073673 [debug] [Thread-4 (]: On test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4: Close
[0m10:57:54.074586 [info ] [Thread-4 (]: 70 of 124 PASS unique_int__regime_classification_trade_date .................... [[32mPASS[0m in 0.11s]
[0m10:57:54.075388 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4
[0m10:57:54.076088 [debug] [Thread-1 (]: Began running node snapshot.portfolio_project_2.regime_classification_snapshot
[0m10:57:54.076962 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m10:57:54.076589 [info ] [Thread-1 (]: 73 of 124 START snapshot analytics_dev_snapshots.regime_classification_snapshot  [RUN]
[0m10:57:54.077990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.relationships_int__regime_classification_trade_date__trade_date__ref_stg__vix_with_versions_.7c9484aad5, now snapshot.portfolio_project_2.regime_classification_snapshot)
[0m10:57:54.078397 [debug] [Thread-1 (]: Began compiling node snapshot.portfolio_project_2.regime_classification_snapshot
[0m10:57:54.081583 [debug] [Thread-1 (]: Began executing node snapshot.portfolio_project_2.regime_classification_snapshot
[0m10:57:54.077455 [info ] [Thread-3 (]: 72 of 124 START sql view model analytics_dev.int__regime_changes ............... [RUN]
[0m10:57:54.106902 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_classification_regime.3b60b975f6, now model.portfolio_project_2.int__regime_changes)
[0m10:57:54.107381 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m10:57:54.110351 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m10:57:54.122234 [debug] [Thread-2 (]: SQL status: OK in 0.097 seconds
[0m10:57:54.131496 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:57:54.134921 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m10:57:54.135428 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: BEGIN
[0m10:57:54.135932 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */
alter view "finance"."analytics_dev"."int__rsi_sma__dbt_tmp" rename to "int__rsi_sma"
[0m10:57:54.136408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:54.136847 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m10:57:54.140897 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m10:57:54.141557 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:57:54.141954 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:57:54.142368 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m10:57:54.143159 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:57:54.143583 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m10:57:54.143933 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:54.145171 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:57:54.145572 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:57:54.146047 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m10:57:54.148988 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:57:54.197655 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:57:54.198240 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

        
  
    
    

    create  table
      "regime_classification_snapshot__dbt_tmp20251111105754189683"
  
    as (
      
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."int__regime_classification"

    ),

    snapshotted_data as (

        select *, 
    
        trade_date as dbt_unique_key
    

        from "finance"."analytics_dev_snapshots"."regime_classification_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
  
    
[0m10:57:54.199857 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m10:57:54.201149 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m10:57:54.201528 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m10:57:54.201870 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_sma: COMMIT
[0m10:57:54.233079 [debug] [Thread-3 (]: SQL status: OK in 0.086 seconds
[0m10:57:54.236295 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:57:54.236670 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m10:57:54.317252 [debug] [Thread-2 (]: SQL status: OK in 0.115 seconds
[0m10:57:54.320226 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_sma"
[0m10:57:54.320679 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_sma"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_sma__dbt_backup" cascade
    
[0m10:57:54.440158 [debug] [Thread-2 (]: SQL status: OK in 0.119 seconds
[0m10:57:54.442151 [debug] [Thread-2 (]: On model.portfolio_project_2.int__rsi_sma: Close
[0m10:57:54.442733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD9B56D0>]}
[0m10:57:54.443701 [debug] [Thread-3 (]: SQL status: OK in 0.207 seconds
[0m10:57:54.443319 [info ] [Thread-2 (]: 71 of 124 OK created sql view model analytics_dev.int__rsi_sma ................. [[32mOK[0m in 0.44s]
[0m10:57:54.445727 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m10:57:54.446532 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__rsi_sma
[0m10:57:54.447151 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:57:54.447828 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m10:57:54.448595 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m10:57:54.449031 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m10:57:54.449527 [info ] [Thread-4 (]: 74 of 124 START test dbt_utils_expression_is_true_int__rsi_sma_gain___0 ........ [RUN]
[0m10:57:54.450563 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.unique_int__regime_classification_trade_date.d675eda6c4, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6)
[0m10:57:54.450961 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m10:57:54.454807 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m10:57:54.455529 [debug] [Thread-1 (]: SQL status: OK in 0.257 seconds
[0m10:57:54.458429 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:57:54.458849 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251111105754189683'
      
      
      order by ordinal_position

  
[0m10:57:54.449988 [info ] [Thread-2 (]: 75 of 124 START test dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp  [RUN]
[0m10:57:54.459616 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_sma, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772)
[0m10:57:54.460051 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m10:57:54.464186 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m10:57:54.464980 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:57:54.465636 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m10:57:54.468667 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m10:57:54.474235 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:57:54.474709 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m10:57:54.475531 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m10:57:54.475991 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m10:57:54.478547 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m10:57:54.479452 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: BEGIN
[0m10:57:54.480368 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:54.481464 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:57:54.484937 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:57:54.485360 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251111105754189683'
      
      
      order by ordinal_position

  
[0m10:57:54.485773 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m10:57:54.486262 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m10:57:54.487200 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"
[0m10:57:54.487749 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: BEGIN
[0m10:57:54.488241 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:54.488716 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:54.490274 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:57:54.490701 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"
[0m10:57:54.491079 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loaded_at <= current_timestamp)


  
  
      
    ) dbt_internal_test
[0m10:57:54.491769 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:57:54.495422 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:57:54.496355 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot'
      
      and lower(table_schema) = 'analytics_dev_snapshots'
      
      
      and lower(table_catalog) = 'finance'
      
      order by ordinal_position

  
[0m10:57:54.502403 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:57:54.509208 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:57:54.509914 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'regime_classification_snapshot__dbt_tmp20251111105754189683'
      
      
      order by ordinal_position

  
[0m10:57:54.516549 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:57:54.537038 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:57:54.537591 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */
DESCRIBE (select * from (
        
    
    with snapshot_query as (

        select * from "finance"."analytics_dev"."int__regime_classification"

    ),

    snapshotted_data as (

        select *, 
    
        trade_date as dbt_unique_key
    

        from "finance"."analytics_dev_snapshots"."regime_classification_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            
  
  coalesce(nullif(loaded_at, loaded_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(trade_date as varchar ), '')
         || '|' || coalesce(cast(loaded_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        trade_date as dbt_unique_key
    
,
            loaded_at as dbt_updated_at,
            loaded_at as dbt_valid_from,
            loaded_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.loaded_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.loaded_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:57:54.543415 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:57:54.553114 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:57:54.553593 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:57:54.555058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:57:54.555876 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:57:54.557075 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:57:54.557669 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      update "finance"."analytics_dev_snapshots"."regime_classification_snapshot" as DBT_INTERNAL_TARGET
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "regime_classification_snapshot__dbt_tmp20251111105754189683" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = DBT_INTERNAL_TARGET.dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and DBT_INTERNAL_TARGET.dbt_valid_to is null;
      

    insert into "finance"."analytics_dev_snapshots"."regime_classification_snapshot" ("trade_date", "close", "regime", "loaded_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."trade_date",DBT_INTERNAL_SOURCE."close",DBT_INTERNAL_SOURCE."regime",DBT_INTERNAL_SOURCE."loaded_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "regime_classification_snapshot__dbt_tmp20251111105754189683" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;


  
[0m10:57:54.602537 [debug] [Thread-3 (]: SQL status: OK in 0.154 seconds
[0m10:57:54.608606 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m10:57:54.609094 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m10:57:54.681954 [debug] [Thread-4 (]: SQL status: OK in 0.193 seconds
[0m10:57:54.682530 [debug] [Thread-2 (]: SQL status: OK in 0.191 seconds
[0m10:57:54.685195 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: ROLLBACK
[0m10:57:54.685981 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6'
[0m10:57:54.686405 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6: Close
[0m10:57:54.687998 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: ROLLBACK
[0m10:57:54.688485 [debug] [Thread-3 (]: SQL status: OK in 0.079 seconds
[0m10:57:54.689239 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772'
[0m10:57:54.690403 [debug] [Thread-1 (]: SQL status: OK in 0.132 seconds
[0m10:57:54.691968 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m10:57:54.689927 [info ] [Thread-4 (]: 74 of 124 PASS dbt_utils_expression_is_true_int__rsi_sma_gain___0 .............. [[32mPASS[0m in 0.24s]
[0m10:57:54.692638 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772: Close
[0m10:57:54.694066 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: COMMIT
[0m10:57:54.694933 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6
[0m10:57:54.695574 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DDBAF170>]}
[0m10:57:54.696304 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:57:54.696924 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m10:57:54.697796 [info ] [Thread-3 (]: 72 of 124 OK created sql view model analytics_dev.int__regime_changes .......... [[32mOK[0m in 0.59s]
[0m10:57:54.699121 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: COMMIT
[0m10:57:54.700467 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m10:57:54.698451 [info ] [Thread-2 (]: 75 of 124 PASS dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp  [[32mPASS[0m in 0.24s]
[0m10:57:54.701418 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m10:57:54.702345 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772
[0m10:57:54.699744 [info ] [Thread-4 (]: 76 of 124 START test dbt_utils_expression_is_true_int__rsi_sma_loss___0 ........ [RUN]
[0m10:57:54.704068 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m10:57:54.703329 [info ] [Thread-3 (]: 77 of 124 START test dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [RUN]
[0m10:57:54.704824 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_gain___0.581372c9e6, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62)
[0m10:57:54.705969 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__regime_changes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704)
[0m10:57:54.705524 [info ] [Thread-2 (]: 78 of 124 START test dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 .... [RUN]
[0m10:57:54.706567 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m10:57:54.707018 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m10:57:54.707527 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loaded_at___current_timestamp.aec1719772, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9)
[0m10:57:54.712205 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m10:57:54.717796 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m10:57:54.718359 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m10:57:54.725586 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m10:57:54.727019 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m10:57:54.732207 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m10:57:54.733033 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m10:57:54.733495 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m10:57:54.736365 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m10:57:54.738789 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m10:57:54.739570 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m10:57:54.740461 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: BEGIN
[0m10:57:54.740987 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:54.741869 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m10:57:54.742322 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: BEGIN
[0m10:57:54.742681 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:54.743291 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m10:57:54.743713 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: BEGIN
[0m10:57:54.744090 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:54.744727 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m10:57:54.745156 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:57:54.745634 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"
[0m10:57:54.746334 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"
[0m10:57:54.747082 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m10:57:54.748222 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:54.748767 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_sma"

where not(period_check between 1 and 14)


  
  
      
    ) dbt_internal_test
[0m10:57:54.749278 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"
[0m10:57:54.750240 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:54.810926 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m10:57:54.813771 [debug] [Thread-1 (]: Using duckdb connection "snapshot.portfolio_project_2.regime_classification_snapshot"
[0m10:57:54.814164 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "snapshot.portfolio_project_2.regime_classification_snapshot"} */

      drop table if exists "regime_classification_snapshot__dbt_tmp20251111105754189683" cascade
    
[0m10:57:54.916737 [debug] [Thread-3 (]: SQL status: OK in 0.167 seconds
[0m10:57:54.917292 [debug] [Thread-4 (]: SQL status: OK in 0.168 seconds
[0m10:57:54.919070 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: ROLLBACK
[0m10:57:54.919759 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704'
[0m10:57:54.920123 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704: Close
[0m10:57:54.921465 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: ROLLBACK
[0m10:57:54.922125 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62'
[0m10:57:54.922498 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62: Close
[0m10:57:54.923100 [info ] [Thread-3 (]: 77 of 124 PASS dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14  [[32mPASS[0m in 0.22s]
[0m10:57:54.924361 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704
[0m10:57:54.924781 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m10:57:54.923610 [info ] [Thread-4 (]: 76 of 124 PASS dbt_utils_expression_is_true_int__rsi_sma_loss___0 .............. [[32mPASS[0m in 0.22s]
[0m10:57:54.925907 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62
[0m10:57:54.926288 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m10:57:54.925167 [info ] [Thread-3 (]: 79 of 124 START test dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 .... [RUN]
[0m10:57:54.927310 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_period_check__between_1_and_14.2532dfb704, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21)
[0m10:57:54.927699 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m10:57:54.931897 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m10:57:54.926643 [info ] [Thread-4 (]: 80 of 124 START test dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn  [RUN]
[0m10:57:54.932802 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_loss___0.008d62dc62, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08)
[0m10:57:54.933202 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m10:57:54.937160 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m10:57:54.938118 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m10:57:54.940656 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m10:57:54.941446 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m10:57:54.943849 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m10:57:54.944874 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m10:57:54.945288 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: BEGIN
[0m10:57:54.945859 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m10:57:54.946437 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:54.946946 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: BEGIN
[0m10:57:54.947699 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:54.948341 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:57:54.948819 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"
[0m10:57:54.949323 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery

where not(sma_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:54.949877 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m10:57:54.950253 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"
[0m10:57:54.950630 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_sma"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:57:54.958172 [debug] [Thread-2 (]: SQL status: OK in 0.207 seconds
[0m10:57:54.961989 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: ROLLBACK
[0m10:57:54.962666 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9'
[0m10:57:54.963036 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9: Close
[0m10:57:54.963521 [debug] [Thread-1 (]: SQL status: OK in 0.149 seconds
[0m10:57:54.964995 [debug] [Thread-1 (]: On snapshot.portfolio_project_2.regime_classification_snapshot: Close
[0m10:57:54.966143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD95B1D0>]}
[0m10:57:54.965611 [info ] [Thread-2 (]: 78 of 124 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0 .......... [[32mPASS[0m in 0.26s]
[0m10:57:54.967658 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9
[0m10:57:54.968107 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m10:57:54.966949 [info ] [Thread-1 (]: 73 of 124 OK snapshotted analytics_dev_snapshots.regime_classification_snapshot  [[32mOK[0m in 0.89s]
[0m10:57:54.969305 [debug] [Thread-1 (]: Finished running node snapshot.portfolio_project_2.regime_classification_snapshot
[0m10:57:54.969706 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m10:57:54.968470 [info ] [Thread-2 (]: 81 of 124 START test not_null_int__rsi_sma_close ............................... [RUN]
[0m10:57:54.970750 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_gain___0.f599a656d9, now test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b)
[0m10:57:54.971137 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m10:57:54.980222 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m10:57:54.970081 [info ] [Thread-1 (]: 82 of 124 START test not_null_int__rsi_sma_gain ................................ [RUN]
[0m10:57:54.981772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.portfolio_project_2.regime_classification_snapshot, now test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953)
[0m10:57:54.982657 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m10:57:54.991894 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m10:57:54.993253 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m10:57:54.999595 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m10:57:55.001104 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m10:57:55.005637 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m10:57:55.007424 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m10:57:55.008198 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: BEGIN
[0m10:57:55.008847 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:55.010280 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m10:57:55.011121 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: BEGIN
[0m10:57:55.012807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:55.014114 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m10:57:55.016250 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"
[0m10:57:55.017086 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close
from "finance"."analytics_dev"."int__rsi_sma"
where close is null



  
  
      
    ) dbt_internal_test
[0m10:57:55.019220 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:57:55.020239 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"
[0m10:57:55.021051 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_sma"
where gain is null



  
  
      
    ) dbt_internal_test
[0m10:57:55.122625 [debug] [Thread-2 (]: SQL status: OK in 0.104 seconds
[0m10:57:55.123273 [debug] [Thread-3 (]: SQL status: OK in 0.173 seconds
[0m10:57:55.124039 [debug] [Thread-4 (]: SQL status: OK in 0.173 seconds
[0m10:57:55.126031 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: ROLLBACK
[0m10:57:55.126616 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m10:57:55.128973 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: ROLLBACK
[0m10:57:55.131124 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: ROLLBACK
[0m10:57:55.131910 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b'
[0m10:57:55.133045 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21'
[0m10:57:55.135877 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: ROLLBACK
[0m10:57:55.136985 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08'
[0m10:57:55.137821 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b: Close
[0m10:57:55.138463 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21: Close
[0m10:57:55.139345 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953'
[0m10:57:55.139791 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08: Close
[0m10:57:55.140393 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953: Close
[0m10:57:55.141116 [info ] [Thread-2 (]: 81 of 124 PASS not_null_int__rsi_sma_close ..................................... [[32mPASS[0m in 0.17s]
[0m10:57:55.142618 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b
[0m10:57:55.143064 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m10:57:55.141772 [info ] [Thread-3 (]: 79 of 124 PASS dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0 .......... [[32mPASS[0m in 0.21s]
[0m10:57:55.145455 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21
[0m10:57:55.145903 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m10:57:55.143440 [info ] [Thread-2 (]: 83 of 124 START test not_null_int__rsi_sma_loaded_at ........................... [RUN]
[0m10:57:55.147083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_close.e88c5ca89b, now test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0)
[0m10:57:55.147570 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m10:57:55.152061 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m10:57:55.143962 [info ] [Thread-4 (]: 80 of 124 PASS dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn . [[32mPASS[0m in 0.21s]
[0m10:57:55.153274 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08
[0m10:57:55.153844 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m10:57:55.144560 [info ] [Thread-1 (]: 82 of 124 PASS not_null_int__rsi_sma_gain ...................................... [[32mPASS[0m in 0.16s]
[0m10:57:55.154957 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953
[0m10:57:55.155362 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m10:57:55.146464 [info ] [Thread-3 (]: 84 of 124 START test not_null_int__rsi_sma_loss ................................ [RUN]
[0m10:57:55.156488 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_sma_sma_loss___0.5677c52d21, now test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065)
[0m10:57:55.156859 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m10:57:55.160631 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m10:57:55.154217 [info ] [Thread-4 (]: 85 of 124 START test not_null_int__rsi_sma_rn .................................. [RUN]
[0m10:57:55.161424 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m10:57:55.162168 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_sma_ticker__rn.5b5367dd08, now test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139)
[0m10:57:55.155745 [info ] [Thread-1 (]: 86 of 124 START test not_null_int__rsi_sma_sma_gain ............................ [RUN]
[0m10:57:55.166148 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m10:57:55.166743 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m10:57:55.167204 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m10:57:55.167760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_gain.cb306a2953, now test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416)
[0m10:57:55.172429 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m10:57:55.174708 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m10:57:55.175444 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m10:57:55.176384 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m10:57:55.186267 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m10:57:55.186797 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: BEGIN
[0m10:57:55.187395 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m10:57:55.187969 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m10:57:55.188436 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:55.190886 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m10:57:55.191472 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: BEGIN
[0m10:57:55.192405 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m10:57:55.193263 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:55.193696 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m10:57:55.267651 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m10:57:55.268695 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m10:57:55.269266 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"
[0m10:57:55.270014 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: BEGIN
[0m10:57:55.270487 [debug] [Thread-3 (]: SQL status: OK in 0.077 seconds
[0m10:57:55.270976 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "finance"."analytics_dev"."int__rsi_sma"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m10:57:55.271491 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:55.271923 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"
[0m10:57:55.272402 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m10:57:55.273375 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_sma"
where loss is null



  
  
      
    ) dbt_internal_test
[0m10:57:55.273877 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: BEGIN
[0m10:57:55.274715 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m10:57:55.275139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:55.275565 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"
[0m10:57:55.276201 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_sma"
where rn is null



  
  
      
    ) dbt_internal_test
[0m10:57:55.276903 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:57:55.277313 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"
[0m10:57:55.277726 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_gain
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_gain is null



  
  
      
    ) dbt_internal_test
[0m10:57:55.444263 [debug] [Thread-3 (]: SQL status: OK in 0.170 seconds
[0m10:57:55.444798 [debug] [Thread-1 (]: SQL status: OK in 0.167 seconds
[0m10:57:55.445352 [debug] [Thread-4 (]: SQL status: OK in 0.169 seconds
[0m10:57:55.446280 [debug] [Thread-2 (]: SQL status: OK in 0.173 seconds
[0m10:57:55.448177 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: ROLLBACK
[0m10:57:55.449745 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: ROLLBACK
[0m10:57:55.451127 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: ROLLBACK
[0m10:57:55.451890 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065'
[0m10:57:55.452518 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416'
[0m10:57:55.453132 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139'
[0m10:57:55.454510 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: ROLLBACK
[0m10:57:55.454928 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065: Close
[0m10:57:55.455366 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416: Close
[0m10:57:55.455760 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139: Close
[0m10:57:55.456424 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0'
[0m10:57:55.457039 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0: Close
[0m10:57:55.457671 [info ] [Thread-1 (]: 86 of 124 PASS not_null_int__rsi_sma_sma_gain .................................. [[32mPASS[0m in 0.29s]
[0m10:57:55.460031 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416
[0m10:57:55.458185 [info ] [Thread-4 (]: 85 of 124 PASS not_null_int__rsi_sma_rn ........................................ [[32mPASS[0m in 0.30s]
[0m10:57:55.460597 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m10:57:55.461262 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139
[0m10:57:55.458721 [info ] [Thread-2 (]: 83 of 124 PASS not_null_int__rsi_sma_loaded_at ................................. [[32mPASS[0m in 0.31s]
[0m10:57:55.462548 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m10:57:55.459288 [info ] [Thread-3 (]: 84 of 124 PASS not_null_int__rsi_sma_loss ...................................... [[32mPASS[0m in 0.30s]
[0m10:57:55.463502 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0
[0m10:57:55.462015 [info ] [Thread-1 (]: 87 of 124 START test not_null_int__rsi_sma_sma_loss ............................ [RUN]
[0m10:57:55.464927 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065
[0m10:57:55.465501 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m10:57:55.464036 [info ] [Thread-4 (]: 88 of 124 START test not_null_int__rsi_sma_ticker .............................. [RUN]
[0m10:57:55.466756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_gain.e3d4bc5416, now test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6)
[0m10:57:55.467308 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m10:57:55.468486 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_rn.fd24dd1139, now test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d)
[0m10:57:55.467928 [info ] [Thread-2 (]: 89 of 124 START test not_null_int__rsi_sma_trade_date .......................... [RUN]
[0m10:57:55.469232 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m10:57:55.470101 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m10:57:55.469709 [info ] [Thread-3 (]: 90 of 124 START test accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis  [RUN]
[0m10:57:55.470771 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loaded_at.da03ab8fd0, now test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0)
[0m10:57:55.478117 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m10:57:55.482834 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m10:57:55.483355 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_loss.ec424fe065, now test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47)
[0m10:57:55.483849 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m10:57:55.484487 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m10:57:55.488673 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m10:57:55.493286 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m10:57:55.494116 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m10:57:55.497510 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m10:57:55.498405 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m10:57:55.501666 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m10:57:55.502393 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m10:57:55.504675 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m10:57:55.505253 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m10:57:55.506249 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m10:57:55.509334 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m10:57:55.509937 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: BEGIN
[0m10:57:55.510671 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m10:57:55.511126 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:55.511626 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m10:57:55.512357 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: BEGIN
[0m10:57:55.513523 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m10:57:55.514175 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: BEGIN
[0m10:57:55.514761 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:55.515254 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: BEGIN
[0m10:57:55.515667 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m10:57:55.516109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:55.516790 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:55.517275 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"
[0m10:57:55.518200 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_sma"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m10:57:55.518801 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m10:57:55.519246 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"
[0m10:57:55.519653 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_sma"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m10:57:55.520095 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:57:55.520640 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m10:57:55.521110 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"
[0m10:57:55.521564 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"
[0m10:57:55.522031 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sma_loss
from (select * from "finance"."analytics_dev"."int__rsi_sma" where rn >= 14) dbt_subquery
where sma_loss is null



  
  
      
    ) dbt_internal_test
[0m10:57:55.522527 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regime as value_field,
        count(*) as n_records

    from "finance"."analytics_dev"."int__regime_changes"
    group by regime

)

select *
from all_values
where value_field not in (
    'complacent','normal','elevated','crisis'
)



  
  
      
    ) dbt_internal_test
[0m10:57:55.524551 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m10:57:55.526908 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: ROLLBACK
[0m10:57:55.527583 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0'
[0m10:57:55.527953 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0: Close
[0m10:57:55.528951 [info ] [Thread-2 (]: 89 of 124 PASS not_null_int__rsi_sma_trade_date ................................ [[32mPASS[0m in 0.06s]
[0m10:57:55.530284 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0
[0m10:57:55.531165 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m10:57:55.531622 [info ] [Thread-2 (]: 91 of 124 START test dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0  [RUN]
[0m10:57:55.532306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_trade_date.a434099ad0, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4)
[0m10:57:55.532706 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m10:57:55.536831 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m10:57:55.537817 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m10:57:55.540563 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m10:57:55.541563 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m10:57:55.541963 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: BEGIN
[0m10:57:55.542308 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:55.543474 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:57:55.543897 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"
[0m10:57:55.544275 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_changes"

where not(days_in_regime >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:55.599236 [debug] [Thread-4 (]: SQL status: OK in 0.080 seconds
[0m10:57:55.601085 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m10:57:55.610976 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: ROLLBACK
[0m10:57:55.612709 [debug] [Thread-2 (]: SQL status: OK in 0.068 seconds
[0m10:57:55.616450 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: ROLLBACK
[0m10:57:55.617699 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d'
[0m10:57:55.618892 [debug] [Thread-3 (]: SQL status: OK in 0.095 seconds
[0m10:57:55.620041 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d: Close
[0m10:57:55.621089 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6'
[0m10:57:55.623763 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: ROLLBACK
[0m10:57:55.626188 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: ROLLBACK
[0m10:57:55.627032 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6: Close
[0m10:57:55.628121 [info ] [Thread-4 (]: 88 of 124 PASS not_null_int__rsi_sma_ticker .................................... [[32mPASS[0m in 0.16s]
[0m10:57:55.629695 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4'
[0m10:57:55.631379 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47'
[0m10:57:55.632637 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d
[0m10:57:55.634146 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4: Close
[0m10:57:55.633570 [info ] [Thread-1 (]: 87 of 124 PASS not_null_int__rsi_sma_sma_loss .................................. [[32mPASS[0m in 0.17s]
[0m10:57:55.635003 [debug] [Thread-3 (]: On test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47: Close
[0m10:57:55.635704 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m10:57:55.636770 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6
[0m10:57:55.637640 [info ] [Thread-2 (]: 91 of 124 PASS dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0  [[32mPASS[0m in 0.11s]
[0m10:57:55.640245 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m10:57:55.641243 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4
[0m10:57:55.638437 [info ] [Thread-4 (]: 92 of 124 START test dbt_utils_expression_is_true_int__regime_changes_start_date___end_date  [RUN]
[0m10:57:55.642465 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m10:57:55.643109 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_ticker.32fdcd1b2d, now test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974)
[0m10:57:55.639557 [info ] [Thread-3 (]: 90 of 124 PASS accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis  [[32mPASS[0m in 0.16s]
[0m10:57:55.644320 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m10:57:55.645311 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47
[0m10:57:55.641913 [info ] [Thread-1 (]: 93 of 124 START test not_null_int__regime_changes_days_in_regime ............... [RUN]
[0m10:57:55.651356 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m10:57:55.643807 [info ] [Thread-2 (]: 94 of 124 START test not_null_int__regime_changes_end_date ..................... [RUN]
[0m10:57:55.652052 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m10:57:55.652527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_sma_sma_loss.ec41b717f6, now test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0)
[0m10:57:55.653182 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_days_in_regime___0.ac63896bf4, now test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755)
[0m10:57:55.654247 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m10:57:55.653656 [info ] [Thread-3 (]: 95 of 124 START test not_null_int__regime_changes_regime ....................... [RUN]
[0m10:57:55.654874 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m10:57:55.655302 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m10:57:55.659183 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m10:57:55.659686 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.accepted_values_int__regime_changes_regime__complacent__normal__elevated__crisis.a1d1df0a47, now test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006)
[0m10:57:55.663972 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m10:57:55.666468 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m10:57:55.667062 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m10:57:55.671578 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m10:57:55.672022 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m10:57:55.674825 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m10:57:55.675383 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m10:57:55.677874 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m10:57:55.678764 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m10:57:55.679509 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: BEGIN
[0m10:57:55.680225 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:55.681068 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m10:57:55.682007 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m10:57:55.685040 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m10:57:55.685601 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m10:57:55.686021 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: BEGIN
[0m10:57:55.686584 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m10:57:55.687073 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: BEGIN
[0m10:57:55.687512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:55.688008 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"
[0m10:57:55.688555 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m10:57:55.688958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:55.689645 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__regime_changes"

where not(start_date <= end_date)


  
  
      
    ) dbt_internal_test
[0m10:57:55.690117 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: BEGIN
[0m10:57:55.690774 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:57:55.691434 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:55.691846 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m10:57:55.692284 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"
[0m10:57:55.692901 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"
[0m10:57:55.693356 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select days_in_regime
from "finance"."analytics_dev"."int__regime_changes"
where days_in_regime is null



  
  
      
    ) dbt_internal_test
[0m10:57:55.693856 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select end_date
from "finance"."analytics_dev"."int__regime_changes"
where end_date is null



  
  
      
    ) dbt_internal_test
[0m10:57:55.694273 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m10:57:55.695175 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"
[0m10:57:55.695925 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select regime
from "finance"."analytics_dev"."int__regime_changes"
where regime is null



  
  
      
    ) dbt_internal_test
[0m10:57:55.809187 [debug] [Thread-4 (]: SQL status: OK in 0.118 seconds
[0m10:57:55.810376 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m10:57:55.812989 [debug] [Thread-2 (]: SQL status: OK in 0.118 seconds
[0m10:57:55.814306 [debug] [Thread-3 (]: SQL status: OK in 0.118 seconds
[0m10:57:55.818905 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: ROLLBACK
[0m10:57:55.822325 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: ROLLBACK
[0m10:57:55.825250 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: ROLLBACK
[0m10:57:55.828475 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: ROLLBACK
[0m10:57:55.830183 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974'
[0m10:57:55.831699 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0'
[0m10:57:55.833197 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755'
[0m10:57:55.834597 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006'
[0m10:57:55.835475 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974: Close
[0m10:57:55.836239 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0: Close
[0m10:57:55.837020 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755: Close
[0m10:57:55.837805 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006: Close
[0m10:57:55.839580 [info ] [Thread-1 (]: 93 of 124 PASS not_null_int__regime_changes_days_in_regime ..................... [[32mPASS[0m in 0.19s]
[0m10:57:55.843936 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0
[0m10:57:55.844798 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m10:57:55.840651 [info ] [Thread-4 (]: 92 of 124 PASS dbt_utils_expression_is_true_int__regime_changes_start_date___end_date  [[32mPASS[0m in 0.20s]
[0m10:57:55.846839 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974
[0m10:57:55.841724 [info ] [Thread-2 (]: 94 of 124 PASS not_null_int__regime_changes_end_date ........................... [[32mPASS[0m in 0.19s]
[0m10:57:55.847640 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m10:57:55.842653 [info ] [Thread-3 (]: 95 of 124 PASS not_null_int__regime_changes_regime ............................. [[32mPASS[0m in 0.18s]
[0m10:57:55.848506 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755
[0m10:57:55.849727 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006
[0m10:57:55.845816 [info ] [Thread-1 (]: 96 of 124 START test not_null_int__regime_changes_regime_period_id ............. [RUN]
[0m10:57:55.850401 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m10:57:55.849024 [info ] [Thread-4 (]: 97 of 124 START test not_null_int__regime_changes_start_date ................... [RUN]
[0m10:57:55.851265 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__rsi_wilder
[0m10:57:55.851852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_days_in_regime.e0360a78f0, now test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257)
[0m10:57:55.852797 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__regime_changes_start_date___end_date.608595d974, now test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7)
[0m10:57:55.852344 [info ] [Thread-2 (]: 98 of 124 START test unique_int__regime_changes_regime_period_id ............... [RUN]
[0m10:57:55.854079 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m10:57:55.853589 [info ] [Thread-3 (]: 99 of 124 START sql view model analytics_dev.int__rsi_wilder ................... [RUN]
[0m10:57:55.854741 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m10:57:55.855270 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_end_date.c0d79b9755, now test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1)
[0m10:57:55.859296 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m10:57:55.860102 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_regime.1711b66006, now model.portfolio_project_2.int__rsi_wilder)
[0m10:57:55.871298 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m10:57:55.871818 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m10:57:55.872368 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__rsi_wilder
[0m10:57:55.877128 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m10:57:55.882862 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__rsi_wilder"
[0m10:57:55.883866 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m10:57:55.884649 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m10:57:55.888522 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m10:57:55.891827 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m10:57:55.893063 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m10:57:55.896784 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m10:57:55.897491 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__rsi_wilder
[0m10:57:55.905963 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__rsi_wilder"
[0m10:57:55.908156 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m10:57:55.909610 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_wilder: BEGIN
[0m10:57:55.910841 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:55.913790 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m10:57:55.917326 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m10:57:55.918393 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m10:57:55.919305 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: BEGIN
[0m10:57:55.920019 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m10:57:55.920976 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: BEGIN
[0m10:57:55.922292 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m10:57:55.923249 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:55.924306 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

  
  create view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" as (
    with RECURSIVE wilder as (
    -- seed row: first complete window per ticker
    select
        r.ticker,
        r.rn,
        r.trade_date,
        r.gain,
        r.loss,
        r.sma_gain as wilder_gain,
        r.sma_loss as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" r
    where r.rn = 14

    union all

    -- recursive step: carry previous wilder_* forward
    select
        nxt.ticker,
        nxt.rn,
        nxt.trade_date,
        nxt.gain,
        nxt.loss,
        (prev.wilder_gain * 13 + nxt.gain) / 14.0 as wilder_gain,
        (prev.wilder_loss * 13 + nxt.loss) / 14.0 as wilder_loss
    from "finance"."analytics_dev"."int__rsi_sma" nxt
    join wilder prev
      on nxt.ticker = prev.ticker
     and nxt.rn = prev.rn + 1
)

select
    ticker::text as ticker,
    rn::int as rn,
    trade_date::date as trade_date,
    gain::decimal(18,2) as gain,
    loss::decimal(18,2) as loss,
    wilder_gain::decimal(18,2) as wilder_gain,
    wilder_loss::decimal(18,2) as wilder_loss
from wilder
  );

[0m10:57:55.925385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:55.926029 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: BEGIN
[0m10:57:55.927802 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:55.929069 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m10:57:55.930124 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"
[0m10:57:55.931200 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select start_date
from "finance"."analytics_dev"."int__regime_changes"
where start_date is null



  
  
      
    ) dbt_internal_test
[0m10:57:55.932104 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:57:55.934582 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m10:57:55.935305 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"
[0m10:57:55.935991 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"
[0m10:57:55.936596 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select regime_period_id
from "finance"."analytics_dev"."int__regime_changes"
where regime_period_id is null



  
  
      
    ) dbt_internal_test
[0m10:57:55.937478 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    regime_period_id as unique_field,
    count(*) as n_records

from "finance"."analytics_dev"."int__regime_changes"
where regime_period_id is not null
group by regime_period_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:57:56.022404 [debug] [Thread-4 (]: SQL status: OK in 0.088 seconds
[0m10:57:56.029136 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: ROLLBACK
[0m10:57:56.030445 [debug] [Thread-3 (]: SQL status: OK in 0.103 seconds
[0m10:57:56.032565 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7'
[0m10:57:56.041394 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m10:57:56.042724 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m10:57:56.043886 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7: Close
[0m10:57:56.045065 [debug] [Thread-2 (]: SQL status: OK in 0.106 seconds
[0m10:57:56.046432 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */
alter view "finance"."analytics_dev"."int__rsi_wilder__dbt_tmp" rename to "int__rsi_wilder"
[0m10:57:56.056061 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: ROLLBACK
[0m10:57:56.050149 [info ] [Thread-4 (]: 97 of 124 PASS not_null_int__regime_changes_start_date ......................... [[32mPASS[0m in 0.20s]
[0m10:57:56.059604 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: ROLLBACK
[0m10:57:56.061053 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257'
[0m10:57:56.062405 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7
[0m10:57:56.063570 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1'
[0m10:57:56.064567 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257: Close
[0m10:57:56.065669 [debug] [Thread-2 (]: On test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1: Close
[0m10:57:56.067458 [info ] [Thread-2 (]: 98 of 124 PASS unique_int__regime_changes_regime_period_id ..................... [[32mPASS[0m in 0.21s]
[0m10:57:56.069756 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1
[0m10:57:56.068427 [info ] [Thread-1 (]: 96 of 124 PASS not_null_int__regime_changes_regime_period_id ................... [[32mPASS[0m in 0.22s]
[0m10:57:56.071432 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257
[0m10:57:56.072565 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:57:56.073492 [info ] [Thread-4 (]: 100 of 124 START sql incremental model analytics_dev.mrt__stocks_with_regimes .. [RUN]
[0m10:57:56.074569 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_start_date.d1a47c87a7, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m10:57:56.075303 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:57:56.088257 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:57:56.089444 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:57:56.094230 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:57:56.094793 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__2e2dbcc9e62e" cascade
    
[0m10:57:56.095609 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:56.102081 [debug] [Thread-3 (]: SQL status: OK in 0.054 seconds
[0m10:57:56.103434 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m10:57:56.103824 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m10:57:56.104161 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_wilder: COMMIT
[0m10:57:56.141319 [debug] [Thread-4 (]: SQL status: OK in 0.046 seconds
[0m10:57:56.167877 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:57:56.168360 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m10:57:56.170012 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:57:56.171519 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:57:56.171903 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m10:57:56.173020 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:57:56.173375 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:57:56.173722 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m10:57:56.196365 [debug] [Thread-3 (]: SQL status: OK in 0.092 seconds
[0m10:57:56.199405 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__rsi_wilder"
[0m10:57:56.199828 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_wilder: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__rsi_wilder"} */

      drop view if exists "finance"."analytics_dev"."int__rsi_wilder__dbt_backup" cascade
    
[0m10:57:56.277211 [debug] [Thread-3 (]: SQL status: OK in 0.077 seconds
[0m10:57:56.279028 [debug] [Thread-3 (]: On model.portfolio_project_2.int__rsi_wilder: Close
[0m10:57:56.280221 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DBB17FB0>]}
[0m10:57:56.280945 [info ] [Thread-3 (]: 99 of 124 OK created sql view model analytics_dev.int__rsi_wilder .............. [[32mOK[0m in 0.42s]
[0m10:57:56.281949 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__rsi_wilder
[0m10:57:56.282911 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m10:57:56.283808 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m10:57:56.284705 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m10:57:56.283393 [info ] [Thread-2 (]: 101 of 124 START test dbt_utils_expression_is_true_int__rsi_wilder_gain___0 .... [RUN]
[0m10:57:56.285777 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.unique_int__regime_changes_regime_period_id.4094befab1, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90)
[0m10:57:56.286237 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m10:57:56.290814 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m10:57:56.284291 [info ] [Thread-1 (]: 102 of 124 START test dbt_utils_expression_is_true_int__rsi_wilder_loss___0 .... [RUN]
[0m10:57:56.291766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__regime_changes_regime_period_id.a45525d257, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703)
[0m10:57:56.292278 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m10:57:56.297722 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m10:57:56.285175 [info ] [Thread-3 (]: 103 of 124 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0  [RUN]
[0m10:57:56.298658 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.int__rsi_wilder, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7)
[0m10:57:56.299152 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m10:57:56.303907 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m10:57:56.304834 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m10:57:56.305340 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m10:57:56.308115 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m10:57:56.308636 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m10:57:56.311637 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m10:57:56.315741 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m10:57:56.316953 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m10:57:56.317455 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: BEGIN
[0m10:57:56.317907 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:56.318695 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m10:57:56.319203 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: BEGIN
[0m10:57:56.319638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:56.320464 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:57:56.320935 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"
[0m10:57:56.321376 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(gain >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:56.321940 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m10:57:56.322410 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: BEGIN
[0m10:57:56.323032 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:56.323662 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:57:56.324081 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"
[0m10:57:56.324501 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(loss >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:56.325165 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:57:56.325578 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"
[0m10:57:56.326084 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_gain >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:56.330187 [debug] [Thread-4 (]: SQL status: OK in 0.156 seconds
[0m10:57:56.332146 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:57:56.332861 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m10:57:56.333589 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m10:57:56.335492 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m10:57:56.336105 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:57:56.336680 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m10:57:56.421758 [debug] [Thread-4 (]: SQL status: OK in 0.085 seconds
[0m10:57:56.431271 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:57:56.431752 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,2) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:57:56.435913 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m10:57:56.451148 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:57:56.451603 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,2))
 as volume, 
      
    cast(null as text)
 as regime, 
      
    cast(null as int)
 as regime_period_id
    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:57:56.453169 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:57:56.486464 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:57:56.487471 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:57:56.487847 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m10:57:56.489006 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:57:56.489393 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:57:56.489828 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,2) not null,
    regime text not null,
    regime_period_id int unique not null
    
    )
 ;
    insert into "finance"."analytics_dev"."mrt__stocks_with_regimes" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime ,
    
      
      regime_period_id 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime, regime_period_id
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,2) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m10:57:56.691615 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,2) not null,
    regime text not null,
    regime_period_id int unique not null
    
    )
 ;
    insert into "finance"."analytics_dev"."mrt__stocks_with_regimes" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime ,
    
      
      regime_period_id 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime, regime_period_id
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    where 1 = 1 
        and "close" > 0
        and volume >= 0
        and trade_date <= current_date
        
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,2) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m10:57:56.692198 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m10:57:56.694742 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m10:57:56.695160 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__2e2dbcc9e62e" cascade
    
[0m10:57:56.697300 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__2e2dbcc9e62e" cascade
    
[0m10:57:56.697815 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m10:57:56.698358 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: ROLLBACK
[0m10:57:56.713654 [debug] [Thread-4 (]: Failed to rollback 'model.portfolio_project_2.mrt__stocks_with_regimes'
[0m10:57:56.714151 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m10:57:56.724141 [debug] [Thread-4 (]: Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK)
[0m10:57:56.724688 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DA4F0350>]}
[0m10:57:56.725372 [error] [Thread-4 (]: 100 of 124 ERROR creating sql incremental model analytics_dev.mrt__stocks_with_regimes  [[31mERROR[0m in 0.65s]
[0m10:57:56.727867 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m10:57:56.728934 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m10:57:56.730188 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.mrt__stocks_with_regimes' to be skipped because of status 'error'.  Reason: Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK).
[0m10:57:56.729520 [info ] [Thread-4 (]: 104 of 124 START test dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0  [RUN]
[0m10:57:56.731459 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.mrt__stocks_with_regimes, now test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d)
[0m10:57:56.731932 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m10:57:56.736877 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m10:57:56.737826 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m10:57:56.739988 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m10:57:56.740822 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m10:57:56.741189 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: BEGIN
[0m10:57:56.741532 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:56.742659 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:57:56.743021 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"
[0m10:57:56.743385 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "finance"."analytics_dev"."int__rsi_wilder"

where not(wilder_loss >= 0)


  
  
      
    ) dbt_internal_test
[0m10:57:57.522840 [debug] [Thread-2 (]: SQL status: OK in 1.201 seconds
[0m10:57:57.523300 [debug] [Thread-3 (]: SQL status: OK in 1.197 seconds
[0m10:57:57.523876 [debug] [Thread-1 (]: SQL status: OK in 1.199 seconds
[0m10:57:57.525609 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: ROLLBACK
[0m10:57:57.526233 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90'
[0m10:57:57.526593 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90: Close
[0m10:57:57.528040 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: ROLLBACK
[0m10:57:57.531059 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: ROLLBACK
[0m10:57:57.529399 [info ] [Thread-2 (]: 101 of 124 PASS dbt_utils_expression_is_true_int__rsi_wilder_gain___0 .......... [[32mPASS[0m in 1.24s]
[0m10:57:57.532014 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7'
[0m10:57:57.532629 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703'
[0m10:57:57.533267 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90
[0m10:57:57.533749 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7: Close
[0m10:57:57.534210 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703: Close
[0m10:57:57.534717 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m10:57:57.535501 [info ] [Thread-2 (]: 105 of 124 START test dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [RUN]
[0m10:57:57.537515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_gain___0.44b88daa90, now test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95)
[0m10:57:57.538054 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m10:57:57.542470 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m10:57:57.536175 [info ] [Thread-3 (]: 103 of 124 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0 ... [[32mPASS[0m in 1.24s]
[0m10:57:57.543612 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7
[0m10:57:57.544045 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m10:57:57.536876 [info ] [Thread-1 (]: 102 of 124 PASS dbt_utils_expression_is_true_int__rsi_wilder_loss___0 .......... [[32mPASS[0m in 1.25s]
[0m10:57:57.545203 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703
[0m10:57:57.545657 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m10:57:57.544428 [info ] [Thread-3 (]: 106 of 124 START test not_null_int__rsi_wilder_gain ............................ [RUN]
[0m10:57:57.546944 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_gain___0.e289542ad7, now test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda)
[0m10:57:57.547359 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m10:57:57.551617 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m10:57:57.552361 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m10:57:57.546071 [info ] [Thread-1 (]: 107 of 124 START test not_null_int__rsi_wilder_loss ............................ [RUN]
[0m10:57:57.555444 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m10:57:57.556012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_loss___0.1e03da6703, now test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56)
[0m10:57:57.556643 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m10:57:57.560667 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m10:57:57.561240 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m10:57:57.563807 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m10:57:57.564559 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m10:57:57.565204 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: BEGIN
[0m10:57:57.566146 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:57.568546 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:57:57.569501 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"
[0m10:57:57.570519 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        ticker, rn
    from "finance"."analytics_dev"."int__rsi_wilder"
    group by ticker, rn
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:57:57.572000 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m10:57:57.578648 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m10:57:57.580527 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m10:57:57.581278 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: BEGIN
[0m10:57:57.582026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:57.582855 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m10:57:57.584270 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: BEGIN
[0m10:57:57.585050 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:57.585776 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:57:57.587685 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"
[0m10:57:57.589292 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loss
from "finance"."analytics_dev"."int__rsi_wilder"
where loss is null



  
  
      
    ) dbt_internal_test
[0m10:57:57.590244 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m10:57:57.591302 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"
[0m10:57:57.592131 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gain
from "finance"."analytics_dev"."int__rsi_wilder"
where gain is null



  
  
      
    ) dbt_internal_test
[0m10:57:57.903890 [debug] [Thread-4 (]: SQL status: OK in 1.160 seconds
[0m10:57:57.909118 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: ROLLBACK
[0m10:57:57.912123 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d'
[0m10:57:57.912977 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d: Close
[0m10:57:57.914789 [info ] [Thread-4 (]: 104 of 124 PASS dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0 ... [[32mPASS[0m in 1.18s]
[0m10:57:57.916265 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d
[0m10:57:57.916921 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m10:57:57.917482 [info ] [Thread-4 (]: 108 of 124 START test not_null_int__rsi_wilder_rn .............................. [RUN]
[0m10:57:57.918356 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_expression_is_true_int__rsi_wilder_wilder_loss___0.8ec34e112d, now test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d)
[0m10:57:57.918940 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m10:57:57.924163 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m10:57:57.925515 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m10:57:57.929551 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m10:57:57.931276 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m10:57:57.932073 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: BEGIN
[0m10:57:57.932768 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:57.934147 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:57:57.934566 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"
[0m10:57:57.934942 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "finance"."analytics_dev"."int__rsi_wilder"
where rn is null



  
  
      
    ) dbt_internal_test
[0m10:57:58.877636 [debug] [Thread-2 (]: SQL status: OK in 1.305 seconds
[0m10:57:58.879945 [debug] [Thread-3 (]: SQL status: OK in 1.287 seconds
[0m10:57:58.880812 [debug] [Thread-1 (]: SQL status: OK in 1.290 seconds
[0m10:57:58.883055 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: ROLLBACK
[0m10:57:58.884490 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: ROLLBACK
[0m10:57:58.885114 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda'
[0m10:57:58.885493 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda: Close
[0m10:57:58.886805 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: ROLLBACK
[0m10:57:58.887395 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56'
[0m10:57:58.887767 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56: Close
[0m10:57:58.888872 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95'
[0m10:57:58.889274 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95: Close
[0m10:57:58.888348 [info ] [Thread-3 (]: 106 of 124 PASS not_null_int__rsi_wilder_gain .................................. [[32mPASS[0m in 1.34s]
[0m10:57:58.890559 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda
[0m10:57:58.891039 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m10:57:58.889832 [info ] [Thread-1 (]: 107 of 124 PASS not_null_int__rsi_wilder_loss .................................. [[32mPASS[0m in 1.33s]
[0m10:57:58.892095 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56
[0m10:57:58.892537 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m10:57:58.891428 [info ] [Thread-3 (]: 109 of 124 START test not_null_int__rsi_wilder_ticker .......................... [RUN]
[0m10:57:58.894067 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_gain.dd149e8dda, now test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd)
[0m10:57:58.894439 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m10:57:58.898733 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m10:57:58.892894 [info ] [Thread-1 (]: 110 of 124 START test not_null_int__rsi_wilder_trade_date ...................... [RUN]
[0m10:57:58.899599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_loss.c6a2f9ee56, now test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c)
[0m10:57:58.900229 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m10:57:58.893537 [info ] [Thread-2 (]: 105 of 124 PASS dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn  [[32mPASS[0m in 1.36s]
[0m10:57:58.904147 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m10:57:58.904839 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95
[0m10:57:58.905418 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m10:57:58.905922 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m10:57:58.908898 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m10:57:58.909461 [info ] [Thread-2 (]: 111 of 124 START test not_null_int__rsi_wilder_wilder_gain ..................... [RUN]
[0m10:57:58.910128 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.dbt_utils_unique_combination_of_columns_int__rsi_wilder_ticker__rn.b675377e95, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9)
[0m10:57:58.910525 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m10:57:58.914717 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m10:57:58.915367 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m10:57:58.918285 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m10:57:58.918908 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m10:57:58.919316 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: BEGIN
[0m10:57:58.919683 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:58.920383 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m10:57:58.923017 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m10:57:58.923637 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m10:57:58.924112 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"
[0m10:57:58.924671 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ticker
from "finance"."analytics_dev"."int__rsi_wilder"
where ticker is null



  
  
      
    ) dbt_internal_test
[0m10:57:58.925346 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m10:57:58.925753 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: BEGIN
[0m10:57:58.926198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:58.927014 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m10:57:58.927435 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: BEGIN
[0m10:57:58.927803 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:58.928493 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:57:58.928960 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"
[0m10:57:58.929374 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_date
from "finance"."analytics_dev"."int__rsi_wilder"
where trade_date is null



  
  
      
    ) dbt_internal_test
[0m10:57:58.930053 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:57:58.930459 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"
[0m10:57:58.930966 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_gain
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_gain is null



  
  
      
    ) dbt_internal_test
[0m10:57:59.102422 [debug] [Thread-4 (]: SQL status: OK in 1.167 seconds
[0m10:57:59.104907 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: ROLLBACK
[0m10:57:59.105583 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d'
[0m10:57:59.106018 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d: Close
[0m10:57:59.107129 [info ] [Thread-4 (]: 108 of 124 PASS not_null_int__rsi_wilder_rn .................................... [[32mPASS[0m in 1.19s]
[0m10:57:59.107967 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d
[0m10:57:59.108387 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m10:57:59.108771 [info ] [Thread-4 (]: 112 of 124 START test not_null_int__rsi_wilder_wilder_loss ..................... [RUN]
[0m10:57:59.109402 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_rn.d5fcd9191d, now test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb)
[0m10:57:59.109900 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m10:57:59.113594 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m10:57:59.114563 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m10:57:59.117376 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m10:57:59.118533 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m10:57:59.118934 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: BEGIN
[0m10:57:59.119283 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:59.120642 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:57:59.121045 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"
[0m10:57:59.121427 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
where wilder_loss is null



  
  
      
    ) dbt_internal_test
[0m10:58:00.196192 [debug] [Thread-3 (]: SQL status: OK in 1.271 seconds
[0m10:58:00.197198 [debug] [Thread-2 (]: SQL status: OK in 1.266 seconds
[0m10:58:00.197760 [debug] [Thread-1 (]: SQL status: OK in 1.268 seconds
[0m10:58:00.201096 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: ROLLBACK
[0m10:58:00.203011 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: ROLLBACK
[0m10:58:00.204523 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: ROLLBACK
[0m10:58:00.205113 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c'
[0m10:58:00.205751 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9'
[0m10:58:00.206379 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd'
[0m10:58:00.206773 [debug] [Thread-1 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c: Close
[0m10:58:00.207194 [debug] [Thread-2 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9: Close
[0m10:58:00.207607 [debug] [Thread-3 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd: Close
[0m10:58:00.208853 [info ] [Thread-1 (]: 110 of 124 PASS not_null_int__rsi_wilder_trade_date ............................ [[32mPASS[0m in 1.31s]
[0m10:58:00.211092 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c
[0m10:58:00.209481 [info ] [Thread-2 (]: 111 of 124 PASS not_null_int__rsi_wilder_wilder_gain ........................... [[32mPASS[0m in 1.30s]
[0m10:58:00.212003 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.wilder_seed_equals_sma
[0m10:58:00.213714 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9
[0m10:58:00.210024 [info ] [Thread-3 (]: 109 of 124 PASS not_null_int__rsi_wilder_ticker ................................ [[32mPASS[0m in 1.32s]
[0m10:58:00.215356 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m10:58:00.214731 [info ] [Thread-1 (]: 113 of 124 START test wilder_seed_equals_sma ................................... [RUN]
[0m10:58:00.217095 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd
[0m10:58:00.218574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_trade_date.b8289b125c, now test.portfolio_project_2.wilder_seed_equals_sma)
[0m10:58:00.217936 [info ] [Thread-2 (]: 114 of 124 SKIP test accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis  [[33mSKIP[0m]
[0m10:58:00.219326 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m10:58:00.219851 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.wilder_seed_equals_sma
[0m10:58:00.220325 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8
[0m10:58:00.224460 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m10:58:00.220815 [info ] [Thread-3 (]: 115 of 124 SKIP test dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0  [[33mSKIP[0m]
[0m10:58:00.225147 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m10:58:00.225675 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.accepted_values_mrt__stocks_with_regimes_regime__complacent__normal__elevated__crisis.51bccd1fa8' to be skipped because of status 'skipped'. 
[0m10:58:00.226335 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b
[0m10:58:00.226879 [info ] [Thread-2 (]: 116 of 124 SKIP test dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date  [[33mSKIP[0m]
[0m10:58:00.227739 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m10:58:00.228517 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf
[0m10:58:00.229688 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_open___0.5ee590fc1b' to be skipped because of status 'skipped'. 
[0m10:58:00.230559 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.wilder_seed_equals_sma
[0m10:58:00.232390 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m10:58:00.231499 [info ] [Thread-3 (]: 117 of 124 SKIP test dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0  [[33mSKIP[0m]
[0m10:58:00.233522 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_trade_date___current_date.1a65fd3ebf' to be skipped because of status 'skipped'. 
[0m10:58:00.241241 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.wilder_seed_equals_sma"
[0m10:58:00.242338 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe
[0m10:58:00.241843 [info ] [Thread-2 (]: 118 of 124 SKIP test dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker  [[33mSKIP[0m]
[0m10:58:00.243349 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_src_stocks_.8614ae4764
[0m10:58:00.243908 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de
[0m10:58:00.244313 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_expression_is_true_mrt__stocks_with_regimes_volume___0.28bc37bafe' to be skipped because of status 'skipped'. 
[0m10:58:00.245379 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m10:58:00.244819 [info ] [Thread-3 (]: 119 of 124 SKIP test relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_src_stocks_  [[33mSKIP[0m]
[0m10:58:00.246196 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.dbt_utils_unique_combination_of_columns_mrt__stocks_with_regimes_trade_date__ticker.22f67400de' to be skipped because of status 'skipped'. 
[0m10:58:00.246748 [debug] [Thread-1 (]: On test.portfolio_project_2.wilder_seed_equals_sma: BEGIN
[0m10:58:00.247415 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_src_stocks_.8614ae4764
[0m10:58:00.248139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:00.249093 [debug] [Thread-7 (]: Marking all children of 'test.portfolio_project_2.relationships_mrt__stocks_with_regimes_trade_date__trade_date__ref_src_stocks_.8614ae4764' to be skipped because of status 'skipped'. 
[0m10:58:00.251418 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:58:00.252634 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.wilder_seed_equals_sma"
[0m10:58:00.253301 [debug] [Thread-1 (]: On test.portfolio_project_2.wilder_seed_equals_sma: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.wilder_seed_equals_sma"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- asserts the seed matches SMA at rn=14
with w as (
  select ticker, trade_date, wilder_gain, wilder_loss
  from "finance"."analytics_dev"."int__rsi_wilder"
  where rn = 14
),
s as (
  select ticker, trade_date, sma_gain, sma_loss
  from "finance"."analytics_dev"."int__rsi_sma"
  where rn = 14
)
select
  w.ticker,
  w.trade_date
from w
join s using (ticker, trade_date)
where abs(w.wilder_gain - s.sma_gain) > 1e-9
   or abs(w.wilder_loss - s.sma_loss) > 1e-9
  
  
      
    ) dbt_internal_test
[0m10:58:00.278680 [debug] [Thread-4 (]: SQL status: OK in 1.157 seconds
[0m10:58:00.282957 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: ROLLBACK
[0m10:58:00.283631 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb'
[0m10:58:00.283979 [debug] [Thread-4 (]: On test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb: Close
[0m10:58:00.284993 [info ] [Thread-4 (]: 112 of 124 PASS not_null_int__rsi_wilder_wilder_loss ........................... [[32mPASS[0m in 1.18s]
[0m10:58:00.285937 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb
[0m10:58:01.442858 [debug] [Thread-1 (]: SQL status: OK in 1.189 seconds
[0m10:58:01.446549 [debug] [Thread-1 (]: On test.portfolio_project_2.wilder_seed_equals_sma: ROLLBACK
[0m10:58:01.447403 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.wilder_seed_equals_sma'
[0m10:58:01.447840 [debug] [Thread-1 (]: On test.portfolio_project_2.wilder_seed_equals_sma: Close
[0m10:58:01.449007 [info ] [Thread-1 (]: 113 of 124 PASS wilder_seed_equals_sma ......................................... [[32mPASS[0m in 1.23s]
[0m10:58:01.450015 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.wilder_seed_equals_sma
[0m10:58:01.450751 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.fct__rsi
[0m10:58:01.451300 [info ] [Thread-2 (]: 120 of 124 START sql view model analytics_dev.fct__rsi ......................... [RUN]
[0m10:58:01.451978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_wilder_gain.e6c3f281f9, now model.portfolio_project_2.fct__rsi)
[0m10:58:01.452423 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.fct__rsi
[0m10:58:01.455726 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.fct__rsi"
[0m10:58:01.456833 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.fct__rsi
[0m10:58:01.460476 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m10:58:01.460920 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:58:01.461338 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:58:01.471517 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m10:58:01.476679 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m10:58:01.477123 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as sma_rs, 
      
    cast(null as decimal(18,2))
 as sma_rsi, 
      
    cast(null as decimal(18,2))
 as wilder_rs, 
      
    cast(null as decimal(18,2))
 as wilder_rsi
    ) as __dbt_sbq
    where false
    limit 0
)
[0m10:58:01.478996 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:58:01.482596 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.fct__rsi"
[0m10:58:01.484138 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m10:58:01.484817 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: BEGIN
[0m10:58:01.486380 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:58:01.486793 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m10:58:01.487198 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

  
    
  create view "finance"."analytics_dev"."fct__rsi__dbt_tmp" as (
    with sma as (
select
    trade_date,
    ticker,
    gain,
    loss,
    sma_gain,
    sma_loss, 
    period_check
from "finance"."analytics_dev"."int__rsi_sma" 
), 

wilder_sma as (
select
    ticker,
    rn,
    trade_date,
    gain,
    loss,
    wilder_gain,
    wilder_loss
from "finance"."analytics_dev"."int__rsi_wilder"
),

rsi as (
    select
        s.trade_date,
        s.ticker,
        (s.sma_gain / nullif(s.sma_loss,0)) as sma_rs,
        100 - (100 / (1 + (s.sma_gain / nullif(s.sma_loss,0)))) as sma_rsi,
        (case 
            when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
            when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
            else (ws.wilder_gain / nullif(ws.wilder_loss,0))
        end) as wilder_rs,
        (case 
        when ws.wilder_loss = 0 and ws.wilder_gain > 0 then 100
        when ws.wilder_loss > 0 and ws.wilder_gain =  0 then 0
        else 100 - (100 / (1 + (ws.wilder_gain / nullif(ws.wilder_loss,0)))) 
        end) as wilder_rsi, 
        s.period_check                
    from sma s
    left join wilder_sma ws on s.trade_date = ws.trade_date and s.ticker = ws.ticker
), 

final as ( 
    select 
        trade_date,
        ticker,
        (case when period_check < 14 then null else sma_rs end) as sma_rs, 
        (case when period_check < 14 then null else sma_rsi end) as sma_rsi, 
        (case when period_check < 14 then null else wilder_rs end) as wilder_rs, 
        (case when period_check < 14 then null else wilder_rsi end) as wilder_rsi, 
    from rsi 
    )

select
    trade_date::date as trade_date,
    ticker::text as ticker,
    sma_rs::decimal(18,2) as sma_rs, 
    sma_rsi::decimal(18,2) as sma_rsi, 
    wilder_rs::decimal(18,2) as wilder_rs, 
    wilder_rsi::decimal(18,2) as wilder_rsi
from final
  );

[0m10:58:01.867974 [debug] [Thread-2 (]: SQL status: OK in 0.380 seconds
[0m10:58:01.871112 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m10:58:01.871473 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */
alter view "finance"."analytics_dev"."fct__rsi__dbt_tmp" rename to "fct__rsi"
[0m10:58:02.106793 [debug] [Thread-2 (]: SQL status: OK in 0.235 seconds
[0m10:58:02.108174 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m10:58:02.108580 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m10:58:02.108946 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: COMMIT
[0m10:58:02.359635 [debug] [Thread-2 (]: SQL status: OK in 0.250 seconds
[0m10:58:02.362669 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.fct__rsi"
[0m10:58:02.363378 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.fct__rsi"} */

      drop view if exists "finance"."analytics_dev"."fct__rsi__dbt_backup" cascade
    
[0m10:58:02.423873 [debug] [Thread-2 (]: SQL status: OK in 0.060 seconds
[0m10:58:02.426203 [debug] [Thread-2 (]: On model.portfolio_project_2.fct__rsi: Close
[0m10:58:02.426787 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce9b30b-92b4-4867-8fb8-04e186689e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD93BE30>]}
[0m10:58:02.427377 [info ] [Thread-2 (]: 120 of 124 OK created sql view model analytics_dev.fct__rsi .................... [[32mOK[0m in 0.97s]
[0m10:58:02.428241 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.fct__rsi
[0m10:58:02.429572 [debug] [Thread-3 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m10:58:02.430254 [debug] [Thread-1 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m10:58:02.431035 [debug] [Thread-4 (]: Began running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m10:58:02.432102 [debug] [Thread-2 (]: Began running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m10:58:02.431690 [info ] [Thread-3 (]: 121 of 124 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [RUN]
[0m10:58:02.432871 [info ] [Thread-1 (]: 123 of 124 START test dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ......... [RUN]
[0m10:58:02.433734 [info ] [Thread-4 (]: 122 of 124 START test dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [RUN]
[0m10:58:02.434710 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_ticker.9946cb48fd, now test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a)
[0m10:58:02.435614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.wilder_seed_equals_sma, now test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a)
[0m10:58:02.434186 [info ] [Thread-2 (]: 124 of 124 START test dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ...... [RUN]
[0m10:58:02.436170 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.portfolio_project_2.not_null_int__rsi_wilder_wilder_loss.d9957e94fb, now test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2)
[0m10:58:02.436563 [debug] [Thread-3 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m10:58:02.436937 [debug] [Thread-1 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m10:58:02.437336 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.fct__rsi, now test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0)
[0m10:58:02.437769 [debug] [Thread-4 (]: Began compiling node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m10:58:02.459275 [debug] [Thread-3 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m10:58:02.467824 [debug] [Thread-1 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m10:58:02.468499 [debug] [Thread-2 (]: Began compiling node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m10:58:02.473151 [debug] [Thread-4 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m10:58:02.477759 [debug] [Thread-2 (]: Writing injected SQL for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m10:58:02.478624 [debug] [Thread-3 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m10:58:02.481788 [debug] [Thread-3 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m10:58:02.482705 [debug] [Thread-1 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m10:58:02.483376 [debug] [Thread-4 (]: Began executing node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m10:58:02.484019 [debug] [Thread-2 (]: Began executing node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m10:58:02.486501 [debug] [Thread-1 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m10:58:02.488798 [debug] [Thread-4 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m10:58:02.491514 [debug] [Thread-2 (]: Writing runtime sql for node "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m10:58:02.492482 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m10:58:02.493212 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: BEGIN
[0m10:58:02.493889 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:58:02.494964 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m10:58:02.495559 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m10:58:02.496185 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m10:58:02.496757 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: BEGIN
[0m10:58:02.497139 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m10:58:02.497542 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: BEGIN
[0m10:58:02.497923 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: BEGIN
[0m10:58:02.498348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:02.499026 [debug] [Thread-3 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"
[0m10:58:02.499399 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:58:02.499796 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:58:02.500470 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and sma_rsi >= 0 and sma_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m10:58:02.501660 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:58:02.502236 [debug] [Thread-1 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"
[0m10:58:02.502843 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where sma_rs is not null) dbt_subquery

where not(sma_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m10:58:02.503589 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m10:58:02.503975 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m10:58:02.504331 [debug] [Thread-4 (]: Using duckdb connection "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"
[0m10:58:02.504709 [debug] [Thread-2 (]: Using duckdb connection "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"
[0m10:58:02.505120 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and wilder_rsi >= 0 and wilder_rsi <= 100
)
 as expression


    from "finance"."analytics_dev"."fct__rsi"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
[0m10:58:02.505549 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from (select * from "finance"."analytics_dev"."fct__rsi" where wilder_rs is not null) dbt_subquery

where not(wilder_rs >= 0)


  
  
      
    ) dbt_internal_test
[0m10:58:03.754414 [debug] [Thread-4 (]: SQL status: OK in 1.248 seconds
[0m10:58:03.755152 [debug] [Thread-2 (]: SQL status: OK in 1.249 seconds
[0m10:58:03.762683 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: ROLLBACK
[0m10:58:03.765943 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: ROLLBACK
[0m10:58:03.767045 [debug] [Thread-2 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0'
[0m10:58:03.768072 [debug] [Thread-4 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2'
[0m10:58:03.768687 [debug] [Thread-2 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0: Close
[0m10:58:03.769334 [debug] [Thread-4 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2: Close
[0m10:58:03.771057 [info ] [Thread-2 (]: 124 of 124 PASS dbt_utils_expression_is_true_fct__rsi_wilder_rs___0 ............ [[32mPASS[0m in 1.33s]
[0m10:58:03.772854 [debug] [Thread-3 (]: SQL status: OK in 1.271 seconds
[0m10:58:03.773861 [debug] [Thread-2 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0
[0m10:58:03.772099 [info ] [Thread-4 (]: 122 of 124 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0  [[32mPASS[0m in 1.34s]
[0m10:58:03.775253 [debug] [Thread-4 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2
[0m10:58:03.777884 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: ROLLBACK
[0m10:58:03.778953 [debug] [Thread-3 (]: Failed to rollback 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a'
[0m10:58:03.779482 [debug] [Thread-3 (]: On test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a: Close
[0m10:58:03.780980 [info ] [Thread-3 (]: 121 of 124 PASS dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0  [[32mPASS[0m in 1.35s]
[0m10:58:03.782464 [debug] [Thread-3 (]: Finished running node test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a
[0m10:58:03.868820 [debug] [Thread-1 (]: SQL status: OK in 1.365 seconds
[0m10:58:03.872122 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: ROLLBACK
[0m10:58:03.872947 [debug] [Thread-1 (]: Failed to rollback 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a'
[0m10:58:03.873439 [debug] [Thread-1 (]: On test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a: Close
[0m10:58:03.874729 [info ] [Thread-1 (]: 123 of 124 PASS dbt_utils_expression_is_true_fct__rsi_sma_rs___0 ............... [[32mPASS[0m in 1.44s]
[0m10:58:03.876116 [debug] [Thread-1 (]: Finished running node test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a
[0m10:58:03.878310 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:03.879162 [debug] [MainThread]: On master: BEGIN
[0m10:58:03.879814 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:03.881998 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:58:03.882475 [debug] [MainThread]: On master: COMMIT
[0m10:58:03.882905 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:03.883310 [debug] [MainThread]: On master: COMMIT
[0m10:58:03.884161 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:58:03.884595 [debug] [MainThread]: On master: Close
[0m10:58:03.885140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:03.885538 [debug] [MainThread]: Connection 'create_finance_analytics_dev_snapshots' was properly closed.
[0m10:58:03.885966 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m10:58:03.886343 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m10:58:03.886713 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m10:58:03.887081 [debug] [MainThread]: Connection 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_sma_rs___0.4c0e94558a' was properly closed.
[0m10:58:03.887458 [debug] [MainThread]: Connection 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_sma_rsi__100__0.2b933fb00a' was properly closed.
[0m10:58:03.887834 [debug] [MainThread]: Connection 'test.portfolio_project_2.dbt_utils_expression_is_true_fct__rsi_wilder_rs___0.10722e68b0' was properly closed.
[0m10:58:03.888208 [debug] [MainThread]: Connection 'test.portfolio_project_2.dbt_expectations_expect_column_values_to_be_between_fct__rsi_wilder_rsi__100__0.c088381bd2' was properly closed.
[0m10:58:03.888860 [info ] [MainThread]: 
[0m10:58:03.889603 [info ] [MainThread]: Finished running 1 incremental model, 1 seed, 1 snapshot, 111 data tests, 10 view models in 0 hours 0 minutes and 15.70 seconds (15.70s).
[0m10:58:03.912369 [debug] [MainThread]: Command end result
[0m10:58:03.983609 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m10:58:03.986517 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m10:58:03.996863 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m10:58:03.997276 [info ] [MainThread]: 
[0m10:58:03.997834 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:58:03.998319 [info ] [MainThread]: 
[0m10:58:03.998893 [error] [MainThread]: [31mFailure in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)[0m
[0m10:58:03.999481 [error] [MainThread]:   Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK)
[0m10:58:03.999993 [info ] [MainThread]: 
[0m10:58:04.000582 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\mrt__stocks_with_regimes.sql
[0m10:58:04.001146 [info ] [MainThread]: 
[0m10:58:04.001651 [info ] [MainThread]: Done. PASS=117 WARN=0 ERROR=1 SKIP=6 NO-OP=0 TOTAL=124
[0m10:58:04.002692 [debug] [MainThread]: Command `-c build` failed at 10:58:04.002553 after 17.26 seconds
[0m10:58:04.003108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DBC5AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD958710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD9B5490>]}
[0m10:58:04.003491 [debug] [MainThread]: Flushing usage events
[0m10:58:05.309470 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:02:54.345098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB2C88050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB34942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB3AD7ED0>]}


============================== 11:02:54.349712 | e6487930-a072-49de-b17b-1cacd136a77f ==============================
[0m11:02:54.349712 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:02:54.350439 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'log_format': 'default', 'invocation_command': 'dbt run --select stg__stocks', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m11:02:54.599475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6487930-a072-49de-b17b-1cacd136a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB2E40180>]}
[0m11:02:54.665675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6487930-a072-49de-b17b-1cacd136a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB397B790>]}
[0m11:02:54.670061 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:02:54.927973 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:02:55.154108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:02:55.154944 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\gold\mrt__stocks_with_regimes.sql
[0m11:02:55.735322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6487930-a072-49de-b17b-1cacd136a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB4BC6350>]}
[0m11:02:55.885058 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m11:02:55.887518 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m11:02:55.923066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6487930-a072-49de-b17b-1cacd136a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB4E00B90>]}
[0m11:02:55.923743 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 1 snapshot, 2 sources, 853 macros
[0m11:02:55.924279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6487930-a072-49de-b17b-1cacd136a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB5592CF0>]}
[0m11:02:55.926967 [info ] [MainThread]: 
[0m11:02:55.927467 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:02:55.927925 [info ] [MainThread]: 
[0m11:02:55.928570 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:02:55.929575 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m11:02:56.008198 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m11:02:56.008581 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m11:02:56.008932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:57.594538 [debug] [ThreadPool]: SQL status: OK in 1.586 seconds
[0m11:02:57.596018 [debug] [ThreadPool]: On list_finance: Close
[0m11:02:57.596745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m11:02:57.597256 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m11:02:57.603477 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:02:57.603828 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m11:02:57.604134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:57.605776 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:02:57.607095 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:02:57.607409 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m11:02:57.608365 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:02:57.608683 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:02:57.608984 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m11:02:57.661716 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m11:02:57.662859 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m11:02:57.663252 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:02:57.663617 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m11:02:57.715978 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m11:02:57.716672 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m11:02:57.726753 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m11:02:57.736013 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m11:02:57.736728 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m11:02:57.737171 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m11:02:57.739996 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m11:02:57.740470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:57.740954 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m11:02:57.741688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:57.742432 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:02:57.742797 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m11:02:57.743154 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m11:02:57.743931 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:02:57.744316 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m11:02:57.744723 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m11:02:57.768175 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m11:02:57.768618 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m11:02:57.769901 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m11:02:57.771161 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m11:02:57.772316 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m11:02:57.772624 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m11:02:57.773182 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m11:02:57.773493 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m11:02:57.776276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6487930-a072-49de-b17b-1cacd136a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB56693D0>]}
[0m11:02:57.776716 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:57.777007 [debug] [MainThread]: On master: BEGIN
[0m11:02:57.777281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:57.778379 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:02:57.778683 [debug] [MainThread]: On master: COMMIT
[0m11:02:57.778978 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:57.779255 [debug] [MainThread]: On master: COMMIT
[0m11:02:57.779801 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:02:57.780108 [debug] [MainThread]: On master: Close
[0m11:02:57.784774 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.stg__stocks
[0m11:02:57.785275 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_dev.stg__stocks .......................... [RUN]
[0m11:02:57.785944 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m11:02:57.786299 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m11:02:57.793531 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m11:02:57.794638 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m11:02:57.825547 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m11:02:57.826487 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:02:57.826856 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m11:02:57.827192 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:02:57.828553 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:02:57.828933 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:02:57.829329 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m11:02:57.973139 [debug] [Thread-1 (]: SQL status: OK in 0.143 seconds
[0m11:02:57.980660 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:02:57.981082 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m11:02:58.065488 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m11:02:58.068404 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:02:58.068765 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m11:02:58.129766 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m11:02:58.140880 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m11:02:58.141291 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:02:58.141628 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m11:02:58.388922 [debug] [Thread-1 (]: SQL status: OK in 0.247 seconds
[0m11:02:58.394483 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:02:58.394873 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m11:02:58.523376 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m11:02:58.525713 [debug] [Thread-1 (]: On model.portfolio_project_2.stg__stocks: Close
[0m11:02:58.527705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6487930-a072-49de-b17b-1cacd136a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB560B410>]}
[0m11:02:58.528331 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics_dev.stg__stocks ..................... [[32mOK[0m in 0.74s]
[0m11:02:58.529183 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m11:02:58.530674 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:58.531041 [debug] [MainThread]: On master: BEGIN
[0m11:02:58.531342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:58.532513 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:02:58.532834 [debug] [MainThread]: On master: COMMIT
[0m11:02:58.533174 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:58.533461 [debug] [MainThread]: On master: COMMIT
[0m11:02:58.534138 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:02:58.534511 [debug] [MainThread]: On master: Close
[0m11:02:58.534933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:58.535224 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m11:02:58.535504 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m11:02:58.535781 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m11:02:58.536131 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__stocks' was properly closed.
[0m11:02:58.536540 [info ] [MainThread]: 
[0m11:02:58.537078 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m11:02:58.537995 [debug] [MainThread]: Command end result
[0m11:02:58.603638 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m11:02:58.606401 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m11:02:58.613459 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m11:02:58.614106 [info ] [MainThread]: 
[0m11:02:58.615000 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:02:58.615563 [info ] [MainThread]: 
[0m11:02:58.616063 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:02:58.617051 [debug] [MainThread]: Command `-c run` succeeded at 11:02:58.616927 after 4.45 seconds
[0m11:02:58.617449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB5A0B5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB561CCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB561CFF0>]}
[0m11:02:58.617823 [debug] [MainThread]: Flushing usage events
[0m11:02:59.325372 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:03:27.239946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF40F78050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF417842D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF41DC7ED0>]}


============================== 11:03:27.244960 | 501385eb-2ae5-4583-ade5-5f816af06c1b ==============================
[0m11:03:27.244960 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:03:27.245680 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +int__region_classification', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m11:03:27.530550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '501385eb-2ae5-4583-ade5-5f816af06c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF41130180>]}
[0m11:03:27.608217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '501385eb-2ae5-4583-ade5-5f816af06c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF41C6B790>]}
[0m11:03:27.610955 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:03:27.882219 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:03:28.148622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:03:28.149087 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:03:28.230831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '501385eb-2ae5-4583-ade5-5f816af06c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF4371CC50>]}
[0m11:03:28.472295 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m11:03:28.474937 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m11:03:28.510109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '501385eb-2ae5-4583-ade5-5f816af06c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF43124B90>]}
[0m11:03:28.510612 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 1 snapshot, 2 sources, 853 macros
[0m11:03:28.511158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '501385eb-2ae5-4583-ade5-5f816af06c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF43166270>]}
[0m11:03:28.512413 [warn ] [MainThread]: The selection criterion '+int__region_classification' does not match any enabled nodes
[0m11:03:28.514471 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:03:28.516735 [debug] [MainThread]: Command end result
[0m11:03:28.574122 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m11:03:28.576697 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m11:03:28.580004 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m11:03:28.580855 [debug] [MainThread]: Command `-c run` succeeded at 11:03:28.580713 after 1.48 seconds
[0m11:03:28.581293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF4337C1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF41BBB1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF433781D0>]}
[0m11:03:28.581688 [debug] [MainThread]: Flushing usage events
[0m11:03:29.374258 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:03:44.060272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001763F638050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001763FE442D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017640487ED0>]}


============================== 11:03:44.064848 | 2e4478c3-63dd-4a8d-8288-a6775839aaa5 ==============================
[0m11:03:44.064848 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:03:44.065749 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select +int__regime_classification', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m11:03:44.324212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e4478c3-63dd-4a8d-8288-a6775839aaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001763F7F0180>]}
[0m11:03:44.393447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e4478c3-63dd-4a8d-8288-a6775839aaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001764032B790>]}
[0m11:03:44.396277 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:03:44.657468 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:03:44.888690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:03:44.889063 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:03:44.969949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e4478c3-63dd-4a8d-8288-a6775839aaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017641DCCC50>]}
[0m11:03:45.182668 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m11:03:45.185217 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m11:03:45.220401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e4478c3-63dd-4a8d-8288-a6775839aaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176417C4B90>]}
[0m11:03:45.220896 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 1 snapshot, 2 sources, 853 macros
[0m11:03:45.221447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e4478c3-63dd-4a8d-8288-a6775839aaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017641816270>]}
[0m11:03:45.224488 [info ] [MainThread]: 
[0m11:03:45.225091 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:03:45.225852 [info ] [MainThread]: 
[0m11:03:45.227713 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:03:45.233591 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m11:03:45.310371 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m11:03:45.310763 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m11:03:45.311075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:47.257555 [debug] [ThreadPool]: SQL status: OK in 1.946 seconds
[0m11:03:47.258929 [debug] [ThreadPool]: On list_finance: Close
[0m11:03:47.259596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m11:03:47.260064 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m11:03:47.266145 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:03:47.266487 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m11:03:47.266834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:47.268282 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:03:47.269531 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:03:47.269834 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m11:03:47.270794 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:03:47.271093 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:03:47.271386 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m11:03:47.338027 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m11:03:47.339391 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m11:03:47.339959 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:03:47.340418 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m11:03:47.393455 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m11:03:47.395064 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m11:03:47.404861 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m11:03:47.419000 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m11:03:47.426157 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m11:03:47.430197 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m11:03:47.430880 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m11:03:47.431543 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m11:03:47.432201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:47.432808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:47.434423 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:03:47.434930 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m11:03:47.435418 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m11:03:47.436119 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:03:47.436665 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m11:03:47.437152 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m11:03:47.463859 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m11:03:47.464256 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m11:03:47.465856 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m11:03:47.467049 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m11:03:47.468252 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m11:03:47.468558 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m11:03:47.469063 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m11:03:47.469368 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m11:03:47.472083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e4478c3-63dd-4a8d-8288-a6775839aaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017642001CC0>]}
[0m11:03:47.472521 [debug] [MainThread]: Using duckdb connection "master"
[0m11:03:47.472811 [debug] [MainThread]: On master: BEGIN
[0m11:03:47.473086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:03:47.474237 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:03:47.474563 [debug] [MainThread]: On master: COMMIT
[0m11:03:47.474875 [debug] [MainThread]: Using duckdb connection "master"
[0m11:03:47.475173 [debug] [MainThread]: On master: COMMIT
[0m11:03:47.475751 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:03:47.476073 [debug] [MainThread]: On master: Close
[0m11:03:47.480908 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_vix
[0m11:03:47.481473 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m11:03:47.482221 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m11:03:47.482585 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_vix
[0m11:03:47.491541 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m11:03:47.492535 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_vix
[0m11:03:47.535274 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m11:03:47.536231 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:03:47.536619 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m11:03:47.536968 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:03:47.538261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:03:47.538630 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:03:47.538984 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m11:03:47.711026 [debug] [Thread-1 (]: SQL status: OK in 0.171 seconds
[0m11:03:47.728294 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:03:47.729150 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m11:03:47.804123 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m11:03:47.807611 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:03:47.807997 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m11:03:47.892631 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m11:03:47.903740 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m11:03:47.904153 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:03:47.904485 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m11:03:48.040678 [debug] [Thread-1 (]: SQL status: OK in 0.136 seconds
[0m11:03:48.046380 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:03:48.046837 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m11:03:48.173258 [debug] [Thread-1 (]: SQL status: OK in 0.126 seconds
[0m11:03:48.175988 [debug] [Thread-1 (]: On model.portfolio_project_2.src_vix: Close
[0m11:03:48.178314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e4478c3-63dd-4a8d-8288-a6775839aaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176420FD850>]}
[0m11:03:48.179054 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.69s]
[0m11:03:48.179883 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_vix
[0m11:03:48.180759 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m11:03:48.181387 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_dev.stg__vix_with_versions ............... [RUN]
[0m11:03:48.182140 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m11:03:48.182553 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m11:03:48.185674 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m11:03:48.186720 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m11:03:48.190473 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m11:03:48.191505 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:03:48.191892 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m11:03:48.192238 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:03:48.193481 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:03:48.193849 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:03:48.194239 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m11:03:48.307896 [debug] [Thread-2 (]: SQL status: OK in 0.113 seconds
[0m11:03:48.311256 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:03:48.311706 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m11:03:48.374404 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m11:03:48.377628 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:03:48.378028 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m11:03:48.440641 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m11:03:48.442095 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m11:03:48.442489 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:03:48.442839 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m11:03:48.656660 [debug] [Thread-2 (]: SQL status: OK in 0.213 seconds
[0m11:03:48.659594 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:03:48.660028 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m11:03:48.832495 [debug] [Thread-2 (]: SQL status: OK in 0.172 seconds
[0m11:03:48.834033 [debug] [Thread-2 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m11:03:48.834576 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e4478c3-63dd-4a8d-8288-a6775839aaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017641A64EC0>]}
[0m11:03:48.835183 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_dev.stg__vix_with_versions .......... [[32mOK[0m in 0.65s]
[0m11:03:48.835979 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m11:03:48.836671 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m11:03:48.837147 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m11:03:48.837885 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.int__regime_classification'
[0m11:03:48.838322 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m11:03:48.841508 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m11:03:48.842568 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m11:03:48.846241 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m11:03:48.847293 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:03:48.847789 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m11:03:48.848226 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:03:48.849733 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:03:48.850240 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:03:48.850656 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m11:03:48.986808 [debug] [Thread-3 (]: SQL status: OK in 0.135 seconds
[0m11:03:48.992246 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:03:48.993194 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m11:03:49.068091 [debug] [Thread-3 (]: SQL status: OK in 0.074 seconds
[0m11:03:49.071225 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:03:49.071602 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m11:03:49.157563 [debug] [Thread-3 (]: SQL status: OK in 0.085 seconds
[0m11:03:49.159877 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m11:03:49.160572 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:03:49.161219 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m11:03:49.307550 [debug] [Thread-3 (]: SQL status: OK in 0.146 seconds
[0m11:03:49.310557 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:03:49.310996 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m11:03:49.479973 [debug] [Thread-3 (]: SQL status: OK in 0.169 seconds
[0m11:03:49.481417 [debug] [Thread-3 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m11:03:49.481965 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e4478c3-63dd-4a8d-8288-a6775839aaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176421EFED0>]}
[0m11:03:49.482587 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.64s]
[0m11:03:49.483457 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m11:03:49.485369 [debug] [MainThread]: Using duckdb connection "master"
[0m11:03:49.485817 [debug] [MainThread]: On master: BEGIN
[0m11:03:49.486127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:03:49.487488 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:03:49.487886 [debug] [MainThread]: On master: COMMIT
[0m11:03:49.488224 [debug] [MainThread]: Using duckdb connection "master"
[0m11:03:49.488540 [debug] [MainThread]: On master: COMMIT
[0m11:03:49.489218 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:03:49.489563 [debug] [MainThread]: On master: Close
[0m11:03:49.489996 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:49.490294 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m11:03:49.490579 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m11:03:49.490861 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m11:03:49.491148 [debug] [MainThread]: Connection 'model.portfolio_project_2.src_vix' was properly closed.
[0m11:03:49.491431 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__vix_with_versions' was properly closed.
[0m11:03:49.491714 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m11:03:49.492099 [info ] [MainThread]: 
[0m11:03:49.492634 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m11:03:49.494100 [debug] [MainThread]: Command end result
[0m11:03:49.567222 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m11:03:49.570036 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m11:03:49.576191 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m11:03:49.576581 [info ] [MainThread]: 
[0m11:03:49.577152 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:03:49.577661 [info ] [MainThread]: 
[0m11:03:49.578192 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:03:49.579136 [debug] [MainThread]: Command `-c run` succeeded at 11:03:49.579019 after 5.65 seconds
[0m11:03:49.579509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001763D37CA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017641C6EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017639BDF150>]}
[0m11:03:49.579869 [debug] [MainThread]: Flushing usage events
[0m11:03:50.280275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:03:59.982002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E8D48050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E95542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E9B97ED0>]}


============================== 11:03:59.986527 | f86fafde-f65c-43ad-aa9c-caedab5abcad ==============================
[0m11:03:59.986527 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:03:59.987429 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'invocation_command': 'dbt run --select +mrt__stocks_with_regimes', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m11:04:00.282461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f86fafde-f65c-43ad-aa9c-caedab5abcad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E8F00180>]}
[0m11:04:00.353492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f86fafde-f65c-43ad-aa9c-caedab5abcad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E9A3B790>]}
[0m11:04:00.356628 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:04:00.661677 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:04:00.895562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:04:00.895938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:04:00.977496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f86fafde-f65c-43ad-aa9c-caedab5abcad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EB4B4C50>]}
[0m11:04:01.203730 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m11:04:01.206405 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m11:04:01.242676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f86fafde-f65c-43ad-aa9c-caedab5abcad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EAE84B90>]}
[0m11:04:01.243168 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 1 snapshot, 2 sources, 853 macros
[0m11:04:01.243707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f86fafde-f65c-43ad-aa9c-caedab5abcad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EAEC6270>]}
[0m11:04:01.246558 [info ] [MainThread]: 
[0m11:04:01.247051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:04:01.247532 [info ] [MainThread]: 
[0m11:04:01.248305 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:04:01.254377 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m11:04:01.330591 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m11:04:01.330983 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m11:04:01.331503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:03.013651 [debug] [ThreadPool]: SQL status: OK in 1.682 seconds
[0m11:04:03.015129 [debug] [ThreadPool]: On list_finance: Close
[0m11:04:03.015867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m11:04:03.016333 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m11:04:03.023334 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:04:03.023699 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m11:04:03.023993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:04:03.025457 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:04:03.026731 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:04:03.027030 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m11:04:03.027954 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:04:03.028249 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:04:03.028537 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m11:04:03.085959 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m11:04:03.087118 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m11:04:03.087482 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:04:03.087860 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m11:04:03.147685 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m11:04:03.149235 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m11:04:03.157307 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m11:04:03.162804 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m11:04:03.163155 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m11:04:03.163436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:03.164374 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m11:04:03.166370 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m11:04:03.166691 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m11:04:03.166970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:03.167614 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:04:03.167939 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m11:04:03.168265 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m11:04:03.168757 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:04:03.169086 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m11:04:03.169404 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m11:04:03.193241 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m11:04:03.193637 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m11:04:03.195074 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m11:04:03.196438 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m11:04:03.197487 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m11:04:03.197807 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m11:04:03.198336 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m11:04:03.198655 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m11:04:03.201479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f86fafde-f65c-43ad-aa9c-caedab5abcad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EB6C2410>]}
[0m11:04:03.201948 [debug] [MainThread]: Using duckdb connection "master"
[0m11:04:03.202263 [debug] [MainThread]: On master: BEGIN
[0m11:04:03.202562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:04:03.203758 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:04:03.204134 [debug] [MainThread]: On master: COMMIT
[0m11:04:03.204432 [debug] [MainThread]: Using duckdb connection "master"
[0m11:04:03.204714 [debug] [MainThread]: On master: COMMIT
[0m11:04:03.205275 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:04:03.205578 [debug] [MainThread]: On master: Close
[0m11:04:03.210248 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m11:04:03.210700 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m11:04:03.211225 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m11:04:03.212320 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m11:04:03.212686 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m11:04:03.222575 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m11:04:03.211712 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m11:04:03.223404 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m11:04:03.223794 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m11:04:03.226848 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m11:04:03.227865 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m11:04:03.258386 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m11:04:03.259103 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m11:04:03.262367 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m11:04:03.263244 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:03.263734 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m11:04:03.264139 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:04:03.265163 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:03.265678 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m11:04:03.266210 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:04:03.267074 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:04:03.274649 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:03.275181 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m11:04:03.275768 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m11:04:03.276143 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:03.276507 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m11:04:03.367756 [debug] [Thread-2 (]: SQL status: OK in 0.091 seconds
[0m11:04:03.378589 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:03.379325 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m11:04:03.381615 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m11:04:03.386435 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:03.386979 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m11:04:03.442114 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m11:04:03.445100 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:03.445575 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m11:04:03.446935 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m11:04:03.449843 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:03.450200 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m11:04:03.509648 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m11:04:03.510095 [debug] [Thread-2 (]: SQL status: OK in 0.064 seconds
[0m11:04:03.521190 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m11:04:03.522477 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m11:04:03.522908 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:03.523342 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:03.523773 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m11:04:03.524198 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m11:04:03.646493 [debug] [Thread-1 (]: SQL status: OK in 0.122 seconds
[0m11:04:03.652795 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:03.653274 [debug] [Thread-2 (]: SQL status: OK in 0.128 seconds
[0m11:04:03.653695 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m11:04:03.656226 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:03.656861 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m11:04:03.821595 [debug] [Thread-1 (]: SQL status: OK in 0.165 seconds
[0m11:04:03.823994 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m11:04:03.826125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f86fafde-f65c-43ad-aa9c-caedab5abcad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EB7B9F10>]}
[0m11:04:03.826814 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.61s]
[0m11:04:03.827657 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m11:04:03.828357 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__stocks
[0m11:04:03.828966 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_dev.stg__stocks .......................... [RUN]
[0m11:04:03.829696 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m11:04:03.830083 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m11:04:03.833315 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m11:04:03.834265 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m11:04:03.837631 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m11:04:03.838493 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:03.838868 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m11:04:03.839210 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:04:03.840360 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:04:03.840717 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:03.841097 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m11:04:03.965471 [debug] [Thread-2 (]: SQL status: OK in 0.308 seconds
[0m11:04:03.966912 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m11:04:03.967443 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f86fafde-f65c-43ad-aa9c-caedab5abcad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EB1168E0>]}
[0m11:04:03.968025 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.74s]
[0m11:04:03.968899 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m11:04:03.969626 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m11:04:03.970120 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics_dev.stg__vix_with_versions ............... [RUN]
[0m11:04:03.970877 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m11:04:03.971263 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m11:04:03.978267 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:03.980129 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m11:04:03.987292 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:03.989046 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:03.989629 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m11:04:03.990075 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:04:03.992006 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m11:04:03.992510 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:03.992961 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m11:04:04.010437 [debug] [Thread-3 (]: SQL status: OK in 0.169 seconds
[0m11:04:04.013942 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:04.014387 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m11:04:04.143674 [debug] [Thread-3 (]: SQL status: OK in 0.129 seconds
[0m11:04:04.147975 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:04.148535 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m11:04:04.154840 [debug] [Thread-4 (]: SQL status: OK in 0.161 seconds
[0m11:04:04.159362 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:04.159969 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m11:04:04.217099 [debug] [Thread-3 (]: SQL status: OK in 0.068 seconds
[0m11:04:04.219983 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m11:04:04.220838 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:04.221591 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m11:04:04.223171 [debug] [Thread-4 (]: SQL status: OK in 0.063 seconds
[0m11:04:04.229129 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:04.229794 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m11:04:04.402344 [debug] [Thread-3 (]: SQL status: OK in 0.180 seconds
[0m11:04:04.405010 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:04.405391 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m11:04:04.405906 [debug] [Thread-4 (]: SQL status: OK in 0.175 seconds
[0m11:04:04.407288 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m11:04:04.407756 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:04.408113 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m11:04:04.539748 [debug] [Thread-4 (]: SQL status: OK in 0.131 seconds
[0m11:04:04.540227 [debug] [Thread-3 (]: SQL status: OK in 0.134 seconds
[0m11:04:04.546843 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:04.548579 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: Close
[0m11:04:04.549224 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m11:04:04.550043 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f86fafde-f65c-43ad-aa9c-caedab5abcad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9ECE2BA70>]}
[0m11:04:04.551052 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_dev.stg__stocks ..................... [[32mOK[0m in 0.72s]
[0m11:04:04.552148 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m11:04:04.672281 [debug] [Thread-4 (]: SQL status: OK in 0.122 seconds
[0m11:04:04.673893 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m11:04:04.674485 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f86fafde-f65c-43ad-aa9c-caedab5abcad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E8E7CC50>]}
[0m11:04:04.675120 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics_dev.stg__vix_with_versions .......... [[32mOK[0m in 0.70s]
[0m11:04:04.675951 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m11:04:04.676738 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m11:04:04.677238 [info ] [Thread-1 (]: 5 of 7 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m11:04:04.677864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__regime_classification)
[0m11:04:04.678257 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m11:04:04.681216 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m11:04:04.682182 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m11:04:04.685729 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m11:04:04.686775 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:04.687238 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m11:04:04.687618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:04.689178 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:04:04.690007 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:04.690892 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m11:04:04.800108 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m11:04:04.803408 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:04.803814 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m11:04:04.912896 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m11:04:04.916121 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:04.916489 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m11:04:05.005863 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m11:04:05.009178 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m11:04:05.009726 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:05.010196 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m11:04:05.250668 [debug] [Thread-1 (]: SQL status: OK in 0.240 seconds
[0m11:04:05.253325 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:05.253770 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m11:04:05.413971 [debug] [Thread-1 (]: SQL status: OK in 0.160 seconds
[0m11:04:05.415485 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m11:04:05.416063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f86fafde-f65c-43ad-aa9c-caedab5abcad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9ECDD30E0>]}
[0m11:04:05.416666 [info ] [Thread-1 (]: 5 of 7 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.74s]
[0m11:04:05.417481 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m11:04:05.418301 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m11:04:05.418805 [info ] [Thread-2 (]: 6 of 7 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m11:04:05.419424 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_changes)
[0m11:04:05.419810 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m11:04:05.423108 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m11:04:05.424028 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m11:04:05.427193 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m11:04:05.428021 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:05.428388 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m11:04:05.428729 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:04:05.430033 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:04:05.430546 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:05.431121 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m11:04:05.542569 [debug] [Thread-2 (]: SQL status: OK in 0.111 seconds
[0m11:04:05.545643 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:05.546042 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m11:04:05.605385 [debug] [Thread-2 (]: SQL status: OK in 0.059 seconds
[0m11:04:05.609952 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:05.610553 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m11:04:05.683479 [debug] [Thread-2 (]: SQL status: OK in 0.072 seconds
[0m11:04:05.684791 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m11:04:05.685162 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:05.685500 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m11:04:05.800359 [debug] [Thread-2 (]: SQL status: OK in 0.114 seconds
[0m11:04:05.802710 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:05.803136 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m11:04:05.915635 [debug] [Thread-2 (]: SQL status: OK in 0.112 seconds
[0m11:04:05.917181 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m11:04:05.917766 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f86fafde-f65c-43ad-aa9c-caedab5abcad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EB84B5F0>]}
[0m11:04:05.918378 [info ] [Thread-2 (]: 6 of 7 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.50s]
[0m11:04:05.919268 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m11:04:05.920000 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m11:04:05.920519 [info ] [Thread-3 (]: 7 of 7 START sql incremental model analytics_dev.mrt__stocks_with_regimes ...... [RUN]
[0m11:04:05.921162 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m11:04:05.921562 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m11:04:05.929340 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:05.930373 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m11:04:05.934592 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:05.935028 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__97c700a7d824" cascade
    
[0m11:04:05.935395 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:04:05.991805 [debug] [Thread-3 (]: SQL status: OK in 0.056 seconds
[0m11:04:06.038204 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:06.038663 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m11:04:06.040371 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:04:06.041886 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:06.042302 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m11:04:06.043532 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:04:06.043944 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:06.044304 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m11:04:06.106508 [debug] [Thread-3 (]: SQL status: OK in 0.062 seconds
[0m11:04:06.107638 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:06.108019 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m11:04:06.108467 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:04:06.109589 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m11:04:06.109956 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:06.110297 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m11:04:06.166736 [debug] [Thread-3 (]: SQL status: OK in 0.056 seconds
[0m11:04:06.198843 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:06.199338 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m11:04:06.203700 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m11:04:06.219065 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:06.219510 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,2))
 as volume, 
      
    cast(null as text)
 as regime, 
      
    cast(null as int)
 as regime_period_id
    ) as __dbt_sbq
    where false
    limit 0
)
[0m11:04:06.221079 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:04:06.229873 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:06.230258 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__97c700a7d824" cascade
    
[0m11:04:06.437613 [debug] [Thread-3 (]: SQL status: OK in 0.207 seconds
[0m11:04:06.438826 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m11:04:06.446814 [debug] [Thread-3 (]: Compilation Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | volume      | DECIMAL(18,0)   | DECIMAL(18,2) | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro duckdb__create_table_as (macros\adapters.sql)
  > called by macro create_table_as (macros\relations\table\create.sql)
  > called by macro materialization_incremental_duckdb (macros\materializations\incremental.sql)
  > called by model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
[0m11:04:06.447492 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f86fafde-f65c-43ad-aa9c-caedab5abcad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EB104AD0>]}
[0m11:04:06.448078 [error] [Thread-3 (]: 7 of 7 ERROR creating sql incremental model analytics_dev.mrt__stocks_with_regimes  [[31mERROR[0m in 0.53s]
[0m11:04:06.449030 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m11:04:06.449636 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.mrt__stocks_with_regimes' to be skipped because of status 'error'.  Reason: Compilation Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | volume      | DECIMAL(18,0)   | DECIMAL(18,2) | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro duckdb__create_table_as (macros\adapters.sql)
  > called by macro create_table_as (macros\relations\table\create.sql)
  > called by macro materialization_incremental_duckdb (macros\materializations\incremental.sql)
  > called by model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql).
[0m11:04:06.451815 [debug] [MainThread]: Using duckdb connection "master"
[0m11:04:06.452145 [debug] [MainThread]: On master: BEGIN
[0m11:04:06.452439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:04:06.453738 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:04:06.454045 [debug] [MainThread]: On master: COMMIT
[0m11:04:06.454337 [debug] [MainThread]: Using duckdb connection "master"
[0m11:04:06.454616 [debug] [MainThread]: On master: COMMIT
[0m11:04:06.455163 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:04:06.455467 [debug] [MainThread]: On master: Close
[0m11:04:06.455836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:06.456105 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m11:04:06.456362 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m11:04:06.456615 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m11:04:06.456866 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m11:04:06.457117 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m11:04:06.457372 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m11:04:06.457621 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__vix_with_versions' was properly closed.
[0m11:04:06.458326 [info ] [MainThread]: 
[0m11:04:06.459112 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m11:04:06.460999 [debug] [MainThread]: Command end result
[0m11:04:06.523799 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m11:04:06.526339 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m11:04:06.532463 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m11:04:06.532803 [info ] [MainThread]: 
[0m11:04:06.533335 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:04:06.533834 [info ] [MainThread]: 
[0m11:04:06.534418 [error] [MainThread]: [31mFailure in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)[0m
[0m11:04:06.535043 [error] [MainThread]:   Compilation Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | volume      | DECIMAL(18,0)   | DECIMAL(18,2) | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro duckdb__create_table_as (macros\adapters.sql)
  > called by macro create_table_as (macros\relations\table\create.sql)
  > called by macro materialization_incremental_duckdb (macros\materializations\incremental.sql)
  > called by model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
[0m11:04:06.535751 [info ] [MainThread]: 
[0m11:04:06.536298 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\mrt__stocks_with_regimes.sql
[0m11:04:06.536777 [info ] [MainThread]: 
[0m11:04:06.537277 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m11:04:06.538197 [debug] [MainThread]: Command `-c run` failed at 11:04:06.538077 after 6.69 seconds
[0m11:04:06.538588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EADBBB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EAE08710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E737A4B0>]}
[0m11:04:06.538967 [debug] [MainThread]: Flushing usage events
[0m11:04:07.381355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:04:30.659706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C0948050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C11542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C1797ED0>]}


============================== 11:04:30.664222 | 3335e42d-228e-4f8c-ae64-48d94f89cda7 ==============================
[0m11:04:30.664222 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:04:30.664935 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': 'C:\\Users\\David\\.dbt', 'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +mrt__stocks_with_regimes', 'printer_width': '80', 'write_json': 'True'}
[0m11:04:30.918776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3335e42d-228e-4f8c-ae64-48d94f89cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C0B00180>]}
[0m11:04:30.988369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3335e42d-228e-4f8c-ae64-48d94f89cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C163B790>]}
[0m11:04:30.990984 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:04:31.256179 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:04:31.505615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:04:31.506686 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\gold\gold_schema.yml
[0m11:04:32.085183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3335e42d-228e-4f8c-ae64-48d94f89cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C30E6750>]}
[0m11:04:32.244784 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m11:04:32.247325 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m11:04:32.277872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3335e42d-228e-4f8c-ae64-48d94f89cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C03FC7D0>]}
[0m11:04:32.278344 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 1 snapshot, 2 sources, 853 macros
[0m11:04:32.278903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3335e42d-228e-4f8c-ae64-48d94f89cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C3316F90>]}
[0m11:04:32.281768 [info ] [MainThread]: 
[0m11:04:32.282262 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:04:32.282722 [info ] [MainThread]: 
[0m11:04:32.283353 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:04:32.288556 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m11:04:32.363613 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m11:04:32.364007 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m11:04:32.364317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:34.268100 [debug] [ThreadPool]: SQL status: OK in 1.904 seconds
[0m11:04:34.269733 [debug] [ThreadPool]: On list_finance: Close
[0m11:04:34.270448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m11:04:34.270933 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m11:04:34.277221 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:04:34.277600 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m11:04:34.277896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:04:34.279567 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:04:34.280906 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:04:34.281227 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m11:04:34.282244 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:04:34.282538 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:04:34.282819 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m11:04:34.387083 [debug] [ThreadPool]: SQL status: OK in 0.104 seconds
[0m11:04:34.389733 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m11:04:34.390057 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:04:34.390357 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m11:04:34.456820 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m11:04:34.458355 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m11:04:34.467225 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m11:04:34.484258 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m11:04:34.488549 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m11:04:34.490875 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m11:04:34.491516 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m11:04:34.491883 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m11:04:34.492238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:34.492596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:34.493712 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:04:34.494015 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m11:04:34.494315 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m11:04:34.494737 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:04:34.495064 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m11:04:34.495379 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m11:04:34.520093 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m11:04:34.520556 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m11:04:34.521854 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m11:04:34.523203 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m11:04:34.524467 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m11:04:34.524793 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m11:04:34.525289 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m11:04:34.525608 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m11:04:34.530818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3335e42d-228e-4f8c-ae64-48d94f89cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C35E9B20>]}
[0m11:04:34.531850 [debug] [MainThread]: Using duckdb connection "master"
[0m11:04:34.532450 [debug] [MainThread]: On master: BEGIN
[0m11:04:34.532998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:04:34.534803 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:04:34.535435 [debug] [MainThread]: On master: COMMIT
[0m11:04:34.536008 [debug] [MainThread]: Using duckdb connection "master"
[0m11:04:34.536563 [debug] [MainThread]: On master: COMMIT
[0m11:04:34.537591 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:04:34.538164 [debug] [MainThread]: On master: Close
[0m11:04:34.543385 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m11:04:34.544307 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m11:04:34.543937 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m11:04:34.545396 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m11:04:34.545819 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m11:04:34.552723 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m11:04:34.544794 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m11:04:34.553661 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m11:04:34.554155 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m11:04:34.557457 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m11:04:34.558595 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m11:04:34.590629 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m11:04:34.591202 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m11:04:34.594692 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m11:04:34.595527 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:34.595928 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m11:04:34.596288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:04:34.597074 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:34.597461 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m11:04:34.597813 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:04:34.598598 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:04:34.599074 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:34.599467 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m11:04:34.600150 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m11:04:34.600553 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:34.600912 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m11:04:34.761277 [debug] [Thread-2 (]: SQL status: OK in 0.160 seconds
[0m11:04:34.762076 [debug] [Thread-1 (]: SQL status: OK in 0.162 seconds
[0m11:04:34.771837 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:34.778727 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:34.779277 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m11:04:34.779896 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m11:04:34.861034 [debug] [Thread-2 (]: SQL status: OK in 0.080 seconds
[0m11:04:34.867453 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:34.868316 [debug] [Thread-1 (]: SQL status: OK in 0.087 seconds
[0m11:04:34.869196 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m11:04:34.876569 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:34.877833 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m11:04:34.978286 [debug] [Thread-2 (]: SQL status: OK in 0.101 seconds
[0m11:04:34.978794 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m11:04:34.991408 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m11:04:34.992726 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m11:04:34.993169 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:34.993599 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:34.994031 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m11:04:34.994453 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m11:04:35.159405 [debug] [Thread-1 (]: SQL status: OK in 0.164 seconds
[0m11:04:35.164973 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:35.165364 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m11:04:35.165756 [debug] [Thread-2 (]: SQL status: OK in 0.171 seconds
[0m11:04:35.168136 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:35.168710 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m11:04:35.341545 [debug] [Thread-1 (]: SQL status: OK in 0.176 seconds
[0m11:04:35.343915 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m11:04:35.345909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3335e42d-228e-4f8c-ae64-48d94f89cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C33A7950>]}
[0m11:04:35.346534 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.80s]
[0m11:04:35.347365 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m11:04:35.348078 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__stocks
[0m11:04:35.348562 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_dev.stg__stocks .......................... [RUN]
[0m11:04:35.349245 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m11:04:35.349618 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m11:04:35.352585 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m11:04:35.353574 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m11:04:35.356788 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m11:04:35.357799 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:35.358211 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m11:04:35.358559 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:04:35.360418 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m11:04:35.361410 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:35.362032 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m11:04:35.433357 [debug] [Thread-2 (]: SQL status: OK in 0.264 seconds
[0m11:04:35.435133 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m11:04:35.435681 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3335e42d-228e-4f8c-ae64-48d94f89cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C37843C0>]}
[0m11:04:35.436359 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.88s]
[0m11:04:35.437345 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m11:04:35.438080 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m11:04:35.438608 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics_dev.stg__vix_with_versions ............... [RUN]
[0m11:04:35.439340 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m11:04:35.439725 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m11:04:35.442722 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:35.443836 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m11:04:35.447513 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:35.448535 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:35.448935 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m11:04:35.449274 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:04:35.450420 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m11:04:35.450815 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:35.451208 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m11:04:35.517660 [debug] [Thread-3 (]: SQL status: OK in 0.155 seconds
[0m11:04:35.520935 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:35.521330 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m11:04:35.541385 [debug] [Thread-4 (]: SQL status: OK in 0.090 seconds
[0m11:04:35.544797 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:35.545252 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m11:04:35.587275 [debug] [Thread-3 (]: SQL status: OK in 0.066 seconds
[0m11:04:35.590394 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:35.590803 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m11:04:35.604136 [debug] [Thread-4 (]: SQL status: OK in 0.058 seconds
[0m11:04:35.607285 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:35.607673 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m11:04:35.661797 [debug] [Thread-3 (]: SQL status: OK in 0.071 seconds
[0m11:04:35.663310 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m11:04:35.663697 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:35.664049 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m11:04:35.681706 [debug] [Thread-4 (]: SQL status: OK in 0.074 seconds
[0m11:04:35.683116 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m11:04:35.683523 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:35.683900 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m11:04:35.809513 [debug] [Thread-3 (]: SQL status: OK in 0.145 seconds
[0m11:04:35.812147 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:35.812524 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m11:04:35.813022 [debug] [Thread-4 (]: SQL status: OK in 0.129 seconds
[0m11:04:35.815224 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:35.815594 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m11:04:35.992716 [debug] [Thread-3 (]: SQL status: OK in 0.179 seconds
[0m11:04:35.993897 [debug] [Thread-4 (]: SQL status: OK in 0.178 seconds
[0m11:04:35.998040 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__stocks: Close
[0m11:04:36.003032 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m11:04:36.004425 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3335e42d-228e-4f8c-ae64-48d94f89cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C4D17F70>]}
[0m11:04:36.006512 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3335e42d-228e-4f8c-ae64-48d94f89cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C35D8950>]}
[0m11:04:36.005434 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_dev.stg__stocks ..................... [[32mOK[0m in 0.66s]
[0m11:04:36.009046 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m11:04:36.007877 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics_dev.stg__vix_with_versions .......... [[32mOK[0m in 0.57s]
[0m11:04:36.010416 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m11:04:36.011415 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m11:04:36.012183 [info ] [Thread-1 (]: 5 of 7 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m11:04:36.013166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__regime_classification)
[0m11:04:36.013885 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m11:04:36.020350 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m11:04:36.022597 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m11:04:36.029164 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m11:04:36.031209 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:36.031805 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m11:04:36.032492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:36.034036 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:04:36.034510 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:36.034927 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m11:04:36.151627 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m11:04:36.154785 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:36.155227 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m11:04:36.245233 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m11:04:36.253265 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:36.253783 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m11:04:36.299944 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m11:04:36.301267 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m11:04:36.301645 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:36.301995 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m11:04:36.412054 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m11:04:36.414476 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:36.414857 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m11:04:36.534742 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m11:04:36.536314 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m11:04:36.536901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3335e42d-228e-4f8c-ae64-48d94f89cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C37AD400>]}
[0m11:04:36.537519 [info ] [Thread-1 (]: 5 of 7 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.52s]
[0m11:04:36.538455 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m11:04:36.539282 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m11:04:36.539789 [info ] [Thread-2 (]: 6 of 7 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m11:04:36.540426 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_changes)
[0m11:04:36.540813 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m11:04:36.549162 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m11:04:36.550315 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m11:04:36.553863 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m11:04:36.555265 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:36.555694 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m11:04:36.556308 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:04:36.557600 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m11:04:36.557992 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:36.558472 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m11:04:36.680502 [debug] [Thread-2 (]: SQL status: OK in 0.121 seconds
[0m11:04:36.683915 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:36.684367 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m11:04:36.739430 [debug] [Thread-2 (]: SQL status: OK in 0.055 seconds
[0m11:04:36.742529 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:36.742891 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m11:04:36.822327 [debug] [Thread-2 (]: SQL status: OK in 0.079 seconds
[0m11:04:36.825461 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m11:04:36.826378 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:36.827186 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m11:04:36.957385 [debug] [Thread-2 (]: SQL status: OK in 0.130 seconds
[0m11:04:36.960266 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:36.960693 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m11:04:37.079359 [debug] [Thread-2 (]: SQL status: OK in 0.118 seconds
[0m11:04:37.080805 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m11:04:37.081342 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3335e42d-228e-4f8c-ae64-48d94f89cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C32647D0>]}
[0m11:04:37.081944 [info ] [Thread-2 (]: 6 of 7 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.54s]
[0m11:04:37.082758 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m11:04:37.083436 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m11:04:37.083932 [info ] [Thread-3 (]: 7 of 7 START sql incremental model analytics_dev.mrt__stocks_with_regimes ...... [RUN]
[0m11:04:37.084592 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m11:04:37.084978 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m11:04:37.089979 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:37.090990 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m11:04:37.095151 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:37.095543 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__77100f931d64" cascade
    
[0m11:04:37.095919 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:04:37.146927 [debug] [Thread-3 (]: SQL status: OK in 0.051 seconds
[0m11:04:37.180631 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:37.181212 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m11:04:37.182841 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:04:37.184265 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:37.184654 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m11:04:37.185644 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:04:37.186029 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:37.186407 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m11:04:37.226024 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m11:04:37.227269 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:37.227749 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m11:04:37.228300 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:04:37.229672 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m11:04:37.230116 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:37.230470 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m11:04:37.270923 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m11:04:37.292361 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:37.292819 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m11:04:37.296904 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m11:04:37.314197 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:37.314653 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,02))
 as volume, 
      
    cast(null as text)
 as regime, 
      
    cast(null as int)
 as regime_period_id
    ) as __dbt_sbq
    where false
    limit 0
)
[0m11:04:37.316259 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:04:37.326186 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:37.326617 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__77100f931d64" cascade
    
[0m11:04:37.410668 [debug] [Thread-3 (]: SQL status: OK in 0.084 seconds
[0m11:04:37.411882 [debug] [Thread-3 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m11:04:37.420002 [debug] [Thread-3 (]: Compilation Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | volume      | DECIMAL(18,0)   | DECIMAL(18,2) | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro duckdb__create_table_as (macros\adapters.sql)
  > called by macro create_table_as (macros\relations\table\create.sql)
  > called by macro materialization_incremental_duckdb (macros\materializations\incremental.sql)
  > called by model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
[0m11:04:37.420541 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3335e42d-228e-4f8c-ae64-48d94f89cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C4C81FD0>]}
[0m11:04:37.421106 [error] [Thread-3 (]: 7 of 7 ERROR creating sql incremental model analytics_dev.mrt__stocks_with_regimes  [[31mERROR[0m in 0.34s]
[0m11:04:37.421929 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m11:04:37.422538 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.mrt__stocks_with_regimes' to be skipped because of status 'error'.  Reason: Compilation Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | volume      | DECIMAL(18,0)   | DECIMAL(18,2) | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro duckdb__create_table_as (macros\adapters.sql)
  > called by macro create_table_as (macros\relations\table\create.sql)
  > called by macro materialization_incremental_duckdb (macros\materializations\incremental.sql)
  > called by model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql).
[0m11:04:37.424548 [debug] [MainThread]: Using duckdb connection "master"
[0m11:04:37.425006 [debug] [MainThread]: On master: BEGIN
[0m11:04:37.425295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:04:37.426418 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:04:37.426723 [debug] [MainThread]: On master: COMMIT
[0m11:04:37.427016 [debug] [MainThread]: Using duckdb connection "master"
[0m11:04:37.427296 [debug] [MainThread]: On master: COMMIT
[0m11:04:37.427838 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:04:37.428144 [debug] [MainThread]: On master: Close
[0m11:04:37.428515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:37.428786 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m11:04:37.429046 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m11:04:37.429302 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m11:04:37.429558 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m11:04:37.429815 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m11:04:37.430073 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m11:04:37.430326 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__vix_with_versions' was properly closed.
[0m11:04:37.430675 [info ] [MainThread]: 
[0m11:04:37.431167 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 5.15 seconds (5.15s).
[0m11:04:37.433154 [debug] [MainThread]: Command end result
[0m11:04:37.496476 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m11:04:37.499583 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m11:04:37.507116 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m11:04:37.507522 [info ] [MainThread]: 
[0m11:04:37.508079 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:04:37.508590 [info ] [MainThread]: 
[0m11:04:37.509326 [error] [MainThread]: [31mFailure in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)[0m
[0m11:04:37.509903 [error] [MainThread]:   Compilation Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason    |
  | ----------- | --------------- | ------------- | ------------------ |
  | volume      | DECIMAL(18,0)   | DECIMAL(18,2) | data type mismatch |
  
  
  > in macro assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros\relations\column\columns_spec_ddl.sql)
  > called by macro duckdb__create_table_as (macros\adapters.sql)
  > called by macro create_table_as (macros\relations\table\create.sql)
  > called by macro materialization_incremental_duckdb (macros\materializations\incremental.sql)
  > called by model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
[0m11:04:37.510577 [info ] [MainThread]: 
[0m11:04:37.511127 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\mrt__stocks_with_regimes.sql
[0m11:04:37.511600 [info ] [MainThread]: 
[0m11:04:37.512116 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m11:04:37.513078 [debug] [MainThread]: Command `-c run` failed at 11:04:37.512962 after 6.98 seconds
[0m11:04:37.513536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251BEFBA4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C4C73AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251C4C73D70>]}
[0m11:04:37.513942 [debug] [MainThread]: Flushing usage events
[0m11:04:38.259049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:04:47.894803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A96178050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A969842D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A96FC7ED0>]}


============================== 11:04:47.899052 | 83aa51d6-c462-49da-a6bd-091171501733 ==============================
[0m11:04:47.899052 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:04:47.899944 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\David\\.dbt', 'target_path': 'None', 'printer_width': '80', 'no_print': 'None', 'invocation_command': 'dbt run --select +mrt__stocks_with_regimes', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\David\\Downloads\\Coding_Projects\\dbt\\portfolio\\portfolio_project_2\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m11:04:48.150157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83aa51d6-c462-49da-a6bd-091171501733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A96330180>]}
[0m11:04:48.216324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83aa51d6-c462-49da-a6bd-091171501733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A96E6B790>]}
[0m11:04:48.218833 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:04:48.483776 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:04:48.731319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:04:48.732419 [debug] [MainThread]: Partial parsing: updated file: portfolio_project_2://models\gold\gold_schema.yml
[0m11:04:49.313355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83aa51d6-c462-49da-a6bd-091171501733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A988FE750>]}
[0m11:04:49.467392 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m11:04:49.469977 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m11:04:49.505055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83aa51d6-c462-49da-a6bd-091171501733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A95C2C7D0>]}
[0m11:04:49.505544 [info ] [MainThread]: Found 11 models, 111 data tests, 1 seed, 1 snapshot, 2 sources, 853 macros
[0m11:04:49.506076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83aa51d6-c462-49da-a6bd-091171501733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A98B5B850>]}
[0m11:04:49.509011 [info ] [MainThread]: 
[0m11:04:49.509560 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:04:49.510082 [info ] [MainThread]: 
[0m11:04:49.510763 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:04:49.515987 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance'
[0m11:04:49.593389 [debug] [ThreadPool]: Using duckdb connection "list_finance"
[0m11:04:49.593772 [debug] [ThreadPool]: On list_finance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"finance"'
    
  
  
[0m11:04:49.594079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:50.860139 [debug] [ThreadPool]: SQL status: OK in 1.266 seconds
[0m11:04:50.861599 [debug] [ThreadPool]: On list_finance: Close
[0m11:04:50.862317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance, now create_finance_analytics_dev)
[0m11:04:50.862819 [debug] [ThreadPool]: Creating schema "database: "finance"
schema: "analytics_dev"
"
[0m11:04:50.868974 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:04:50.869342 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m11:04:50.869647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:04:50.871204 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:04:50.872484 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:04:50.872787 [debug] [ThreadPool]: On create_finance_analytics_dev: BEGIN
[0m11:04:50.873702 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:04:50.874003 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:04:50.874412 [debug] [ThreadPool]: On create_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "create_finance_analytics_dev"} */

    
    
        create schema if not exists "finance"."analytics_dev"
    
[0m11:04:50.918534 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m11:04:50.919772 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m11:04:50.920165 [debug] [ThreadPool]: Using duckdb connection "create_finance_analytics_dev"
[0m11:04:50.920516 [debug] [ThreadPool]: On create_finance_analytics_dev: COMMIT
[0m11:04:50.961443 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m11:04:50.962214 [debug] [ThreadPool]: On create_finance_analytics_dev: Close
[0m11:04:50.966746 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev'
[0m11:04:50.977778 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m11:04:50.978462 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_finance_analytics_dev_snapshots'
[0m11:04:50.978949 [debug] [ThreadPool]: On list_finance_analytics_dev: BEGIN
[0m11:04:50.982295 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m11:04:50.983579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:50.984209 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: BEGIN
[0m11:04:50.985002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:50.985738 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:04:50.986320 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev"
[0m11:04:50.986703 [debug] [ThreadPool]: On list_finance_analytics_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev'
    and lower(table_catalog) = 'finance'
  
[0m11:04:50.987403 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:04:50.987807 [debug] [ThreadPool]: Using duckdb connection "list_finance_analytics_dev_snapshots"
[0m11:04:50.988160 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "connection_name": "list_finance_analytics_dev_snapshots"} */
select
      'finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'analytics_dev_snapshots'
    and lower(table_catalog) = 'finance'
  
[0m11:04:51.016082 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m11:04:51.016556 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m11:04:51.017864 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: ROLLBACK
[0m11:04:51.019328 [debug] [ThreadPool]: On list_finance_analytics_dev: ROLLBACK
[0m11:04:51.020442 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev_snapshots'
[0m11:04:51.021060 [debug] [ThreadPool]: On list_finance_analytics_dev_snapshots: Close
[0m11:04:51.022192 [debug] [ThreadPool]: Failed to rollback 'list_finance_analytics_dev'
[0m11:04:51.022647 [debug] [ThreadPool]: On list_finance_analytics_dev: Close
[0m11:04:51.025660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83aa51d6-c462-49da-a6bd-091171501733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A98E29710>]}
[0m11:04:51.026178 [debug] [MainThread]: Using duckdb connection "master"
[0m11:04:51.026494 [debug] [MainThread]: On master: BEGIN
[0m11:04:51.026908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:04:51.028419 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:04:51.028842 [debug] [MainThread]: On master: COMMIT
[0m11:04:51.029164 [debug] [MainThread]: Using duckdb connection "master"
[0m11:04:51.029458 [debug] [MainThread]: On master: COMMIT
[0m11:04:51.030252 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:04:51.030632 [debug] [MainThread]: On master: Close
[0m11:04:51.036939 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.src_vix
[0m11:04:51.037513 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.src_stocks
[0m11:04:51.038110 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_dev.src_vix .............................. [RUN]
[0m11:04:51.039362 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_vix'
[0m11:04:51.038731 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_dev.src_stocks ........................... [RUN]
[0m11:04:51.039907 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.src_vix
[0m11:04:51.040429 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.portfolio_project_2.src_stocks'
[0m11:04:51.049021 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.src_vix"
[0m11:04:51.049541 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.src_stocks
[0m11:04:51.055049 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.src_stocks"
[0m11:04:51.056139 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.src_vix
[0m11:04:51.056859 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.src_stocks
[0m11:04:51.111492 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.src_stocks"
[0m11:04:51.112197 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.src_vix"
[0m11:04:51.113828 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:51.114306 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: BEGIN
[0m11:04:51.114744 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:04:51.116246 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:51.116878 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: BEGIN
[0m11:04:51.117284 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:04:51.118036 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m11:04:51.118556 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:51.119027 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

  
  create view "finance"."analytics_dev"."src_vix__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."vix"
)

select
    trade_date::date as trade_date, 
    "close"::double as "close", 
    loaded_at::timestamp as loaded_at
from src
  );

[0m11:04:51.119527 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:04:51.120373 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:51.120841 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

  
  create view "finance"."analytics_dev"."src_stocks__dbt_tmp" as (
    with src as (
    select *
    from "finance"."raw"."stocks"
)

select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from src
  );

[0m11:04:51.260281 [debug] [Thread-1 (]: SQL status: OK in 0.139 seconds
[0m11:04:51.266875 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:51.267395 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks" rename to "src_stocks__dbt_backup"
[0m11:04:51.268643 [debug] [Thread-2 (]: SQL status: OK in 0.148 seconds
[0m11:04:51.286522 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:51.287723 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix" rename to "src_vix__dbt_backup"
[0m11:04:51.333152 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m11:04:51.340149 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:51.340653 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */
alter view "finance"."analytics_dev"."src_stocks__dbt_tmp" rename to "src_stocks"
[0m11:04:51.347205 [debug] [Thread-2 (]: SQL status: OK in 0.058 seconds
[0m11:04:51.351632 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:51.352539 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */
alter view "finance"."analytics_dev"."src_vix__dbt_tmp" rename to "src_vix"
[0m11:04:51.403726 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m11:04:51.427976 [debug] [Thread-2 (]: SQL status: OK in 0.074 seconds
[0m11:04:51.429016 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m11:04:51.430934 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m11:04:51.431591 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:51.432096 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:51.432615 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: COMMIT
[0m11:04:51.433122 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: COMMIT
[0m11:04:51.529106 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m11:04:51.535985 [debug] [Thread-2 (]: SQL status: OK in 0.102 seconds
[0m11:04:51.539244 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.src_stocks"
[0m11:04:51.542314 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.src_vix"
[0m11:04:51.542886 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_stocks"} */

      drop view if exists "finance"."analytics_dev"."src_stocks__dbt_backup" cascade
    
[0m11:04:51.543404 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.src_vix"} */

      drop view if exists "finance"."analytics_dev"."src_vix__dbt_backup" cascade
    
[0m11:04:51.758093 [debug] [Thread-2 (]: SQL status: OK in 0.214 seconds
[0m11:04:51.758767 [debug] [Thread-1 (]: SQL status: OK in 0.215 seconds
[0m11:04:51.761577 [debug] [Thread-2 (]: On model.portfolio_project_2.src_vix: Close
[0m11:04:51.763150 [debug] [Thread-1 (]: On model.portfolio_project_2.src_stocks: Close
[0m11:04:51.766894 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83aa51d6-c462-49da-a6bd-091171501733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A98BD37D0>]}
[0m11:04:51.767650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83aa51d6-c462-49da-a6bd-091171501733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A98FFC680>]}
[0m11:04:51.768880 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_dev.src_vix ......................... [[32mOK[0m in 0.72s]
[0m11:04:51.771363 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.src_vix
[0m11:04:51.770109 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics_dev.src_stocks ...................... [[32mOK[0m in 0.73s]
[0m11:04:51.772767 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.src_stocks
[0m11:04:51.773916 [debug] [Thread-3 (]: Began running node model.portfolio_project_2.stg__vix_with_versions
[0m11:04:51.774571 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.stg__stocks
[0m11:04:51.775406 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_dev.stg__vix_with_versions ............... [RUN]
[0m11:04:51.777053 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__vix_with_versions'
[0m11:04:51.776119 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics_dev.stg__stocks .......................... [RUN]
[0m11:04:51.777654 [debug] [Thread-3 (]: Began compiling node model.portfolio_project_2.stg__vix_with_versions
[0m11:04:51.778278 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.portfolio_project_2.stg__stocks'
[0m11:04:51.783157 [debug] [Thread-3 (]: Writing injected SQL for node "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:51.783987 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.stg__stocks
[0m11:04:51.790383 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.stg__stocks"
[0m11:04:51.792647 [debug] [Thread-3 (]: Began executing node model.portfolio_project_2.stg__vix_with_versions
[0m11:04:51.797541 [debug] [Thread-3 (]: Writing runtime sql for node "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:51.799013 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.stg__stocks
[0m11:04:51.805750 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.stg__stocks"
[0m11:04:51.807475 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:51.808283 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: BEGIN
[0m11:04:51.808918 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:04:51.810303 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:51.810825 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: BEGIN
[0m11:04:51.811217 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:04:51.812181 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m11:04:51.812793 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:51.813331 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

  
  create view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" as (
    with src_vix as (
select
    trade_date, 
    "close", 
    loaded_at
from "finance"."analytics_dev"."src_vix"
), 

thresholds as (
    select *
    from "finance"."analytics_dev"."regime_thresholds"
),

vix_with_all_versions as (
    select
        v.trade_date, 
        v."close", 
        v.loaded_at,
        t.version_id, 
        t.version_name, 
        t.complacent_max, 
        t.normal_max, 
        t.elevated_max, 
        t.effective_date, 
        row_number() over(partition by v.trade_date order by t.effective_date desc) as version_rank
    from src_vix v
    join thresholds t on v.trade_date >= t.effective_date

)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close",
    loaded_at::timestamp as loaded_at,
    version_id::int as version_id,
    version_name::text as version_name,
    complacent_max::int as complacent_max,
    normal_max::int as normal_max,
    elevated_max::int as elevated_max,
    effective_date::date as effective_date, 
    version_rank::int as version_rank
from vix_with_all_versions
where 1=1
    and version_rank = 1
    and "close" is not null
  );

[0m11:04:51.813841 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m11:04:51.814751 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:51.815312 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

  
  create view "finance"."analytics_dev"."stg__stocks__dbt_tmp" as (
    with base as (
    select *
    from "finance"."analytics_dev"."src_stocks"
)


select 
    trade_date::date as trade_date, 
    ticker::text as ticker, 
    "open"::decimal(18,2) as "open", 
    high::decimal(18,2) as high, 
    low::decimal(18,2) as low, 
    "close"::decimal(18,2) as "close", 
    volume::decimal(18,2) as volume, 
    loaded_at::timestamp as loaded_at
from base
where 1=1

-- remove closed trading days
    and "close" is not null

-- assert prices greater than zero
    and "open" > 0
    and high > 0
    and low > 0
    and "close" > 0
    and volume >= 0

-- assert prices reasonable
    and "close" between low and high
    and "open" between low and high

-- assert no future dates
    and trade_date <= current_date
    and loaded_at <= current_timestamp
  );

[0m11:04:51.903290 [debug] [Thread-4 (]: SQL status: OK in 0.087 seconds
[0m11:04:51.906694 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:51.907146 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks" rename to "stg__stocks__dbt_backup"
[0m11:04:51.907565 [debug] [Thread-3 (]: SQL status: OK in 0.093 seconds
[0m11:04:51.911328 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:51.911784 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions" rename to "stg__vix_with_versions__dbt_backup"
[0m11:04:51.960781 [debug] [Thread-4 (]: SQL status: OK in 0.053 seconds
[0m11:04:51.964819 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:51.965291 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */
alter view "finance"."analytics_dev"."stg__stocks__dbt_tmp" rename to "stg__stocks"
[0m11:04:51.966627 [debug] [Thread-3 (]: SQL status: OK in 0.054 seconds
[0m11:04:51.970888 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:51.971387 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */
alter view "finance"."analytics_dev"."stg__vix_with_versions__dbt_tmp" rename to "stg__vix_with_versions"
[0m11:04:52.015978 [debug] [Thread-4 (]: SQL status: OK in 0.050 seconds
[0m11:04:52.017336 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m11:04:52.017727 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:52.018076 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: COMMIT
[0m11:04:52.037965 [debug] [Thread-3 (]: SQL status: OK in 0.066 seconds
[0m11:04:52.039351 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m11:04:52.039759 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:52.040111 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: COMMIT
[0m11:04:52.136807 [debug] [Thread-3 (]: SQL status: OK in 0.096 seconds
[0m11:04:52.140883 [debug] [Thread-3 (]: Using duckdb connection "model.portfolio_project_2.stg__vix_with_versions"
[0m11:04:52.141327 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__vix_with_versions"} */

      drop view if exists "finance"."analytics_dev"."stg__vix_with_versions__dbt_backup" cascade
    
[0m11:04:52.141763 [debug] [Thread-4 (]: SQL status: OK in 0.123 seconds
[0m11:04:52.144206 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.stg__stocks"
[0m11:04:52.144578 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.stg__stocks"} */

      drop view if exists "finance"."analytics_dev"."stg__stocks__dbt_backup" cascade
    
[0m11:04:52.285183 [debug] [Thread-4 (]: SQL status: OK in 0.140 seconds
[0m11:04:52.285933 [debug] [Thread-3 (]: SQL status: OK in 0.144 seconds
[0m11:04:52.287755 [debug] [Thread-4 (]: On model.portfolio_project_2.stg__stocks: Close
[0m11:04:52.289495 [debug] [Thread-3 (]: On model.portfolio_project_2.stg__vix_with_versions: Close
[0m11:04:52.290265 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83aa51d6-c462-49da-a6bd-091171501733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9A472710>]}
[0m11:04:52.291060 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83aa51d6-c462-49da-a6bd-091171501733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A98FCDEB0>]}
[0m11:04:52.292070 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics_dev.stg__stocks ..................... [[32mOK[0m in 0.51s]
[0m11:04:52.294530 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.stg__stocks
[0m11:04:52.293346 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_dev.stg__vix_with_versions .......... [[32mOK[0m in 0.51s]
[0m11:04:52.295589 [debug] [Thread-3 (]: Finished running node model.portfolio_project_2.stg__vix_with_versions
[0m11:04:52.296299 [debug] [Thread-2 (]: Began running node model.portfolio_project_2.int__regime_classification
[0m11:04:52.296846 [info ] [Thread-2 (]: 5 of 7 START sql view model analytics_dev.int__regime_classification ........... [RUN]
[0m11:04:52.297587 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_vix, now model.portfolio_project_2.int__regime_classification)
[0m11:04:52.298321 [debug] [Thread-2 (]: Began compiling node model.portfolio_project_2.int__regime_classification
[0m11:04:52.302895 [debug] [Thread-2 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_classification"
[0m11:04:52.304325 [debug] [Thread-2 (]: Began executing node model.portfolio_project_2.int__regime_classification
[0m11:04:52.309446 [debug] [Thread-2 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_classification"
[0m11:04:52.310989 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:52.311501 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: BEGIN
[0m11:04:52.311873 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:04:52.313254 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:04:52.313675 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:52.314071 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

  
  create view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" as (
    with base as (
    select
        trade_date,
        "close",
        loaded_at,
        version_id,
        version_name,
        complacent_max,
        normal_max,
        elevated_max,
        effective_date
from "finance"."analytics_dev"."stg__vix_with_versions"
),

final as (
    select
        trade_date, 
        "close", 
        (case 
            when "close" <= complacent_max then 'complacent'
            when "close" > complacent_max and close <= normal_max then 'normal'
            when "close" > normal_max and "close" <= elevated_max then 'elevated'
            when "close" > elevated_max then 'crisis'
        end) as regime, 
        loaded_at
    from base b
)

select
    trade_date::date as trade_date,
    "close"::decimal(18,2) as "close", 
    regime::text as regime, 
    loaded_at::timestamp as loaded_at
from final
  );

[0m11:04:52.434415 [debug] [Thread-2 (]: SQL status: OK in 0.120 seconds
[0m11:04:52.438155 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:52.438704 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification" rename to "int__regime_classification__dbt_backup"
[0m11:04:52.562424 [debug] [Thread-2 (]: SQL status: OK in 0.123 seconds
[0m11:04:52.565732 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:52.566564 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */
alter view "finance"."analytics_dev"."int__regime_classification__dbt_tmp" rename to "int__regime_classification"
[0m11:04:52.662224 [debug] [Thread-2 (]: SQL status: OK in 0.095 seconds
[0m11:04:52.665195 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m11:04:52.665989 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:52.666708 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: COMMIT
[0m11:04:52.796966 [debug] [Thread-2 (]: SQL status: OK in 0.130 seconds
[0m11:04:52.800288 [debug] [Thread-2 (]: Using duckdb connection "model.portfolio_project_2.int__regime_classification"
[0m11:04:52.800851 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_classification"} */

      drop view if exists "finance"."analytics_dev"."int__regime_classification__dbt_backup" cascade
    
[0m11:04:52.921034 [debug] [Thread-2 (]: SQL status: OK in 0.119 seconds
[0m11:04:52.925307 [debug] [Thread-2 (]: On model.portfolio_project_2.int__regime_classification: Close
[0m11:04:52.926433 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83aa51d6-c462-49da-a6bd-091171501733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9902E900>]}
[0m11:04:52.927627 [info ] [Thread-2 (]: 5 of 7 OK created sql view model analytics_dev.int__regime_classification ...... [[32mOK[0m in 0.63s]
[0m11:04:52.928700 [debug] [Thread-2 (]: Finished running node model.portfolio_project_2.int__regime_classification
[0m11:04:52.929466 [debug] [Thread-1 (]: Began running node model.portfolio_project_2.int__regime_changes
[0m11:04:52.929983 [info ] [Thread-1 (]: 6 of 7 START sql view model analytics_dev.int__regime_changes .................. [RUN]
[0m11:04:52.930637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.src_stocks, now model.portfolio_project_2.int__regime_changes)
[0m11:04:52.931016 [debug] [Thread-1 (]: Began compiling node model.portfolio_project_2.int__regime_changes
[0m11:04:52.949725 [debug] [Thread-1 (]: Writing injected SQL for node "model.portfolio_project_2.int__regime_changes"
[0m11:04:52.952178 [debug] [Thread-1 (]: Began executing node model.portfolio_project_2.int__regime_changes
[0m11:04:52.960092 [debug] [Thread-1 (]: Writing runtime sql for node "model.portfolio_project_2.int__regime_changes"
[0m11:04:52.961294 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:52.962023 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: BEGIN
[0m11:04:52.962650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:52.964626 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:04:52.965261 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:52.965966 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

  
  create view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" as (
    with regime_classifications as (
    SELECT
        trade_date, 
        "close", 
        regime, 
        loaded_at
    FROM "finance"."analytics_dev"."int__regime_classification"
), 

prev_regime as (
select
    trade_date, 
    regime, 
    loaded_at, 
    lag(regime) over(order by trade_date asc, loaded_at asc) as prev_regime
from regime_classifications
),

regime_changes as (
    select 
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        (case
            when regime != prev_regime or prev_regime is null then 1
            else 0
        end) as changed
    from prev_regime
),

regime_change_count as (
    select
        trade_date, 
        regime, 
        loaded_at, 
        prev_regime,
        changed,
        sum(changed) over(
                        order by trade_date asc, loaded_at asc 
                        rows between unbounded preceding and current row
                        ) as regime_period_id
    from regime_changes
), 

final as (
    select
        regime, 
        regime_period_id,
        count(*) as days_in_regime, 
        min(trade_date) as "start_date",
        max(trade_date) as end_date
    from regime_change_count
    where regime is not null
    group by regime_period_id, regime
)

select
    regime::text as regime, 
    regime_period_id::int as regime_period_id,
    days_in_regime::int as days_in_regime, 
    "start_date"::date as "start_date",
    end_date::date as end_date
from final
order by "start_date" asc
  );

[0m11:04:53.064384 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m11:04:53.071436 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:53.072349 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes" rename to "int__regime_changes__dbt_backup"
[0m11:04:53.138426 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m11:04:53.142151 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:53.142752 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */
alter view "finance"."analytics_dev"."int__regime_changes__dbt_tmp" rename to "int__regime_changes"
[0m11:04:53.213386 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m11:04:53.215934 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m11:04:53.216990 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:53.217745 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: COMMIT
[0m11:04:53.354486 [debug] [Thread-1 (]: SQL status: OK in 0.136 seconds
[0m11:04:53.363450 [debug] [Thread-1 (]: Using duckdb connection "model.portfolio_project_2.int__regime_changes"
[0m11:04:53.366632 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.int__regime_changes"} */

      drop view if exists "finance"."analytics_dev"."int__regime_changes__dbt_backup" cascade
    
[0m11:04:53.548531 [debug] [Thread-1 (]: SQL status: OK in 0.179 seconds
[0m11:04:53.550650 [debug] [Thread-1 (]: On model.portfolio_project_2.int__regime_changes: Close
[0m11:04:53.551362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83aa51d6-c462-49da-a6bd-091171501733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A98BB35F0>]}
[0m11:04:53.552427 [info ] [Thread-1 (]: 6 of 7 OK created sql view model analytics_dev.int__regime_changes ............. [[32mOK[0m in 0.62s]
[0m11:04:53.553719 [debug] [Thread-1 (]: Finished running node model.portfolio_project_2.int__regime_changes
[0m11:04:53.554888 [debug] [Thread-4 (]: Began running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m11:04:53.556166 [info ] [Thread-4 (]: 7 of 7 START sql incremental model analytics_dev.mrt__stocks_with_regimes ...... [RUN]
[0m11:04:53.557096 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.portfolio_project_2.stg__stocks, now model.portfolio_project_2.mrt__stocks_with_regimes)
[0m11:04:53.557535 [debug] [Thread-4 (]: Began compiling node model.portfolio_project_2.mrt__stocks_with_regimes
[0m11:04:53.563387 [debug] [Thread-4 (]: Writing injected SQL for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:53.567093 [debug] [Thread-4 (]: Began executing node model.portfolio_project_2.mrt__stocks_with_regimes
[0m11:04:53.574320 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:53.574894 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__1180d5ba51cd" cascade
    
[0m11:04:53.575846 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:04:53.646055 [debug] [Thread-4 (]: SQL status: OK in 0.070 seconds
[0m11:04:53.688433 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:53.688978 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='finance'
        and type='sqlite'
    
  
[0m11:04:53.691570 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m11:04:53.693912 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:53.694372 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m11:04:53.695846 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m11:04:53.696346 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:53.696759 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    
    
        create schema if not exists "finance"."dbt_temp"
    
[0m11:04:53.758804 [debug] [Thread-4 (]: SQL status: OK in 0.061 seconds
[0m11:04:53.760581 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:53.761294 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

    

  
[0m11:04:53.761870 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m11:04:53.763727 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m11:04:53.764459 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:53.764857 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: COMMIT
[0m11:04:53.814993 [debug] [Thread-4 (]: SQL status: OK in 0.050 seconds
[0m11:04:53.836835 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:53.837304 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as __dbt_sbq
    where false
    limit 0
)
[0m11:04:53.842337 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m11:04:53.858380 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:53.859174 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as trade_date, 
      
    cast(null as text)
 as ticker, 
      
    cast(null as decimal(18,2))
 as open, 
      
    cast(null as decimal(18,2))
 as high, 
      
    cast(null as decimal(18,2))
 as low, 
      
    cast(null as decimal(18,2))
 as close, 
      
    cast(null as decimal(18,0))
 as volume, 
      
    cast(null as text)
 as regime, 
      
    cast(null as int)
 as regime_period_id
    ) as __dbt_sbq
    where false
    limit 0
)
[0m11:04:53.862068 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m11:04:53.891802 [debug] [Thread-4 (]: Writing runtime sql for node "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:53.892848 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:53.893326 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: BEGIN
[0m11:04:53.894656 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m11:04:53.895030 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:53.895444 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null,
    regime_period_id int unique not null
    
    )
 ;
    insert into "finance"."analytics_dev"."mrt__stocks_with_regimes" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime ,
    
      
      regime_period_id 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime, regime_period_id
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m11:04:54.145189 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

  
    
    
      
    

    create  table
      "finance"."analytics_dev"."mrt__stocks_with_regimes"
  
  (
    trade_date date not null,
    ticker text not null,
    open decimal(18,2) not null,
    high decimal(18,2) not null,
    low decimal(18,2) not null,
    close decimal(18,2),
    volume decimal(18,0) not null,
    regime text not null,
    regime_period_id int unique not null
    
    )
 ;
    insert into "finance"."analytics_dev"."mrt__stocks_with_regimes" 
  (
    
      
      trade_date ,
    
      
      ticker ,
    
      
      open ,
    
      
      high ,
    
      
      low ,
    
      
      close ,
    
      
      volume ,
    
      
      regime ,
    
      
      regime_period_id 
    
  )
 (
      
    select trade_date, ticker, open, high, low, close, volume, regime, regime_period_id
    from (
        


with regimes as (
    select
    regime, 
    regime_period_id,
    days_in_regime, 
    "start_date",
    end_date
from "finance"."analytics_dev"."int__regime_changes"
), 


src_stocks as (
    select 
        trade_date, 
        ticker, 
        "open", 
        high, 
        low, 
        "close", 
        volume
    from "finance"."analytics_dev"."stg__stocks"
    
)

select
    s.trade_date::date as trade_date, 
    s.ticker::text as ticker, 
    s."open"::decimal(18,2) as "open", 
    s.high::decimal(18,2) as high, 
    s.low::decimal(18,2) as low, 
    s."close"::decimal(18,2) as "close", 
    s.volume::decimal(18,0) as volume, 
    r.regime::text as regime,
    r.regime_period_id::int as regime_period_id 
from src_stocks s
left join regimes r on s.trade_date BETWEEN r."start_date" and coalesce(r.end_date, '9999-12-31')
    ) as model_subq
    );
  
  
  
[0m11:04:54.146130 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m11:04:54.151427 [debug] [Thread-4 (]: Using duckdb connection "model.portfolio_project_2.mrt__stocks_with_regimes"
[0m11:04:54.152081 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__1180d5ba51cd" cascade
    
[0m11:04:54.154540 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "portfolio_project_2", "target_name": "dev", "node_id": "model.portfolio_project_2.mrt__stocks_with_regimes"} */

      drop table if exists "finance"."dbt_temp"."mrt__stocks_with_regimes__1180d5ba51cd" cascade
    
[0m11:04:54.155045 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m11:04:54.155619 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: ROLLBACK
[0m11:04:54.169507 [debug] [Thread-4 (]: Failed to rollback 'model.portfolio_project_2.mrt__stocks_with_regimes'
[0m11:04:54.169956 [debug] [Thread-4 (]: On model.portfolio_project_2.mrt__stocks_with_regimes: Close
[0m11:04:54.178789 [debug] [Thread-4 (]: Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK)
[0m11:04:54.179271 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83aa51d6-c462-49da-a6bd-091171501733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A98BB2B10>]}
[0m11:04:54.179869 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model analytics_dev.mrt__stocks_with_regimes  [[31mERROR[0m in 0.62s]
[0m11:04:54.180704 [debug] [Thread-4 (]: Finished running node model.portfolio_project_2.mrt__stocks_with_regimes
[0m11:04:54.181344 [debug] [Thread-7 (]: Marking all children of 'model.portfolio_project_2.mrt__stocks_with_regimes' to be skipped because of status 'error'.  Reason: Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK).
[0m11:04:54.183762 [debug] [MainThread]: Using duckdb connection "master"
[0m11:04:54.184186 [debug] [MainThread]: On master: BEGIN
[0m11:04:54.184488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:04:54.185837 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:04:54.186169 [debug] [MainThread]: On master: COMMIT
[0m11:04:54.186479 [debug] [MainThread]: Using duckdb connection "master"
[0m11:04:54.186773 [debug] [MainThread]: On master: COMMIT
[0m11:04:54.187380 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:04:54.187698 [debug] [MainThread]: On master: Close
[0m11:04:54.188089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:54.188371 [debug] [MainThread]: Connection 'create_finance_analytics_dev' was properly closed.
[0m11:04:54.188637 [debug] [MainThread]: Connection 'list_finance_analytics_dev' was properly closed.
[0m11:04:54.188902 [debug] [MainThread]: Connection 'list_finance_analytics_dev_snapshots' was properly closed.
[0m11:04:54.189168 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_classification' was properly closed.
[0m11:04:54.189434 [debug] [MainThread]: Connection 'model.portfolio_project_2.int__regime_changes' was properly closed.
[0m11:04:54.189716 [debug] [MainThread]: Connection 'model.portfolio_project_2.stg__vix_with_versions' was properly closed.
[0m11:04:54.189978 [debug] [MainThread]: Connection 'model.portfolio_project_2.mrt__stocks_with_regimes' was properly closed.
[0m11:04:54.190456 [info ] [MainThread]: 
[0m11:04:54.190992 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 4.68 seconds (4.68s).
[0m11:04:54.192912 [debug] [MainThread]: Command end result
[0m11:04:54.258116 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\manifest.json
[0m11:04:54.260888 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\semantic_manifest.json
[0m11:04:54.267578 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\David\Downloads\Coding_Projects\dbt\portfolio\portfolio_project_2\target\run_results.json
[0m11:04:54.268100 [info ] [MainThread]: 
[0m11:04:54.268728 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:04:54.269466 [info ] [MainThread]: 
[0m11:04:54.270309 [error] [MainThread]: [31mFailure in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)[0m
[0m11:04:54.271172 [error] [MainThread]:   Runtime Error in model mrt__stocks_with_regimes (models\gold\mrt__stocks_with_regimes.sql)
  TransactionContext Error: Current transaction is aborted (please ROLLBACK)
[0m11:04:54.271853 [info ] [MainThread]: 
[0m11:04:54.272527 [info ] [MainThread]:   compiled code at target\compiled\portfolio_project_2\models\gold\mrt__stocks_with_regimes.sql
[0m11:04:54.273141 [info ] [MainThread]: 
[0m11:04:54.273869 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m11:04:54.275266 [debug] [MainThread]: Command `-c run` failed at 11:04:54.275081 after 6.51 seconds
[0m11:04:54.275930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A962132F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9A59FA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9A59FB90>]}
[0m11:04:54.276529 [debug] [MainThread]: Flushing usage events
[0m11:04:55.010803 [debug] [MainThread]: An error was encountered while trying to flush usage events
